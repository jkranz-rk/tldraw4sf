{"version":3,"file":"static/js/main.e74821c7.js","mappings":";sCAAA,OAOC,WACA,aAEA,IAAIA,EAAS,CAAC,EAAEC,eAGhB,SAASC,IAGR,IAFA,IAAIC,EAAU,GAELC,EAAI,EAAGA,EAAIC,UAAUC,OAAQF,IAAK,CAC1C,IAAIG,EAAMF,UAAUD,GACpB,GAAKG,EAAL,CAEA,IAAIC,SAAiBD,EAErB,GAAgB,WAAZC,GAAoC,WAAZA,EAC3BL,EAAQM,KAAKF,QACP,GAAIG,MAAMC,QAAQJ,IACxB,GAAIA,EAAID,OAAQ,CACf,IAAIM,EAAQV,EAAWW,MAAM,KAAMN,GAC/BK,GACHT,EAAQM,KAAKG,EAEf,OACM,GAAgB,WAAZJ,EAAsB,CAChC,GAAID,EAAIO,WAAaC,OAAOC,UAAUF,WAAaP,EAAIO,SAASA,WAAWG,SAAS,iBAAkB,CACrGd,EAAQM,KAAKF,EAAIO,YACjB,QACD,CAEA,IAAK,IAAII,KAAOX,EACXP,EAAOmB,KAAKZ,EAAKW,IAAQX,EAAIW,IAChCf,EAAQM,KAAKS,EAGhB,CAxBkB,CAyBnB,CAEA,OAAOf,EAAQiB,KAAK,IACrB,CAEqCC,EAAOC,SAC3CpB,EAAWqB,QAAUrB,EACrBmB,EAAOC,QAAUpB,QAKhB,KAFwB,EAAF,WACtB,OAAOA,CACP,UAFoB,OAEpB,YAIF,CApDA,yBCPD,IAAIsB,EAAaC,EAAQ,MACrBC,EAAcD,EAAQ,MAEtBE,EAAaC,UAGjBP,EAAOC,QAAU,SAAUO,GACzB,GAAIL,EAAWK,GAAW,OAAOA,EACjC,MAAMF,EAAWD,EAAYG,GAAY,qBAC3C,wBCTA,IAAIC,EAAkBL,EAAQ,MAC1BM,EAASN,EAAQ,MACjBO,EAAiBP,EAAAA,MAAAA,EAEjBQ,EAAcH,EAAgB,eAC9BI,EAAiBxB,MAAMM,eAIQmB,GAA/BD,EAAeD,IACjBD,EAAeE,EAAgBD,EAAa,CAC1CG,cAAc,EACdC,MAAON,EAAO,QAKlBV,EAAOC,QAAU,SAAUJ,GACzBgB,EAAeD,GAAaf,IAAO,CACrC,qCClBA,IAAIoB,EAASb,EAAAA,MAAAA,OAIbJ,EAAOC,QAAU,SAAUiB,EAAGC,EAAOC,GACnC,OAAOD,GAASC,EAAUH,EAAOC,EAAGC,GAAOlC,OAAS,EACtD,wBCPA,IAAIoC,EAAWjB,EAAQ,MAEnBkB,EAAUC,OACVjB,EAAaC,UAGjBP,EAAOC,QAAU,SAAUO,GACzB,GAAIa,EAASb,GAAW,OAAOA,EAC/B,MAAMF,EAAWgB,EAAQd,GAAY,oBACvC,uBCTA,IAAIgB,EAAkBpB,EAAQ,MAC1BqB,EAAkBrB,EAAQ,MAC1BsB,EAAoBtB,EAAQ,MAG5BuB,EAAe,SAAUC,GAC3B,OAAO,SAAUC,EAAOC,EAAIC,GAC1B,IAGIf,EAHAgB,EAAIR,EAAgBK,GACpB5C,EAASyC,EAAkBM,GAC3Bb,EAAQM,EAAgBM,EAAW9C,GAIvC,GAAI2C,GAAeE,GAAMA,GAAI,KAAO7C,EAASkC,GAG3C,IAFAH,EAAQgB,EAAEb,OAEGH,EAAO,OAAO,OAEtB,KAAM/B,EAASkC,EAAOA,IAC3B,IAAKS,GAAeT,KAASa,IAAMA,EAAEb,KAAWW,EAAI,OAAOF,GAAeT,GAAS,EACnF,OAAQS,IAAgB,CAC5B,CACF,EAEA5B,EAAOC,QAAU,CAGfL,SAAU+B,GAAa,GAGvBM,QAASN,GAAa,0BC9BxB,IAAIrC,EAAUc,EAAQ,MAClB8B,EAAgB9B,EAAQ,MACxBiB,EAAWjB,EAAQ,MAGnB+B,EAFkB/B,EAAQ,KAEhBK,CAAgB,WAC1B2B,EAAS/C,MAIbW,EAAOC,QAAU,SAAUoC,GACzB,IAAIC,EASF,OAREhD,EAAQ+C,KACVC,EAAID,EAAcE,aAEdL,EAAcI,KAAOA,IAAMF,GAAU9C,EAAQgD,EAAE3C,aAC1C0B,EAASiB,IAEN,QADVA,EAAIA,EAAEH,OAFwDG,OAAIxB,SAKvDA,IAANwB,EAAkBF,EAASE,CACtC,wBCrBA,IAAIE,EAA0BpC,EAAQ,MAItCJ,EAAOC,QAAU,SAAUoC,EAAepD,GACxC,OAAO,IAAKuD,EAAwBH,GAA7B,CAAwD,IAAXpD,EAAe,EAAIA,EACzE,wBCNA,IAAIwD,EAAcrC,EAAQ,MAEtBX,EAAWgD,EAAY,CAAC,EAAEhD,UAC1BiD,EAAcD,EAAY,GAAGE,OAEjC3C,EAAOC,QAAU,SAAU2C,GACzB,OAAOF,EAAYjD,EAASmD,GAAK,GAAI,EACvC,wBCPA,IAAIC,EAAwBzC,EAAQ,MAChCD,EAAaC,EAAQ,MACrB0C,EAAa1C,EAAQ,MAGrB2C,EAFkB3C,EAAQ,KAEVK,CAAgB,eAChCuC,EAAUtD,OAGVuD,EAAuE,aAAnDH,EAAW,WAAc,OAAO9D,SAAW,CAAhC,IAUnCgB,EAAOC,QAAU4C,EAAwBC,EAAa,SAAUF,GAC9D,IAAIZ,EAAGkB,EAAKC,EACZ,YAAcrC,IAAP8B,EAAmB,YAAqB,OAAPA,EAAc,OAEO,iBAAjDM,EAXD,SAAUN,EAAI/C,GACzB,IACE,OAAO+C,EAAG/C,EACZ,CAAE,MAAOuD,GAAoB,CAC/B,CAOoBC,CAAOrB,EAAIgB,EAAQJ,GAAKG,IAA8BG,EAEpED,EAAoBH,EAAWd,GAEH,WAA3BmB,EAASL,EAAWd,KAAmB7B,EAAW6B,EAAEsB,QAAU,YAAcH,CACnF,uBC5BA,IAAIxE,EAASyB,EAAQ,MACjBmD,EAAUnD,EAAQ,MAClBoD,EAAiCpD,EAAQ,MACzCqD,EAAuBrD,EAAQ,MAEnCJ,EAAOC,QAAU,SAAUyD,EAAQC,EAAQC,GAIzC,IAHA,IAAIC,EAAON,EAAQI,GACfhD,EAAiB8C,EAAqBK,EACtCC,EAA2BP,EAA+BM,EACrD/E,EAAI,EAAGA,EAAI8E,EAAK5E,OAAQF,IAAK,CACpC,IAAIc,EAAMgE,EAAK9E,GACVJ,EAAO+E,EAAQ7D,IAAU+D,GAAcjF,EAAOiF,EAAY/D,IAC7Dc,EAAe+C,EAAQ7D,EAAKkE,EAAyBJ,EAAQ9D,GAEjE,CACF,wBCfA,IAAImE,EAAc5D,EAAQ,MACtBqD,EAAuBrD,EAAQ,MAC/B6D,EAA2B7D,EAAQ,MAEvCJ,EAAOC,QAAU+D,EAAc,SAAUE,EAAQrE,EAAKmB,GACpD,OAAOyC,EAAqBK,EAAEI,EAAQrE,EAAKoE,EAAyB,EAAGjD,GACzE,EAAI,SAAUkD,EAAQrE,EAAKmB,GAEzB,OADAkD,EAAOrE,GAAOmB,EACPkD,CACT,oBCTAlE,EAAOC,QAAU,SAAUkE,EAAQnD,GACjC,MAAO,CACLoD,aAAuB,EAATD,GACdpD,eAAyB,EAAToD,GAChBE,WAAqB,EAATF,GACZnD,MAAOA,EAEX,wBCPA,IAAIb,EAAaC,EAAQ,MACrBqD,EAAuBrD,EAAQ,MAC/BkE,EAAclE,EAAQ,MACtBmE,EAAuBnE,EAAQ,MAEnCJ,EAAOC,QAAU,SAAU+B,EAAGnC,EAAKmB,EAAOwD,GACnCA,IAASA,EAAU,CAAC,GACzB,IAAIC,EAASD,EAAQJ,WACjBM,OAAwB5D,IAAjB0D,EAAQE,KAAqBF,EAAQE,KAAO7E,EAEvD,GADIM,EAAWa,IAAQsD,EAAYtD,EAAO0D,EAAMF,GAC5CA,EAAQG,OACNF,EAAQzC,EAAEnC,GAAOmB,EAChBuD,EAAqB1E,EAAKmB,OAC1B,CACL,IACOwD,EAAQI,OACJ5C,EAAEnC,KAAM4E,GAAS,UADEzC,EAAEnC,EAEhC,CAAE,MAAOuD,GAAoB,CACzBqB,EAAQzC,EAAEnC,GAAOmB,EAChByC,EAAqBK,EAAE9B,EAAGnC,EAAK,CAClCmB,MAAOA,EACPoD,YAAY,EACZrD,cAAeyD,EAAQK,gBACvBR,UAAWG,EAAQM,aAEvB,CAAE,OAAO9C,CACX,wBC1BA,IAAI2C,EAASvE,EAAQ,MAGjBO,EAAiBjB,OAAOiB,eAE5BX,EAAOC,QAAU,SAAUJ,EAAKmB,GAC9B,IACEL,EAAegE,EAAQ9E,EAAK,CAAEmB,MAAOA,EAAOD,cAAc,EAAMsD,UAAU,GAC5E,CAAE,MAAOjB,GACPuB,EAAO9E,GAAOmB,CAChB,CAAE,OAAOA,CACX,wBCXA,IAAI+D,EAAQ3E,EAAQ,MAGpBJ,EAAOC,SAAW8E,GAAM,WAEtB,OAA8E,GAAvErF,OAAOiB,eAAe,CAAC,EAAG,EAAG,CAAEqE,IAAK,WAAc,OAAO,CAAG,IAAK,EAC1E,sBCNA,IAAIC,EAAiC,iBAAZC,UAAwBA,SAASC,IAItDC,EAAmC,oBAAfH,QAA8CnE,IAAhBmE,EAEtDjF,EAAOC,QAAU,CACfkF,IAAKF,EACLG,WAAYA,wBCRd,IAAIT,EAASvE,EAAQ,MACjBiB,EAAWjB,EAAQ,MAEnB8E,EAAWP,EAAOO,SAElBG,EAAShE,EAAS6D,IAAa7D,EAAS6D,EAASI,eAErDtF,EAAOC,QAAU,SAAU2C,GACzB,OAAOyC,EAASH,EAASI,cAAc1C,GAAM,CAAC,CAChD,oBCTA,IAAItC,EAAaC,UAGjBP,EAAOC,QAAU,SAAU2C,GACzB,GAAIA,EAHiB,iBAGM,MAAMtC,EAAW,kCAC5C,OAAOsC,CACT,oBCNA5C,EAAOC,QAA8B,oBAAbsF,WAA4BhE,OAAOgE,UAAUC,YAAc,yBCAnF,IAOIC,EAAOC,EAPPf,EAASvE,EAAQ,MACjBoF,EAAYpF,EAAQ,MAEpBuF,EAAUhB,EAAOgB,QACjBC,EAAOjB,EAAOiB,KACdC,EAAWF,GAAWA,EAAQE,UAAYD,GAAQA,EAAKF,QACvDI,EAAKD,GAAYA,EAASC,GAG1BA,IAIFJ,GAHAD,EAAQK,EAAGC,MAAM,MAGD,GAAK,GAAKN,EAAM,GAAK,EAAI,IAAMA,EAAM,GAAKA,EAAM,MAK7DC,GAAWF,MACdC,EAAQD,EAAUC,MAAM,iBACVA,EAAM,IAAM,MACxBA,EAAQD,EAAUC,MAAM,oBACbC,GAAWD,EAAM,IAIhCzF,EAAOC,QAAUyF,oBCzBjB1F,EAAOC,QAAU,CACf,cACA,iBACA,gBACA,uBACA,iBACA,WACA,iCCRF,IAAI0E,EAASvE,EAAQ,MACjB2D,EAA2B3D,EAAAA,MAAAA,EAC3B4F,EAA8B5F,EAAQ,MACtC6F,EAAgB7F,EAAQ,MACxBmE,EAAuBnE,EAAQ,MAC/B8F,EAA4B9F,EAAQ,KACpC+F,EAAW/F,EAAQ,MAiBvBJ,EAAOC,QAAU,SAAUuE,EAASb,GAClC,IAGYD,EAAQ7D,EAAKuG,EAAgBC,EAAgBC,EAHrDC,EAAS/B,EAAQd,OACjB8C,EAAShC,EAAQG,OACjB8B,EAASjC,EAAQkC,KASrB,GANEhD,EADE8C,EACO7B,EACA8B,EACA9B,EAAO4B,IAAWhC,EAAqBgC,EAAQ,CAAC,IAE/C5B,EAAO4B,IAAW,CAAC,GAAG5G,UAEtB,IAAKE,KAAO8D,EAAQ,CAQ9B,GAPA0C,EAAiB1C,EAAO9D,GAGtBuG,EAFE5B,EAAQmC,gBACVL,EAAavC,EAAyBL,EAAQ7D,KACfyG,EAAWtF,MACpB0C,EAAO7D,IACtBsG,EAASK,EAAS3G,EAAM0G,GAAUE,EAAS,IAAM,KAAO5G,EAAK2E,EAAQoC,cAE5C9F,IAAnBsF,EAA8B,CAC3C,UAAWC,UAAyBD,EAAgB,SACpDF,EAA0BG,EAAgBD,EAC5C,EAEI5B,EAAQqC,MAAST,GAAkBA,EAAeS,OACpDb,EAA4BK,EAAgB,QAAQ,GAEtDJ,EAAcvC,EAAQ7D,EAAKwG,EAAgB7B,EAC7C,CACF,oBCrDAxE,EAAOC,QAAU,SAAU6G,GACzB,IACE,QAASA,GACX,CAAE,MAAO1D,GACP,OAAO,CACT,CACF,qCCJAhD,EAAQ,KACR,IAAIqC,EAAcrC,EAAQ,MACtB6F,EAAgB7F,EAAQ,MACxB2G,EAAa3G,EAAQ,MACrB2E,EAAQ3E,EAAQ,MAChBK,EAAkBL,EAAQ,MAC1B4F,EAA8B5F,EAAQ,MAEtC+B,EAAU1B,EAAgB,WAC1BuG,EAAkBC,OAAOtH,UAE7BK,EAAOC,QAAU,SAAUiH,EAAKJ,EAAMK,EAAQC,GAC5C,IAAIC,EAAS5G,EAAgByG,GAEzBI,GAAuBvC,GAAM,WAE/B,IAAI/C,EAAI,CAAC,EAET,OADAA,EAAEqF,GAAU,WAAc,OAAO,CAAG,EACf,GAAd,GAAGH,GAAKlF,EACjB,IAEIuF,EAAoBD,IAAwBvC,GAAM,WAEpD,IAAIyC,GAAa,EACbC,EAAK,IAkBT,MAhBY,UAARP,KAIFO,EAAK,CAAC,GAGHlF,YAAc,CAAC,EAClBkF,EAAGlF,YAAYJ,GAAW,WAAc,OAAOsF,CAAI,EACnDA,EAAGC,MAAQ,GACXD,EAAGJ,GAAU,IAAIA,IAGnBI,EAAGX,KAAO,WAAiC,OAAnBU,GAAa,EAAa,IAAM,EAExDC,EAAGJ,GAAQ,KACHG,CACV,IAEA,IACGF,IACAC,GACDJ,EACA,CACA,IAAIQ,EAA8BlF,EAAY,IAAI4E,IAC9CO,EAAUd,EAAKO,EAAQ,GAAGH,IAAM,SAAUW,EAAcC,EAAQC,EAAKC,EAAMC,GAC7E,IAAIC,EAAwBzF,EAAYoF,GACpCM,EAAQL,EAAOhB,KACnB,OAAIqB,IAAUpB,GAAcoB,IAAUnB,EAAgBF,KAChDQ,IAAwBW,EAInB,CAAEG,MAAM,EAAMpH,MAAO2G,EAA4BG,EAAQC,EAAKC,IAEhE,CAAEI,MAAM,EAAMpH,MAAOkH,EAAsBH,EAAKD,EAAQE,IAE1D,CAAEI,MAAM,EACjB,IAEAnC,EAAc1E,OAAO5B,UAAWuH,EAAKU,EAAQ,IAC7C3B,EAAce,EAAiBK,EAAQO,EAAQ,GACjD,CAEIR,GAAMpB,EAA4BgB,EAAgBK,GAAS,QAAQ,EACzE,qCCxEA,IAAI/H,EAAUc,EAAQ,MAClBsB,EAAoBtB,EAAQ,MAC5BiI,EAA2BjI,EAAQ,MACnCkI,EAAOlI,EAAQ,MA6BnBJ,EAAOC,QAzBgB,SAAnBsI,EAA6B7E,EAAQ8E,EAAU7E,EAAQ8E,EAAWC,EAAOC,EAAOC,EAAQC,GAM1F,IALA,IAGIC,EAHAC,EAAcL,EACdM,EAAc,EACdC,IAAQL,GAASN,EAAKM,EAAQC,GAG3BG,EAAcP,GACfO,KAAerF,IACjBmF,EAAUG,EAAQA,EAAMtF,EAAOqF,GAAcA,EAAaR,GAAY7E,EAAOqF,GAEzEL,EAAQ,GAAKrJ,EAAQwJ,GAEvBC,EAAcR,EAAiB7E,EAAQ8E,EAAUM,EADpCpH,EAAkBoH,GACuCC,EAAaJ,EAAQ,GAAK,GAEhGN,EAAyBU,EAAc,GACvCrF,EAAOqF,GAAeD,GAGxBC,KAEFC,IAEF,OAAOD,CACT,wBC/BA,IAAIG,EAAc9I,EAAQ,MAEtB+I,EAAoBC,SAASzJ,UAC7BH,EAAQ2J,EAAkB3J,MAC1BM,EAAOqJ,EAAkBrJ,KAG7BE,EAAOC,QAA4B,iBAAXoJ,SAAuBA,QAAQ7J,QAAU0J,EAAcpJ,EAAKwI,KAAK9I,GAAS,WAChG,OAAOM,EAAKN,MAAMA,EAAOR,UAC3B,yBCTA,IAAIyD,EAAcrC,EAAQ,MACtBkJ,EAAYlJ,EAAQ,MACpB8I,EAAc9I,EAAQ,MAEtBkI,EAAO7F,EAAYA,EAAY6F,MAGnCtI,EAAOC,QAAU,SAAUsJ,EAAIC,GAE7B,OADAF,EAAUC,QACMzI,IAAT0I,EAAqBD,EAAKL,EAAcZ,EAAKiB,EAAIC,GAAQ,WAC9D,OAAOD,EAAG/J,MAAMgK,EAAMxK,UACxB,CACF,wBCZA,IAAI+F,EAAQ3E,EAAQ,MAEpBJ,EAAOC,SAAW8E,GAAM,WAEtB,IAAI0E,EAAQ,WAAyB,EAAInB,OAEzC,MAAsB,mBAARmB,GAAsBA,EAAK7K,eAAe,YAC1D,0BCPA,IAAIsK,EAAc9I,EAAQ,MAEtBN,EAAOsJ,SAASzJ,UAAUG,KAE9BE,EAAOC,QAAUiJ,EAAcpJ,EAAKwI,KAAKxI,GAAQ,WAC/C,OAAOA,EAAKN,MAAMM,EAAMd,UAC1B,wBCNA,IAAIgF,EAAc5D,EAAQ,MACtBzB,EAASyB,EAAQ,MAEjB+I,EAAoBC,SAASzJ,UAE7B+J,EAAgB1F,GAAetE,OAAOqE,yBAEtCsB,EAAS1G,EAAOwK,EAAmB,QAEnCQ,EAAStE,GAA0D,cAA/C,WAAkC,EAAIX,KAC1DkF,EAAevE,KAAYrB,GAAgBA,GAAe0F,EAAcP,EAAmB,QAAQpI,cAEvGf,EAAOC,QAAU,CACfoF,OAAQA,EACRsE,OAAQA,EACRC,aAAcA,yBCfhB,IAAI9G,EAAa1C,EAAQ,MACrBqC,EAAcrC,EAAQ,MAE1BJ,EAAOC,QAAU,SAAUsJ,GAIzB,GAAuB,aAAnBzG,EAAWyG,GAAoB,OAAO9G,EAAY8G,EACxD,wBCRA,IAAIL,EAAc9I,EAAQ,MAEtB+I,EAAoBC,SAASzJ,UAC7BG,EAAOqJ,EAAkBrJ,KACzB+J,EAAsBX,GAAeC,EAAkBb,KAAKA,KAAKxI,EAAMA,GAE3EE,EAAOC,QAAUiJ,EAAcW,EAAsB,SAAUN,GAC7D,OAAO,WACL,OAAOzJ,EAAKN,MAAM+J,EAAIvK,UACxB,CACF,wBCVA,IAAI2F,EAASvE,EAAQ,MACjBD,EAAaC,EAAQ,MAMzBJ,EAAOC,QAAU,SAAU6J,EAAWC,GACpC,OAAO/K,UAAUC,OAAS,GALFuB,EAKgBmE,EAAOmF,GAJxC3J,EAAWK,GAAYA,OAAWM,GAIoB6D,EAAOmF,IAAcnF,EAAOmF,GAAWC,GALtF,IAAUvJ,CAM1B,wBCTA,IAAI8I,EAAYlJ,EAAQ,MACpB4J,EAAoB5J,EAAQ,MAIhCJ,EAAOC,QAAU,SAAUgK,EAAGC,GAC5B,IAAIC,EAAOF,EAAEC,GACb,OAAOF,EAAkBG,QAAQrJ,EAAYwI,EAAUa,EACzD,wBCRA,IAAI1H,EAAcrC,EAAQ,MACtBgK,EAAWhK,EAAQ,MAEnBiK,EAAQC,KAAKD,MACbpJ,EAASwB,EAAY,GAAGxB,QACxBsJ,EAAU9H,EAAY,GAAG8H,SACzB7H,EAAcD,EAAY,GAAGE,OAE7B6H,EAAuB,8BACvBC,EAAgC,sBAIpCzK,EAAOC,QAAU,SAAUyK,EAAS3C,EAAK4C,EAAUC,EAAUC,EAAeC,GAC1E,IAAIC,EAAUJ,EAAWD,EAAQzL,OAC7B+L,EAAIJ,EAAS3L,OACbgM,EAAUR,EAKd,YAJsB3J,IAAlB+J,IACFA,EAAgBT,EAASS,GACzBI,EAAUT,GAELD,EAAQO,EAAaG,GAAS,SAAUxF,EAAOyF,GACpD,IAAIC,EACJ,OAAQlK,EAAOiK,EAAI,IACjB,IAAK,IAAK,MAAO,IACjB,IAAK,IAAK,OAAOR,EACjB,IAAK,IAAK,OAAOhI,EAAYqF,EAAK,EAAG4C,GACrC,IAAK,IAAK,OAAOjI,EAAYqF,EAAKgD,GAClC,IAAK,IACHI,EAAUN,EAAcnI,EAAYwI,EAAI,GAAI,IAC5C,MACF,QACE,IAAIE,GAAKF,EACT,GAAU,IAANE,EAAS,OAAO3F,EACpB,GAAI2F,EAAIJ,EAAG,CACT,IAAIlH,EAAIuG,EAAMe,EAAI,IAClB,OAAU,IAANtH,EAAgB2B,EAChB3B,GAAKkH,OAA8BlK,IAApB8J,EAAS9G,EAAI,GAAmB7C,EAAOiK,EAAI,GAAKN,EAAS9G,EAAI,GAAK7C,EAAOiK,EAAI,GACzFzF,CACT,CACA0F,EAAUP,EAASQ,EAAI,GAE3B,YAAmBtK,IAAZqK,EAAwB,GAAKA,CACtC,GACF,wBC5CA,IAAIE,EAAQ,SAAUzI,GACpB,OAAOA,GAAMA,EAAG0H,MAAQA,MAAQ1H,CAClC,EAGA5C,EAAOC,QAELoL,EAA2B,iBAAdC,YAA0BA,aACvCD,EAAuB,iBAAVE,QAAsBA,SAEnCF,EAAqB,iBAARG,MAAoBA,OACjCH,EAAuB,iBAAV1G,EAAAA,GAAsBA,EAAAA,IAElC,WAAc,OAAO8G,IAAM,CAA3B,IAAmCrC,SAAS,cAATA,yBCbtC,IAAI3G,EAAcrC,EAAQ,MACtBgK,EAAWhK,EAAQ,MAEnBxB,EAAiB6D,EAAY,CAAC,EAAE7D,gBAKpCoB,EAAOC,QAAUP,OAAOf,QAAU,SAAgBiE,EAAI/C,GACpD,OAAOjB,EAAewL,EAASxH,GAAK/C,EACtC,oBCVAG,EAAOC,QAAU,CAAC,wBCAlB,IAAIyL,EAAatL,EAAQ,MAEzBJ,EAAOC,QAAUyL,EAAW,WAAY,yCCFxC,IAAI1H,EAAc5D,EAAQ,MACtB2E,EAAQ3E,EAAQ,MAChBkF,EAAgBlF,EAAQ,KAG5BJ,EAAOC,SAAW+D,IAAgBe,GAAM,WAEtC,OAEQ,GAFDrF,OAAOiB,eAAe2E,EAAc,OAAQ,IAAK,CACtDN,IAAK,WAAc,OAAO,CAAG,IAC5B2G,CACL,0BCVA,IAAIlJ,EAAcrC,EAAQ,MACtB2E,EAAQ3E,EAAQ,MAChBwL,EAAUxL,EAAQ,MAElB4C,EAAUtD,OACVqG,EAAQtD,EAAY,GAAGsD,OAG3B/F,EAAOC,QAAU8E,GAAM,WAGrB,OAAQ/B,EAAQ,KAAK6I,qBAAqB,EAC5C,IAAK,SAAUjJ,GACb,MAAsB,UAAfgJ,EAAQhJ,GAAkBmD,EAAMnD,EAAI,IAAMI,EAAQJ,EAC3D,EAAII,wBCdJ,IAAIP,EAAcrC,EAAQ,MACtBD,EAAaC,EAAQ,MACrB0L,EAAQ1L,EAAQ,MAEhB2L,EAAmBtJ,EAAY2G,SAAS3J,UAGvCU,EAAW2L,EAAME,iBACpBF,EAAME,cAAgB,SAAUpJ,GAC9B,OAAOmJ,EAAiBnJ,EAC1B,GAGF5C,EAAOC,QAAU6L,EAAME,oCCbvB,IAYIC,EAAKjH,EAAKkH,EAZVC,EAAkB/L,EAAQ,MAC1BuE,EAASvE,EAAQ,MACjBiB,EAAWjB,EAAQ,MACnB4F,EAA8B5F,EAAQ,MACtCzB,EAASyB,EAAQ,MACjBgM,EAAShM,EAAQ,MACjBiM,EAAYjM,EAAQ,MACpBkM,EAAalM,EAAQ,MAErBmM,EAA6B,6BAC7BhM,EAAYoE,EAAOpE,UACnBiM,EAAU7H,EAAO6H,QAgBrB,GAAIL,GAAmBC,EAAOK,MAAO,CACnC,IAAIX,EAAQM,EAAOK,QAAUL,EAAOK,MAAQ,IAAID,GAEhDV,EAAM9G,IAAM8G,EAAM9G,IAClB8G,EAAMI,IAAMJ,EAAMI,IAClBJ,EAAMG,IAAMH,EAAMG,IAElBA,EAAM,SAAUrJ,EAAI8J,GAClB,GAAIZ,EAAMI,IAAItJ,GAAK,MAAMrC,EAAUgM,GAGnC,OAFAG,EAASC,OAAS/J,EAClBkJ,EAAMG,IAAIrJ,EAAI8J,GACPA,CACT,EACA1H,EAAM,SAAUpC,GACd,OAAOkJ,EAAM9G,IAAIpC,IAAO,CAAC,CAC3B,EACAsJ,EAAM,SAAUtJ,GACd,OAAOkJ,EAAMI,IAAItJ,EACnB,CACF,KAAO,CACL,IAAIgK,EAAQP,EAAU,SACtBC,EAAWM,IAAS,EACpBX,EAAM,SAAUrJ,EAAI8J,GAClB,GAAI/N,EAAOiE,EAAIgK,GAAQ,MAAMrM,EAAUgM,GAGvC,OAFAG,EAASC,OAAS/J,EAClBoD,EAA4BpD,EAAIgK,EAAOF,GAChCA,CACT,EACA1H,EAAM,SAAUpC,GACd,OAAOjE,EAAOiE,EAAIgK,GAAShK,EAAGgK,GAAS,CAAC,CAC1C,EACAV,EAAM,SAAUtJ,GACd,OAAOjE,EAAOiE,EAAIgK,EACpB,CACF,CAEA5M,EAAOC,QAAU,CACfgM,IAAKA,EACLjH,IAAKA,EACLkH,IAAKA,EACLW,QArDY,SAAUjK,GACtB,OAAOsJ,EAAItJ,GAAMoC,EAAIpC,GAAMqJ,EAAIrJ,EAAI,CAAC,EACtC,EAoDEkK,UAlDc,SAAUC,GACxB,OAAO,SAAUnK,GACf,IAAI6J,EACJ,IAAKpL,EAASuB,KAAQ6J,EAAQzH,EAAIpC,IAAKoK,OAASD,EAC9C,MAAMxM,EAAU,0BAA4BwM,EAAO,aACnD,OAAON,CACX,CACF,yBCzBA,IAAIb,EAAUxL,EAAQ,MAKtBJ,EAAOC,QAAUZ,MAAMC,SAAW,SAAiBkB,GACjD,MAA4B,SAArBoL,EAAQpL,EACjB,wBCPA,IAAIyM,EAAe7M,EAAQ,MAEvB6E,EAAcgI,EAAa9H,IAI/BnF,EAAOC,QAAUgN,EAAa7H,WAAa,SAAU5E,GACnD,MAA0B,mBAAZA,GAA0BA,IAAayE,CACvD,EAAI,SAAUzE,GACZ,MAA0B,mBAAZA,CAChB,wBCVA,IAAIiC,EAAcrC,EAAQ,MACtB2E,EAAQ3E,EAAQ,MAChBD,EAAaC,EAAQ,MACrBwL,EAAUxL,EAAQ,MAClBsL,EAAatL,EAAQ,MACrB4L,EAAgB5L,EAAQ,MAExB8M,EAAO,WAAyB,EAChCC,EAAQ,GACRC,EAAY1B,EAAW,UAAW,aAClC2B,EAAoB,2BACpBvG,EAAOrE,EAAY4K,EAAkBvG,MACrCwG,GAAuBD,EAAkBvG,KAAKoG,GAE9CK,EAAsB,SAAuB/M,GAC/C,IAAKL,EAAWK,GAAW,OAAO,EAClC,IAEE,OADA4M,EAAUF,EAAMC,EAAO3M,IAChB,CACT,CAAE,MAAO4C,GACP,OAAO,CACT,CACF,EAEIoK,EAAsB,SAAuBhN,GAC/C,IAAKL,EAAWK,GAAW,OAAO,EAClC,OAAQoL,EAAQpL,IACd,IAAK,gBACL,IAAK,oBACL,IAAK,yBAA0B,OAAO,EAExC,IAIE,OAAO8M,KAAyBxG,EAAKuG,EAAmBrB,EAAcxL,GACxE,CAAE,MAAO4C,GACP,OAAO,CACT,CACF,EAEAoK,EAAoB3G,MAAO,EAI3B7G,EAAOC,SAAWmN,GAAarI,GAAM,WACnC,IAAI0I,EACJ,OAAOF,EAAoBA,EAAoBzN,QACzCyN,EAAoB7N,UACpB6N,GAAoB,WAAcE,GAAS,CAAM,KAClDA,CACP,IAAKD,EAAsBD,wBCnD3B,IAAIxI,EAAQ3E,EAAQ,MAChBD,EAAaC,EAAQ,MAErB0K,EAAc,kBAEd3E,EAAW,SAAUuH,EAASC,GAChC,IAAI3M,EAAQ4M,EAAKC,EAAUH,IAC3B,OAAO1M,GAAS8M,GACZ9M,GAAS+M,IACT5N,EAAWwN,GAAa5I,EAAM4I,KAC5BA,EACR,EAEIE,EAAY1H,EAAS0H,UAAY,SAAUG,GAC7C,OAAOzM,OAAOyM,GAAQzD,QAAQO,EAAa,KAAKmD,aAClD,EAEIL,EAAOzH,EAASyH,KAAO,CAAC,EACxBG,EAAS5H,EAAS4H,OAAS,IAC3BD,EAAW3H,EAAS2H,SAAW,IAEnC9N,EAAOC,QAAUkG,oBCnBjBnG,EAAOC,QAAU,SAAU2C,GACzB,OAAc,OAAPA,QAAsB9B,IAAP8B,CACxB,wBCJA,IAAIzC,EAAaC,EAAQ,MACrB6M,EAAe7M,EAAQ,MAEvB6E,EAAcgI,EAAa9H,IAE/BnF,EAAOC,QAAUgN,EAAa7H,WAAa,SAAUxC,GACnD,MAAoB,iBAANA,EAAwB,OAAPA,EAAczC,EAAWyC,IAAOA,IAAOqC,CACxE,EAAI,SAAUrC,GACZ,MAAoB,iBAANA,EAAwB,OAAPA,EAAczC,EAAWyC,EAC1D,oBCTA5C,EAAOC,SAAU,wBCAjB,IAAIyL,EAAatL,EAAQ,MACrBD,EAAaC,EAAQ,MACrB8N,EAAgB9N,EAAQ,MACxB+N,EAAoB/N,EAAQ,MAE5B4C,EAAUtD,OAEdM,EAAOC,QAAUkO,EAAoB,SAAUvL,GAC7C,MAAoB,iBAANA,CAChB,EAAI,SAAUA,GACZ,IAAIwL,EAAU1C,EAAW,UACzB,OAAOvL,EAAWiO,IAAYF,EAAcE,EAAQzO,UAAWqD,EAAQJ,GACzE,wBCZA,IAAIyL,EAAWjO,EAAQ,MAIvBJ,EAAOC,QAAU,SAAUqO,GACzB,OAAOD,EAASC,EAAIrP,OACtB,wBCNA,IAAIwD,EAAcrC,EAAQ,MACtB2E,EAAQ3E,EAAQ,MAChBD,EAAaC,EAAQ,MACrBzB,EAASyB,EAAQ,MACjB4D,EAAc5D,EAAQ,MACtBmO,EAA6BnO,EAAAA,MAAAA,aAC7B4L,EAAgB5L,EAAQ,MACxBoO,EAAsBpO,EAAQ,MAE9BqO,EAAuBD,EAAoB3B,QAC3C6B,EAAmBF,EAAoBxJ,IACvC1D,EAAUC,OAEVZ,EAAiBjB,OAAOiB,eACxB+B,EAAcD,EAAY,GAAGE,OAC7B4H,EAAU9H,EAAY,GAAG8H,SACzBxK,EAAO0C,EAAY,GAAG1C,MAEtB4O,EAAsB3K,IAAgBe,GAAM,WAC9C,OAAsF,IAA/EpE,GAAe,WAAyB,GAAI,SAAU,CAAEK,MAAO,IAAK/B,MAC7E,IAEI2P,EAAWrN,OAAOA,QAAQwE,MAAM,UAEhCzB,EAActE,EAAOC,QAAU,SAAUe,EAAO0D,EAAMF,GACf,YAArC9B,EAAYpB,EAAQoD,GAAO,EAAG,KAChCA,EAAO,IAAM6F,EAAQjJ,EAAQoD,GAAO,qBAAsB,MAAQ,KAEhEF,GAAWA,EAAQqK,SAAQnK,EAAO,OAASA,GAC3CF,GAAWA,EAAQsK,SAAQpK,EAAO,OAASA,KAC1C/F,EAAOqC,EAAO,SAAYuN,GAA8BvN,EAAM0D,OAASA,KACtEV,EAAarD,EAAeK,EAAO,OAAQ,CAAEA,MAAO0D,EAAM3D,cAAc,IACvEC,EAAM0D,KAAOA,GAEhBiK,GAAuBnK,GAAW7F,EAAO6F,EAAS,UAAYxD,EAAM/B,SAAWuF,EAAQuK,OACzFpO,EAAeK,EAAO,SAAU,CAAEA,MAAOwD,EAAQuK,QAEnD,IACMvK,GAAW7F,EAAO6F,EAAS,gBAAkBA,EAAQjC,YACnDyB,GAAarD,EAAeK,EAAO,YAAa,CAAEqD,UAAU,IAEvDrD,EAAMrB,YAAWqB,EAAMrB,eAAYmB,EAChD,CAAE,MAAOsC,GAAoB,CAC7B,IAAIqJ,EAAQgC,EAAqBzN,GAG/B,OAFGrC,EAAO8N,EAAO,YACjBA,EAAM9I,OAAS5D,EAAK6O,EAAyB,iBAARlK,EAAmBA,EAAO,KACxD1D,CACX,EAIAoI,SAASzJ,UAAUF,SAAW6E,GAAY,WACxC,OAAOnE,EAAWsL,OAASiD,EAAiBjD,MAAM9H,QAAUqI,EAAcP,KAC5E,GAAG,8BCrDH,IAAIuD,EAAO1E,KAAK0E,KACZ3E,EAAQC,KAAKD,MAKjBrK,EAAOC,QAAUqK,KAAK2E,OAAS,SAAeC,GAC5C,IAAI9D,GAAK8D,EACT,OAAQ9D,EAAI,EAAIf,EAAQ2E,GAAM5D,EAChC,wBCRA,IAmDI+D,EAnDAC,EAAWhP,EAAQ,MACnBiP,EAAyBjP,EAAQ,MACjCkP,EAAclP,EAAQ,MACtBkM,EAAalM,EAAQ,MACrBmP,EAAOnP,EAAQ,MACfoP,EAAwBpP,EAAQ,KAChCiM,EAAYjM,EAAQ,MAIpBqP,EAAY,YACZC,EAAS,SACTC,EAAWtD,EAAU,YAErBuD,EAAmB,WAAyB,EAE5CC,EAAY,SAAUC,GACxB,MARO,IAQKJ,EATL,IASmBI,EAAnBC,KAAwCL,EATxC,GAUT,EAGIM,EAA4B,SAAUb,GACxCA,EAAgBc,MAAMJ,EAAU,KAChCV,EAAgBe,QAChB,IAAIC,EAAOhB,EAAgBiB,aAAa1Q,OAExC,OADAyP,EAAkB,KACXgB,CACT,EAyBIE,EAAkB,WACpB,IACElB,EAAkB,IAAImB,cAAc,WACtC,CAAE,MAAOlN,GAAqB,CAC9BiN,EAAqC,oBAAZnL,SACrBA,SAASqL,QAAUpB,EACjBa,EAA0Bb,GA5BH,WAE7B,IAEIqB,EAFAC,EAASjB,EAAsB,UAC/BkB,EAAK,OAAShB,EAAS,IAU3B,OARAe,EAAOE,MAAMC,QAAU,OACvBrB,EAAKsB,YAAYJ,GAEjBA,EAAOK,IAAMvP,OAAOmP,IACpBF,EAAiBC,EAAOM,cAAc7L,UACvB8L,OACfR,EAAeP,MAAMJ,EAAU,sBAC/BW,EAAeN,QACRM,EAAeS,CACxB,CAeQC,GACFlB,EAA0Bb,GAE9B,IADA,IAAIlQ,EAASqQ,EAAYrQ,OAClBA,YAAiBoR,EAAgBZ,GAAWH,EAAYrQ,IAC/D,OAAOoR,GACT,EAEA/D,EAAWqD,IAAY,EAKvB3P,EAAOC,QAAUP,OAAOgB,QAAU,SAAgBsB,EAAGmP,GACnD,IAAIhO,EAQJ,OAPU,OAANnB,GACF4N,EAAiBH,GAAaL,EAASpN,GACvCmB,EAAS,IAAIyM,EACbA,EAAiBH,GAAa,KAE9BtM,EAAOwM,GAAY3N,GACdmB,EAASkN,SACMvP,IAAfqQ,EAA2BhO,EAASkM,EAAuBvL,EAAEX,EAAQgO,EAC9E,wBClFA,IAAInN,EAAc5D,EAAQ,MACtBgR,EAA0BhR,EAAQ,MAClCqD,EAAuBrD,EAAQ,MAC/BgP,EAAWhP,EAAQ,MACnBoB,EAAkBpB,EAAQ,MAC1BiR,EAAajR,EAAQ,MAKzBH,EAAQ6D,EAAIE,IAAgBoN,EAA0B1R,OAAO4R,iBAAmB,SAA0BtP,EAAGmP,GAC3G/B,EAASpN,GAMT,IALA,IAIInC,EAJA0R,EAAQ/P,EAAgB2P,GACxBtN,EAAOwN,EAAWF,GAClBlS,EAAS4E,EAAK5E,OACdkC,EAAQ,EAELlC,EAASkC,GAAOsC,EAAqBK,EAAE9B,EAAGnC,EAAMgE,EAAK1C,KAAUoQ,EAAM1R,IAC5E,OAAOmC,CACT,wBCnBA,IAAIgC,EAAc5D,EAAQ,MACtBoR,EAAiBpR,EAAQ,MACzBgR,EAA0BhR,EAAQ,MAClCgP,EAAWhP,EAAQ,MACnBqR,EAAgBrR,EAAQ,MAExBE,EAAaC,UAEbmR,EAAkBhS,OAAOiB,eAEzBgR,EAA4BjS,OAAOqE,yBACnC6N,EAAa,aACbhI,EAAe,eACfiI,EAAW,WAIf5R,EAAQ6D,EAAIE,EAAcoN,EAA0B,SAAwBpP,EAAGkI,EAAG4H,GAIhF,GAHA1C,EAASpN,GACTkI,EAAIuH,EAAcvH,GAClBkF,EAAS0C,GACQ,oBAAN9P,GAA0B,cAANkI,GAAqB,UAAW4H,GAAcD,KAAYC,IAAeA,EAAWD,GAAW,CAC5H,IAAIE,EAAUJ,EAA0B3P,EAAGkI,GACvC6H,GAAWA,EAAQF,KACrB7P,EAAEkI,GAAK4H,EAAW9Q,MAClB8Q,EAAa,CACX/Q,aAAc6I,KAAgBkI,EAAaA,EAAWlI,GAAgBmI,EAAQnI,GAC9ExF,WAAYwN,KAAcE,EAAaA,EAAWF,GAAcG,EAAQH,GACxEvN,UAAU,GAGhB,CAAE,OAAOqN,EAAgB1P,EAAGkI,EAAG4H,EACjC,EAAIJ,EAAkB,SAAwB1P,EAAGkI,EAAG4H,GAIlD,GAHA1C,EAASpN,GACTkI,EAAIuH,EAAcvH,GAClBkF,EAAS0C,GACLN,EAAgB,IAClB,OAAOE,EAAgB1P,EAAGkI,EAAG4H,EAC/B,CAAE,MAAO1O,GAAoB,CAC7B,GAAI,QAAS0O,GAAc,QAASA,EAAY,MAAMxR,EAAW,2BAEjE,MADI,UAAWwR,IAAY9P,EAAEkI,GAAK4H,EAAW9Q,OACtCgB,CACT,wBC1CA,IAAIgC,EAAc5D,EAAQ,MACtBN,EAAOM,EAAQ,MACf4R,EAA6B5R,EAAQ,MACrC6D,EAA2B7D,EAAQ,MACnCoB,EAAkBpB,EAAQ,MAC1BqR,EAAgBrR,EAAQ,MACxBzB,EAASyB,EAAQ,MACjBoR,EAAiBpR,EAAQ,MAGzBuR,EAA4BjS,OAAOqE,yBAIvC9D,EAAQ6D,EAAIE,EAAc2N,EAA4B,SAAkC3P,EAAGkI,GAGzF,GAFAlI,EAAIR,EAAgBQ,GACpBkI,EAAIuH,EAAcvH,GACdsH,EAAgB,IAClB,OAAOG,EAA0B3P,EAAGkI,EACtC,CAAE,MAAO9G,GAAoB,CAC7B,GAAIzE,EAAOqD,EAAGkI,GAAI,OAAOjG,GAA0BnE,EAAKkS,EAA2BlO,EAAG9B,EAAGkI,GAAIlI,EAAEkI,GACjG,wBCrBA,IAAI+H,EAAqB7R,EAAQ,MAG7BkM,EAFclM,EAAQ,MAEG8R,OAAO,SAAU,aAK9CjS,EAAQ6D,EAAIpE,OAAOyS,qBAAuB,SAA6BnQ,GACrE,OAAOiQ,EAAmBjQ,EAAGsK,EAC/B,qBCTArM,EAAQ6D,EAAIpE,OAAO0S,4CCDnB,IAAI3P,EAAcrC,EAAQ,MAE1BJ,EAAOC,QAAUwC,EAAY,CAAC,EAAEyL,qCCFhC,IAAIzL,EAAcrC,EAAQ,MACtBzB,EAASyB,EAAQ,MACjBoB,EAAkBpB,EAAQ,MAC1B6B,EAAU7B,EAAAA,KAAAA,QACVkM,EAAalM,EAAQ,MAErBhB,EAAOqD,EAAY,GAAGrD,MAE1BY,EAAOC,QAAU,SAAUiE,EAAQmO,GACjC,IAGIxS,EAHAmC,EAAIR,EAAgB0C,GACpBnF,EAAI,EACJoE,EAAS,GAEb,IAAKtD,KAAOmC,GAAIrD,EAAO2N,EAAYzM,IAAQlB,EAAOqD,EAAGnC,IAAQT,EAAK+D,EAAQtD,GAE1E,KAAOwS,EAAMpT,OAASF,GAAOJ,EAAOqD,EAAGnC,EAAMwS,EAAMtT,SAChDkD,EAAQkB,EAAQtD,IAAQT,EAAK+D,EAAQtD,IAExC,OAAOsD,CACT,wBCnBA,IAAI8O,EAAqB7R,EAAQ,MAC7BkP,EAAclP,EAAQ,MAK1BJ,EAAOC,QAAUP,OAAOmE,MAAQ,SAAc7B,GAC5C,OAAOiQ,EAAmBjQ,EAAGsN,EAC/B,mCCPA,IAAIgD,EAAwB,CAAC,EAAEzG,qBAE3B9H,EAA2BrE,OAAOqE,yBAGlCwO,EAAcxO,IAA6BuO,EAAsBxS,KAAK,CAAE,EAAG,GAAK,GAIpFG,EAAQ6D,EAAIyO,EAAc,SAA8BtI,GACtD,IAAI3D,EAAavC,EAAyB0H,KAAMxB,GAChD,QAAS3D,GAAcA,EAAWlC,UACpC,EAAIkO,wBCbJ,IAAIxS,EAAOM,EAAQ,MACfD,EAAaC,EAAQ,MACrBiB,EAAWjB,EAAQ,MAEnBE,EAAaC,UAIjBP,EAAOC,QAAU,SAAUuS,EAAOC,GAChC,IAAIlJ,EAAImJ,EACR,GAAa,WAATD,GAAqBtS,EAAWoJ,EAAKiJ,EAAM/S,YAAc4B,EAASqR,EAAM5S,EAAKyJ,EAAIiJ,IAAS,OAAOE,EACrG,GAAIvS,EAAWoJ,EAAKiJ,EAAMG,WAAatR,EAASqR,EAAM5S,EAAKyJ,EAAIiJ,IAAS,OAAOE,EAC/E,GAAa,WAATD,GAAqBtS,EAAWoJ,EAAKiJ,EAAM/S,YAAc4B,EAASqR,EAAM5S,EAAKyJ,EAAIiJ,IAAS,OAAOE,EACrG,MAAMpS,EAAW,0CACnB,wBCdA,IAAIoL,EAAatL,EAAQ,MACrBqC,EAAcrC,EAAQ,MACtBwS,EAA4BxS,EAAQ,MACpCyS,EAA8BzS,EAAQ,KACtCgP,EAAWhP,EAAQ,MAEnB8R,EAASzP,EAAY,GAAGyP,QAG5BlS,EAAOC,QAAUyL,EAAW,UAAW,YAAc,SAAiB9I,GACpE,IAAIiB,EAAO+O,EAA0B9O,EAAEsL,EAASxM,IAC5CwP,EAAwBS,EAA4B/O,EACxD,OAAOsO,EAAwBF,EAAOrO,EAAMuO,EAAsBxP,IAAOiB,CAC3E,wBCbA,IAAI/D,EAAOM,EAAQ,MACfgP,EAAWhP,EAAQ,MACnBD,EAAaC,EAAQ,MACrBwL,EAAUxL,EAAQ,MAClB2G,EAAa3G,EAAQ,MAErBE,EAAaC,UAIjBP,EAAOC,QAAU,SAAU6S,EAAG5R,GAC5B,IAAI4F,EAAOgM,EAAEhM,KACb,GAAI3G,EAAW2G,GAAO,CACpB,IAAI3D,EAASrD,EAAKgH,EAAMgM,EAAG5R,GAE3B,OADe,OAAXiC,GAAiBiM,EAASjM,GACvBA,CACT,CACA,GAAmB,WAAfyI,EAAQkH,GAAiB,OAAOhT,EAAKiH,EAAY+L,EAAG5R,GACxD,MAAMZ,EAAW,8CACnB,qCChBA,IAAIR,EAAOM,EAAQ,MACfqC,EAAcrC,EAAQ,MACtBX,EAAWW,EAAQ,MACnB2S,EAAc3S,EAAQ,MACtB4S,EAAgB5S,EAAQ,MACxBgM,EAAShM,EAAQ,MACjBM,EAASN,EAAQ,MACjBsO,EAAmBtO,EAAAA,MAAAA,IACnB6S,EAAsB7S,EAAQ,MAC9B8S,EAAkB9S,EAAQ,MAE1B+S,EAAgB/G,EAAO,wBAAyB7K,OAAO5B,UAAU4K,SACjE6I,EAAanM,OAAOtH,UAAUmH,KAC9BuM,EAAcD,EACdnS,EAASwB,EAAY,GAAGxB,QACxBgB,EAAUQ,EAAY,GAAGR,SACzBsI,EAAU9H,EAAY,GAAG8H,SACzB7H,EAAcD,EAAY,GAAGE,OAE7B2Q,EAA4B,WAC9B,IAAIC,EAAM,IACNC,EAAM,MAGV,OAFA1T,EAAKsT,EAAYG,EAAK,KACtBzT,EAAKsT,EAAYI,EAAK,KACG,IAAlBD,EAAIE,WAAqC,IAAlBD,EAAIC,SACpC,CANgC,GAQ5BC,EAAgBV,EAAcW,aAG9BC,OAAuC9S,IAAvB,OAAOgG,KAAK,IAAI,IAExBwM,GAA4BM,GAAiBF,GAAiBT,GAAuBC,KAG/FG,EAAc,SAAcrF,GAC1B,IAII7K,EAAQ0Q,EAAQJ,EAAWhO,EAAO1G,EAAGmF,EAAQ4P,EAJ7CrM,EAAKgE,KACLgB,EAAQiC,EAAiBjH,GACzBM,EAAMtI,EAASuO,GACf+F,EAAMtH,EAAMsH,IAGhB,GAAIA,EAIF,OAHAA,EAAIN,UAAYhM,EAAGgM,UACnBtQ,EAASrD,EAAKuT,EAAaU,EAAKhM,GAChCN,EAAGgM,UAAYM,EAAIN,UACZtQ,EAGT,IAAI6Q,EAASvH,EAAMuH,OACfC,EAASP,GAAiBjM,EAAGwM,OAC7BvM,EAAQ5H,EAAKiT,EAAatL,GAC1B9D,EAAS8D,EAAG9D,OACZuQ,EAAa,EACbC,EAAUpM,EA+Cd,GA7CIkM,IACFvM,EAAQ6C,EAAQ7C,EAAO,IAAK,KACC,IAAzBzF,EAAQyF,EAAO,OACjBA,GAAS,KAGXyM,EAAUzR,EAAYqF,EAAKN,EAAGgM,WAE1BhM,EAAGgM,UAAY,KAAOhM,EAAG2M,WAAa3M,EAAG2M,WAA+C,OAAlCnT,EAAO8G,EAAKN,EAAGgM,UAAY,MACnF9P,EAAS,OAASA,EAAS,IAC3BwQ,EAAU,IAAMA,EAChBD,KAIFL,EAAS,IAAI5M,OAAO,OAAStD,EAAS,IAAK+D,IAGzCkM,IACFC,EAAS,IAAI5M,OAAO,IAAMtD,EAAS,WAAY+D,IAE7C4L,IAA0BG,EAAYhM,EAAGgM,WAE7ChO,EAAQ3F,EAAKsT,EAAYa,EAASJ,EAASpM,EAAI0M,GAE3CF,EACExO,GACFA,EAAM+M,MAAQ9P,EAAY+C,EAAM+M,MAAO0B,GACvCzO,EAAM,GAAK/C,EAAY+C,EAAM,GAAIyO,GACjCzO,EAAMtE,MAAQsG,EAAGgM,UACjBhM,EAAGgM,WAAahO,EAAM,GAAGxG,QACpBwI,EAAGgM,UAAY,EACbH,GAA4B7N,IACrCgC,EAAGgM,UAAYhM,EAAG9C,OAASc,EAAMtE,MAAQsE,EAAM,GAAGxG,OAASwU,GAEzDG,GAAiBnO,GAASA,EAAMxG,OAAS,GAG3Ca,EAAKqT,EAAe1N,EAAM,GAAIoO,GAAQ,WACpC,IAAK9U,EAAI,EAAGA,EAAIC,UAAUC,OAAS,EAAGF,SACf+B,IAAjB9B,UAAUD,KAAkB0G,EAAM1G,QAAK+B,EAE/C,IAGE2E,GAASuO,EAEX,IADAvO,EAAMuO,OAAS9P,EAASxD,EAAO,MAC1B3B,EAAI,EAAGA,EAAIiV,EAAO/U,OAAQF,IAE7BmF,GADA4P,EAAQE,EAAOjV,IACF,IAAM0G,EAAMqO,EAAM,IAInC,OAAOrO,CACT,GAGFzF,EAAOC,QAAUoT,qCCnHjB,IAAIjE,EAAWhP,EAAQ,MAIvBJ,EAAOC,QAAU,WACf,IAAIuJ,EAAO4F,EAAS3D,MAChBtI,EAAS,GASb,OARIqG,EAAK6K,aAAYlR,GAAU,KAC3BqG,EAAK7E,SAAQxB,GAAU,KACvBqG,EAAK8K,aAAYnR,GAAU,KAC3BqG,EAAK4K,YAAWjR,GAAU,KAC1BqG,EAAK+K,SAAQpR,GAAU,KACvBqG,EAAKpI,UAAS+B,GAAU,KACxBqG,EAAKgL,cAAarR,GAAU,KAC5BqG,EAAKyK,SAAQ9Q,GAAU,KACpBA,CACT,wBCjBA,IAAI4B,EAAQ3E,EAAQ,MAIhBqU,EAHSrU,EAAQ,MAGA6G,OAEjByM,EAAgB3O,GAAM,WACxB,IAAI0C,EAAKgN,EAAQ,IAAK,KAEtB,OADAhN,EAAGgM,UAAY,EACW,MAAnBhM,EAAGX,KAAK,OACjB,IAII4N,EAAgBhB,GAAiB3O,GAAM,WACzC,OAAQ0P,EAAQ,IAAK,KAAKR,MAC5B,IAEIN,EAAeD,GAAiB3O,GAAM,WAExC,IAAI0C,EAAKgN,EAAQ,KAAM,MAEvB,OADAhN,EAAGgM,UAAY,EACU,MAAlBhM,EAAGX,KAAK,MACjB,IAEA9G,EAAOC,QAAU,CACf0T,aAAcA,EACde,cAAeA,EACfhB,cAAeA,yBC5BjB,IAAI3O,EAAQ3E,EAAQ,MAIhBqU,EAHSrU,EAAQ,MAGA6G,OAErBjH,EAAOC,QAAU8E,GAAM,WACrB,IAAI0C,EAAKgN,EAAQ,IAAK,KACtB,QAAShN,EAAG8M,QAAU9M,EAAGX,KAAK,OAAsB,MAAbW,EAAGC,MAC5C,0BCTA,IAAI3C,EAAQ3E,EAAQ,MAIhBqU,EAHSrU,EAAQ,MAGA6G,OAErBjH,EAAOC,QAAU8E,GAAM,WACrB,IAAI0C,EAAKgN,EAAQ,UAAW,KAC5B,MAAiC,MAA1BhN,EAAGX,KAAK,KAAKkN,OAAOrI,GACI,OAA7B,IAAIpB,QAAQ9C,EAAI,QACpB,0BCVA,IAAIuC,EAAoB5J,EAAQ,MAE5BE,EAAaC,UAIjBP,EAAOC,QAAU,SAAU2C,GACzB,GAAIoH,EAAkBpH,GAAK,MAAMtC,EAAW,wBAA0BsC,GACtE,OAAOA,CACT,wBCTA,IAAIwJ,EAAShM,EAAQ,MACjBuU,EAAMvU,EAAQ,MAEdyD,EAAOuI,EAAO,QAElBpM,EAAOC,QAAU,SAAUJ,GACzB,OAAOgE,EAAKhE,KAASgE,EAAKhE,GAAO8U,EAAI9U,GACvC,wBCPA,IAAI8E,EAASvE,EAAQ,MACjBmE,EAAuBnE,EAAQ,MAE/BwU,EAAS,qBACT9I,EAAQnH,EAAOiQ,IAAWrQ,EAAqBqQ,EAAQ,CAAC,GAE5D5U,EAAOC,QAAU6L,wBCNjB,IAAI+I,EAAUzU,EAAQ,MAClB0L,EAAQ1L,EAAQ,OAEnBJ,EAAOC,QAAU,SAAUJ,EAAKmB,GAC/B,OAAO8K,EAAMjM,KAASiM,EAAMjM,QAAiBiB,IAAVE,EAAsBA,EAAQ,CAAC,EACpE,GAAG,WAAY,IAAI5B,KAAK,CACtBsG,QAAS,SACToP,KAAMD,EAAU,OAAS,SACzBE,UAAW,+CACXC,QAAS,2DACTrR,OAAQ,8DCVV,IAAIlB,EAAcrC,EAAQ,MACtB6U,EAAsB7U,EAAQ,MAC9BX,EAAWW,EAAQ,MACnB8U,EAAyB9U,EAAQ,MAEjCa,EAASwB,EAAY,GAAGxB,QACxBkU,EAAa1S,EAAY,GAAG0S,YAC5BzS,EAAcD,EAAY,GAAGE,OAE7BhB,EAAe,SAAUyT,GAC3B,OAAO,SAAUvT,EAAOwT,GACtB,IAGIC,EAAOC,EAHPrU,EAAIzB,EAASyV,EAAuBrT,IACpC8I,EAAWsK,EAAoBI,GAC/BG,EAAOtU,EAAEjC,OAEb,OAAI0L,EAAW,GAAKA,GAAY6K,EAAaJ,EAAoB,QAAKtU,GACtEwU,EAAQH,EAAWjU,EAAGyJ,IACP,OAAU2K,EAAQ,OAAU3K,EAAW,IAAM6K,IACtDD,EAASJ,EAAWjU,EAAGyJ,EAAW,IAAM,OAAU4K,EAAS,MAC3DH,EACEnU,EAAOC,EAAGyJ,GACV2K,EACFF,EACE1S,EAAYxB,EAAGyJ,EAAUA,EAAW,GACV4K,EAAS,OAAlCD,EAAQ,OAAU,IAA0B,KACvD,CACF,EAEAtV,EAAOC,QAAU,CAGfwV,OAAQ9T,GAAa,GAGrBV,OAAQU,GAAa,yBCjCvB,IAAI+T,EAAatV,EAAQ,MACrB2E,EAAQ3E,EAAQ,MAGpBJ,EAAOC,UAAYP,OAAO0S,wBAA0BrN,GAAM,WACxD,IAAI4Q,EAASC,SAGb,OAAQrU,OAAOoU,MAAajW,OAAOiW,aAAmBC,UAEnDA,OAAO/O,MAAQ6O,GAAcA,EAAa,EAC/C,0BCZA,IAAIT,EAAsB7U,EAAQ,MAE9ByV,EAAMvL,KAAKuL,IACXC,EAAMxL,KAAKwL,IAKf9V,EAAOC,QAAU,SAAUkB,EAAOlC,GAChC,IAAI8W,EAAUd,EAAoB9T,GAClC,OAAO4U,EAAU,EAAIF,EAAIE,EAAU9W,EAAQ,GAAK6W,EAAIC,EAAS9W,EAC/D,wBCVA,IAAI+W,EAAgB5V,EAAQ,MACxB8U,EAAyB9U,EAAQ,MAErCJ,EAAOC,QAAU,SAAU2C,GACzB,OAAOoT,EAAcd,EAAuBtS,GAC9C,wBCNA,IAAIqM,EAAQ7O,EAAQ,MAIpBJ,EAAOC,QAAU,SAAUO,GACzB,IAAIyV,GAAUzV,EAEd,OAAOyV,IAAWA,GAAqB,IAAXA,EAAe,EAAIhH,EAAMgH,EACvD,wBCRA,IAAIhB,EAAsB7U,EAAQ,MAE9B0V,EAAMxL,KAAKwL,IAIf9V,EAAOC,QAAU,SAAUO,GACzB,OAAOA,EAAW,EAAIsV,EAAIb,EAAoBzU,GAAW,kBAAoB,CAC/E,wBCRA,IAAI0U,EAAyB9U,EAAQ,MAEjC4C,EAAUtD,OAIdM,EAAOC,QAAU,SAAUO,GACzB,OAAOwC,EAAQkS,EAAuB1U,GACxC,wBCRA,IAAIV,EAAOM,EAAQ,MACfiB,EAAWjB,EAAQ,MACnB8V,EAAW9V,EAAQ,MACnB+V,EAAY/V,EAAQ,MACpBgW,EAAsBhW,EAAQ,MAC9BK,EAAkBL,EAAQ,MAE1BE,EAAaC,UACb8V,EAAe5V,EAAgB,eAInCT,EAAOC,QAAU,SAAUuS,EAAOC,GAChC,IAAKpR,EAASmR,IAAU0D,EAAS1D,GAAQ,OAAOA,EAChD,IACIrP,EADAmT,EAAeH,EAAU3D,EAAO6D,GAEpC,GAAIC,EAAc,CAGhB,QAFaxV,IAAT2R,IAAoBA,EAAO,WAC/BtP,EAASrD,EAAKwW,EAAc9D,EAAOC,IAC9BpR,EAAS8B,IAAW+S,EAAS/S,GAAS,OAAOA,EAClD,MAAM7C,EAAW,0CACnB,CAEA,YADaQ,IAAT2R,IAAoBA,EAAO,UACxB2D,EAAoB5D,EAAOC,EACpC,wBCxBA,IAAI8D,EAAcnW,EAAQ,MACtB8V,EAAW9V,EAAQ,MAIvBJ,EAAOC,QAAU,SAAUO,GACzB,IAAIX,EAAM0W,EAAY/V,EAAU,UAChC,OAAO0V,EAASrW,GAAOA,EAAMA,EAAM,EACrC,wBCRA,IAGI4J,EAAO,CAAC,EAEZA,EALsBrJ,EAAQ,KAEVK,CAAgB,gBAGd,IAEtBT,EAAOC,QAA2B,eAAjBsB,OAAOkI,yBCPxB,IAAImC,EAAUxL,EAAQ,MAElBkB,EAAUC,OAEdvB,EAAOC,QAAU,SAAUO,GACzB,GAA0B,WAAtBoL,EAAQpL,GAAwB,MAAMD,UAAU,6CACpD,OAAOe,EAAQd,EACjB,oBCPA,IAAIc,EAAUC,OAEdvB,EAAOC,QAAU,SAAUO,GACzB,IACE,OAAOc,EAAQd,EACjB,CAAE,MAAO4C,GACP,MAAO,QACT,CACF,wBCRA,IAAIX,EAAcrC,EAAQ,MAEtBoW,EAAK,EACLC,EAAUnM,KAAKoM,SACfjX,EAAWgD,EAAY,GAAIhD,UAE/BO,EAAOC,QAAU,SAAUJ,GACzB,MAAO,gBAAqBiB,IAARjB,EAAoB,GAAKA,GAAO,KAAOJ,IAAW+W,EAAKC,EAAS,GACtF,wBCPA,IAAIE,EAAgBvW,EAAQ,KAE5BJ,EAAOC,QAAU0W,IACXf,OAAO/O,MACkB,iBAAnB+O,OAAOgB,+BCLnB,IAAI5S,EAAc5D,EAAQ,MACtB2E,EAAQ3E,EAAQ,MAIpBJ,EAAOC,QAAU+D,GAAee,GAAM,WAEpC,OAGgB,IAHTrF,OAAOiB,gBAAe,WAAyB,GAAI,YAAa,CACrEK,MAAO,GACPqD,UAAU,IACT1E,SACL,0BCXA,IAAIgF,EAASvE,EAAQ,MACjBD,EAAaC,EAAQ,MAErBoM,EAAU7H,EAAO6H,QAErBxM,EAAOC,QAAUE,EAAWqM,IAAY,cAAc/C,KAAKlI,OAAOiL,0BCLlE,IAAI7H,EAASvE,EAAQ,MACjBgM,EAAShM,EAAQ,MACjBzB,EAASyB,EAAQ,MACjBuU,EAAMvU,EAAQ,MACduW,EAAgBvW,EAAQ,KACxB+N,EAAoB/N,EAAQ,MAE5BwV,EAASjR,EAAOiR,OAChBiB,EAAwBzK,EAAO,OAC/B0K,EAAwB3I,EAAoByH,EAAY,KAAKA,EAASA,GAAUA,EAAOmB,eAAiBpC,EAE5G3U,EAAOC,QAAU,SAAUyE,GAKvB,OAJG/F,EAAOkY,EAAuBnS,KACjCmS,EAAsBnS,GAAQiS,GAAiBhY,EAAOiX,EAAQlR,GAC1DkR,EAAOlR,GACPoS,EAAsB,UAAYpS,IAC/BmS,EAAsBnS,EACjC,qCChBA,IAAIsS,EAAI5W,EAAQ,MACZmI,EAAmBnI,EAAQ,MAC3BkJ,EAAYlJ,EAAQ,MACpBgK,EAAWhK,EAAQ,MACnBsB,EAAoBtB,EAAQ,MAC5B6W,EAAqB7W,EAAQ,MAIjC4W,EAAE,CAAEtT,OAAQ,QAASwT,OAAO,GAAQ,CAClCC,QAAS,SAAiBC,GACxB,IAEIC,EAFArV,EAAIoI,EAASqB,MACbhD,EAAY/G,EAAkBM,GAKlC,OAHAsH,EAAU8N,IACVC,EAAIJ,EAAmBjV,EAAG,IACxB/C,OAASsJ,EAAiB8O,EAAGrV,EAAGA,EAAGyG,EAAW,EAAG,EAAG2O,EAAYpY,UAAUC,OAAS,EAAID,UAAU,QAAK8B,GACjGuW,CACT,uCClBF,IAAIL,EAAI5W,EAAQ,MACZmI,EAAmBnI,EAAQ,MAC3BgK,EAAWhK,EAAQ,MACnBsB,EAAoBtB,EAAQ,MAC5B6U,EAAsB7U,EAAQ,MAC9B6W,EAAqB7W,EAAQ,MAIjC4W,EAAE,CAAEtT,OAAQ,QAASwT,OAAO,GAAQ,CAClCI,KAAM,WACJ,IAAIC,EAAWvY,UAAUC,OAASD,UAAU,QAAK8B,EAC7CkB,EAAIoI,EAASqB,MACbhD,EAAY/G,EAAkBM,GAC9BqV,EAAIJ,EAAmBjV,EAAG,GAE9B,OADAqV,EAAEpY,OAASsJ,EAAiB8O,EAAGrV,EAAGA,EAAGyG,EAAW,OAAgB3H,IAAbyW,EAAyB,EAAItC,EAAoBsC,IAC7FF,CACT,0BChBqBjX,EAAQ,KAG/BoX,CAAiB,iCCHMpX,EAAQ,KAG/BoX,CAAiB,0CCJjB,IAAIR,EAAI5W,EAAQ,MACZ0G,EAAO1G,EAAQ,MAInB4W,EAAE,CAAEtT,OAAQ,SAAUwT,OAAO,EAAMtQ,OAAQ,IAAIE,OAASA,GAAQ,CAC9DA,KAAMA,uCCNR,IAAItH,EAAQY,EAAQ,MAChBN,EAAOM,EAAQ,MACfqC,EAAcrC,EAAQ,MACtBqX,EAAgCrX,EAAQ,MACxC2E,EAAQ3E,EAAQ,MAChBgP,EAAWhP,EAAQ,MACnBD,EAAaC,EAAQ,MACrB4J,EAAoB5J,EAAQ,MAC5B6U,EAAsB7U,EAAQ,MAC9BiO,EAAWjO,EAAQ,MACnBX,EAAWW,EAAQ,MACnB8U,EAAyB9U,EAAQ,MACjCsX,EAAqBtX,EAAQ,MAC7B+V,EAAY/V,EAAQ,MACpBuX,EAAkBvX,EAAQ,MAC1BwX,EAAaxX,EAAQ,MAGrByX,EAFkBzX,EAAQ,KAEhBK,CAAgB,WAC1BoV,EAAMvL,KAAKuL,IACXC,EAAMxL,KAAKwL,IACX5D,EAASzP,EAAY,GAAGyP,QACxB9S,EAAOqD,EAAY,GAAGrD,MACtB0Y,EAAgBrV,EAAY,GAAGR,SAC/BS,EAAcD,EAAY,GAAGE,OAQ7BoV,EAEgC,OAA3B,IAAIxN,QAAQ,IAAK,MAItByN,IACE,IAAIH,IAC6B,KAA5B,IAAIA,GAAS,IAAK,MAiB7BJ,EAA8B,WAAW,SAAUQ,EAAG9E,EAAe+E,GACnE,IAAIC,EAAoBH,EAA+C,IAAM,KAE7E,MAAO,CAGL,SAAiBI,EAAaC,GAC5B,IAAIrW,EAAIkT,EAAuBzJ,MAC3B6M,EAAWtO,EAAkBoO,QAAetX,EAAYqV,EAAUiC,EAAaP,GACnF,OAAOS,EACHxY,EAAKwY,EAAUF,EAAapW,EAAGqW,GAC/BvY,EAAKqT,EAAe1T,EAASuC,GAAIoW,EAAaC,EACpD,EAGA,SAAUrK,EAAQqK,GAChB,IAAIE,EAAKnJ,EAAS3D,MACdvK,EAAIzB,EAASuO,GAEjB,GACyB,iBAAhBqK,IAC6C,IAApDP,EAAcO,EAAcF,KACW,IAAvCL,EAAcO,EAAc,MAC5B,CACA,IAAIG,EAAMN,EAAgB/E,EAAeoF,EAAIrX,EAAGmX,GAChD,GAAIG,EAAIpQ,KAAM,OAAOoQ,EAAIxX,KAC3B,CAEA,IAAIyX,EAAoBtY,EAAWkY,GAC9BI,IAAmBJ,EAAe5Y,EAAS4Y,IAEhD,IAAI1T,EAAS4T,EAAG5T,OAChB,GAAIA,EAAQ,CACV,IAAI+T,EAAcH,EAAGnX,QACrBmX,EAAG9E,UAAY,CACjB,CAEA,IADA,IAAIkF,EAAU,KACD,CACX,IAAIxV,EAASyU,EAAWW,EAAIrX,GAC5B,GAAe,OAAXiC,EAAiB,MAGrB,GADA/D,EAAKuZ,EAASxV,IACTwB,EAAQ,MAGI,KADFlF,EAAS0D,EAAO,MACVoV,EAAG9E,UAAYiE,EAAmBxW,EAAGmN,EAASkK,EAAG9E,WAAYiF,GACpF,CAIA,IAFA,IA/EwB9V,EA+EpBgW,EAAoB,GACpBC,EAAqB,EAChB9Z,EAAI,EAAGA,EAAI4Z,EAAQ1Z,OAAQF,IAAK,CAWvC,IARA,IAAI2L,EAAUjL,GAFd0D,EAASwV,EAAQ5Z,IAEa,IAC1B4L,EAAWkL,EAAIC,EAAIb,EAAoB9R,EAAOhC,OAAQD,EAAEjC,QAAS,GACjE2L,EAAW,GAMNkO,EAAI,EAAGA,EAAI3V,EAAOlE,OAAQ6Z,IAAK1Z,EAAKwL,OA3FrC9J,KADc8B,EA4F+CO,EAAO2V,IA3FxDlW,EAAKrB,OAAOqB,IA4FhC,IAAIiI,EAAgB1H,EAAO6Q,OAC3B,GAAIyE,EAAmB,CACrB,IAAIM,EAAe7G,EAAO,CAACxH,GAAUE,EAAUD,EAAUzJ,QACnCJ,IAAlB+J,GAA6BzL,EAAK2Z,EAAclO,GACpD,IAAIC,EAAcrL,EAASD,EAAM6Y,OAAcvX,EAAWiY,GAC5D,MACEjO,EAAc6M,EAAgBjN,EAASxJ,EAAGyJ,EAAUC,EAAUC,EAAewN,GAE3E1N,GAAYkO,IACdD,GAAqBlW,EAAYxB,EAAG2X,EAAoBlO,GAAYG,EACpE+N,EAAqBlO,EAAWD,EAAQzL,OAE5C,CACA,OAAO2Z,EAAoBlW,EAAYxB,EAAG2X,EAC5C,EAEJ,KA1FqC9T,GAAM,WACzC,IAAI0C,EAAK,IAOT,OANAA,EAAGX,KAAO,WACR,IAAI3D,EAAS,GAEb,OADAA,EAAO6Q,OAAS,CAAErI,EAAG,KACdxI,CACT,EAEkC,MAA3B,GAAGoH,QAAQ9C,EAAI,OACxB,MAiFsCsQ,GAAoBC,kCCtI1D,IAAI9L,EAAMxM,OAAOC,UAAUf,eACvBoa,EAAS,IASb,SAASC,IAAU,CA4BnB,SAASC,EAAG3P,EAAI4P,EAASC,GACvB3N,KAAKlC,GAAKA,EACVkC,KAAK0N,QAAUA,EACf1N,KAAK2N,KAAOA,IAAQ,CACtB,CAaA,SAASC,EAAYC,EAASC,EAAOhQ,EAAI4P,EAASC,GAChD,GAAkB,oBAAP7P,EACT,MAAM,IAAIhJ,UAAU,mCAGtB,IAAIiZ,EAAW,IAAIN,EAAG3P,EAAI4P,GAAWG,EAASF,GAC1CK,EAAMT,EAASA,EAASO,EAAQA,EAMpC,OAJKD,EAAQI,QAAQD,GACXH,EAAQI,QAAQD,GAAKlQ,GAC1B+P,EAAQI,QAAQD,GAAO,CAACH,EAAQI,QAAQD,GAAMD,GADhBF,EAAQI,QAAQD,GAAKra,KAAKoa,IADlCF,EAAQI,QAAQD,GAAOD,EAAUF,EAAQK,gBAI7DL,CACT,CASA,SAASM,EAAWN,EAASG,GACI,MAAzBH,EAAQK,aAAoBL,EAAQI,QAAU,IAAIT,SAC5CK,EAAQI,QAAQD,EAC9B,CASA,SAASI,IACPpO,KAAKiO,QAAU,IAAIT,EACnBxN,KAAKkO,aAAe,CACtB,CAzEIja,OAAOgB,SACTuY,EAAOtZ,UAAYD,OAAOgB,OAAO,OAM5B,IAAIuY,GAASa,YAAWd,GAAS,IA2ExCa,EAAala,UAAUoa,WAAa,WAClC,IACIC,EACAtV,EAFA2N,EAAQ,GAIZ,GAA0B,IAAtB5G,KAAKkO,aAAoB,OAAOtH,EAEpC,IAAK3N,KAASsV,EAASvO,KAAKiO,QACtBxN,EAAIpM,KAAKka,EAAQtV,IAAO2N,EAAMjT,KAAK4Z,EAAStU,EAAK/B,MAAM,GAAK+B,GAGlE,OAAIhF,OAAO0S,sBACFC,EAAMH,OAAOxS,OAAO0S,sBAAsB4H,IAG5C3H,CACT,EASAwH,EAAala,UAAUsa,UAAY,SAAmBV,GACpD,IAAIE,EAAMT,EAASA,EAASO,EAAQA,EAChCW,EAAWzO,KAAKiO,QAAQD,GAE5B,IAAKS,EAAU,MAAO,GACtB,GAAIA,EAAS3Q,GAAI,MAAO,CAAC2Q,EAAS3Q,IAElC,IAAK,IAAIxK,EAAI,EAAGob,EAAID,EAASjb,OAAQmb,EAAK,IAAI/a,MAAM8a,GAAIpb,EAAIob,EAAGpb,IAC7Dqb,EAAGrb,GAAKmb,EAASnb,GAAGwK,GAGtB,OAAO6Q,CACT,EASAP,EAAala,UAAU0a,cAAgB,SAAuBd,GAC5D,IAAIE,EAAMT,EAASA,EAASO,EAAQA,EAChCU,EAAYxO,KAAKiO,QAAQD,GAE7B,OAAKQ,EACDA,EAAU1Q,GAAW,EAClB0Q,EAAUhb,OAFM,CAGzB,EASA4a,EAAala,UAAU2a,KAAO,SAAcf,EAAOgB,EAAIC,EAAIC,EAAIC,EAAIC,GACjE,IAAIlB,EAAMT,EAASA,EAASO,EAAQA,EAEpC,IAAK9N,KAAKiO,QAAQD,GAAM,OAAO,EAE/B,IAEImB,EACA7b,EAHAkb,EAAYxO,KAAKiO,QAAQD,GACzBoB,EAAM7b,UAAUC,OAIpB,GAAIgb,EAAU1Q,GAAI,CAGhB,OAFI0Q,EAAUb,MAAM3N,KAAKqP,eAAevB,EAAOU,EAAU1Q,QAAIzI,GAAW,GAEhE+Z,GACN,KAAK,EAAG,OAAOZ,EAAU1Q,GAAGzJ,KAAKma,EAAUd,UAAU,EACrD,KAAK,EAAG,OAAOc,EAAU1Q,GAAGzJ,KAAKma,EAAUd,QAASoB,IAAK,EACzD,KAAK,EAAG,OAAON,EAAU1Q,GAAGzJ,KAAKma,EAAUd,QAASoB,EAAIC,IAAK,EAC7D,KAAK,EAAG,OAAOP,EAAU1Q,GAAGzJ,KAAKma,EAAUd,QAASoB,EAAIC,EAAIC,IAAK,EACjE,KAAK,EAAG,OAAOR,EAAU1Q,GAAGzJ,KAAKma,EAAUd,QAASoB,EAAIC,EAAIC,EAAIC,IAAK,EACrE,KAAK,EAAG,OAAOT,EAAU1Q,GAAGzJ,KAAKma,EAAUd,QAASoB,EAAIC,EAAIC,EAAIC,EAAIC,IAAK,EAG3E,IAAK5b,EAAI,EAAG6b,EAAO,IAAIvb,MAAMwb,EAAK,GAAI9b,EAAI8b,EAAK9b,IAC7C6b,EAAK7b,EAAI,GAAKC,UAAUD,GAG1Bkb,EAAU1Q,GAAG/J,MAAMya,EAAUd,QAASyB,EACxC,KAAO,CACL,IACI9B,EADA7Z,EAASgb,EAAUhb,OAGvB,IAAKF,EAAI,EAAGA,EAAIE,EAAQF,IAGtB,OAFIkb,EAAUlb,GAAGqa,MAAM3N,KAAKqP,eAAevB,EAAOU,EAAUlb,GAAGwK,QAAIzI,GAAW,GAEtE+Z,GACN,KAAK,EAAGZ,EAAUlb,GAAGwK,GAAGzJ,KAAKma,EAAUlb,GAAGoa,SAAU,MACpD,KAAK,EAAGc,EAAUlb,GAAGwK,GAAGzJ,KAAKma,EAAUlb,GAAGoa,QAASoB,GAAK,MACxD,KAAK,EAAGN,EAAUlb,GAAGwK,GAAGzJ,KAAKma,EAAUlb,GAAGoa,QAASoB,EAAIC,GAAK,MAC5D,KAAK,EAAGP,EAAUlb,GAAGwK,GAAGzJ,KAAKma,EAAUlb,GAAGoa,QAASoB,EAAIC,EAAIC,GAAK,MAChE,QACE,IAAKG,EAAM,IAAK9B,EAAI,EAAG8B,EAAO,IAAIvb,MAAMwb,EAAK,GAAI/B,EAAI+B,EAAK/B,IACxD8B,EAAK9B,EAAI,GAAK9Z,UAAU8Z,GAG1BmB,EAAUlb,GAAGwK,GAAG/J,MAAMya,EAAUlb,GAAGoa,QAASyB,GAGpD,CAEA,OAAO,CACT,EAWAf,EAAala,UAAUob,GAAK,SAAYxB,EAAOhQ,EAAI4P,GACjD,OAAOE,EAAY5N,KAAM8N,EAAOhQ,EAAI4P,GAAS,EAC/C,EAWAU,EAAala,UAAUyZ,KAAO,SAAcG,EAAOhQ,EAAI4P,GACrD,OAAOE,EAAY5N,KAAM8N,EAAOhQ,EAAI4P,GAAS,EAC/C,EAYAU,EAAala,UAAUmb,eAAiB,SAAwBvB,EAAOhQ,EAAI4P,EAASC,GAClF,IAAIK,EAAMT,EAASA,EAASO,EAAQA,EAEpC,IAAK9N,KAAKiO,QAAQD,GAAM,OAAOhO,KAC/B,IAAKlC,EAEH,OADAqQ,EAAWnO,KAAMgO,GACVhO,KAGT,IAAIwO,EAAYxO,KAAKiO,QAAQD,GAE7B,GAAIQ,EAAU1Q,GAEV0Q,EAAU1Q,KAAOA,GACf6P,IAAQa,EAAUb,MAClBD,GAAWc,EAAUd,UAAYA,GAEnCS,EAAWnO,KAAMgO,OAEd,CACL,IAAK,IAAI1a,EAAI,EAAGib,EAAS,GAAI/a,EAASgb,EAAUhb,OAAQF,EAAIE,EAAQF,KAEhEkb,EAAUlb,GAAGwK,KAAOA,GACnB6P,IAASa,EAAUlb,GAAGqa,MACtBD,GAAWc,EAAUlb,GAAGoa,UAAYA,IAErCa,EAAO5a,KAAK6a,EAAUlb,IAOtBib,EAAO/a,OAAQwM,KAAKiO,QAAQD,GAAyB,IAAlBO,EAAO/a,OAAe+a,EAAO,GAAKA,EACpEJ,EAAWnO,KAAMgO,EACxB,CAEA,OAAOhO,IACT,EASAoO,EAAala,UAAUqb,mBAAqB,SAA4BzB,GACtE,IAAIE,EAUJ,OARIF,GACFE,EAAMT,EAASA,EAASO,EAAQA,EAC5B9N,KAAKiO,QAAQD,IAAMG,EAAWnO,KAAMgO,KAExChO,KAAKiO,QAAU,IAAIT,EACnBxN,KAAKkO,aAAe,GAGflO,IACT,EAKAoO,EAAala,UAAUsb,IAAMpB,EAAala,UAAUmb,eACpDjB,EAAala,UAAU0Z,YAAcQ,EAAala,UAAUob,GAK5DlB,EAAaqB,SAAWlC,EAKxBa,EAAaA,aAAeA,EAM1B7Z,EAAOC,QAAU4Z,mCCpUnB,IAGIsB,EAAiB,4BAGjBC,EAAuB,EACvBC,EAAyB,EAGzBC,EAAmB,iBAGnBC,EAAU,qBACVC,EAAW,iBACXC,EAAW,yBACXC,EAAU,mBACVC,EAAU,gBACVC,EAAW,iBACXC,EAAU,oBACVC,EAAS,6BACTC,EAAS,eACTC,EAAY,kBACZC,EAAU,gBACVC,EAAY,kBACZC,EAAa,mBACbC,EAAW,iBACXC,EAAY,kBACZC,EAAS,eACTC,EAAY,kBACZC,EAAY,kBACZC,EAAe,qBACfC,EAAa,mBAEbC,EAAiB,uBACjBC,EAAc,oBAkBdC,EAAe,8BAGfC,EAAW,mBAGXC,EAAiB,CAAC,EACtBA,EAxBiB,yBAwBYA,EAvBZ,yBAwBjBA,EAvBc,sBAuBYA,EAtBX,uBAuBfA,EAtBe,uBAsBYA,EArBZ,uBAsBfA,EArBsB,8BAqBYA,EApBlB,wBAqBhBA,EApBgB,yBAoBY,EAC5BA,EAAexB,GAAWwB,EAAevB,GACzCuB,EAAeJ,GAAkBI,EAAerB,GAChDqB,EAAeH,GAAeG,EAAepB,GAC7CoB,EAAenB,GAAYmB,EAAelB,GAC1CkB,EAAehB,GAAUgB,EAAef,GACxCe,EAAeb,GAAaa,EAAeV,GAC3CU,EAAeT,GAAUS,EAAeR,GACxCQ,EAAeL,IAAc,EAG7B,IAAIM,EAA8B,iBAAVrY,EAAAA,GAAsBA,EAAAA,GAAUA,EAAAA,EAAOjF,SAAWA,QAAUiF,EAAAA,EAGhFsY,EAA0B,iBAARzR,MAAoBA,MAAQA,KAAK9L,SAAWA,QAAU8L,KAGxE0R,EAAOF,GAAcC,GAAY7T,SAAS,cAATA,GAGjC+T,EAA4Cld,IAAYA,EAAQmd,UAAYnd,EAG5Eod,EAAaF,GAA4Cnd,IAAWA,EAAOod,UAAYpd,EAGvFsd,EAAgBD,GAAcA,EAAWpd,UAAYkd,EAGrDI,EAAcD,GAAiBN,EAAWrX,QAG1C6X,EAAY,WACd,IACE,OAAOD,GAAeA,EAAYE,SAAWF,EAAYE,QAAQ,OACnE,CAAE,MAAOC,GAAI,CACf,CAJgB,GAOZC,EAAmBH,GAAYA,EAASI,aAuD5C,SAASC,EAAUC,EAAOC,GAIxB,IAHA,IAAI5c,GAAS,EACTlC,EAAkB,MAAT6e,EAAgB,EAAIA,EAAM7e,SAE9BkC,EAAQlC,GACf,GAAI8e,EAAUD,EAAM3c,GAAQA,EAAO2c,GACjC,OAAO,EAGX,OAAO,CACT,CAiEA,SAASE,EAAWC,GAClB,IAAI9c,GAAS,EACTgC,EAAS9D,MAAM4e,EAAIzI,MAKvB,OAHAyI,EAAIC,SAAQ,SAASld,EAAOnB,GAC1BsD,IAAShC,GAAS,CAACtB,EAAKmB,EAC1B,IACOmC,CACT,CAuBA,SAASgb,EAAWlS,GAClB,IAAI9K,GAAS,EACTgC,EAAS9D,MAAM4M,EAAIuJ,MAKvB,OAHAvJ,EAAIiS,SAAQ,SAASld,GACnBmC,IAAShC,GAASH,CACpB,IACOmC,CACT,CAGA,IAxBiBgH,EAAMiU,EAwBnBC,EAAahf,MAAMM,UACnB2e,EAAYlV,SAASzJ,UACrB4e,EAAc7e,OAAOC,UAGrB6e,EAAatB,EAAK,sBAGlBuB,EAAeH,EAAU7e,SAGzBb,EAAiB2f,EAAY3f,eAG7B8f,EAAc,WAChB,IAAI/J,EAAM,SAAS7N,KAAK0X,GAAcA,EAAW3a,MAAQ2a,EAAW3a,KAAK8L,UAAY,IACrF,OAAOgF,EAAO,iBAAmBA,EAAO,EAC1C,CAHkB,GAUdgK,EAAuBJ,EAAY9e,SAGnCmf,GAAa3X,OAAO,IACtBwX,EAAa3e,KAAKlB,GAAgB2L,QA7PjB,sBA6PuC,QACvDA,QAAQ,yDAA0D,SAAW,KAI5EsU,GAASvB,EAAgBJ,EAAK2B,YAAS/d,EACvC8U,GAASsH,EAAKtH,OACdkJ,GAAa5B,EAAK4B,WAClBjT,GAAuB0S,EAAY1S,qBACnCkT,GAASV,EAAWU,OACpBC,GAAiBpJ,GAASA,GAAOqJ,iBAAcne,EAG/Coe,GAAmBxf,OAAO0S,sBAC1B+M,GAAiBN,GAASA,GAAOO,cAAWte,EAC5Cue,IAnEalV,EAmEQzK,OAAOmE,KAnETua,EAmEe1e,OAlE7B,SAASR,GACd,OAAOiL,EAAKiU,EAAUlf,GACxB,GAmEEogB,GAAWC,GAAUrC,EAAM,YAC3BsC,GAAMD,GAAUrC,EAAM,OACtBuC,GAAUF,GAAUrC,EAAM,WAC1BwC,GAAMH,GAAUrC,EAAM,OACtB1Q,GAAU+S,GAAUrC,EAAM,WAC1ByC,GAAeJ,GAAU7f,OAAQ,UAGjCkgB,GAAqBC,GAASP,IAC9BQ,GAAgBD,GAASL,IACzBO,GAAoBF,GAASJ,IAC7BO,GAAgBH,GAASH,IACzBO,GAAoBJ,GAASrT,IAG7B0T,GAActK,GAASA,GAAOjW,eAAYmB,EAC1Cqf,GAAgBD,GAAcA,GAAYvN,aAAU7R,EASxD,SAASsf,GAAKC,GACZ,IAAIlf,GAAS,EACTlC,EAAoB,MAAXohB,EAAkB,EAAIA,EAAQphB,OAG3C,IADAwM,KAAK6U,UACInf,EAAQlC,GAAQ,CACvB,IAAIshB,EAAQF,EAAQlf,GACpBsK,KAAKQ,IAAIsU,EAAM,GAAIA,EAAM,GAC3B,CACF,CA6FA,SAASC,GAAUH,GACjB,IAAIlf,GAAS,EACTlC,EAAoB,MAAXohB,EAAkB,EAAIA,EAAQphB,OAG3C,IADAwM,KAAK6U,UACInf,EAAQlC,GAAQ,CACvB,IAAIshB,EAAQF,EAAQlf,GACpBsK,KAAKQ,IAAIsU,EAAM,GAAIA,EAAM,GAC3B,CACF,CA0GA,SAASE,GAASJ,GAChB,IAAIlf,GAAS,EACTlC,EAAoB,MAAXohB,EAAkB,EAAIA,EAAQphB,OAG3C,IADAwM,KAAK6U,UACInf,EAAQlC,GAAQ,CACvB,IAAIshB,EAAQF,EAAQlf,GACpBsK,KAAKQ,IAAIsU,EAAM,GAAIA,EAAM,GAC3B,CACF,CA6FA,SAASG,GAASC,GAChB,IAAIxf,GAAS,EACTlC,EAAmB,MAAV0hB,EAAiB,EAAIA,EAAO1hB,OAGzC,IADAwM,KAAKmV,SAAW,IAAIH,KACXtf,EAAQlC,GACfwM,KAAKoV,IAAIF,EAAOxf,GAEpB,CAyCA,SAAS2f,GAAMT,GACb,IAAIzS,EAAOnC,KAAKmV,SAAW,IAAIJ,GAAUH,GACzC5U,KAAK+J,KAAO5H,EAAK4H,IACnB,CAkGA,SAASuL,GAAc/f,EAAOggB,GAC5B,IAAIC,EAAQ3hB,GAAQ0B,GAChBkgB,GAASD,GAASE,GAAYngB,GAC9BogB,GAAUH,IAAUC,GAAS9B,GAASpe,GACtCqgB,GAAUJ,IAAUC,IAAUE,GAAUxD,GAAa5c,GACrDsgB,EAAcL,GAASC,GAASE,GAAUC,EAC1Cle,EAASme,EAloBf,SAAmBlW,EAAGmW,GAIpB,IAHA,IAAIpgB,GAAS,EACTgC,EAAS9D,MAAM+L,KAEVjK,EAAQiK,GACfjI,EAAOhC,GAASogB,EAASpgB,GAE3B,OAAOgC,CACT,CA0nB6Bqe,CAAUxgB,EAAM/B,OAAQsC,QAAU,GACzDtC,EAASkE,EAAOlE,OAEpB,IAAK,IAAIY,KAAOmB,GACTggB,IAAapiB,EAAekB,KAAKkB,EAAOnB,IACvCyhB,IAEQ,UAAPzhB,GAECuhB,IAAkB,UAAPvhB,GAA0B,UAAPA,IAE9BwhB,IAAkB,UAAPxhB,GAA0B,cAAPA,GAA8B,cAAPA,IAEtD4hB,GAAQ5hB,EAAKZ,KAElBkE,EAAO/D,KAAKS,GAGhB,OAAOsD,CACT,CAUA,SAASue,GAAa5D,EAAOje,GAE3B,IADA,IAAIZ,EAAS6e,EAAM7e,OACZA,KACL,GAAI0iB,GAAG7D,EAAM7e,GAAQ,GAAIY,GACvB,OAAOZ,EAGX,OAAQ,CACV,CAyBA,SAAS2iB,GAAW5gB,GAClB,OAAa,MAATA,OACeF,IAAVE,EAAsByb,EAAeR,EAEtC+C,IAAkBA,MAAkBtf,OAAOsB,GA0arD,SAAmBA,GACjB,IAAI6gB,EAAQjjB,EAAekB,KAAKkB,EAAOge,IACnC9b,EAAMlC,EAAMge,IAEhB,IACEhe,EAAMge,SAAkBle,EACxB,IAAIghB,GAAW,CACjB,CAAE,MAAOpE,GAAI,CAEb,IAAIva,EAASwb,EAAqB7e,KAAKkB,GACnC8gB,IACED,EACF7gB,EAAMge,IAAkB9b,SAEjBlC,EAAMge,KAGjB,OAAO7b,CACT,CA3bM4e,CAAU/gB,GA4iBhB,SAAwBA,GACtB,OAAO2d,EAAqB7e,KAAKkB,EACnC,CA7iBMghB,CAAehhB,EACrB,CASA,SAASihB,GAAgBjhB,GACvB,OAAOkhB,GAAalhB,IAAU4gB,GAAW5gB,IAAUua,CACrD,CAgBA,SAAS4G,GAAYnhB,EAAOohB,EAAOC,EAASC,EAAYC,GACtD,OAAIvhB,IAAUohB,IAGD,MAATphB,GAA0B,MAATohB,IAAmBF,GAAalhB,KAAWkhB,GAAaE,GACpEphB,IAAUA,GAASohB,IAAUA,EAmBxC,SAAyBle,EAAQke,EAAOC,EAASC,EAAYE,EAAWD,GACtE,IAAIE,EAAWnjB,GAAQ4E,GACnBwe,EAAWpjB,GAAQ8iB,GACnBO,EAASF,EAAWjH,EAAWoH,GAAO1e,GACtC2e,EAASH,EAAWlH,EAAWoH,GAAOR,GAKtCU,GAHJH,EAASA,GAAUpH,EAAUW,EAAYyG,IAGhBzG,EACrB6G,GAHJF,EAASA,GAAUtH,EAAUW,EAAY2G,IAGhB3G,EACrB8G,EAAYL,GAAUE,EAE1B,GAAIG,GAAa5D,GAASlb,GAAS,CACjC,IAAKkb,GAASgD,GACZ,OAAO,EAETK,GAAW,EACXK,GAAW,CACb,CACA,GAAIE,IAAcF,EAEhB,OADAP,IAAUA,EAAQ,IAAIzB,IACd2B,GAAY7E,GAAa1Z,GAC7B+e,GAAY/e,EAAQke,EAAOC,EAASC,EAAYE,EAAWD,GAiKnE,SAAoBre,EAAQke,EAAOlf,EAAKmf,EAASC,EAAYE,EAAWD,GACtE,OAAQrf,GACN,KAAK0Z,EACH,GAAK1Y,EAAOgf,YAAcd,EAAMc,YAC3Bhf,EAAOif,YAAcf,EAAMe,WAC9B,OAAO,EAETjf,EAASA,EAAOkf,OAChBhB,EAAQA,EAAMgB,OAEhB,KAAKzG,EACH,QAAKzY,EAAOgf,YAAcd,EAAMc,aAC3BV,EAAU,IAAI1D,GAAW5a,GAAS,IAAI4a,GAAWsD,KAKxD,KAAK1G,EACL,KAAKC,EACL,KAAKK,EAGH,OAAO2F,IAAIzd,GAASke,GAEtB,KAAKxG,EACH,OAAO1X,EAAOQ,MAAQ0d,EAAM1d,MAAQR,EAAOmf,SAAWjB,EAAMiB,QAE9D,KAAKhH,EACL,KAAKE,EAIH,OAAOrY,GAAWke,EAAQ,GAE5B,KAAKrG,EACH,IAAIuH,EAAUtF,EAEhB,KAAK1B,EACH,IAAIiH,EAAYlB,EAAUjH,EAG1B,GAFAkI,IAAYA,EAAUnF,GAElBja,EAAOsR,MAAQ4M,EAAM5M,OAAS+N,EAChC,OAAO,EAGT,IAAIC,EAAUjB,EAAMvd,IAAId,GACxB,GAAIsf,EACF,OAAOA,GAAWpB,EAEpBC,GAAWhH,EAGXkH,EAAMtW,IAAI/H,EAAQke,GAClB,IAAIjf,EAAS8f,GAAYK,EAAQpf,GAASof,EAAQlB,GAAQC,EAASC,EAAYE,EAAWD,GAE1F,OADAA,EAAc,OAAEre,GACTf,EAET,KAAKqZ,EACH,GAAI2D,GACF,OAAOA,GAAcrgB,KAAKoE,IAAWic,GAAcrgB,KAAKsiB,GAG9D,OAAO,CACT,CA/NQqB,CAAWvf,EAAQke,EAAOO,EAAQN,EAASC,EAAYE,EAAWD,GAExE,KAAMF,EAAUjH,GAAuB,CACrC,IAAIsI,EAAeZ,GAAYlkB,EAAekB,KAAKoE,EAAQ,eACvDyf,EAAeZ,GAAYnkB,EAAekB,KAAKsiB,EAAO,eAE1D,GAAIsB,GAAgBC,EAAc,CAChC,IAAIC,EAAeF,EAAexf,EAAOlD,QAAUkD,EAC/C2f,EAAeF,EAAevB,EAAMphB,QAAUohB,EAGlD,OADAG,IAAUA,EAAQ,IAAIzB,IACf0B,EAAUoB,EAAcC,EAAcxB,EAASC,EAAYC,EACpE,CACF,CACA,IAAKS,EACH,OAAO,EAGT,OADAT,IAAUA,EAAQ,IAAIzB,IA6NxB,SAAsB5c,EAAQke,EAAOC,EAASC,EAAYE,EAAWD,GACnE,IAAIgB,EAAYlB,EAAUjH,EACtB0I,EAAWC,GAAW7f,GACtB8f,EAAYF,EAAS7kB,OACrBglB,EAAWF,GAAW3B,GACtB8B,EAAYD,EAAShlB,OAEzB,GAAI+kB,GAAaE,IAAcX,EAC7B,OAAO,EAET,IAAIpiB,EAAQ6iB,EACZ,KAAO7iB,KAAS,CACd,IAAItB,EAAMikB,EAAS3iB,GACnB,KAAMoiB,EAAY1jB,KAAOuiB,EAAQxjB,EAAekB,KAAKsiB,EAAOviB,IAC1D,OAAO,CAEX,CAEA,IAAI2jB,EAAUjB,EAAMvd,IAAId,GACxB,GAAIsf,GAAWjB,EAAMvd,IAAIod,GACvB,OAAOoB,GAAWpB,EAEpB,IAAIjf,GAAS,EACbof,EAAMtW,IAAI/H,EAAQke,GAClBG,EAAMtW,IAAImW,EAAOle,GAEjB,IAAIigB,EAAWZ,EACf,OAASpiB,EAAQ6iB,GAAW,CAE1B,IAAII,EAAWlgB,EADfrE,EAAMikB,EAAS3iB,IAEXkjB,EAAWjC,EAAMviB,GAErB,GAAIyiB,EACF,IAAIgC,EAAWf,EACXjB,EAAW+B,EAAUD,EAAUvkB,EAAKuiB,EAAOle,EAAQqe,GACnDD,EAAW8B,EAAUC,EAAUxkB,EAAKqE,EAAQke,EAAOG,GAGzD,UAAmBzhB,IAAbwjB,EACGF,IAAaC,GAAY7B,EAAU4B,EAAUC,EAAUhC,EAASC,EAAYC,GAC7E+B,GACD,CACLnhB,GAAS,EACT,KACF,CACAghB,IAAaA,EAAkB,eAAPtkB,EAC1B,CACA,GAAIsD,IAAWghB,EAAU,CACvB,IAAII,EAAUrgB,EAAO3B,YACjBiiB,EAAUpC,EAAM7f,YAGhBgiB,GAAWC,KACV,gBAAiBtgB,MAAU,gBAAiBke,IACzB,mBAAXmC,GAAyBA,aAAmBA,GACjC,mBAAXC,GAAyBA,aAAmBA,IACvDrhB,GAAS,EAEb,CAGA,OAFAof,EAAc,OAAEre,GAChBqe,EAAc,OAAEH,GACTjf,CACT,CA1RSshB,CAAavgB,EAAQke,EAAOC,EAASC,EAAYE,EAAWD,EACrE,CA5DSmC,CAAgB1jB,EAAOohB,EAAOC,EAASC,EAAYH,GAAaI,GACzE,CAqEA,SAASoC,GAAa3jB,GACpB,SAAKK,GAASL,IAwahB,SAAkBmJ,GAChB,QAASuU,GAAeA,KAAcvU,CACxC,CA1a0Bya,CAAS5jB,MAGnB6jB,GAAW7jB,GAAS4d,GAAa/B,GAChCpT,KAAKoW,GAAS7e,GAC/B,CAqBA,SAAS8jB,GAAS5gB,GAChB,IAwZF,SAAqBlD,GACnB,IAAI+jB,EAAO/jB,GAASA,EAAMuB,YACtB2U,EAAwB,mBAAR6N,GAAsBA,EAAKplB,WAAc4e,EAE7D,OAAOvd,IAAUkW,CACnB,CA7ZO8N,CAAY9gB,GACf,OAAOmb,GAAWnb,GAEpB,IAAIf,EAAS,GACb,IAAK,IAAItD,KAAOH,OAAOwE,GACjBtF,EAAekB,KAAKoE,EAAQrE,IAAe,eAAPA,GACtCsD,EAAO/D,KAAKS,GAGhB,OAAOsD,CACT,CAeA,SAAS8f,GAAYnF,EAAOsE,EAAOC,EAASC,EAAYE,EAAWD,GACjE,IAAIgB,EAAYlB,EAAUjH,EACtB6J,EAAYnH,EAAM7e,OAClBilB,EAAY9B,EAAMnjB,OAEtB,GAAIgmB,GAAaf,KAAeX,GAAaW,EAAYe,GACvD,OAAO,EAGT,IAAIzB,EAAUjB,EAAMvd,IAAI8Y,GACxB,GAAI0F,GAAWjB,EAAMvd,IAAIod,GACvB,OAAOoB,GAAWpB,EAEpB,IAAIjhB,GAAS,EACTgC,GAAS,EACT+hB,EAAQ7C,EAAUhH,EAA0B,IAAIqF,QAAW5f,EAM/D,IAJAyhB,EAAMtW,IAAI6R,EAAOsE,GACjBG,EAAMtW,IAAImW,EAAOtE,KAGR3c,EAAQ8jB,GAAW,CAC1B,IAAIE,EAAWrH,EAAM3c,GACjBkjB,EAAWjC,EAAMjhB,GAErB,GAAImhB,EACF,IAAIgC,EAAWf,EACXjB,EAAW+B,EAAUc,EAAUhkB,EAAOihB,EAAOtE,EAAOyE,GACpDD,EAAW6C,EAAUd,EAAUljB,EAAO2c,EAAOsE,EAAOG,GAE1D,QAAiBzhB,IAAbwjB,EAAwB,CAC1B,GAAIA,EACF,SAEFnhB,GAAS,EACT,KACF,CAEA,GAAI+hB,GACF,IAAKrH,EAAUuE,GAAO,SAASiC,EAAUe,GACnC,GA72BavlB,EA62BOulB,GAANF,EA52BXhZ,IAAIrM,KA62BFslB,IAAad,GAAY7B,EAAU2C,EAAUd,EAAUhC,EAASC,EAAYC,IAC/E,OAAO2C,EAAK9lB,KAAKgmB,GA/2B/B,IAAyBvlB,CAi3Bf,IAAI,CACNsD,GAAS,EACT,KACF,OACK,GACDgiB,IAAad,IACX7B,EAAU2C,EAAUd,EAAUhC,EAASC,EAAYC,GACpD,CACLpf,GAAS,EACT,KACF,CACF,CAGA,OAFAof,EAAc,OAAEzE,GAChByE,EAAc,OAAEH,GACTjf,CACT,CAwKA,SAAS4gB,GAAW7f,GAClB,OApZF,SAAwBA,EAAQmhB,EAAUC,GACxC,IAAIniB,EAASkiB,EAASnhB,GACtB,OAAO5E,GAAQ4E,GAAUf,EAhuB3B,SAAmB2a,EAAO6C,GAKxB,IAJA,IAAIxf,GAAS,EACTlC,EAAS0hB,EAAO1hB,OAChBsmB,EAASzH,EAAM7e,SAEVkC,EAAQlC,GACf6e,EAAMyH,EAASpkB,GAASwf,EAAOxf,GAEjC,OAAO2c,CACT,CAutBoC0H,CAAUriB,EAAQmiB,EAAYphB,GAClE,CAiZSuhB,CAAevhB,EAAQL,GAAM6hB,GACtC,CAUA,SAASC,GAAW1H,EAAKpe,GACvB,IAAI+N,EAAOqQ,EAAI2C,SACf,OAqHF,SAAmB5f,GACjB,IAAIgM,SAAchM,EAClB,MAAgB,UAARgM,GAA4B,UAARA,GAA4B,UAARA,GAA4B,WAARA,EACrD,cAAVhM,EACU,OAAVA,CACP,CA1HS4kB,CAAU/lB,GACb+N,EAAmB,iBAAP/N,EAAkB,SAAW,QACzC+N,EAAKqQ,GACX,CAUA,SAASsB,GAAUrb,EAAQrE,GACzB,IAAImB,EAxjCN,SAAkBkD,EAAQrE,GACxB,OAAiB,MAAVqE,OAAiBpD,EAAYoD,EAAOrE,EAC7C,CAsjCcgmB,CAAS3hB,EAAQrE,GAC7B,OAAO8kB,GAAa3jB,GAASA,OAAQF,CACvC,CAr2BAsf,GAAKzgB,UAAU2gB,MAvEf,WACE7U,KAAKmV,SAAWjB,GAAeA,GAAa,MAAQ,CAAC,EACrDlU,KAAK+J,KAAO,CACd,EAqEA4K,GAAKzgB,UAAkB,OAzDvB,SAAoBE,GAClB,IAAIsD,EAASsI,KAAKS,IAAIrM,WAAe4L,KAAKmV,SAAS/gB,GAEnD,OADA4L,KAAK+J,MAAQrS,EAAS,EAAI,EACnBA,CACT,EAsDAid,GAAKzgB,UAAUqF,IA3Cf,SAAiBnF,GACf,IAAI+N,EAAOnC,KAAKmV,SAChB,GAAIjB,GAAc,CAChB,IAAIxc,EAASyK,EAAK/N,GAClB,OAAOsD,IAAWgY,OAAiBra,EAAYqC,CACjD,CACA,OAAOvE,EAAekB,KAAK8N,EAAM/N,GAAO+N,EAAK/N,QAAOiB,CACtD,EAqCAsf,GAAKzgB,UAAUuM,IA1Bf,SAAiBrM,GACf,IAAI+N,EAAOnC,KAAKmV,SAChB,OAAOjB,QAA8B7e,IAAd8M,EAAK/N,GAAsBjB,EAAekB,KAAK8N,EAAM/N,EAC9E,EAwBAugB,GAAKzgB,UAAUsM,IAZf,SAAiBpM,EAAKmB,GACpB,IAAI4M,EAAOnC,KAAKmV,SAGhB,OAFAnV,KAAK+J,MAAQ/J,KAAKS,IAAIrM,GAAO,EAAI,EACjC+N,EAAK/N,GAAQ8f,SAA0B7e,IAAVE,EAAuBma,EAAiBna,EAC9DyK,IACT,EAsHA+U,GAAU7gB,UAAU2gB,MApFpB,WACE7U,KAAKmV,SAAW,GAChBnV,KAAK+J,KAAO,CACd,EAkFAgL,GAAU7gB,UAAkB,OAvE5B,SAAyBE,GACvB,IAAI+N,EAAOnC,KAAKmV,SACZzf,EAAQugB,GAAa9T,EAAM/N,GAE/B,QAAIsB,EAAQ,KAIRA,GADYyM,EAAK3O,OAAS,EAE5B2O,EAAKkY,MAEL/G,GAAOjf,KAAK8N,EAAMzM,EAAO,KAEzBsK,KAAK+J,MACA,EACT,EAyDAgL,GAAU7gB,UAAUqF,IA9CpB,SAAsBnF,GACpB,IAAI+N,EAAOnC,KAAKmV,SACZzf,EAAQugB,GAAa9T,EAAM/N,GAE/B,OAAOsB,EAAQ,OAAIL,EAAY8M,EAAKzM,GAAO,EAC7C,EA0CAqf,GAAU7gB,UAAUuM,IA/BpB,SAAsBrM,GACpB,OAAO6hB,GAAajW,KAAKmV,SAAU/gB,IAAQ,CAC7C,EA8BA2gB,GAAU7gB,UAAUsM,IAlBpB,SAAsBpM,EAAKmB,GACzB,IAAI4M,EAAOnC,KAAKmV,SACZzf,EAAQugB,GAAa9T,EAAM/N,GAQ/B,OANIsB,EAAQ,KACRsK,KAAK+J,KACP5H,EAAKxO,KAAK,CAACS,EAAKmB,KAEhB4M,EAAKzM,GAAO,GAAKH,EAEZyK,IACT,EAwGAgV,GAAS9gB,UAAU2gB,MAtEnB,WACE7U,KAAK+J,KAAO,EACZ/J,KAAKmV,SAAW,CACd,KAAQ,IAAIR,GACZ,IAAO,IAAKZ,IAAOgB,IACnB,OAAU,IAAIJ,GAElB,EAgEAK,GAAS9gB,UAAkB,OArD3B,SAAwBE,GACtB,IAAIsD,EAASwiB,GAAWla,KAAM5L,GAAa,OAAEA,GAE7C,OADA4L,KAAK+J,MAAQrS,EAAS,EAAI,EACnBA,CACT,EAkDAsd,GAAS9gB,UAAUqF,IAvCnB,SAAqBnF,GACnB,OAAO8lB,GAAWla,KAAM5L,GAAKmF,IAAInF,EACnC,EAsCA4gB,GAAS9gB,UAAUuM,IA3BnB,SAAqBrM,GACnB,OAAO8lB,GAAWla,KAAM5L,GAAKqM,IAAIrM,EACnC,EA0BA4gB,GAAS9gB,UAAUsM,IAdnB,SAAqBpM,EAAKmB,GACxB,IAAI4M,EAAO+X,GAAWla,KAAM5L,GACxB2V,EAAO5H,EAAK4H,KAIhB,OAFA5H,EAAK3B,IAAIpM,EAAKmB,GACdyK,KAAK+J,MAAQ5H,EAAK4H,MAAQA,EAAO,EAAI,EAC9B/J,IACT,EAwDAiV,GAAS/gB,UAAUkhB,IAAMH,GAAS/gB,UAAUP,KAnB5C,SAAqB4B,GAEnB,OADAyK,KAAKmV,SAAS3U,IAAIjL,EAAOma,GAClB1P,IACT,EAiBAiV,GAAS/gB,UAAUuM,IANnB,SAAqBlL,GACnB,OAAOyK,KAAKmV,SAAS1U,IAAIlL,EAC3B,EAoGA8f,GAAMnhB,UAAU2gB,MA3EhB,WACE7U,KAAKmV,SAAW,IAAIJ,GACpB/U,KAAK+J,KAAO,CACd,EAyEAsL,GAAMnhB,UAAkB,OA9DxB,SAAqBE,GACnB,IAAI+N,EAAOnC,KAAKmV,SACZzd,EAASyK,EAAa,OAAE/N,GAG5B,OADA4L,KAAK+J,KAAO5H,EAAK4H,KACVrS,CACT,EAyDA2d,GAAMnhB,UAAUqF,IA9ChB,SAAkBnF,GAChB,OAAO4L,KAAKmV,SAAS5b,IAAInF,EAC3B,EA6CAihB,GAAMnhB,UAAUuM,IAlChB,SAAkBrM,GAChB,OAAO4L,KAAKmV,SAAS1U,IAAIrM,EAC3B,EAiCAihB,GAAMnhB,UAAUsM,IArBhB,SAAkBpM,EAAKmB,GACrB,IAAI4M,EAAOnC,KAAKmV,SAChB,GAAIhT,aAAgB4S,GAAW,CAC7B,IAAIuF,EAAQnY,EAAKgT,SACjB,IAAKpB,IAAQuG,EAAM9mB,OAAS+mB,IAG1B,OAFAD,EAAM3mB,KAAK,CAACS,EAAKmB,IACjByK,KAAK+J,OAAS5H,EAAK4H,KACZ/J,KAETmC,EAAOnC,KAAKmV,SAAW,IAAIH,GAASsF,EACtC,CAGA,OAFAnY,EAAK3B,IAAIpM,EAAKmB,GACdyK,KAAK+J,KAAO5H,EAAK4H,KACV/J,IACT,EA8hBA,IAAIia,GAAcxG,GAA+B,SAAShb,GACxD,OAAc,MAAVA,EACK,IAETA,EAASxE,OAAOwE,GA9sClB,SAAqB4Z,EAAOC,GAM1B,IALA,IAAI5c,GAAS,EACTlC,EAAkB,MAAT6e,EAAgB,EAAIA,EAAM7e,OACnCgnB,EAAW,EACX9iB,EAAS,KAEJhC,EAAQlC,GAAQ,CACvB,IAAI+B,EAAQ8c,EAAM3c,GACd4c,EAAU/c,EAAOG,EAAO2c,KAC1B3a,EAAO8iB,KAAcjlB,EAEzB,CACA,OAAOmC,CACT,CAksCS+iB,CAAYhH,GAAiBhb,IAAS,SAASyR,GACpD,OAAO9J,GAAqB/L,KAAKoE,EAAQyR,EAC3C,IACF,EAodA,WACE,MAAO,EACT,EA7cIiN,GAAShB,GAkCb,SAASH,GAAQzgB,EAAO/B,GAEtB,SADAA,EAAmB,MAAVA,EAAiBqc,EAAmBrc,KAE1B,iBAAT+B,GAAqB8b,EAASrT,KAAKzI,KAC1CA,GAAS,GAAKA,EAAQ,GAAK,GAAKA,EAAQ/B,CAC7C,CA2DA,SAAS4gB,GAAS1V,GAChB,GAAY,MAARA,EAAc,CAChB,IACE,OAAOsU,EAAa3e,KAAKqK,EAC3B,CAAE,MAAOuT,GAAI,CACb,IACE,OAAQvT,EAAO,EACjB,CAAE,MAAOuT,GAAI,CACf,CACA,MAAO,EACT,CAkCA,SAASiE,GAAG3gB,EAAOohB,GACjB,OAAOphB,IAAUohB,GAAUphB,IAAUA,GAASohB,IAAUA,CAC1D,EA7IK9C,IAAYsD,GAAO,IAAItD,GAAS,IAAI6G,YAAY,MAAQvJ,GACxD4C,IAAOoD,GAAO,IAAIpD,KAAQzD,GAC1B0D,IAAWmD,GAAOnD,GAAQ2G,YAAcjK,GACxCuD,IAAOkD,GAAO,IAAIlD,KAAQpD,GAC1B9P,IAAWoW,GAAO,IAAIpW,KAAYkQ,KACrCkG,GAAS,SAAS5hB,GAChB,IAAImC,EAASye,GAAW5gB,GACpB+jB,EAAO5hB,GAAU+Y,EAAYlb,EAAMuB,iBAAczB,EACjDulB,EAAatB,EAAOlF,GAASkF,GAAQ,GAEzC,GAAIsB,EACF,OAAQA,GACN,KAAKzG,GAAoB,OAAOhD,EAChC,KAAKkD,GAAe,OAAO/D,EAC3B,KAAKgE,GAAmB,OAAO5D,EAC/B,KAAK6D,GAAe,OAAO1D,EAC3B,KAAK2D,GAAmB,OAAOvD,EAGnC,OAAOvZ,CACT,GA6IF,IAAIge,GAAcc,GAAgB,WAAa,OAAOjjB,SAAW,CAA/B,IAAsCijB,GAAkB,SAASjhB,GACjG,OAAOkhB,GAAalhB,IAAUpC,EAAekB,KAAKkB,EAAO,YACtD6K,GAAqB/L,KAAKkB,EAAO,SACtC,EAyBI1B,GAAUD,MAAMC,QAgDpB,IAAI8f,GAAWD,IA4Of,WACE,OAAO,CACT,EA3LA,SAAS0F,GAAW7jB,GAClB,IAAKK,GAASL,GACZ,OAAO,EAIT,IAAIkC,EAAM0e,GAAW5gB,GACrB,OAAOkC,GAAO2Y,GAAW3Y,GAAO4Y,GAAU5Y,GAAOuY,GAAYvY,GAAOkZ,CACtE,CA4BA,SAASkK,GAAStlB,GAChB,MAAuB,iBAATA,GACZA,GAAS,GAAKA,EAAQ,GAAK,GAAKA,GAASsa,CAC7C,CA2BA,SAASja,GAASL,GAChB,IAAIgM,SAAchM,EAClB,OAAgB,MAATA,IAA0B,UAARgM,GAA4B,YAARA,EAC/C,CA0BA,SAASkV,GAAalhB,GACpB,OAAgB,MAATA,GAAiC,iBAATA,CACjC,CAmBA,IAAI4c,GAAeD,EAhiDnB,SAAmBxT,GACjB,OAAO,SAASnJ,GACd,OAAOmJ,EAAKnJ,EACd,CACF,CA4hDsCulB,CAAU5I,GAnvBhD,SAA0B3c,GACxB,OAAOkhB,GAAalhB,IAClBslB,GAAStlB,EAAM/B,WAAa8d,EAAe6E,GAAW5gB,GAC1D,EA8wBA,SAAS6C,GAAKK,GACZ,OA1NgB,OADGlD,EA2NAkD,IA1NKoiB,GAAStlB,EAAM/B,UAAY4lB,GAAW7jB,GA0NjC+f,GAAc7c,GAAU4gB,GAAS5gB,GA3NhE,IAAqBlD,CA4NrB,CAyCAhB,EAAOC,QAlNP,SAAiBe,EAAOohB,GACtB,OAAOD,GAAYnhB,EAAOohB,EAC5B,wBC7lDA,IAAIoE,EAAkB,sBAGlBC,EAAM,IAGNjK,EAAY,kBAGZkK,EAAS,aAGTC,EAAa,qBAGbC,EAAa,aAGbC,EAAY,cAGZC,EAAeC,SAGf/J,EAA8B,iBAAVrY,EAAAA,GAAsBA,EAAAA,GAAUA,EAAAA,EAAOjF,SAAWA,QAAUiF,EAAAA,EAGhFsY,EAA0B,iBAARzR,MAAoBA,MAAQA,KAAK9L,SAAWA,QAAU8L,KAGxE0R,EAAOF,GAAcC,GAAY7T,SAAS,cAATA,GAUjC4Y,EAPctiB,OAAOC,UAOQF,SAG7BunB,EAAY1c,KAAKuL,IACjBoR,EAAY3c,KAAKwL,IAkBjBoR,EAAM,WACR,OAAOhK,EAAKiK,KAAKD,KACnB,EAwDA,SAASE,EAASjd,EAAMkd,EAAM7iB,GAC5B,IAAI8iB,EACAC,EACAC,EACArkB,EACAskB,EACAC,EACAC,EAAiB,EACjBC,GAAU,EACVC,GAAS,EACTC,GAAW,EAEf,GAAmB,mBAAR3d,EACT,MAAM,IAAI5J,UAAUimB,GAUtB,SAASuB,EAAWC,GAClB,IAAIpN,EAAO0M,EACPze,EAAU0e,EAKd,OAHAD,EAAWC,OAAWzmB,EACtB6mB,EAAiBK,EACjB7kB,EAASgH,EAAK3K,MAAMqJ,EAAS+R,EAE/B,CAmBA,SAASqN,EAAaD,GACpB,IAAIE,EAAoBF,EAAON,EAM/B,YAAyB5mB,IAAjB4mB,GAA+BQ,GAAqBb,GACzDa,EAAoB,GAAOL,GANJG,EAAOL,GAM8BH,CACjE,CAEA,SAASW,IACP,IAAIH,EAAOd,IACX,GAAIe,EAAaD,GACf,OAAOI,EAAaJ,GAGtBP,EAAUY,WAAWF,EAzBvB,SAAuBH,GACrB,IAEI7kB,EAASkkB,GAFWW,EAAON,GAI/B,OAAOG,EAASZ,EAAU9jB,EAAQqkB,GAHRQ,EAAOL,IAGkCxkB,CACrE,CAmBqCmlB,CAAcN,GACnD,CAEA,SAASI,EAAaJ,GAKpB,OAJAP,OAAU3mB,EAINgnB,GAAYR,EACPS,EAAWC,IAEpBV,EAAWC,OAAWzmB,EACfqC,EACT,CAcA,SAASolB,IACP,IAAIP,EAAOd,IACPsB,EAAaP,EAAaD,GAM9B,GAJAV,EAAWtoB,UACXuoB,EAAW9b,KACXic,EAAeM,EAEXQ,EAAY,CACd,QAAgB1nB,IAAZ2mB,EACF,OAvEN,SAAqBO,GAMnB,OAJAL,EAAiBK,EAEjBP,EAAUY,WAAWF,EAAcd,GAE5BO,EAAUG,EAAWC,GAAQ7kB,CACtC,CAgEaslB,CAAYf,GAErB,GAAIG,EAGF,OADAJ,EAAUY,WAAWF,EAAcd,GAC5BU,EAAWL,EAEtB,CAIA,YAHgB5mB,IAAZ2mB,IACFA,EAAUY,WAAWF,EAAcd,IAE9BlkB,CACT,CAGA,OAxGAkkB,EAAOqB,EAASrB,IAAS,EACrBhmB,EAASmD,KACXojB,IAAYpjB,EAAQojB,QAEpBJ,GADAK,EAAS,YAAarjB,GACHwiB,EAAU0B,EAASlkB,EAAQgjB,UAAY,EAAGH,GAAQG,EACrEM,EAAW,aAActjB,IAAYA,EAAQsjB,SAAWA,GAiG1DS,EAAUI,OAnCV,gBACkB7nB,IAAZ2mB,GACFmB,aAAanB,GAEfE,EAAiB,EACjBL,EAAWI,EAAeH,EAAWE,OAAU3mB,CACjD,EA8BAynB,EAAUM,MA5BV,WACE,YAAmB/nB,IAAZ2mB,EAAwBtkB,EAASilB,EAAalB,IACvD,EA2BOqB,CACT,CAyFA,SAASlnB,EAASL,GAChB,IAAIgM,SAAchM,EAClB,QAASA,IAAkB,UAARgM,GAA4B,YAARA,EACzC,CA2EA,SAAS0b,EAAS1nB,GAChB,GAAoB,iBAATA,EACT,OAAOA,EAET,GAhCF,SAAkBA,GAChB,MAAuB,iBAATA,GAtBhB,SAAsBA,GACpB,QAASA,GAAyB,iBAATA,CAC3B,CAqBKkhB,CAAalhB,IAAUghB,EAAeliB,KAAKkB,IAAUwb,CAC1D,CA6BMtG,CAASlV,GACX,OAAOylB,EAET,GAAIplB,EAASL,GAAQ,CACnB,IAAIohB,EAAgC,mBAAjBphB,EAAM2R,QAAwB3R,EAAM2R,UAAY3R,EACnEA,EAAQK,EAAS+gB,GAAUA,EAAQ,GAAMA,CAC3C,CACA,GAAoB,iBAATphB,EACT,OAAiB,IAAVA,EAAcA,GAASA,EAEhCA,EAAQA,EAAMuJ,QAAQmc,EAAQ,IAC9B,IAAIoC,EAAWlC,EAAWnd,KAAKzI,GAC/B,OAAQ8nB,GAAYjC,EAAUpd,KAAKzI,GAC/B8lB,EAAa9lB,EAAM2B,MAAM,GAAImmB,EAAW,EAAI,GAC3CnC,EAAWld,KAAKzI,GAASylB,GAAOzlB,CACvC,CAEAhB,EAAOC,QA9IP,SAAkBkK,EAAMkd,EAAM7iB,GAC5B,IAAIojB,GAAU,EACVE,GAAW,EAEf,GAAmB,mBAAR3d,EACT,MAAM,IAAI5J,UAAUimB,GAMtB,OAJInlB,EAASmD,KACXojB,EAAU,YAAapjB,IAAYA,EAAQojB,QAAUA,EACrDE,EAAW,aAActjB,IAAYA,EAAQsjB,SAAWA,GAEnDV,EAASjd,EAAMkd,EAAM,CAC1B,QAAWO,EACX,QAAWP,EACX,SAAYS,GAEhB,wBC9SA,IAAI9B,EAAmB,IAGnB7K,EAAiB,4BAMjBU,EAAU,oBACVC,EAAS,6BASTe,EAAe,8BAGfG,EAA8B,iBAAVrY,EAAAA,GAAsBA,EAAAA,GAAUA,EAAAA,EAAOjF,SAAWA,QAAUiF,EAAAA,EAGhFsY,EAA0B,iBAARzR,MAAoBA,MAAQA,KAAK9L,SAAWA,QAAU8L,KAGxE0R,EAAOF,GAAcC,GAAY7T,SAAS,cAATA,GAWrC,SAAS2f,EAAcjL,EAAO9c,GAE5B,SADa8c,EAAQA,EAAM7e,OAAS,IAyDtC,SAAqB6e,EAAO9c,EAAOe,GACjC,GAAIf,IAAUA,EACZ,OAvBJ,SAAuB8c,EAAOC,EAAWhc,EAAWinB,GAClD,IAAI/pB,EAAS6e,EAAM7e,OACfkC,EAAQY,GAAainB,EAAY,GAAK,GAE1C,KAAQA,EAAY7nB,MAAYA,EAAQlC,GACtC,GAAI8e,EAAUD,EAAM3c,GAAQA,EAAO2c,GACjC,OAAO3c,EAGX,OAAQ,CACV,CAaW8nB,CAAcnL,EAAOoL,EAAWnnB,GAEzC,IAAIZ,EAAQY,EAAY,EACpB9C,EAAS6e,EAAM7e,OAEnB,OAASkC,EAAQlC,GACf,GAAI6e,EAAM3c,KAAWH,EACnB,OAAOG,EAGX,OAAQ,CACV,CArEqBgoB,CAAYrL,EAAO9c,EAAO,IAAM,CACrD,CAWA,SAASooB,EAAkBtL,EAAO9c,EAAOqoB,GAIvC,IAHA,IAAIloB,GAAS,EACTlC,EAAS6e,EAAQA,EAAM7e,OAAS,IAE3BkC,EAAQlC,GACf,GAAIoqB,EAAWroB,EAAO8c,EAAM3c,IAC1B,OAAO,EAGX,OAAO,CACT,CAwDA,SAAS+nB,EAAUloB,GACjB,OAAOA,IAAUA,CACnB,CAUA,SAASsoB,EAASC,EAAO1pB,GACvB,OAAO0pB,EAAMrd,IAAIrM,EACnB,CAwCA,SAASse,EAAWlS,GAClB,IAAI9K,GAAS,EACTgC,EAAS9D,MAAM4M,EAAIuJ,MAKvB,OAHAvJ,EAAIiS,SAAQ,SAASld,GACnBmC,IAAShC,GAASH,CACpB,IACOmC,CACT,CAGA,IAAIkb,EAAahf,MAAMM,UACnB2e,EAAYlV,SAASzJ,UACrB4e,EAAc7e,OAAOC,UAGrB6e,EAAatB,EAAK,sBAGlBwB,EAAc,WAChB,IAAI/J,EAAM,SAAS7N,KAAK0X,GAAcA,EAAW3a,MAAQ2a,EAAW3a,KAAK8L,UAAY,IACrF,OAAOgF,EAAO,iBAAmBA,EAAO,EAC1C,CAHkB,GAMd8J,EAAeH,EAAU7e,SAGzBb,EAAiB2f,EAAY3f,eAO7BojB,EAAiBzD,EAAY9e,SAG7Bmf,EAAa3X,OAAO,IACtBwX,EAAa3e,KAAKlB,GAAgB2L,QApMjB,sBAoMuC,QACvDA,QAAQ,yDAA0D,SAAW,KAI5EwU,EAASV,EAAWU,OAGpBS,EAAMD,EAAUrC,EAAM,OACtBwC,EAAMH,EAAUrC,EAAM,OACtByC,EAAeJ,EAAU7f,OAAQ,UASrC,SAAS0gB,EAAKC,GACZ,IAAIlf,GAAS,EACTlC,EAASohB,EAAUA,EAAQphB,OAAS,EAGxC,IADAwM,KAAK6U,UACInf,EAAQlC,GAAQ,CACvB,IAAIshB,EAAQF,EAAQlf,GACpBsK,KAAKQ,IAAIsU,EAAM,GAAIA,EAAM,GAC3B,CACF,CAyFA,SAASC,EAAUH,GACjB,IAAIlf,GAAS,EACTlC,EAASohB,EAAUA,EAAQphB,OAAS,EAGxC,IADAwM,KAAK6U,UACInf,EAAQlC,GAAQ,CACvB,IAAIshB,EAAQF,EAAQlf,GACpBsK,KAAKQ,IAAIsU,EAAM,GAAIA,EAAM,GAC3B,CACF,CAuGA,SAASE,EAASJ,GAChB,IAAIlf,GAAS,EACTlC,EAASohB,EAAUA,EAAQphB,OAAS,EAGxC,IADAwM,KAAK6U,UACInf,EAAQlC,GAAQ,CACvB,IAAIshB,EAAQF,EAAQlf,GACpBsK,KAAKQ,IAAIsU,EAAM,GAAIA,EAAM,GAC3B,CACF,CAsFA,SAASG,EAASC,GAChB,IAAIxf,GAAS,EACTlC,EAAS0hB,EAASA,EAAO1hB,OAAS,EAGtC,IADAwM,KAAKmV,SAAW,IAAIH,IACXtf,EAAQlC,GACfwM,KAAKoV,IAAIF,EAAOxf,GAEpB,CA0CA,SAASugB,EAAa5D,EAAOje,GAE3B,IADA,IAgOUmB,EAAOohB,EAhObnjB,EAAS6e,EAAM7e,OACZA,KACL,IA8NQ+B,EA9ND8c,EAAM7e,GAAQ,OA8NNmjB,EA9NUviB,IA+NAmB,IAAUA,GAASohB,IAAUA,EA9NpD,OAAOnjB,EAGX,OAAQ,CACV,CAUA,SAAS0lB,EAAa3jB,GACpB,IAAKK,EAASL,KAgIEmJ,EAhIiBnJ,EAiIxB0d,GAAeA,KAAcvU,GAhIpC,OAAO,EA+HX,IAAkBA,EA7HZqf,EAgON,SAAoBxoB,GAGlB,IAAIkC,EAAM7B,EAASL,GAASghB,EAAeliB,KAAKkB,GAAS,GACzD,OAAOkC,GAAO2Y,GAAW3Y,GAAO4Y,CAClC,CArOiB+I,CAAW7jB,IAtc5B,SAAsBA,GAGpB,IAAImC,GAAS,EACb,GAAa,MAATnC,GAA0C,mBAAlBA,EAAMvB,SAChC,IACE0D,KAAYnC,EAAQ,GACtB,CAAE,MAAO0c,GAAI,CAEf,OAAOva,CACT,CA4bsCsmB,CAAazoB,GAAU4d,EAAa/B,EACxE,OAAO2M,EAAQ/f,KAuIjB,SAAkBU,GAChB,GAAY,MAARA,EAAc,CAChB,IACE,OAAOsU,EAAa3e,KAAKqK,EAC3B,CAAE,MAAOuT,GAAI,CACb,IACE,OAAQvT,EAAO,EACjB,CAAE,MAAOuT,GAAI,CACf,CACA,MAAO,EACT,CAjJsBmC,CAAS7e,GAC/B,CAtSAof,EAAKzgB,UAAU2gB,MAnEf,WACE7U,KAAKmV,SAAWjB,EAAeA,EAAa,MAAQ,CAAC,CACvD,EAkEAS,EAAKzgB,UAAkB,OAtDvB,SAAoBE,GAClB,OAAO4L,KAAKS,IAAIrM,WAAe4L,KAAKmV,SAAS/gB,EAC/C,EAqDAugB,EAAKzgB,UAAUqF,IA1Cf,SAAiBnF,GACf,IAAI+N,EAAOnC,KAAKmV,SAChB,GAAIjB,EAAc,CAChB,IAAIxc,EAASyK,EAAK/N,GAClB,OAAOsD,IAAWgY,OAAiBra,EAAYqC,CACjD,CACA,OAAOvE,EAAekB,KAAK8N,EAAM/N,GAAO+N,EAAK/N,QAAOiB,CACtD,EAoCAsf,EAAKzgB,UAAUuM,IAzBf,SAAiBrM,GACf,IAAI+N,EAAOnC,KAAKmV,SAChB,OAAOjB,OAA6B7e,IAAd8M,EAAK/N,GAAqBjB,EAAekB,KAAK8N,EAAM/N,EAC5E,EAuBAugB,EAAKzgB,UAAUsM,IAXf,SAAiBpM,EAAKmB,GAGpB,OAFWyK,KAAKmV,SACX/gB,GAAQ8f,QAA0B7e,IAAVE,EAAuBma,EAAiBna,EAC9DyK,IACT,EAmHA+U,EAAU7gB,UAAU2gB,MAjFpB,WACE7U,KAAKmV,SAAW,EAClB,EAgFAJ,EAAU7gB,UAAkB,OArE5B,SAAyBE,GACvB,IAAI+N,EAAOnC,KAAKmV,SACZzf,EAAQugB,EAAa9T,EAAM/N,GAE/B,QAAIsB,EAAQ,KAIRA,GADYyM,EAAK3O,OAAS,EAE5B2O,EAAKkY,MAEL/G,EAAOjf,KAAK8N,EAAMzM,EAAO,IAEpB,EACT,EAwDAqf,EAAU7gB,UAAUqF,IA7CpB,SAAsBnF,GACpB,IAAI+N,EAAOnC,KAAKmV,SACZzf,EAAQugB,EAAa9T,EAAM/N,GAE/B,OAAOsB,EAAQ,OAAIL,EAAY8M,EAAKzM,GAAO,EAC7C,EAyCAqf,EAAU7gB,UAAUuM,IA9BpB,SAAsBrM,GACpB,OAAO6hB,EAAajW,KAAKmV,SAAU/gB,IAAQ,CAC7C,EA6BA2gB,EAAU7gB,UAAUsM,IAjBpB,SAAsBpM,EAAKmB,GACzB,IAAI4M,EAAOnC,KAAKmV,SACZzf,EAAQugB,EAAa9T,EAAM/N,GAO/B,OALIsB,EAAQ,EACVyM,EAAKxO,KAAK,CAACS,EAAKmB,IAEhB4M,EAAKzM,GAAO,GAAKH,EAEZyK,IACT,EAiGAgV,EAAS9gB,UAAU2gB,MA/DnB,WACE7U,KAAKmV,SAAW,CACd,KAAQ,IAAIR,EACZ,IAAO,IAAKZ,GAAOgB,GACnB,OAAU,IAAIJ,EAElB,EA0DAK,EAAS9gB,UAAkB,OA/C3B,SAAwBE,GACtB,OAAO8lB,EAAWla,KAAM5L,GAAa,OAAEA,EACzC,EA8CA4gB,EAAS9gB,UAAUqF,IAnCnB,SAAqBnF,GACnB,OAAO8lB,EAAWla,KAAM5L,GAAKmF,IAAInF,EACnC,EAkCA4gB,EAAS9gB,UAAUuM,IAvBnB,SAAqBrM,GACnB,OAAO8lB,EAAWla,KAAM5L,GAAKqM,IAAIrM,EACnC,EAsBA4gB,EAAS9gB,UAAUsM,IAVnB,SAAqBpM,EAAKmB,GAExB,OADA2kB,EAAWla,KAAM5L,GAAKoM,IAAIpM,EAAKmB,GACxByK,IACT,EAwDAiV,EAAS/gB,UAAUkhB,IAAMH,EAAS/gB,UAAUP,KAnB5C,SAAqB4B,GAEnB,OADAyK,KAAKmV,SAAS3U,IAAIjL,EAAOma,GAClB1P,IACT,EAiBAiV,EAAS/gB,UAAUuM,IANnB,SAAqBlL,GACnB,OAAOyK,KAAKmV,SAAS1U,IAAIlL,EAC3B,EA4GA,IAAI0oB,EAAchK,GAAQ,EAAIvB,EAAW,IAAIuB,EAAI,CAAC,EAAE,KAAK,IAlqB1C,IAkqBoE,SAASiB,GAC1F,OAAO,IAAIjB,EAAIiB,EACjB,EAuMA,WACE,EA9LF,SAASgF,EAAW1H,EAAKpe,GACvB,IAAI+N,EAAOqQ,EAAI2C,SACf,OAyBF,SAAmB5f,GACjB,IAAIgM,SAAchM,EAClB,MAAgB,UAARgM,GAA4B,UAARA,GAA4B,UAARA,GAA4B,WAARA,EACrD,cAAVhM,EACU,OAAVA,CACP,CA9BS4kB,CAAU/lB,GACb+N,EAAmB,iBAAP/N,EAAkB,SAAW,QACzC+N,EAAKqQ,GACX,CAUA,SAASsB,EAAUrb,EAAQrE,GACzB,IAAImB,EArjBN,SAAkBkD,EAAQrE,GACxB,OAAiB,MAAVqE,OAAiBpD,EAAYoD,EAAOrE,EAC7C,CAmjBcgmB,CAAS3hB,EAAQrE,GAC7B,OAAO8kB,EAAa3jB,GAASA,OAAQF,CACvC,CA0JA,SAASO,EAASL,GAChB,IAAIgM,SAAchM,EAClB,QAASA,IAAkB,UAARgM,GAA4B,YAARA,EACzC,CAkBAhN,EAAOC,QAhHP,SAAc6d,GACZ,OAAQA,GAASA,EAAM7e,OAzJzB,SAAkB6e,EAAOyD,EAAU8H,GACjC,IAAIloB,GAAS,EACTvB,EAAWmpB,EACX9pB,EAAS6e,EAAM7e,OACf0qB,GAAW,EACXxmB,EAAS,GACT+hB,EAAO/hB,EAEX,GAAIkmB,EACFM,GAAW,EACX/pB,EAAWwpB,OAER,GAAInqB,GAAU+mB,EAAkB,CACnC,IAAI/Z,EAAMsV,EAAW,KAAOmI,EAAU5L,GACtC,GAAI7R,EACF,OAAOkS,EAAWlS,GAEpB0d,GAAW,EACX/pB,EAAW0pB,EACXpE,EAAO,IAAIxE,CACb,MAEEwE,EAAO3D,EAAW,GAAKpe,EAEzBymB,EACA,OAASzoB,EAAQlC,GAAQ,CACvB,IAAI+B,EAAQ8c,EAAM3c,GACd0oB,EAAWtI,EAAWA,EAASvgB,GAASA,EAG5C,GADAA,EAASqoB,GAAwB,IAAVroB,EAAeA,EAAQ,EAC1C2oB,GAAYE,IAAaA,EAAU,CAErC,IADA,IAAIC,EAAY5E,EAAKjmB,OACd6qB,KACL,GAAI5E,EAAK4E,KAAeD,EACtB,SAASD,EAGTrI,GACF2D,EAAK9lB,KAAKyqB,GAEZ1mB,EAAO/D,KAAK4B,EACd,MACUpB,EAASslB,EAAM2E,EAAUR,KAC7BnE,IAAS/hB,GACX+hB,EAAK9lB,KAAKyqB,GAEZ1mB,EAAO/D,KAAK4B,GAEhB,CACA,OAAOmC,CACT,CAwGM4mB,CAASjM,GACT,EACN,wBCnxBA,MASIkM,EAAY,WAGhB,IAAIlmB,EAAIvC,OAAO0oB,aACXC,EAAe,oEACfC,EAAgB,oEAChBC,EAAiB,CAAC,EAEtB,SAASC,EAAaC,EAAUC,GAC9B,IAAKH,EAAeE,GAAW,CAC7BF,EAAeE,GAAY,CAAC,EAC5B,IAAK,IAAIvrB,EAAE,EAAIA,EAAEurB,EAASrrB,OAASF,IACjCqrB,EAAeE,GAAUA,EAASrpB,OAAOlC,IAAMA,CAEnD,CACA,OAAOqrB,EAAeE,GAAUC,EAClC,CAEA,IAAIP,EAAW,CACbQ,iBAAmB,SAAUhY,GAC3B,GAAa,MAATA,EAAe,MAAO,GAC1B,IAAIgG,EAAMwR,EAASS,UAAUjY,EAAO,GAAG,SAAS7G,GAAG,OAAOue,EAAajpB,OAAO0K,EAAG,IACjF,OAAQ6M,EAAIvZ,OAAS,GACrB,QACA,KAAK,EAAI,OAAOuZ,EAChB,KAAK,EAAI,OAAOA,EAAI,MACpB,KAAK,EAAI,OAAOA,EAAI,KACpB,KAAK,EAAI,OAAOA,EAAI,IAEtB,EAEAkS,qBAAuB,SAAUlY,GAC/B,OAAa,MAATA,EAAsB,GACb,IAATA,EAAoB,KACjBwX,EAASW,YAAYnY,EAAMvT,OAAQ,IAAI,SAASkC,GAAS,OAAOkpB,EAAaH,EAAc1X,EAAMvR,OAAOE,GAAS,GAC1H,EAEAypB,gBAAkB,SAAUpY,GAC1B,OAAa,MAATA,EAAsB,GACnBwX,EAASS,UAAUjY,EAAO,IAAI,SAAS7G,GAAG,OAAO7H,EAAE6H,EAAE,GAAI,IAAK,GACvE,EAEAkf,oBAAqB,SAAUC,GAC7B,OAAkB,MAAdA,EAA2B,GACb,IAAdA,EAAyB,KACtBd,EAASW,YAAYG,EAAW7rB,OAAQ,OAAO,SAASkC,GAAS,OAAO2pB,EAAW3V,WAAWhU,GAAS,EAAI,GACpH,EAGA4pB,qBAAsB,SAAUC,GAI9B,IAHA,IAAIF,EAAad,EAASiB,SAASD,GAC/BE,EAAI,IAAIpM,WAA6B,EAAlBgM,EAAW7rB,QAEzBF,EAAE,EAAGosB,EAASL,EAAW7rB,OAAQF,EAAEosB,EAAUpsB,IAAK,CACzD,IAAIqsB,EAAgBN,EAAW3V,WAAWpW,GAC1CmsB,EAAM,EAAFnsB,GAAOqsB,IAAkB,EAC7BF,EAAM,EAAFnsB,EAAI,GAAKqsB,EAAgB,GAC/B,CACA,OAAOF,CACT,EAGAG,yBAAyB,SAAUP,GACjC,GAAiB,OAAbA,QAAkChqB,IAAbgqB,EACrB,OAAOd,EAASsB,WAAWR,GAG3B,IADA,IAAII,EAAI,IAAI7rB,MAAMyrB,EAAW7rB,OAAO,GAC3BF,EAAE,EAAGosB,EAASD,EAAIjsB,OAAQF,EAAEosB,EAAUpsB,IAC7CmsB,EAAInsB,GAAmB,IAAhB+rB,EAAa,EAAF/rB,GAAS+rB,EAAa,EAAF/rB,EAAI,GAG5C,IAAIoE,EAAS,GAIb,OAHA+nB,EAAIhN,SAAQ,SAAUqN,GACpBpoB,EAAO/D,KAAK0E,EAAEynB,GAChB,IACOvB,EAASsB,WAAWnoB,EAAOpD,KAAK,IAI7C,EAIAyrB,8BAA+B,SAAUhZ,GACvC,OAAa,MAATA,EAAsB,GACnBwX,EAASS,UAAUjY,EAAO,GAAG,SAAS7G,GAAG,OAAOwe,EAAclpB,OAAO0K,EAAG,GACjF,EAGA8f,kCAAkC,SAAUjZ,GAC1C,OAAa,MAATA,EAAsB,GACb,IAATA,EAAoB,MACxBA,EAAQA,EAAMjI,QAAQ,KAAM,KACrByf,EAASW,YAAYnY,EAAMvT,OAAQ,IAAI,SAASkC,GAAS,OAAOkpB,EAAaF,EAAe3X,EAAMvR,OAAOE,GAAS,IAC3H,EAEA8pB,SAAU,SAAUD,GAClB,OAAOhB,EAASS,UAAUO,EAAc,IAAI,SAASrf,GAAG,OAAO7H,EAAE6H,EAAG,GACtE,EACA8e,UAAW,SAAUO,EAAcU,EAAaC,GAC9C,GAAoB,MAAhBX,EAAsB,MAAO,GACjC,IAAIjsB,EAAGiC,EAYH4qB,EAXAC,EAAoB,CAAC,EACrBC,EAA4B,CAAC,EAC7BC,EAAU,GACVC,EAAW,GACXC,EAAU,GACVC,EAAmB,EACnBC,EAAkB,EAClBC,EAAiB,EACjBC,EAAa,GACbC,EAAiB,EACjBC,EAAsB,EAG1B,IAAKX,EAAK,EAAGA,EAAKZ,EAAa/rB,OAAQ2sB,GAAM,EAQ3C,GAPAG,EAAYf,EAAa/pB,OAAO2qB,GAC3BlsB,OAAOC,UAAUf,eAAekB,KAAK+rB,EAAmBE,KAC3DF,EAAmBE,GAAaI,IAChCL,EAA2BC,IAAa,GAG1CC,EAAaC,EAAYF,EACrBrsB,OAAOC,UAAUf,eAAekB,KAAK+rB,EAAmBG,GAC1DC,EAAYD,MACP,CACL,GAAItsB,OAAOC,UAAUf,eAAekB,KAAKgsB,EAA2BG,GAAY,CAC9E,GAAIA,EAAU9W,WAAW,GAAG,IAAK,CAC/B,IAAKpW,EAAE,EAAIA,EAAEqtB,EAAkBrtB,IAC7ButB,IAAwC,EACpCC,GAAyBb,EAAY,GACvCa,EAAwB,EACxBF,EAAajtB,KAAKusB,EAAeW,IACjCA,EAAmB,GAEnBC,IAIJ,IADAvrB,EAAQirB,EAAU9W,WAAW,GACxBpW,EAAE,EAAIA,EAAE,EAAIA,IACfutB,EAAoBA,GAAoB,EAAY,EAANtrB,EAC1CurB,GAAyBb,EAAY,GACvCa,EAAwB,EACxBF,EAAajtB,KAAKusB,EAAeW,IACjCA,EAAmB,GAEnBC,IAEFvrB,IAAiB,CAErB,KAAO,CAEL,IADAA,EAAQ,EACHjC,EAAE,EAAIA,EAAEqtB,EAAkBrtB,IAC7ButB,EAAoBA,GAAoB,EAAKtrB,EACzCurB,GAAwBb,EAAY,GACtCa,EAAwB,EACxBF,EAAajtB,KAAKusB,EAAeW,IACjCA,EAAmB,GAEnBC,IAEFvrB,EAAQ,EAGV,IADAA,EAAQirB,EAAU9W,WAAW,GACxBpW,EAAE,EAAIA,EAAE,GAAKA,IAChButB,EAAoBA,GAAoB,EAAY,EAANtrB,EAC1CurB,GAAyBb,EAAY,GACvCa,EAAwB,EACxBF,EAAajtB,KAAKusB,EAAeW,IACjCA,EAAmB,GAEnBC,IAEFvrB,IAAiB,CAErB,CAEyB,KADzBkrB,IAEEA,EAAoB5hB,KAAKkiB,IAAI,EAAGJ,GAChCA,YAEKN,EAA2BG,EACpC,MAEE,IADAjrB,EAAQ6qB,EAAmBI,GACtBltB,EAAE,EAAIA,EAAEqtB,EAAkBrtB,IAC7ButB,EAAoBA,GAAoB,EAAY,EAANtrB,EAC1CurB,GAAyBb,EAAY,GACvCa,EAAwB,EACxBF,EAAajtB,KAAKusB,EAAeW,IACjCA,EAAmB,GAEnBC,IAEFvrB,IAAiB,EAMI,KADzBkrB,IAEEA,EAAoB5hB,KAAKkiB,IAAI,EAAGJ,GAChCA,KAGFP,EAAmBG,GAAcG,IACjCF,EAAY1qB,OAAOwqB,EACrB,CAIF,GAAkB,KAAdE,EAAkB,CACpB,GAAIvsB,OAAOC,UAAUf,eAAekB,KAAKgsB,EAA2BG,GAAY,CAC9E,GAAIA,EAAU9W,WAAW,GAAG,IAAK,CAC/B,IAAKpW,EAAE,EAAIA,EAAEqtB,EAAkBrtB,IAC7ButB,IAAwC,EACpCC,GAAyBb,EAAY,GACvCa,EAAwB,EACxBF,EAAajtB,KAAKusB,EAAeW,IACjCA,EAAmB,GAEnBC,IAIJ,IADAvrB,EAAQirB,EAAU9W,WAAW,GACxBpW,EAAE,EAAIA,EAAE,EAAIA,IACfutB,EAAoBA,GAAoB,EAAY,EAANtrB,EAC1CurB,GAAyBb,EAAY,GACvCa,EAAwB,EACxBF,EAAajtB,KAAKusB,EAAeW,IACjCA,EAAmB,GAEnBC,IAEFvrB,IAAiB,CAErB,KAAO,CAEL,IADAA,EAAQ,EACHjC,EAAE,EAAIA,EAAEqtB,EAAkBrtB,IAC7ButB,EAAoBA,GAAoB,EAAKtrB,EACzCurB,GAAyBb,EAAY,GACvCa,EAAwB,EACxBF,EAAajtB,KAAKusB,EAAeW,IACjCA,EAAmB,GAEnBC,IAEFvrB,EAAQ,EAGV,IADAA,EAAQirB,EAAU9W,WAAW,GACxBpW,EAAE,EAAIA,EAAE,GAAKA,IAChButB,EAAoBA,GAAoB,EAAY,EAANtrB,EAC1CurB,GAAyBb,EAAY,GACvCa,EAAwB,EACxBF,EAAajtB,KAAKusB,EAAeW,IACjCA,EAAmB,GAEnBC,IAEFvrB,IAAiB,CAErB,CAEyB,KADzBkrB,IAEEA,EAAoB5hB,KAAKkiB,IAAI,EAAGJ,GAChCA,YAEKN,EAA2BG,EACpC,MAEE,IADAjrB,EAAQ6qB,EAAmBI,GACtBltB,EAAE,EAAIA,EAAEqtB,EAAkBrtB,IAC7ButB,EAAoBA,GAAoB,EAAY,EAANtrB,EAC1CurB,GAAyBb,EAAY,GACvCa,EAAwB,EACxBF,EAAajtB,KAAKusB,EAAeW,IACjCA,EAAmB,GAEnBC,IAEFvrB,IAAiB,EAMI,KADzBkrB,IAEEA,EAAoB5hB,KAAKkiB,IAAI,EAAGJ,GAChCA,IAEJ,CAIA,IADAprB,EAAQ,EACHjC,EAAE,EAAIA,EAAEqtB,EAAkBrtB,IAC7ButB,EAAoBA,GAAoB,EAAY,EAANtrB,EAC1CurB,GAAyBb,EAAY,GACvCa,EAAwB,EACxBF,EAAajtB,KAAKusB,EAAeW,IACjCA,EAAmB,GAEnBC,IAEFvrB,IAAiB,EAInB,OAAa,CAEX,GADAsrB,IAAwC,EACpCC,GAAyBb,EAAY,EAAG,CAC1CW,EAAajtB,KAAKusB,EAAeW,IACjC,KACF,CACKC,GACP,CACA,OAAOF,EAAatsB,KAAK,GAC3B,EAEAurB,WAAY,SAAUR,GACpB,OAAkB,MAAdA,EAA2B,GACb,IAAdA,EAAyB,KACtBd,EAASW,YAAYG,EAAW7rB,OAAQ,OAAO,SAASkC,GAAS,OAAO2pB,EAAW3V,WAAWhU,EAAQ,GAC/G,EAEAwpB,YAAa,SAAU1rB,EAAQwtB,EAAYC,GACzC,IAOI3tB,EACA4tB,EACAC,EAAMC,EAAMC,EAAUC,EACtBxB,EAVAyB,EAAa,GAEbC,EAAY,EACZC,EAAW,EACXC,EAAU,EACV5M,EAAQ,GACRpd,EAAS,GAKTyK,EAAO,CAAC8E,IAAIga,EAAa,GAAI/hB,SAAS8hB,EAAYtrB,MAAM,GAE5D,IAAKpC,EAAI,EAAGA,EAAI,EAAGA,GAAK,EACtBiuB,EAAWjuB,GAAKA,EAMlB,IAHA6tB,EAAO,EACPE,EAAWxiB,KAAKkiB,IAAI,EAAE,GACtBO,EAAM,EACCA,GAAOD,GACZD,EAAOjf,EAAK8E,IAAM9E,EAAKjD,SACvBiD,EAAKjD,WAAa,EACG,GAAjBiD,EAAKjD,WACPiD,EAAKjD,SAAW8hB,EAChB7e,EAAK8E,IAAMga,EAAa9e,EAAKzM,UAE/ByrB,IAASC,EAAK,EAAI,EAAI,GAAKE,EAC3BA,IAAU,EAGZ,OAAeH,GACb,KAAK,EAID,IAHAA,EAAO,EACPE,EAAWxiB,KAAKkiB,IAAI,EAAE,GACtBO,EAAM,EACCA,GAAOD,GACZD,EAAOjf,EAAK8E,IAAM9E,EAAKjD,SACvBiD,EAAKjD,WAAa,EACG,GAAjBiD,EAAKjD,WACPiD,EAAKjD,SAAW8hB,EAChB7e,EAAK8E,IAAMga,EAAa9e,EAAKzM,UAE/ByrB,IAASC,EAAK,EAAI,EAAI,GAAKE,EAC3BA,IAAU,EAEdxB,EAAIznB,EAAE8oB,GACN,MACF,KAAK,EAID,IAHAA,EAAO,EACPE,EAAWxiB,KAAKkiB,IAAI,EAAE,IACtBO,EAAM,EACCA,GAAOD,GACZD,EAAOjf,EAAK8E,IAAM9E,EAAKjD,SACvBiD,EAAKjD,WAAa,EACG,GAAjBiD,EAAKjD,WACPiD,EAAKjD,SAAW8hB,EAChB7e,EAAK8E,IAAMga,EAAa9e,EAAKzM,UAE/ByrB,IAASC,EAAK,EAAI,EAAI,GAAKE,EAC3BA,IAAU,EAEdxB,EAAIznB,EAAE8oB,GACN,MACF,KAAK,EACH,MAAO,GAKX,IAHAI,EAAW,GAAKzB,EAChBoB,EAAIpB,EACJpoB,EAAO/D,KAAKmsB,KACC,CACX,GAAI3d,EAAKzM,MAAQlC,EACf,MAAO,GAMT,IAHA2tB,EAAO,EACPE,EAAWxiB,KAAKkiB,IAAI,EAAEW,GACtBJ,EAAM,EACCA,GAAOD,GACZD,EAAOjf,EAAK8E,IAAM9E,EAAKjD,SACvBiD,EAAKjD,WAAa,EACG,GAAjBiD,EAAKjD,WACPiD,EAAKjD,SAAW8hB,EAChB7e,EAAK8E,IAAMga,EAAa9e,EAAKzM,UAE/ByrB,IAASC,EAAK,EAAI,EAAI,GAAKE,EAC3BA,IAAU,EAGZ,OAAQxB,EAAIqB,GACV,KAAK,EAIH,IAHAA,EAAO,EACPE,EAAWxiB,KAAKkiB,IAAI,EAAE,GACtBO,EAAM,EACCA,GAAOD,GACZD,EAAOjf,EAAK8E,IAAM9E,EAAKjD,SACvBiD,EAAKjD,WAAa,EACG,GAAjBiD,EAAKjD,WACPiD,EAAKjD,SAAW8hB,EAChB7e,EAAK8E,IAAMga,EAAa9e,EAAKzM,UAE/ByrB,IAASC,EAAK,EAAI,EAAI,GAAKE,EAC3BA,IAAU,EAGZC,EAAWE,KAAcppB,EAAE8oB,GAC3BrB,EAAI2B,EAAS,EACbD,IACA,MACF,KAAK,EAIH,IAHAL,EAAO,EACPE,EAAWxiB,KAAKkiB,IAAI,EAAE,IACtBO,EAAM,EACCA,GAAOD,GACZD,EAAOjf,EAAK8E,IAAM9E,EAAKjD,SACvBiD,EAAKjD,WAAa,EACG,GAAjBiD,EAAKjD,WACPiD,EAAKjD,SAAW8hB,EAChB7e,EAAK8E,IAAMga,EAAa9e,EAAKzM,UAE/ByrB,IAASC,EAAK,EAAI,EAAI,GAAKE,EAC3BA,IAAU,EAEZC,EAAWE,KAAcppB,EAAE8oB,GAC3BrB,EAAI2B,EAAS,EACbD,IACA,MACF,KAAK,EACH,OAAO9pB,EAAOpD,KAAK,IAQvB,GALiB,GAAbktB,IACFA,EAAY3iB,KAAKkiB,IAAI,EAAGW,GACxBA,KAGEH,EAAWzB,GACbhL,EAAQyM,EAAWzB,OACd,CACL,GAAIA,IAAM2B,EAGR,OAAO,KAFP3M,EAAQoM,EAAIA,EAAE1rB,OAAO,EAIzB,CACAkC,EAAO/D,KAAKmhB,GAGZyM,EAAWE,KAAcP,EAAIpM,EAAMtf,OAAO,GAG1C0rB,EAAIpM,EAEa,KAJjB0M,IAKEA,EAAY3iB,KAAKkiB,IAAI,EAAGW,GACxBA,IAGJ,CACF,GAEA,OAAOnD,CACT,CAregB,QAweyB,KAAvCoD,EAAAA,WAAqB,OAAOpD,CAAW,mECre5B,IAAIqD,EAAGjtB,EAAQ,MAASktB,EAAGltB,EAAQ,MAAa,SAASmtB,EAAE5hB,GAAG,IAAI,IAAI6hB,EAAE,yDAAyD7hB,EAAE4f,EAAE,EAAEA,EAAEvsB,UAAUC,OAAOssB,IAAIiC,GAAG,WAAWC,mBAAmBzuB,UAAUusB,IAAI,MAAM,yBAAyB5f,EAAE,WAAW6hB,EAAE,gHAAgH,CAAC,IAAIE,EAAG,IAAIhO,IAAIiO,EAAG,CAAC,EAAE,SAASC,EAAGjiB,EAAE6hB,GAAGK,EAAGliB,EAAE6hB,GAAGK,EAAGliB,EAAE,UAAU6hB,EAAE,CACxb,SAASK,EAAGliB,EAAE6hB,GAAW,IAARG,EAAGhiB,GAAG6hB,EAAM7hB,EAAE,EAAEA,EAAE6hB,EAAEvuB,OAAO0M,IAAI+hB,EAAG7M,IAAI2M,EAAE7hB,GAAG,CAC5D,IAAImiB,IAAK,qBAAqBviB,QAAQ,qBAAqBA,OAAOrG,UAAU,qBAAqBqG,OAAOrG,SAASI,eAAeyoB,EAAGruB,OAAOC,UAAUf,eAAeovB,EAAG,8VAA8VC,EACpgB,CAAC,EAAEC,EAAG,CAAC,EACiN,SAASC,EAAExiB,EAAE6hB,EAAEjC,EAAE6C,EAAE1Q,EAAE5Z,EAAEuqB,GAAG5iB,KAAK6iB,gBAAgB,IAAId,GAAG,IAAIA,GAAG,IAAIA,EAAE/hB,KAAK8iB,cAAcH,EAAE3iB,KAAK+iB,mBAAmB9Q,EAAEjS,KAAKgjB,gBAAgBlD,EAAE9f,KAAKijB,aAAa/iB,EAAEF,KAAKuB,KAAKwgB,EAAE/hB,KAAKkjB,YAAY7qB,EAAE2H,KAAKmjB,kBAAkBP,CAAC,CAAC,IAAIQ,EAAE,CAAC,EACpb,uIAAuI9oB,MAAM,KAAKmY,SAAQ,SAASvS,GAAGkjB,EAAEljB,GAAG,IAAIwiB,EAAExiB,EAAE,GAAE,EAAGA,EAAE,MAAK,GAAG,EAAG,IAAG,CAAC,CAAC,gBAAgB,kBAAkB,CAAC,YAAY,SAAS,CAAC,UAAU,OAAO,CAAC,YAAY,eAAeuS,SAAQ,SAASvS,GAAG,IAAI6hB,EAAE7hB,EAAE,GAAGkjB,EAAErB,GAAG,IAAIW,EAAEX,EAAE,GAAE,EAAG7hB,EAAE,GAAG,MAAK,GAAG,EAAG,IAAG,CAAC,kBAAkB,YAAY,aAAa,SAASuS,SAAQ,SAASvS,GAAGkjB,EAAEljB,GAAG,IAAIwiB,EAAExiB,EAAE,GAAE,EAAGA,EAAEsC,cAAc,MAAK,GAAG,EAAG,IAC1e,CAAC,cAAc,4BAA4B,YAAY,iBAAiBiQ,SAAQ,SAASvS,GAAGkjB,EAAEljB,GAAG,IAAIwiB,EAAExiB,EAAE,GAAE,EAAGA,EAAE,MAAK,GAAG,EAAG,IAAG,8OAA8O5F,MAAM,KAAKmY,SAAQ,SAASvS,GAAGkjB,EAAEljB,GAAG,IAAIwiB,EAAExiB,EAAE,GAAE,EAAGA,EAAEsC,cAAc,MAAK,GAAG,EAAG,IACxb,CAAC,UAAU,WAAW,QAAQ,YAAYiQ,SAAQ,SAASvS,GAAGkjB,EAAEljB,GAAG,IAAIwiB,EAAExiB,EAAE,GAAE,EAAGA,EAAE,MAAK,GAAG,EAAG,IAAG,CAAC,UAAU,YAAYuS,SAAQ,SAASvS,GAAGkjB,EAAEljB,GAAG,IAAIwiB,EAAExiB,EAAE,GAAE,EAAGA,EAAE,MAAK,GAAG,EAAG,IAAG,CAAC,OAAO,OAAO,OAAO,QAAQuS,SAAQ,SAASvS,GAAGkjB,EAAEljB,GAAG,IAAIwiB,EAAExiB,EAAE,GAAE,EAAGA,EAAE,MAAK,GAAG,EAAG,IAAG,CAAC,UAAU,SAASuS,SAAQ,SAASvS,GAAGkjB,EAAEljB,GAAG,IAAIwiB,EAAExiB,EAAE,GAAE,EAAGA,EAAEsC,cAAc,MAAK,GAAG,EAAG,IAAG,IAAI6gB,EAAG,gBAAgB,SAASC,EAAGpjB,GAAG,OAAOA,EAAE,GAAGqjB,aAAa,CAIxZ,SAASC,EAAGtjB,EAAE6hB,EAAEjC,EAAE6C,GAAG,IAAI1Q,EAAEmR,EAAEjwB,eAAe4uB,GAAGqB,EAAErB,GAAG,MAAQ,OAAO9P,EAAE,IAAIA,EAAE1Q,KAAKohB,KAAK,EAAEZ,EAAEvuB,SAAS,MAAMuuB,EAAE,IAAI,MAAMA,EAAE,IAAI,MAAMA,EAAE,IAAI,MAAMA,EAAE,MAP9I,SAAY7hB,EAAE6hB,EAAEjC,EAAE6C,GAAG,GAAG,OAAOZ,GAAG,qBAAqBA,GADqE,SAAY7hB,EAAE6hB,EAAEjC,EAAE6C,GAAG,GAAG,OAAO7C,GAAG,IAAIA,EAAEve,KAAK,OAAM,EAAG,cAAcwgB,GAAG,IAAK,WAAW,IAAK,SAAS,OAAM,EAAG,IAAK,UAAU,OAAGY,IAAc,OAAO7C,GAASA,EAAE+C,gBAAmD,WAAnC3iB,EAAEA,EAAEsC,cAActL,MAAM,EAAE,KAAsB,UAAUgJ,GAAE,QAAQ,OAAM,EAAG,CAC/TujB,CAAGvjB,EAAE6hB,EAAEjC,EAAE6C,GAAG,OAAM,EAAG,GAAGA,EAAE,OAAM,EAAG,GAAG,OAAO7C,EAAE,OAAOA,EAAEve,MAAM,KAAK,EAAE,OAAOwgB,EAAE,KAAK,EAAE,OAAM,IAAKA,EAAE,KAAK,EAAE,OAAO2B,MAAM3B,GAAG,KAAK,EAAE,OAAO2B,MAAM3B,IAAI,EAAEA,EAAE,OAAM,CAAE,CAOtE4B,CAAG5B,EAAEjC,EAAE7N,EAAE0Q,KAAK7C,EAAE,MAAM6C,GAAG,OAAO1Q,EARxK,SAAY/R,GAAG,QAAGoiB,EAAGjuB,KAAKouB,EAAGviB,KAAeoiB,EAAGjuB,KAAKmuB,EAAGtiB,KAAeqiB,EAAGvkB,KAAKkC,GAAUuiB,EAAGviB,IAAG,GAAGsiB,EAAGtiB,IAAG,GAAS,GAAE,CAQwD0jB,CAAG7B,KAAK,OAAOjC,EAAE5f,EAAE2jB,gBAAgB9B,GAAG7hB,EAAE4jB,aAAa/B,EAAE,GAAGjC,IAAI7N,EAAE+Q,gBAAgB9iB,EAAE+R,EAAEgR,cAAc,OAAOnD,EAAE,IAAI7N,EAAE1Q,MAAQ,GAAGue,GAAGiC,EAAE9P,EAAE6Q,cAAcH,EAAE1Q,EAAE8Q,mBAAmB,OAAOjD,EAAE5f,EAAE2jB,gBAAgB9B,IAAajC,EAAE,KAAX7N,EAAEA,EAAE1Q,OAAc,IAAI0Q,IAAG,IAAK6N,EAAE,GAAG,GAAGA,EAAE6C,EAAEziB,EAAE6jB,eAAepB,EAAEZ,EAAEjC,GAAG5f,EAAE4jB,aAAa/B,EAAEjC,KAAI,CAHjd,0jCAA0jCxlB,MAAM,KAAKmY,SAAQ,SAASvS,GAAG,IAAI6hB,EAAE7hB,EAAEpB,QAAQukB,EACzmCC,GAAIF,EAAErB,GAAG,IAAIW,EAAEX,EAAE,GAAE,EAAG7hB,EAAE,MAAK,GAAG,EAAG,IAAG,2EAA2E5F,MAAM,KAAKmY,SAAQ,SAASvS,GAAG,IAAI6hB,EAAE7hB,EAAEpB,QAAQukB,EAAGC,GAAIF,EAAErB,GAAG,IAAIW,EAAEX,EAAE,GAAE,EAAG7hB,EAAE,gCAA+B,GAAG,EAAG,IAAG,CAAC,WAAW,WAAW,aAAauS,SAAQ,SAASvS,GAAG,IAAI6hB,EAAE7hB,EAAEpB,QAAQukB,EAAGC,GAAIF,EAAErB,GAAG,IAAIW,EAAEX,EAAE,GAAE,EAAG7hB,EAAE,wCAAuC,GAAG,EAAG,IAAG,CAAC,WAAW,eAAeuS,SAAQ,SAASvS,GAAGkjB,EAAEljB,GAAG,IAAIwiB,EAAExiB,EAAE,GAAE,EAAGA,EAAEsC,cAAc,MAAK,GAAG,EAAG,IACld4gB,EAAEY,UAAU,IAAItB,EAAE,YAAY,GAAE,EAAG,aAAa,gCAA+B,GAAG,GAAI,CAAC,MAAM,OAAO,SAAS,cAAcjQ,SAAQ,SAASvS,GAAGkjB,EAAEljB,GAAG,IAAIwiB,EAAExiB,EAAE,GAAE,EAAGA,EAAEsC,cAAc,MAAK,GAAG,EAAG,IAE5L,IAAIyhB,EAAGrC,EAAGsC,mDAAmDC,EAAGha,OAAOia,IAAI,iBAAiBC,EAAGla,OAAOia,IAAI,gBAAgBE,EAAGna,OAAOia,IAAI,kBAAkBG,EAAGpa,OAAOia,IAAI,qBAAqBI,EAAGra,OAAOia,IAAI,kBAAkBK,EAAGta,OAAOia,IAAI,kBAAkBM,EAAGva,OAAOia,IAAI,iBAAiBO,EAAGxa,OAAOia,IAAI,qBAAqBQ,EAAGza,OAAOia,IAAI,kBAAkBS,EAAG1a,OAAOia,IAAI,uBAAuBU,EAAG3a,OAAOia,IAAI,cAAcW,EAAG5a,OAAOia,IAAI,cAAcja,OAAOia,IAAI,eAAeja,OAAOia,IAAI,0BACje,IAAIY,EAAG7a,OAAOia,IAAI,mBAAmBja,OAAOia,IAAI,uBAAuBja,OAAOia,IAAI,eAAeja,OAAOia,IAAI,wBAAwB,IAAIa,EAAG9a,OAAOgB,SAAS,SAAS+Z,EAAGhlB,GAAG,OAAG,OAAOA,GAAG,kBAAkBA,EAAS,KAAwC,oBAAnCA,EAAE+kB,GAAI/kB,EAAE+kB,IAAK/kB,EAAE,eAA0CA,EAAE,IAAI,CAAC,IAAoBilB,EAAhBvZ,EAAE3X,OAAOmxB,OAAU,SAASC,EAAGnlB,GAAG,QAAG,IAASilB,EAAG,IAAI,MAAMG,OAAQ,CAAC,MAAMxF,GAAG,IAAIiC,EAAEjC,EAAEhJ,MAAMyO,OAAOvrB,MAAM,gBAAgBmrB,EAAGpD,GAAGA,EAAE,IAAI,EAAE,CAAC,MAAM,KAAKoD,EAAGjlB,CAAC,CAAC,IAAIslB,GAAG,EACzb,SAASC,EAAGvlB,EAAE6hB,GAAG,IAAI7hB,GAAGslB,EAAG,MAAM,GAAGA,GAAG,EAAG,IAAI1F,EAAEwF,MAAMI,kBAAkBJ,MAAMI,uBAAkB,EAAO,IAAI,GAAG3D,EAAE,GAAGA,EAAE,WAAW,MAAMuD,OAAQ,EAAErxB,OAAOiB,eAAe6sB,EAAE7tB,UAAU,QAAQ,CAACsM,IAAI,WAAW,MAAM8kB,OAAQ,IAAI,kBAAkB1nB,SAASA,QAAQ+D,UAAU,CAAC,IAAI/D,QAAQ+D,UAAUogB,EAAE,GAAG,CAAC,MAAMrT,GAAG,IAAIiU,EAAEjU,CAAC,CAAC9Q,QAAQ+D,UAAUzB,EAAE,GAAG6hB,EAAE,KAAK,CAAC,IAAIA,EAAE1tB,MAAM,CAAC,MAAMqa,GAAGiU,EAAEjU,CAAC,CAACxO,EAAE7L,KAAK0tB,EAAE7tB,UAAU,KAAK,CAAC,IAAI,MAAMoxB,OAAQ,CAAC,MAAM5W,GAAGiU,EAAEjU,CAAC,CAACxO,GAAG,CAAC,CAAC,MAAMwO,GAAG,GAAGA,GAAGiU,GAAG,kBAAkBjU,EAAEoI,MAAM,CAAC,IAAI,IAAI7E,EAAEvD,EAAEoI,MAAMxc,MAAM,MACnfjC,EAAEsqB,EAAE7L,MAAMxc,MAAM,MAAMsoB,EAAE3Q,EAAEze,OAAO,EAAEmyB,EAAEttB,EAAE7E,OAAO,EAAE,GAAGovB,GAAG,GAAG+C,GAAG1T,EAAE2Q,KAAKvqB,EAAEstB,IAAIA,IAAI,KAAK,GAAG/C,GAAG,GAAG+C,EAAE/C,IAAI+C,IAAI,GAAG1T,EAAE2Q,KAAKvqB,EAAEstB,GAAG,CAAC,GAAG,IAAI/C,GAAG,IAAI+C,EAAG,MAAM/C,IAAQ,IAAJ+C,GAAS1T,EAAE2Q,KAAKvqB,EAAEstB,GAAG,CAAC,IAAIC,EAAE,KAAK3T,EAAE2Q,GAAG9jB,QAAQ,WAAW,QAA6F,OAArFoB,EAAE2lB,aAAaD,EAAEzxB,SAAS,iBAAiByxB,EAAEA,EAAE9mB,QAAQ,cAAcoB,EAAE2lB,cAAqBD,CAAC,QAAO,GAAGhD,GAAG,GAAG+C,GAAG,KAAK,CAAC,CAAC,CAAC,QAAQH,GAAG,EAAGF,MAAMI,kBAAkB5F,CAAC,CAAC,OAAO5f,EAAEA,EAAEA,EAAE2lB,aAAa3lB,EAAEjH,KAAK,IAAIosB,EAAGnlB,GAAG,EAAE,CAC9Z,SAAS4lB,EAAG5lB,GAAG,OAAOA,EAAEzI,KAAK,KAAK,EAAE,OAAO4tB,EAAGnlB,EAAEqB,MAAM,KAAK,GAAG,OAAO8jB,EAAG,QAAQ,KAAK,GAAG,OAAOA,EAAG,YAAY,KAAK,GAAG,OAAOA,EAAG,gBAAgB,KAAK,EAAE,KAAK,EAAE,KAAK,GAAG,OAAOnlB,EAAEulB,EAAGvlB,EAAEqB,MAAK,GAAM,KAAK,GAAG,OAAOrB,EAAEulB,EAAGvlB,EAAEqB,KAAKwkB,QAAO,GAAM,KAAK,EAAE,OAAO7lB,EAAEulB,EAAGvlB,EAAEqB,MAAK,GAAM,QAAQ,MAAM,GAAG,CACxR,SAASykB,EAAG9lB,GAAG,GAAG,MAAMA,EAAE,OAAO,KAAK,GAAG,oBAAoBA,EAAE,OAAOA,EAAE2lB,aAAa3lB,EAAEjH,MAAM,KAAK,GAAG,kBAAkBiH,EAAE,OAAOA,EAAE,OAAOA,GAAG,KAAKokB,EAAG,MAAM,WAAW,KAAKD,EAAG,MAAM,SAAS,KAAKG,EAAG,MAAM,WAAW,KAAKD,EAAG,MAAM,aAAa,KAAKK,EAAG,MAAM,WAAW,KAAKC,EAAG,MAAM,eAAe,GAAG,kBAAkB3kB,EAAE,OAAOA,EAAE+lB,UAAU,KAAKvB,EAAG,OAAOxkB,EAAE2lB,aAAa,WAAW,YAAY,KAAKpB,EAAG,OAAOvkB,EAAEgmB,SAASL,aAAa,WAAW,YAAY,KAAKlB,EAAG,IAAI5C,EAAE7hB,EAAE6lB,OAC7Z,OADoa7lB,EAAEA,EAAE2lB,eACnd3lB,EAAE,MADieA,EAAE6hB,EAAE8D,aAClf9D,EAAE9oB,MAAM,IAAY,cAAciH,EAAE,IAAI,cAAqBA,EAAE,KAAK4kB,EAAG,OAA6B,QAAtB/C,EAAE7hB,EAAE2lB,aAAa,MAAc9D,EAAEiE,EAAG9lB,EAAEqB,OAAO,OAAO,KAAKwjB,EAAGhD,EAAE7hB,EAAEimB,SAASjmB,EAAEA,EAAEkmB,MAAM,IAAI,OAAOJ,EAAG9lB,EAAE6hB,GAAG,CAAC,MAAMjC,GAAG,EAAE,OAAO,IAAI,CAC3M,SAASuG,EAAGnmB,GAAG,IAAI6hB,EAAE7hB,EAAEqB,KAAK,OAAOrB,EAAEzI,KAAK,KAAK,GAAG,MAAM,QAAQ,KAAK,EAAE,OAAOsqB,EAAE8D,aAAa,WAAW,YAAY,KAAK,GAAG,OAAO9D,EAAEmE,SAASL,aAAa,WAAW,YAAY,KAAK,GAAG,MAAM,qBAAqB,KAAK,GAAG,OAAkB3lB,GAAXA,EAAE6hB,EAAEgE,QAAWF,aAAa3lB,EAAEjH,MAAM,GAAG8oB,EAAE8D,cAAc,KAAK3lB,EAAE,cAAcA,EAAE,IAAI,cAAc,KAAK,EAAE,MAAM,WAAW,KAAK,EAAE,OAAO6hB,EAAE,KAAK,EAAE,MAAM,SAAS,KAAK,EAAE,MAAM,OAAO,KAAK,EAAE,MAAM,OAAO,KAAK,GAAG,OAAOiE,EAAGjE,GAAG,KAAK,EAAE,OAAOA,IAAIwC,EAAG,aAAa,OAAO,KAAK,GAAG,MAAM,YACtf,KAAK,GAAG,MAAM,WAAW,KAAK,GAAG,MAAM,QAAQ,KAAK,GAAG,MAAM,WAAW,KAAK,GAAG,MAAM,eAAe,KAAK,GAAG,MAAM,gBAAgB,KAAK,EAAE,KAAK,EAAE,KAAK,GAAG,KAAK,EAAE,KAAK,GAAG,KAAK,GAAG,GAAG,oBAAoBxC,EAAE,OAAOA,EAAE8D,aAAa9D,EAAE9oB,MAAM,KAAK,GAAG,kBAAkB8oB,EAAE,OAAOA,EAAE,OAAO,IAAI,CAAC,SAASuE,EAAGpmB,GAAG,cAAcA,GAAG,IAAK,UAAU,IAAK,SAAS,IAAK,SAAS,IAAK,YAAqB,IAAK,SAAS,OAAOA,EAAE,QAAQ,MAAM,GAAG,CACra,SAASqmB,EAAGrmB,GAAG,IAAI6hB,EAAE7hB,EAAEqB,KAAK,OAAOrB,EAAEA,EAAEsmB,WAAW,UAAUtmB,EAAEsC,gBAAgB,aAAauf,GAAG,UAAUA,EAAE,CAEtF,SAAS0E,EAAGvmB,GAAGA,EAAEwmB,gBAAgBxmB,EAAEwmB,cADvD,SAAYxmB,GAAG,IAAI6hB,EAAEwE,EAAGrmB,GAAG,UAAU,QAAQ4f,EAAE7rB,OAAOqE,yBAAyB4H,EAAEpJ,YAAY5C,UAAU6tB,GAAGY,EAAE,GAAGziB,EAAE6hB,GAAG,IAAI7hB,EAAE/M,eAAe4uB,IAAI,qBAAqBjC,GAAG,oBAAoBA,EAAEvmB,KAAK,oBAAoBumB,EAAEtf,IAAI,CAAC,IAAIyR,EAAE6N,EAAEvmB,IAAIlB,EAAEynB,EAAEtf,IAAiL,OAA7KvM,OAAOiB,eAAegL,EAAE6hB,EAAE,CAACzsB,cAAa,EAAGiE,IAAI,WAAW,OAAO0Y,EAAE5d,KAAK2L,KAAK,EAAEQ,IAAI,SAASN,GAAGyiB,EAAE,GAAGziB,EAAE7H,EAAEhE,KAAK2L,KAAKE,EAAE,IAAIjM,OAAOiB,eAAegL,EAAE6hB,EAAE,CAACppB,WAAWmnB,EAAEnnB,aAAmB,CAACyhB,SAAS,WAAW,OAAOuI,CAAC,EAAEgE,SAAS,SAASzmB,GAAGyiB,EAAE,GAAGziB,CAAC,EAAE0mB,aAAa,WAAW1mB,EAAEwmB,cACxf,YAAYxmB,EAAE6hB,EAAE,EAAE,CAAC,CAAkD8E,CAAG3mB,GAAG,CAAC,SAAS4mB,EAAG5mB,GAAG,IAAIA,EAAE,OAAM,EAAG,IAAI6hB,EAAE7hB,EAAEwmB,cAAc,IAAI3E,EAAE,OAAM,EAAG,IAAIjC,EAAEiC,EAAE3H,WAAeuI,EAAE,GAAqD,OAAlDziB,IAAIyiB,EAAE4D,EAAGrmB,GAAGA,EAAE6mB,QAAQ,OAAO,QAAQ7mB,EAAE3K,QAAO2K,EAAEyiB,KAAa7C,IAAGiC,EAAE4E,SAASzmB,IAAG,EAAM,CAAC,SAAS8mB,EAAG9mB,GAAwD,GAAG,qBAAxDA,EAAEA,IAAI,qBAAqBzG,SAASA,cAAS,IAAkC,OAAO,KAAK,IAAI,OAAOyG,EAAE+mB,eAAe/mB,EAAEgnB,IAAI,CAAC,MAAMnF,GAAG,OAAO7hB,EAAEgnB,IAAI,CAAC,CACpa,SAASC,EAAGjnB,EAAE6hB,GAAG,IAAIjC,EAAEiC,EAAEgF,QAAQ,OAAOnb,EAAE,CAAC,EAAEmW,EAAE,CAACqF,oBAAe,EAAOC,kBAAa,EAAO9xB,WAAM,EAAOwxB,QAAQ,MAAMjH,EAAEA,EAAE5f,EAAEonB,cAAcC,gBAAgB,CAAC,SAASC,EAAGtnB,EAAE6hB,GAAG,IAAIjC,EAAE,MAAMiC,EAAEsF,aAAa,GAAGtF,EAAEsF,aAAa1E,EAAE,MAAMZ,EAAEgF,QAAQhF,EAAEgF,QAAQhF,EAAEqF,eAAetH,EAAEwG,EAAG,MAAMvE,EAAExsB,MAAMwsB,EAAExsB,MAAMuqB,GAAG5f,EAAEonB,cAAc,CAACC,eAAe5E,EAAE8E,aAAa3H,EAAE4H,WAAW,aAAa3F,EAAExgB,MAAM,UAAUwgB,EAAExgB,KAAK,MAAMwgB,EAAEgF,QAAQ,MAAMhF,EAAExsB,MAAM,CAAC,SAASoyB,EAAGznB,EAAE6hB,GAAe,OAAZA,EAAEA,EAAEgF,UAAiBvD,EAAGtjB,EAAE,UAAU6hB,GAAE,EAAG,CAC9d,SAAS6F,EAAG1nB,EAAE6hB,GAAG4F,EAAGznB,EAAE6hB,GAAG,IAAIjC,EAAEwG,EAAGvE,EAAExsB,OAAOotB,EAAEZ,EAAExgB,KAAK,GAAG,MAAMue,EAAK,WAAW6C,GAAM,IAAI7C,GAAG,KAAK5f,EAAE3K,OAAO2K,EAAE3K,OAAOuqB,KAAE5f,EAAE3K,MAAM,GAAGuqB,GAAO5f,EAAE3K,QAAQ,GAAGuqB,IAAI5f,EAAE3K,MAAM,GAAGuqB,QAAQ,GAAG,WAAW6C,GAAG,UAAUA,EAA8B,YAA3BziB,EAAE2jB,gBAAgB,SAAgB9B,EAAE5uB,eAAe,SAAS00B,GAAG3nB,EAAE6hB,EAAExgB,KAAKue,GAAGiC,EAAE5uB,eAAe,iBAAiB00B,GAAG3nB,EAAE6hB,EAAExgB,KAAK+kB,EAAGvE,EAAEsF,eAAe,MAAMtF,EAAEgF,SAAS,MAAMhF,EAAEqF,iBAAiBlnB,EAAEknB,iBAAiBrF,EAAEqF,eAAe,CACla,SAASU,EAAG5nB,EAAE6hB,EAAEjC,GAAG,GAAGiC,EAAE5uB,eAAe,UAAU4uB,EAAE5uB,eAAe,gBAAgB,CAAC,IAAIwvB,EAAEZ,EAAExgB,KAAK,KAAK,WAAWohB,GAAG,UAAUA,QAAG,IAASZ,EAAExsB,OAAO,OAAOwsB,EAAExsB,OAAO,OAAOwsB,EAAE,GAAG7hB,EAAEonB,cAAcG,aAAa3H,GAAGiC,IAAI7hB,EAAE3K,QAAQ2K,EAAE3K,MAAMwsB,GAAG7hB,EAAEmnB,aAAatF,CAAC,CAAU,MAATjC,EAAE5f,EAAEjH,QAAciH,EAAEjH,KAAK,IAAIiH,EAAEknB,iBAAiBlnB,EAAEonB,cAAcC,eAAe,KAAKzH,IAAI5f,EAAEjH,KAAK6mB,EAAE,CACzV,SAAS+H,GAAG3nB,EAAE6hB,EAAEjC,GAAM,WAAWiC,GAAGiF,EAAG9mB,EAAE6nB,iBAAiB7nB,IAAE,MAAM4f,EAAE5f,EAAEmnB,aAAa,GAAGnnB,EAAEonB,cAAcG,aAAavnB,EAAEmnB,eAAe,GAAGvH,IAAI5f,EAAEmnB,aAAa,GAAGvH,GAAE,CAAC,IAAIkI,GAAGp0B,MAAMC,QAC7K,SAASo0B,GAAG/nB,EAAE6hB,EAAEjC,EAAE6C,GAAe,GAAZziB,EAAEA,EAAEnH,QAAWgpB,EAAE,CAACA,EAAE,CAAC,EAAE,IAAI,IAAI9P,EAAE,EAAEA,EAAE6N,EAAEtsB,OAAOye,IAAI8P,EAAE,IAAIjC,EAAE7N,KAAI,EAAG,IAAI6N,EAAE,EAAEA,EAAE5f,EAAE1M,OAAOssB,IAAI7N,EAAE8P,EAAE5uB,eAAe,IAAI+M,EAAE4f,GAAGvqB,OAAO2K,EAAE4f,GAAGoI,WAAWjW,IAAI/R,EAAE4f,GAAGoI,SAASjW,GAAGA,GAAG0Q,IAAIziB,EAAE4f,GAAGqI,iBAAgB,EAAG,KAAK,CAAmB,IAAlBrI,EAAE,GAAGwG,EAAGxG,GAAGiC,EAAE,KAAS9P,EAAE,EAAEA,EAAE/R,EAAE1M,OAAOye,IAAI,CAAC,GAAG/R,EAAE+R,GAAG1c,QAAQuqB,EAAiD,OAA9C5f,EAAE+R,GAAGiW,UAAS,OAAGvF,IAAIziB,EAAE+R,GAAGkW,iBAAgB,IAAW,OAAOpG,GAAG7hB,EAAE+R,GAAGmW,WAAWrG,EAAE7hB,EAAE+R,GAAG,CAAC,OAAO8P,IAAIA,EAAEmG,UAAS,EAAG,CAAC,CACxY,SAASG,GAAGnoB,EAAE6hB,GAAG,GAAG,MAAMA,EAAEuG,wBAAwB,MAAMhD,MAAMxD,EAAE,KAAK,OAAOlW,EAAE,CAAC,EAAEmW,EAAE,CAACxsB,WAAM,EAAO8xB,kBAAa,EAAOkB,SAAS,GAAGroB,EAAEonB,cAAcG,cAAc,CAAC,SAASe,GAAGtoB,EAAE6hB,GAAG,IAAIjC,EAAEiC,EAAExsB,MAAM,GAAG,MAAMuqB,EAAE,CAA+B,GAA9BA,EAAEiC,EAAEwG,SAASxG,EAAEA,EAAEsF,aAAgB,MAAMvH,EAAE,CAAC,GAAG,MAAMiC,EAAE,MAAMuD,MAAMxD,EAAE,KAAK,GAAGkG,GAAGlI,GAAG,CAAC,GAAG,EAAEA,EAAEtsB,OAAO,MAAM8xB,MAAMxD,EAAE,KAAKhC,EAAEA,EAAE,EAAE,CAACiC,EAAEjC,CAAC,CAAC,MAAMiC,IAAIA,EAAE,IAAIjC,EAAEiC,CAAC,CAAC7hB,EAAEonB,cAAc,CAACG,aAAanB,EAAGxG,GAAG,CACnY,SAAS2I,GAAGvoB,EAAE6hB,GAAG,IAAIjC,EAAEwG,EAAGvE,EAAExsB,OAAOotB,EAAE2D,EAAGvE,EAAEsF,cAAc,MAAMvH,KAAIA,EAAE,GAAGA,KAAM5f,EAAE3K,QAAQ2K,EAAE3K,MAAMuqB,GAAG,MAAMiC,EAAEsF,cAAcnnB,EAAEmnB,eAAevH,IAAI5f,EAAEmnB,aAAavH,IAAI,MAAM6C,IAAIziB,EAAEmnB,aAAa,GAAG1E,EAAE,CAAC,SAAS+F,GAAGxoB,GAAG,IAAI6hB,EAAE7hB,EAAEyoB,YAAY5G,IAAI7hB,EAAEonB,cAAcG,cAAc,KAAK1F,GAAG,OAAOA,IAAI7hB,EAAE3K,MAAMwsB,EAAE,CAAC,SAAS6G,GAAG1oB,GAAG,OAAOA,GAAG,IAAK,MAAM,MAAM,6BAA6B,IAAK,OAAO,MAAM,qCAAqC,QAAQ,MAAM,+BAA+B,CAC7c,SAAS2oB,GAAG3oB,EAAE6hB,GAAG,OAAO,MAAM7hB,GAAG,iCAAiCA,EAAE0oB,GAAG7G,GAAG,+BAA+B7hB,GAAG,kBAAkB6hB,EAAE,+BAA+B7hB,CAAC,CAChK,IAAI4oB,GAAe5oB,GAAZ6oB,IAAY7oB,GAAsJ,SAASA,EAAE6hB,GAAG,GAAG,+BAA+B7hB,EAAE8oB,cAAc,cAAc9oB,EAAEA,EAAE+oB,UAAUlH,MAAM,CAA2F,KAA1F+G,GAAGA,IAAIrvB,SAASI,cAAc,QAAUovB,UAAU,QAAQlH,EAAE7a,UAAUlT,WAAW,SAAa+tB,EAAE+G,GAAGI,WAAWhpB,EAAEgpB,YAAYhpB,EAAEipB,YAAYjpB,EAAEgpB,YAAY,KAAKnH,EAAEmH,YAAYhpB,EAAEkF,YAAY2c,EAAEmH,WAAW,CAAC,EAAvb,qBAAqBE,OAAOA,MAAMC,wBAAwB,SAAStH,EAAEjC,EAAE6C,EAAE1Q,GAAGmX,MAAMC,yBAAwB,WAAW,OAAOnpB,GAAE6hB,EAAEjC,EAAM,GAAE,EAAE5f,IACtK,SAASopB,GAAGppB,EAAE6hB,GAAG,GAAGA,EAAE,CAAC,IAAIjC,EAAE5f,EAAEgpB,WAAW,GAAGpJ,GAAGA,IAAI5f,EAAEqpB,WAAW,IAAIzJ,EAAEnO,SAAwB,YAAdmO,EAAE0J,UAAUzH,EAAS,CAAC7hB,EAAEyoB,YAAY5G,CAAC,CACtH,IAAI0H,GAAG,CAACC,yBAAwB,EAAGC,aAAY,EAAGC,mBAAkB,EAAGC,kBAAiB,EAAGC,kBAAiB,EAAGC,SAAQ,EAAGC,cAAa,EAAGC,iBAAgB,EAAGC,aAAY,EAAGC,SAAQ,EAAGC,MAAK,EAAGC,UAAS,EAAGC,cAAa,EAAGC,YAAW,EAAGC,cAAa,EAAGC,WAAU,EAAGC,UAAS,EAAGC,SAAQ,EAAGC,YAAW,EAAGC,aAAY,EAAGC,cAAa,EAAGC,YAAW,EAAGC,eAAc,EAAGC,gBAAe,EAAGC,iBAAgB,EAAGC,YAAW,EAAGC,WAAU,EAAGC,YAAW,EAAGC,SAAQ,EAAGC,OAAM,EAAGC,SAAQ,EAAGC,SAAQ,EAAGC,QAAO,EAAGC,QAAO,EAClfC,MAAK,EAAGC,aAAY,EAAGC,cAAa,EAAGC,aAAY,EAAGC,iBAAgB,EAAGC,kBAAiB,EAAGC,kBAAiB,EAAGC,eAAc,EAAGC,aAAY,GAAIC,GAAG,CAAC,SAAS,KAAK,MAAM,KAA6H,SAASC,GAAGpsB,EAAE6hB,EAAEjC,GAAG,OAAO,MAAMiC,GAAG,mBAAmBA,GAAG,KAAKA,EAAE,GAAGjC,GAAG,kBAAkBiC,GAAG,IAAIA,GAAG0H,GAAGt2B,eAAe+M,IAAIupB,GAAGvpB,IAAI,GAAG6hB,GAAGwD,OAAOxD,EAAE,IAAI,CACzb,SAASwK,GAAGrsB,EAAE6hB,GAAa,IAAI,IAAIjC,KAAlB5f,EAAEA,EAAEgF,MAAmB6c,EAAE,GAAGA,EAAE5uB,eAAe2sB,GAAG,CAAC,IAAI6C,EAAE,IAAI7C,EAAEtpB,QAAQ,MAAMyb,EAAEqa,GAAGxM,EAAEiC,EAAEjC,GAAG6C,GAAG,UAAU7C,IAAIA,EAAE,YAAY6C,EAAEziB,EAAEssB,YAAY1M,EAAE7N,GAAG/R,EAAE4f,GAAG7N,CAAC,CAAC,CADYhe,OAAOmE,KAAKqxB,IAAIhX,SAAQ,SAASvS,GAAGmsB,GAAG5Z,SAAQ,SAASsP,GAAGA,EAAEA,EAAE7hB,EAAE1K,OAAO,GAAG+tB,cAAcrjB,EAAEusB,UAAU,GAAGhD,GAAG1H,GAAG0H,GAAGvpB,EAAE,GAAE,IAChI,IAAIwsB,GAAG9gB,EAAE,CAAC+gB,UAAS,GAAI,CAACC,MAAK,EAAGC,MAAK,EAAGC,IAAG,EAAGC,KAAI,EAAGC,OAAM,EAAGC,IAAG,EAAGC,KAAI,EAAGnmB,OAAM,EAAGomB,QAAO,EAAGC,MAAK,EAAGC,MAAK,EAAGC,OAAM,EAAGp1B,QAAO,EAAGq1B,OAAM,EAAGC,KAAI,IAClT,SAASC,GAAGvtB,EAAE6hB,GAAG,GAAGA,EAAE,CAAC,GAAG2K,GAAGxsB,KAAK,MAAM6hB,EAAEwG,UAAU,MAAMxG,EAAEuG,yBAAyB,MAAMhD,MAAMxD,EAAE,IAAI5hB,IAAI,GAAG,MAAM6hB,EAAEuG,wBAAwB,CAAC,GAAG,MAAMvG,EAAEwG,SAAS,MAAMjD,MAAMxD,EAAE,KAAK,GAAG,kBAAkBC,EAAEuG,2BAA2B,WAAWvG,EAAEuG,yBAAyB,MAAMhD,MAAMxD,EAAE,IAAK,CAAC,GAAG,MAAMC,EAAE7c,OAAO,kBAAkB6c,EAAE7c,MAAM,MAAMogB,MAAMxD,EAAE,IAAK,CAAC,CAClW,SAAS4L,GAAGxtB,EAAE6hB,GAAG,IAAI,IAAI7hB,EAAE1J,QAAQ,KAAK,MAAM,kBAAkBurB,EAAE4L,GAAG,OAAOztB,GAAG,IAAK,iBAAiB,IAAK,gBAAgB,IAAK,YAAY,IAAK,gBAAgB,IAAK,gBAAgB,IAAK,mBAAmB,IAAK,iBAAiB,IAAK,gBAAgB,OAAM,EAAG,QAAQ,OAAM,EAAG,CAAC,IAAI0tB,GAAG,KAAK,SAASC,GAAG3tB,GAA6F,OAA1FA,EAAEA,EAAEjI,QAAQiI,EAAE4tB,YAAYhuB,QAASiuB,0BAA0B7tB,EAAEA,EAAE6tB,yBAAgC,IAAI7tB,EAAEyR,SAASzR,EAAE8tB,WAAW9tB,CAAC,CAAC,IAAI+tB,GAAG,KAAKC,GAAG,KAAKC,GAAG,KACpc,SAASC,GAAGluB,GAAG,GAAGA,EAAEmuB,GAAGnuB,GAAG,CAAC,GAAG,oBAAoB+tB,GAAG,MAAM3I,MAAMxD,EAAE,MAAM,IAAIC,EAAE7hB,EAAEouB,UAAUvM,IAAIA,EAAEwM,GAAGxM,GAAGkM,GAAG/tB,EAAEouB,UAAUpuB,EAAEqB,KAAKwgB,GAAG,CAAC,CAAC,SAASyM,GAAGtuB,GAAGguB,GAAGC,GAAGA,GAAGx6B,KAAKuM,GAAGiuB,GAAG,CAACjuB,GAAGguB,GAAGhuB,CAAC,CAAC,SAASuuB,KAAK,GAAGP,GAAG,CAAC,IAAIhuB,EAAEguB,GAAGnM,EAAEoM,GAAoB,GAAjBA,GAAGD,GAAG,KAAKE,GAAGluB,GAAM6hB,EAAE,IAAI7hB,EAAE,EAAEA,EAAE6hB,EAAEvuB,OAAO0M,IAAIkuB,GAAGrM,EAAE7hB,GAAG,CAAC,CAAC,SAASwuB,GAAGxuB,EAAE6hB,GAAG,OAAO7hB,EAAE6hB,EAAE,CAAC,SAAS4M,KAAK,CAAC,IAAIC,IAAG,EAAG,SAASC,GAAG3uB,EAAE6hB,EAAEjC,GAAG,GAAG8O,GAAG,OAAO1uB,EAAE6hB,EAAEjC,GAAG8O,IAAG,EAAG,IAAI,OAAOF,GAAGxuB,EAAE6hB,EAAEjC,EAAE,CAAC,QAAW8O,IAAG,GAAG,OAAOV,IAAI,OAAOC,MAAGQ,KAAKF,KAAI,CAAC,CAChb,SAASK,GAAG5uB,EAAE6hB,GAAG,IAAIjC,EAAE5f,EAAEouB,UAAU,GAAG,OAAOxO,EAAE,OAAO,KAAK,IAAI6C,EAAE4L,GAAGzO,GAAG,GAAG,OAAO6C,EAAE,OAAO,KAAK7C,EAAE6C,EAAEZ,GAAG7hB,EAAE,OAAO6hB,GAAG,IAAK,UAAU,IAAK,iBAAiB,IAAK,gBAAgB,IAAK,uBAAuB,IAAK,cAAc,IAAK,qBAAqB,IAAK,cAAc,IAAK,qBAAqB,IAAK,YAAY,IAAK,mBAAmB,IAAK,gBAAgBY,GAAGA,EAAEyF,YAAqBzF,IAAI,YAAbziB,EAAEA,EAAEqB,OAAuB,UAAUrB,GAAG,WAAWA,GAAG,aAAaA,IAAIA,GAAGyiB,EAAE,MAAMziB,EAAE,QAAQA,GAAE,EAAG,GAAGA,EAAE,OAAO,KAAK,GAAG4f,GAAG,oBACleA,EAAE,MAAMwF,MAAMxD,EAAE,IAAIC,SAASjC,IAAI,OAAOA,CAAC,CAAC,IAAIiP,IAAG,EAAG,GAAG1M,EAAG,IAAI,IAAI2M,GAAG,CAAC,EAAE/6B,OAAOiB,eAAe85B,GAAG,UAAU,CAACz1B,IAAI,WAAWw1B,IAAG,CAAE,IAAIjvB,OAAOmvB,iBAAiB,OAAOD,GAAGA,IAAIlvB,OAAOovB,oBAAoB,OAAOF,GAAGA,GAAG,CAAC,MAAM9uB,IAAG6uB,IAAG,CAAE,CAAC,SAASI,GAAGjvB,EAAE6hB,EAAEjC,EAAE6C,EAAE1Q,EAAE5Z,EAAEuqB,EAAE+C,EAAEC,GAAG,IAAIlX,EAAE9a,MAAMM,UAAUgD,MAAM7C,KAAKd,UAAU,GAAG,IAAIwuB,EAAEhuB,MAAM+rB,EAAEpR,EAAE,CAAC,MAAMnP,GAAGS,KAAKovB,QAAQ7vB,EAAE,CAAC,CAAC,IAAI8vB,IAAG,EAAGC,GAAG,KAAKC,IAAG,EAAGC,GAAG,KAAKC,GAAG,CAACL,QAAQ,SAASlvB,GAAGmvB,IAAG,EAAGC,GAAGpvB,CAAC,GAAG,SAASwvB,GAAGxvB,EAAE6hB,EAAEjC,EAAE6C,EAAE1Q,EAAE5Z,EAAEuqB,EAAE+C,EAAEC,GAAGyJ,IAAG,EAAGC,GAAG,KAAKH,GAAGp7B,MAAM07B,GAAGl8B,UAAU,CACjW,SAASo8B,GAAGzvB,GAAG,IAAI6hB,EAAE7hB,EAAE4f,EAAE5f,EAAE,GAAGA,EAAE0vB,UAAU,KAAK7N,EAAE8N,QAAQ9N,EAAEA,EAAE8N,WAAW,CAAC3vB,EAAE6hB,EAAE,GAAO,KAAa,MAAjBA,EAAE7hB,GAASjE,SAAc6jB,EAAEiC,EAAE8N,QAAQ3vB,EAAE6hB,EAAE8N,aAAa3vB,EAAE,CAAC,OAAO,IAAI6hB,EAAEtqB,IAAIqoB,EAAE,IAAI,CAAC,SAASgQ,GAAG5vB,GAAG,GAAG,KAAKA,EAAEzI,IAAI,CAAC,IAAIsqB,EAAE7hB,EAAE6vB,cAAsE,GAAxD,OAAOhO,IAAkB,QAAd7hB,EAAEA,EAAE0vB,aAAqB7N,EAAE7hB,EAAE6vB,gBAAmB,OAAOhO,EAAE,OAAOA,EAAEiO,UAAU,CAAC,OAAO,IAAI,CAAC,SAASC,GAAG/vB,GAAG,GAAGyvB,GAAGzvB,KAAKA,EAAE,MAAMolB,MAAMxD,EAAE,KAAM,CAE1S,SAASoO,GAAGhwB,GAAW,OAAO,QAAfA,EADtN,SAAYA,GAAG,IAAI6hB,EAAE7hB,EAAE0vB,UAAU,IAAI7N,EAAE,CAAS,GAAG,QAAXA,EAAE4N,GAAGzvB,IAAe,MAAMolB,MAAMxD,EAAE,MAAM,OAAOC,IAAI7hB,EAAE,KAAKA,CAAC,CAAC,IAAI,IAAI4f,EAAE5f,EAAEyiB,EAAEZ,IAAI,CAAC,IAAI9P,EAAE6N,EAAE+P,OAAO,GAAG,OAAO5d,EAAE,MAAM,IAAI5Z,EAAE4Z,EAAE2d,UAAU,GAAG,OAAOv3B,EAAE,CAAY,GAAG,QAAdsqB,EAAE1Q,EAAE4d,QAAmB,CAAC/P,EAAE6C,EAAE,QAAQ,CAAC,KAAK,CAAC,GAAG1Q,EAAEke,QAAQ93B,EAAE83B,MAAM,CAAC,IAAI93B,EAAE4Z,EAAEke,MAAM93B,GAAG,CAAC,GAAGA,IAAIynB,EAAE,OAAOmQ,GAAGhe,GAAG/R,EAAE,GAAG7H,IAAIsqB,EAAE,OAAOsN,GAAGhe,GAAG8P,EAAE1pB,EAAEA,EAAE+3B,OAAO,CAAC,MAAM9K,MAAMxD,EAAE,KAAM,CAAC,GAAGhC,EAAE+P,SAASlN,EAAEkN,OAAO/P,EAAE7N,EAAE0Q,EAAEtqB,MAAM,CAAC,IAAI,IAAIuqB,GAAE,EAAG+C,EAAE1T,EAAEke,MAAMxK,GAAG,CAAC,GAAGA,IAAI7F,EAAE,CAAC8C,GAAE,EAAG9C,EAAE7N,EAAE0Q,EAAEtqB,EAAE,KAAK,CAAC,GAAGstB,IAAIhD,EAAE,CAACC,GAAE,EAAGD,EAAE1Q,EAAE6N,EAAEznB,EAAE,KAAK,CAACstB,EAAEA,EAAEyK,OAAO,CAAC,IAAIxN,EAAE,CAAC,IAAI+C,EAAEttB,EAAE83B,MAAMxK,GAAG,CAAC,GAAGA,IAC5f7F,EAAE,CAAC8C,GAAE,EAAG9C,EAAEznB,EAAEsqB,EAAE1Q,EAAE,KAAK,CAAC,GAAG0T,IAAIhD,EAAE,CAACC,GAAE,EAAGD,EAAEtqB,EAAEynB,EAAE7N,EAAE,KAAK,CAAC0T,EAAEA,EAAEyK,OAAO,CAAC,IAAIxN,EAAE,MAAM0C,MAAMxD,EAAE,KAAM,CAAC,CAAC,GAAGhC,EAAE8P,YAAYjN,EAAE,MAAM2C,MAAMxD,EAAE,KAAM,CAAC,GAAG,IAAIhC,EAAEroB,IAAI,MAAM6tB,MAAMxD,EAAE,MAAM,OAAOhC,EAAEwO,UAAUhoB,UAAUwZ,EAAE5f,EAAE6hB,CAAC,CAAkBsO,CAAGnwB,IAAmBowB,GAAGpwB,GAAG,IAAI,CAAC,SAASowB,GAAGpwB,GAAG,GAAG,IAAIA,EAAEzI,KAAK,IAAIyI,EAAEzI,IAAI,OAAOyI,EAAE,IAAIA,EAAEA,EAAEiwB,MAAM,OAAOjwB,GAAG,CAAC,IAAI6hB,EAAEuO,GAAGpwB,GAAG,GAAG,OAAO6hB,EAAE,OAAOA,EAAE7hB,EAAEA,EAAEkwB,OAAO,CAAC,OAAO,IAAI,CAC1X,IAAIG,GAAG1O,EAAG2O,0BAA0BC,GAAG5O,EAAG6O,wBAAwBC,GAAG9O,EAAG+O,qBAAqBC,GAAGhP,EAAGiP,sBAAsBC,GAAElP,EAAGmP,aAAaC,GAAGpP,EAAGqP,iCAAiCC,GAAGtP,EAAGuP,2BAA2BC,GAAGxP,EAAGyP,8BAA8BC,GAAG1P,EAAG2P,wBAAwBC,GAAG5P,EAAG6P,qBAAqBC,GAAG9P,EAAG+P,sBAAsBC,GAAG,KAAKC,GAAG,KACvV,IAAIC,GAAGlzB,KAAKmzB,MAAMnzB,KAAKmzB,MAAiC,SAAY9xB,GAAU,OAAPA,KAAK,EAAS,IAAIA,EAAE,GAAG,IAAI+xB,GAAG/xB,GAAGgyB,GAAG,GAAG,CAAC,EAA/ED,GAAGpzB,KAAKszB,IAAID,GAAGrzB,KAAKuzB,IAA4D,IAAIC,GAAG,GAAGC,GAAG,QAC7H,SAASC,GAAGryB,GAAG,OAAOA,GAAGA,GAAG,KAAK,EAAE,OAAO,EAAE,KAAK,EAAE,OAAO,EAAE,KAAK,EAAE,OAAO,EAAE,KAAK,EAAE,OAAO,EAAE,KAAK,GAAG,OAAO,GAAG,KAAK,GAAG,OAAO,GAAG,KAAK,GAAG,KAAK,IAAI,KAAK,IAAI,KAAK,IAAI,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,MAAM,KAAK,MAAM,KAAK,MAAM,KAAK,OAAO,KAAK,OAAO,KAAK,OAAO,KAAK,QAAQ,KAAK,QAAQ,OAAS,QAAFA,EAAU,KAAK,QAAQ,KAAK,QAAQ,KAAK,SAAS,KAAK,SAAS,KAAK,SAAS,OAAS,UAAFA,EAAY,KAAK,UAAU,OAAO,UAAU,KAAK,UAAU,OAAO,UAAU,KAAK,UAAU,OAAO,UAAU,KAAK,WAAW,OAAO,WACzgB,QAAQ,OAAOA,EAAE,CAAC,SAASsyB,GAAGtyB,EAAE6hB,GAAG,IAAIjC,EAAE5f,EAAEuyB,aAAa,GAAG,IAAI3S,EAAE,OAAO,EAAE,IAAI6C,EAAE,EAAE1Q,EAAE/R,EAAEwyB,eAAer6B,EAAE6H,EAAEyyB,YAAY/P,EAAI,UAAF9C,EAAY,GAAG,IAAI8C,EAAE,CAAC,IAAI+C,EAAE/C,GAAG3Q,EAAE,IAAI0T,EAAEhD,EAAE4P,GAAG5M,GAAS,KAALttB,GAAGuqB,KAAUD,EAAE4P,GAAGl6B,GAAI,MAAa,KAAPuqB,EAAE9C,GAAG7N,GAAQ0Q,EAAE4P,GAAG3P,GAAG,IAAIvqB,IAAIsqB,EAAE4P,GAAGl6B,IAAI,GAAG,IAAIsqB,EAAE,OAAO,EAAE,GAAG,IAAIZ,GAAGA,IAAIY,GAAG,KAAKZ,EAAE9P,MAAKA,EAAE0Q,GAAGA,KAAEtqB,EAAE0pB,GAAGA,IAAQ,KAAK9P,GAAG,KAAO,QAAF5Z,IAAY,OAAO0pB,EAA0C,GAAxC,KAAO,EAAFY,KAAOA,GAAK,GAAF7C,GAA4B,KAAtBiC,EAAE7hB,EAAE0yB,gBAAwB,IAAI1yB,EAAEA,EAAE2yB,cAAc9Q,GAAGY,EAAE,EAAEZ,GAAc9P,EAAE,IAAb6N,EAAE,GAAGiS,GAAGhQ,IAAUY,GAAGziB,EAAE4f,GAAGiC,IAAI9P,EAAE,OAAO0Q,CAAC,CACvc,SAASmQ,GAAG5yB,EAAE6hB,GAAG,OAAO7hB,GAAG,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,OAAO6hB,EAAE,IAAI,KAAK,EAAE,KAAK,GAAG,KAAK,GAAG,KAAK,GAAG,KAAK,IAAI,KAAK,IAAI,KAAK,IAAI,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,MAAM,KAAK,MAAM,KAAK,MAAM,KAAK,OAAO,KAAK,OAAO,KAAK,OAAO,KAAK,QAAQ,KAAK,QAAQ,OAAOA,EAAE,IAAuJ,QAAQ,OAAO,EAAE,CACrN,SAASgR,GAAG7yB,GAAgC,OAAO,KAApCA,GAAkB,WAAhBA,EAAEuyB,cAAsCvyB,EAAI,WAAFA,EAAa,WAAW,CAAC,CAAC,SAAS8yB,KAAK,IAAI9yB,EAAEmyB,GAAoC,OAA1B,KAAQ,SAAfA,KAAK,MAAqBA,GAAG,IAAWnyB,CAAC,CAAC,SAAS+yB,GAAG/yB,GAAG,IAAI,IAAI6hB,EAAE,GAAGjC,EAAE,EAAE,GAAGA,EAAEA,IAAIiC,EAAEpuB,KAAKuM,GAAG,OAAO6hB,CAAC,CAC3a,SAASmR,GAAGhzB,EAAE6hB,EAAEjC,GAAG5f,EAAEuyB,cAAc1Q,EAAE,YAAYA,IAAI7hB,EAAEwyB,eAAe,EAAExyB,EAAEyyB,YAAY,IAAGzyB,EAAEA,EAAEizB,YAAWpR,EAAE,GAAGgQ,GAAGhQ,IAAQjC,CAAC,CACzH,SAASsT,GAAGlzB,EAAE6hB,GAAG,IAAIjC,EAAE5f,EAAE0yB,gBAAgB7Q,EAAE,IAAI7hB,EAAEA,EAAE2yB,cAAc/S,GAAG,CAAC,IAAI6C,EAAE,GAAGoP,GAAGjS,GAAG7N,EAAE,GAAG0Q,EAAE1Q,EAAE8P,EAAE7hB,EAAEyiB,GAAGZ,IAAI7hB,EAAEyiB,IAAIZ,GAAGjC,IAAI7N,CAAC,CAAC,CAAC,IAAIpb,GAAE,EAAE,SAASw8B,GAAGnzB,GAAS,OAAO,GAAbA,IAAIA,GAAa,EAAEA,EAAE,KAAO,UAAFA,GAAa,GAAG,UAAU,EAAE,CAAC,CAAC,IAAIozB,GAAGC,GAAGC,GAAGC,GAAGC,GAAGC,IAAG,EAAGC,GAAG,GAAGC,GAAG,KAAKC,GAAG,KAAKC,GAAG,KAAKC,GAAG,IAAIjgB,IAAIkgB,GAAG,IAAIlgB,IAAImgB,GAAG,GAAGC,GAAG,6PAA6P75B,MAAM,KAChiB,SAAS85B,GAAGl0B,EAAE6hB,GAAG,OAAO7hB,GAAG,IAAK,UAAU,IAAK,WAAW2zB,GAAG,KAAK,MAAM,IAAK,YAAY,IAAK,YAAYC,GAAG,KAAK,MAAM,IAAK,YAAY,IAAK,WAAWC,GAAG,KAAK,MAAM,IAAK,cAAc,IAAK,aAAaC,GAAGK,OAAOtS,EAAEuS,WAAW,MAAM,IAAK,oBAAoB,IAAK,qBAAqBL,GAAGI,OAAOtS,EAAEuS,WAAW,CACnT,SAASC,GAAGr0B,EAAE6hB,EAAEjC,EAAE6C,EAAE1Q,EAAE5Z,GAAG,OAAG,OAAO6H,GAAGA,EAAEs0B,cAAcn8B,GAAS6H,EAAE,CAACu0B,UAAU1S,EAAE2S,aAAa5U,EAAE6U,iBAAiBhS,EAAE6R,YAAYn8B,EAAEu8B,iBAAiB,CAAC3iB,IAAI,OAAO8P,IAAY,QAARA,EAAEsM,GAAGtM,KAAawR,GAAGxR,IAAI7hB,IAAEA,EAAEy0B,kBAAkBhS,EAAEZ,EAAE7hB,EAAE00B,iBAAiB,OAAO3iB,IAAI,IAAI8P,EAAEvrB,QAAQyb,IAAI8P,EAAEpuB,KAAKse,GAAU/R,EAAC,CAEpR,SAAS20B,GAAG30B,GAAG,IAAI6hB,EAAE+S,GAAG50B,EAAEjI,QAAQ,GAAG,OAAO8pB,EAAE,CAAC,IAAIjC,EAAE6P,GAAG5N,GAAG,GAAG,OAAOjC,EAAE,GAAW,MAARiC,EAAEjC,EAAEroB,MAAY,GAAW,QAARsqB,EAAE+N,GAAGhQ,IAA4D,OAA/C5f,EAAEu0B,UAAU1S,OAAE2R,GAAGxzB,EAAE60B,UAAS,WAAWvB,GAAG1T,EAAE,SAAgB,GAAG,IAAIiC,GAAGjC,EAAEwO,UAAUhoB,QAAQypB,cAAciF,aAAmE,YAArD90B,EAAEu0B,UAAU,IAAI3U,EAAEroB,IAAIqoB,EAAEwO,UAAU2G,cAAc,KAAY,CAAC/0B,EAAEu0B,UAAU,IAAI,CAClT,SAASS,GAAGh1B,GAAG,GAAG,OAAOA,EAAEu0B,UAAU,OAAM,EAAG,IAAI,IAAI1S,EAAE7hB,EAAE00B,iBAAiB,EAAE7S,EAAEvuB,QAAQ,CAAC,IAAIssB,EAAEqV,GAAGj1B,EAAEw0B,aAAax0B,EAAEy0B,iBAAiB5S,EAAE,GAAG7hB,EAAEs0B,aAAa,GAAG,OAAO1U,EAAiG,OAAe,QAARiC,EAAEsM,GAAGvO,KAAayT,GAAGxR,GAAG7hB,EAAEu0B,UAAU3U,GAAE,EAA3H,IAAI6C,EAAE,IAAtB7C,EAAE5f,EAAEs0B,aAAwB19B,YAAYgpB,EAAEve,KAAKue,GAAG8N,GAAGjL,EAAE7C,EAAE7nB,OAAOm9B,cAAczS,GAAGiL,GAAG,KAA0D7L,EAAEsT,OAAO,CAAC,OAAM,CAAE,CAAC,SAASC,GAAGp1B,EAAE6hB,EAAEjC,GAAGoV,GAAGh1B,IAAI4f,EAAEuU,OAAOtS,EAAE,CAAC,SAASwT,KAAK5B,IAAG,EAAG,OAAOE,IAAIqB,GAAGrB,MAAMA,GAAG,MAAM,OAAOC,IAAIoB,GAAGpB,MAAMA,GAAG,MAAM,OAAOC,IAAImB,GAAGnB,MAAMA,GAAG,MAAMC,GAAGvhB,QAAQ6iB,IAAIrB,GAAGxhB,QAAQ6iB,GAAG,CACnf,SAASE,GAAGt1B,EAAE6hB,GAAG7hB,EAAEu0B,YAAY1S,IAAI7hB,EAAEu0B,UAAU,KAAKd,KAAKA,IAAG,EAAG9R,EAAG2O,0BAA0B3O,EAAG2P,wBAAwB+D,KAAK,CAC5H,SAASE,GAAGv1B,GAAG,SAAS6hB,EAAEA,GAAG,OAAOyT,GAAGzT,EAAE7hB,EAAE,CAAC,GAAG,EAAE0zB,GAAGpgC,OAAO,CAACgiC,GAAG5B,GAAG,GAAG1zB,GAAG,IAAI,IAAI4f,EAAE,EAAEA,EAAE8T,GAAGpgC,OAAOssB,IAAI,CAAC,IAAI6C,EAAEiR,GAAG9T,GAAG6C,EAAE8R,YAAYv0B,IAAIyiB,EAAE8R,UAAU,KAAK,CAAC,CAAyF,IAAxF,OAAOZ,IAAI2B,GAAG3B,GAAG3zB,GAAG,OAAO4zB,IAAI0B,GAAG1B,GAAG5zB,GAAG,OAAO6zB,IAAIyB,GAAGzB,GAAG7zB,GAAG8zB,GAAGvhB,QAAQsP,GAAGkS,GAAGxhB,QAAQsP,GAAOjC,EAAE,EAAEA,EAAEoU,GAAG1gC,OAAOssB,KAAI6C,EAAEuR,GAAGpU,IAAK2U,YAAYv0B,IAAIyiB,EAAE8R,UAAU,MAAM,KAAK,EAAEP,GAAG1gC,QAAiB,QAARssB,EAAEoU,GAAG,IAAYO,WAAYI,GAAG/U,GAAG,OAAOA,EAAE2U,WAAWP,GAAGmB,OAAO,CAAC,IAAIK,GAAGzR,EAAG0R,wBAAwBC,IAAG,EAC5a,SAASC,GAAG31B,EAAE6hB,EAAEjC,EAAE6C,GAAG,IAAI1Q,EAAEpb,GAAEwB,EAAEq9B,GAAGI,WAAWJ,GAAGI,WAAW,KAAK,IAAIj/B,GAAE,EAAEk/B,GAAG71B,EAAE6hB,EAAEjC,EAAE6C,EAAE,CAAC,QAAQ9rB,GAAEob,EAAEyjB,GAAGI,WAAWz9B,CAAC,CAAC,CAAC,SAAS29B,GAAG91B,EAAE6hB,EAAEjC,EAAE6C,GAAG,IAAI1Q,EAAEpb,GAAEwB,EAAEq9B,GAAGI,WAAWJ,GAAGI,WAAW,KAAK,IAAIj/B,GAAE,EAAEk/B,GAAG71B,EAAE6hB,EAAEjC,EAAE6C,EAAE,CAAC,QAAQ9rB,GAAEob,EAAEyjB,GAAGI,WAAWz9B,CAAC,CAAC,CACjO,SAAS09B,GAAG71B,EAAE6hB,EAAEjC,EAAE6C,GAAG,GAAGiT,GAAG,CAAC,IAAI3jB,EAAEkjB,GAAGj1B,EAAE6hB,EAAEjC,EAAE6C,GAAG,GAAG,OAAO1Q,EAAEgkB,GAAG/1B,EAAE6hB,EAAEY,EAAE5X,GAAG+U,GAAGsU,GAAGl0B,EAAEyiB,QAAQ,GANtF,SAAYziB,EAAE6hB,EAAEjC,EAAE6C,EAAE1Q,GAAG,OAAO8P,GAAG,IAAK,UAAU,OAAO8R,GAAGU,GAAGV,GAAG3zB,EAAE6hB,EAAEjC,EAAE6C,EAAE1Q,IAAG,EAAG,IAAK,YAAY,OAAO6hB,GAAGS,GAAGT,GAAG5zB,EAAE6hB,EAAEjC,EAAE6C,EAAE1Q,IAAG,EAAG,IAAK,YAAY,OAAO8hB,GAAGQ,GAAGR,GAAG7zB,EAAE6hB,EAAEjC,EAAE6C,EAAE1Q,IAAG,EAAG,IAAK,cAAc,IAAI5Z,EAAE4Z,EAAEqiB,UAAkD,OAAxCN,GAAGxzB,IAAInI,EAAEk8B,GAAGP,GAAGz6B,IAAIlB,IAAI,KAAK6H,EAAE6hB,EAAEjC,EAAE6C,EAAE1Q,KAAU,EAAG,IAAK,oBAAoB,OAAO5Z,EAAE4Z,EAAEqiB,UAAUL,GAAGzzB,IAAInI,EAAEk8B,GAAGN,GAAG16B,IAAIlB,IAAI,KAAK6H,EAAE6hB,EAAEjC,EAAE6C,EAAE1Q,KAAI,EAAG,OAAM,CAAE,CAM1QikB,CAAGjkB,EAAE/R,EAAE6hB,EAAEjC,EAAE6C,GAAGA,EAAEwT,uBAAuB,GAAG/B,GAAGl0B,EAAEyiB,GAAK,EAAFZ,IAAM,EAAEoS,GAAG39B,QAAQ0J,GAAG,CAAC,KAAK,OAAO+R,GAAG,CAAC,IAAI5Z,EAAEg2B,GAAGpc,GAA0D,GAAvD,OAAO5Z,GAAGi7B,GAAGj7B,GAAiB,QAAdA,EAAE88B,GAAGj1B,EAAE6hB,EAAEjC,EAAE6C,KAAasT,GAAG/1B,EAAE6hB,EAAEY,EAAE5X,GAAG+U,GAAMznB,IAAI4Z,EAAE,MAAMA,EAAE5Z,CAAC,CAAC,OAAO4Z,GAAG0Q,EAAEwT,iBAAiB,MAAMF,GAAG/1B,EAAE6hB,EAAEY,EAAE,KAAK7C,EAAE,CAAC,CAAC,IAAI/U,GAAG,KACpU,SAASoqB,GAAGj1B,EAAE6hB,EAAEjC,EAAE6C,GAA2B,GAAxB5X,GAAG,KAAwB,QAAX7K,EAAE40B,GAAV50B,EAAE2tB,GAAGlL,KAAuB,GAAW,QAARZ,EAAE4N,GAAGzvB,IAAYA,EAAE,UAAU,GAAW,MAAR4f,EAAEiC,EAAEtqB,KAAW,CAAS,GAAG,QAAXyI,EAAE4vB,GAAG/N,IAAe,OAAO7hB,EAAEA,EAAE,IAAI,MAAM,GAAG,IAAI4f,EAAE,CAAC,GAAGiC,EAAEuM,UAAUhoB,QAAQypB,cAAciF,aAAa,OAAO,IAAIjT,EAAEtqB,IAAIsqB,EAAEuM,UAAU2G,cAAc,KAAK/0B,EAAE,IAAI,MAAM6hB,IAAI7hB,IAAIA,EAAE,MAAW,OAAL6K,GAAG7K,EAAS,IAAI,CAC7S,SAASk2B,GAAGl2B,GAAG,OAAOA,GAAG,IAAK,SAAS,IAAK,QAAQ,IAAK,QAAQ,IAAK,cAAc,IAAK,OAAO,IAAK,MAAM,IAAK,WAAW,IAAK,WAAW,IAAK,UAAU,IAAK,YAAY,IAAK,OAAO,IAAK,UAAU,IAAK,WAAW,IAAK,QAAQ,IAAK,UAAU,IAAK,UAAU,IAAK,WAAW,IAAK,QAAQ,IAAK,YAAY,IAAK,UAAU,IAAK,QAAQ,IAAK,QAAQ,IAAK,OAAO,IAAK,gBAAgB,IAAK,cAAc,IAAK,YAAY,IAAK,aAAa,IAAK,QAAQ,IAAK,SAAS,IAAK,SAAS,IAAK,SAAS,IAAK,cAAc,IAAK,WAAW,IAAK,aAAa,IAAK,eAAe,IAAK,SAAS,IAAK,kBAAkB,IAAK,YAAY,IAAK,mBAAmB,IAAK,iBAAiB,IAAK,oBAAoB,IAAK,aAAa,IAAK,YAAY,IAAK,cAAc,IAAK,OAAO,IAAK,mBAAmB,IAAK,QAAQ,IAAK,aAAa,IAAK,WAAW,IAAK,SAAS,IAAK,cAAc,OAAO,EAAE,IAAK,OAAO,IAAK,YAAY,IAAK,WAAW,IAAK,YAAY,IAAK,WAAW,IAAK,YAAY,IAAK,WAAW,IAAK,YAAY,IAAK,cAAc,IAAK,aAAa,IAAK,cAAc,IAAK,SAAS,IAAK,SAAS,IAAK,YAAY,IAAK,QAAQ,IAAK,aAAa,IAAK,aAAa,IAAK,eAAe,IAAK,eAAe,OAAO,EACpqC,IAAK,UAAU,OAAO+wB,MAAM,KAAKE,GAAG,OAAO,EAAE,KAAKE,GAAG,OAAO,EAAE,KAAKE,GAAG,KAAKE,GAAG,OAAO,GAAG,KAAKE,GAAG,OAAO,UAAU,QAAQ,OAAO,GAAG,QAAQ,OAAO,GAAG,CAAC,IAAI0E,GAAG,KAAKC,GAAG,KAAKC,GAAG,KAAK,SAASC,KAAK,GAAGD,GAAG,OAAOA,GAAG,IAAIr2B,EAAkByiB,EAAhBZ,EAAEuU,GAAGxW,EAAEiC,EAAEvuB,OAASye,EAAE,UAAUokB,GAAGA,GAAG9gC,MAAM8gC,GAAG1N,YAAYtwB,EAAE4Z,EAAEze,OAAO,IAAI0M,EAAE,EAAEA,EAAE4f,GAAGiC,EAAE7hB,KAAK+R,EAAE/R,GAAGA,KAAK,IAAI0iB,EAAE9C,EAAE5f,EAAE,IAAIyiB,EAAE,EAAEA,GAAGC,GAAGb,EAAEjC,EAAE6C,KAAK1Q,EAAE5Z,EAAEsqB,GAAGA,KAAK,OAAO4T,GAAGtkB,EAAE/a,MAAMgJ,EAAE,EAAEyiB,EAAE,EAAEA,OAAE,EAAO,CACxY,SAAS8T,GAAGv2B,GAAG,IAAI6hB,EAAE7hB,EAAEw2B,QAA+E,MAAvE,aAAax2B,EAAgB,KAAbA,EAAEA,EAAEy2B,WAAgB,KAAK5U,IAAI7hB,EAAE,IAAKA,EAAE6hB,EAAE,KAAK7hB,IAAIA,EAAE,IAAW,IAAIA,GAAG,KAAKA,EAAEA,EAAE,CAAC,CAAC,SAAS02B,KAAK,OAAM,CAAE,CAAC,SAASC,KAAK,OAAM,CAAE,CAC5K,SAASC,GAAG52B,GAAG,SAAS6hB,EAAEA,EAAEY,EAAE1Q,EAAE5Z,EAAEuqB,GAA6G,IAAI,IAAI9C,KAAlH9f,KAAK+2B,WAAWhV,EAAE/hB,KAAKg3B,YAAY/kB,EAAEjS,KAAKuB,KAAKohB,EAAE3iB,KAAKw0B,YAAYn8B,EAAE2H,KAAK/H,OAAO2qB,EAAE5iB,KAAKi3B,cAAc,KAAkB/2B,EAAEA,EAAE/M,eAAe2sB,KAAKiC,EAAE7hB,EAAE4f,GAAG9f,KAAK8f,GAAGiC,EAAEA,EAAE1pB,GAAGA,EAAEynB,IAAgI,OAA5H9f,KAAKk3B,oBAAoB,MAAM7+B,EAAE8+B,iBAAiB9+B,EAAE8+B,kBAAiB,IAAK9+B,EAAE++B,aAAaR,GAAGC,GAAG72B,KAAKq3B,qBAAqBR,GAAU72B,IAAI,CAC9E,OAD+E4L,EAAEmW,EAAE7tB,UAAU,CAACojC,eAAe,WAAWt3B,KAAKm3B,kBAAiB,EAAG,IAAIj3B,EAAEF,KAAKw0B,YAAYt0B,IAAIA,EAAEo3B,eAAep3B,EAAEo3B,iBAAiB,mBAAmBp3B,EAAEk3B,cAC7el3B,EAAEk3B,aAAY,GAAIp3B,KAAKk3B,mBAAmBN,GAAG,EAAET,gBAAgB,WAAW,IAAIj2B,EAAEF,KAAKw0B,YAAYt0B,IAAIA,EAAEi2B,gBAAgBj2B,EAAEi2B,kBAAkB,mBAAmBj2B,EAAEq3B,eAAer3B,EAAEq3B,cAAa,GAAIv3B,KAAKq3B,qBAAqBT,GAAG,EAAEY,QAAQ,WAAW,EAAEC,aAAab,KAAY7U,CAAC,CACjR,IAAoL2V,GAAGC,GAAGC,GAAtLC,GAAG,CAACC,WAAW,EAAEC,QAAQ,EAAEC,WAAW,EAAEC,UAAU,SAAS/3B,GAAG,OAAOA,EAAE+3B,WAAWvc,KAAKD,KAAK,EAAE0b,iBAAiB,EAAEe,UAAU,GAAGC,GAAGrB,GAAGe,IAAIO,GAAGxsB,EAAE,CAAC,EAAEisB,GAAG,CAACQ,KAAK,EAAEC,OAAO,IAAIC,GAAGzB,GAAGsB,IAAaI,GAAG5sB,EAAE,CAAC,EAAEwsB,GAAG,CAACK,QAAQ,EAAEC,QAAQ,EAAEC,QAAQ,EAAEC,QAAQ,EAAEC,MAAM,EAAEC,MAAM,EAAEC,QAAQ,EAAEC,SAAS,EAAEC,OAAO,EAAEC,QAAQ,EAAEC,iBAAiBC,GAAGC,OAAO,EAAEC,QAAQ,EAAEC,cAAc,SAASr5B,GAAG,YAAO,IAASA,EAAEq5B,cAAcr5B,EAAEs5B,cAAct5B,EAAE4tB,WAAW5tB,EAAEu5B,UAAUv5B,EAAEs5B,YAAYt5B,EAAEq5B,aAAa,EAAEG,UAAU,SAASx5B,GAAG,MAAG,cAC3eA,EAASA,EAAEw5B,WAAUx5B,IAAI03B,KAAKA,IAAI,cAAc13B,EAAEqB,MAAMm2B,GAAGx3B,EAAEu4B,QAAQb,GAAGa,QAAQd,GAAGz3B,EAAEw4B,QAAQd,GAAGc,SAASf,GAAGD,GAAG,EAAEE,GAAG13B,GAAUw3B,GAAE,EAAEiC,UAAU,SAASz5B,GAAG,MAAM,cAAcA,EAAEA,EAAEy5B,UAAUhC,EAAE,IAAIiC,GAAG9C,GAAG0B,IAAiCqB,GAAG/C,GAA7BlrB,EAAE,CAAC,EAAE4sB,GAAG,CAACsB,aAAa,KAA4CC,GAAGjD,GAA9BlrB,EAAE,CAAC,EAAEwsB,GAAG,CAACmB,cAAc,KAA0ES,GAAGlD,GAA5DlrB,EAAE,CAAC,EAAEisB,GAAG,CAACoC,cAAc,EAAEC,YAAY,EAAEC,cAAc,KAAcC,GAAGxuB,EAAE,CAAC,EAAEisB,GAAG,CAACwC,cAAc,SAASn6B,GAAG,MAAM,kBAAkBA,EAAEA,EAAEm6B,cAAcv6B,OAAOu6B,aAAa,IAAIC,GAAGxD,GAAGsD,IAAyBG,GAAGzD,GAArBlrB,EAAE,CAAC,EAAEisB,GAAG,CAAC11B,KAAK,KAAcq4B,GAAG,CAACC,IAAI,SACxfC,SAAS,IAAIC,KAAK,YAAYC,GAAG,UAAUC,MAAM,aAAaC,KAAK,YAAYC,IAAI,SAASC,IAAI,KAAKC,KAAK,cAAcC,KAAK,cAAcC,OAAO,aAAaC,gBAAgB,gBAAgBC,GAAG,CAAC,EAAE,YAAY,EAAE,MAAM,GAAG,QAAQ,GAAG,QAAQ,GAAG,QAAQ,GAAG,UAAU,GAAG,MAAM,GAAG,QAAQ,GAAG,WAAW,GAAG,SAAS,GAAG,IAAI,GAAG,SAAS,GAAG,WAAW,GAAG,MAAM,GAAG,OAAO,GAAG,YAAY,GAAG,UAAU,GAAG,aAAa,GAAG,YAAY,GAAG,SAAS,GAAG,SAAS,IAAI,KAAK,IAAI,KAAK,IAAI,KAAK,IAAI,KAAK,IAAI,KAAK,IAAI,KAAK,IAAI,KACtf,IAAI,KAAK,IAAI,KAAK,IAAI,MAAM,IAAI,MAAM,IAAI,MAAM,IAAI,UAAU,IAAI,aAAa,IAAI,QAAQC,GAAG,CAACC,IAAI,SAASC,QAAQ,UAAUC,KAAK,UAAUC,MAAM,YAAY,SAASC,GAAGz7B,GAAG,IAAI6hB,EAAE/hB,KAAKw0B,YAAY,OAAOzS,EAAEoX,iBAAiBpX,EAAEoX,iBAAiBj5B,MAAIA,EAAEo7B,GAAGp7B,OAAM6hB,EAAE7hB,EAAK,CAAC,SAASk5B,KAAK,OAAOuC,EAAE,CAChS,IAAIC,GAAGhwB,EAAE,CAAC,EAAEwsB,GAAG,CAAChkC,IAAI,SAAS8L,GAAG,GAAGA,EAAE9L,IAAI,CAAC,IAAI2tB,EAAEyY,GAAGt6B,EAAE9L,MAAM8L,EAAE9L,IAAI,GAAG,iBAAiB2tB,EAAE,OAAOA,CAAC,CAAC,MAAM,aAAa7hB,EAAEqB,KAAc,MAARrB,EAAEu2B,GAAGv2B,IAAU,QAAQpK,OAAO0oB,aAAate,GAAI,YAAYA,EAAEqB,MAAM,UAAUrB,EAAEqB,KAAK85B,GAAGn7B,EAAEw2B,UAAU,eAAe,EAAE,EAAEmF,KAAK,EAAEC,SAAS,EAAE/C,QAAQ,EAAEC,SAAS,EAAEC,OAAO,EAAEC,QAAQ,EAAE6C,OAAO,EAAEC,OAAO,EAAE7C,iBAAiBC,GAAGzC,SAAS,SAASz2B,GAAG,MAAM,aAAaA,EAAEqB,KAAKk1B,GAAGv2B,GAAG,CAAC,EAAEw2B,QAAQ,SAASx2B,GAAG,MAAM,YAAYA,EAAEqB,MAAM,UAAUrB,EAAEqB,KAAKrB,EAAEw2B,QAAQ,CAAC,EAAEuF,MAAM,SAAS/7B,GAAG,MAAM,aAC7eA,EAAEqB,KAAKk1B,GAAGv2B,GAAG,YAAYA,EAAEqB,MAAM,UAAUrB,EAAEqB,KAAKrB,EAAEw2B,QAAQ,CAAC,IAAIwF,GAAGpF,GAAG8E,IAAiIO,GAAGrF,GAA7HlrB,EAAE,CAAC,EAAE4sB,GAAG,CAAClE,UAAU,EAAE8H,MAAM,EAAEC,OAAO,EAAEC,SAAS,EAAEC,mBAAmB,EAAEC,MAAM,EAAEC,MAAM,EAAEC,MAAM,EAAEC,YAAY,EAAEC,UAAU,KAAmIC,GAAG/F,GAArHlrB,EAAE,CAAC,EAAEwsB,GAAG,CAAC0E,QAAQ,EAAEC,cAAc,EAAEC,eAAe,EAAE/D,OAAO,EAAEC,QAAQ,EAAEH,QAAQ,EAAEC,SAAS,EAAEG,iBAAiBC,MAA0E6D,GAAGnG,GAA3DlrB,EAAE,CAAC,EAAEisB,GAAG,CAAC5U,aAAa,EAAEiX,YAAY,EAAEC,cAAc,KAAc+C,GAAGtxB,EAAE,CAAC,EAAE4sB,GAAG,CAAC2E,OAAO,SAASj9B,GAAG,MAAM,WAAWA,EAAEA,EAAEi9B,OAAO,gBAAgBj9B,GAAGA,EAAEk9B,YAAY,CAAC,EACnfC,OAAO,SAASn9B,GAAG,MAAM,WAAWA,EAAEA,EAAEm9B,OAAO,gBAAgBn9B,GAAGA,EAAEo9B,YAAY,eAAep9B,GAAGA,EAAEq9B,WAAW,CAAC,EAAEC,OAAO,EAAEC,UAAU,IAAIC,GAAG5G,GAAGoG,IAAIS,GAAG,CAAC,EAAE,GAAG,GAAG,IAAIC,GAAGvb,GAAI,qBAAqBviB,OAAO+9B,GAAG,KAAKxb,GAAI,iBAAiB5oB,WAAWokC,GAAGpkC,SAASqkC,cAAc,IAAIC,GAAG1b,GAAI,cAAcviB,SAAS+9B,GAAGG,GAAG3b,KAAMub,IAAIC,IAAI,EAAEA,IAAI,IAAIA,IAAIlvB,GAAG7Y,OAAO0oB,aAAa,IAAIyf,IAAG,EAC1W,SAASC,GAAGh+B,EAAE6hB,GAAG,OAAO7hB,GAAG,IAAK,QAAQ,OAAO,IAAIy9B,GAAGnnC,QAAQurB,EAAE2U,SAAS,IAAK,UAAU,OAAO,MAAM3U,EAAE2U,QAAQ,IAAK,WAAW,IAAK,YAAY,IAAK,WAAW,OAAM,EAAG,QAAQ,OAAM,EAAG,CAAC,SAASyH,GAAGj+B,GAAc,MAAM,kBAAjBA,EAAEA,EAAEo4B,SAAkC,SAASp4B,EAAEA,EAAEiC,KAAK,IAAI,CAAC,IAAIi8B,IAAG,EAE9Q,IAAIC,GAAG,CAACC,OAAM,EAAGC,MAAK,EAAGC,UAAS,EAAG,kBAAiB,EAAGC,OAAM,EAAGC,OAAM,EAAGl0B,QAAO,EAAGm0B,UAAS,EAAGC,OAAM,EAAGC,QAAO,EAAGC,KAAI,EAAGC,MAAK,EAAGxiB,MAAK,EAAGyiB,KAAI,EAAGC,MAAK,GAAI,SAASC,GAAGh/B,GAAG,IAAI6hB,EAAE7hB,GAAGA,EAAEsmB,UAAUtmB,EAAEsmB,SAAShkB,cAAc,MAAM,UAAUuf,IAAIsc,GAAGn+B,EAAEqB,MAAM,aAAawgB,CAAO,CAAC,SAASod,GAAGj/B,EAAE6hB,EAAEjC,EAAE6C,GAAG6L,GAAG7L,GAAsB,GAAnBZ,EAAEqd,GAAGrd,EAAE,aAAgBvuB,SAASssB,EAAE,IAAIqY,GAAG,WAAW,SAAS,KAAKrY,EAAE6C,GAAGziB,EAAEvM,KAAK,CAACma,MAAMgS,EAAEtR,UAAUuT,IAAI,CAAC,IAAIsd,GAAG,KAAKC,GAAG,KAAK,SAAStjC,GAAGkE,GAAGq/B,GAAGr/B,EAAE,EAAE,CAAC,SAASs/B,GAAGt/B,GAAe,GAAG4mB,EAAT2Y,GAAGv/B,IAAY,OAAOA,CAAC,CACpe,SAASw/B,GAAGx/B,EAAE6hB,GAAG,GAAG,WAAW7hB,EAAE,OAAO6hB,CAAC,CAAC,IAAI4d,IAAG,EAAG,GAAGtd,EAAG,CAAC,IAAIud,GAAG,GAAGvd,EAAG,CAAC,IAAIwd,GAAG,YAAYpmC,SAAS,IAAIomC,GAAG,CAAC,IAAIC,GAAGrmC,SAASI,cAAc,OAAOimC,GAAGhc,aAAa,UAAU,WAAW+b,GAAG,oBAAoBC,GAAGC,OAAO,CAACH,GAAGC,EAAE,MAAMD,IAAG,EAAGD,GAAGC,MAAMnmC,SAASqkC,cAAc,EAAErkC,SAASqkC,aAAa,CAAC,SAASkC,KAAKX,KAAKA,GAAGY,YAAY,mBAAmBC,IAAIZ,GAAGD,GAAG,KAAK,CAAC,SAASa,GAAGhgC,GAAG,GAAG,UAAUA,EAAE+iB,cAAcuc,GAAGF,IAAI,CAAC,IAAIvd,EAAE,GAAGod,GAAGpd,EAAEud,GAAGp/B,EAAE2tB,GAAG3tB,IAAI2uB,GAAG7yB,GAAG+lB,EAAE,CAAC,CAC/b,SAASoe,GAAGjgC,EAAE6hB,EAAEjC,GAAG,YAAY5f,GAAG8/B,KAAUV,GAAGxf,GAARuf,GAAGtd,GAAUqe,YAAY,mBAAmBF,KAAK,aAAahgC,GAAG8/B,IAAI,CAAC,SAASK,GAAGngC,GAAG,GAAG,oBAAoBA,GAAG,UAAUA,GAAG,YAAYA,EAAE,OAAOs/B,GAAGF,GAAG,CAAC,SAASgB,GAAGpgC,EAAE6hB,GAAG,GAAG,UAAU7hB,EAAE,OAAOs/B,GAAGzd,EAAE,CAAC,SAASwe,GAAGrgC,EAAE6hB,GAAG,GAAG,UAAU7hB,GAAG,WAAWA,EAAE,OAAOs/B,GAAGzd,EAAE,CAAiE,IAAIye,GAAG,oBAAoBvsC,OAAO05B,GAAG15B,OAAO05B,GAA5G,SAAYztB,EAAE6hB,GAAG,OAAO7hB,IAAI6hB,IAAI,IAAI7hB,GAAG,EAAEA,IAAI,EAAE6hB,IAAI7hB,IAAIA,GAAG6hB,IAAIA,CAAC,EACtW,SAAS0e,GAAGvgC,EAAE6hB,GAAG,GAAGye,GAAGtgC,EAAE6hB,GAAG,OAAM,EAAG,GAAG,kBAAkB7hB,GAAG,OAAOA,GAAG,kBAAkB6hB,GAAG,OAAOA,EAAE,OAAM,EAAG,IAAIjC,EAAE7rB,OAAOmE,KAAK8H,GAAGyiB,EAAE1uB,OAAOmE,KAAK2pB,GAAG,GAAGjC,EAAEtsB,SAASmvB,EAAEnvB,OAAO,OAAM,EAAG,IAAImvB,EAAE,EAAEA,EAAE7C,EAAEtsB,OAAOmvB,IAAI,CAAC,IAAI1Q,EAAE6N,EAAE6C,GAAG,IAAIL,EAAGjuB,KAAK0tB,EAAE9P,KAAKuuB,GAAGtgC,EAAE+R,GAAG8P,EAAE9P,IAAI,OAAM,CAAE,CAAC,OAAM,CAAE,CAAC,SAASyuB,GAAGxgC,GAAG,KAAKA,GAAGA,EAAEgpB,YAAYhpB,EAAEA,EAAEgpB,WAAW,OAAOhpB,CAAC,CACtU,SAASygC,GAAGzgC,EAAE6hB,GAAG,IAAwBY,EAApB7C,EAAE4gB,GAAGxgC,GAAO,IAAJA,EAAE,EAAY4f,GAAG,CAAC,GAAG,IAAIA,EAAEnO,SAAS,CAA0B,GAAzBgR,EAAEziB,EAAE4f,EAAE6I,YAAYn1B,OAAU0M,GAAG6hB,GAAGY,GAAGZ,EAAE,MAAM,CAAC6e,KAAK9gB,EAAEhG,OAAOiI,EAAE7hB,GAAGA,EAAEyiB,CAAC,CAACziB,EAAE,CAAC,KAAK4f,GAAG,CAAC,GAAGA,EAAE+gB,YAAY,CAAC/gB,EAAEA,EAAE+gB,YAAY,MAAM3gC,CAAC,CAAC4f,EAAEA,EAAEkO,UAAU,CAAClO,OAAE,CAAM,CAACA,EAAE4gB,GAAG5gB,EAAE,CAAC,CAAC,SAASghB,GAAG5gC,EAAE6hB,GAAG,SAAO7hB,IAAG6hB,KAAE7hB,IAAI6hB,KAAK7hB,GAAG,IAAIA,EAAEyR,YAAYoQ,GAAG,IAAIA,EAAEpQ,SAASmvB,GAAG5gC,EAAE6hB,EAAEiM,YAAY,aAAa9tB,EAAEA,EAAE6gC,SAAShf,KAAG7hB,EAAE8gC,4BAAwD,GAA7B9gC,EAAE8gC,wBAAwBjf,KAAY,CAC9Z,SAASkf,KAAK,IAAI,IAAI/gC,EAAEJ,OAAOiiB,EAAEiF,IAAKjF,aAAa7hB,EAAEghC,mBAAmB,CAAC,IAAI,IAAIphB,EAAE,kBAAkBiC,EAAEzc,cAAcw2B,SAASqF,IAAI,CAAC,MAAMxe,GAAG7C,GAAE,CAAE,CAAC,IAAGA,EAAyB,MAAMiC,EAAEiF,GAA/B9mB,EAAE6hB,EAAEzc,eAAgC7L,SAAS,CAAC,OAAOsoB,CAAC,CAAC,SAASqf,GAAGlhC,GAAG,IAAI6hB,EAAE7hB,GAAGA,EAAEsmB,UAAUtmB,EAAEsmB,SAAShkB,cAAc,OAAOuf,IAAI,UAAUA,IAAI,SAAS7hB,EAAEqB,MAAM,WAAWrB,EAAEqB,MAAM,QAAQrB,EAAEqB,MAAM,QAAQrB,EAAEqB,MAAM,aAAarB,EAAEqB,OAAO,aAAawgB,GAAG,SAAS7hB,EAAEmhC,gBAAgB,CACxa,SAASC,GAAGphC,GAAG,IAAI6hB,EAAEkf,KAAKnhB,EAAE5f,EAAEqhC,YAAY5e,EAAEziB,EAAEshC,eAAe,GAAGzf,IAAIjC,GAAGA,GAAGA,EAAEiI,eAAe+Y,GAAGhhB,EAAEiI,cAAc0Z,gBAAgB3hB,GAAG,CAAC,GAAG,OAAO6C,GAAGye,GAAGthB,GAAG,GAAGiC,EAAEY,EAAE1lB,WAAc,KAARiD,EAAEyiB,EAAE+e,OAAiBxhC,EAAE6hB,GAAG,mBAAmBjC,EAAEA,EAAE6hB,eAAe5f,EAAEjC,EAAE8hB,aAAa/iC,KAAKwL,IAAInK,EAAE4f,EAAEvqB,MAAM/B,aAAa,IAAG0M,GAAG6hB,EAAEjC,EAAEiI,eAAetuB,WAAWsoB,EAAE8f,aAAa/hC,QAASgiC,aAAa,CAAC5hC,EAAEA,EAAE4hC,eAAe,IAAI7vB,EAAE6N,EAAE6I,YAAYn1B,OAAO6E,EAAEwG,KAAKwL,IAAIsY,EAAE1lB,MAAMgV,GAAG0Q,OAAE,IAASA,EAAE+e,IAAIrpC,EAAEwG,KAAKwL,IAAIsY,EAAE+e,IAAIzvB,IAAI/R,EAAE6hC,QAAQ1pC,EAAEsqB,IAAI1Q,EAAE0Q,EAAEA,EAAEtqB,EAAEA,EAAE4Z,GAAGA,EAAE0uB,GAAG7gB,EAAEznB,GAAG,IAAIuqB,EAAE+d,GAAG7gB,EACvf6C,GAAG1Q,GAAG2Q,IAAI,IAAI1iB,EAAE8hC,YAAY9hC,EAAE+hC,aAAahwB,EAAE2uB,MAAM1gC,EAAEgiC,eAAejwB,EAAE6H,QAAQ5Z,EAAEiiC,YAAYvf,EAAEge,MAAM1gC,EAAEkiC,cAAcxf,EAAE9I,WAAUiI,EAAEA,EAAEsgB,eAAgBC,SAASrwB,EAAE2uB,KAAK3uB,EAAE6H,QAAQ5Z,EAAEqiC,kBAAkBlqC,EAAEsqB,GAAGziB,EAAEsiC,SAASzgB,GAAG7hB,EAAE6hC,OAAOnf,EAAEge,KAAKhe,EAAE9I,UAAUiI,EAAE0gB,OAAO7f,EAAEge,KAAKhe,EAAE9I,QAAQ5Z,EAAEsiC,SAASzgB,IAAI,CAAM,IAALA,EAAE,GAAO7hB,EAAE4f,EAAE5f,EAAEA,EAAE8tB,YAAY,IAAI9tB,EAAEyR,UAAUoQ,EAAEpuB,KAAK,CAAC0J,QAAQ6C,EAAEwiC,KAAKxiC,EAAEyiC,WAAWC,IAAI1iC,EAAE2iC,YAAmD,IAAvC,oBAAoB/iB,EAAEgjB,OAAOhjB,EAAEgjB,QAAYhjB,EAAE,EAAEA,EAAEiC,EAAEvuB,OAAOssB,KAAI5f,EAAE6hB,EAAEjC,IAAKziB,QAAQslC,WAAWziC,EAAEwiC,KAAKxiC,EAAE7C,QAAQwlC,UAAU3iC,EAAE0iC,GAAG,CAAC,CACzf,IAAIG,GAAG1gB,GAAI,iBAAiB5oB,UAAU,IAAIA,SAASqkC,aAAakF,GAAG,KAAKC,GAAG,KAAKC,GAAG,KAAKC,IAAG,EAC3F,SAASC,GAAGljC,EAAE6hB,EAAEjC,GAAG,IAAI6C,EAAE7C,EAAEhgB,SAASggB,EAAEA,EAAErmB,SAAS,IAAIqmB,EAAEnO,SAASmO,EAAEA,EAAEiI,cAAcob,IAAI,MAAMH,IAAIA,KAAKhc,EAAGrE,KAAU,mBAALA,EAAEqgB,KAAyB5B,GAAGze,GAAGA,EAAE,CAAC1lB,MAAM0lB,EAAEgf,eAAeD,IAAI/e,EAAEif,cAAuFjf,EAAE,CAACsf,YAA3Etf,GAAGA,EAAEoF,eAAepF,EAAEoF,cAAc8Z,aAAa/hC,QAAQgiC,gBAA+BG,WAAWC,aAAavf,EAAEuf,aAAaC,UAAUxf,EAAEwf,UAAUC,YAAYzf,EAAEyf,aAAcc,IAAIzC,GAAGyC,GAAGvgB,KAAKugB,GAAGvgB,EAAsB,GAApBA,EAAEyc,GAAG6D,GAAG,aAAgBzvC,SAASuuB,EAAE,IAAIoW,GAAG,WAAW,SAAS,KAAKpW,EAAEjC,GAAG5f,EAAEvM,KAAK,CAACma,MAAMiU,EAAEvT,UAAUmU,IAAIZ,EAAE9pB,OAAO+qC,KAAK,CACtf,SAASK,GAAGnjC,EAAE6hB,GAAG,IAAIjC,EAAE,CAAC,EAAiF,OAA/EA,EAAE5f,EAAEsC,eAAeuf,EAAEvf,cAAcsd,EAAE,SAAS5f,GAAG,SAAS6hB,EAAEjC,EAAE,MAAM5f,GAAG,MAAM6hB,EAASjC,CAAC,CAAC,IAAIwjB,GAAG,CAACC,aAAaF,GAAG,YAAY,gBAAgBG,mBAAmBH,GAAG,YAAY,sBAAsBI,eAAeJ,GAAG,YAAY,kBAAkBK,cAAcL,GAAG,aAAa,kBAAkBM,GAAG,CAAC,EAAEC,GAAG,CAAC,EACpF,SAASC,GAAG3jC,GAAG,GAAGyjC,GAAGzjC,GAAG,OAAOyjC,GAAGzjC,GAAG,IAAIojC,GAAGpjC,GAAG,OAAOA,EAAE,IAAY4f,EAARiC,EAAEuhB,GAAGpjC,GAAK,IAAI4f,KAAKiC,EAAE,GAAGA,EAAE5uB,eAAe2sB,IAAIA,KAAK8jB,GAAG,OAAOD,GAAGzjC,GAAG6hB,EAAEjC,GAAG,OAAO5f,CAAC,CAA/XmiB,IAAKuhB,GAAGnqC,SAASI,cAAc,OAAOqL,MAAM,mBAAmBpF,gBAAgBwjC,GAAGC,aAAaO,iBAAiBR,GAAGE,mBAAmBM,iBAAiBR,GAAGG,eAAeK,WAAW,oBAAoBhkC,eAAewjC,GAAGI,cAAc5N,YAAwJ,IAAIiO,GAAGF,GAAG,gBAAgBG,GAAGH,GAAG,sBAAsBI,GAAGJ,GAAG,kBAAkBK,GAAGL,GAAG,iBAAiBM,GAAG,IAAIpwB,IAAIqwB,GAAG,smBAAsmB9pC,MAAM,KAC/lC,SAAS+pC,GAAGnkC,EAAE6hB,GAAGoiB,GAAG3jC,IAAIN,EAAE6hB,GAAGI,EAAGJ,EAAE,CAAC7hB,GAAG,CAAC,IAAI,IAAIokC,GAAG,EAAEA,GAAGF,GAAG5wC,OAAO8wC,KAAK,CAAC,IAAIC,GAAGH,GAAGE,IAA2DD,GAApDE,GAAG/hC,cAAuD,MAAtC+hC,GAAG,GAAGhhB,cAAcghB,GAAGrtC,MAAM,IAAiB,CAACmtC,GAAGN,GAAG,kBAAkBM,GAAGL,GAAG,wBAAwBK,GAAGJ,GAAG,oBAAoBI,GAAG,WAAW,iBAAiBA,GAAG,UAAU,WAAWA,GAAG,WAAW,UAAUA,GAAGH,GAAG,mBAAmB9hB,EAAG,eAAe,CAAC,WAAW,cAAcA,EAAG,eAAe,CAAC,WAAW,cAAcA,EAAG,iBAAiB,CAAC,aAAa,gBAC7cA,EAAG,iBAAiB,CAAC,aAAa,gBAAgBD,EAAG,WAAW,oEAAoE7nB,MAAM,MAAM6nB,EAAG,WAAW,uFAAuF7nB,MAAM,MAAM6nB,EAAG,gBAAgB,CAAC,iBAAiB,WAAW,YAAY,UAAUA,EAAG,mBAAmB,2DAA2D7nB,MAAM,MAAM6nB,EAAG,qBAAqB,6DAA6D7nB,MAAM,MAC/f6nB,EAAG,sBAAsB,8DAA8D7nB,MAAM,MAAM,IAAIkqC,GAAG,6NAA6NlqC,MAAM,KAAKmqC,GAAG,IAAIxwB,IAAI,0CAA0C3Z,MAAM,KAAKmM,OAAO+9B,KACzZ,SAASE,GAAGxkC,EAAE6hB,EAAEjC,GAAG,IAAI6C,EAAEziB,EAAEqB,MAAM,gBAAgBrB,EAAE+2B,cAAcnX,EAlDjE,SAAY5f,EAAE6hB,EAAEjC,EAAE6C,EAAE1Q,EAAE5Z,EAAEuqB,EAAE+C,EAAEC,GAA4B,GAAzB8J,GAAG37B,MAAMiM,KAAKzM,WAAc87B,GAAG,CAAC,IAAGA,GAAgC,MAAM/J,MAAMxD,EAAE,MAA1C,IAAIpT,EAAE4gB,GAAGD,IAAG,EAAGC,GAAG,KAA8BC,KAAKA,IAAG,EAAGC,GAAG9gB,EAAE,CAAC,CAkDpEi2B,CAAGhiB,EAAEZ,OAAE,EAAO7hB,GAAGA,EAAE+2B,cAAc,IAAI,CACxG,SAASsI,GAAGr/B,EAAE6hB,GAAGA,EAAE,KAAO,EAAFA,GAAK,IAAI,IAAIjC,EAAE,EAAEA,EAAE5f,EAAE1M,OAAOssB,IAAI,CAAC,IAAI6C,EAAEziB,EAAE4f,GAAG7N,EAAE0Q,EAAE7U,MAAM6U,EAAEA,EAAEnU,UAAUtO,EAAE,CAAC,IAAI7H,OAAE,EAAO,GAAG0pB,EAAE,IAAI,IAAIa,EAAED,EAAEnvB,OAAO,EAAE,GAAGovB,EAAEA,IAAI,CAAC,IAAI+C,EAAEhD,EAAEC,GAAGgD,EAAED,EAAEif,SAASl2B,EAAEiX,EAAEsR,cAA2B,GAAbtR,EAAEA,EAAE5X,SAAY6X,IAAIvtB,GAAG4Z,EAAEolB,uBAAuB,MAAMn3B,EAAEwkC,GAAGzyB,EAAE0T,EAAEjX,GAAGrW,EAAEutB,CAAC,MAAM,IAAIhD,EAAE,EAAEA,EAAED,EAAEnvB,OAAOovB,IAAI,CAAoD,GAA5CgD,GAAPD,EAAEhD,EAAEC,IAAOgiB,SAASl2B,EAAEiX,EAAEsR,cAActR,EAAEA,EAAE5X,SAAY6X,IAAIvtB,GAAG4Z,EAAEolB,uBAAuB,MAAMn3B,EAAEwkC,GAAGzyB,EAAE0T,EAAEjX,GAAGrW,EAAEutB,CAAC,CAAC,CAAC,CAAC,GAAG2J,GAAG,MAAMrvB,EAAEsvB,GAAGD,IAAG,EAAGC,GAAG,KAAKtvB,CAAE,CAC5a,SAAS2kC,GAAE3kC,EAAE6hB,GAAG,IAAIjC,EAAEiC,EAAE+iB,SAAI,IAAShlB,IAAIA,EAAEiC,EAAE+iB,IAAI,IAAI7wB,KAAK,IAAI0O,EAAEziB,EAAE,WAAW4f,EAAErf,IAAIkiB,KAAKoiB,GAAGhjB,EAAE7hB,EAAE,GAAE,GAAI4f,EAAE1K,IAAIuN,GAAG,CAAC,SAASqiB,GAAG9kC,EAAE6hB,EAAEjC,GAAG,IAAI6C,EAAE,EAAEZ,IAAIY,GAAG,GAAGoiB,GAAGjlB,EAAE5f,EAAEyiB,EAAEZ,EAAE,CAAC,IAAIkjB,GAAG,kBAAkBpmC,KAAKoM,SAASjX,SAAS,IAAIkD,MAAM,GAAG,SAASguC,GAAGhlC,GAAG,IAAIA,EAAE+kC,IAAI,CAAC/kC,EAAE+kC,KAAI,EAAGhjB,EAAGxP,SAAQ,SAASsP,GAAG,oBAAoBA,IAAI0iB,GAAGhkC,IAAIshB,IAAIijB,GAAGjjB,GAAE,EAAG7hB,GAAG8kC,GAAGjjB,GAAE,EAAG7hB,GAAG,IAAG,IAAI6hB,EAAE,IAAI7hB,EAAEyR,SAASzR,EAAEA,EAAE6nB,cAAc,OAAOhG,GAAGA,EAAEkjB,MAAMljB,EAAEkjB,KAAI,EAAGD,GAAG,mBAAkB,EAAGjjB,GAAG,CAAC,CACjb,SAASgjB,GAAG7kC,EAAE6hB,EAAEjC,EAAE6C,GAAG,OAAOyT,GAAGrU,IAAI,KAAK,EAAE,IAAI9P,EAAE4jB,GAAG,MAAM,KAAK,EAAE5jB,EAAE+jB,GAAG,MAAM,QAAQ/jB,EAAE8jB,GAAGjW,EAAE7N,EAAEpV,KAAK,KAAKklB,EAAEjC,EAAE5f,GAAG+R,OAAE,GAAQ8c,IAAI,eAAehN,GAAG,cAAcA,GAAG,UAAUA,IAAI9P,GAAE,GAAI0Q,OAAE,IAAS1Q,EAAE/R,EAAE+uB,iBAAiBlN,EAAEjC,EAAE,CAACpgB,SAAQ,EAAGylC,QAAQlzB,IAAI/R,EAAE+uB,iBAAiBlN,EAAEjC,GAAE,QAAI,IAAS7N,EAAE/R,EAAE+uB,iBAAiBlN,EAAEjC,EAAE,CAACqlB,QAAQlzB,IAAI/R,EAAE+uB,iBAAiBlN,EAAEjC,GAAE,EAAG,CAClV,SAASmW,GAAG/1B,EAAE6hB,EAAEjC,EAAE6C,EAAE1Q,GAAG,IAAI5Z,EAAEsqB,EAAE,GAAG,KAAO,EAAFZ,IAAM,KAAO,EAAFA,IAAM,OAAOY,EAAEziB,EAAE,OAAO,CAAC,GAAG,OAAOyiB,EAAE,OAAO,IAAIC,EAAED,EAAElrB,IAAI,GAAG,IAAImrB,GAAG,IAAIA,EAAE,CAAC,IAAI+C,EAAEhD,EAAE2L,UAAU2G,cAAc,GAAGtP,IAAI1T,GAAG,IAAI0T,EAAEhU,UAAUgU,EAAEqI,aAAa/b,EAAE,MAAM,GAAG,IAAI2Q,EAAE,IAAIA,EAAED,EAAEkN,OAAO,OAAOjN,GAAG,CAAC,IAAIgD,EAAEhD,EAAEnrB,IAAI,IAAG,IAAImuB,GAAG,IAAIA,MAAKA,EAAEhD,EAAE0L,UAAU2G,iBAAkBhjB,GAAG,IAAI2T,EAAEjU,UAAUiU,EAAEoI,aAAa/b,GAAE,OAAO2Q,EAAEA,EAAEiN,MAAM,CAAC,KAAK,OAAOlK,GAAG,CAAS,GAAG,QAAX/C,EAAEkS,GAAGnP,IAAe,OAAe,GAAG,KAAXC,EAAEhD,EAAEnrB,MAAc,IAAImuB,EAAE,CAACjD,EAAEtqB,EAAEuqB,EAAE,SAAS1iB,CAAC,CAACylB,EAAEA,EAAEqI,UAAU,CAAC,CAACrL,EAAEA,EAAEkN,MAAM,CAAChB,IAAG,WAAW,IAAIlM,EAAEtqB,EAAE4Z,EAAE4b,GAAG/N,GAAG8C,EAAE,GACpf1iB,EAAE,CAAC,IAAIylB,EAAEwe,GAAG5qC,IAAI2G,GAAG,QAAG,IAASylB,EAAE,CAAC,IAAIC,EAAEuS,GAAGx4B,EAAEO,EAAE,OAAOA,GAAG,IAAK,WAAW,GAAG,IAAIu2B,GAAG3W,GAAG,MAAM5f,EAAE,IAAK,UAAU,IAAK,QAAQ0lB,EAAEsW,GAAG,MAAM,IAAK,UAAUv8B,EAAE,QAAQimB,EAAEmU,GAAG,MAAM,IAAK,WAAWp6B,EAAE,OAAOimB,EAAEmU,GAAG,MAAM,IAAK,aAAa,IAAK,YAAYnU,EAAEmU,GAAG,MAAM,IAAK,QAAQ,GAAG,IAAIja,EAAEuZ,OAAO,MAAMn5B,EAAE,IAAK,WAAW,IAAK,WAAW,IAAK,YAAY,IAAK,YAAY,IAAK,UAAU,IAAK,WAAW,IAAK,YAAY,IAAK,cAAc0lB,EAAEgU,GAAG,MAAM,IAAK,OAAO,IAAK,UAAU,IAAK,YAAY,IAAK,WAAW,IAAK,YAAY,IAAK,WAAW,IAAK,YAAY,IAAK,OAAOhU,EAC1iBiU,GAAG,MAAM,IAAK,cAAc,IAAK,WAAW,IAAK,YAAY,IAAK,aAAajU,EAAEiX,GAAG,MAAM,KAAKkH,GAAG,KAAKC,GAAG,KAAKC,GAAGre,EAAEoU,GAAG,MAAM,KAAKkK,GAAGte,EAAEqX,GAAG,MAAM,IAAK,SAASrX,EAAE2S,GAAG,MAAM,IAAK,QAAQ3S,EAAE8X,GAAG,MAAM,IAAK,OAAO,IAAK,MAAM,IAAK,QAAQ9X,EAAE0U,GAAG,MAAM,IAAK,oBAAoB,IAAK,qBAAqB,IAAK,gBAAgB,IAAK,cAAc,IAAK,cAAc,IAAK,aAAa,IAAK,cAAc,IAAK,YAAY1U,EAAEuW,GAAG,IAAIiJ,EAAE,KAAO,EAAFrjB,GAAKsjB,GAAGD,GAAG,WAAWllC,EAAEuD,EAAE2hC,EAAE,OAAOzf,EAAEA,EAAE,UAAU,KAAKA,EAAEyf,EAAE,GAAG,IAAI,IAAQE,EAAJpkB,EAAEyB,EAAI,OAC/ezB,GAAG,CAAK,IAAI1b,GAAR8/B,EAAEpkB,GAAUoN,UAAsF,GAA5E,IAAIgX,EAAE7tC,KAAK,OAAO+N,IAAI8/B,EAAE9/B,EAAE,OAAO/B,IAAc,OAAV+B,EAAEspB,GAAG5N,EAAEzd,KAAY2hC,EAAEzxC,KAAK4xC,GAAGrkB,EAAE1b,EAAE8/B,MAASD,EAAE,MAAMnkB,EAAEA,EAAE2O,MAAM,CAAC,EAAEuV,EAAE5xC,SAASmyB,EAAE,IAAIC,EAAED,EAAEhmB,EAAE,KAAKmgB,EAAE7N,GAAG2Q,EAAEjvB,KAAK,CAACma,MAAM6X,EAAEnX,UAAU42B,IAAI,CAAC,CAAC,GAAG,KAAO,EAAFrjB,GAAK,CAA4E,GAAnC6D,EAAE,aAAa1lB,GAAG,eAAeA,KAAtEylB,EAAE,cAAczlB,GAAG,gBAAgBA,IAA2C4f,IAAI8N,MAAKjuB,EAAEmgB,EAAEyZ,eAAezZ,EAAE0Z,eAAe1E,GAAGn1B,KAAIA,EAAE6lC,OAAgB5f,GAAGD,KAAGA,EAAE1T,EAAEnS,SAASmS,EAAEA,GAAG0T,EAAE1T,EAAE8V,eAAepC,EAAEkc,aAAalc,EAAEhhB,aAAa7E,OAAU8lB,GAAqCA,EAAEjD,EAAiB,QAAfhjB,GAAnCA,EAAEmgB,EAAEyZ,eAAezZ,EAAE2Z,WAAkB3E,GAAGn1B,GAAG,QAC9dA,KAAR0lC,EAAE1V,GAAGhwB,KAAU,IAAIA,EAAElI,KAAK,IAAIkI,EAAElI,OAAKkI,EAAE,QAAUimB,EAAE,KAAKjmB,EAAEgjB,GAAKiD,IAAIjmB,GAAE,CAAgU,GAA/TylC,EAAExL,GAAGp0B,EAAE,eAAe/B,EAAE,eAAeyd,EAAE,QAAW,eAAehhB,GAAG,gBAAgBA,IAAEklC,EAAEjJ,GAAG32B,EAAE,iBAAiB/B,EAAE,iBAAiByd,EAAE,WAAUmkB,EAAE,MAAMzf,EAAED,EAAE8Z,GAAG7Z,GAAG0f,EAAE,MAAM3lC,EAAEgmB,EAAE8Z,GAAG9/B,IAAGgmB,EAAE,IAAIyf,EAAE5/B,EAAE0b,EAAE,QAAQ0E,EAAE9F,EAAE7N,IAAKha,OAAOotC,EAAE1f,EAAE4T,cAAc+L,EAAE9/B,EAAE,KAAKsvB,GAAG7iB,KAAK0Q,KAAIyiB,EAAE,IAAIA,EAAE3hC,EAAEyd,EAAE,QAAQvhB,EAAEmgB,EAAE7N,IAAKha,OAAOqtC,EAAEF,EAAE7L,cAAc8L,EAAE7/B,EAAE4/B,GAAGC,EAAE7/B,EAAKogB,GAAGjmB,EAAEoiB,EAAE,CAAa,IAARte,EAAE9D,EAAEuhB,EAAE,EAAMokB,EAAhBF,EAAExf,EAAkB0f,EAAEA,EAAEG,GAAGH,GAAGpkB,IAAQ,IAAJokB,EAAE,EAAM9/B,EAAE/B,EAAE+B,EAAEA,EAAEigC,GAAGjgC,GAAG8/B,IAAI,KAAK,EAAEpkB,EAAEokB,GAAGF,EAAEK,GAAGL,GAAGlkB,IAAI,KAAK,EAAEokB,EAAEpkB,GAAGzd,EACpfgiC,GAAGhiC,GAAG6hC,IAAI,KAAKpkB,KAAK,CAAC,GAAGkkB,IAAI3hC,GAAG,OAAOA,GAAG2hC,IAAI3hC,EAAEmsB,UAAU,MAAM7N,EAAEqjB,EAAEK,GAAGL,GAAG3hC,EAAEgiC,GAAGhiC,EAAE,CAAC2hC,EAAE,IAAI,MAAMA,EAAE,KAAK,OAAOxf,GAAG8f,GAAG9iB,EAAE+C,EAAEC,EAAEwf,GAAE,GAAI,OAAOzlC,GAAG,OAAO0lC,GAAGK,GAAG9iB,EAAEyiB,EAAE1lC,EAAEylC,GAAE,EAAG,CAA8D,GAAG,YAA1Cxf,GAAjBD,EAAEhD,EAAE8c,GAAG9c,GAAG7iB,QAAW0mB,UAAUb,EAAEa,SAAShkB,gBAA+B,UAAUojB,GAAG,SAASD,EAAEpkB,KAAK,IAAIokC,EAAGjG,QAAQ,GAAGR,GAAGvZ,GAAG,GAAGga,GAAGgG,EAAGpF,OAAO,CAACoF,EAAGtF,GAAG,IAAIuF,EAAGzF,EAAE,MAAMva,EAAED,EAAEa,WAAW,UAAUZ,EAAEpjB,gBAAgB,aAAamjB,EAAEpkB,MAAM,UAAUokB,EAAEpkB,QAAQokC,EAAGrF,IACrV,OAD4VqF,IAAKA,EAAGA,EAAGzlC,EAAEyiB,IAAKwc,GAAGvc,EAAE+iB,EAAG7lB,EAAE7N,IAAW2zB,GAAIA,EAAG1lC,EAAEylB,EAAEhD,GAAG,aAAaziB,IAAI0lC,EAAGjgB,EAAE2B,gBAClfse,EAAGle,YAAY,WAAW/B,EAAEpkB,MAAMsmB,GAAGlC,EAAE,SAASA,EAAEpwB,QAAOqwC,EAAGjjB,EAAE8c,GAAG9c,GAAG7iB,OAAcI,GAAG,IAAK,WAAag/B,GAAG0G,IAAK,SAASA,EAAGvE,mBAAgB2B,GAAG4C,EAAG3C,GAAGtgB,EAAEugB,GAAG,MAAK,MAAM,IAAK,WAAWA,GAAGD,GAAGD,GAAG,KAAK,MAAM,IAAK,YAAYG,IAAG,EAAG,MAAM,IAAK,cAAc,IAAK,UAAU,IAAK,UAAUA,IAAG,EAAGC,GAAGxgB,EAAE9C,EAAE7N,GAAG,MAAM,IAAK,kBAAkB,GAAG8wB,GAAG,MAAM,IAAK,UAAU,IAAK,QAAQK,GAAGxgB,EAAE9C,EAAE7N,GAAG,IAAI4zB,EAAG,GAAGjI,GAAG7b,EAAE,CAAC,OAAO7hB,GAAG,IAAK,mBAAmB,IAAI4lC,EAAG,qBAAqB,MAAM/jB,EAAE,IAAK,iBAAiB+jB,EAAG,mBACpe,MAAM/jB,EAAE,IAAK,oBAAoB+jB,EAAG,sBAAsB,MAAM/jB,EAAE+jB,OAAG,CAAM,MAAM1H,GAAGF,GAAGh+B,EAAE4f,KAAKgmB,EAAG,oBAAoB,YAAY5lC,GAAG,MAAM4f,EAAE4W,UAAUoP,EAAG,sBAAsBA,IAAK9H,IAAI,OAAOle,EAAEkc,SAASoC,IAAI,uBAAuB0H,EAAG,qBAAqBA,GAAI1H,KAAKyH,EAAGrP,OAAYF,GAAG,UAARD,GAAGpkB,GAAkBokB,GAAG9gC,MAAM8gC,GAAG1N,YAAYyV,IAAG,IAAiB,GAAZwH,EAAGxG,GAAGzc,EAAEmjB,IAAStyC,SAASsyC,EAAG,IAAIvL,GAAGuL,EAAG5lC,EAAE,KAAK4f,EAAE7N,GAAG2Q,EAAEjvB,KAAK,CAACma,MAAMg4B,EAAGt3B,UAAUo3B,IAAKC,EAAGC,EAAG3jC,KAAK0jC,EAAa,QAATA,EAAG1H,GAAGre,MAAegmB,EAAG3jC,KAAK0jC,MAAUA,EAAG9H,GA5BhM,SAAY79B,EAAE6hB,GAAG,OAAO7hB,GAAG,IAAK,iBAAiB,OAAOi+B,GAAGpc,GAAG,IAAK,WAAW,OAAG,KAAKA,EAAEka,MAAa,MAAKgC,IAAG,EAAUtvB,IAAG,IAAK,YAAY,OAAOzO,EAAE6hB,EAAE5f,QAASwM,IAAIsvB,GAAG,KAAK/9B,EAAE,QAAQ,OAAO,KAAK,CA4BE6lC,CAAG7lC,EAAE4f,GA3Bzd,SAAY5f,EAAE6hB,GAAG,GAAGqc,GAAG,MAAM,mBAAmBl+B,IAAI09B,IAAIM,GAAGh+B,EAAE6hB,IAAI7hB,EAAEs2B,KAAKD,GAAGD,GAAGD,GAAG,KAAK+H,IAAG,EAAGl+B,GAAG,KAAK,OAAOA,GAAG,IAAK,QAAgQ,QAAQ,OAAO,KAA3P,IAAK,WAAW,KAAK6hB,EAAEgX,SAAShX,EAAEkX,QAAQlX,EAAEmX,UAAUnX,EAAEgX,SAAShX,EAAEkX,OAAO,CAAC,GAAGlX,EAAEikB,MAAM,EAAEjkB,EAAEikB,KAAKxyC,OAAO,OAAOuuB,EAAEikB,KAAK,GAAGjkB,EAAEka,MAAM,OAAOnmC,OAAO0oB,aAAauD,EAAEka,MAAM,CAAC,OAAO,KAAK,IAAK,iBAAiB,OAAO+B,IAAI,OAAOjc,EAAEia,OAAO,KAAKja,EAAE5f,KAAyB,CA2BqF8jC,CAAG/lC,EAAE4f,MACje,GADoe6C,EAAEyc,GAAGzc,EAAE,kBACvenvB,SAASye,EAAE,IAAIsoB,GAAG,gBAAgB,cAAc,KAAKza,EAAE7N,GAAG2Q,EAAEjvB,KAAK,CAACma,MAAMmE,EAAEzD,UAAUmU,IAAI1Q,EAAE9P,KAAK0jC,GAAG,CAACtG,GAAG3c,EAAEb,EAAE,GAAE,CAAC,SAASwjB,GAAGrlC,EAAE6hB,EAAEjC,GAAG,MAAM,CAAC8kB,SAAS1kC,EAAE6N,SAASgU,EAAEkV,cAAcnX,EAAE,CAAC,SAASsf,GAAGl/B,EAAE6hB,GAAG,IAAI,IAAIjC,EAAEiC,EAAE,UAAUY,EAAE,GAAG,OAAOziB,GAAG,CAAC,IAAI+R,EAAE/R,EAAE7H,EAAE4Z,EAAEqc,UAAU,IAAIrc,EAAExa,KAAK,OAAOY,IAAI4Z,EAAE5Z,EAAY,OAAVA,EAAEy2B,GAAG5uB,EAAE4f,KAAY6C,EAAEujB,QAAQX,GAAGrlC,EAAE7H,EAAE4Z,IAAc,OAAV5Z,EAAEy2B,GAAG5uB,EAAE6hB,KAAYY,EAAEhvB,KAAK4xC,GAAGrlC,EAAE7H,EAAE4Z,KAAK/R,EAAEA,EAAE2vB,MAAM,CAAC,OAAOlN,CAAC,CAAC,SAAS8iB,GAAGvlC,GAAG,GAAG,OAAOA,EAAE,OAAO,KAAK,GAAGA,EAAEA,EAAE2vB,aAAa3vB,GAAG,IAAIA,EAAEzI,KAAK,OAAOyI,GAAI,IAAI,CACnd,SAASwlC,GAAGxlC,EAAE6hB,EAAEjC,EAAE6C,EAAE1Q,GAAG,IAAI,IAAI5Z,EAAE0pB,EAAEgV,WAAWnU,EAAE,GAAG,OAAO9C,GAAGA,IAAI6C,GAAG,CAAC,IAAIgD,EAAE7F,EAAE8F,EAAED,EAAEiK,UAAUlhB,EAAEiX,EAAE2I,UAAU,GAAG,OAAO1I,GAAGA,IAAIjD,EAAE,MAAM,IAAIgD,EAAEluB,KAAK,OAAOiX,IAAIiX,EAAEjX,EAAEuD,EAAa,OAAV2T,EAAEkJ,GAAGhP,EAAEznB,KAAYuqB,EAAEsjB,QAAQX,GAAGzlB,EAAE8F,EAAED,IAAK1T,GAAc,OAAV2T,EAAEkJ,GAAGhP,EAAEznB,KAAYuqB,EAAEjvB,KAAK4xC,GAAGzlB,EAAE8F,EAAED,KAAM7F,EAAEA,EAAE+P,MAAM,CAAC,IAAIjN,EAAEpvB,QAAQ0M,EAAEvM,KAAK,CAACma,MAAMiU,EAAEvT,UAAUoU,GAAG,CAAC,IAAIujB,GAAG,SAASC,GAAG,iBAAiB,SAASC,GAAGnmC,GAAG,OAAO,kBAAkBA,EAAEA,EAAE,GAAGA,GAAGpB,QAAQqnC,GAAG,MAAMrnC,QAAQsnC,GAAG,GAAG,CAAC,SAASE,GAAGpmC,EAAE6hB,EAAEjC,GAAW,GAARiC,EAAEskB,GAAGtkB,GAAMskB,GAAGnmC,KAAK6hB,GAAGjC,EAAE,MAAMwF,MAAMxD,EAAE,KAAM,CAAC,SAASykB,KAAK,CAC9e,IAAIC,GAAG,KAAKC,GAAG,KAAK,SAASC,GAAGxmC,EAAE6hB,GAAG,MAAM,aAAa7hB,GAAG,aAAaA,GAAG,kBAAkB6hB,EAAEwG,UAAU,kBAAkBxG,EAAEwG,UAAU,kBAAkBxG,EAAEuG,yBAAyB,OAAOvG,EAAEuG,yBAAyB,MAAMvG,EAAEuG,wBAAwBqe,MAAM,CAC5P,IAAIC,GAAG,oBAAoBhqB,WAAWA,gBAAW,EAAOiqB,GAAG,oBAAoB1pB,aAAaA,kBAAa,EAAO2pB,GAAG,oBAAoB9yB,QAAQA,aAAQ,EAAO+yB,GAAG,oBAAoBC,eAAeA,eAAe,qBAAqBF,GAAG,SAAS5mC,GAAG,OAAO4mC,GAAGnsB,QAAQ,MAAMssB,KAAK/mC,GAAGgnC,MAAMC,GAAG,EAAEP,GAAG,SAASO,GAAGjnC,GAAG0c,YAAW,WAAW,MAAM1c,CAAE,GAAE,CACpV,SAASknC,GAAGlnC,EAAE6hB,GAAG,IAAIjC,EAAEiC,EAAEY,EAAE,EAAE,EAAE,CAAC,IAAI1Q,EAAE6N,EAAE+gB,YAA6B,GAAjB3gC,EAAEipB,YAAYrJ,GAAM7N,GAAG,IAAIA,EAAEN,SAAS,GAAY,QAATmO,EAAE7N,EAAE9P,MAAc,CAAC,GAAG,IAAIwgB,EAA0B,OAAvBziB,EAAEipB,YAAYlX,QAAGwjB,GAAG1T,GAAUY,GAAG,KAAK,MAAM7C,GAAG,OAAOA,GAAG,OAAOA,GAAG6C,IAAI7C,EAAE7N,CAAC,OAAO6N,GAAG2V,GAAG1T,EAAE,CAAC,SAASslB,GAAGnnC,GAAG,KAAK,MAAMA,EAAEA,EAAEA,EAAE2gC,YAAY,CAAC,IAAI9e,EAAE7hB,EAAEyR,SAAS,GAAG,IAAIoQ,GAAG,IAAIA,EAAE,MAAM,GAAG,IAAIA,EAAE,CAAU,GAAG,OAAZA,EAAE7hB,EAAEiC,OAAiB,OAAO4f,GAAG,OAAOA,EAAE,MAAM,GAAG,OAAOA,EAAE,OAAO,IAAI,CAAC,CAAC,OAAO7hB,CAAC,CACjY,SAASonC,GAAGpnC,GAAGA,EAAEA,EAAEqnC,gBAAgB,IAAI,IAAIxlB,EAAE,EAAE7hB,GAAG,CAAC,GAAG,IAAIA,EAAEyR,SAAS,CAAC,IAAImO,EAAE5f,EAAEiC,KAAK,GAAG,MAAM2d,GAAG,OAAOA,GAAG,OAAOA,EAAE,CAAC,GAAG,IAAIiC,EAAE,OAAO7hB,EAAE6hB,GAAG,KAAK,OAAOjC,GAAGiC,GAAG,CAAC7hB,EAAEA,EAAEqnC,eAAe,CAAC,OAAO,IAAI,CAAC,IAAIC,GAAG3oC,KAAKoM,SAASjX,SAAS,IAAIkD,MAAM,GAAGuwC,GAAG,gBAAgBD,GAAGE,GAAG,gBAAgBF,GAAGhC,GAAG,oBAAoBgC,GAAG1C,GAAG,iBAAiB0C,GAAGG,GAAG,oBAAoBH,GAAGI,GAAG,kBAAkBJ,GAClX,SAAS1S,GAAG50B,GAAG,IAAI6hB,EAAE7hB,EAAEunC,IAAI,GAAG1lB,EAAE,OAAOA,EAAE,IAAI,IAAIjC,EAAE5f,EAAE8tB,WAAWlO,GAAG,CAAC,GAAGiC,EAAEjC,EAAE0lB,KAAK1lB,EAAE2nB,IAAI,CAAe,GAAd3nB,EAAEiC,EAAE6N,UAAa,OAAO7N,EAAEoO,OAAO,OAAOrQ,GAAG,OAAOA,EAAEqQ,MAAM,IAAIjwB,EAAEonC,GAAGpnC,GAAG,OAAOA,GAAG,CAAC,GAAG4f,EAAE5f,EAAEunC,IAAI,OAAO3nB,EAAE5f,EAAEonC,GAAGpnC,EAAE,CAAC,OAAO6hB,CAAC,CAAKjC,GAAJ5f,EAAE4f,GAAMkO,UAAU,CAAC,OAAO,IAAI,CAAC,SAASK,GAAGnuB,GAAkB,QAAfA,EAAEA,EAAEunC,KAAKvnC,EAAEslC,MAAc,IAAItlC,EAAEzI,KAAK,IAAIyI,EAAEzI,KAAK,KAAKyI,EAAEzI,KAAK,IAAIyI,EAAEzI,IAAI,KAAKyI,CAAC,CAAC,SAASu/B,GAAGv/B,GAAG,GAAG,IAAIA,EAAEzI,KAAK,IAAIyI,EAAEzI,IAAI,OAAOyI,EAAEouB,UAAU,MAAMhJ,MAAMxD,EAAE,IAAK,CAAC,SAASyM,GAAGruB,GAAG,OAAOA,EAAEwnC,KAAK,IAAI,CAAC,IAAIG,GAAG,GAAGC,IAAI,EAAE,SAASC,GAAG7nC,GAAG,MAAM,CAACoG,QAAQpG,EAAE,CACve,SAAS8nC,GAAE9nC,GAAG,EAAE4nC,KAAK5nC,EAAEoG,QAAQuhC,GAAGC,IAAID,GAAGC,IAAI,KAAKA,KAAK,CAAC,SAASG,GAAE/nC,EAAE6hB,GAAG+lB,KAAKD,GAAGC,IAAI5nC,EAAEoG,QAAQpG,EAAEoG,QAAQyb,CAAC,CAAC,IAAImmB,GAAG,CAAC,EAAEC,GAAEJ,GAAGG,IAAIE,GAAGL,IAAG,GAAIM,GAAGH,GAAG,SAASI,GAAGpoC,EAAE6hB,GAAG,IAAIjC,EAAE5f,EAAEqB,KAAKgnC,aAAa,IAAIzoB,EAAE,OAAOooB,GAAG,IAAIvlB,EAAEziB,EAAEouB,UAAU,GAAG3L,GAAGA,EAAE6lB,8CAA8CzmB,EAAE,OAAOY,EAAE8lB,0CAA0C,IAASpwC,EAAL4Z,EAAE,CAAC,EAAI,IAAI5Z,KAAKynB,EAAE7N,EAAE5Z,GAAG0pB,EAAE1pB,GAAoH,OAAjHsqB,KAAIziB,EAAEA,EAAEouB,WAAYka,4CAA4CzmB,EAAE7hB,EAAEuoC,0CAA0Cx2B,GAAUA,CAAC,CAC9d,SAASy2B,GAAGxoC,GAAyB,OAAO,QAA7BA,EAAEA,EAAEyoC,yBAAmC,IAASzoC,CAAC,CAAC,SAAS0oC,KAAKZ,GAAEI,IAAIJ,GAAEG,GAAE,CAAC,SAASU,GAAG3oC,EAAE6hB,EAAEjC,GAAG,GAAGqoB,GAAE7hC,UAAU4hC,GAAG,MAAM5iB,MAAMxD,EAAE,MAAMmmB,GAAEE,GAAEpmB,GAAGkmB,GAAEG,GAAGtoB,EAAE,CAAC,SAASgpB,GAAG5oC,EAAE6hB,EAAEjC,GAAG,IAAI6C,EAAEziB,EAAEouB,UAAgC,GAAtBvM,EAAEA,EAAE4mB,kBAAqB,oBAAoBhmB,EAAEomB,gBAAgB,OAAOjpB,EAAwB,IAAI,IAAI7N,KAA9B0Q,EAAEA,EAAEomB,kBAAiC,KAAK92B,KAAK8P,GAAG,MAAMuD,MAAMxD,EAAE,IAAIuE,EAAGnmB,IAAI,UAAU+R,IAAI,OAAOrG,EAAE,CAAC,EAAEkU,EAAE6C,EAAE,CACxX,SAASqmB,GAAG9oC,GAA2G,OAAxGA,GAAGA,EAAEA,EAAEouB,YAAYpuB,EAAE+oC,2CAA2Cf,GAAGG,GAAGF,GAAE7hC,QAAQ2hC,GAAEE,GAAEjoC,GAAG+nC,GAAEG,GAAGA,GAAG9hC,UAAe,CAAE,CAAC,SAAS4iC,GAAGhpC,EAAE6hB,EAAEjC,GAAG,IAAI6C,EAAEziB,EAAEouB,UAAU,IAAI3L,EAAE,MAAM2C,MAAMxD,EAAE,MAAMhC,GAAG5f,EAAE4oC,GAAG5oC,EAAE6hB,EAAEsmB,IAAI1lB,EAAEsmB,0CAA0C/oC,EAAE8nC,GAAEI,IAAIJ,GAAEG,IAAGF,GAAEE,GAAEjoC,IAAI8nC,GAAEI,IAAIH,GAAEG,GAAGtoB,EAAE,CAAC,IAAIqpB,GAAG,KAAKC,IAAG,EAAGC,IAAG,EAAG,SAASC,GAAGppC,GAAG,OAAOipC,GAAGA,GAAG,CAACjpC,GAAGipC,GAAGx1C,KAAKuM,EAAE,CAChW,SAASqpC,KAAK,IAAIF,IAAI,OAAOF,GAAG,CAACE,IAAG,EAAG,IAAInpC,EAAE,EAAE6hB,EAAElrB,GAAE,IAAI,IAAIipB,EAAEqpB,GAAG,IAAItyC,GAAE,EAAEqJ,EAAE4f,EAAEtsB,OAAO0M,IAAI,CAAC,IAAIyiB,EAAE7C,EAAE5f,GAAG,GAAGyiB,EAAEA,GAAE,SAAU,OAAOA,EAAE,CAACwmB,GAAG,KAAKC,IAAG,CAAE,CAAC,MAAMn3B,GAAG,MAAM,OAAOk3B,KAAKA,GAAGA,GAAGjyC,MAAMgJ,EAAE,IAAIqwB,GAAGY,GAAGoY,IAAIt3B,CAAE,CAAC,QAAQpb,GAAEkrB,EAAEsnB,IAAG,CAAE,CAAC,CAAC,OAAO,IAAI,CAAC,IAAIG,GAAG,GAAGC,GAAG,EAAEC,GAAG,KAAKC,GAAG,EAAEC,GAAG,GAAGC,GAAG,EAAEC,GAAG,KAAKC,GAAG,EAAEC,GAAG,GAAG,SAASC,GAAG/pC,EAAE6hB,GAAGynB,GAAGC,MAAME,GAAGH,GAAGC,MAAMC,GAAGA,GAAGxpC,EAAEypC,GAAG5nB,CAAC,CACjV,SAASmoB,GAAGhqC,EAAE6hB,EAAEjC,GAAG8pB,GAAGC,MAAME,GAAGH,GAAGC,MAAMG,GAAGJ,GAAGC,MAAMC,GAAGA,GAAG5pC,EAAE,IAAIyiB,EAAEonB,GAAG7pC,EAAE8pC,GAAG,IAAI/3B,EAAE,GAAG8f,GAAGpP,GAAG,EAAEA,KAAK,GAAG1Q,GAAG6N,GAAG,EAAE,IAAIznB,EAAE,GAAG05B,GAAGhQ,GAAG9P,EAAE,GAAG,GAAG5Z,EAAE,CAAC,IAAIuqB,EAAE3Q,EAAEA,EAAE,EAAE5Z,GAAGsqB,GAAG,GAAGC,GAAG,GAAG5uB,SAAS,IAAI2uB,IAAIC,EAAE3Q,GAAG2Q,EAAEmnB,GAAG,GAAG,GAAGhY,GAAGhQ,GAAG9P,EAAE6N,GAAG7N,EAAE0Q,EAAEqnB,GAAG3xC,EAAE6H,CAAC,MAAM6pC,GAAG,GAAG1xC,EAAEynB,GAAG7N,EAAE0Q,EAAEqnB,GAAG9pC,CAAC,CAAC,SAASiqC,GAAGjqC,GAAG,OAAOA,EAAE2vB,SAASoa,GAAG/pC,EAAE,GAAGgqC,GAAGhqC,EAAE,EAAE,GAAG,CAAC,SAASkqC,GAAGlqC,GAAG,KAAKA,IAAIwpC,IAAIA,GAAGF,KAAKC,IAAID,GAAGC,IAAI,KAAKE,GAAGH,KAAKC,IAAID,GAAGC,IAAI,KAAK,KAAKvpC,IAAI4pC,IAAIA,GAAGF,KAAKC,IAAID,GAAGC,IAAI,KAAKG,GAAGJ,KAAKC,IAAID,GAAGC,IAAI,KAAKE,GAAGH,KAAKC,IAAID,GAAGC,IAAI,IAAI,CAAC,IAAIQ,GAAG,KAAKC,GAAG,KAAKC,IAAE,EAAGC,GAAG,KACje,SAASC,GAAGvqC,EAAE6hB,GAAG,IAAIjC,EAAE4qB,GAAG,EAAE,KAAK,KAAK,GAAG5qB,EAAE6qB,YAAY,UAAU7qB,EAAEwO,UAAUvM,EAAEjC,EAAE+P,OAAO3vB,EAAgB,QAAd6hB,EAAE7hB,EAAE0qC,YAAoB1qC,EAAE0qC,UAAU,CAAC9qB,GAAG5f,EAAEjE,OAAO,IAAI8lB,EAAEpuB,KAAKmsB,EAAE,CACxJ,SAAS+qB,GAAG3qC,EAAE6hB,GAAG,OAAO7hB,EAAEzI,KAAK,KAAK,EAAE,IAAIqoB,EAAE5f,EAAEqB,KAAyE,OAAO,QAA3EwgB,EAAE,IAAIA,EAAEpQ,UAAUmO,EAAEtd,gBAAgBuf,EAAEyE,SAAShkB,cAAc,KAAKuf,KAAmB7hB,EAAEouB,UAAUvM,EAAEsoB,GAAGnqC,EAAEoqC,GAAGjD,GAAGtlB,EAAEmH,aAAY,GAAO,KAAK,EAAE,OAAoD,QAA7CnH,EAAE,KAAK7hB,EAAE4qC,cAAc,IAAI/oB,EAAEpQ,SAAS,KAAKoQ,KAAY7hB,EAAEouB,UAAUvM,EAAEsoB,GAAGnqC,EAAEoqC,GAAG,MAAK,GAAO,KAAK,GAAG,OAA+B,QAAxBvoB,EAAE,IAAIA,EAAEpQ,SAAS,KAAKoQ,KAAYjC,EAAE,OAAOgqB,GAAG,CAAC/+B,GAAGg/B,GAAGgB,SAASf,IAAI,KAAK9pC,EAAE6vB,cAAc,CAACC,WAAWjO,EAAEipB,YAAYlrB,EAAEmrB,UAAU,aAAYnrB,EAAE4qB,GAAG,GAAG,KAAK,KAAK,IAAKpc,UAAUvM,EAAEjC,EAAE+P,OAAO3vB,EAAEA,EAAEiwB,MAAMrQ,EAAEuqB,GAAGnqC,EAAEoqC,GAClf,MAAK,GAAO,QAAQ,OAAM,EAAG,CAAC,SAASY,GAAGhrC,GAAG,OAAO,KAAY,EAAPA,EAAEmJ,OAAS,KAAa,IAARnJ,EAAEjE,MAAU,CAAC,SAASkvC,GAAGjrC,GAAG,GAAGqqC,GAAE,CAAC,IAAIxoB,EAAEuoB,GAAG,GAAGvoB,EAAE,CAAC,IAAIjC,EAAEiC,EAAE,IAAI8oB,GAAG3qC,EAAE6hB,GAAG,CAAC,GAAGmpB,GAAGhrC,GAAG,MAAMolB,MAAMxD,EAAE,MAAMC,EAAEslB,GAAGvnB,EAAE+gB,aAAa,IAAIle,EAAE0nB,GAAGtoB,GAAG8oB,GAAG3qC,EAAE6hB,GAAG0oB,GAAG9nB,EAAE7C,IAAI5f,EAAEjE,OAAe,KAATiE,EAAEjE,MAAY,EAAEsuC,IAAE,EAAGF,GAAGnqC,EAAE,CAAC,KAAK,CAAC,GAAGgrC,GAAGhrC,GAAG,MAAMolB,MAAMxD,EAAE,MAAM5hB,EAAEjE,OAAe,KAATiE,EAAEjE,MAAY,EAAEsuC,IAAE,EAAGF,GAAGnqC,CAAC,CAAC,CAAC,CAAC,SAASkrC,GAAGlrC,GAAG,IAAIA,EAAEA,EAAE2vB,OAAO,OAAO3vB,GAAG,IAAIA,EAAEzI,KAAK,IAAIyI,EAAEzI,KAAK,KAAKyI,EAAEzI,KAAKyI,EAAEA,EAAE2vB,OAAOwa,GAAGnqC,CAAC,CACha,SAASmrC,GAAGnrC,GAAG,GAAGA,IAAImqC,GAAG,OAAM,EAAG,IAAIE,GAAE,OAAOa,GAAGlrC,GAAGqqC,IAAE,GAAG,EAAG,IAAIxoB,EAAkG,IAA/FA,EAAE,IAAI7hB,EAAEzI,QAAQsqB,EAAE,IAAI7hB,EAAEzI,OAAgBsqB,EAAE,UAAXA,EAAE7hB,EAAEqB,OAAmB,SAASwgB,IAAI2kB,GAAGxmC,EAAEqB,KAAKrB,EAAEorC,gBAAmBvpB,IAAIA,EAAEuoB,IAAI,CAAC,GAAGY,GAAGhrC,GAAG,MAAMqrC,KAAKjmB,MAAMxD,EAAE,MAAM,KAAKC,GAAG0oB,GAAGvqC,EAAE6hB,GAAGA,EAAEslB,GAAGtlB,EAAE8e,YAAY,CAAO,GAANuK,GAAGlrC,GAAM,KAAKA,EAAEzI,IAAI,CAAgD,KAA7ByI,EAAE,QAApBA,EAAEA,EAAE6vB,eAAyB7vB,EAAE8vB,WAAW,MAAW,MAAM1K,MAAMxD,EAAE,MAAM5hB,EAAE,CAAiB,IAAhBA,EAAEA,EAAE2gC,YAAgB9e,EAAE,EAAE7hB,GAAG,CAAC,GAAG,IAAIA,EAAEyR,SAAS,CAAC,IAAImO,EAAE5f,EAAEiC,KAAK,GAAG,OAAO2d,EAAE,CAAC,GAAG,IAAIiC,EAAE,CAACuoB,GAAGjD,GAAGnnC,EAAE2gC,aAAa,MAAM3gC,CAAC,CAAC6hB,GAAG,KAAK,MAAMjC,GAAG,OAAOA,GAAG,OAAOA,GAAGiC,GAAG,CAAC7hB,EAAEA,EAAE2gC,WAAW,CAACyJ,GACjgB,IAAI,CAAC,MAAMA,GAAGD,GAAGhD,GAAGnnC,EAAEouB,UAAUuS,aAAa,KAAK,OAAM,CAAE,CAAC,SAAS0K,KAAK,IAAI,IAAIrrC,EAAEoqC,GAAGpqC,GAAGA,EAAEmnC,GAAGnnC,EAAE2gC,YAAY,CAAC,SAAS2K,KAAKlB,GAAGD,GAAG,KAAKE,IAAE,CAAE,CAAC,SAASkB,GAAGvrC,GAAG,OAAOsqC,GAAGA,GAAG,CAACtqC,GAAGsqC,GAAG72C,KAAKuM,EAAE,CAAC,IAAIwrC,GAAGznB,EAAG0R,wBAAwB,SAASgW,GAAGzrC,EAAE6hB,GAAG,GAAG7hB,GAAGA,EAAE0rC,aAAa,CAA4B,IAAI,IAAI9rB,KAAnCiC,EAAEnW,EAAE,CAAC,EAAEmW,GAAG7hB,EAAEA,EAAE0rC,kBAA4B,IAAS7pB,EAAEjC,KAAKiC,EAAEjC,GAAG5f,EAAE4f,IAAI,OAAOiC,CAAC,CAAC,OAAOA,CAAC,CAAC,IAAI8pB,GAAG9D,GAAG,MAAM+D,GAAG,KAAKC,GAAG,KAAKC,GAAG,KAAK,SAASC,KAAKD,GAAGD,GAAGD,GAAG,IAAI,CAAC,SAASI,GAAGhsC,GAAG,IAAI6hB,EAAE8pB,GAAGvlC,QAAQ0hC,GAAE6D,IAAI3rC,EAAEisC,cAAcpqB,CAAC,CACjd,SAASqqB,GAAGlsC,EAAE6hB,EAAEjC,GAAG,KAAK,OAAO5f,GAAG,CAAC,IAAIyiB,EAAEziB,EAAE0vB,UAA+H,IAApH1vB,EAAEmsC,WAAWtqB,KAAKA,GAAG7hB,EAAEmsC,YAAYtqB,EAAE,OAAOY,IAAIA,EAAE0pB,YAAYtqB,IAAI,OAAOY,IAAIA,EAAE0pB,WAAWtqB,KAAKA,IAAIY,EAAE0pB,YAAYtqB,GAAM7hB,IAAI4f,EAAE,MAAM5f,EAAEA,EAAE2vB,MAAM,CAAC,CAAC,SAASyc,GAAGpsC,EAAE6hB,GAAG+pB,GAAG5rC,EAAE8rC,GAAGD,GAAG,KAAsB,QAAjB7rC,EAAEA,EAAEqsC,eAAuB,OAAOrsC,EAAEssC,eAAe,KAAKtsC,EAAEusC,MAAM1qB,KAAK2qB,IAAG,GAAIxsC,EAAEssC,aAAa,KAAK,CACtU,SAASG,GAAGzsC,GAAG,IAAI6hB,EAAE7hB,EAAEisC,cAAc,GAAGH,KAAK9rC,EAAE,GAAGA,EAAE,CAACwN,QAAQxN,EAAE0sC,cAAc7qB,EAAE8qB,KAAK,MAAM,OAAOd,GAAG,CAAC,GAAG,OAAOD,GAAG,MAAMxmB,MAAMxD,EAAE,MAAMiqB,GAAG7rC,EAAE4rC,GAAGS,aAAa,CAACE,MAAM,EAAED,aAAatsC,EAAE,MAAM6rC,GAAGA,GAAGc,KAAK3sC,EAAE,OAAO6hB,CAAC,CAAC,IAAI+qB,GAAG,KAAK,SAASC,GAAG7sC,GAAG,OAAO4sC,GAAGA,GAAG,CAAC5sC,GAAG4sC,GAAGn5C,KAAKuM,EAAE,CAAC,SAAS8sC,GAAG9sC,EAAE6hB,EAAEjC,EAAE6C,GAAG,IAAI1Q,EAAE8P,EAAEkrB,YAA+E,OAAnE,OAAOh7B,GAAG6N,EAAE+sB,KAAK/sB,EAAEitB,GAAGhrB,KAAKjC,EAAE+sB,KAAK56B,EAAE46B,KAAK56B,EAAE46B,KAAK/sB,GAAGiC,EAAEkrB,YAAYntB,EAASotB,GAAGhtC,EAAEyiB,EAAE,CAChY,SAASuqB,GAAGhtC,EAAE6hB,GAAG7hB,EAAEusC,OAAO1qB,EAAE,IAAIjC,EAAE5f,EAAE0vB,UAAqC,IAA3B,OAAO9P,IAAIA,EAAE2sB,OAAO1qB,GAAGjC,EAAE5f,EAAMA,EAAEA,EAAE2vB,OAAO,OAAO3vB,GAAGA,EAAEmsC,YAAYtqB,EAAgB,QAAdjC,EAAE5f,EAAE0vB,aAAqB9P,EAAEusB,YAAYtqB,GAAGjC,EAAE5f,EAAEA,EAAEA,EAAE2vB,OAAO,OAAO,IAAI/P,EAAEroB,IAAIqoB,EAAEwO,UAAU,IAAI,CAAC,IAAI6e,IAAG,EAAG,SAASC,GAAGltC,GAAGA,EAAEmtC,YAAY,CAACC,UAAUptC,EAAE6vB,cAAcwd,gBAAgB,KAAKC,eAAe,KAAK7sC,OAAO,CAAC8sC,QAAQ,KAAKR,YAAY,KAAKR,MAAM,GAAGiB,QAAQ,KAAK,CACpX,SAASC,GAAGztC,EAAE6hB,GAAG7hB,EAAEA,EAAEmtC,YAAYtrB,EAAEsrB,cAAcntC,IAAI6hB,EAAEsrB,YAAY,CAACC,UAAUptC,EAAEotC,UAAUC,gBAAgBrtC,EAAEqtC,gBAAgBC,eAAettC,EAAEstC,eAAe7sC,OAAOT,EAAES,OAAO+sC,QAAQxtC,EAAEwtC,SAAS,CAAC,SAASjuC,GAAGS,EAAE6hB,GAAG,MAAM,CAAC6rB,UAAU1tC,EAAE2tC,KAAK9rB,EAAEtqB,IAAI,EAAEq2C,QAAQ,KAAKC,SAAS,KAAKlB,KAAK,KAAK,CACtR,SAASmB,GAAG9tC,EAAE6hB,EAAEjC,GAAG,IAAI6C,EAAEziB,EAAEmtC,YAAY,GAAG,OAAO1qB,EAAE,OAAO,KAAgB,GAAXA,EAAEA,EAAEhiB,OAAU,KAAO,EAAFstC,IAAK,CAAC,IAAIh8B,EAAE0Q,EAAE8qB,QAA+D,OAAvD,OAAOx7B,EAAE8P,EAAE8qB,KAAK9qB,GAAGA,EAAE8qB,KAAK56B,EAAE46B,KAAK56B,EAAE46B,KAAK9qB,GAAGY,EAAE8qB,QAAQ1rB,EAASmrB,GAAGhtC,EAAE4f,EAAE,CAAoF,OAAnE,QAAhB7N,EAAE0Q,EAAEsqB,cAAsBlrB,EAAE8qB,KAAK9qB,EAAEgrB,GAAGpqB,KAAKZ,EAAE8qB,KAAK56B,EAAE46B,KAAK56B,EAAE46B,KAAK9qB,GAAGY,EAAEsqB,YAAYlrB,EAASmrB,GAAGhtC,EAAE4f,EAAE,CAAC,SAASouB,GAAGhuC,EAAE6hB,EAAEjC,GAAmB,GAAG,QAAnBiC,EAAEA,EAAEsrB,eAA0BtrB,EAAEA,EAAEphB,OAAO,KAAO,QAAFmf,IAAY,CAAC,IAAI6C,EAAEZ,EAAE0qB,MAAwB3sB,GAAlB6C,GAAGziB,EAAEuyB,aAAkB1Q,EAAE0qB,MAAM3sB,EAAEsT,GAAGlzB,EAAE4f,EAAE,CAAC,CACrZ,SAASquB,GAAGjuC,EAAE6hB,GAAG,IAAIjC,EAAE5f,EAAEmtC,YAAY1qB,EAAEziB,EAAE0vB,UAAU,GAAG,OAAOjN,GAAoB7C,KAAhB6C,EAAEA,EAAE0qB,aAAmB,CAAC,IAAIp7B,EAAE,KAAK5Z,EAAE,KAAyB,GAAG,QAAvBynB,EAAEA,EAAEytB,iBAA4B,CAAC,EAAE,CAAC,IAAI3qB,EAAE,CAACgrB,UAAU9tB,EAAE8tB,UAAUC,KAAK/tB,EAAE+tB,KAAKp2C,IAAIqoB,EAAEroB,IAAIq2C,QAAQhuB,EAAEguB,QAAQC,SAASjuB,EAAEiuB,SAASlB,KAAK,MAAM,OAAOx0C,EAAE4Z,EAAE5Z,EAAEuqB,EAAEvqB,EAAEA,EAAEw0C,KAAKjqB,EAAE9C,EAAEA,EAAE+sB,IAAI,OAAO,OAAO/sB,GAAG,OAAOznB,EAAE4Z,EAAE5Z,EAAE0pB,EAAE1pB,EAAEA,EAAEw0C,KAAK9qB,CAAC,MAAM9P,EAAE5Z,EAAE0pB,EAAiH,OAA/GjC,EAAE,CAACwtB,UAAU3qB,EAAE2qB,UAAUC,gBAAgBt7B,EAAEu7B,eAAen1C,EAAEsI,OAAOgiB,EAAEhiB,OAAO+sC,QAAQ/qB,EAAE+qB,cAASxtC,EAAEmtC,YAAYvtB,EAAQ,CAAoB,QAAnB5f,EAAE4f,EAAE0tB,gBAAwB1tB,EAAEytB,gBAAgBxrB,EAAE7hB,EAAE2sC,KACnf9qB,EAAEjC,EAAE0tB,eAAezrB,CAAC,CACpB,SAASqsB,GAAGluC,EAAE6hB,EAAEjC,EAAE6C,GAAG,IAAI1Q,EAAE/R,EAAEmtC,YAAYF,IAAG,EAAG,IAAI90C,EAAE4Z,EAAEs7B,gBAAgB3qB,EAAE3Q,EAAEu7B,eAAe7nB,EAAE1T,EAAEtR,OAAO8sC,QAAQ,GAAG,OAAO9nB,EAAE,CAAC1T,EAAEtR,OAAO8sC,QAAQ,KAAK,IAAI7nB,EAAED,EAAEjX,EAAEkX,EAAEinB,KAAKjnB,EAAEinB,KAAK,KAAK,OAAOjqB,EAAEvqB,EAAEqW,EAAEkU,EAAEiqB,KAAKn+B,EAAEkU,EAAEgD,EAAE,IAAIrmB,EAAEW,EAAE0vB,UAAU,OAAOrwB,KAAoBomB,GAAhBpmB,EAAEA,EAAE8tC,aAAgBG,kBAAmB5qB,IAAI,OAAO+C,EAAEpmB,EAAEguC,gBAAgB7+B,EAAEiX,EAAEknB,KAAKn+B,EAAEnP,EAAEiuC,eAAe5nB,GAAG,CAAC,GAAG,OAAOvtB,EAAE,CAAC,IAAIg2C,EAAEp8B,EAAEq7B,UAA6B,IAAnB1qB,EAAE,EAAErjB,EAAEmP,EAAEkX,EAAE,KAAKD,EAAEttB,IAAI,CAAC,IAAIi2C,EAAE3oB,EAAEkoB,KAAKU,EAAE5oB,EAAEioB,UAAU,IAAIjrB,EAAE2rB,KAAKA,EAAE,CAAC,OAAO/uC,IAAIA,EAAEA,EAAEstC,KAAK,CAACe,UAAUW,EAAEV,KAAK,EAAEp2C,IAAIkuB,EAAEluB,IAAIq2C,QAAQnoB,EAAEmoB,QAAQC,SAASpoB,EAAEooB,SACvflB,KAAK,OAAO3sC,EAAE,CAAC,IAAIP,EAAEO,EAAEklC,EAAEzf,EAAU,OAAR2oB,EAAEvsB,EAAEwsB,EAAEzuB,EAASslB,EAAE3tC,KAAK,KAAK,EAAc,GAAG,oBAAfkI,EAAEylC,EAAE0I,SAAiC,CAACO,EAAE1uC,EAAEtL,KAAKk6C,EAAEF,EAAEC,GAAG,MAAMpuC,CAAC,CAACmuC,EAAE1uC,EAAE,MAAMO,EAAE,KAAK,EAAEP,EAAE1D,OAAe,MAAT0D,EAAE1D,MAAa,IAAI,KAAK,EAAsD,GAAG,QAA3CqyC,EAAE,oBAAd3uC,EAAEylC,EAAE0I,SAAgCnuC,EAAEtL,KAAKk6C,EAAEF,EAAEC,GAAG3uC,SAAe,IAAS2uC,EAAE,MAAMpuC,EAAEmuC,EAAEziC,EAAE,CAAC,EAAEyiC,EAAEC,GAAG,MAAMpuC,EAAE,KAAK,EAAEitC,IAAG,EAAG,CAAC,OAAOxnB,EAAEooB,UAAU,IAAIpoB,EAAEkoB,OAAO3tC,EAAEjE,OAAO,GAAe,QAAZqyC,EAAEr8B,EAAEy7B,SAAiBz7B,EAAEy7B,QAAQ,CAAC/nB,GAAG2oB,EAAE36C,KAAKgyB,GAAG,MAAM4oB,EAAE,CAACX,UAAUW,EAAEV,KAAKS,EAAE72C,IAAIkuB,EAAEluB,IAAIq2C,QAAQnoB,EAAEmoB,QAAQC,SAASpoB,EAAEooB,SAASlB,KAAK,MAAM,OAAOttC,GAAGmP,EAAEnP,EAAEgvC,EAAE3oB,EAAEyoB,GAAG9uC,EAAEA,EAAEstC,KAAK0B,EAAE3rB,GAAG0rB,EAC3e,GAAG,QAAZ3oB,EAAEA,EAAEknB,MAAiB,IAAsB,QAAnBlnB,EAAE1T,EAAEtR,OAAO8sC,SAAiB,MAAe9nB,GAAJ2oB,EAAE3oB,GAAMknB,KAAKyB,EAAEzB,KAAK,KAAK56B,EAAEu7B,eAAec,EAAEr8B,EAAEtR,OAAO8sC,QAAQ,IAAI,EAAsG,GAA5F,OAAOluC,IAAIqmB,EAAEyoB,GAAGp8B,EAAEq7B,UAAU1nB,EAAE3T,EAAEs7B,gBAAgB7+B,EAAEuD,EAAEu7B,eAAejuC,EAA4B,QAA1BwiB,EAAE9P,EAAEtR,OAAOssC,aAAwB,CAACh7B,EAAE8P,EAAE,GAAGa,GAAG3Q,EAAE47B,KAAK57B,EAAEA,EAAE46B,WAAW56B,IAAI8P,EAAE,MAAM,OAAO1pB,IAAI4Z,EAAEtR,OAAO8rC,MAAM,GAAG+B,IAAI5rB,EAAE1iB,EAAEusC,MAAM7pB,EAAE1iB,EAAE6vB,cAAcse,CAAC,CAAC,CAC9V,SAASI,GAAGvuC,EAAE6hB,EAAEjC,GAA8B,GAA3B5f,EAAE6hB,EAAE2rB,QAAQ3rB,EAAE2rB,QAAQ,KAAQ,OAAOxtC,EAAE,IAAI6hB,EAAE,EAAEA,EAAE7hB,EAAE1M,OAAOuuB,IAAI,CAAC,IAAIY,EAAEziB,EAAE6hB,GAAG9P,EAAE0Q,EAAEorB,SAAS,GAAG,OAAO97B,EAAE,CAAqB,GAApB0Q,EAAEorB,SAAS,KAAKprB,EAAE7C,EAAK,oBAAoB7N,EAAE,MAAMqT,MAAMxD,EAAE,IAAI7P,IAAIA,EAAE5d,KAAKsuB,EAAE,CAAC,CAAC,CAAC,IAAI+rB,IAAI,IAAI9sB,EAAG+sB,WAAWC,KAAK,SAASC,GAAG3uC,EAAE6hB,EAAEjC,EAAE6C,GAA8B7C,EAAE,QAAXA,EAAEA,EAAE6C,EAAtBZ,EAAE7hB,EAAE6vB,sBAAmC,IAASjQ,EAAEiC,EAAEnW,EAAE,CAAC,EAAEmW,EAAEjC,GAAG5f,EAAE6vB,cAAcjQ,EAAE,IAAI5f,EAAEusC,QAAQvsC,EAAEmtC,YAAYC,UAAUxtB,EAAE,CAClX,IAAIgvB,GAAG,CAACC,UAAU,SAAS7uC,GAAG,SAAOA,EAAEA,EAAE8uC,kBAAiBrf,GAAGzvB,KAAKA,CAAI,EAAE+uC,gBAAgB,SAAS/uC,EAAE6hB,EAAEjC,GAAG5f,EAAEA,EAAE8uC,gBAAgB,IAAIrsB,EAAEusB,KAAIj9B,EAAEk9B,GAAGjvC,GAAG7H,EAAEoH,GAAGkjB,EAAE1Q,GAAG5Z,EAAEy1C,QAAQ/rB,OAAE,IAASjC,GAAG,OAAOA,IAAIznB,EAAE01C,SAASjuB,GAAe,QAAZiC,EAAEisB,GAAG9tC,EAAE7H,EAAE4Z,MAAcm9B,GAAGrtB,EAAE7hB,EAAE+R,EAAE0Q,GAAGurB,GAAGnsB,EAAE7hB,EAAE+R,GAAG,EAAEo9B,oBAAoB,SAASnvC,EAAE6hB,EAAEjC,GAAG5f,EAAEA,EAAE8uC,gBAAgB,IAAIrsB,EAAEusB,KAAIj9B,EAAEk9B,GAAGjvC,GAAG7H,EAAEoH,GAAGkjB,EAAE1Q,GAAG5Z,EAAEZ,IAAI,EAAEY,EAAEy1C,QAAQ/rB,OAAE,IAASjC,GAAG,OAAOA,IAAIznB,EAAE01C,SAASjuB,GAAe,QAAZiC,EAAEisB,GAAG9tC,EAAE7H,EAAE4Z,MAAcm9B,GAAGrtB,EAAE7hB,EAAE+R,EAAE0Q,GAAGurB,GAAGnsB,EAAE7hB,EAAE+R,GAAG,EAAEq9B,mBAAmB,SAASpvC,EAAE6hB,GAAG7hB,EAAEA,EAAE8uC,gBAAgB,IAAIlvB,EAAEovB,KAAIvsB,EACnfwsB,GAAGjvC,GAAG+R,EAAExS,GAAGqgB,EAAE6C,GAAG1Q,EAAExa,IAAI,OAAE,IAASsqB,GAAG,OAAOA,IAAI9P,EAAE87B,SAAShsB,GAAe,QAAZA,EAAEisB,GAAG9tC,EAAE+R,EAAE0Q,MAAcysB,GAAGrtB,EAAE7hB,EAAEyiB,EAAE7C,GAAGouB,GAAGnsB,EAAE7hB,EAAEyiB,GAAG,GAAG,SAAS4sB,GAAGrvC,EAAE6hB,EAAEjC,EAAE6C,EAAE1Q,EAAE5Z,EAAEuqB,GAAiB,MAAM,oBAApB1iB,EAAEA,EAAEouB,WAAsCkhB,sBAAsBtvC,EAAEsvC,sBAAsB7sB,EAAEtqB,EAAEuqB,IAAGb,EAAE7tB,YAAW6tB,EAAE7tB,UAAUu7C,wBAAsBhP,GAAG3gB,EAAE6C,KAAK8d,GAAGxuB,EAAE5Z,GAAK,CAC1S,SAASq3C,GAAGxvC,EAAE6hB,EAAEjC,GAAG,IAAI6C,GAAE,EAAG1Q,EAAEi2B,GAAO7vC,EAAE0pB,EAAE4tB,YAA2W,MAA/V,kBAAkBt3C,GAAG,OAAOA,EAAEA,EAAEs0C,GAAGt0C,IAAI4Z,EAAEy2B,GAAG3mB,GAAGsmB,GAAGF,GAAE7hC,QAAyBjO,GAAGsqB,EAAE,QAAtBA,EAAEZ,EAAEwmB,oBAA4B,IAAS5lB,GAAG2lB,GAAGpoC,EAAE+R,GAAGi2B,IAAInmB,EAAE,IAAIA,EAAEjC,EAAEznB,GAAG6H,EAAE6vB,cAAc,OAAOhO,EAAE/gB,YAAO,IAAS+gB,EAAE/gB,MAAM+gB,EAAE/gB,MAAM,KAAK+gB,EAAE6tB,QAAQd,GAAG5uC,EAAEouB,UAAUvM,EAAEA,EAAEitB,gBAAgB9uC,EAAEyiB,KAAIziB,EAAEA,EAAEouB,WAAYka,4CAA4Cv2B,EAAE/R,EAAEuoC,0CAA0CpwC,GAAU0pB,CAAC,CAC5Z,SAAS8tB,GAAG3vC,EAAE6hB,EAAEjC,EAAE6C,GAAGziB,EAAE6hB,EAAE/gB,MAAM,oBAAoB+gB,EAAE+tB,2BAA2B/tB,EAAE+tB,0BAA0BhwB,EAAE6C,GAAG,oBAAoBZ,EAAEguB,kCAAkChuB,EAAEguB,iCAAiCjwB,EAAE6C,GAAGZ,EAAE/gB,QAAQd,GAAG4uC,GAAGO,oBAAoBttB,EAAEA,EAAE/gB,MAAM,KAAK,CACpQ,SAASgvC,GAAG9vC,EAAE6hB,EAAEjC,EAAE6C,GAAG,IAAI1Q,EAAE/R,EAAEouB,UAAUrc,EAAEnM,MAAMga,EAAE7N,EAAEjR,MAAMd,EAAE6vB,cAAc9d,EAAE28B,KAAKF,GAAGtB,GAAGltC,GAAG,IAAI7H,EAAE0pB,EAAE4tB,YAAY,kBAAkBt3C,GAAG,OAAOA,EAAE4Z,EAAEvE,QAAQi/B,GAAGt0C,IAAIA,EAAEqwC,GAAG3mB,GAAGsmB,GAAGF,GAAE7hC,QAAQ2L,EAAEvE,QAAQ46B,GAAGpoC,EAAE7H,IAAI4Z,EAAEjR,MAAMd,EAAE6vB,cAA2C,oBAA7B13B,EAAE0pB,EAAEkuB,4BAAiDpB,GAAG3uC,EAAE6hB,EAAE1pB,EAAEynB,GAAG7N,EAAEjR,MAAMd,EAAE6vB,eAAe,oBAAoBhO,EAAEkuB,0BAA0B,oBAAoBh+B,EAAEi+B,yBAAyB,oBAAoBj+B,EAAEk+B,2BAA2B,oBAAoBl+B,EAAEm+B,qBAAqBruB,EAAE9P,EAAEjR,MACrf,oBAAoBiR,EAAEm+B,oBAAoBn+B,EAAEm+B,qBAAqB,oBAAoBn+B,EAAEk+B,2BAA2Bl+B,EAAEk+B,4BAA4BpuB,IAAI9P,EAAEjR,OAAO8tC,GAAGO,oBAAoBp9B,EAAEA,EAAEjR,MAAM,MAAMotC,GAAGluC,EAAE4f,EAAE7N,EAAE0Q,GAAG1Q,EAAEjR,MAAMd,EAAE6vB,eAAe,oBAAoB9d,EAAEo+B,oBAAoBnwC,EAAEjE,OAAO,QAAQ,CACpS,SAASq0C,GAAGpwC,EAAE6hB,EAAEjC,GAAW,GAAG,QAAX5f,EAAE4f,EAAEywB,MAAiB,oBAAoBrwC,GAAG,kBAAkBA,EAAE,CAAC,GAAG4f,EAAE0wB,OAAO,CAAY,GAAX1wB,EAAEA,EAAE0wB,OAAY,CAAC,GAAG,IAAI1wB,EAAEroB,IAAI,MAAM6tB,MAAMxD,EAAE,MAAM,IAAIa,EAAE7C,EAAEwO,SAAS,CAAC,IAAI3L,EAAE,MAAM2C,MAAMxD,EAAE,IAAI5hB,IAAI,IAAI+R,EAAE0Q,EAAEtqB,EAAE,GAAG6H,EAAE,OAAG,OAAO6hB,GAAG,OAAOA,EAAEwuB,KAAK,oBAAoBxuB,EAAEwuB,KAAKxuB,EAAEwuB,IAAIE,aAAap4C,EAAS0pB,EAAEwuB,KAAIxuB,EAAE,SAAS7hB,GAAG,IAAI6hB,EAAE9P,EAAE28B,KAAK7sB,IAAI2sB,KAAK3sB,EAAE9P,EAAE28B,KAAK,CAAC,GAAG,OAAO1uC,SAAS6hB,EAAE1pB,GAAG0pB,EAAE1pB,GAAG6H,CAAC,EAAE6hB,EAAE0uB,WAAWp4C,EAAS0pB,EAAC,CAAC,GAAG,kBAAkB7hB,EAAE,MAAMolB,MAAMxD,EAAE,MAAM,IAAIhC,EAAE0wB,OAAO,MAAMlrB,MAAMxD,EAAE,IAAI5hB,GAAI,CAAC,OAAOA,CAAC,CACre,SAASwwC,GAAGxwC,EAAE6hB,GAAuC,MAApC7hB,EAAEjM,OAAOC,UAAUF,SAASK,KAAK0tB,GAASuD,MAAMxD,EAAE,GAAG,oBAAoB5hB,EAAE,qBAAqBjM,OAAOmE,KAAK2pB,GAAGztB,KAAK,MAAM,IAAI4L,GAAI,CAAC,SAASywC,GAAGzwC,GAAiB,OAAO6hB,EAAf7hB,EAAEkmB,OAAelmB,EAAEimB,SAAS,CACrM,SAASyqB,GAAG1wC,GAAG,SAAS6hB,EAAEA,EAAEjC,GAAG,GAAG5f,EAAE,CAAC,IAAIyiB,EAAEZ,EAAE6oB,UAAU,OAAOjoB,GAAGZ,EAAE6oB,UAAU,CAAC9qB,GAAGiC,EAAE9lB,OAAO,IAAI0mB,EAAEhvB,KAAKmsB,EAAE,CAAC,CAAC,SAASA,EAAEA,EAAE6C,GAAG,IAAIziB,EAAE,OAAO,KAAK,KAAK,OAAOyiB,GAAGZ,EAAEjC,EAAE6C,GAAGA,EAAEA,EAAEyN,QAAQ,OAAO,IAAI,CAAC,SAASzN,EAAEziB,EAAE6hB,GAAG,IAAI7hB,EAAE,IAAI6T,IAAI,OAAOgO,GAAG,OAAOA,EAAE3tB,IAAI8L,EAAEM,IAAIuhB,EAAE3tB,IAAI2tB,GAAG7hB,EAAEM,IAAIuhB,EAAErsB,MAAMqsB,GAAGA,EAAEA,EAAEqO,QAAQ,OAAOlwB,CAAC,CAAC,SAAS+R,EAAE/R,EAAE6hB,GAAsC,OAAnC7hB,EAAE2wC,GAAG3wC,EAAE6hB,IAAKrsB,MAAM,EAAEwK,EAAEkwB,QAAQ,KAAYlwB,CAAC,CAAC,SAAS7H,EAAE0pB,EAAEjC,EAAE6C,GAAa,OAAVZ,EAAErsB,MAAMitB,EAAMziB,EAA6C,QAAjByiB,EAAEZ,EAAE6N,YAA6BjN,EAAEA,EAAEjtB,OAAQoqB,GAAGiC,EAAE9lB,OAAO,EAAE6jB,GAAG6C,GAAEZ,EAAE9lB,OAAO,EAAS6jB,IAArGiC,EAAE9lB,OAAO,QAAQ6jB,EAAqF,CAAC,SAAS8C,EAAEb,GACzd,OAD4d7hB,GAC7f,OAAO6hB,EAAE6N,YAAY7N,EAAE9lB,OAAO,GAAU8lB,CAAC,CAAC,SAAS4D,EAAEzlB,EAAE6hB,EAAEjC,EAAE6C,GAAG,OAAG,OAAOZ,GAAG,IAAIA,EAAEtqB,MAAWsqB,EAAE+uB,GAAGhxB,EAAE5f,EAAEmJ,KAAKsZ,IAAKkN,OAAO3vB,EAAE6hB,KAAEA,EAAE9P,EAAE8P,EAAEjC,IAAK+P,OAAO3vB,EAAS6hB,EAAC,CAAC,SAAS6D,EAAE1lB,EAAE6hB,EAAEjC,EAAE6C,GAAG,IAAItqB,EAAEynB,EAAEve,KAAK,OAAGlJ,IAAIisB,EAAU/kB,EAAEW,EAAE6hB,EAAEjC,EAAEha,MAAMyiB,SAAS5F,EAAE7C,EAAE1rB,KAAQ,OAAO2tB,IAAIA,EAAE4oB,cAActyC,GAAG,kBAAkBA,GAAG,OAAOA,GAAGA,EAAE4tB,WAAWlB,GAAI4rB,GAAGt4C,KAAK0pB,EAAExgB,QAAaohB,EAAE1Q,EAAE8P,EAAEjC,EAAEha,QAASyqC,IAAID,GAAGpwC,EAAE6hB,EAAEjC,GAAG6C,EAAEkN,OAAO3vB,EAAEyiB,KAAEA,EAAEouB,GAAGjxB,EAAEve,KAAKue,EAAE1rB,IAAI0rB,EAAEha,MAAM,KAAK5F,EAAEmJ,KAAKsZ,IAAK4tB,IAAID,GAAGpwC,EAAE6hB,EAAEjC,GAAG6C,EAAEkN,OAAO3vB,EAASyiB,EAAC,CAAC,SAASjU,EAAExO,EAAE6hB,EAAEjC,EAAE6C,GAAG,OAAG,OAAOZ,GAAG,IAAIA,EAAEtqB,KACjfsqB,EAAEuM,UAAU2G,gBAAgBnV,EAAEmV,eAAelT,EAAEuM,UAAU0iB,iBAAiBlxB,EAAEkxB,iBAAsBjvB,EAAEkvB,GAAGnxB,EAAE5f,EAAEmJ,KAAKsZ,IAAKkN,OAAO3vB,EAAE6hB,KAAEA,EAAE9P,EAAE8P,EAAEjC,EAAEyI,UAAU,KAAMsH,OAAO3vB,EAAS6hB,EAAC,CAAC,SAASxiB,EAAEW,EAAE6hB,EAAEjC,EAAE6C,EAAEtqB,GAAG,OAAG,OAAO0pB,GAAG,IAAIA,EAAEtqB,MAAWsqB,EAAEmvB,GAAGpxB,EAAE5f,EAAEmJ,KAAKsZ,EAAEtqB,IAAKw3B,OAAO3vB,EAAE6hB,KAAEA,EAAE9P,EAAE8P,EAAEjC,IAAK+P,OAAO3vB,EAAS6hB,EAAC,CAAC,SAASssB,EAAEnuC,EAAE6hB,EAAEjC,GAAG,GAAG,kBAAkBiC,GAAG,KAAKA,GAAG,kBAAkBA,EAAE,OAAOA,EAAE+uB,GAAG,GAAG/uB,EAAE7hB,EAAEmJ,KAAKyW,IAAK+P,OAAO3vB,EAAE6hB,EAAE,GAAG,kBAAkBA,GAAG,OAAOA,EAAE,CAAC,OAAOA,EAAEkE,UAAU,KAAK9B,EAAG,OAAOrE,EAAEixB,GAAGhvB,EAAExgB,KAAKwgB,EAAE3tB,IAAI2tB,EAAEjc,MAAM,KAAK5F,EAAEmJ,KAAKyW,IACjfywB,IAAID,GAAGpwC,EAAE,KAAK6hB,GAAGjC,EAAE+P,OAAO3vB,EAAE4f,EAAE,KAAKuE,EAAG,OAAOtC,EAAEkvB,GAAGlvB,EAAE7hB,EAAEmJ,KAAKyW,IAAK+P,OAAO3vB,EAAE6hB,EAAE,KAAKgD,EAAiB,OAAOspB,EAAEnuC,GAAEyiB,EAAnBZ,EAAEqE,OAAmBrE,EAAEoE,UAAUrG,GAAG,GAAGkI,GAAGjG,IAAImD,EAAGnD,GAAG,OAAOA,EAAEmvB,GAAGnvB,EAAE7hB,EAAEmJ,KAAKyW,EAAE,OAAQ+P,OAAO3vB,EAAE6hB,EAAE2uB,GAAGxwC,EAAE6hB,EAAE,CAAC,OAAO,IAAI,CAAC,SAASusB,EAAEpuC,EAAE6hB,EAAEjC,EAAE6C,GAAG,IAAI1Q,EAAE,OAAO8P,EAAEA,EAAE3tB,IAAI,KAAK,GAAG,kBAAkB0rB,GAAG,KAAKA,GAAG,kBAAkBA,EAAE,OAAO,OAAO7N,EAAE,KAAK0T,EAAEzlB,EAAE6hB,EAAE,GAAGjC,EAAE6C,GAAG,GAAG,kBAAkB7C,GAAG,OAAOA,EAAE,CAAC,OAAOA,EAAEmG,UAAU,KAAK9B,EAAG,OAAOrE,EAAE1rB,MAAM6d,EAAE2T,EAAE1lB,EAAE6hB,EAAEjC,EAAE6C,GAAG,KAAK,KAAK0B,EAAG,OAAOvE,EAAE1rB,MAAM6d,EAAEvD,EAAExO,EAAE6hB,EAAEjC,EAAE6C,GAAG,KAAK,KAAKoC,EAAG,OAAiBupB,EAAEpuC,EACpf6hB,GADwe9P,EAAE6N,EAAEsG,OACxetG,EAAEqG,UAAUxD,GAAG,GAAGqF,GAAGlI,IAAIoF,EAAGpF,GAAG,OAAO,OAAO7N,EAAE,KAAK1S,EAAEW,EAAE6hB,EAAEjC,EAAE6C,EAAE,MAAM+tB,GAAGxwC,EAAE4f,EAAE,CAAC,OAAO,IAAI,CAAC,SAASyuB,EAAEruC,EAAE6hB,EAAEjC,EAAE6C,EAAE1Q,GAAG,GAAG,kBAAkB0Q,GAAG,KAAKA,GAAG,kBAAkBA,EAAE,OAAwBgD,EAAE5D,EAAnB7hB,EAAEA,EAAE3G,IAAIumB,IAAI,KAAW,GAAG6C,EAAE1Q,GAAG,GAAG,kBAAkB0Q,GAAG,OAAOA,EAAE,CAAC,OAAOA,EAAEsD,UAAU,KAAK9B,EAAG,OAA2CyB,EAAE7D,EAAtC7hB,EAAEA,EAAE3G,IAAI,OAAOopB,EAAEvuB,IAAI0rB,EAAE6C,EAAEvuB,MAAM,KAAWuuB,EAAE1Q,GAAG,KAAKoS,EAAG,OAA2C3V,EAAEqT,EAAtC7hB,EAAEA,EAAE3G,IAAI,OAAOopB,EAAEvuB,IAAI0rB,EAAE6C,EAAEvuB,MAAM,KAAWuuB,EAAE1Q,GAAG,KAAK8S,EAAiB,OAAOwpB,EAAEruC,EAAE6hB,EAAEjC,GAAEznB,EAAvBsqB,EAAEyD,OAAuBzD,EAAEwD,UAAUlU,GAAG,GAAG+V,GAAGrF,IAAIuC,EAAGvC,GAAG,OAAwBpjB,EAAEwiB,EAAnB7hB,EAAEA,EAAE3G,IAAIumB,IAAI,KAAW6C,EAAE1Q,EAAE,MAAMy+B,GAAG3uB,EAAEY,EAAE,CAAC,OAAO,IAAI,CAC9f,SAAShjB,EAAEsS,EAAE2Q,EAAE+C,EAAEC,GAAG,IAAI,IAAIlX,EAAE,KAAKnP,EAAE,KAAK+lC,EAAE1iB,EAAE1B,EAAE0B,EAAE,EAAEnf,EAAE,KAAK,OAAO6hC,GAAGpkB,EAAEyE,EAAEnyB,OAAO0tB,IAAI,CAACokB,EAAE5vC,MAAMwrB,GAAGzd,EAAE6hC,EAAEA,EAAE,MAAM7hC,EAAE6hC,EAAElV,QAAQ,IAAIzwB,EAAE2uC,EAAEr8B,EAAEqzB,EAAE3f,EAAEzE,GAAG0E,GAAG,GAAG,OAAOjmB,EAAE,CAAC,OAAO2lC,IAAIA,EAAE7hC,GAAG,KAAK,CAACvD,GAAGolC,GAAG,OAAO3lC,EAAEiwB,WAAW7N,EAAE9P,EAAEqzB,GAAG1iB,EAAEvqB,EAAEsH,EAAEijB,EAAE1B,GAAG,OAAO3hB,EAAEmP,EAAE/O,EAAEJ,EAAE6wB,QAAQzwB,EAAEJ,EAAEI,EAAE2lC,EAAE7hC,CAAC,CAAC,GAAGyd,IAAIyE,EAAEnyB,OAAO,OAAOssB,EAAE7N,EAAEqzB,GAAGiF,IAAGN,GAAGh4B,EAAEiP,GAAGxS,EAAE,GAAG,OAAO42B,EAAE,CAAC,KAAKpkB,EAAEyE,EAAEnyB,OAAO0tB,IAAkB,QAAdokB,EAAE+I,EAAEp8B,EAAE0T,EAAEzE,GAAG0E,MAAchD,EAAEvqB,EAAEitC,EAAE1iB,EAAE1B,GAAG,OAAO3hB,EAAEmP,EAAE42B,EAAE/lC,EAAE6wB,QAAQkV,EAAE/lC,EAAE+lC,GAAc,OAAXiF,IAAGN,GAAGh4B,EAAEiP,GAAUxS,CAAC,CAAC,IAAI42B,EAAE3iB,EAAE1Q,EAAEqzB,GAAGpkB,EAAEyE,EAAEnyB,OAAO0tB,IAAsB,QAAlBzd,EAAE8qC,EAAEjJ,EAAErzB,EAAEiP,EAAEyE,EAAEzE,GAAG0E,MAAc1lB,GAAG,OAAOuD,EAAEmsB,WAAW0V,EAAEjR,OAAO,OACvf5wB,EAAErP,IAAI8sB,EAAEzd,EAAErP,KAAKwuB,EAAEvqB,EAAEoL,EAAEmf,EAAE1B,GAAG,OAAO3hB,EAAEmP,EAAEjL,EAAElE,EAAE6wB,QAAQ3sB,EAAElE,EAAEkE,GAAuD,OAApDvD,GAAGolC,EAAE7yB,SAAQ,SAASvS,GAAG,OAAO6hB,EAAE9P,EAAE/R,EAAE,IAAGqqC,IAAGN,GAAGh4B,EAAEiP,GAAUxS,CAAC,CAAC,SAAS02B,EAAEnzB,EAAE2Q,EAAE+C,EAAEC,GAAG,IAAIlX,EAAEwW,EAAGS,GAAG,GAAG,oBAAoBjX,EAAE,MAAM4W,MAAMxD,EAAE,MAAkB,GAAG,OAAf6D,EAAEjX,EAAEra,KAAKsxB,IAAc,MAAML,MAAMxD,EAAE,MAAM,IAAI,IAAIwjB,EAAE52B,EAAE,KAAKnP,EAAEqjB,EAAE1B,EAAE0B,EAAE,EAAEnf,EAAE,KAAK9D,EAAEgmB,EAAEknB,OAAO,OAAOttC,IAAII,EAAEhD,KAAKukB,IAAIvhB,EAAEgmB,EAAEknB,OAAO,CAACttC,EAAE7J,MAAMwrB,GAAGzd,EAAElE,EAAEA,EAAE,MAAMkE,EAAElE,EAAE6wB,QAAQ,IAAIgV,EAAEkJ,EAAEr8B,EAAE1S,EAAEI,EAAEpK,MAAMqwB,GAAG,GAAG,OAAOwf,EAAE,CAAC,OAAO7lC,IAAIA,EAAEkE,GAAG,KAAK,CAACvD,GAAGX,GAAG,OAAO6lC,EAAExV,WAAW7N,EAAE9P,EAAE1S,GAAGqjB,EAAEvqB,EAAE+sC,EAAExiB,EAAE1B,GAAG,OAAOokB,EAAE52B,EAAE02B,EAAEE,EAAElV,QAAQgV,EAAEE,EAAEF,EAAE7lC,EAAEkE,CAAC,CAAC,GAAG9D,EAAEhD,KAAK,OAAOmjB,EAAE7N,EACzf1S,GAAGgrC,IAAGN,GAAGh4B,EAAEiP,GAAGxS,EAAE,GAAG,OAAOnP,EAAE,CAAC,MAAMI,EAAEhD,KAAKukB,IAAIvhB,EAAEgmB,EAAEknB,OAAwB,QAAjBltC,EAAE0uC,EAAEp8B,EAAEtS,EAAEpK,MAAMqwB,MAAchD,EAAEvqB,EAAEsH,EAAEijB,EAAE1B,GAAG,OAAOokB,EAAE52B,EAAE/O,EAAE2lC,EAAElV,QAAQzwB,EAAE2lC,EAAE3lC,GAAc,OAAX4qC,IAAGN,GAAGh4B,EAAEiP,GAAUxS,CAAC,CAAC,IAAInP,EAAEojB,EAAE1Q,EAAE1S,IAAII,EAAEhD,KAAKukB,IAAIvhB,EAAEgmB,EAAEknB,OAA4B,QAArBltC,EAAE4uC,EAAEhvC,EAAE0S,EAAEiP,EAAEvhB,EAAEpK,MAAMqwB,MAAc1lB,GAAG,OAAOP,EAAEiwB,WAAWrwB,EAAE80B,OAAO,OAAO10B,EAAEvL,IAAI8sB,EAAEvhB,EAAEvL,KAAKwuB,EAAEvqB,EAAEsH,EAAEijB,EAAE1B,GAAG,OAAOokB,EAAE52B,EAAE/O,EAAE2lC,EAAElV,QAAQzwB,EAAE2lC,EAAE3lC,GAAuD,OAApDO,GAAGX,EAAEkT,SAAQ,SAASvS,GAAG,OAAO6hB,EAAE9P,EAAE/R,EAAE,IAAGqqC,IAAGN,GAAGh4B,EAAEiP,GAAUxS,CAAC,CAG3T,OAH4T,SAAS22B,EAAEnlC,EAAEyiB,EAAEtqB,EAAEstB,GAAkF,GAA/E,kBAAkBttB,GAAG,OAAOA,GAAGA,EAAEkJ,OAAO+iB,GAAI,OAAOjsB,EAAEjE,MAAMiE,EAAEA,EAAEyN,MAAMyiB,UAAa,kBAAkBlwB,GAAG,OAAOA,EAAE,CAAC,OAAOA,EAAE4tB,UAAU,KAAK9B,EAAGjkB,EAAE,CAAC,IAAI,IAAI0lB,EAC7hBvtB,EAAEjE,IAAIsa,EAAEiU,EAAE,OAAOjU,GAAG,CAAC,GAAGA,EAAEta,MAAMwxB,EAAE,CAAU,IAATA,EAAEvtB,EAAEkJ,QAAY+iB,GAAI,GAAG,IAAI5V,EAAEjX,IAAI,CAACqoB,EAAE5f,EAAEwO,EAAE0hB,UAASzN,EAAE1Q,EAAEvD,EAAErW,EAAEyN,MAAMyiB,WAAYsH,OAAO3vB,EAAEA,EAAEyiB,EAAE,MAAMziB,CAAC,OAAO,GAAGwO,EAAEi8B,cAAc/kB,GAAG,kBAAkBA,GAAG,OAAOA,GAAGA,EAAEK,WAAWlB,GAAI4rB,GAAG/qB,KAAKlX,EAAEnN,KAAK,CAACue,EAAE5f,EAAEwO,EAAE0hB,UAASzN,EAAE1Q,EAAEvD,EAAErW,EAAEyN,QAASyqC,IAAID,GAAGpwC,EAAEwO,EAAErW,GAAGsqB,EAAEkN,OAAO3vB,EAAEA,EAAEyiB,EAAE,MAAMziB,CAAC,CAAC4f,EAAE5f,EAAEwO,GAAG,KAAK,CAAMqT,EAAE7hB,EAAEwO,GAAGA,EAAEA,EAAE0hB,OAAO,CAAC/3B,EAAEkJ,OAAO+iB,IAAI3B,EAAEuuB,GAAG74C,EAAEyN,MAAMyiB,SAASroB,EAAEmJ,KAAKsc,EAAEttB,EAAEjE,MAAOy7B,OAAO3vB,EAAEA,EAAEyiB,KAAIgD,EAAEorB,GAAG14C,EAAEkJ,KAAKlJ,EAAEjE,IAAIiE,EAAEyN,MAAM,KAAK5F,EAAEmJ,KAAKsc,IAAK4qB,IAAID,GAAGpwC,EAAEyiB,EAAEtqB,GAAGstB,EAAEkK,OAAO3vB,EAAEA,EAAEylB,EAAE,CAAC,OAAO/C,EAAE1iB,GAAG,KAAKmkB,EAAGnkB,EAAE,CAAC,IAAIwO,EAAErW,EAAEjE,IAAI,OACzfuuB,GAAG,CAAC,GAAGA,EAAEvuB,MAAMsa,EAAC,CAAC,GAAG,IAAIiU,EAAElrB,KAAKkrB,EAAE2L,UAAU2G,gBAAgB58B,EAAE48B,eAAetS,EAAE2L,UAAU0iB,iBAAiB34C,EAAE24C,eAAe,CAAClxB,EAAE5f,EAAEyiB,EAAEyN,UAASzN,EAAE1Q,EAAE0Q,EAAEtqB,EAAEkwB,UAAU,KAAMsH,OAAO3vB,EAAEA,EAAEyiB,EAAE,MAAMziB,CAAC,CAAM4f,EAAE5f,EAAEyiB,GAAG,KAAM,CAAKZ,EAAE7hB,EAAEyiB,GAAGA,EAAEA,EAAEyN,OAAO,EAACzN,EAAEsuB,GAAG54C,EAAE6H,EAAEmJ,KAAKsc,IAAKkK,OAAO3vB,EAAEA,EAAEyiB,CAAC,CAAC,OAAOC,EAAE1iB,GAAG,KAAK6kB,EAAG,OAAiBsgB,EAAEnlC,EAAEyiB,GAAdjU,EAAErW,EAAE+tB,OAAc/tB,EAAE8tB,UAAUR,GAAG,GAAGqC,GAAG3vB,GAAG,OAAOsH,EAAEO,EAAEyiB,EAAEtqB,EAAEstB,GAAG,GAAGT,EAAG7sB,GAAG,OAAO+sC,EAAEllC,EAAEyiB,EAAEtqB,EAAEstB,GAAG+qB,GAAGxwC,EAAE7H,EAAE,CAAC,MAAM,kBAAkBA,GAAG,KAAKA,GAAG,kBAAkBA,GAAGA,EAAE,GAAGA,EAAE,OAAOsqB,GAAG,IAAIA,EAAElrB,KAAKqoB,EAAE5f,EAAEyiB,EAAEyN,UAASzN,EAAE1Q,EAAE0Q,EAAEtqB,IAAKw3B,OAAO3vB,EAAEA,EAAEyiB,IACnf7C,EAAE5f,EAAEyiB,IAAGA,EAAEmuB,GAAGz4C,EAAE6H,EAAEmJ,KAAKsc,IAAKkK,OAAO3vB,EAAEA,EAAEyiB,GAAGC,EAAE1iB,IAAI4f,EAAE5f,EAAEyiB,EAAE,CAAS,CAAC,IAAIwuB,GAAGP,IAAG,GAAIQ,GAAGR,IAAG,GAAIS,GAAG,CAAC,EAAEC,GAAGvJ,GAAGsJ,IAAIE,GAAGxJ,GAAGsJ,IAAIG,GAAGzJ,GAAGsJ,IAAI,SAASI,GAAGvxC,GAAG,GAAGA,IAAImxC,GAAG,MAAM/rB,MAAMxD,EAAE,MAAM,OAAO5hB,CAAC,CAAC,SAASwxC,GAAGxxC,EAAE6hB,GAAyC,OAAtCkmB,GAAEuJ,GAAGzvB,GAAGkmB,GAAEsJ,GAAGrxC,GAAG+nC,GAAEqJ,GAAGD,IAAInxC,EAAE6hB,EAAEpQ,UAAmB,KAAK,EAAE,KAAK,GAAGoQ,GAAGA,EAAEA,EAAE0f,iBAAiB1f,EAAEiH,aAAaH,GAAG,KAAK,IAAI,MAAM,QAAkE9G,EAAE8G,GAArC9G,GAAvB7hB,EAAE,IAAIA,EAAE6hB,EAAEiM,WAAWjM,GAAMiH,cAAc,KAAK9oB,EAAEA,EAAEyxC,SAAkB3J,GAAEsJ,IAAIrJ,GAAEqJ,GAAGvvB,EAAE,CAAC,SAAS6vB,KAAK5J,GAAEsJ,IAAItJ,GAAEuJ,IAAIvJ,GAAEwJ,GAAG,CACnb,SAASK,GAAG3xC,GAAGuxC,GAAGD,GAAGlrC,SAAS,IAAIyb,EAAE0vB,GAAGH,GAAGhrC,SAAawZ,EAAE+I,GAAG9G,EAAE7hB,EAAEqB,MAAMwgB,IAAIjC,IAAImoB,GAAEsJ,GAAGrxC,GAAG+nC,GAAEqJ,GAAGxxB,GAAG,CAAC,SAASgyB,GAAG5xC,GAAGqxC,GAAGjrC,UAAUpG,IAAI8nC,GAAEsJ,IAAItJ,GAAEuJ,IAAI,CAAC,IAAIQ,GAAEhK,GAAG,GACrJ,SAASiK,GAAG9xC,GAAG,IAAI,IAAI6hB,EAAE7hB,EAAE,OAAO6hB,GAAG,CAAC,GAAG,KAAKA,EAAEtqB,IAAI,CAAC,IAAIqoB,EAAEiC,EAAEgO,cAAc,GAAG,OAAOjQ,IAAmB,QAAfA,EAAEA,EAAEkQ,aAAqB,OAAOlQ,EAAE3d,MAAM,OAAO2d,EAAE3d,MAAM,OAAO4f,CAAC,MAAM,GAAG,KAAKA,EAAEtqB,UAAK,IAASsqB,EAAEupB,cAAc2G,aAAa,GAAG,KAAa,IAARlwB,EAAE9lB,OAAW,OAAO8lB,OAAO,GAAG,OAAOA,EAAEoO,MAAM,CAACpO,EAAEoO,MAAMN,OAAO9N,EAAEA,EAAEA,EAAEoO,MAAM,QAAQ,CAAC,GAAGpO,IAAI7hB,EAAE,MAAM,KAAK,OAAO6hB,EAAEqO,SAAS,CAAC,GAAG,OAAOrO,EAAE8N,QAAQ9N,EAAE8N,SAAS3vB,EAAE,OAAO,KAAK6hB,EAAEA,EAAE8N,MAAM,CAAC9N,EAAEqO,QAAQP,OAAO9N,EAAE8N,OAAO9N,EAAEA,EAAEqO,OAAO,CAAC,OAAO,IAAI,CAAC,IAAI8hB,GAAG,GACrc,SAASC,KAAK,IAAI,IAAIjyC,EAAE,EAAEA,EAAEgyC,GAAG1+C,OAAO0M,IAAIgyC,GAAGhyC,GAAGkyC,8BAA8B,KAAKF,GAAG1+C,OAAO,CAAC,CAAC,IAAI6+C,GAAGpuB,EAAGquB,uBAAuBC,GAAGtuB,EAAG0R,wBAAwB6c,GAAG,EAAEC,GAAE,KAAKl8C,GAAE,KAAKkI,GAAE,KAAKi0C,IAAG,EAAGC,IAAG,EAAGC,GAAG,EAAEC,GAAG,EAAE,SAASC,KAAI,MAAMxtB,MAAMxD,EAAE,KAAM,CAAC,SAASixB,GAAG7yC,EAAE6hB,GAAG,GAAG,OAAOA,EAAE,OAAM,EAAG,IAAI,IAAIjC,EAAE,EAAEA,EAAEiC,EAAEvuB,QAAQssB,EAAE5f,EAAE1M,OAAOssB,IAAI,IAAI0gB,GAAGtgC,EAAE4f,GAAGiC,EAAEjC,IAAI,OAAM,EAAG,OAAM,CAAE,CAChW,SAASkzB,GAAG9yC,EAAE6hB,EAAEjC,EAAE6C,EAAE1Q,EAAE5Z,GAAyH,GAAtHm6C,GAAGn6C,EAAEo6C,GAAE1wB,EAAEA,EAAEgO,cAAc,KAAKhO,EAAEsrB,YAAY,KAAKtrB,EAAE0qB,MAAM,EAAE4F,GAAG/rC,QAAQ,OAAOpG,GAAG,OAAOA,EAAE6vB,cAAckjB,GAAGC,GAAGhzC,EAAE4f,EAAE6C,EAAE1Q,GAAM0gC,GAAG,CAACt6C,EAAE,EAAE,EAAE,CAAY,GAAXs6C,IAAG,EAAGC,GAAG,EAAK,IAAIv6C,EAAE,MAAMitB,MAAMxD,EAAE,MAAMzpB,GAAG,EAAEoG,GAAElI,GAAE,KAAKwrB,EAAEsrB,YAAY,KAAKgF,GAAG/rC,QAAQ6sC,GAAGjzC,EAAE4f,EAAE6C,EAAE1Q,EAAE,OAAO0gC,GAAG,CAA+D,GAA9DN,GAAG/rC,QAAQ8sC,GAAGrxB,EAAE,OAAOxrB,IAAG,OAAOA,GAAEs2C,KAAK2F,GAAG,EAAE/zC,GAAElI,GAAEk8C,GAAE,KAAKC,IAAG,EAAM3wB,EAAE,MAAMuD,MAAMxD,EAAE,MAAM,OAAO5hB,CAAC,CAAC,SAASmzC,KAAK,IAAInzC,EAAE,IAAI0yC,GAAQ,OAALA,GAAG,EAAS1yC,CAAC,CAC/Y,SAASozC,KAAK,IAAIpzC,EAAE,CAAC6vB,cAAc,KAAKud,UAAU,KAAKiG,UAAU,KAAKC,MAAM,KAAK3G,KAAK,MAA8C,OAAxC,OAAOpuC,GAAEg0C,GAAE1iB,cAActxB,GAAEyB,EAAEzB,GAAEA,GAAEouC,KAAK3sC,EAASzB,EAAC,CAAC,SAASg1C,KAAK,GAAG,OAAOl9C,GAAE,CAAC,IAAI2J,EAAEuyC,GAAE7iB,UAAU1vB,EAAE,OAAOA,EAAEA,EAAE6vB,cAAc,IAAI,MAAM7vB,EAAE3J,GAAEs2C,KAAK,IAAI9qB,EAAE,OAAOtjB,GAAEg0C,GAAE1iB,cAActxB,GAAEouC,KAAK,GAAG,OAAO9qB,EAAEtjB,GAAEsjB,EAAExrB,GAAE2J,MAAM,CAAC,GAAG,OAAOA,EAAE,MAAMolB,MAAMxD,EAAE,MAAU5hB,EAAE,CAAC6vB,eAAPx5B,GAAE2J,GAAqB6vB,cAAcud,UAAU/2C,GAAE+2C,UAAUiG,UAAUh9C,GAAEg9C,UAAUC,MAAMj9C,GAAEi9C,MAAM3G,KAAK,MAAM,OAAOpuC,GAAEg0C,GAAE1iB,cAActxB,GAAEyB,EAAEzB,GAAEA,GAAEouC,KAAK3sC,CAAC,CAAC,OAAOzB,EAAC,CACje,SAASi1C,GAAGxzC,EAAE6hB,GAAG,MAAM,oBAAoBA,EAAEA,EAAE7hB,GAAG6hB,CAAC,CACnD,SAAS4xB,GAAGzzC,GAAG,IAAI6hB,EAAE0xB,KAAK3zB,EAAEiC,EAAEyxB,MAAM,GAAG,OAAO1zB,EAAE,MAAMwF,MAAMxD,EAAE,MAAMhC,EAAE8zB,oBAAoB1zC,EAAE,IAAIyiB,EAAEpsB,GAAE0b,EAAE0Q,EAAE4wB,UAAUl7C,EAAEynB,EAAE2tB,QAAQ,GAAG,OAAOp1C,EAAE,CAAC,GAAG,OAAO4Z,EAAE,CAAC,IAAI2Q,EAAE3Q,EAAE46B,KAAK56B,EAAE46B,KAAKx0C,EAAEw0C,KAAKx0C,EAAEw0C,KAAKjqB,CAAC,CAACD,EAAE4wB,UAAUthC,EAAE5Z,EAAEynB,EAAE2tB,QAAQ,IAAI,CAAC,GAAG,OAAOx7B,EAAE,CAAC5Z,EAAE4Z,EAAE46B,KAAKlqB,EAAEA,EAAE2qB,UAAU,IAAI3nB,EAAE/C,EAAE,KAAKgD,EAAE,KAAKlX,EAAErW,EAAE,EAAE,CAAC,IAAIkH,EAAEmP,EAAEm/B,KAAK,IAAI2E,GAAGjzC,KAAKA,EAAE,OAAOqmB,IAAIA,EAAEA,EAAEinB,KAAK,CAACgB,KAAK,EAAEgG,OAAOnlC,EAAEmlC,OAAOC,cAAcplC,EAAEolC,cAAcC,WAAWrlC,EAAEqlC,WAAWlH,KAAK,OAAOlqB,EAAEjU,EAAEolC,cAAcplC,EAAEqlC,WAAW7zC,EAAEyiB,EAAEjU,EAAEmlC,YAAY,CAAC,IAAIxF,EAAE,CAACR,KAAKtuC,EAAEs0C,OAAOnlC,EAAEmlC,OAAOC,cAAcplC,EAAEolC,cACngBC,WAAWrlC,EAAEqlC,WAAWlH,KAAK,MAAM,OAAOjnB,GAAGD,EAAEC,EAAEyoB,EAAEzrB,EAAED,GAAGiD,EAAEA,EAAEinB,KAAKwB,EAAEoE,GAAEhG,OAAOltC,EAAEivC,IAAIjvC,CAAC,CAACmP,EAAEA,EAAEm+B,IAAI,OAAO,OAAOn+B,GAAGA,IAAIrW,GAAG,OAAOutB,EAAEhD,EAAED,EAAEiD,EAAEinB,KAAKlnB,EAAE6a,GAAG7d,EAAEZ,EAAEgO,iBAAiB2c,IAAG,GAAI3qB,EAAEgO,cAAcpN,EAAEZ,EAAEurB,UAAU1qB,EAAEb,EAAEwxB,UAAU3tB,EAAE9F,EAAEk0B,kBAAkBrxB,CAAC,CAAiB,GAAG,QAAnBziB,EAAE4f,EAAEmtB,aAAwB,CAACh7B,EAAE/R,EAAE,GAAG7H,EAAE4Z,EAAE47B,KAAK4E,GAAEhG,OAAOp0C,EAAEm2C,IAAIn2C,EAAE4Z,EAAEA,EAAE46B,WAAW56B,IAAI/R,EAAE,MAAM,OAAO+R,IAAI6N,EAAE2sB,MAAM,GAAG,MAAM,CAAC1qB,EAAEgO,cAAcjQ,EAAEm0B,SAAS,CAC9X,SAASC,GAAGh0C,GAAG,IAAI6hB,EAAE0xB,KAAK3zB,EAAEiC,EAAEyxB,MAAM,GAAG,OAAO1zB,EAAE,MAAMwF,MAAMxD,EAAE,MAAMhC,EAAE8zB,oBAAoB1zC,EAAE,IAAIyiB,EAAE7C,EAAEm0B,SAAShiC,EAAE6N,EAAE2tB,QAAQp1C,EAAE0pB,EAAEgO,cAAc,GAAG,OAAO9d,EAAE,CAAC6N,EAAE2tB,QAAQ,KAAK,IAAI7qB,EAAE3Q,EAAEA,EAAE46B,KAAK,GAAGx0C,EAAE6H,EAAE7H,EAAEuqB,EAAEixB,QAAQjxB,EAAEA,EAAEiqB,WAAWjqB,IAAI3Q,GAAGuuB,GAAGnoC,EAAE0pB,EAAEgO,iBAAiB2c,IAAG,GAAI3qB,EAAEgO,cAAc13B,EAAE,OAAO0pB,EAAEwxB,YAAYxxB,EAAEurB,UAAUj1C,GAAGynB,EAAEk0B,kBAAkB37C,CAAC,CAAC,MAAM,CAACA,EAAEsqB,EAAE,CAAC,SAASwxB,KAAK,CACpW,SAASh0B,GAAGjgB,EAAE6hB,GAAG,IAAIjC,EAAE2yB,GAAE9vB,EAAE8wB,KAAKxhC,EAAE8P,IAAI1pB,GAAGmoC,GAAG7d,EAAEoN,cAAc9d,GAAsE,GAAnE5Z,IAAIsqB,EAAEoN,cAAc9d,EAAEy6B,IAAG,GAAI/pB,EAAEA,EAAE6wB,MAAMY,GAAGC,GAAGx3C,KAAK,KAAKijB,EAAE6C,EAAEziB,GAAG,CAACA,IAAOyiB,EAAE2xB,cAAcvyB,GAAG1pB,GAAG,OAAOoG,IAAuB,EAApBA,GAAEsxB,cAAct4B,IAAM,CAAuD,GAAtDqoB,EAAE7jB,OAAO,KAAKs4C,GAAG,EAAEC,GAAG33C,KAAK,KAAKijB,EAAE6C,EAAE1Q,EAAE8P,QAAG,EAAO,MAAS,OAAO1a,GAAE,MAAMie,MAAMxD,EAAE,MAAM,KAAQ,GAAH0wB,KAAQiC,GAAG30B,EAAEiC,EAAE9P,EAAE,CAAC,OAAOA,CAAC,CAAC,SAASwiC,GAAGv0C,EAAE6hB,EAAEjC,GAAG5f,EAAEjE,OAAO,MAAMiE,EAAE,CAACo0C,YAAYvyB,EAAExsB,MAAMuqB,GAAmB,QAAhBiC,EAAE0wB,GAAEpF,cAAsBtrB,EAAE,CAAC2yB,WAAW,KAAKC,OAAO,MAAMlC,GAAEpF,YAAYtrB,EAAEA,EAAE4yB,OAAO,CAACz0C,IAAgB,QAAX4f,EAAEiC,EAAE4yB,QAAgB5yB,EAAE4yB,OAAO,CAACz0C,GAAG4f,EAAEnsB,KAAKuM,EAAG,CAClf,SAASs0C,GAAGt0C,EAAE6hB,EAAEjC,EAAE6C,GAAGZ,EAAExsB,MAAMuqB,EAAEiC,EAAEuyB,YAAY3xB,EAAEiyB,GAAG7yB,IAAI8yB,GAAG30C,EAAE,CAAC,SAASm0C,GAAGn0C,EAAE6hB,EAAEjC,GAAG,OAAOA,GAAE,WAAW80B,GAAG7yB,IAAI8yB,GAAG30C,EAAE,GAAE,CAAC,SAAS00C,GAAG10C,GAAG,IAAI6hB,EAAE7hB,EAAEo0C,YAAYp0C,EAAEA,EAAE3K,MAAM,IAAI,IAAIuqB,EAAEiC,IAAI,OAAOye,GAAGtgC,EAAE4f,EAAE,CAAC,MAAM6C,GAAG,OAAM,CAAE,CAAC,CAAC,SAASkyB,GAAG30C,GAAG,IAAI6hB,EAAEmrB,GAAGhtC,EAAE,GAAG,OAAO6hB,GAAGqtB,GAAGrtB,EAAE7hB,EAAE,GAAG,EAAE,CAClQ,SAAS40C,GAAG50C,GAAG,IAAI6hB,EAAEuxB,KAA8M,MAAzM,oBAAoBpzC,IAAIA,EAAEA,KAAK6hB,EAAEgO,cAAchO,EAAEurB,UAAUptC,EAAEA,EAAE,CAACutC,QAAQ,KAAKR,YAAY,KAAKR,MAAM,EAAEwH,SAAS,KAAKL,oBAAoBF,GAAGM,kBAAkB9zC,GAAG6hB,EAAEyxB,MAAMtzC,EAAEA,EAAEA,EAAE+zC,SAASc,GAAGl4C,KAAK,KAAK41C,GAAEvyC,GAAS,CAAC6hB,EAAEgO,cAAc7vB,EAAE,CAC5P,SAASq0C,GAAGr0C,EAAE6hB,EAAEjC,EAAE6C,GAA8O,OAA3OziB,EAAE,CAACzI,IAAIyI,EAAEjL,OAAO8sB,EAAEizB,QAAQl1B,EAAEm1B,KAAKtyB,EAAEkqB,KAAK,MAAsB,QAAhB9qB,EAAE0wB,GAAEpF,cAAsBtrB,EAAE,CAAC2yB,WAAW,KAAKC,OAAO,MAAMlC,GAAEpF,YAAYtrB,EAAEA,EAAE2yB,WAAWx0C,EAAE2sC,KAAK3sC,GAAmB,QAAf4f,EAAEiC,EAAE2yB,YAAoB3yB,EAAE2yB,WAAWx0C,EAAE2sC,KAAK3sC,GAAGyiB,EAAE7C,EAAE+sB,KAAK/sB,EAAE+sB,KAAK3sC,EAAEA,EAAE2sC,KAAKlqB,EAAEZ,EAAE2yB,WAAWx0C,GAAWA,CAAC,CAAC,SAASg1C,KAAK,OAAOzB,KAAK1jB,aAAa,CAAC,SAASolB,GAAGj1C,EAAE6hB,EAAEjC,EAAE6C,GAAG,IAAI1Q,EAAEqhC,KAAKb,GAAEx2C,OAAOiE,EAAE+R,EAAE8d,cAAcwkB,GAAG,EAAExyB,EAAEjC,OAAE,OAAO,IAAS6C,EAAE,KAAKA,EAAE,CAC9Y,SAASyyB,GAAGl1C,EAAE6hB,EAAEjC,EAAE6C,GAAG,IAAI1Q,EAAEwhC,KAAK9wB,OAAE,IAASA,EAAE,KAAKA,EAAE,IAAItqB,OAAE,EAAO,GAAG,OAAO9B,GAAE,CAAC,IAAIqsB,EAAErsB,GAAEw5B,cAA0B,GAAZ13B,EAAEuqB,EAAEoyB,QAAW,OAAOryB,GAAGowB,GAAGpwB,EAAEC,EAAEqyB,MAAmC,YAA5BhjC,EAAE8d,cAAcwkB,GAAGxyB,EAAEjC,EAAEznB,EAAEsqB,GAAU,CAAC8vB,GAAEx2C,OAAOiE,EAAE+R,EAAE8d,cAAcwkB,GAAG,EAAExyB,EAAEjC,EAAEznB,EAAEsqB,EAAE,CAAC,SAAS0yB,GAAGn1C,EAAE6hB,GAAG,OAAOozB,GAAG,QAAQ,EAAEj1C,EAAE6hB,EAAE,CAAC,SAASqyB,GAAGl0C,EAAE6hB,GAAG,OAAOqzB,GAAG,KAAK,EAAEl1C,EAAE6hB,EAAE,CAAC,SAASuzB,GAAGp1C,EAAE6hB,GAAG,OAAOqzB,GAAG,EAAE,EAAEl1C,EAAE6hB,EAAE,CAAC,SAASwzB,GAAGr1C,EAAE6hB,GAAG,OAAOqzB,GAAG,EAAE,EAAEl1C,EAAE6hB,EAAE,CAChX,SAASyzB,GAAGt1C,EAAE6hB,GAAG,MAAG,oBAAoBA,GAAS7hB,EAAEA,IAAI6hB,EAAE7hB,GAAG,WAAW6hB,EAAE,KAAK,GAAK,OAAOA,QAAG,IAASA,GAAS7hB,EAAEA,IAAI6hB,EAAEzb,QAAQpG,EAAE,WAAW6hB,EAAEzb,QAAQ,IAAI,QAA1E,CAA2E,CAAC,SAASmvC,GAAGv1C,EAAE6hB,EAAEjC,GAA6C,OAA1CA,EAAE,OAAOA,QAAG,IAASA,EAAEA,EAAErZ,OAAO,CAACvG,IAAI,KAAYk1C,GAAG,EAAE,EAAEI,GAAG34C,KAAK,KAAKklB,EAAE7hB,GAAG4f,EAAE,CAAC,SAAS41B,KAAK,CAAC,SAASC,GAAGz1C,EAAE6hB,GAAG,IAAIjC,EAAE2zB,KAAK1xB,OAAE,IAASA,EAAE,KAAKA,EAAE,IAAIY,EAAE7C,EAAEiQ,cAAc,OAAG,OAAOpN,GAAG,OAAOZ,GAAGgxB,GAAGhxB,EAAEY,EAAE,IAAWA,EAAE,IAAG7C,EAAEiQ,cAAc,CAAC7vB,EAAE6hB,GAAU7hB,EAAC,CAC7Z,SAAS01C,GAAG11C,EAAE6hB,GAAG,IAAIjC,EAAE2zB,KAAK1xB,OAAE,IAASA,EAAE,KAAKA,EAAE,IAAIY,EAAE7C,EAAEiQ,cAAc,OAAG,OAAOpN,GAAG,OAAOZ,GAAGgxB,GAAGhxB,EAAEY,EAAE,IAAWA,EAAE,IAAGziB,EAAEA,IAAI4f,EAAEiQ,cAAc,CAAC7vB,EAAE6hB,GAAU7hB,EAAC,CAAC,SAAS21C,GAAG31C,EAAE6hB,EAAEjC,GAAG,OAAG,KAAQ,GAAH0yB,KAActyC,EAAEotC,YAAYptC,EAAEotC,WAAU,EAAGZ,IAAG,GAAIxsC,EAAE6vB,cAAcjQ,IAAE0gB,GAAG1gB,EAAEiC,KAAKjC,EAAEkT,KAAKyf,GAAEhG,OAAO3sB,EAAE0uB,IAAI1uB,EAAE5f,EAAEotC,WAAU,GAAWvrB,EAAC,CAAC,SAAS+zB,GAAG51C,EAAE6hB,GAAG,IAAIjC,EAAEjpB,GAAEA,GAAE,IAAIipB,GAAG,EAAEA,EAAEA,EAAE,EAAE5f,GAAE,GAAI,IAAIyiB,EAAE4vB,GAAGzc,WAAWyc,GAAGzc,WAAW,CAAC,EAAE,IAAI51B,GAAE,GAAI6hB,GAAG,CAAC,QAAQlrB,GAAEipB,EAAEyyB,GAAGzc,WAAWnT,CAAC,CAAC,CAAC,SAASozB,KAAK,OAAOtC,KAAK1jB,aAAa,CAC1d,SAASimB,GAAG91C,EAAE6hB,EAAEjC,GAAG,IAAI6C,EAAEwsB,GAAGjvC,GAAkE,GAA/D4f,EAAE,CAAC+tB,KAAKlrB,EAAEkxB,OAAO/zB,EAAEg0B,eAAc,EAAGC,WAAW,KAAKlH,KAAK,MAASoJ,GAAG/1C,GAAGg2C,GAAGn0B,EAAEjC,QAAQ,GAAiB,QAAdA,EAAEktB,GAAG9sC,EAAE6hB,EAAEjC,EAAE6C,IAAY,CAAWysB,GAAGtvB,EAAE5f,EAAEyiB,EAAXusB,MAAgBiH,GAAGr2B,EAAEiC,EAAEY,EAAE,CAAC,CAC/K,SAASoyB,GAAG70C,EAAE6hB,EAAEjC,GAAG,IAAI6C,EAAEwsB,GAAGjvC,GAAG+R,EAAE,CAAC47B,KAAKlrB,EAAEkxB,OAAO/zB,EAAEg0B,eAAc,EAAGC,WAAW,KAAKlH,KAAK,MAAM,GAAGoJ,GAAG/1C,GAAGg2C,GAAGn0B,EAAE9P,OAAO,CAAC,IAAI5Z,EAAE6H,EAAE0vB,UAAU,GAAG,IAAI1vB,EAAEusC,QAAQ,OAAOp0C,GAAG,IAAIA,EAAEo0C,QAAiC,QAAxBp0C,EAAE0pB,EAAE6xB,qBAA8B,IAAI,IAAIhxB,EAAEb,EAAEiyB,kBAAkBruB,EAAEttB,EAAEuqB,EAAE9C,GAAqC,GAAlC7N,EAAE6hC,eAAc,EAAG7hC,EAAE8hC,WAAWpuB,EAAK6a,GAAG7a,EAAE/C,GAAG,CAAC,IAAIgD,EAAE7D,EAAEkrB,YAA+E,OAAnE,OAAOrnB,GAAG3T,EAAE46B,KAAK56B,EAAE86B,GAAGhrB,KAAK9P,EAAE46B,KAAKjnB,EAAEinB,KAAKjnB,EAAEinB,KAAK56B,QAAG8P,EAAEkrB,YAAYh7B,EAAQ,CAAC,CAAC,MAAMvD,GAAG,CAAwB,QAAdoR,EAAEktB,GAAG9sC,EAAE6hB,EAAE9P,EAAE0Q,MAAoBysB,GAAGtvB,EAAE5f,EAAEyiB,EAAb1Q,EAAEi9B,MAAgBiH,GAAGr2B,EAAEiC,EAAEY,GAAG,CAAC,CAC/c,SAASszB,GAAG/1C,GAAG,IAAI6hB,EAAE7hB,EAAE0vB,UAAU,OAAO1vB,IAAIuyC,IAAG,OAAO1wB,GAAGA,IAAI0wB,EAAC,CAAC,SAASyD,GAAGh2C,EAAE6hB,GAAG4wB,GAAGD,IAAG,EAAG,IAAI5yB,EAAE5f,EAAEutC,QAAQ,OAAO3tB,EAAEiC,EAAE8qB,KAAK9qB,GAAGA,EAAE8qB,KAAK/sB,EAAE+sB,KAAK/sB,EAAE+sB,KAAK9qB,GAAG7hB,EAAEutC,QAAQ1rB,CAAC,CAAC,SAASo0B,GAAGj2C,EAAE6hB,EAAEjC,GAAG,GAAG,KAAO,QAAFA,GAAW,CAAC,IAAI6C,EAAEZ,EAAE0qB,MAAwB3sB,GAAlB6C,GAAGziB,EAAEuyB,aAAkB1Q,EAAE0qB,MAAM3sB,EAAEsT,GAAGlzB,EAAE4f,EAAE,CAAC,CAC9P,IAAIszB,GAAG,CAACgD,YAAYzJ,GAAG0J,YAAYvD,GAAEwD,WAAWxD,GAAEyD,UAAUzD,GAAE0D,oBAAoB1D,GAAE2D,mBAAmB3D,GAAE4D,gBAAgB5D,GAAE6D,QAAQ7D,GAAE8D,WAAW9D,GAAE+D,OAAO/D,GAAEgE,SAAShE,GAAEiE,cAAcjE,GAAEkE,iBAAiBlE,GAAEmE,cAAcnE,GAAEoE,iBAAiBpE,GAAEqE,qBAAqBrE,GAAEsE,MAAMtE,GAAEuE,0BAAyB,GAAIpE,GAAG,CAACmD,YAAYzJ,GAAG0J,YAAY,SAASn2C,EAAE6hB,GAA4C,OAAzCuxB,KAAKvjB,cAAc,CAAC7vB,OAAE,IAAS6hB,EAAE,KAAKA,GAAU7hB,CAAC,EAAEo2C,WAAW3J,GAAG4J,UAAUlB,GAAGmB,oBAAoB,SAASt2C,EAAE6hB,EAAEjC,GAA6C,OAA1CA,EAAE,OAAOA,QAAG,IAASA,EAAEA,EAAErZ,OAAO,CAACvG,IAAI,KAAYi1C,GAAG,QAC3f,EAAEK,GAAG34C,KAAK,KAAKklB,EAAE7hB,GAAG4f,EAAE,EAAE42B,gBAAgB,SAASx2C,EAAE6hB,GAAG,OAAOozB,GAAG,QAAQ,EAAEj1C,EAAE6hB,EAAE,EAAE00B,mBAAmB,SAASv2C,EAAE6hB,GAAG,OAAOozB,GAAG,EAAE,EAAEj1C,EAAE6hB,EAAE,EAAE40B,QAAQ,SAASz2C,EAAE6hB,GAAG,IAAIjC,EAAEwzB,KAAqD,OAAhDvxB,OAAE,IAASA,EAAE,KAAKA,EAAE7hB,EAAEA,IAAI4f,EAAEiQ,cAAc,CAAC7vB,EAAE6hB,GAAU7hB,CAAC,EAAE02C,WAAW,SAAS12C,EAAE6hB,EAAEjC,GAAG,IAAI6C,EAAE2wB,KAAkM,OAA7LvxB,OAAE,IAASjC,EAAEA,EAAEiC,GAAGA,EAAEY,EAAEoN,cAAcpN,EAAE2qB,UAAUvrB,EAAE7hB,EAAE,CAACutC,QAAQ,KAAKR,YAAY,KAAKR,MAAM,EAAEwH,SAAS,KAAKL,oBAAoB1zC,EAAE8zC,kBAAkBjyB,GAAGY,EAAE6wB,MAAMtzC,EAAEA,EAAEA,EAAE+zC,SAAS+B,GAAGn5C,KAAK,KAAK41C,GAAEvyC,GAAS,CAACyiB,EAAEoN,cAAc7vB,EAAE,EAAE22C,OAAO,SAAS32C,GAC3d,OAAdA,EAAE,CAACoG,QAAQpG,GAAhBozC,KAA4BvjB,cAAc7vB,CAAC,EAAE42C,SAAShC,GAAGiC,cAAcrB,GAAGsB,iBAAiB,SAAS92C,GAAG,OAAOozC,KAAKvjB,cAAc7vB,CAAC,EAAE+2C,cAAc,WAAW,IAAI/2C,EAAE40C,IAAG,GAAI/yB,EAAE7hB,EAAE,GAA6C,OAA1CA,EAAE41C,GAAGj5C,KAAK,KAAKqD,EAAE,IAAIozC,KAAKvjB,cAAc7vB,EAAQ,CAAC6hB,EAAE7hB,EAAE,EAAEg3C,iBAAiB,WAAW,EAAEC,qBAAqB,SAASj3C,EAAE6hB,EAAEjC,GAAG,IAAI6C,EAAE8vB,GAAExgC,EAAEqhC,KAAK,GAAG/I,GAAE,CAAC,QAAG,IAASzqB,EAAE,MAAMwF,MAAMxD,EAAE,MAAMhC,EAAEA,GAAG,KAAK,CAAO,GAANA,EAAEiC,IAAO,OAAO1a,GAAE,MAAMie,MAAMxD,EAAE,MAAM,KAAQ,GAAH0wB,KAAQiC,GAAG9xB,EAAEZ,EAAEjC,EAAE,CAAC7N,EAAE8d,cAAcjQ,EAAE,IAAIznB,EAAE,CAAC9C,MAAMuqB,EAAEw0B,YAAYvyB,GACvZ,OAD0Z9P,EAAEuhC,MAAMn7C,EAAEg9C,GAAGhB,GAAGx3C,KAAK,KAAK8lB,EACpftqB,EAAE6H,GAAG,CAACA,IAAIyiB,EAAE1mB,OAAO,KAAKs4C,GAAG,EAAEC,GAAG33C,KAAK,KAAK8lB,EAAEtqB,EAAEynB,EAAEiC,QAAG,EAAO,MAAajC,CAAC,EAAEs3B,MAAM,WAAW,IAAIl3C,EAAEozC,KAAKvxB,EAAE1a,GAAEiwC,iBAAiB,GAAG/M,GAAE,CAAC,IAAIzqB,EAAEkqB,GAAkDjoB,EAAE,IAAIA,EAAE,KAA9CjC,GAAHiqB,KAAU,GAAG,GAAGhY,GAAhBgY,IAAsB,IAAI/1C,SAAS,IAAI8rB,GAAuB,GAAPA,EAAE8yB,QAAW7wB,GAAG,IAAIjC,EAAE9rB,SAAS,KAAK+tB,GAAG,GAAG,MAAaA,EAAE,IAAIA,EAAE,KAAfjC,EAAE+yB,MAAmB7+C,SAAS,IAAI,IAAI,OAAOkM,EAAE6vB,cAAchO,CAAC,EAAEs1B,0BAAyB,GAAInE,GAAG,CAACkD,YAAYzJ,GAAG0J,YAAYV,GAAGW,WAAW3J,GAAG4J,UAAUnC,GAAGoC,oBAAoBf,GAAGgB,mBAAmBnB,GAAGoB,gBAAgBnB,GAAGoB,QAAQf,GAAGgB,WAAWjD,GAAGkD,OAAO3B,GAAG4B,SAAS,WAAW,OAAOnD,GAAGD,GAAG,EACrhBqD,cAAcrB,GAAGsB,iBAAiB,SAAS92C,GAAc,OAAO21C,GAAZpC,KAAiBl9C,GAAEw5B,cAAc7vB,EAAE,EAAE+2C,cAAc,WAAgD,MAAM,CAArCtD,GAAGD,IAAI,GAAKD,KAAK1jB,cAAyB,EAAEmnB,iBAAiB/C,GAAGgD,qBAAqBh3B,GAAGi3B,MAAMrB,GAAGsB,0BAAyB,GAAIlE,GAAG,CAACiD,YAAYzJ,GAAG0J,YAAYV,GAAGW,WAAW3J,GAAG4J,UAAUnC,GAAGoC,oBAAoBf,GAAGgB,mBAAmBnB,GAAGoB,gBAAgBnB,GAAGoB,QAAQf,GAAGgB,WAAW1C,GAAG2C,OAAO3B,GAAG4B,SAAS,WAAW,OAAO5C,GAAGR,GAAG,EAAEqD,cAAcrB,GAAGsB,iBAAiB,SAAS92C,GAAG,IAAI6hB,EAAE0xB,KAAK,OAAO,OACzfl9C,GAAEwrB,EAAEgO,cAAc7vB,EAAE21C,GAAG9zB,EAAExrB,GAAEw5B,cAAc7vB,EAAE,EAAE+2C,cAAc,WAAgD,MAAM,CAArC/C,GAAGR,IAAI,GAAKD,KAAK1jB,cAAyB,EAAEmnB,iBAAiB/C,GAAGgD,qBAAqBh3B,GAAGi3B,MAAMrB,GAAGsB,0BAAyB,GAAI,SAASE,GAAGr3C,EAAE6hB,GAAG,IAAI,IAAIjC,EAAE,GAAG6C,EAAEZ,EAAE,GAAGjC,GAAGgG,EAAGnD,GAAGA,EAAEA,EAAEkN,aAAalN,GAAG,IAAI1Q,EAAE6N,CAAC,CAAC,MAAMznB,GAAG4Z,EAAE,6BAA6B5Z,EAAEuf,QAAQ,KAAKvf,EAAEye,KAAK,CAAC,MAAM,CAACvhB,MAAM2K,EAAEhI,OAAO6pB,EAAEjL,MAAM7E,EAAEulC,OAAO,KAAK,CAAC,SAASC,GAAGv3C,EAAE6hB,EAAEjC,GAAG,MAAM,CAACvqB,MAAM2K,EAAEhI,OAAO,KAAK4e,MAAM,MAAMgJ,EAAEA,EAAE,KAAK03B,OAAO,MAAMz1B,EAAEA,EAAE,KAAK,CACzd,SAAS21B,GAAGx3C,EAAE6hB,GAAG,IAAI41B,QAAQhgD,MAAMoqB,EAAExsB,MAAM,CAAC,MAAMuqB,GAAGlD,YAAW,WAAW,MAAMkD,CAAE,GAAE,CAAC,CAAC,IAAI83B,GAAG,oBAAoB72C,QAAQA,QAAQgT,IAAI,SAAS8jC,GAAG33C,EAAE6hB,EAAEjC,IAAGA,EAAErgB,IAAI,EAAEqgB,IAAKroB,IAAI,EAAEqoB,EAAEguB,QAAQ,CAACzwC,QAAQ,MAAM,IAAIslB,EAAEZ,EAAExsB,MAAsD,OAAhDuqB,EAAEiuB,SAAS,WAAW+J,KAAKA,IAAG,EAAGC,GAAGp1B,GAAG+0B,GAAGx3C,EAAE6hB,EAAE,EAASjC,CAAC,CAC3Q,SAASk4B,GAAG93C,EAAE6hB,EAAEjC,IAAGA,EAAErgB,IAAI,EAAEqgB,IAAKroB,IAAI,EAAE,IAAIkrB,EAAEziB,EAAEqB,KAAK02C,yBAAyB,GAAG,oBAAoBt1B,EAAE,CAAC,IAAI1Q,EAAE8P,EAAExsB,MAAMuqB,EAAEguB,QAAQ,WAAW,OAAOnrB,EAAE1Q,EAAE,EAAE6N,EAAEiuB,SAAS,WAAW2J,GAAGx3C,EAAE6hB,EAAE,CAAC,CAAC,IAAI1pB,EAAE6H,EAAEouB,UAA8O,OAApO,OAAOj2B,GAAG,oBAAoBA,EAAE6/C,oBAAoBp4B,EAAEiuB,SAAS,WAAW2J,GAAGx3C,EAAE6hB,GAAG,oBAAoBY,IAAI,OAAOw1B,GAAGA,GAAG,IAAIlkC,IAAI,CAACjU,OAAOm4C,GAAG/iC,IAAIpV,OAAO,IAAI8f,EAAEiC,EAAEjL,MAAM9W,KAAKk4C,kBAAkBn2B,EAAExsB,MAAM,CAAC6iD,eAAe,OAAOt4B,EAAEA,EAAE,IAAI,GAAUA,CAAC,CACnb,SAASu4B,GAAGn4C,EAAE6hB,EAAEjC,GAAG,IAAI6C,EAAEziB,EAAEo4C,UAAU,GAAG,OAAO31B,EAAE,CAACA,EAAEziB,EAAEo4C,UAAU,IAAIV,GAAG,IAAI3lC,EAAE,IAAIgC,IAAI0O,EAAEniB,IAAIuhB,EAAE9P,EAAE,WAAiB,KAAXA,EAAE0Q,EAAEppB,IAAIwoB,MAAgB9P,EAAE,IAAIgC,IAAI0O,EAAEniB,IAAIuhB,EAAE9P,IAAIA,EAAExR,IAAIqf,KAAK7N,EAAEmD,IAAI0K,GAAG5f,EAAEq4C,GAAG17C,KAAK,KAAKqD,EAAE6hB,EAAEjC,GAAGiC,EAAEklB,KAAK/mC,EAAEA,GAAG,CAAC,SAASs4C,GAAGt4C,GAAG,EAAE,CAAC,IAAI6hB,EAA4E,IAAvEA,EAAE,KAAK7hB,EAAEzI,OAAsBsqB,EAAE,QAApBA,EAAE7hB,EAAE6vB,gBAAyB,OAAOhO,EAAEiO,YAAuBjO,EAAE,OAAO7hB,EAAEA,EAAEA,EAAE2vB,MAAM,OAAO,OAAO3vB,GAAG,OAAO,IAAI,CAChW,SAASu4C,GAAGv4C,EAAE6hB,EAAEjC,EAAE6C,EAAE1Q,GAAG,OAAG,KAAY,EAAP/R,EAAEmJ,OAAenJ,IAAI6hB,EAAE7hB,EAAEjE,OAAO,OAAOiE,EAAEjE,OAAO,IAAI6jB,EAAE7jB,OAAO,OAAO6jB,EAAE7jB,QAAQ,MAAM,IAAI6jB,EAAEroB,MAAM,OAAOqoB,EAAE8P,UAAU9P,EAAEroB,IAAI,KAAIsqB,EAAEtiB,IAAI,EAAE,IAAKhI,IAAI,EAAEu2C,GAAGluB,EAAEiC,EAAE,KAAKjC,EAAE2sB,OAAO,GAAGvsC,IAAEA,EAAEjE,OAAO,MAAMiE,EAAEusC,MAAMx6B,EAAS/R,EAAC,CAAC,IAAIw4C,GAAGz0B,EAAG00B,kBAAkBjM,IAAG,EAAG,SAASkM,GAAG14C,EAAE6hB,EAAEjC,EAAE6C,GAAGZ,EAAEoO,MAAM,OAAOjwB,EAAEkxC,GAAGrvB,EAAE,KAAKjC,EAAE6C,GAAGwuB,GAAGpvB,EAAE7hB,EAAEiwB,MAAMrQ,EAAE6C,EAAE,CACnV,SAASk2B,GAAG34C,EAAE6hB,EAAEjC,EAAE6C,EAAE1Q,GAAG6N,EAAEA,EAAEiG,OAAO,IAAI1tB,EAAE0pB,EAAEwuB,IAAqC,OAAjCjE,GAAGvqB,EAAE9P,GAAG0Q,EAAEqwB,GAAG9yC,EAAE6hB,EAAEjC,EAAE6C,EAAEtqB,EAAE4Z,GAAG6N,EAAEuzB,KAAQ,OAAOnzC,GAAIwsC,IAA2EnC,IAAGzqB,GAAGqqB,GAAGpoB,GAAGA,EAAE9lB,OAAO,EAAE28C,GAAG14C,EAAE6hB,EAAEY,EAAE1Q,GAAU8P,EAAEoO,QAA7GpO,EAAEsrB,YAAYntC,EAAEmtC,YAAYtrB,EAAE9lB,QAAQ,KAAKiE,EAAEusC,QAAQx6B,EAAE6mC,GAAG54C,EAAE6hB,EAAE9P,GAAoD,CACzN,SAAS8mC,GAAG74C,EAAE6hB,EAAEjC,EAAE6C,EAAE1Q,GAAG,GAAG,OAAO/R,EAAE,CAAC,IAAI7H,EAAEynB,EAAEve,KAAK,MAAG,oBAAoBlJ,GAAI2gD,GAAG3gD,SAAI,IAASA,EAAEuzC,cAAc,OAAO9rB,EAAEm5B,cAAS,IAASn5B,EAAE8rB,eAAoD1rC,EAAE6wC,GAAGjxB,EAAEve,KAAK,KAAKohB,EAAEZ,EAAEA,EAAE1Y,KAAK4I,IAAKs+B,IAAIxuB,EAAEwuB,IAAIrwC,EAAE2vB,OAAO9N,EAASA,EAAEoO,MAAMjwB,IAArG6hB,EAAEtqB,IAAI,GAAGsqB,EAAExgB,KAAKlJ,EAAE6gD,GAAGh5C,EAAE6hB,EAAE1pB,EAAEsqB,EAAE1Q,GAAyE,CAAW,GAAV5Z,EAAE6H,EAAEiwB,MAAS,KAAKjwB,EAAEusC,MAAMx6B,GAAG,CAAC,IAAI2Q,EAAEvqB,EAAEizC,cAA0C,IAAhBxrB,EAAE,QAAdA,EAAEA,EAAEm5B,SAAmBn5B,EAAE2gB,IAAQ7d,EAAED,IAAIziB,EAAEqwC,MAAMxuB,EAAEwuB,IAAI,OAAOuI,GAAG54C,EAAE6hB,EAAE9P,EAAE,CAA6C,OAA5C8P,EAAE9lB,OAAO,GAAEiE,EAAE2wC,GAAGx4C,EAAEsqB,IAAK4tB,IAAIxuB,EAAEwuB,IAAIrwC,EAAE2vB,OAAO9N,EAASA,EAAEoO,MAAMjwB,CAAC,CAC1b,SAASg5C,GAAGh5C,EAAE6hB,EAAEjC,EAAE6C,EAAE1Q,GAAG,GAAG,OAAO/R,EAAE,CAAC,IAAI7H,EAAE6H,EAAEorC,cAAc,GAAG7K,GAAGpoC,EAAEsqB,IAAIziB,EAAEqwC,MAAMxuB,EAAEwuB,IAAI,IAAG7D,IAAG,EAAG3qB,EAAE+oB,aAAanoB,EAAEtqB,EAAE,KAAK6H,EAAEusC,MAAMx6B,GAAsC,OAAO8P,EAAE0qB,MAAMvsC,EAAEusC,MAAMqM,GAAG54C,EAAE6hB,EAAE9P,GAAjE,KAAa,OAAR/R,EAAEjE,SAAgBywC,IAAG,EAAyC,EAAC,OAAOyM,GAAGj5C,EAAE6hB,EAAEjC,EAAE6C,EAAE1Q,EAAE,CACxN,SAASmnC,GAAGl5C,EAAE6hB,EAAEjC,GAAG,IAAI6C,EAAEZ,EAAE+oB,aAAa74B,EAAE0Q,EAAE4F,SAASlwB,EAAE,OAAO6H,EAAEA,EAAE6vB,cAAc,KAAK,GAAG,WAAWpN,EAAEtZ,KAAK,GAAG,KAAY,EAAP0Y,EAAE1Y,MAAQ0Y,EAAEgO,cAAc,CAACspB,UAAU,EAAEC,UAAU,KAAKC,YAAY,MAAMtR,GAAEuR,GAAGC,IAAIA,IAAI35B,MAAM,CAAC,GAAG,KAAO,WAAFA,GAAc,OAAO5f,EAAE,OAAO7H,EAAEA,EAAEghD,UAAUv5B,EAAEA,EAAEiC,EAAE0qB,MAAM1qB,EAAEsqB,WAAW,WAAWtqB,EAAEgO,cAAc,CAACspB,UAAUn5C,EAAEo5C,UAAU,KAAKC,YAAY,MAAMx3B,EAAEsrB,YAAY,KAAKpF,GAAEuR,GAAGC,IAAIA,IAAIv5C,EAAE,KAAK6hB,EAAEgO,cAAc,CAACspB,UAAU,EAAEC,UAAU,KAAKC,YAAY,MAAM52B,EAAE,OAAOtqB,EAAEA,EAAEghD,UAAUv5B,EAAEmoB,GAAEuR,GAAGC,IAAIA,IAAI92B,CAAC,MAAM,OACtftqB,GAAGsqB,EAAEtqB,EAAEghD,UAAUv5B,EAAEiC,EAAEgO,cAAc,MAAMpN,EAAE7C,EAAEmoB,GAAEuR,GAAGC,IAAIA,IAAI92B,EAAc,OAAZi2B,GAAG14C,EAAE6hB,EAAE9P,EAAE6N,GAAUiC,EAAEoO,KAAK,CAAC,SAASupB,GAAGx5C,EAAE6hB,GAAG,IAAIjC,EAAEiC,EAAEwuB,KAAO,OAAOrwC,GAAG,OAAO4f,GAAG,OAAO5f,GAAGA,EAAEqwC,MAAMzwB,KAAEiC,EAAE9lB,OAAO,IAAI8lB,EAAE9lB,OAAO,QAAO,CAAC,SAASk9C,GAAGj5C,EAAE6hB,EAAEjC,EAAE6C,EAAE1Q,GAAG,IAAI5Z,EAAEqwC,GAAG5oB,GAAGuoB,GAAGF,GAAE7hC,QAAmD,OAA3CjO,EAAEiwC,GAAGvmB,EAAE1pB,GAAGi0C,GAAGvqB,EAAE9P,GAAG6N,EAAEkzB,GAAG9yC,EAAE6hB,EAAEjC,EAAE6C,EAAEtqB,EAAE4Z,GAAG0Q,EAAE0wB,KAAQ,OAAOnzC,GAAIwsC,IAA2EnC,IAAG5nB,GAAGwnB,GAAGpoB,GAAGA,EAAE9lB,OAAO,EAAE28C,GAAG14C,EAAE6hB,EAAEjC,EAAE7N,GAAU8P,EAAEoO,QAA7GpO,EAAEsrB,YAAYntC,EAAEmtC,YAAYtrB,EAAE9lB,QAAQ,KAAKiE,EAAEusC,QAAQx6B,EAAE6mC,GAAG54C,EAAE6hB,EAAE9P,GAAoD,CACla,SAAS0nC,GAAGz5C,EAAE6hB,EAAEjC,EAAE6C,EAAE1Q,GAAG,GAAGy2B,GAAG5oB,GAAG,CAAC,IAAIznB,GAAE,EAAG2wC,GAAGjnB,EAAE,MAAM1pB,GAAE,EAAW,GAARi0C,GAAGvqB,EAAE9P,GAAM,OAAO8P,EAAEuM,UAAUsrB,GAAG15C,EAAE6hB,GAAG2tB,GAAG3tB,EAAEjC,EAAE6C,GAAGqtB,GAAGjuB,EAAEjC,EAAE6C,EAAE1Q,GAAG0Q,GAAE,OAAQ,GAAG,OAAOziB,EAAE,CAAC,IAAI0iB,EAAEb,EAAEuM,UAAU3I,EAAE5D,EAAEupB,cAAc1oB,EAAE9c,MAAM6f,EAAE,IAAIC,EAAEhD,EAAElV,QAAQgB,EAAEoR,EAAE6vB,YAAY,kBAAkBjhC,GAAG,OAAOA,EAAEA,EAAEi+B,GAAGj+B,GAAyBA,EAAE45B,GAAGvmB,EAA1BrT,EAAEg6B,GAAG5oB,GAAGuoB,GAAGF,GAAE7hC,SAAmB,IAAI/G,EAAEugB,EAAEmwB,yBAAyB5B,EAAE,oBAAoB9uC,GAAG,oBAAoBqjB,EAAEstB,wBAAwB7B,GAAG,oBAAoBzrB,EAAEmtB,kCAAkC,oBAAoBntB,EAAEktB,4BAC1dnqB,IAAIhD,GAAGiD,IAAIlX,IAAImhC,GAAG9tB,EAAEa,EAAED,EAAEjU,GAAGy+B,IAAG,EAAG,IAAImB,EAAEvsB,EAAEgO,cAAcnN,EAAE5hB,MAAMstC,EAAEF,GAAGrsB,EAAEY,EAAEC,EAAE3Q,GAAG2T,EAAE7D,EAAEgO,cAAcpK,IAAIhD,GAAG2rB,IAAI1oB,GAAGwiB,GAAG9hC,SAAS6mC,IAAI,oBAAoB5tC,IAAIsvC,GAAG9sB,EAAEjC,EAAEvgB,EAAEojB,GAAGiD,EAAE7D,EAAEgO,gBAAgBpK,EAAEwnB,IAAIoC,GAAGxtB,EAAEjC,EAAE6F,EAAEhD,EAAE2rB,EAAE1oB,EAAElX,KAAK2/B,GAAG,oBAAoBzrB,EAAEutB,2BAA2B,oBAAoBvtB,EAAEwtB,qBAAqB,oBAAoBxtB,EAAEwtB,oBAAoBxtB,EAAEwtB,qBAAqB,oBAAoBxtB,EAAEutB,2BAA2BvtB,EAAEutB,6BAA6B,oBAAoBvtB,EAAEytB,oBAAoBtuB,EAAE9lB,OAAO,WAClf,oBAAoB2mB,EAAEytB,oBAAoBtuB,EAAE9lB,OAAO,SAAS8lB,EAAEupB,cAAc3oB,EAAEZ,EAAEgO,cAAcnK,GAAGhD,EAAE9c,MAAM6c,EAAEC,EAAE5hB,MAAM4kB,EAAEhD,EAAElV,QAAQgB,EAAEiU,EAAEgD,IAAI,oBAAoB/C,EAAEytB,oBAAoBtuB,EAAE9lB,OAAO,SAAS0mB,GAAE,EAAG,KAAK,CAACC,EAAEb,EAAEuM,UAAUqf,GAAGztC,EAAE6hB,GAAG4D,EAAE5D,EAAEupB,cAAc58B,EAAEqT,EAAExgB,OAAOwgB,EAAE4oB,YAAYhlB,EAAEgmB,GAAG5pB,EAAExgB,KAAKokB,GAAG/C,EAAE9c,MAAM4I,EAAE2/B,EAAEtsB,EAAE+oB,aAAawD,EAAE1rB,EAAElV,QAAwB,kBAAhBkY,EAAE9F,EAAE6vB,cAAiC,OAAO/pB,EAAEA,EAAE+mB,GAAG/mB,GAAyBA,EAAE0iB,GAAGvmB,EAA1B6D,EAAE8iB,GAAG5oB,GAAGuoB,GAAGF,GAAE7hC,SAAmB,IAAIioC,EAAEzuB,EAAEmwB,0BAA0B1wC,EAAE,oBAAoBgvC,GAAG,oBAAoB3rB,EAAEstB,0BAC9e,oBAAoBttB,EAAEmtB,kCAAkC,oBAAoBntB,EAAEktB,4BAA4BnqB,IAAI0oB,GAAGC,IAAI1oB,IAAIiqB,GAAG9tB,EAAEa,EAAED,EAAEiD,GAAGunB,IAAG,EAAGmB,EAAEvsB,EAAEgO,cAAcnN,EAAE5hB,MAAMstC,EAAEF,GAAGrsB,EAAEY,EAAEC,EAAE3Q,GAAG,IAAItS,EAAEoiB,EAAEgO,cAAcpK,IAAI0oB,GAAGC,IAAI3uC,GAAGyoC,GAAG9hC,SAAS6mC,IAAI,oBAAoBoB,IAAIM,GAAG9sB,EAAEjC,EAAEyuB,EAAE5rB,GAAGhjB,EAAEoiB,EAAEgO,gBAAgBrhB,EAAEy+B,IAAIoC,GAAGxtB,EAAEjC,EAAEpR,EAAEiU,EAAE2rB,EAAE3uC,EAAEimB,KAAI,IAAKrmB,GAAG,oBAAoBqjB,EAAEi3B,4BAA4B,oBAAoBj3B,EAAEk3B,sBAAsB,oBAAoBl3B,EAAEk3B,qBAAqBl3B,EAAEk3B,oBAAoBn3B,EAAEhjB,EAAEimB,GAAG,oBAAoBhD,EAAEi3B,4BAC5fj3B,EAAEi3B,2BAA2Bl3B,EAAEhjB,EAAEimB,IAAI,oBAAoBhD,EAAEm3B,qBAAqBh4B,EAAE9lB,OAAO,GAAG,oBAAoB2mB,EAAEstB,0BAA0BnuB,EAAE9lB,OAAO,QAAQ,oBAAoB2mB,EAAEm3B,oBAAoBp0B,IAAIzlB,EAAEorC,eAAegD,IAAIpuC,EAAE6vB,gBAAgBhO,EAAE9lB,OAAO,GAAG,oBAAoB2mB,EAAEstB,yBAAyBvqB,IAAIzlB,EAAEorC,eAAegD,IAAIpuC,EAAE6vB,gBAAgBhO,EAAE9lB,OAAO,MAAM8lB,EAAEupB,cAAc3oB,EAAEZ,EAAEgO,cAAcpwB,GAAGijB,EAAE9c,MAAM6c,EAAEC,EAAE5hB,MAAMrB,EAAEijB,EAAElV,QAAQkY,EAAEjD,EAAEjU,IAAI,oBAAoBkU,EAAEm3B,oBAAoBp0B,IAAIzlB,EAAEorC,eAAegD,IACjfpuC,EAAE6vB,gBAAgBhO,EAAE9lB,OAAO,GAAG,oBAAoB2mB,EAAEstB,yBAAyBvqB,IAAIzlB,EAAEorC,eAAegD,IAAIpuC,EAAE6vB,gBAAgBhO,EAAE9lB,OAAO,MAAM0mB,GAAE,EAAG,CAAC,OAAOq3B,GAAG95C,EAAE6hB,EAAEjC,EAAE6C,EAAEtqB,EAAE4Z,EAAE,CACnK,SAAS+nC,GAAG95C,EAAE6hB,EAAEjC,EAAE6C,EAAE1Q,EAAE5Z,GAAGqhD,GAAGx5C,EAAE6hB,GAAG,IAAIa,EAAE,KAAa,IAARb,EAAE9lB,OAAW,IAAI0mB,IAAIC,EAAE,OAAO3Q,GAAGi3B,GAAGnnB,EAAEjC,GAAE,GAAIg5B,GAAG54C,EAAE6hB,EAAE1pB,GAAGsqB,EAAEZ,EAAEuM,UAAUoqB,GAAGpyC,QAAQyb,EAAE,IAAI4D,EAAE/C,GAAG,oBAAoB9C,EAAEm4B,yBAAyB,KAAKt1B,EAAEoD,SAAwI,OAA/HhE,EAAE9lB,OAAO,EAAE,OAAOiE,GAAG0iB,GAAGb,EAAEoO,MAAMghB,GAAGpvB,EAAE7hB,EAAEiwB,MAAM,KAAK93B,GAAG0pB,EAAEoO,MAAMghB,GAAGpvB,EAAE,KAAK4D,EAAEttB,IAAIugD,GAAG14C,EAAE6hB,EAAE4D,EAAEttB,GAAG0pB,EAAEgO,cAAcpN,EAAE3hB,MAAMiR,GAAGi3B,GAAGnnB,EAAEjC,GAAE,GAAWiC,EAAEoO,KAAK,CAAC,SAAS8pB,GAAG/5C,GAAG,IAAI6hB,EAAE7hB,EAAEouB,UAAUvM,EAAEm4B,eAAerR,GAAG3oC,EAAE6hB,EAAEm4B,eAAen4B,EAAEm4B,iBAAiBn4B,EAAErU,SAASqU,EAAErU,SAASm7B,GAAG3oC,EAAE6hB,EAAErU,SAAQ,GAAIgkC,GAAGxxC,EAAE6hB,EAAEkT,cAAc,CAC5e,SAASklB,GAAGj6C,EAAE6hB,EAAEjC,EAAE6C,EAAE1Q,GAAuC,OAApCu5B,KAAKC,GAAGx5B,GAAG8P,EAAE9lB,OAAO,IAAI28C,GAAG14C,EAAE6hB,EAAEjC,EAAE6C,GAAUZ,EAAEoO,KAAK,CAAC,IAaqLiqB,GAAGC,GAAGC,GAAGC,GAb1LC,GAAG,CAACxqB,WAAW,KAAKgb,YAAY,KAAKC,UAAU,GAAG,SAASwP,GAAGv6C,GAAG,MAAM,CAACm5C,UAAUn5C,EAAEo5C,UAAU,KAAKC,YAAY,KAAK,CAClM,SAASmB,GAAGx6C,EAAE6hB,EAAEjC,GAAG,IAA0D6F,EAAtDhD,EAAEZ,EAAE+oB,aAAa74B,EAAE8/B,GAAEzrC,QAAQjO,GAAE,EAAGuqB,EAAE,KAAa,IAARb,EAAE9lB,OAAqJ,IAAvI0pB,EAAE/C,KAAK+C,GAAE,OAAOzlB,GAAG,OAAOA,EAAE6vB,gBAAiB,KAAO,EAAF9d,IAAS0T,GAAEttB,GAAE,EAAG0pB,EAAE9lB,QAAQ,KAAY,OAAOiE,GAAG,OAAOA,EAAE6vB,gBAAc9d,GAAG,GAAEg2B,GAAE8J,GAAI,EAAF9/B,GAAQ,OAAO/R,EAA2B,OAAxBirC,GAAGppB,GAAwB,QAArB7hB,EAAE6hB,EAAEgO,gBAA2C,QAAf7vB,EAAEA,EAAE8vB,aAA4B,KAAY,EAAPjO,EAAE1Y,MAAQ0Y,EAAE0qB,MAAM,EAAE,OAAOvsC,EAAEiC,KAAK4f,EAAE0qB,MAAM,EAAE1qB,EAAE0qB,MAAM,WAAW,OAAK7pB,EAAED,EAAE4F,SAASroB,EAAEyiB,EAAEg4B,SAAgBtiD,GAAGsqB,EAAEZ,EAAE1Y,KAAKhR,EAAE0pB,EAAEoO,MAAMvN,EAAE,CAACvZ,KAAK,SAASkf,SAAS3F,GAAG,KAAO,EAAFD,IAAM,OAAOtqB,GAAGA,EAAEg0C,WAAW,EAAEh0C,EAAEyyC,aAC7eloB,GAAGvqB,EAAEuiD,GAAGh4B,EAAED,EAAE,EAAE,MAAMziB,EAAEgxC,GAAGhxC,EAAEyiB,EAAE7C,EAAE,MAAMznB,EAAEw3B,OAAO9N,EAAE7hB,EAAE2vB,OAAO9N,EAAE1pB,EAAE+3B,QAAQlwB,EAAE6hB,EAAEoO,MAAM93B,EAAE0pB,EAAEoO,MAAMJ,cAAc0qB,GAAG36B,GAAGiC,EAAEgO,cAAcyqB,GAAGt6C,GAAG26C,GAAG94B,EAAEa,IAAqB,GAAG,QAArB3Q,EAAE/R,EAAE6vB,gBAA2C,QAAfpK,EAAE1T,EAAE+d,YAAqB,OAGpM,SAAY9vB,EAAE6hB,EAAEjC,EAAE6C,EAAE1Q,EAAE5Z,EAAEuqB,GAAG,GAAG9C,EAAG,OAAW,IAARiC,EAAE9lB,OAAiB8lB,EAAE9lB,QAAQ,IAAwB6+C,GAAG56C,EAAE6hB,EAAEa,EAA3BD,EAAE80B,GAAGnyB,MAAMxD,EAAE,SAAsB,OAAOC,EAAEgO,eAAqBhO,EAAEoO,MAAMjwB,EAAEiwB,MAAMpO,EAAE9lB,OAAO,IAAI,OAAK5D,EAAEsqB,EAAEg4B,SAAS1oC,EAAE8P,EAAE1Y,KAAKsZ,EAAEi4B,GAAG,CAACvxC,KAAK,UAAUkf,SAAS5F,EAAE4F,UAAUtW,EAAE,EAAE,OAAM5Z,EAAE64C,GAAG74C,EAAE4Z,EAAE2Q,EAAE,OAAQ3mB,OAAO,EAAE0mB,EAAEkN,OAAO9N,EAAE1pB,EAAEw3B,OAAO9N,EAAEY,EAAEyN,QAAQ/3B,EAAE0pB,EAAEoO,MAAMxN,EAAE,KAAY,EAAPZ,EAAE1Y,OAAS8nC,GAAGpvB,EAAE7hB,EAAEiwB,MAAM,KAAKvN,GAAGb,EAAEoO,MAAMJ,cAAc0qB,GAAG73B,GAAGb,EAAEgO,cAAcyqB,GAAUniD,GAAE,GAAG,KAAY,EAAP0pB,EAAE1Y,MAAQ,OAAOyxC,GAAG56C,EAAE6hB,EAAEa,EAAE,MAAM,GAAG,OAAO3Q,EAAE9P,KAAK,CAChd,GADidwgB,EAAE1Q,EAAE4uB,aAAa5uB,EAAE4uB,YAAYka,QAC3e,IAAIp1B,EAAEhD,EAAEq4B,KAA0C,OAArCr4B,EAAEgD,EAA0Cm1B,GAAG56C,EAAE6hB,EAAEa,EAA/BD,EAAE80B,GAAlBp/C,EAAEitB,MAAMxD,EAAE,MAAaa,OAAE,GAA0B,CAAwB,GAAvBgD,EAAE,KAAK/C,EAAE1iB,EAAEmsC,YAAeK,IAAI/mB,EAAE,CAAK,GAAG,QAAPhD,EAAEtb,IAAc,CAAC,OAAOub,GAAGA,GAAG,KAAK,EAAE3Q,EAAE,EAAE,MAAM,KAAK,GAAGA,EAAE,EAAE,MAAM,KAAK,GAAG,KAAK,IAAI,KAAK,IAAI,KAAK,IAAI,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,KAAK,MAAM,KAAK,MAAM,KAAK,MAAM,KAAK,OAAO,KAAK,OAAO,KAAK,OAAO,KAAK,QAAQ,KAAK,QAAQ,KAAK,QAAQ,KAAK,QAAQ,KAAK,SAAS,KAAK,SAAS,KAAK,SAASA,EAAE,GAAG,MAAM,KAAK,UAAUA,EAAE,UAAU,MAAM,QAAQA,EAAE,EAChd,KADkdA,EAAE,KAAKA,GAAG0Q,EAAE+P,eAAe9P,IAAI,EAAE3Q,IAC5eA,IAAI5Z,EAAE4yC,YAAY5yC,EAAE4yC,UAAUh5B,EAAEi7B,GAAGhtC,EAAE+R,GAAGm9B,GAAGzsB,EAAEziB,EAAE+R,GAAG,GAAG,CAA0B,OAAzBgpC,KAAgCH,GAAG56C,EAAE6hB,EAAEa,EAAlCD,EAAE80B,GAAGnyB,MAAMxD,EAAE,OAAyB,CAAC,MAAG,OAAO7P,EAAE9P,MAAY4f,EAAE9lB,OAAO,IAAI8lB,EAAEoO,MAAMjwB,EAAEiwB,MAAMpO,EAAEm5B,GAAGr+C,KAAK,KAAKqD,GAAG+R,EAAEkpC,YAAYp5B,EAAE,OAAK7hB,EAAE7H,EAAE2yC,YAAYV,GAAGjD,GAAGp1B,EAAE4uB,aAAawJ,GAAGtoB,EAAEwoB,IAAE,EAAGC,GAAG,KAAK,OAAOtqC,IAAI0pC,GAAGC,MAAME,GAAGH,GAAGC,MAAMG,GAAGJ,GAAGC,MAAMC,GAAGC,GAAG7pC,EAAE6K,GAAGi/B,GAAG9pC,EAAE6qC,SAASjB,GAAG/nB,GAAGA,EAAE84B,GAAG94B,EAAEY,EAAE4F,UAAUxG,EAAE9lB,OAAO,KAAY8lB,EAAC,CALrKq5B,CAAGl7C,EAAE6hB,EAAEa,EAAED,EAAEgD,EAAE1T,EAAE6N,GAAG,GAAGznB,EAAE,CAACA,EAAEsqB,EAAEg4B,SAAS/3B,EAAEb,EAAE1Y,KAAesc,GAAV1T,EAAE/R,EAAEiwB,OAAUC,QAAQ,IAAIxK,EAAE,CAACvc,KAAK,SAASkf,SAAS5F,EAAE4F,UAChF,OAD0F,KAAO,EAAF3F,IAAMb,EAAEoO,QAAQle,IAAG0Q,EAAEZ,EAAEoO,OAAQkc,WAAW,EAAE1pB,EAAEmoB,aAAallB,EAAE7D,EAAE6oB,UAAU,OAAOjoB,EAAEkuB,GAAG5+B,EAAE2T,IAAKy1B,aAA4B,SAAfppC,EAAEopC,aAAuB,OAAO11B,EAAEttB,EAAEw4C,GAAGlrB,EAAEttB,IAAIA,EAAE64C,GAAG74C,EAAEuqB,EAAE9C,EAAE,OAAQ7jB,OAAO,EAAG5D,EAAEw3B,OACnf9N,EAAEY,EAAEkN,OAAO9N,EAAEY,EAAEyN,QAAQ/3B,EAAE0pB,EAAEoO,MAAMxN,EAAEA,EAAEtqB,EAAEA,EAAE0pB,EAAEoO,MAA8BvN,EAAE,QAA1BA,EAAE1iB,EAAEiwB,MAAMJ,eAAyB0qB,GAAG36B,GAAG,CAACu5B,UAAUz2B,EAAEy2B,UAAUv5B,EAAEw5B,UAAU,KAAKC,YAAY32B,EAAE22B,aAAalhD,EAAE03B,cAAcnN,EAAEvqB,EAAEg0C,WAAWnsC,EAAEmsC,YAAYvsB,EAAEiC,EAAEgO,cAAcyqB,GAAU73B,CAAC,CAAoO,OAAzNziB,GAAV7H,EAAE6H,EAAEiwB,OAAUC,QAAQzN,EAAEkuB,GAAGx4C,EAAE,CAACgR,KAAK,UAAUkf,SAAS5F,EAAE4F,WAAW,KAAY,EAAPxG,EAAE1Y,QAAUsZ,EAAE8pB,MAAM3sB,GAAG6C,EAAEkN,OAAO9N,EAAEY,EAAEyN,QAAQ,KAAK,OAAOlwB,IAAkB,QAAd4f,EAAEiC,EAAE6oB,YAAoB7oB,EAAE6oB,UAAU,CAAC1qC,GAAG6hB,EAAE9lB,OAAO,IAAI6jB,EAAEnsB,KAAKuM,IAAI6hB,EAAEoO,MAAMxN,EAAEZ,EAAEgO,cAAc,KAAYpN,CAAC,CACnd,SAASk4B,GAAG36C,EAAE6hB,GAA8D,OAA3DA,EAAE64B,GAAG,CAACvxC,KAAK,UAAUkf,SAASxG,GAAG7hB,EAAEmJ,KAAK,EAAE,OAAQwmB,OAAO3vB,EAASA,EAAEiwB,MAAMpO,CAAC,CAAC,SAAS+4B,GAAG56C,EAAE6hB,EAAEjC,EAAE6C,GAAwG,OAArG,OAAOA,GAAG8oB,GAAG9oB,GAAGwuB,GAAGpvB,EAAE7hB,EAAEiwB,MAAM,KAAKrQ,IAAG5f,EAAE26C,GAAG94B,EAAEA,EAAE+oB,aAAaviB,WAAYtsB,OAAO,EAAE8lB,EAAEgO,cAAc,KAAY7vB,CAAC,CAGkJ,SAASo7C,GAAGp7C,EAAE6hB,EAAEjC,GAAG5f,EAAEusC,OAAO1qB,EAAE,IAAIY,EAAEziB,EAAE0vB,UAAU,OAAOjN,IAAIA,EAAE8pB,OAAO1qB,GAAGqqB,GAAGlsC,EAAE2vB,OAAO9N,EAAEjC,EAAE,CACxc,SAASy7B,GAAGr7C,EAAE6hB,EAAEjC,EAAE6C,EAAE1Q,GAAG,IAAI5Z,EAAE6H,EAAE6vB,cAAc,OAAO13B,EAAE6H,EAAE6vB,cAAc,CAACyrB,YAAYz5B,EAAE05B,UAAU,KAAKC,mBAAmB,EAAEC,KAAKh5B,EAAEi5B,KAAK97B,EAAE+7B,SAAS5pC,IAAI5Z,EAAEmjD,YAAYz5B,EAAE1pB,EAAEojD,UAAU,KAAKpjD,EAAEqjD,mBAAmB,EAAErjD,EAAEsjD,KAAKh5B,EAAEtqB,EAAEujD,KAAK97B,EAAEznB,EAAEwjD,SAAS5pC,EAAE,CAC3O,SAAS6pC,GAAG57C,EAAE6hB,EAAEjC,GAAG,IAAI6C,EAAEZ,EAAE+oB,aAAa74B,EAAE0Q,EAAEsvB,YAAY55C,EAAEsqB,EAAEi5B,KAAsC,GAAjChD,GAAG14C,EAAE6hB,EAAEY,EAAE4F,SAASzI,GAAkB,KAAO,GAAtB6C,EAAEovB,GAAEzrC,UAAqBqc,EAAI,EAAFA,EAAI,EAAEZ,EAAE9lB,OAAO,QAAQ,CAAC,GAAG,OAAOiE,GAAG,KAAa,IAARA,EAAEjE,OAAWiE,EAAE,IAAIA,EAAE6hB,EAAEoO,MAAM,OAAOjwB,GAAG,CAAC,GAAG,KAAKA,EAAEzI,IAAI,OAAOyI,EAAE6vB,eAAeurB,GAAGp7C,EAAE4f,EAAEiC,QAAQ,GAAG,KAAK7hB,EAAEzI,IAAI6jD,GAAGp7C,EAAE4f,EAAEiC,QAAQ,GAAG,OAAO7hB,EAAEiwB,MAAM,CAACjwB,EAAEiwB,MAAMN,OAAO3vB,EAAEA,EAAEA,EAAEiwB,MAAM,QAAQ,CAAC,GAAGjwB,IAAI6hB,EAAE,MAAM7hB,EAAE,KAAK,OAAOA,EAAEkwB,SAAS,CAAC,GAAG,OAAOlwB,EAAE2vB,QAAQ3vB,EAAE2vB,SAAS9N,EAAE,MAAM7hB,EAAEA,EAAEA,EAAE2vB,MAAM,CAAC3vB,EAAEkwB,QAAQP,OAAO3vB,EAAE2vB,OAAO3vB,EAAEA,EAAEkwB,OAAO,CAACzN,GAAG,CAAC,CAAQ,GAAPslB,GAAE8J,GAAEpvB,GAAM,KAAY,EAAPZ,EAAE1Y,MAAQ0Y,EAAEgO,cAC/e,UAAU,OAAO9d,GAAG,IAAK,WAAqB,IAAV6N,EAAEiC,EAAEoO,MAAUle,EAAE,KAAK,OAAO6N,GAAiB,QAAd5f,EAAE4f,EAAE8P,YAAoB,OAAOoiB,GAAG9xC,KAAK+R,EAAE6N,GAAGA,EAAEA,EAAEsQ,QAAY,QAAJtQ,EAAE7N,IAAYA,EAAE8P,EAAEoO,MAAMpO,EAAEoO,MAAM,OAAOle,EAAE6N,EAAEsQ,QAAQtQ,EAAEsQ,QAAQ,MAAMmrB,GAAGx5B,GAAE,EAAG9P,EAAE6N,EAAEznB,GAAG,MAAM,IAAK,YAA6B,IAAjBynB,EAAE,KAAK7N,EAAE8P,EAAEoO,MAAUpO,EAAEoO,MAAM,KAAK,OAAOle,GAAG,CAAe,GAAG,QAAjB/R,EAAE+R,EAAE2d,YAAuB,OAAOoiB,GAAG9xC,GAAG,CAAC6hB,EAAEoO,MAAMle,EAAE,KAAK,CAAC/R,EAAE+R,EAAEme,QAAQne,EAAEme,QAAQtQ,EAAEA,EAAE7N,EAAEA,EAAE/R,CAAC,CAACq7C,GAAGx5B,GAAE,EAAGjC,EAAE,KAAKznB,GAAG,MAAM,IAAK,WAAWkjD,GAAGx5B,GAAE,EAAG,KAAK,UAAK,GAAQ,MAAM,QAAQA,EAAEgO,cAAc,KAAK,OAAOhO,EAAEoO,KAAK,CAC7d,SAASypB,GAAG15C,EAAE6hB,GAAG,KAAY,EAAPA,EAAE1Y,OAAS,OAAOnJ,IAAIA,EAAE0vB,UAAU,KAAK7N,EAAE6N,UAAU,KAAK7N,EAAE9lB,OAAO,EAAE,CAAC,SAAS68C,GAAG54C,EAAE6hB,EAAEjC,GAAyD,GAAtD,OAAO5f,IAAI6hB,EAAEwqB,aAAarsC,EAAEqsC,cAAciC,IAAIzsB,EAAE0qB,MAAS,KAAK3sB,EAAEiC,EAAEsqB,YAAY,OAAO,KAAK,GAAG,OAAOnsC,GAAG6hB,EAAEoO,QAAQjwB,EAAEiwB,MAAM,MAAM7K,MAAMxD,EAAE,MAAM,GAAG,OAAOC,EAAEoO,MAAM,CAA4C,IAAjCrQ,EAAE+wB,GAAZ3wC,EAAE6hB,EAAEoO,MAAajwB,EAAE4qC,cAAc/oB,EAAEoO,MAAMrQ,EAAMA,EAAE+P,OAAO9N,EAAE,OAAO7hB,EAAEkwB,SAASlwB,EAAEA,EAAEkwB,SAAQtQ,EAAEA,EAAEsQ,QAAQygB,GAAG3wC,EAAEA,EAAE4qC,eAAgBjb,OAAO9N,EAAEjC,EAAEsQ,QAAQ,IAAI,CAAC,OAAOrO,EAAEoO,KAAK,CAO9a,SAAS4rB,GAAG77C,EAAE6hB,GAAG,IAAIwoB,GAAE,OAAOrqC,EAAE27C,UAAU,IAAK,SAAS95B,EAAE7hB,EAAE07C,KAAK,IAAI,IAAI97B,EAAE,KAAK,OAAOiC,GAAG,OAAOA,EAAE6N,YAAY9P,EAAEiC,GAAGA,EAAEA,EAAEqO,QAAQ,OAAOtQ,EAAE5f,EAAE07C,KAAK,KAAK97B,EAAEsQ,QAAQ,KAAK,MAAM,IAAK,YAAYtQ,EAAE5f,EAAE07C,KAAK,IAAI,IAAIj5B,EAAE,KAAK,OAAO7C,GAAG,OAAOA,EAAE8P,YAAYjN,EAAE7C,GAAGA,EAAEA,EAAEsQ,QAAQ,OAAOzN,EAAEZ,GAAG,OAAO7hB,EAAE07C,KAAK17C,EAAE07C,KAAK,KAAK17C,EAAE07C,KAAKxrB,QAAQ,KAAKzN,EAAEyN,QAAQ,KAAK,CAC5U,SAAS36B,GAAEyK,GAAG,IAAI6hB,EAAE,OAAO7hB,EAAE0vB,WAAW1vB,EAAE0vB,UAAUO,QAAQjwB,EAAEiwB,MAAMrQ,EAAE,EAAE6C,EAAE,EAAE,GAAGZ,EAAE,IAAI,IAAI9P,EAAE/R,EAAEiwB,MAAM,OAAOle,GAAG6N,GAAG7N,EAAEw6B,MAAMx6B,EAAEo6B,WAAW1pB,GAAkB,SAAf1Q,EAAEopC,aAAsB14B,GAAW,SAAR1Q,EAAEhW,MAAegW,EAAE4d,OAAO3vB,EAAE+R,EAAEA,EAAEme,aAAa,IAAIne,EAAE/R,EAAEiwB,MAAM,OAAOle,GAAG6N,GAAG7N,EAAEw6B,MAAMx6B,EAAEo6B,WAAW1pB,GAAG1Q,EAAEopC,aAAa14B,GAAG1Q,EAAEhW,MAAMgW,EAAE4d,OAAO3vB,EAAE+R,EAAEA,EAAEme,QAAyC,OAAjClwB,EAAEm7C,cAAc14B,EAAEziB,EAAEmsC,WAAWvsB,EAASiC,CAAC,CAC7V,SAASi6B,GAAG97C,EAAE6hB,EAAEjC,GAAG,IAAI6C,EAAEZ,EAAE+oB,aAAmB,OAANV,GAAGroB,GAAUA,EAAEtqB,KAAK,KAAK,EAAE,KAAK,GAAG,KAAK,GAAG,KAAK,EAAE,KAAK,GAAG,KAAK,EAAE,KAAK,EAAE,KAAK,GAAG,KAAK,EAAE,KAAK,GAAG,OAAOhC,GAAEssB,GAAG,KAAK,KAAK,EAUtD,KAAK,GAAG,OAAO2mB,GAAG3mB,EAAExgB,OAAOqnC,KAAKnzC,GAAEssB,GAAG,KAVqD,KAAK,EAA2Q,OAAzQY,EAAEZ,EAAEuM,UAAUsjB,KAAK5J,GAAEI,IAAIJ,GAAEG,IAAGgK,KAAKxvB,EAAEu3B,iBAAiBv3B,EAAEjV,QAAQiV,EAAEu3B,eAAev3B,EAAEu3B,eAAe,MAAS,OAAOh6C,GAAG,OAAOA,EAAEiwB,QAAMkb,GAAGtpB,GAAGA,EAAE9lB,OAAO,EAAE,OAAOiE,GAAGA,EAAE6vB,cAAciF,cAAc,KAAa,IAARjT,EAAE9lB,SAAa8lB,EAAE9lB,OAAO,KAAK,OAAOuuC,KAAKyR,GAAGzR,IAAIA,GAAG,QAAO6P,GAAGn6C,EAAE6hB,GAAGtsB,GAAEssB,GAAU,KAAK,KAAK,EAAE+vB,GAAG/vB,GAAG,IAAI9P,EAAEw/B,GAAGD,GAAGlrC,SAC7e,GAATwZ,EAAEiC,EAAExgB,KAAQ,OAAOrB,GAAG,MAAM6hB,EAAEuM,UAAUgsB,GAAGp6C,EAAE6hB,EAAEjC,EAAE6C,EAAE1Q,GAAG/R,EAAEqwC,MAAMxuB,EAAEwuB,MAAMxuB,EAAE9lB,OAAO,IAAI8lB,EAAE9lB,OAAO,aAAa,CAAC,IAAI0mB,EAAE,CAAC,GAAG,OAAOZ,EAAEuM,UAAU,MAAMhJ,MAAMxD,EAAE,MAAW,OAALrsB,GAAEssB,GAAU,IAAI,CAAkB,GAAjB7hB,EAAEuxC,GAAGH,GAAGhrC,SAAY+kC,GAAGtpB,GAAG,CAACY,EAAEZ,EAAEuM,UAAUxO,EAAEiC,EAAExgB,KAAK,IAAIlJ,EAAE0pB,EAAEupB,cAA+C,OAAjC3oB,EAAE8kB,IAAI1lB,EAAEY,EAAE+kB,IAAIrvC,EAAE6H,EAAE,KAAY,EAAP6hB,EAAE1Y,MAAeyW,GAAG,IAAK,SAAS+kB,GAAE,SAASliB,GAAGkiB,GAAE,QAAQliB,GAAG,MAAM,IAAK,SAAS,IAAK,SAAS,IAAK,QAAQkiB,GAAE,OAAOliB,GAAG,MAAM,IAAK,QAAQ,IAAK,QAAQ,IAAI1Q,EAAE,EAAEA,EAAEuyB,GAAGhxC,OAAOye,IAAI4yB,GAAEL,GAAGvyB,GAAG0Q,GAAG,MAAM,IAAK,SAASkiB,GAAE,QAAQliB,GAAG,MAAM,IAAK,MAAM,IAAK,QAAQ,IAAK,OAAOkiB,GAAE,QACnhBliB,GAAGkiB,GAAE,OAAOliB,GAAG,MAAM,IAAK,UAAUkiB,GAAE,SAASliB,GAAG,MAAM,IAAK,QAAQ6E,EAAG7E,EAAEtqB,GAAGwsC,GAAE,UAAUliB,GAAG,MAAM,IAAK,SAASA,EAAE2E,cAAc,CAAC40B,cAAc7jD,EAAE8jD,UAAUtX,GAAE,UAAUliB,GAAG,MAAM,IAAK,WAAW6F,GAAG7F,EAAEtqB,GAAGwsC,GAAE,UAAUliB,GAAkB,IAAI,IAAIC,KAAvB6K,GAAG3N,EAAEznB,GAAG4Z,EAAE,KAAkB5Z,EAAE,GAAGA,EAAElF,eAAeyvB,GAAG,CAAC,IAAI+C,EAAEttB,EAAEuqB,GAAG,aAAaA,EAAE,kBAAkB+C,EAAEhD,EAAEgG,cAAchD,KAAI,IAAKttB,EAAE+jD,0BAA0B9V,GAAG3jB,EAAEgG,YAAYhD,EAAEzlB,GAAG+R,EAAE,CAAC,WAAW0T,IAAI,kBAAkBA,GAAGhD,EAAEgG,cAAc,GAAGhD,KAAI,IAAKttB,EAAE+jD,0BAA0B9V,GAAG3jB,EAAEgG,YAC1ehD,EAAEzlB,GAAG+R,EAAE,CAAC,WAAW,GAAG0T,IAAIzD,EAAG/uB,eAAeyvB,IAAI,MAAM+C,GAAG,aAAa/C,GAAGiiB,GAAE,SAASliB,EAAE,CAAC,OAAO7C,GAAG,IAAK,QAAQ2G,EAAG9D,GAAGmF,EAAGnF,EAAEtqB,GAAE,GAAI,MAAM,IAAK,WAAWouB,EAAG9D,GAAG+F,GAAG/F,GAAG,MAAM,IAAK,SAAS,IAAK,SAAS,MAAM,QAAQ,oBAAoBtqB,EAAEgkD,UAAU15B,EAAE25B,QAAQ/V,IAAI5jB,EAAE1Q,EAAE8P,EAAEsrB,YAAY1qB,EAAE,OAAOA,IAAIZ,EAAE9lB,OAAO,EAAE,KAAK,CAAC2mB,EAAE,IAAI3Q,EAAEN,SAASM,EAAEA,EAAE8V,cAAc,iCAAiC7nB,IAAIA,EAAE0oB,GAAG9I,IAAI,iCAAiC5f,EAAE,WAAW4f,IAAG5f,EAAE0iB,EAAE/oB,cAAc,QAASovB,UAAU,qBAAuB/oB,EAAEA,EAAEipB,YAAYjpB,EAAEgpB,aAC/f,kBAAkBvG,EAAEgL,GAAGztB,EAAE0iB,EAAE/oB,cAAcimB,EAAE,CAAC6N,GAAGhL,EAAEgL,MAAMztB,EAAE0iB,EAAE/oB,cAAcimB,GAAG,WAAWA,IAAI8C,EAAE1iB,EAAEyiB,EAAEw5B,SAASv5B,EAAEu5B,UAAS,EAAGx5B,EAAE5Y,OAAO6Y,EAAE7Y,KAAK4Y,EAAE5Y,QAAQ7J,EAAE0iB,EAAE25B,gBAAgBr8C,EAAE4f,GAAG5f,EAAEunC,IAAI1lB,EAAE7hB,EAAEwnC,IAAI/kB,EAAEy3B,GAAGl6C,EAAE6hB,GAAE,GAAG,GAAIA,EAAEuM,UAAUpuB,EAAEA,EAAE,CAAW,OAAV0iB,EAAE8K,GAAG5N,EAAE6C,GAAU7C,GAAG,IAAK,SAAS+kB,GAAE,SAAS3kC,GAAG2kC,GAAE,QAAQ3kC,GAAG+R,EAAE0Q,EAAE,MAAM,IAAK,SAAS,IAAK,SAAS,IAAK,QAAQkiB,GAAE,OAAO3kC,GAAG+R,EAAE0Q,EAAE,MAAM,IAAK,QAAQ,IAAK,QAAQ,IAAI1Q,EAAE,EAAEA,EAAEuyB,GAAGhxC,OAAOye,IAAI4yB,GAAEL,GAAGvyB,GAAG/R,GAAG+R,EAAE0Q,EAAE,MAAM,IAAK,SAASkiB,GAAE,QAAQ3kC,GAAG+R,EAAE0Q,EAAE,MAAM,IAAK,MAAM,IAAK,QAAQ,IAAK,OAAOkiB,GAAE,QAClf3kC,GAAG2kC,GAAE,OAAO3kC,GAAG+R,EAAE0Q,EAAE,MAAM,IAAK,UAAUkiB,GAAE,SAAS3kC,GAAG+R,EAAE0Q,EAAE,MAAM,IAAK,QAAQ6E,EAAGtnB,EAAEyiB,GAAG1Q,EAAEkV,EAAGjnB,EAAEyiB,GAAGkiB,GAAE,UAAU3kC,GAAG,MAAM,IAAK,SAAiL,QAAQ+R,EAAE0Q,QAAxK,IAAK,SAASziB,EAAEonB,cAAc,CAAC40B,cAAcv5B,EAAEw5B,UAAUlqC,EAAErG,EAAE,CAAC,EAAE+W,EAAE,CAACptB,WAAM,IAASsvC,GAAE,UAAU3kC,GAAG,MAAM,IAAK,WAAWsoB,GAAGtoB,EAAEyiB,GAAG1Q,EAAEoW,GAAGnoB,EAAEyiB,GAAGkiB,GAAE,UAAU3kC,GAAiC,IAAI7H,KAAhBo1B,GAAG3N,EAAE7N,GAAG0T,EAAE1T,EAAa,GAAG0T,EAAExyB,eAAekF,GAAG,CAAC,IAAIutB,EAAED,EAAEttB,GAAG,UAAUA,EAAEk0B,GAAGrsB,EAAE0lB,GAAG,4BAA4BvtB,EAAuB,OAApButB,EAAEA,EAAEA,EAAE+gB,YAAO,IAAgB5d,GAAG7oB,EAAE0lB,GAAI,aAAavtB,EAAE,kBAAkButB,GAAG,aAC7e9F,GAAG,KAAK8F,IAAI0D,GAAGppB,EAAE0lB,GAAG,kBAAkBA,GAAG0D,GAAGppB,EAAE,GAAG0lB,GAAG,mCAAmCvtB,GAAG,6BAA6BA,GAAG,cAAcA,IAAI6pB,EAAG/uB,eAAekF,GAAG,MAAMutB,GAAG,aAAavtB,GAAGwsC,GAAE,SAAS3kC,GAAG,MAAM0lB,GAAGpC,EAAGtjB,EAAE7H,EAAEutB,EAAEhD,GAAG,CAAC,OAAO9C,GAAG,IAAK,QAAQ2G,EAAGvmB,GAAG4nB,EAAG5nB,EAAEyiB,GAAE,GAAI,MAAM,IAAK,WAAW8D,EAAGvmB,GAAGwoB,GAAGxoB,GAAG,MAAM,IAAK,SAAS,MAAMyiB,EAAEptB,OAAO2K,EAAE4jB,aAAa,QAAQ,GAAGwC,EAAG3D,EAAEptB,QAAQ,MAAM,IAAK,SAAS2K,EAAEi8C,WAAWx5B,EAAEw5B,SAAmB,OAAV9jD,EAAEsqB,EAAEptB,OAAc0yB,GAAG/nB,IAAIyiB,EAAEw5B,SAAS9jD,GAAE,GAAI,MAAMsqB,EAAE0E,cAAcY,GAAG/nB,IAAIyiB,EAAEw5B,SAASx5B,EAAE0E,cAClf,GAAI,MAAM,QAAQ,oBAAoBpV,EAAEoqC,UAAUn8C,EAAEo8C,QAAQ/V,IAAI,OAAOzmB,GAAG,IAAK,SAAS,IAAK,QAAQ,IAAK,SAAS,IAAK,WAAW6C,IAAIA,EAAE65B,UAAU,MAAMt8C,EAAE,IAAK,MAAMyiB,GAAE,EAAG,MAAMziB,EAAE,QAAQyiB,GAAE,EAAG,CAACA,IAAIZ,EAAE9lB,OAAO,EAAE,CAAC,OAAO8lB,EAAEwuB,MAAMxuB,EAAE9lB,OAAO,IAAI8lB,EAAE9lB,OAAO,QAAQ,CAAM,OAALxG,GAAEssB,GAAU,KAAK,KAAK,EAAE,GAAG7hB,GAAG,MAAM6hB,EAAEuM,UAAUisB,GAAGr6C,EAAE6hB,EAAE7hB,EAAEorC,cAAc3oB,OAAO,CAAC,GAAG,kBAAkBA,GAAG,OAAOZ,EAAEuM,UAAU,MAAMhJ,MAAMxD,EAAE,MAAsC,GAAhChC,EAAE2xB,GAAGD,GAAGlrC,SAASmrC,GAAGH,GAAGhrC,SAAY+kC,GAAGtpB,GAAG,CAAyC,GAAxCY,EAAEZ,EAAEuM,UAAUxO,EAAEiC,EAAEupB,cAAc3oB,EAAE8kB,IAAI1lB,GAAK1pB,EAAEsqB,EAAE6G,YAAY1J,IAC/e,QADof5f,EACvfmqC,IAAY,OAAOnqC,EAAEzI,KAAK,KAAK,EAAE6uC,GAAG3jB,EAAE6G,UAAU1J,EAAE,KAAY,EAAP5f,EAAEmJ,OAAS,MAAM,KAAK,GAAE,IAAKnJ,EAAEorC,cAAc8Q,0BAA0B9V,GAAG3jB,EAAE6G,UAAU1J,EAAE,KAAY,EAAP5f,EAAEmJ,OAAShR,IAAI0pB,EAAE9lB,OAAO,EAAE,MAAM0mB,GAAG,IAAI7C,EAAEnO,SAASmO,EAAEA,EAAEiI,eAAe00B,eAAe95B,IAAK8kB,IAAI1lB,EAAEA,EAAEuM,UAAU3L,CAAC,CAAM,OAALltB,GAAEssB,GAAU,KAAK,KAAK,GAA0B,GAAvBimB,GAAE+J,IAAGpvB,EAAEZ,EAAEgO,cAAiB,OAAO7vB,GAAG,OAAOA,EAAE6vB,eAAe,OAAO7vB,EAAE6vB,cAAcC,WAAW,CAAC,GAAGua,IAAG,OAAOD,IAAI,KAAY,EAAPvoB,EAAE1Y,OAAS,KAAa,IAAR0Y,EAAE9lB,OAAWsvC,KAAKC,KAAKzpB,EAAE9lB,OAAO,MAAM5D,GAAE,OAAQ,GAAGA,EAAEgzC,GAAGtpB,GAAG,OAAOY,GAAG,OAAOA,EAAEqN,WAAW,CAAC,GAAG,OAC5f9vB,EAAE,CAAC,IAAI7H,EAAE,MAAMitB,MAAMxD,EAAE,MAAqD,KAA7BzpB,EAAE,QAApBA,EAAE0pB,EAAEgO,eAAyB13B,EAAE23B,WAAW,MAAW,MAAM1K,MAAMxD,EAAE,MAAMzpB,EAAEovC,IAAI1lB,CAAC,MAAMypB,KAAK,KAAa,IAARzpB,EAAE9lB,SAAa8lB,EAAEgO,cAAc,MAAMhO,EAAE9lB,OAAO,EAAExG,GAAEssB,GAAG1pB,GAAE,CAAE,MAAM,OAAOmyC,KAAKyR,GAAGzR,IAAIA,GAAG,MAAMnyC,GAAE,EAAG,IAAIA,EAAE,OAAe,MAAR0pB,EAAE9lB,MAAY8lB,EAAE,IAAI,CAAC,OAAG,KAAa,IAARA,EAAE9lB,QAAkB8lB,EAAE0qB,MAAM3sB,EAAEiC,KAAEY,EAAE,OAAOA,MAAO,OAAOziB,GAAG,OAAOA,EAAE6vB,gBAAgBpN,IAAIZ,EAAEoO,MAAMl0B,OAAO,KAAK,KAAY,EAAP8lB,EAAE1Y,QAAU,OAAOnJ,GAAG,KAAe,EAAV6xC,GAAEzrC,SAAW,IAAIo2C,KAAIA,GAAE,GAAGzB,OAAO,OAAOl5B,EAAEsrB,cAActrB,EAAE9lB,OAAO,GAAGxG,GAAEssB,GAAU,MAAK,KAAK,EAAE,OAAO6vB,KACrfyI,GAAGn6C,EAAE6hB,GAAG,OAAO7hB,GAAGglC,GAAGnjB,EAAEuM,UAAU2G,eAAex/B,GAAEssB,GAAG,KAAK,KAAK,GAAG,OAAOmqB,GAAGnqB,EAAExgB,KAAK2kB,UAAUzwB,GAAEssB,GAAG,KAA+C,KAAK,GAA0B,GAAvBimB,GAAE+J,IAAwB,QAArB15C,EAAE0pB,EAAEgO,eAA0B,OAAOt6B,GAAEssB,GAAG,KAAuC,GAAlCY,EAAE,KAAa,IAARZ,EAAE9lB,OAA4B,QAAjB2mB,EAAEvqB,EAAEojD,WAAsB,GAAG94B,EAAEo5B,GAAG1jD,GAAE,OAAQ,CAAC,GAAG,IAAIqkD,IAAG,OAAOx8C,GAAG,KAAa,IAARA,EAAEjE,OAAW,IAAIiE,EAAE6hB,EAAEoO,MAAM,OAAOjwB,GAAG,CAAS,GAAG,QAAX0iB,EAAEovB,GAAG9xC,IAAe,CAAmG,IAAlG6hB,EAAE9lB,OAAO,IAAI8/C,GAAG1jD,GAAE,GAAoB,QAAhBsqB,EAAEC,EAAEyqB,eAAuBtrB,EAAEsrB,YAAY1qB,EAAEZ,EAAE9lB,OAAO,GAAG8lB,EAAEs5B,aAAa,EAAE14B,EAAE7C,EAAMA,EAAEiC,EAAEoO,MAAM,OAAOrQ,GAAO5f,EAAEyiB,GAANtqB,EAAEynB,GAAQ7jB,OAAO,SAC/d,QAAd2mB,EAAEvqB,EAAEu3B,YAAoBv3B,EAAEg0C,WAAW,EAAEh0C,EAAEo0C,MAAMvsC,EAAE7H,EAAE83B,MAAM,KAAK93B,EAAEgjD,aAAa,EAAEhjD,EAAEizC,cAAc,KAAKjzC,EAAE03B,cAAc,KAAK13B,EAAEg1C,YAAY,KAAKh1C,EAAEk0C,aAAa,KAAKl0C,EAAEi2B,UAAU,OAAOj2B,EAAEg0C,WAAWzpB,EAAEypB,WAAWh0C,EAAEo0C,MAAM7pB,EAAE6pB,MAAMp0C,EAAE83B,MAAMvN,EAAEuN,MAAM93B,EAAEgjD,aAAa,EAAEhjD,EAAEuyC,UAAU,KAAKvyC,EAAEizC,cAAc1oB,EAAE0oB,cAAcjzC,EAAE03B,cAAcnN,EAAEmN,cAAc13B,EAAEg1C,YAAYzqB,EAAEyqB,YAAYh1C,EAAEkJ,KAAKqhB,EAAErhB,KAAKrB,EAAE0iB,EAAE2pB,aAAal0C,EAAEk0C,aAAa,OAAOrsC,EAAE,KAAK,CAACusC,MAAMvsC,EAAEusC,MAAMD,aAAatsC,EAAEssC,eAAe1sB,EAAEA,EAAEsQ,QAA2B,OAAnB6X,GAAE8J,GAAY,EAAVA,GAAEzrC,QAAU,GAAUyb,EAAEoO,KAAK,CAACjwB,EAClgBA,EAAEkwB,OAAO,CAAC,OAAO/3B,EAAEujD,MAAM7qB,KAAI4rB,KAAK56B,EAAE9lB,OAAO,IAAI0mB,GAAE,EAAGo5B,GAAG1jD,GAAE,GAAI0pB,EAAE0qB,MAAM,QAAQ,KAAK,CAAC,IAAI9pB,EAAE,GAAW,QAARziB,EAAE8xC,GAAGpvB,KAAa,GAAGb,EAAE9lB,OAAO,IAAI0mB,GAAE,EAAmB,QAAhB7C,EAAE5f,EAAEmtC,eAAuBtrB,EAAEsrB,YAAYvtB,EAAEiC,EAAE9lB,OAAO,GAAG8/C,GAAG1jD,GAAE,GAAI,OAAOA,EAAEujD,MAAM,WAAWvjD,EAAEwjD,WAAWj5B,EAAEgN,YAAY2a,GAAE,OAAO90C,GAAEssB,GAAG,UAAU,EAAEgP,KAAI14B,EAAEqjD,mBAAmBiB,IAAI,aAAa78B,IAAIiC,EAAE9lB,OAAO,IAAI0mB,GAAE,EAAGo5B,GAAG1jD,GAAE,GAAI0pB,EAAE0qB,MAAM,SAASp0C,EAAEmjD,aAAa54B,EAAEwN,QAAQrO,EAAEoO,MAAMpO,EAAEoO,MAAMvN,IAAa,QAAT9C,EAAEznB,EAAEsjD,MAAc77B,EAAEsQ,QAAQxN,EAAEb,EAAEoO,MAAMvN,EAAEvqB,EAAEsjD,KAAK/4B,EAAE,CAAC,OAAG,OAAOvqB,EAAEujD,MAAY75B,EAAE1pB,EAAEujD,KAAKvjD,EAAEojD,UAC9e15B,EAAE1pB,EAAEujD,KAAK75B,EAAEqO,QAAQ/3B,EAAEqjD,mBAAmB3qB,KAAIhP,EAAEqO,QAAQ,KAAKtQ,EAAEiyB,GAAEzrC,QAAQ2hC,GAAE8J,GAAEpvB,EAAI,EAAF7C,EAAI,EAAI,EAAFA,GAAKiC,IAAEtsB,GAAEssB,GAAU,MAAK,KAAK,GAAG,KAAK,GAAG,OAAO66B,KAAKj6B,EAAE,OAAOZ,EAAEgO,cAAc,OAAO7vB,GAAG,OAAOA,EAAE6vB,gBAAgBpN,IAAIZ,EAAE9lB,OAAO,MAAM0mB,GAAG,KAAY,EAAPZ,EAAE1Y,MAAQ,KAAQ,WAAHowC,MAAiBhkD,GAAEssB,GAAkB,EAAfA,EAAEs5B,eAAiBt5B,EAAE9lB,OAAO,OAAOxG,GAAEssB,GAAG,KAAK,KAAK,GAAe,KAAK,GAAG,OAAO,KAAK,MAAMuD,MAAMxD,EAAE,IAAIC,EAAEtqB,KAAM,CAClX,SAASolD,GAAG38C,EAAE6hB,GAAS,OAANqoB,GAAGroB,GAAUA,EAAEtqB,KAAK,KAAK,EAAE,OAAOixC,GAAG3mB,EAAExgB,OAAOqnC,KAAiB,OAAZ1oC,EAAE6hB,EAAE9lB,QAAe8lB,EAAE9lB,OAAS,MAAHiE,EAAS,IAAI6hB,GAAG,KAAK,KAAK,EAAE,OAAO6vB,KAAK5J,GAAEI,IAAIJ,GAAEG,IAAGgK,KAAe,KAAO,OAAjBjyC,EAAE6hB,EAAE9lB,SAAqB,KAAO,IAAFiE,IAAQ6hB,EAAE9lB,OAAS,MAAHiE,EAAS,IAAI6hB,GAAG,KAAK,KAAK,EAAE,OAAO+vB,GAAG/vB,GAAG,KAAK,KAAK,GAA0B,GAAvBimB,GAAE+J,IAAwB,QAArB7xC,EAAE6hB,EAAEgO,gBAA2B,OAAO7vB,EAAE8vB,WAAW,CAAC,GAAG,OAAOjO,EAAE6N,UAAU,MAAMtK,MAAMxD,EAAE,MAAM0pB,IAAI,CAAW,OAAS,OAAnBtrC,EAAE6hB,EAAE9lB,QAAsB8lB,EAAE9lB,OAAS,MAAHiE,EAAS,IAAI6hB,GAAG,KAAK,KAAK,GAAG,OAAOimB,GAAE+J,IAAG,KAAK,KAAK,EAAE,OAAOH,KAAK,KAAK,KAAK,GAAG,OAAO1F,GAAGnqB,EAAExgB,KAAK2kB,UAAU,KAAK,KAAK,GAAG,KAAK,GAAG,OAAO02B,KAC1gB,KAAyB,QAAQ,OAAO,KAAK,CArB7CxC,GAAG,SAASl6C,EAAE6hB,GAAG,IAAI,IAAIjC,EAAEiC,EAAEoO,MAAM,OAAOrQ,GAAG,CAAC,GAAG,IAAIA,EAAEroB,KAAK,IAAIqoB,EAAEroB,IAAIyI,EAAEkF,YAAY0a,EAAEwO,gBAAgB,GAAG,IAAIxO,EAAEroB,KAAK,OAAOqoB,EAAEqQ,MAAM,CAACrQ,EAAEqQ,MAAMN,OAAO/P,EAAEA,EAAEA,EAAEqQ,MAAM,QAAQ,CAAC,GAAGrQ,IAAIiC,EAAE,MAAM,KAAK,OAAOjC,EAAEsQ,SAAS,CAAC,GAAG,OAAOtQ,EAAE+P,QAAQ/P,EAAE+P,SAAS9N,EAAE,OAAOjC,EAAEA,EAAE+P,MAAM,CAAC/P,EAAEsQ,QAAQP,OAAO/P,EAAE+P,OAAO/P,EAAEA,EAAEsQ,OAAO,CAAC,EAAEiqB,GAAG,WAAW,EACxTC,GAAG,SAASp6C,EAAE6hB,EAAEjC,EAAE6C,GAAG,IAAI1Q,EAAE/R,EAAEorC,cAAc,GAAGr5B,IAAI0Q,EAAE,CAACziB,EAAE6hB,EAAEuM,UAAUmjB,GAAGH,GAAGhrC,SAAS,IAA4Rsc,EAAxRvqB,EAAE,KAAK,OAAOynB,GAAG,IAAK,QAAQ7N,EAAEkV,EAAGjnB,EAAE+R,GAAG0Q,EAAEwE,EAAGjnB,EAAEyiB,GAAGtqB,EAAE,GAAG,MAAM,IAAK,SAAS4Z,EAAErG,EAAE,CAAC,EAAEqG,EAAE,CAAC1c,WAAM,IAASotB,EAAE/W,EAAE,CAAC,EAAE+W,EAAE,CAACptB,WAAM,IAAS8C,EAAE,GAAG,MAAM,IAAK,WAAW4Z,EAAEoW,GAAGnoB,EAAE+R,GAAG0Q,EAAE0F,GAAGnoB,EAAEyiB,GAAGtqB,EAAE,GAAG,MAAM,QAAQ,oBAAoB4Z,EAAEoqC,SAAS,oBAAoB15B,EAAE05B,UAAUn8C,EAAEo8C,QAAQ/V,IAAyB,IAAI73B,KAAzB+e,GAAG3N,EAAE6C,GAAS7C,EAAE,KAAc7N,EAAE,IAAI0Q,EAAExvB,eAAeub,IAAIuD,EAAE9e,eAAeub,IAAI,MAAMuD,EAAEvD,GAAG,GAAG,UAAUA,EAAE,CAAC,IAAIiX,EAAE1T,EAAEvD,GAAG,IAAIkU,KAAK+C,EAAEA,EAAExyB,eAAeyvB,KACjf9C,IAAIA,EAAE,CAAC,GAAGA,EAAE8C,GAAG,GAAG,KAAK,4BAA4BlU,GAAG,aAAaA,GAAG,mCAAmCA,GAAG,6BAA6BA,GAAG,cAAcA,IAAIwT,EAAG/uB,eAAeub,GAAGrW,IAAIA,EAAE,KAAKA,EAAEA,GAAG,IAAI1E,KAAK+a,EAAE,OAAO,IAAIA,KAAKiU,EAAE,CAAC,IAAIiD,EAAEjD,EAAEjU,GAAyB,GAAtBiX,EAAE,MAAM1T,EAAEA,EAAEvD,QAAG,EAAUiU,EAAExvB,eAAeub,IAAIkX,IAAID,IAAI,MAAMC,GAAG,MAAMD,GAAG,GAAG,UAAUjX,EAAE,GAAGiX,EAAE,CAAC,IAAI/C,KAAK+C,GAAGA,EAAExyB,eAAeyvB,IAAIgD,GAAGA,EAAEzyB,eAAeyvB,KAAK9C,IAAIA,EAAE,CAAC,GAAGA,EAAE8C,GAAG,IAAI,IAAIA,KAAKgD,EAAEA,EAAEzyB,eAAeyvB,IAAI+C,EAAE/C,KAAKgD,EAAEhD,KAAK9C,IAAIA,EAAE,CAAC,GAAGA,EAAE8C,GAAGgD,EAAEhD,GAAG,MAAM9C,IAAIznB,IAAIA,EAAE,IAAIA,EAAE1E,KAAK+a,EACpfoR,IAAIA,EAAE8F,MAAM,4BAA4BlX,GAAGkX,EAAEA,EAAEA,EAAE+gB,YAAO,EAAOhhB,EAAEA,EAAEA,EAAEghB,YAAO,EAAO,MAAM/gB,GAAGD,IAAIC,IAAIvtB,EAAEA,GAAG,IAAI1E,KAAK+a,EAAEkX,IAAI,aAAalX,EAAE,kBAAkBkX,GAAG,kBAAkBA,IAAIvtB,EAAEA,GAAG,IAAI1E,KAAK+a,EAAE,GAAGkX,GAAG,mCAAmClX,GAAG,6BAA6BA,IAAIwT,EAAG/uB,eAAeub,IAAI,MAAMkX,GAAG,aAAalX,GAAGm2B,GAAE,SAAS3kC,GAAG7H,GAAGstB,IAAIC,IAAIvtB,EAAE,MAAMA,EAAEA,GAAG,IAAI1E,KAAK+a,EAAEkX,GAAG,CAAC9F,IAAIznB,EAAEA,GAAG,IAAI1E,KAAK,QAAQmsB,GAAG,IAAIpR,EAAErW,GAAK0pB,EAAEsrB,YAAY3+B,KAAEqT,EAAE9lB,OAAO,EAAC,CAAC,EAAEs+C,GAAG,SAASr6C,EAAE6hB,EAAEjC,EAAE6C,GAAG7C,IAAI6C,IAAIZ,EAAE9lB,OAAO,EAAE,EAkBlb,IAAI6gD,IAAG,EAAGC,IAAE,EAAGC,GAAG,oBAAoBC,QAAQA,QAAQhpC,IAAIzV,GAAE,KAAK,SAAS0+C,GAAGh9C,EAAE6hB,GAAG,IAAIjC,EAAE5f,EAAEqwC,IAAI,GAAG,OAAOzwB,EAAE,GAAG,oBAAoBA,EAAE,IAAIA,EAAE,KAAK,CAAC,MAAM6C,GAAGw6B,GAAEj9C,EAAE6hB,EAAEY,EAAE,MAAM7C,EAAExZ,QAAQ,IAAI,CAAC,SAAS82C,GAAGl9C,EAAE6hB,EAAEjC,GAAG,IAAIA,GAAG,CAAC,MAAM6C,GAAGw6B,GAAEj9C,EAAE6hB,EAAEY,EAAE,CAAC,CAAC,IAAI06B,IAAG,EAIxR,SAASC,GAAGp9C,EAAE6hB,EAAEjC,GAAG,IAAI6C,EAAEZ,EAAEsrB,YAAyC,GAAG,QAAhC1qB,EAAE,OAAOA,EAAEA,EAAE+xB,WAAW,MAAiB,CAAC,IAAIziC,EAAE0Q,EAAEA,EAAEkqB,KAAK,EAAE,CAAC,IAAI56B,EAAExa,IAAIyI,KAAKA,EAAE,CAAC,IAAI7H,EAAE4Z,EAAE+iC,QAAQ/iC,EAAE+iC,aAAQ,OAAO,IAAS38C,GAAG+kD,GAAGr7B,EAAEjC,EAAEznB,EAAE,CAAC4Z,EAAEA,EAAE46B,IAAI,OAAO56B,IAAI0Q,EAAE,CAAC,CAAC,SAAS46B,GAAGr9C,EAAE6hB,GAAgD,GAAG,QAAhCA,EAAE,QAAlBA,EAAEA,EAAEsrB,aAAuBtrB,EAAE2yB,WAAW,MAAiB,CAAC,IAAI50B,EAAEiC,EAAEA,EAAE8qB,KAAK,EAAE,CAAC,IAAI/sB,EAAEroB,IAAIyI,KAAKA,EAAE,CAAC,IAAIyiB,EAAE7C,EAAE7qB,OAAO6qB,EAAEk1B,QAAQryB,GAAG,CAAC7C,EAAEA,EAAE+sB,IAAI,OAAO/sB,IAAIiC,EAAE,CAAC,CAAC,SAASy7B,GAAGt9C,GAAG,IAAI6hB,EAAE7hB,EAAEqwC,IAAI,GAAG,OAAOxuB,EAAE,CAAC,IAAIjC,EAAE5f,EAAEouB,UAAiBpuB,EAAEzI,IAA8ByI,EAAE4f,EAAE,oBAAoBiC,EAAEA,EAAE7hB,GAAG6hB,EAAEzb,QAAQpG,CAAC,CAAC,CAClf,SAASu9C,GAAGv9C,GAAG,IAAI6hB,EAAE7hB,EAAE0vB,UAAU,OAAO7N,IAAI7hB,EAAE0vB,UAAU,KAAK6tB,GAAG17B,IAAI7hB,EAAEiwB,MAAM,KAAKjwB,EAAE0qC,UAAU,KAAK1qC,EAAEkwB,QAAQ,KAAK,IAAIlwB,EAAEzI,MAAoB,QAAdsqB,EAAE7hB,EAAEouB,oBAA4BvM,EAAE0lB,WAAW1lB,EAAE2lB,WAAW3lB,EAAE+iB,WAAW/iB,EAAE4lB,WAAW5lB,EAAE6lB,MAAM1nC,EAAEouB,UAAU,KAAKpuB,EAAE2vB,OAAO,KAAK3vB,EAAEqsC,aAAa,KAAKrsC,EAAEorC,cAAc,KAAKprC,EAAE6vB,cAAc,KAAK7vB,EAAE4qC,aAAa,KAAK5qC,EAAEouB,UAAU,KAAKpuB,EAAEmtC,YAAY,IAAI,CAAC,SAASqQ,GAAGx9C,GAAG,OAAO,IAAIA,EAAEzI,KAAK,IAAIyI,EAAEzI,KAAK,IAAIyI,EAAEzI,GAAG,CACna,SAASkmD,GAAGz9C,GAAGA,EAAE,OAAO,CAAC,KAAK,OAAOA,EAAEkwB,SAAS,CAAC,GAAG,OAAOlwB,EAAE2vB,QAAQ6tB,GAAGx9C,EAAE2vB,QAAQ,OAAO,KAAK3vB,EAAEA,EAAE2vB,MAAM,CAA2B,IAA1B3vB,EAAEkwB,QAAQP,OAAO3vB,EAAE2vB,OAAW3vB,EAAEA,EAAEkwB,QAAQ,IAAIlwB,EAAEzI,KAAK,IAAIyI,EAAEzI,KAAK,KAAKyI,EAAEzI,KAAK,CAAC,GAAW,EAARyI,EAAEjE,MAAQ,SAASiE,EAAE,GAAG,OAAOA,EAAEiwB,OAAO,IAAIjwB,EAAEzI,IAAI,SAASyI,EAAOA,EAAEiwB,MAAMN,OAAO3vB,EAAEA,EAAEA,EAAEiwB,KAAK,CAAC,KAAa,EAARjwB,EAAEjE,OAAS,OAAOiE,EAAEouB,SAAS,CAAC,CACzT,SAASsvB,GAAG19C,EAAE6hB,EAAEjC,GAAG,IAAI6C,EAAEziB,EAAEzI,IAAI,GAAG,IAAIkrB,GAAG,IAAIA,EAAEziB,EAAEA,EAAEouB,UAAUvM,EAAE,IAAIjC,EAAEnO,SAASmO,EAAEkO,WAAW6vB,aAAa39C,EAAE6hB,GAAGjC,EAAE+9B,aAAa39C,EAAE6hB,IAAI,IAAIjC,EAAEnO,UAAUoQ,EAAEjC,EAAEkO,YAAa6vB,aAAa39C,EAAE4f,IAAKiC,EAAEjC,GAAI1a,YAAYlF,GAA4B,QAAxB4f,EAAEA,EAAEg+B,2BAA8B,IAASh+B,GAAG,OAAOiC,EAAEu6B,UAAUv6B,EAAEu6B,QAAQ/V,UAAU,GAAG,IAAI5jB,GAAc,QAAVziB,EAAEA,EAAEiwB,OAAgB,IAAIytB,GAAG19C,EAAE6hB,EAAEjC,GAAG5f,EAAEA,EAAEkwB,QAAQ,OAAOlwB,GAAG09C,GAAG19C,EAAE6hB,EAAEjC,GAAG5f,EAAEA,EAAEkwB,OAAO,CAC1X,SAAS2tB,GAAG79C,EAAE6hB,EAAEjC,GAAG,IAAI6C,EAAEziB,EAAEzI,IAAI,GAAG,IAAIkrB,GAAG,IAAIA,EAAEziB,EAAEA,EAAEouB,UAAUvM,EAAEjC,EAAE+9B,aAAa39C,EAAE6hB,GAAGjC,EAAE1a,YAAYlF,QAAQ,GAAG,IAAIyiB,GAAc,QAAVziB,EAAEA,EAAEiwB,OAAgB,IAAI4tB,GAAG79C,EAAE6hB,EAAEjC,GAAG5f,EAAEA,EAAEkwB,QAAQ,OAAOlwB,GAAG69C,GAAG79C,EAAE6hB,EAAEjC,GAAG5f,EAAEA,EAAEkwB,OAAO,CAAC,IAAI4tB,GAAE,KAAKC,IAAG,EAAG,SAASC,GAAGh+C,EAAE6hB,EAAEjC,GAAG,IAAIA,EAAEA,EAAEqQ,MAAM,OAAOrQ,GAAGq+B,GAAGj+C,EAAE6hB,EAAEjC,GAAGA,EAAEA,EAAEsQ,OAAO,CACnR,SAAS+tB,GAAGj+C,EAAE6hB,EAAEjC,GAAG,GAAGgS,IAAI,oBAAoBA,GAAGssB,qBAAqB,IAAItsB,GAAGssB,qBAAqBvsB,GAAG/R,EAAE,CAAC,MAAM6F,GAAG,CAAC,OAAO7F,EAAEroB,KAAK,KAAK,EAAEslD,IAAGG,GAAGp9B,EAAEiC,GAAG,KAAK,EAAE,IAAIY,EAAEq7B,GAAE/rC,EAAEgsC,GAAGD,GAAE,KAAKE,GAAGh+C,EAAE6hB,EAAEjC,GAAOm+B,GAAGhsC,EAAE,QAAT+rC,GAAEr7B,KAAkBs7B,IAAI/9C,EAAE89C,GAAEl+B,EAAEA,EAAEwO,UAAU,IAAIpuB,EAAEyR,SAASzR,EAAE8tB,WAAW7E,YAAYrJ,GAAG5f,EAAEipB,YAAYrJ,IAAIk+B,GAAE70B,YAAYrJ,EAAEwO,YAAY,MAAM,KAAK,GAAG,OAAO0vB,KAAIC,IAAI/9C,EAAE89C,GAAEl+B,EAAEA,EAAEwO,UAAU,IAAIpuB,EAAEyR,SAASy1B,GAAGlnC,EAAE8tB,WAAWlO,GAAG,IAAI5f,EAAEyR,UAAUy1B,GAAGlnC,EAAE4f,GAAG2V,GAAGv1B,IAAIknC,GAAG4W,GAAEl+B,EAAEwO,YAAY,MAAM,KAAK,EAAE3L,EAAEq7B,GAAE/rC,EAAEgsC,GAAGD,GAAEl+B,EAAEwO,UAAU2G,cAAcgpB,IAAG,EAClfC,GAAGh+C,EAAE6hB,EAAEjC,GAAGk+B,GAAEr7B,EAAEs7B,GAAGhsC,EAAE,MAAM,KAAK,EAAE,KAAK,GAAG,KAAK,GAAG,KAAK,GAAG,IAAI8qC,KAAoB,QAAhBp6B,EAAE7C,EAAEutB,cAAsC,QAAf1qB,EAAEA,EAAE+xB,aAAsB,CAACziC,EAAE0Q,EAAEA,EAAEkqB,KAAK,EAAE,CAAC,IAAIx0C,EAAE4Z,EAAE2Q,EAAEvqB,EAAE28C,QAAQ38C,EAAEA,EAAEZ,SAAI,IAASmrB,IAAI,KAAO,EAAFvqB,IAAe,KAAO,EAAFA,KAAf+kD,GAAGt9B,EAAEiC,EAAEa,GAAyB3Q,EAAEA,EAAE46B,IAAI,OAAO56B,IAAI0Q,EAAE,CAACu7B,GAAGh+C,EAAE6hB,EAAEjC,GAAG,MAAM,KAAK,EAAE,IAAIi9B,KAAIG,GAAGp9B,EAAEiC,GAAiB,oBAAdY,EAAE7C,EAAEwO,WAAgC+vB,sBAAsB,IAAI17B,EAAE7c,MAAMga,EAAEwrB,cAAc3oB,EAAE3hB,MAAM8e,EAAEiQ,cAAcpN,EAAE07B,sBAAsB,CAAC,MAAM14B,GAAGw3B,GAAEr9B,EAAEiC,EAAE4D,EAAE,CAACu4B,GAAGh+C,EAAE6hB,EAAEjC,GAAG,MAAM,KAAK,GAAGo+B,GAAGh+C,EAAE6hB,EAAEjC,GAAG,MAAM,KAAK,GAAU,EAAPA,EAAEzW,MAAQ0zC,IAAGp6B,EAAEo6B,KAAI,OAChfj9B,EAAEiQ,cAAcmuB,GAAGh+C,EAAE6hB,EAAEjC,GAAGi9B,GAAEp6B,GAAGu7B,GAAGh+C,EAAE6hB,EAAEjC,GAAG,MAAM,QAAQo+B,GAAGh+C,EAAE6hB,EAAEjC,GAAG,CAAC,SAASw+B,GAAGp+C,GAAG,IAAI6hB,EAAE7hB,EAAEmtC,YAAY,GAAG,OAAOtrB,EAAE,CAAC7hB,EAAEmtC,YAAY,KAAK,IAAIvtB,EAAE5f,EAAEouB,UAAU,OAAOxO,IAAIA,EAAE5f,EAAEouB,UAAU,IAAI0uB,IAAIj7B,EAAEtP,SAAQ,SAASsP,GAAG,IAAIY,EAAE47B,GAAG1hD,KAAK,KAAKqD,EAAE6hB,GAAGjC,EAAErf,IAAIshB,KAAKjC,EAAE1K,IAAI2M,GAAGA,EAAEklB,KAAKtkB,EAAEA,GAAG,GAAE,CAAC,CACzQ,SAAS67B,GAAGt+C,EAAE6hB,GAAG,IAAIjC,EAAEiC,EAAE6oB,UAAU,GAAG,OAAO9qB,EAAE,IAAI,IAAI6C,EAAE,EAAEA,EAAE7C,EAAEtsB,OAAOmvB,IAAI,CAAC,IAAI1Q,EAAE6N,EAAE6C,GAAG,IAAI,IAAItqB,EAAE6H,EAAE0iB,EAAEb,EAAE4D,EAAE/C,EAAE1iB,EAAE,KAAK,OAAOylB,GAAG,CAAC,OAAOA,EAAEluB,KAAK,KAAK,EAAEumD,GAAEr4B,EAAE2I,UAAU2vB,IAAG,EAAG,MAAM/9C,EAAE,KAAK,EAA4C,KAAK,EAAE89C,GAAEr4B,EAAE2I,UAAU2G,cAAcgpB,IAAG,EAAG,MAAM/9C,EAAEylB,EAAEA,EAAEkK,MAAM,CAAC,GAAG,OAAOmuB,GAAE,MAAM14B,MAAMxD,EAAE,MAAMq8B,GAAG9lD,EAAEuqB,EAAE3Q,GAAG+rC,GAAE,KAAKC,IAAG,EAAG,IAAIr4B,EAAE3T,EAAE2d,UAAU,OAAOhK,IAAIA,EAAEiK,OAAO,MAAM5d,EAAE4d,OAAO,IAAI,CAAC,MAAMnhB,GAAGyuC,GAAElrC,EAAE8P,EAAErT,EAAE,CAAC,CAAC,GAAkB,MAAfqT,EAAEs5B,aAAmB,IAAIt5B,EAAEA,EAAEoO,MAAM,OAAOpO,GAAG08B,GAAG18B,EAAE7hB,GAAG6hB,EAAEA,EAAEqO,OAAO,CACje,SAASquB,GAAGv+C,EAAE6hB,GAAG,IAAIjC,EAAE5f,EAAE0vB,UAAUjN,EAAEziB,EAAEjE,MAAM,OAAOiE,EAAEzI,KAAK,KAAK,EAAE,KAAK,GAAG,KAAK,GAAG,KAAK,GAAiB,GAAd+mD,GAAGz8B,EAAE7hB,GAAGw+C,GAAGx+C,GAAQ,EAAFyiB,EAAI,CAAC,IAAI26B,GAAG,EAAEp9C,EAAEA,EAAE2vB,QAAQ0tB,GAAG,EAAEr9C,EAAE,CAAC,MAAMklC,GAAG+X,GAAEj9C,EAAEA,EAAE2vB,OAAOuV,EAAE,CAAC,IAAIkY,GAAG,EAAEp9C,EAAEA,EAAE2vB,OAAO,CAAC,MAAMuV,GAAG+X,GAAEj9C,EAAEA,EAAE2vB,OAAOuV,EAAE,CAAC,CAAC,MAAM,KAAK,EAAEoZ,GAAGz8B,EAAE7hB,GAAGw+C,GAAGx+C,GAAK,IAAFyiB,GAAO,OAAO7C,GAAGo9B,GAAGp9B,EAAEA,EAAE+P,QAAQ,MAAM,KAAK,EAAgD,GAA9C2uB,GAAGz8B,EAAE7hB,GAAGw+C,GAAGx+C,GAAK,IAAFyiB,GAAO,OAAO7C,GAAGo9B,GAAGp9B,EAAEA,EAAE+P,QAAmB,GAAR3vB,EAAEjE,MAAS,CAAC,IAAIgW,EAAE/R,EAAEouB,UAAU,IAAIhF,GAAGrX,EAAE,GAAG,CAAC,MAAMmzB,GAAG+X,GAAEj9C,EAAEA,EAAE2vB,OAAOuV,EAAE,CAAC,CAAC,GAAK,EAAFziB,GAAoB,OAAd1Q,EAAE/R,EAAEouB,WAAmB,CAAC,IAAIj2B,EAAE6H,EAAEorC,cAAc1oB,EAAE,OAAO9C,EAAEA,EAAEwrB,cAAcjzC,EAAEstB,EAAEzlB,EAAEqB,KAAKqkB,EAAE1lB,EAAEmtC,YACje,GAAnBntC,EAAEmtC,YAAY,KAAQ,OAAOznB,EAAE,IAAI,UAAUD,GAAG,UAAUttB,EAAEkJ,MAAM,MAAMlJ,EAAEY,MAAM0uB,EAAG1V,EAAE5Z,GAAGq1B,GAAG/H,EAAE/C,GAAG,IAAIlU,EAAEgf,GAAG/H,EAAEttB,GAAG,IAAIuqB,EAAE,EAAEA,EAAEgD,EAAEpyB,OAAOovB,GAAG,EAAE,CAAC,IAAIrjB,EAAEqmB,EAAEhD,GAAGyrB,EAAEzoB,EAAEhD,EAAE,GAAG,UAAUrjB,EAAEgtB,GAAGta,EAAEo8B,GAAG,4BAA4B9uC,EAAEwpB,GAAG9W,EAAEo8B,GAAG,aAAa9uC,EAAE+pB,GAAGrX,EAAEo8B,GAAG7qB,EAAGvR,EAAE1S,EAAE8uC,EAAE3/B,EAAE,CAAC,OAAOiX,GAAG,IAAK,QAAQiC,EAAG3V,EAAE5Z,GAAG,MAAM,IAAK,WAAWowB,GAAGxW,EAAE5Z,GAAG,MAAM,IAAK,SAAS,IAAIi2C,EAAEr8B,EAAEqV,cAAc40B,YAAYjqC,EAAEqV,cAAc40B,cAAc7jD,EAAE8jD,SAAS,IAAI5N,EAAEl2C,EAAE9C,MAAM,MAAMg5C,EAAEtmB,GAAGhW,IAAI5Z,EAAE8jD,SAAS5N,GAAE,GAAID,MAAMj2C,EAAE8jD,WAAW,MAAM9jD,EAAEgvB,aAAaY,GAAGhW,IAAI5Z,EAAE8jD,SACnf9jD,EAAEgvB,cAAa,GAAIY,GAAGhW,IAAI5Z,EAAE8jD,SAAS9jD,EAAE8jD,SAAS,GAAG,IAAG,IAAKlqC,EAAEy1B,IAAIrvC,CAAC,CAAC,MAAM+sC,GAAG+X,GAAEj9C,EAAEA,EAAE2vB,OAAOuV,EAAE,CAAC,CAAC,MAAM,KAAK,EAAgB,GAAdoZ,GAAGz8B,EAAE7hB,GAAGw+C,GAAGx+C,GAAQ,EAAFyiB,EAAI,CAAC,GAAG,OAAOziB,EAAEouB,UAAU,MAAMhJ,MAAMxD,EAAE,MAAM7P,EAAE/R,EAAEouB,UAAUj2B,EAAE6H,EAAEorC,cAAc,IAAIr5B,EAAEuX,UAAUnxB,CAAC,CAAC,MAAM+sC,GAAG+X,GAAEj9C,EAAEA,EAAE2vB,OAAOuV,EAAE,CAAC,CAAC,MAAM,KAAK,EAAgB,GAAdoZ,GAAGz8B,EAAE7hB,GAAGw+C,GAAGx+C,GAAQ,EAAFyiB,GAAK,OAAO7C,GAAGA,EAAEiQ,cAAciF,aAAa,IAAIS,GAAG1T,EAAEkT,cAAc,CAAC,MAAMmQ,GAAG+X,GAAEj9C,EAAEA,EAAE2vB,OAAOuV,EAAE,CAAC,MAAM,KAAK,EAG4G,QAAQoZ,GAAGz8B,EACnf7hB,GAAGw+C,GAAGx+C,SAJ4Y,KAAK,GAAGs+C,GAAGz8B,EAAE7hB,GAAGw+C,GAAGx+C,GAAqB,MAAlB+R,EAAE/R,EAAEiwB,OAAQl0B,QAAa5D,EAAE,OAAO4Z,EAAE8d,cAAc9d,EAAEqc,UAAUqwB,SAAStmD,GAAGA,GAClf,OAAO4Z,EAAE2d,WAAW,OAAO3d,EAAE2d,UAAUG,gBAAgB6uB,GAAG7tB,OAAQ,EAAFpO,GAAK27B,GAAGp+C,GAAG,MAAM,KAAK,GAAsF,GAAnFX,EAAE,OAAOugB,GAAG,OAAOA,EAAEiQ,cAAqB,EAAP7vB,EAAEmJ,MAAQ0zC,IAAGruC,EAAEquC,KAAIx9C,EAAEi/C,GAAGz8B,EAAE7hB,GAAG68C,GAAEruC,GAAG8vC,GAAGz8B,EAAE7hB,GAAGw+C,GAAGx+C,GAAQ,KAAFyiB,EAAO,CAA0B,GAAzBjU,EAAE,OAAOxO,EAAE6vB,eAAkB7vB,EAAEouB,UAAUqwB,SAASjwC,KAAKnP,GAAG,KAAY,EAAPW,EAAEmJ,MAAQ,IAAI7K,GAAE0B,EAAEX,EAAEW,EAAEiwB,MAAM,OAAO5wB,GAAG,CAAC,IAAI8uC,EAAE7vC,GAAEe,EAAE,OAAOf,IAAG,CAAe,OAAV+vC,GAAJD,EAAE9vC,IAAM2xB,MAAame,EAAE72C,KAAK,KAAK,EAAE,KAAK,GAAG,KAAK,GAAG,KAAK,GAAG6lD,GAAG,EAAEhP,EAAEA,EAAEze,QAAQ,MAAM,KAAK,EAAEqtB,GAAG5O,EAAEA,EAAEze,QAAQ,IAAIlwB,EAAE2uC,EAAEhgB,UAAU,GAAG,oBAAoB3uB,EAAE0+C,qBAAqB,CAAC17B,EAAE2rB,EAAExuB,EAAEwuB,EAAEze,OAAO,IAAI9N,EAAEY,EAAEhjB,EAAEmG,MACpfic,EAAEupB,cAAc3rC,EAAEqB,MAAM+gB,EAAEgO,cAAcpwB,EAAE0+C,sBAAsB,CAAC,MAAMjZ,GAAG+X,GAAEx6B,EAAE7C,EAAEslB,EAAE,CAAC,CAAC,MAAM,KAAK,EAAE8X,GAAG5O,EAAEA,EAAEze,QAAQ,MAAM,KAAK,GAAG,GAAG,OAAOye,EAAEve,cAAc,CAAC8uB,GAAGxQ,GAAG,QAAQ,EAAE,OAAOE,GAAGA,EAAE1e,OAAOye,EAAE9vC,GAAE+vC,GAAGsQ,GAAGxQ,EAAE,CAAC9uC,EAAEA,EAAE6wB,OAAO,CAAClwB,EAAE,IAAIX,EAAE,KAAK8uC,EAAEnuC,IAAI,CAAC,GAAG,IAAImuC,EAAE52C,KAAK,GAAG,OAAO8H,EAAE,CAACA,EAAE8uC,EAAE,IAAIp8B,EAAEo8B,EAAE/f,UAAU5f,EAAa,oBAAVrW,EAAE4Z,EAAE/M,OAA4BsnB,YAAYn0B,EAAEm0B,YAAY,UAAU,OAAO,aAAan0B,EAAE8M,QAAQ,QAASwgB,EAAE0oB,EAAE/f,UAAkC1L,OAAE,KAA1BgD,EAAEyoB,EAAE/C,cAAcpmC,QAAoB,OAAO0gB,GAAGA,EAAEzyB,eAAe,WAAWyyB,EAAEzgB,QAAQ,KAAKwgB,EAAEzgB,MAAMC,QACzfmnB,GAAG,UAAU1J,GAAG,CAAC,MAAMwiB,GAAG+X,GAAEj9C,EAAEA,EAAE2vB,OAAOuV,EAAE,CAAC,OAAO,GAAG,IAAIiJ,EAAE52C,KAAK,GAAG,OAAO8H,EAAE,IAAI8uC,EAAE/f,UAAU9E,UAAU9a,EAAE,GAAG2/B,EAAE/C,aAAa,CAAC,MAAMlG,GAAG+X,GAAEj9C,EAAEA,EAAE2vB,OAAOuV,EAAE,OAAO,IAAI,KAAKiJ,EAAE52C,KAAK,KAAK42C,EAAE52C,KAAK,OAAO42C,EAAEte,eAAese,IAAInuC,IAAI,OAAOmuC,EAAEle,MAAM,CAACke,EAAEle,MAAMN,OAAOwe,EAAEA,EAAEA,EAAEle,MAAM,QAAQ,CAAC,GAAGke,IAAInuC,EAAE,MAAMA,EAAE,KAAK,OAAOmuC,EAAEje,SAAS,CAAC,GAAG,OAAOie,EAAExe,QAAQwe,EAAExe,SAAS3vB,EAAE,MAAMA,EAAEX,IAAI8uC,IAAI9uC,EAAE,MAAM8uC,EAAEA,EAAExe,MAAM,CAACtwB,IAAI8uC,IAAI9uC,EAAE,MAAM8uC,EAAEje,QAAQP,OAAOwe,EAAExe,OAAOwe,EAAEA,EAAEje,OAAO,CAAC,CAAC,MAAM,KAAK,GAAGouB,GAAGz8B,EAAE7hB,GAAGw+C,GAAGx+C,GAAK,EAAFyiB,GAAK27B,GAAGp+C,GAAS,KAAK,IACtd,CAAC,SAASw+C,GAAGx+C,GAAG,IAAI6hB,EAAE7hB,EAAEjE,MAAM,GAAK,EAAF8lB,EAAI,CAAC,IAAI7hB,EAAE,CAAC,IAAI,IAAI4f,EAAE5f,EAAE2vB,OAAO,OAAO/P,GAAG,CAAC,GAAG49B,GAAG59B,GAAG,CAAC,IAAI6C,EAAE7C,EAAE,MAAM5f,CAAC,CAAC4f,EAAEA,EAAE+P,MAAM,CAAC,MAAMvK,MAAMxD,EAAE,KAAM,CAAC,OAAOa,EAAElrB,KAAK,KAAK,EAAE,IAAIwa,EAAE0Q,EAAE2L,UAAkB,GAAR3L,EAAE1mB,QAAWqtB,GAAGrX,EAAE,IAAI0Q,EAAE1mB,QAAQ,IAAgB8hD,GAAG79C,EAATy9C,GAAGz9C,GAAU+R,GAAG,MAAM,KAAK,EAAE,KAAK,EAAE,IAAI2Q,EAAED,EAAE2L,UAAU2G,cAAsB2oB,GAAG19C,EAATy9C,GAAGz9C,GAAU0iB,GAAG,MAAM,QAAQ,MAAM0C,MAAMxD,EAAE,MAAO,CAAC,MAAM8D,GAAGu3B,GAAEj9C,EAAEA,EAAE2vB,OAAOjK,EAAE,CAAC1lB,EAAEjE,QAAQ,CAAC,CAAG,KAAF8lB,IAAS7hB,EAAEjE,QAAQ,KAAK,CAAC,SAAS6iD,GAAG5+C,EAAE6hB,EAAEjC,GAAGthB,GAAE0B,EAAE6+C,GAAG7+C,EAAE6hB,EAAEjC,EAAE,CACvb,SAASi/B,GAAG7+C,EAAE6hB,EAAEjC,GAAG,IAAI,IAAI6C,EAAE,KAAY,EAAPziB,EAAEmJ,MAAQ,OAAO7K,IAAG,CAAC,IAAIyT,EAAEzT,GAAEnG,EAAE4Z,EAAEke,MAAM,GAAG,KAAKle,EAAExa,KAAKkrB,EAAE,CAAC,IAAIC,EAAE,OAAO3Q,EAAE8d,eAAe+sB,GAAG,IAAIl6B,EAAE,CAAC,IAAI+C,EAAE1T,EAAE2d,UAAUhK,EAAE,OAAOD,GAAG,OAAOA,EAAEoK,eAAegtB,GAAEp3B,EAAEm3B,GAAG,IAAIpuC,EAAEquC,GAAO,GAALD,GAAGl6B,GAAMm6B,GAAEn3B,KAAKlX,EAAE,IAAIlQ,GAAEyT,EAAE,OAAOzT,IAAOonB,GAAJhD,EAAEpkB,IAAM2xB,MAAM,KAAKvN,EAAEnrB,KAAK,OAAOmrB,EAAEmN,cAAcivB,GAAG/sC,GAAG,OAAO2T,GAAGA,EAAEiK,OAAOjN,EAAEpkB,GAAEonB,GAAGo5B,GAAG/sC,GAAG,KAAK,OAAO5Z,GAAGmG,GAAEnG,EAAE0mD,GAAG1mD,EAAE0pB,EAAEjC,GAAGznB,EAAEA,EAAE+3B,QAAQ5xB,GAAEyT,EAAE6qC,GAAGn3B,EAAEo3B,GAAEruC,CAAC,CAACuwC,GAAG/+C,EAAM,MAAM,KAAoB,KAAf+R,EAAEopC,eAAoB,OAAOhjD,GAAGA,EAAEw3B,OAAO5d,EAAEzT,GAAEnG,GAAG4mD,GAAG/+C,EAAM,CAAC,CACvc,SAAS++C,GAAG/+C,GAAG,KAAK,OAAO1B,IAAG,CAAC,IAAIujB,EAAEvjB,GAAE,GAAG,KAAa,KAARujB,EAAE9lB,OAAY,CAAC,IAAI6jB,EAAEiC,EAAE6N,UAAU,IAAI,GAAG,KAAa,KAAR7N,EAAE9lB,OAAY,OAAO8lB,EAAEtqB,KAAK,KAAK,EAAE,KAAK,GAAG,KAAK,GAAGslD,IAAGQ,GAAG,EAAEx7B,GAAG,MAAM,KAAK,EAAE,IAAIY,EAAEZ,EAAEuM,UAAU,GAAW,EAARvM,EAAE9lB,QAAU8gD,GAAE,GAAG,OAAOj9B,EAAE6C,EAAE0tB,wBAAwB,CAAC,IAAIp+B,EAAE8P,EAAE4oB,cAAc5oB,EAAExgB,KAAKue,EAAEwrB,cAAcK,GAAG5pB,EAAExgB,KAAKue,EAAEwrB,eAAe3oB,EAAEo3B,mBAAmB9nC,EAAE6N,EAAEiQ,cAAcpN,EAAEu8B,oCAAoC,CAAC,IAAI7mD,EAAE0pB,EAAEsrB,YAAY,OAAOh1C,GAAGo2C,GAAG1sB,EAAE1pB,EAAEsqB,GAAG,MAAM,KAAK,EAAE,IAAIC,EAAEb,EAAEsrB,YAAY,GAAG,OAAOzqB,EAAE,CAAQ,GAAP9C,EAAE,KAAQ,OAAOiC,EAAEoO,MAAM,OAAOpO,EAAEoO,MAAM14B,KAAK,KAAK,EACvf,KAAK,EAAEqoB,EAAEiC,EAAEoO,MAAM7B,UAAUmgB,GAAG1sB,EAAEa,EAAE9C,EAAE,CAAC,MAAM,KAAK,EAAE,IAAI6F,EAAE5D,EAAEuM,UAAU,GAAG,OAAOxO,GAAW,EAARiC,EAAE9lB,MAAQ,CAAC6jB,EAAE6F,EAAE,IAAIC,EAAE7D,EAAEupB,cAAc,OAAOvpB,EAAExgB,MAAM,IAAK,SAAS,IAAK,QAAQ,IAAK,SAAS,IAAK,WAAWqkB,EAAE42B,WAAW18B,EAAEgjB,QAAQ,MAAM,IAAK,MAAMld,EAAEvgB,MAAMya,EAAEza,IAAIugB,EAAEvgB,KAAK,CAAC,MAAM,KAAK,EAAQ,KAAK,EAAQ,KAAK,GAAyJ,KAAK,GAAG,KAAK,GAAG,KAAK,GAAG,KAAK,GAAG,KAAK,GAAG,KAAK,GAAG,MAAhM,KAAK,GAAG,GAAG,OAAO0c,EAAEgO,cAAc,CAAC,IAAIrhB,EAAEqT,EAAE6N,UAAU,GAAG,OAAOlhB,EAAE,CAAC,IAAInP,EAAEmP,EAAEqhB,cAAc,GAAG,OAAOxwB,EAAE,CAAC,IAAI8uC,EAAE9uC,EAAEywB,WAAW,OAAOqe,GAAG5Y,GAAG4Y,EAAE,CAAC,CAAC,CAAC,MAC5c,QAAQ,MAAM/oB,MAAMxD,EAAE,MAAOi7B,IAAW,IAARh7B,EAAE9lB,OAAWuhD,GAAGz7B,EAAE,CAAC,MAAMusB,GAAG6O,GAAEp7B,EAAEA,EAAE8N,OAAOye,EAAE,CAAC,CAAC,GAAGvsB,IAAI7hB,EAAE,CAAC1B,GAAE,KAAK,KAAK,CAAa,GAAG,QAAfshB,EAAEiC,EAAEqO,SAAoB,CAACtQ,EAAE+P,OAAO9N,EAAE8N,OAAOrxB,GAAEshB,EAAE,KAAK,CAACthB,GAAEujB,EAAE8N,MAAM,CAAC,CAAC,SAASgvB,GAAG3+C,GAAG,KAAK,OAAO1B,IAAG,CAAC,IAAIujB,EAAEvjB,GAAE,GAAGujB,IAAI7hB,EAAE,CAAC1B,GAAE,KAAK,KAAK,CAAC,IAAIshB,EAAEiC,EAAEqO,QAAQ,GAAG,OAAOtQ,EAAE,CAACA,EAAE+P,OAAO9N,EAAE8N,OAAOrxB,GAAEshB,EAAE,KAAK,CAACthB,GAAEujB,EAAE8N,MAAM,CAAC,CACvS,SAASmvB,GAAG9+C,GAAG,KAAK,OAAO1B,IAAG,CAAC,IAAIujB,EAAEvjB,GAAE,IAAI,OAAOujB,EAAEtqB,KAAK,KAAK,EAAE,KAAK,GAAG,KAAK,GAAG,IAAIqoB,EAAEiC,EAAE8N,OAAO,IAAI0tB,GAAG,EAAEx7B,EAAE,CAAC,MAAM6D,GAAGu3B,GAAEp7B,EAAEjC,EAAE8F,EAAE,CAAC,MAAM,KAAK,EAAE,IAAIjD,EAAEZ,EAAEuM,UAAU,GAAG,oBAAoB3L,EAAE0tB,kBAAkB,CAAC,IAAIp+B,EAAE8P,EAAE8N,OAAO,IAAIlN,EAAE0tB,mBAAmB,CAAC,MAAMzqB,GAAGu3B,GAAEp7B,EAAE9P,EAAE2T,EAAE,CAAC,CAAC,IAAIvtB,EAAE0pB,EAAE8N,OAAO,IAAI2tB,GAAGz7B,EAAE,CAAC,MAAM6D,GAAGu3B,GAAEp7B,EAAE1pB,EAAEutB,EAAE,CAAC,MAAM,KAAK,EAAE,IAAIhD,EAAEb,EAAE8N,OAAO,IAAI2tB,GAAGz7B,EAAE,CAAC,MAAM6D,GAAGu3B,GAAEp7B,EAAEa,EAAEgD,EAAE,EAAE,CAAC,MAAMA,GAAGu3B,GAAEp7B,EAAEA,EAAE8N,OAAOjK,EAAE,CAAC,GAAG7D,IAAI7hB,EAAE,CAAC1B,GAAE,KAAK,KAAK,CAAC,IAAImnB,EAAE5D,EAAEqO,QAAQ,GAAG,OAAOzK,EAAE,CAACA,EAAEkK,OAAO9N,EAAE8N,OAAOrxB,GAAEmnB,EAAE,KAAK,CAACnnB,GAAEujB,EAAE8N,MAAM,CAAC,CAC7d,IAwBkNsvB,GAxB9MC,GAAGvgD,KAAK0E,KAAK87C,GAAGp7B,EAAGquB,uBAAuBgN,GAAGr7B,EAAG00B,kBAAkB4G,GAAGt7B,EAAG0R,wBAAwBsY,GAAE,EAAE5mC,GAAE,KAAKm4C,GAAE,KAAKC,GAAE,EAAEhG,GAAG,EAAED,GAAGzR,GAAG,GAAG2U,GAAE,EAAEgD,GAAG,KAAKlR,GAAG,EAAEmR,GAAG,EAAEC,GAAG,EAAEC,GAAG,KAAKC,GAAG,KAAKlB,GAAG,EAAEjC,GAAGoD,IAASC,GAAG,KAAKlI,IAAG,EAAGC,GAAG,KAAKI,GAAG,KAAK8H,IAAG,EAAGC,GAAG,KAAKC,GAAG,EAAEC,GAAG,EAAEC,GAAG,KAAKC,IAAI,EAAEC,GAAG,EAAE,SAASrR,KAAI,OAAO,KAAO,EAAFjB,IAAKld,MAAK,IAAIuvB,GAAGA,GAAGA,GAAGvvB,IAAG,CAChU,SAASoe,GAAGjvC,GAAG,OAAG,KAAY,EAAPA,EAAEmJ,MAAe,EAAK,KAAO,EAAF4kC,KAAM,IAAIwR,GAASA,IAAGA,GAAK,OAAO/T,GAAG5V,YAAkB,IAAIyqB,KAAKA,GAAGvtB,MAAMutB,IAAU,KAAPrgD,EAAErJ,IAAkBqJ,EAAiBA,OAAE,KAAjBA,EAAEJ,OAAOgO,OAAmB,GAAGsoB,GAAGl2B,EAAEqB,KAAc,CAAC,SAAS6tC,GAAGlvC,EAAE6hB,EAAEjC,EAAE6C,GAAG,GAAG,GAAGy9B,GAAG,MAAMA,GAAG,EAAEC,GAAG,KAAK/6B,MAAMxD,EAAE,MAAMoR,GAAGhzB,EAAE4f,EAAE6C,GAAM,KAAO,EAAFsrB,KAAM/tC,IAAImH,KAAEnH,IAAImH,KAAI,KAAO,EAAF4mC,MAAO0R,IAAI7/B,GAAG,IAAI48B,IAAG8D,GAAGtgD,EAAEu/C,KAAIgB,GAAGvgD,EAAEyiB,GAAG,IAAI7C,GAAG,IAAImuB,IAAG,KAAY,EAAPlsB,EAAE1Y,QAAUszC,GAAG5rB,KAAI,IAAIqY,IAAIG,MAAK,CAC1Y,SAASkX,GAAGvgD,EAAE6hB,GAAG,IAAIjC,EAAE5f,EAAEwgD,cA5MzB,SAAYxgD,EAAE6hB,GAAG,IAAI,IAAIjC,EAAE5f,EAAEwyB,eAAe/P,EAAEziB,EAAEyyB,YAAY1gB,EAAE/R,EAAEygD,gBAAgBtoD,EAAE6H,EAAEuyB,aAAa,EAAEp6B,GAAG,CAAC,IAAIuqB,EAAE,GAAGmP,GAAG15B,GAAGstB,EAAE,GAAG/C,EAAEgD,EAAE3T,EAAE2Q,IAAO,IAAIgD,EAAM,KAAKD,EAAE7F,IAAI,KAAK6F,EAAEhD,KAAG1Q,EAAE2Q,GAAGkQ,GAAGnN,EAAE5D,IAAQ6D,GAAG7D,IAAI7hB,EAAE0gD,cAAcj7B,GAAGttB,IAAIstB,CAAC,CAAC,CA4MnLk7B,CAAG3gD,EAAE6hB,GAAG,IAAIY,EAAE6P,GAAGtyB,EAAEA,IAAImH,GAAEo4C,GAAE,GAAG,GAAG,IAAI98B,EAAE,OAAO7C,GAAG2Q,GAAG3Q,GAAG5f,EAAEwgD,aAAa,KAAKxgD,EAAE4gD,iBAAiB,OAAO,GAAG/+B,EAAEY,GAAGA,EAAEziB,EAAE4gD,mBAAmB/+B,EAAE,CAAgB,GAAf,MAAMjC,GAAG2Q,GAAG3Q,GAAM,IAAIiC,EAAE,IAAI7hB,EAAEzI,IA7IsJ,SAAYyI,GAAGkpC,IAAG,EAAGE,GAAGppC,EAAE,CA6I5K6gD,CAAGC,GAAGnkD,KAAK,KAAKqD,IAAIopC,GAAG0X,GAAGnkD,KAAK,KAAKqD,IAAI6mC,IAAG,WAAW,KAAO,EAAFkH,KAAM1E,IAAI,IAAGzpB,EAAE,SAAS,CAAC,OAAOuT,GAAG1Q,IAAI,KAAK,EAAE7C,EAAEqR,GAAG,MAAM,KAAK,EAAErR,EAAEuR,GAAG,MAAM,KAAK,GAAwC,QAAQvR,EAAEyR,SAApC,KAAK,UAAUzR,EAAE6R,GAAsB7R,EAAEmhC,GAAGnhC,EAAEohC,GAAGrkD,KAAK,KAAKqD,GAAG,CAACA,EAAE4gD,iBAAiB/+B,EAAE7hB,EAAEwgD,aAAa5gC,CAAC,CAAC,CAC7c,SAASohC,GAAGhhD,EAAE6hB,GAAc,GAAXu+B,IAAI,EAAEC,GAAG,EAAK,KAAO,EAAFtS,IAAK,MAAM3oB,MAAMxD,EAAE,MAAM,IAAIhC,EAAE5f,EAAEwgD,aAAa,GAAGS,MAAMjhD,EAAEwgD,eAAe5gC,EAAE,OAAO,KAAK,IAAI6C,EAAE6P,GAAGtyB,EAAEA,IAAImH,GAAEo4C,GAAE,GAAG,GAAG,IAAI98B,EAAE,OAAO,KAAK,GAAG,KAAO,GAAFA,IAAO,KAAKA,EAAEziB,EAAE0gD,eAAe7+B,EAAEA,EAAEq/B,GAAGlhD,EAAEyiB,OAAO,CAACZ,EAAEY,EAAE,IAAI1Q,EAAEg8B,GAAEA,IAAG,EAAE,IAAI51C,EAAEgpD,KAAgD,IAAxCh6C,KAAInH,GAAGu/C,KAAI19B,IAAEi+B,GAAG,KAAKrD,GAAG5rB,KAAI,IAAIuwB,GAAGphD,EAAE6hB,UAAUw/B,KAAK,KAAK,CAAC,MAAM57B,GAAG67B,GAAGthD,EAAEylB,EAAE,CAAUsmB,KAAKoT,GAAG/4C,QAAQjO,EAAE41C,GAAEh8B,EAAE,OAAOutC,GAAEz9B,EAAE,GAAG1a,GAAE,KAAKo4C,GAAE,EAAE19B,EAAE26B,GAAE,CAAC,GAAG,IAAI36B,EAAE,CAAyC,GAAxC,IAAIA,IAAY,KAAR9P,EAAE8gB,GAAG7yB,MAAWyiB,EAAE1Q,EAAE8P,EAAE0/B,GAAGvhD,EAAE+R,KAAQ,IAAI8P,EAAE,MAAMjC,EAAE4/B,GAAG4B,GAAGphD,EAAE,GAAGsgD,GAAGtgD,EAAEyiB,GAAG89B,GAAGvgD,EAAE6wB,MAAKjR,EAAE,GAAG,IAAIiC,EAAEy+B,GAAGtgD,EAAEyiB,OAChf,CAAuB,GAAtB1Q,EAAE/R,EAAEoG,QAAQspB,UAAa,KAAO,GAAFjN,KAGnC,SAAYziB,GAAG,IAAI,IAAI6hB,EAAE7hB,IAAI,CAAC,GAAW,MAAR6hB,EAAE9lB,MAAY,CAAC,IAAI6jB,EAAEiC,EAAEsrB,YAAY,GAAG,OAAOvtB,GAAe,QAAXA,EAAEA,EAAE60B,QAAiB,IAAI,IAAIhyB,EAAE,EAAEA,EAAE7C,EAAEtsB,OAAOmvB,IAAI,CAAC,IAAI1Q,EAAE6N,EAAE6C,GAAGtqB,EAAE4Z,EAAEqiC,YAAYriC,EAAEA,EAAE1c,MAAM,IAAI,IAAIirC,GAAGnoC,IAAI4Z,GAAG,OAAM,CAAE,CAAC,MAAM2Q,GAAG,OAAM,CAAE,CAAC,CAAC,CAAW,GAAV9C,EAAEiC,EAAEoO,MAAwB,MAAfpO,EAAEs5B,cAAoB,OAAOv7B,EAAEA,EAAE+P,OAAO9N,EAAEA,EAAEjC,MAAM,CAAC,GAAGiC,IAAI7hB,EAAE,MAAM,KAAK,OAAO6hB,EAAEqO,SAAS,CAAC,GAAG,OAAOrO,EAAE8N,QAAQ9N,EAAE8N,SAAS3vB,EAAE,OAAM,EAAG6hB,EAAEA,EAAE8N,MAAM,CAAC9N,EAAEqO,QAAQP,OAAO9N,EAAE8N,OAAO9N,EAAEA,EAAEqO,OAAO,CAAC,CAAC,OAAM,CAAE,CAHvXsxB,CAAGzvC,KAAe,KAAV8P,EAAEq/B,GAAGlhD,EAAEyiB,MAAmB,KAARtqB,EAAE06B,GAAG7yB,MAAWyiB,EAAEtqB,EAAE0pB,EAAE0/B,GAAGvhD,EAAE7H,KAAK,IAAI0pB,GAAG,MAAMjC,EAAE4/B,GAAG4B,GAAGphD,EAAE,GAAGsgD,GAAGtgD,EAAEyiB,GAAG89B,GAAGvgD,EAAE6wB,MAAKjR,EAAqC,OAAnC5f,EAAEyhD,aAAa1vC,EAAE/R,EAAE0hD,cAAcj/B,EAASZ,GAAG,KAAK,EAAE,KAAK,EAAE,MAAMuD,MAAMxD,EAAE,MAAM,KAAK,EAC8B,KAAK,EAAE+/B,GAAG3hD,EAAE4/C,GAAGE,IAAI,MAD7B,KAAK,EAAU,GAARQ,GAAGtgD,EAAEyiB,IAAS,UAAFA,KAAeA,GAAiB,IAAbZ,EAAE68B,GAAG,IAAI7tB,MAAU,CAAC,GAAG,IAAIyB,GAAGtyB,EAAE,GAAG,MAAyB,KAAnB+R,EAAE/R,EAAEwyB,gBAAqB/P,KAAKA,EAAE,CAACusB,KAAIhvC,EAAEyyB,aAAazyB,EAAEwyB,eAAezgB,EAAE,KAAK,CAAC/R,EAAE4hD,cAAclb,GAAGib,GAAGhlD,KAAK,KAAKqD,EAAE4/C,GAAGE,IAAIj+B,GAAG,KAAK,CAAC8/B,GAAG3hD,EAAE4/C,GAAGE,IAAI,MAAM,KAAK,EAAU,GAARQ,GAAGtgD,EAAEyiB,IAAS,QAAFA,KAC9eA,EAAE,MAAqB,IAAfZ,EAAE7hB,EAAEizB,WAAelhB,GAAG,EAAE,EAAE0Q,GAAG,CAAC,IAAIC,EAAE,GAAGmP,GAAGpP,GAAGtqB,EAAE,GAAGuqB,GAAEA,EAAEb,EAAEa,IAAK3Q,IAAIA,EAAE2Q,GAAGD,IAAItqB,CAAC,CAAqG,GAApGsqB,EAAE1Q,EAAqG,IAA3F0Q,GAAG,KAAXA,EAAEoO,KAAIpO,GAAW,IAAI,IAAIA,EAAE,IAAI,KAAKA,EAAE,KAAK,KAAKA,EAAE,KAAK,IAAIA,EAAE,IAAI,KAAKA,EAAE,KAAK,KAAKy8B,GAAGz8B,EAAE,OAAOA,GAAU,CAACziB,EAAE4hD,cAAclb,GAAGib,GAAGhlD,KAAK,KAAKqD,EAAE4/C,GAAGE,IAAIr9B,GAAG,KAAK,CAACk/B,GAAG3hD,EAAE4/C,GAAGE,IAAI,MAA+B,QAAQ,MAAM16B,MAAMxD,EAAE,MAAO,CAAC,CAAW,OAAV2+B,GAAGvgD,EAAE6wB,MAAY7wB,EAAEwgD,eAAe5gC,EAAEohC,GAAGrkD,KAAK,KAAKqD,GAAG,IAAI,CACrX,SAASuhD,GAAGvhD,EAAE6hB,GAAG,IAAIjC,EAAE+/B,GAA2G,OAAxG3/C,EAAEoG,QAAQypB,cAAciF,eAAessB,GAAGphD,EAAE6hB,GAAG9lB,OAAO,KAAe,KAAViE,EAAEkhD,GAAGlhD,EAAE6hB,MAAWA,EAAE+9B,GAAGA,GAAGhgC,EAAE,OAAOiC,GAAGk6B,GAAGl6B,IAAW7hB,CAAC,CAAC,SAAS+7C,GAAG/7C,GAAG,OAAO4/C,GAAGA,GAAG5/C,EAAE4/C,GAAGnsD,KAAKI,MAAM+rD,GAAG5/C,EAAE,CAE5L,SAASsgD,GAAGtgD,EAAE6hB,GAAuD,IAApDA,IAAI69B,GAAG79B,IAAI49B,GAAGz/C,EAAEwyB,gBAAgB3Q,EAAE7hB,EAAEyyB,cAAc5Q,EAAM7hB,EAAEA,EAAEygD,gBAAgB,EAAE5+B,GAAG,CAAC,IAAIjC,EAAE,GAAGiS,GAAGhQ,GAAGY,EAAE,GAAG7C,EAAE5f,EAAE4f,IAAI,EAAEiC,IAAIY,CAAC,CAAC,CAAC,SAASq+B,GAAG9gD,GAAG,GAAG,KAAO,EAAF+tC,IAAK,MAAM3oB,MAAMxD,EAAE,MAAMq/B,KAAK,IAAIp/B,EAAEyQ,GAAGtyB,EAAE,GAAG,GAAG,KAAO,EAAF6hB,GAAK,OAAO0+B,GAAGvgD,EAAE6wB,MAAK,KAAK,IAAIjR,EAAEshC,GAAGlhD,EAAE6hB,GAAG,GAAG,IAAI7hB,EAAEzI,KAAK,IAAIqoB,EAAE,CAAC,IAAI6C,EAAEoQ,GAAG7yB,GAAG,IAAIyiB,IAAIZ,EAAEY,EAAE7C,EAAE2hC,GAAGvhD,EAAEyiB,GAAG,CAAC,GAAG,IAAI7C,EAAE,MAAMA,EAAE4/B,GAAG4B,GAAGphD,EAAE,GAAGsgD,GAAGtgD,EAAE6hB,GAAG0+B,GAAGvgD,EAAE6wB,MAAKjR,EAAE,GAAG,IAAIA,EAAE,MAAMwF,MAAMxD,EAAE,MAAiF,OAA3E5hB,EAAEyhD,aAAazhD,EAAEoG,QAAQspB,UAAU1vB,EAAE0hD,cAAc7/B,EAAE8/B,GAAG3hD,EAAE4/C,GAAGE,IAAIS,GAAGvgD,EAAE6wB,MAAY,IAAI,CACvd,SAASgxB,GAAG7hD,EAAE6hB,GAAG,IAAIjC,EAAEmuB,GAAEA,IAAG,EAAE,IAAI,OAAO/tC,EAAE6hB,EAAE,CAAC,QAAY,KAAJksB,GAAEnuB,KAAU68B,GAAG5rB,KAAI,IAAIqY,IAAIG,KAAK,CAAC,CAAC,SAASyY,GAAG9hD,GAAG,OAAOggD,IAAI,IAAIA,GAAGzoD,KAAK,KAAO,EAAFw2C,KAAMkT,KAAK,IAAIp/B,EAAEksB,GAAEA,IAAG,EAAE,IAAInuB,EAAEy/B,GAAGzpB,WAAWnT,EAAE9rB,GAAE,IAAI,GAAG0oD,GAAGzpB,WAAW,KAAKj/B,GAAE,EAAEqJ,EAAE,OAAOA,GAAG,CAAC,QAAQrJ,GAAE8rB,EAAE48B,GAAGzpB,WAAWhW,EAAM,KAAO,GAAXmuB,GAAElsB,KAAawnB,IAAI,CAAC,CAAC,SAASqT,KAAKnD,GAAGD,GAAGlzC,QAAQ0hC,GAAEwR,GAAG,CAChT,SAAS8H,GAAGphD,EAAE6hB,GAAG7hB,EAAEyhD,aAAa,KAAKzhD,EAAE0hD,cAAc,EAAE,IAAI9hC,EAAE5f,EAAE4hD,cAAiD,IAAlC,IAAIhiC,IAAI5f,EAAE4hD,eAAe,EAAEjb,GAAG/mB,IAAO,OAAO0/B,GAAE,IAAI1/B,EAAE0/B,GAAE3vB,OAAO,OAAO/P,GAAG,CAAC,IAAI6C,EAAE7C,EAAQ,OAANsqB,GAAGznB,GAAUA,EAAElrB,KAAK,KAAK,EAA6B,QAA3BkrB,EAAEA,EAAEphB,KAAKonC,yBAA4B,IAAShmB,GAAGimB,KAAK,MAAM,KAAK,EAAEgJ,KAAK5J,GAAEI,IAAIJ,GAAEG,IAAGgK,KAAK,MAAM,KAAK,EAAEL,GAAGnvB,GAAG,MAAM,KAAK,EAAEivB,KAAK,MAAM,KAAK,GAAc,KAAK,GAAG5J,GAAE+J,IAAG,MAAM,KAAK,GAAG7F,GAAGvpB,EAAEphB,KAAK2kB,UAAU,MAAM,KAAK,GAAG,KAAK,GAAG02B,KAAK98B,EAAEA,EAAE+P,MAAM,CAAqE,GAApExoB,GAAEnH,EAAEs/C,GAAEt/C,EAAE2wC,GAAG3wC,EAAEoG,QAAQ,MAAMm5C,GAAEhG,GAAG13B,EAAE26B,GAAE,EAAEgD,GAAG,KAAKE,GAAGD,GAAGnR,GAAG,EAAEsR,GAAGD,GAAG,KAAQ,OAAO/S,GAAG,CAAC,IAAI/qB,EAC1f,EAAEA,EAAE+qB,GAAGt5C,OAAOuuB,IAAI,GAA2B,QAAhBY,GAAR7C,EAAEgtB,GAAG/qB,IAAOkrB,aAAqB,CAACntB,EAAEmtB,YAAY,KAAK,IAAIh7B,EAAE0Q,EAAEkqB,KAAKx0C,EAAEynB,EAAE2tB,QAAQ,GAAG,OAAOp1C,EAAE,CAAC,IAAIuqB,EAAEvqB,EAAEw0C,KAAKx0C,EAAEw0C,KAAK56B,EAAE0Q,EAAEkqB,KAAKjqB,CAAC,CAAC9C,EAAE2tB,QAAQ9qB,CAAC,CAACmqB,GAAG,IAAI,CAAC,OAAO5sC,CAAC,CAC3K,SAASshD,GAAGthD,EAAE6hB,GAAG,OAAE,CAAC,IAAIjC,EAAE0/B,GAAE,IAAuB,GAAnBvT,KAAKoG,GAAG/rC,QAAQ8sC,GAAMV,GAAG,CAAC,IAAI,IAAI/vB,EAAE8vB,GAAE1iB,cAAc,OAAOpN,GAAG,CAAC,IAAI1Q,EAAE0Q,EAAE6wB,MAAM,OAAOvhC,IAAIA,EAAEw7B,QAAQ,MAAM9qB,EAAEA,EAAEkqB,IAAI,CAAC6F,IAAG,CAAE,CAA4C,GAA3CF,GAAG,EAAE/zC,GAAElI,GAAEk8C,GAAE,KAAKE,IAAG,EAAGC,GAAG,EAAE0M,GAAGh5C,QAAQ,KAAQ,OAAOwZ,GAAG,OAAOA,EAAE+P,OAAO,CAAC6sB,GAAE,EAAEgD,GAAG39B,EAAEy9B,GAAE,KAAK,KAAK,CAACt/C,EAAE,CAAC,IAAI7H,EAAE6H,EAAE0iB,EAAE9C,EAAE+P,OAAOlK,EAAE7F,EAAE8F,EAAE7D,EAAqB,GAAnBA,EAAE09B,GAAE95B,EAAE1pB,OAAO,MAAS,OAAO2pB,GAAG,kBAAkBA,GAAG,oBAAoBA,EAAEqhB,KAAK,CAAC,IAAIv4B,EAAEkX,EAAErmB,EAAEomB,EAAE0oB,EAAE9uC,EAAE9H,IAAI,GAAG,KAAY,EAAP8H,EAAE8J,QAAU,IAAIglC,GAAG,KAAKA,GAAG,KAAKA,GAAG,CAAC,IAAIC,EAAE/uC,EAAEqwB,UAAU0e,GAAG/uC,EAAE8tC,YAAYiB,EAAEjB,YAAY9tC,EAAEwwB,cAAcue,EAAEve,cACxexwB,EAAEktC,MAAM6B,EAAE7B,QAAQltC,EAAE8tC,YAAY,KAAK9tC,EAAEwwB,cAAc,KAAK,CAAC,IAAIwe,EAAEiK,GAAG51B,GAAG,GAAG,OAAO2rB,EAAE,CAACA,EAAEtyC,QAAQ,IAAIw8C,GAAGlK,EAAE3rB,EAAE+C,EAAEttB,EAAE0pB,GAAU,EAAPwsB,EAAEllC,MAAQgvC,GAAGhgD,EAAEqW,EAAEqT,GAAO6D,EAAElX,EAAE,IAAI/O,GAAZoiB,EAAEwsB,GAAclB,YAAY,GAAG,OAAO1tC,EAAE,CAAC,IAAIylC,EAAE,IAAInxB,IAAImxB,EAAEhwB,IAAIwQ,GAAG7D,EAAEsrB,YAAYjI,CAAC,MAAMzlC,EAAEyV,IAAIwQ,GAAG,MAAM1lB,CAAC,CAAM,GAAG,KAAO,EAAF6hB,GAAK,CAACs2B,GAAGhgD,EAAEqW,EAAEqT,GAAGk5B,KAAK,MAAM/6C,CAAC,CAAC0lB,EAAEN,MAAMxD,EAAE,KAAM,MAAM,GAAGyoB,IAAU,EAAP5kB,EAAEtc,KAAO,CAAC,IAAIg8B,EAAEmT,GAAG51B,GAAG,GAAG,OAAOyiB,EAAE,CAAC,KAAa,MAARA,EAAEppC,SAAeopC,EAAEppC,OAAO,KAAKw8C,GAAGpT,EAAEziB,EAAE+C,EAAEttB,EAAE0pB,GAAG0pB,GAAG8L,GAAG3xB,EAAED,IAAI,MAAMzlB,CAAC,CAAC,CAAC7H,EAAEutB,EAAE2xB,GAAG3xB,EAAED,GAAG,IAAI+2B,KAAIA,GAAE,GAAG,OAAOmD,GAAGA,GAAG,CAACxnD,GAAGwnD,GAAGlsD,KAAK0E,GAAGA,EAAEuqB,EAAE,EAAE,CAAC,OAAOvqB,EAAEZ,KAAK,KAAK,EAAEY,EAAE4D,OAAO,MACpf8lB,IAAIA,EAAE1pB,EAAEo0C,OAAO1qB,EAAkBosB,GAAG91C,EAAbw/C,GAAGx/C,EAAEutB,EAAE7D,IAAW,MAAM7hB,EAAE,KAAK,EAAEylB,EAAEC,EAAE,IAAI1E,EAAE7oB,EAAEkJ,KAAK+jC,EAAEjtC,EAAEi2B,UAAU,GAAG,KAAa,IAARj2B,EAAE4D,SAAa,oBAAoBilB,EAAE+2B,0BAA0B,OAAO3S,GAAG,oBAAoBA,EAAE4S,oBAAoB,OAAOC,KAAKA,GAAG13C,IAAI6kC,KAAK,CAACjtC,EAAE4D,OAAO,MAAM8lB,IAAIA,EAAE1pB,EAAEo0C,OAAO1qB,EAAkBosB,GAAG91C,EAAb2/C,GAAG3/C,EAAEstB,EAAE5D,IAAW,MAAM7hB,CAAC,EAAE7H,EAAEA,EAAEw3B,MAAM,OAAO,OAAOx3B,EAAE,CAAC4pD,GAAGniC,EAAE,CAAC,MAAM6lB,GAAI5jB,EAAE4jB,EAAG6Z,KAAI1/B,GAAG,OAAOA,IAAI0/B,GAAE1/B,EAAEA,EAAE+P,QAAQ,QAAQ,CAAC,KAAK,CAAS,CAAC,SAASwxB,KAAK,IAAInhD,EAAEm/C,GAAG/4C,QAAsB,OAAd+4C,GAAG/4C,QAAQ8sC,GAAU,OAAOlzC,EAAEkzC,GAAGlzC,CAAC,CACrd,SAAS+6C,KAAQ,IAAIyB,IAAG,IAAIA,IAAG,IAAIA,KAAEA,GAAE,GAAE,OAAOr1C,IAAG,KAAQ,UAAHmnC,KAAe,KAAQ,UAAHmR,KAAea,GAAGn5C,GAAEo4C,GAAE,CAAC,SAAS2B,GAAGlhD,EAAE6hB,GAAG,IAAIjC,EAAEmuB,GAAEA,IAAG,EAAE,IAAItrB,EAAE0+B,KAAqC,IAA7Bh6C,KAAInH,GAAGu/C,KAAI19B,IAAEi+B,GAAG,KAAKsB,GAAGphD,EAAE6hB,UAAUmgC,KAAK,KAAK,CAAC,MAAMjwC,GAAGuvC,GAAGthD,EAAE+R,EAAE,CAAgC,GAAtBg6B,KAAKgC,GAAEnuB,EAAEu/B,GAAG/4C,QAAQqc,EAAK,OAAO68B,GAAE,MAAMl6B,MAAMxD,EAAE,MAAiB,OAAXza,GAAE,KAAKo4C,GAAE,EAAS/C,EAAC,CAAC,SAASwF,KAAK,KAAK,OAAO1C,IAAG2C,GAAG3C,GAAE,CAAC,SAAS+B,KAAK,KAAK,OAAO/B,KAAI7uB,MAAMwxB,GAAG3C,GAAE,CAAC,SAAS2C,GAAGjiD,GAAG,IAAI6hB,EAAEo9B,GAAGj/C,EAAE0vB,UAAU1vB,EAAEu5C,IAAIv5C,EAAEorC,cAAcprC,EAAE4qC,aAAa,OAAO/oB,EAAEkgC,GAAG/hD,GAAGs/C,GAAEz9B,EAAEu9B,GAAGh5C,QAAQ,IAAI,CAC1d,SAAS27C,GAAG/hD,GAAG,IAAI6hB,EAAE7hB,EAAE,EAAE,CAAC,IAAI4f,EAAEiC,EAAE6N,UAAqB,GAAX1vB,EAAE6hB,EAAE8N,OAAU,KAAa,MAAR9N,EAAE9lB,QAAc,GAAgB,QAAb6jB,EAAEk8B,GAAGl8B,EAAEiC,EAAE03B,KAAkB,YAAJ+F,GAAE1/B,OAAc,CAAW,GAAG,QAAbA,EAAE+8B,GAAG/8B,EAAEiC,IAAmC,OAAnBjC,EAAE7jB,OAAO,WAAMujD,GAAE1/B,GAAS,GAAG,OAAO5f,EAAmE,OAAXw8C,GAAE,OAAE8C,GAAE,MAA5Dt/C,EAAEjE,OAAO,MAAMiE,EAAEm7C,aAAa,EAAEn7C,EAAE0qC,UAAU,IAA4B,CAAa,GAAG,QAAf7oB,EAAEA,EAAEqO,SAAyB,YAAJovB,GAAEz9B,GAASy9B,GAAEz9B,EAAE7hB,CAAC,OAAO,OAAO6hB,GAAG,IAAI26B,KAAIA,GAAE,EAAE,CAAC,SAASmF,GAAG3hD,EAAE6hB,EAAEjC,GAAG,IAAI6C,EAAE9rB,GAAEob,EAAEstC,GAAGzpB,WAAW,IAAIypB,GAAGzpB,WAAW,KAAKj/B,GAAE,EAC3Y,SAAYqJ,EAAE6hB,EAAEjC,EAAE6C,GAAG,GAAGw+B,WAAW,OAAOjB,IAAI,GAAG,KAAO,EAAFjS,IAAK,MAAM3oB,MAAMxD,EAAE,MAAMhC,EAAE5f,EAAEyhD,aAAa,IAAI1vC,EAAE/R,EAAE0hD,cAAc,GAAG,OAAO9hC,EAAE,OAAO,KAA2C,GAAtC5f,EAAEyhD,aAAa,KAAKzhD,EAAE0hD,cAAc,EAAK9hC,IAAI5f,EAAEoG,QAAQ,MAAMgf,MAAMxD,EAAE,MAAM5hB,EAAEwgD,aAAa,KAAKxgD,EAAE4gD,iBAAiB,EAAE,IAAIzoD,EAAEynB,EAAE2sB,MAAM3sB,EAAEusB,WAA8J,GA1NtT,SAAYnsC,EAAE6hB,GAAG,IAAIjC,EAAE5f,EAAEuyB,cAAc1Q,EAAE7hB,EAAEuyB,aAAa1Q,EAAE7hB,EAAEwyB,eAAe,EAAExyB,EAAEyyB,YAAY,EAAEzyB,EAAE0gD,cAAc7+B,EAAE7hB,EAAEkiD,kBAAkBrgC,EAAE7hB,EAAE0yB,gBAAgB7Q,EAAEA,EAAE7hB,EAAE2yB,cAAc,IAAIlQ,EAAEziB,EAAEizB,WAAW,IAAIjzB,EAAEA,EAAEygD,gBAAgB,EAAE7gC,GAAG,CAAC,IAAI7N,EAAE,GAAG8f,GAAGjS,GAAGznB,EAAE,GAAG4Z,EAAE8P,EAAE9P,GAAG,EAAE0Q,EAAE1Q,IAAI,EAAE/R,EAAE+R,IAAI,EAAE6N,IAAIznB,CAAC,CAAC,CA0N5GgqD,CAAGniD,EAAE7H,GAAG6H,IAAImH,KAAIm4C,GAAEn4C,GAAE,KAAKo4C,GAAE,GAAG,KAAoB,KAAf3/B,EAAEu7B,eAAoB,KAAa,KAARv7B,EAAE7jB,QAAagkD,KAAKA,IAAG,EAAGgB,GAAG1vB,IAAG,WAAgB,OAAL4vB,KAAY,IAAI,KAAI9oD,EAAE,KAAa,MAARynB,EAAE7jB,OAAgB,KAAoB,MAAf6jB,EAAEu7B,eAAqBhjD,EAAE,CAACA,EAAEknD,GAAGzpB,WAAWypB,GAAGzpB,WAAW,KAChf,IAAIlT,EAAE/rB,GAAEA,GAAE,EAAE,IAAI8uB,EAAEsoB,GAAEA,IAAG,EAAEqR,GAAGh5C,QAAQ,KA1CpC,SAAYpG,EAAE6hB,GAAgB,GAAbykB,GAAG5Q,GAAawL,GAAVlhC,EAAE+gC,MAAc,CAAC,GAAG,mBAAmB/gC,EAAE,IAAI4f,EAAE,CAAC7iB,MAAMiD,EAAEyhC,eAAeD,IAAIxhC,EAAE0hC,mBAAmB1hC,EAAE,CAA8C,IAAIyiB,GAAjD7C,GAAGA,EAAE5f,EAAE6nB,gBAAgBjI,EAAE+hB,aAAa/hC,QAAegiC,cAAchiB,EAAEgiB,eAAe,GAAGnf,GAAG,IAAIA,EAAEqf,WAAW,CAACliB,EAAE6C,EAAEsf,WAAW,IAAIhwB,EAAE0Q,EAAEuf,aAAa7pC,EAAEsqB,EAAEwf,UAAUxf,EAAEA,EAAEyf,YAAY,IAAItiB,EAAEnO,SAAStZ,EAAEsZ,QAAQ,CAAC,MAAMnM,GAAGsa,EAAE,KAAK,MAAM5f,CAAC,CAAC,IAAI0iB,EAAE,EAAE+C,GAAG,EAAEC,GAAG,EAAElX,EAAE,EAAEnP,EAAE,EAAE8uC,EAAEnuC,EAAEouC,EAAE,KAAKvsB,EAAE,OAAO,CAAC,IAAI,IAAIwsB,EAAKF,IAAIvuB,GAAG,IAAI7N,GAAG,IAAIo8B,EAAE18B,WAAWgU,EAAE/C,EAAE3Q,GAAGo8B,IAAIh2C,GAAG,IAAIsqB,GAAG,IAAI0rB,EAAE18B,WAAWiU,EAAEhD,EAAED,GAAG,IAAI0rB,EAAE18B,WAAWiR,GACnfyrB,EAAE7kB,UAAUh2B,QAAW,QAAQ+6C,EAAEF,EAAEnlB,aAAkBolB,EAAED,EAAEA,EAAEE,EAAE,OAAO,CAAC,GAAGF,IAAInuC,EAAE,MAAM6hB,EAA8C,GAA5CusB,IAAIxuB,KAAKpR,IAAIuD,IAAI0T,EAAE/C,GAAG0rB,IAAIj2C,KAAKkH,IAAIojB,IAAIiD,EAAEhD,GAAM,QAAQ2rB,EAAEF,EAAExN,aAAa,MAAUyN,GAAJD,EAAEC,GAAMtgB,UAAU,CAACqgB,EAAEE,CAAC,CAACzuB,GAAG,IAAI6F,IAAI,IAAIC,EAAE,KAAK,CAAC3oB,MAAM0oB,EAAE+b,IAAI9b,EAAE,MAAM9F,EAAE,IAAI,CAACA,EAAEA,GAAG,CAAC7iB,MAAM,EAAEykC,IAAI,EAAE,MAAM5hB,EAAE,KAA+C,IAA1C2mB,GAAG,CAAClF,YAAYrhC,EAAEshC,eAAe1hB,GAAG8V,IAAG,EAAOp3B,GAAEujB,EAAE,OAAOvjB,IAAG,GAAO0B,GAAJ6hB,EAAEvjB,IAAM2xB,MAAM,KAAoB,KAAfpO,EAAEs5B,eAAoB,OAAOn7C,EAAEA,EAAE2vB,OAAO9N,EAAEvjB,GAAE0B,OAAO,KAAK,OAAO1B,IAAG,CAACujB,EAAEvjB,GAAE,IAAI,IAAImB,EAAEoiB,EAAE6N,UAAU,GAAG,KAAa,KAAR7N,EAAE9lB,OAAY,OAAO8lB,EAAEtqB,KAAK,KAAK,EAAE,KAAK,GAAG,KAAK,GACvK,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,GAAG,MAA3W,KAAK,EAAE,GAAG,OAAOkI,EAAE,CAAC,IAAIylC,EAAEzlC,EAAE2rC,cAAcjG,EAAE1lC,EAAEowB,cAActsB,EAAEse,EAAEuM,UAAUpN,EAAEzd,EAAEysC,wBAAwBnuB,EAAE4oB,cAAc5oB,EAAExgB,KAAK6jC,EAAEuG,GAAG5pB,EAAExgB,KAAK6jC,GAAGC,GAAG5hC,EAAEy7C,oCAAoCh+B,CAAC,CAAC,MAAM,KAAK,EAAE,IAAIokB,EAAEvjB,EAAEuM,UAAU2G,cAAc,IAAIqQ,EAAE3zB,SAAS2zB,EAAE3c,YAAY,GAAG,IAAI2c,EAAE3zB,UAAU2zB,EAAE7D,iBAAiB6D,EAAEnc,YAAYmc,EAAE7D,iBAAiB,MAAyC,QAAQ,MAAMnc,MAAMxD,EAAE,MAAO,CAAC,MAAMtc,GAAG23C,GAAEp7B,EAAEA,EAAE8N,OAAOrqB,EAAE,CAAa,GAAG,QAAftF,EAAE6hB,EAAEqO,SAAoB,CAAClwB,EAAE2vB,OAAO9N,EAAE8N,OAAOrxB,GAAE0B,EAAE,KAAK,CAAC1B,GAAEujB,EAAE8N,MAAM,CAAClwB,EAAE09C,GAAGA,IAAG,CAAW,CAwCldiF,CAAGpiD,EAAE4f,GAAG2+B,GAAG3+B,EAAE5f,GAAGohC,GAAGmF,IAAI7Q,KAAK4Q,GAAGC,GAAGD,GAAG,KAAKtmC,EAAEoG,QAAQwZ,EAAEg/B,GAAGh/B,EAAE5f,EAAE+R,GAAG4e,KAAKod,GAAEtoB,EAAE9uB,GAAE+rB,EAAE28B,GAAGzpB,WAAWz9B,CAAC,MAAM6H,EAAEoG,QAAQwZ,EAAsF,GAApFmgC,KAAKA,IAAG,EAAGC,GAAGhgD,EAAEigD,GAAGluC,GAAG5Z,EAAE6H,EAAEuyB,aAAa,IAAIp6B,IAAI8/C,GAAG,MAjOmJ,SAAYj4C,GAAG,GAAG4xB,IAAI,oBAAoBA,GAAGywB,kBAAkB,IAAIzwB,GAAGywB,kBAAkB1wB,GAAG3xB,OAAE,EAAO,OAAuB,IAAhBA,EAAEoG,QAAQrK,OAAW,CAAC,MAAM8lB,GAAG,CAAC,CAiOxRygC,CAAG1iC,EAAEwO,WAAamyB,GAAGvgD,EAAE6wB,MAAQ,OAAOhP,EAAE,IAAIY,EAAEziB,EAAEuiD,mBAAmB3iC,EAAE,EAAEA,EAAEiC,EAAEvuB,OAAOssB,IAAI7N,EAAE8P,EAAEjC,GAAG6C,EAAE1Q,EAAE1c,MAAM,CAAC6iD,eAAenmC,EAAE6E,MAAM0gC,OAAOvlC,EAAEulC,SAAS,GAAGM,GAAG,MAAMA,IAAG,EAAG53C,EAAE63C,GAAGA,GAAG,KAAK73C,EAAE,KAAQ,EAAHigD,KAAO,IAAIjgD,EAAEzI,KAAK0pD,KAAK9oD,EAAE6H,EAAEuyB,aAAa,KAAO,EAAFp6B,GAAK6H,IAAImgD,GAAGD,MAAMA,GAAG,EAAEC,GAAGngD,GAAGkgD,GAAG,EAAE7W,IAAgB,CAFxFmZ,CAAGxiD,EAAE6hB,EAAEjC,EAAE6C,EAAE,CAAC,QAAQ48B,GAAGzpB,WAAW7jB,EAAEpb,GAAE8rB,CAAC,CAAC,OAAO,IAAI,CAGhc,SAASw+B,KAAK,GAAG,OAAOjB,GAAG,CAAC,IAAIhgD,EAAEmzB,GAAG8sB,IAAIp+B,EAAEw9B,GAAGzpB,WAAWhW,EAAEjpB,GAAE,IAAmC,GAA/B0oD,GAAGzpB,WAAW,KAAKj/B,GAAE,GAAGqJ,EAAE,GAAGA,EAAK,OAAOggD,GAAG,IAAIv9B,GAAE,MAAO,CAAmB,GAAlBziB,EAAEggD,GAAGA,GAAG,KAAKC,GAAG,EAAK,KAAO,EAAFlS,IAAK,MAAM3oB,MAAMxD,EAAE,MAAM,IAAI7P,EAAEg8B,GAAO,IAALA,IAAG,EAAMzvC,GAAE0B,EAAEoG,QAAQ,OAAO9H,IAAG,CAAC,IAAInG,EAAEmG,GAAEokB,EAAEvqB,EAAE83B,MAAM,GAAG,KAAa,GAAR3xB,GAAEvC,OAAU,CAAC,IAAI0pB,EAAEttB,EAAEuyC,UAAU,GAAG,OAAOjlB,EAAE,CAAC,IAAI,IAAIC,EAAE,EAAEA,EAAED,EAAEnyB,OAAOoyB,IAAI,CAAC,IAAIlX,EAAEiX,EAAEC,GAAG,IAAIpnB,GAAEkQ,EAAE,OAAOlQ,IAAG,CAAC,IAAIe,EAAEf,GAAE,OAAOe,EAAE9H,KAAK,KAAK,EAAE,KAAK,GAAG,KAAK,GAAG6lD,GAAG,EAAE/9C,EAAElH,GAAG,IAAIg2C,EAAE9uC,EAAE4wB,MAAM,GAAG,OAAOke,EAAEA,EAAExe,OAAOtwB,EAAEf,GAAE6vC,OAAO,KAAK,OAAO7vC,IAAG,CAAK,IAAI8vC,GAAR/uC,EAAEf,IAAU4xB,QAAQme,EAAEhvC,EAAEswB,OAAa,GAAN4tB,GAAGl+C,GAAMA,IACnfmP,EAAE,CAAClQ,GAAE,KAAK,KAAK,CAAC,GAAG,OAAO8vC,EAAE,CAACA,EAAEze,OAAO0e,EAAE/vC,GAAE8vC,EAAE,KAAK,CAAC9vC,GAAE+vC,CAAC,CAAC,CAAC,CAAC,IAAI5uC,EAAEtH,EAAEu3B,UAAU,GAAG,OAAOjwB,EAAE,CAAC,IAAIylC,EAAEzlC,EAAEwwB,MAAM,GAAG,OAAOiV,EAAE,CAACzlC,EAAEwwB,MAAM,KAAK,EAAE,CAAC,IAAIkV,EAAED,EAAEhV,QAAQgV,EAAEhV,QAAQ,KAAKgV,EAAEC,CAAC,OAAO,OAAOD,EAAE,CAAC,CAAC5mC,GAAEnG,CAAC,CAAC,CAAC,GAAG,KAAoB,KAAfA,EAAEgjD,eAAoB,OAAOz4B,EAAEA,EAAEiN,OAAOx3B,EAAEmG,GAAEokB,OAAOb,EAAE,KAAK,OAAOvjB,IAAG,CAAK,GAAG,KAAa,MAApBnG,EAAEmG,IAAYvC,OAAY,OAAO5D,EAAEZ,KAAK,KAAK,EAAE,KAAK,GAAG,KAAK,GAAG6lD,GAAG,EAAEjlD,EAAEA,EAAEw3B,QAAQ,IAAIpsB,EAAEpL,EAAE+3B,QAAQ,GAAG,OAAO3sB,EAAE,CAACA,EAAEosB,OAAOx3B,EAAEw3B,OAAOrxB,GAAEiF,EAAE,MAAMse,CAAC,CAACvjB,GAAEnG,EAAEw3B,MAAM,CAAC,CAAC,IAAI3O,EAAEhhB,EAAEoG,QAAQ,IAAI9H,GAAE0iB,EAAE,OAAO1iB,IAAG,CAAK,IAAI8mC,GAAR1iB,EAAEpkB,IAAU2xB,MAAM,GAAG,KAAoB,KAAfvN,EAAEy4B,eAAoB,OAClf/V,EAAEA,EAAEzV,OAAOjN,EAAEpkB,GAAE8mC,OAAOvjB,EAAE,IAAIa,EAAE1B,EAAE,OAAO1iB,IAAG,CAAK,GAAG,KAAa,MAApBmnB,EAAEnnB,IAAYvC,OAAY,IAAI,OAAO0pB,EAAEluB,KAAK,KAAK,EAAE,KAAK,GAAG,KAAK,GAAG8lD,GAAG,EAAE53B,GAAG,CAAC,MAAMggB,GAAIwX,GAAEx3B,EAAEA,EAAEkK,OAAO8V,EAAG,CAAC,GAAGhgB,IAAI/C,EAAE,CAACpkB,GAAE,KAAK,MAAMujB,CAAC,CAAC,IAAIvc,EAAEmgB,EAAEyK,QAAQ,GAAG,OAAO5qB,EAAE,CAACA,EAAEqqB,OAAOlK,EAAEkK,OAAOrxB,GAAEgH,EAAE,MAAMuc,CAAC,CAACvjB,GAAEmnB,EAAEkK,MAAM,CAAC,CAAU,GAAToe,GAAEh8B,EAAEs3B,KAAQzX,IAAI,oBAAoBA,GAAG6wB,sBAAsB,IAAI7wB,GAAG6wB,sBAAsB9wB,GAAG3xB,EAAE,CAAC,MAAMylC,GAAI,CAAChjB,GAAE,CAAE,CAAC,OAAOA,CAAC,CAAC,QAAQ9rB,GAAEipB,EAAEy/B,GAAGzpB,WAAW/T,CAAC,CAAC,CAAC,OAAM,CAAE,CAAC,SAAS6gC,GAAG1iD,EAAE6hB,EAAEjC,GAAyB5f,EAAE8tC,GAAG9tC,EAAjB6hB,EAAE81B,GAAG33C,EAAf6hB,EAAEw1B,GAAGz3B,EAAEiC,GAAY,GAAY,GAAGA,EAAEmtB,KAAI,OAAOhvC,IAAIgzB,GAAGhzB,EAAE,EAAE6hB,GAAG0+B,GAAGvgD,EAAE6hB,GAAG,CACze,SAASo7B,GAAEj9C,EAAE6hB,EAAEjC,GAAG,GAAG,IAAI5f,EAAEzI,IAAImrD,GAAG1iD,EAAEA,EAAE4f,QAAQ,KAAK,OAAOiC,GAAG,CAAC,GAAG,IAAIA,EAAEtqB,IAAI,CAACmrD,GAAG7gC,EAAE7hB,EAAE4f,GAAG,KAAK,CAAM,GAAG,IAAIiC,EAAEtqB,IAAI,CAAC,IAAIkrB,EAAEZ,EAAEuM,UAAU,GAAG,oBAAoBvM,EAAExgB,KAAK02C,0BAA0B,oBAAoBt1B,EAAEu1B,oBAAoB,OAAOC,KAAKA,GAAG13C,IAAIkiB,IAAI,CAAuBZ,EAAEisB,GAAGjsB,EAAjB7hB,EAAE83C,GAAGj2B,EAAf7hB,EAAEq3C,GAAGz3B,EAAE5f,GAAY,GAAY,GAAGA,EAAEgvC,KAAI,OAAOntB,IAAImR,GAAGnR,EAAE,EAAE7hB,GAAGugD,GAAG1+B,EAAE7hB,IAAI,KAAK,CAAC,CAAC6hB,EAAEA,EAAE8N,MAAM,CAAC,CACnV,SAAS0oB,GAAGr4C,EAAE6hB,EAAEjC,GAAG,IAAI6C,EAAEziB,EAAEo4C,UAAU,OAAO31B,GAAGA,EAAE0R,OAAOtS,GAAGA,EAAEmtB,KAAIhvC,EAAEyyB,aAAazyB,EAAEwyB,eAAe5S,EAAEzY,KAAInH,IAAIu/C,GAAE3/B,KAAKA,IAAI,IAAI48B,IAAG,IAAIA,KAAM,UAAF+C,MAAeA,IAAG,IAAI1uB,KAAI6tB,GAAG0C,GAAGphD,EAAE,GAAG0/C,IAAI9/B,GAAG2gC,GAAGvgD,EAAE6hB,EAAE,CAAC,SAAS8gC,GAAG3iD,EAAE6hB,GAAG,IAAIA,IAAI,KAAY,EAAP7hB,EAAEmJ,MAAQ0Y,EAAE,GAAGA,EAAEuQ,GAAU,KAAQ,WAAfA,KAAK,MAAuBA,GAAG,WAAW,IAAIxS,EAAEovB,KAAc,QAAVhvC,EAAEgtC,GAAGhtC,EAAE6hB,MAAcmR,GAAGhzB,EAAE6hB,EAAEjC,GAAG2gC,GAAGvgD,EAAE4f,GAAG,CAAC,SAASo7B,GAAGh7C,GAAG,IAAI6hB,EAAE7hB,EAAE6vB,cAAcjQ,EAAE,EAAE,OAAOiC,IAAIjC,EAAEiC,EAAEkpB,WAAW4X,GAAG3iD,EAAE4f,EAAE,CACjZ,SAASy+B,GAAGr+C,EAAE6hB,GAAG,IAAIjC,EAAE,EAAE,OAAO5f,EAAEzI,KAAK,KAAK,GAAG,IAAIkrB,EAAEziB,EAAEouB,UAAcrc,EAAE/R,EAAE6vB,cAAc,OAAO9d,IAAI6N,EAAE7N,EAAEg5B,WAAW,MAAM,KAAK,GAAGtoB,EAAEziB,EAAEouB,UAAU,MAAM,QAAQ,MAAMhJ,MAAMxD,EAAE,MAAO,OAAOa,GAAGA,EAAE0R,OAAOtS,GAAG8gC,GAAG3iD,EAAE4f,EAAE,CAQqK,SAASmhC,GAAG/gD,EAAE6hB,GAAG,OAAOwO,GAAGrwB,EAAE6hB,EAAE,CACjZ,SAAS+gC,GAAG5iD,EAAE6hB,EAAEjC,EAAE6C,GAAG3iB,KAAKvI,IAAIyI,EAAEF,KAAK5L,IAAI0rB,EAAE9f,KAAKowB,QAAQpwB,KAAKmwB,MAAMnwB,KAAK6vB,OAAO7vB,KAAKsuB,UAAUtuB,KAAKuB,KAAKvB,KAAK2qC,YAAY,KAAK3qC,KAAKtK,MAAM,EAAEsK,KAAKuwC,IAAI,KAAKvwC,KAAK8qC,aAAa/oB,EAAE/hB,KAAKusC,aAAavsC,KAAK+vB,cAAc/vB,KAAKqtC,YAAYrtC,KAAKsrC,cAAc,KAAKtrC,KAAKqJ,KAAKsZ,EAAE3iB,KAAKq7C,aAAar7C,KAAK/D,MAAM,EAAE+D,KAAK4qC,UAAU,KAAK5qC,KAAKqsC,WAAWrsC,KAAKysC,MAAM,EAAEzsC,KAAK4vB,UAAU,IAAI,CAAC,SAAS8a,GAAGxqC,EAAE6hB,EAAEjC,EAAE6C,GAAG,OAAO,IAAImgC,GAAG5iD,EAAE6hB,EAAEjC,EAAE6C,EAAE,CAAC,SAASq2B,GAAG94C,GAAiB,UAAdA,EAAEA,EAAEhM,aAAuBgM,EAAE6iD,iBAAiB,CAEpd,SAASlS,GAAG3wC,EAAE6hB,GAAG,IAAIjC,EAAE5f,EAAE0vB,UACuB,OADb,OAAO9P,IAAGA,EAAE4qB,GAAGxqC,EAAEzI,IAAIsqB,EAAE7hB,EAAE9L,IAAI8L,EAAEmJ,OAAQshC,YAAYzqC,EAAEyqC,YAAY7qB,EAAEve,KAAKrB,EAAEqB,KAAKue,EAAEwO,UAAUpuB,EAAEouB,UAAUxO,EAAE8P,UAAU1vB,EAAEA,EAAE0vB,UAAU9P,IAAIA,EAAEgrB,aAAa/oB,EAAEjC,EAAEve,KAAKrB,EAAEqB,KAAKue,EAAE7jB,MAAM,EAAE6jB,EAAEu7B,aAAa,EAAEv7B,EAAE8qB,UAAU,MAAM9qB,EAAE7jB,MAAc,SAARiE,EAAEjE,MAAe6jB,EAAEusB,WAAWnsC,EAAEmsC,WAAWvsB,EAAE2sB,MAAMvsC,EAAEusC,MAAM3sB,EAAEqQ,MAAMjwB,EAAEiwB,MAAMrQ,EAAEwrB,cAAcprC,EAAEorC,cAAcxrB,EAAEiQ,cAAc7vB,EAAE6vB,cAAcjQ,EAAEutB,YAAYntC,EAAEmtC,YAAYtrB,EAAE7hB,EAAEqsC,aAAazsB,EAAEysB,aAAa,OAAOxqB,EAAE,KAAK,CAAC0qB,MAAM1qB,EAAE0qB,MAAMD,aAAazqB,EAAEyqB,cAC/e1sB,EAAEsQ,QAAQlwB,EAAEkwB,QAAQtQ,EAAEpqB,MAAMwK,EAAExK,MAAMoqB,EAAEywB,IAAIrwC,EAAEqwC,IAAWzwB,CAAC,CACxD,SAASixB,GAAG7wC,EAAE6hB,EAAEjC,EAAE6C,EAAE1Q,EAAE5Z,GAAG,IAAIuqB,EAAE,EAAM,GAAJD,EAAEziB,EAAK,oBAAoBA,EAAE84C,GAAG94C,KAAK0iB,EAAE,QAAQ,GAAG,kBAAkB1iB,EAAE0iB,EAAE,OAAO1iB,EAAE,OAAOA,GAAG,KAAKokB,EAAG,OAAO4sB,GAAGpxB,EAAEyI,SAAStW,EAAE5Z,EAAE0pB,GAAG,KAAKwC,EAAG3B,EAAE,EAAE3Q,GAAG,EAAE,MAAM,KAAKuS,EAAG,OAAOtkB,EAAEwqC,GAAG,GAAG5qB,EAAEiC,EAAI,EAAF9P,IAAO04B,YAAYnmB,EAAGtkB,EAAEusC,MAAMp0C,EAAE6H,EAAE,KAAK0kB,EAAG,OAAO1kB,EAAEwqC,GAAG,GAAG5qB,EAAEiC,EAAE9P,IAAK04B,YAAY/lB,EAAG1kB,EAAEusC,MAAMp0C,EAAE6H,EAAE,KAAK2kB,EAAG,OAAO3kB,EAAEwqC,GAAG,GAAG5qB,EAAEiC,EAAE9P,IAAK04B,YAAY9lB,EAAG3kB,EAAEusC,MAAMp0C,EAAE6H,EAAE,KAAK8kB,EAAG,OAAO41B,GAAG96B,EAAE7N,EAAE5Z,EAAE0pB,GAAG,QAAQ,GAAG,kBAAkB7hB,GAAG,OAAOA,EAAE,OAAOA,EAAE+lB,UAAU,KAAKxB,EAAG7B,EAAE,GAAG,MAAM1iB,EAAE,KAAKwkB,EAAG9B,EAAE,EAAE,MAAM1iB,EAAE,KAAKykB,EAAG/B,EAAE,GACpf,MAAM1iB,EAAE,KAAK4kB,EAAGlC,EAAE,GAAG,MAAM1iB,EAAE,KAAK6kB,EAAGnC,EAAE,GAAGD,EAAE,KAAK,MAAMziB,EAAE,MAAMolB,MAAMxD,EAAE,IAAI,MAAM5hB,EAAEA,SAASA,EAAE,KAAuD,OAAjD6hB,EAAE2oB,GAAG9nB,EAAE9C,EAAEiC,EAAE9P,IAAK04B,YAAYzqC,EAAE6hB,EAAExgB,KAAKohB,EAAEZ,EAAE0qB,MAAMp0C,EAAS0pB,CAAC,CAAC,SAASmvB,GAAGhxC,EAAE6hB,EAAEjC,EAAE6C,GAA2B,OAAxBziB,EAAEwqC,GAAG,EAAExqC,EAAEyiB,EAAEZ,IAAK0qB,MAAM3sB,EAAS5f,CAAC,CAAC,SAAS06C,GAAG16C,EAAE6hB,EAAEjC,EAAE6C,GAAuE,OAApEziB,EAAEwqC,GAAG,GAAGxqC,EAAEyiB,EAAEZ,IAAK4oB,YAAY3lB,EAAG9kB,EAAEusC,MAAM3sB,EAAE5f,EAAEouB,UAAU,CAACqwB,UAAS,GAAWz+C,CAAC,CAAC,SAAS4wC,GAAG5wC,EAAE6hB,EAAEjC,GAA8B,OAA3B5f,EAAEwqC,GAAG,EAAExqC,EAAE,KAAK6hB,IAAK0qB,MAAM3sB,EAAS5f,CAAC,CAC5W,SAAS+wC,GAAG/wC,EAAE6hB,EAAEjC,GAA8J,OAA3JiC,EAAE2oB,GAAG,EAAE,OAAOxqC,EAAEqoB,SAASroB,EAAEqoB,SAAS,GAAGroB,EAAE9L,IAAI2tB,IAAK0qB,MAAM3sB,EAAEiC,EAAEuM,UAAU,CAAC2G,cAAc/0B,EAAE+0B,cAAc+tB,gBAAgB,KAAKhS,eAAe9wC,EAAE8wC,gBAAuBjvB,CAAC,CACtL,SAASkhC,GAAG/iD,EAAE6hB,EAAEjC,EAAE6C,EAAE1Q,GAAGjS,KAAKvI,IAAIsqB,EAAE/hB,KAAKi1B,cAAc/0B,EAAEF,KAAK2hD,aAAa3hD,KAAKs4C,UAAUt4C,KAAKsG,QAAQtG,KAAKgjD,gBAAgB,KAAKhjD,KAAK8hD,eAAe,EAAE9hD,KAAK0gD,aAAa1gD,KAAKk6C,eAAel6C,KAAK0N,QAAQ,KAAK1N,KAAK8gD,iBAAiB,EAAE9gD,KAAKmzB,WAAWF,GAAG,GAAGjzB,KAAK2gD,gBAAgB1tB,IAAI,GAAGjzB,KAAK4yB,eAAe5yB,KAAK4hD,cAAc5hD,KAAKoiD,iBAAiBpiD,KAAK4gD,aAAa5gD,KAAK2yB,YAAY3yB,KAAK0yB,eAAe1yB,KAAKyyB,aAAa,EAAEzyB,KAAK6yB,cAAcI,GAAG,GAAGjzB,KAAKs3C,iBAAiB30B,EAAE3iB,KAAKyiD,mBAAmBxwC,EAAEjS,KAAKkjD,gCAC/e,IAAI,CAAC,SAASC,GAAGjjD,EAAE6hB,EAAEjC,EAAE6C,EAAE1Q,EAAE5Z,EAAEuqB,EAAE+C,EAAEC,GAAgN,OAA7M1lB,EAAE,IAAI+iD,GAAG/iD,EAAE6hB,EAAEjC,EAAE6F,EAAEC,GAAG,IAAI7D,GAAGA,EAAE,GAAE,IAAK1pB,IAAI0pB,GAAG,IAAIA,EAAE,EAAE1pB,EAAEqyC,GAAG,EAAE,KAAK,KAAK3oB,GAAG7hB,EAAEoG,QAAQjO,EAAEA,EAAEi2B,UAAUpuB,EAAE7H,EAAE03B,cAAc,CAAC1yB,QAAQslB,EAAEqS,aAAalV,EAAEhC,MAAM,KAAKy7B,YAAY,KAAK6J,0BAA0B,MAAMhW,GAAG/0C,GAAU6H,CAAC,CACzP,SAAS7J,GAAG6J,GAAG,IAAIA,EAAE,OAAOgoC,GAAuBhoC,EAAE,CAAC,GAAGyvB,GAA1BzvB,EAAEA,EAAE8uC,mBAA8B9uC,GAAG,IAAIA,EAAEzI,IAAI,MAAM6tB,MAAMxD,EAAE,MAAM,IAAIC,EAAE7hB,EAAE,EAAE,CAAC,OAAO6hB,EAAEtqB,KAAK,KAAK,EAAEsqB,EAAEA,EAAEuM,UAAU5gB,QAAQ,MAAMxN,EAAE,KAAK,EAAE,GAAGwoC,GAAG3mB,EAAExgB,MAAM,CAACwgB,EAAEA,EAAEuM,UAAU2a,0CAA0C,MAAM/oC,CAAC,EAAE6hB,EAAEA,EAAE8N,MAAM,OAAO,OAAO9N,GAAG,MAAMuD,MAAMxD,EAAE,KAAM,CAAC,GAAG,IAAI5hB,EAAEzI,IAAI,CAAC,IAAIqoB,EAAE5f,EAAEqB,KAAK,GAAGmnC,GAAG5oB,GAAG,OAAOgpB,GAAG5oC,EAAE4f,EAAEiC,EAAE,CAAC,OAAOA,CAAC,CACpW,SAASshC,GAAGnjD,EAAE6hB,EAAEjC,EAAE6C,EAAE1Q,EAAE5Z,EAAEuqB,EAAE+C,EAAEC,GAAwK,OAArK1lB,EAAEijD,GAAGrjC,EAAE6C,GAAE,EAAGziB,EAAE+R,EAAE5Z,EAAEuqB,EAAE+C,EAAEC,IAAKlY,QAAQrX,GAAG,MAAMypB,EAAE5f,EAAEoG,SAAsBjO,EAAEoH,GAAhBkjB,EAAEusB,KAAIj9B,EAAEk9B,GAAGrvB,KAAeiuB,cAAS,IAAShsB,GAAG,OAAOA,EAAEA,EAAE,KAAKisB,GAAGluB,EAAEznB,EAAE4Z,GAAG/R,EAAEoG,QAAQmmC,MAAMx6B,EAAEihB,GAAGhzB,EAAE+R,EAAE0Q,GAAG89B,GAAGvgD,EAAEyiB,GAAUziB,CAAC,CAAC,SAASojD,GAAGpjD,EAAE6hB,EAAEjC,EAAE6C,GAAG,IAAI1Q,EAAE8P,EAAEzb,QAAQjO,EAAE62C,KAAItsB,EAAEusB,GAAGl9B,GAAsL,OAAnL6N,EAAEzpB,GAAGypB,GAAG,OAAOiC,EAAErU,QAAQqU,EAAErU,QAAQoS,EAAEiC,EAAEm4B,eAAep6B,GAAEiC,EAAEtiB,GAAGpH,EAAEuqB,IAAKkrB,QAAQ,CAACzwC,QAAQ6C,GAAuB,QAApByiB,OAAE,IAASA,EAAE,KAAKA,KAAaZ,EAAEgsB,SAASprB,GAAe,QAAZziB,EAAE8tC,GAAG/7B,EAAE8P,EAAEa,MAAcwsB,GAAGlvC,EAAE+R,EAAE2Q,EAAEvqB,GAAG61C,GAAGhuC,EAAE+R,EAAE2Q,IAAWA,CAAC,CAC3b,SAAS2gC,GAAGrjD,GAAe,OAAZA,EAAEA,EAAEoG,SAAc6pB,OAAyBjwB,EAAEiwB,MAAM14B,IAAoDyI,EAAEiwB,MAAM7B,WAAhF,IAA0F,CAAC,SAASk1B,GAAGtjD,EAAE6hB,GAAqB,GAAG,QAArB7hB,EAAEA,EAAE6vB,gBAA2B,OAAO7vB,EAAE8vB,WAAW,CAAC,IAAIlQ,EAAE5f,EAAE+qC,UAAU/qC,EAAE+qC,UAAU,IAAInrB,GAAGA,EAAEiC,EAAEjC,EAAEiC,CAAC,CAAC,CAAC,SAAS0hC,GAAGvjD,EAAE6hB,GAAGyhC,GAAGtjD,EAAE6hB,IAAI7hB,EAAEA,EAAE0vB,YAAY4zB,GAAGtjD,EAAE6hB,EAAE,CAnB7So9B,GAAG,SAASj/C,EAAE6hB,EAAEjC,GAAG,GAAG,OAAO5f,EAAE,GAAGA,EAAEorC,gBAAgBvpB,EAAE+oB,cAAc1C,GAAG9hC,QAAQomC,IAAG,MAAO,CAAC,GAAG,KAAKxsC,EAAEusC,MAAM3sB,IAAI,KAAa,IAARiC,EAAE9lB,OAAW,OAAOywC,IAAG,EAzE1I,SAAYxsC,EAAE6hB,EAAEjC,GAAG,OAAOiC,EAAEtqB,KAAK,KAAK,EAAEwiD,GAAGl4B,GAAGypB,KAAK,MAAM,KAAK,EAAEqG,GAAG9vB,GAAG,MAAM,KAAK,EAAE2mB,GAAG3mB,EAAExgB,OAAOynC,GAAGjnB,GAAG,MAAM,KAAK,EAAE2vB,GAAG3vB,EAAEA,EAAEuM,UAAU2G,eAAe,MAAM,KAAK,GAAG,IAAItS,EAAEZ,EAAExgB,KAAK2kB,SAASjU,EAAE8P,EAAEupB,cAAc/1C,MAAM0yC,GAAE4D,GAAGlpB,EAAEwpB,eAAexpB,EAAEwpB,cAAcl6B,EAAE,MAAM,KAAK,GAAqB,GAAG,QAArB0Q,EAAEZ,EAAEgO,eAA2B,OAAG,OAAOpN,EAAEqN,YAAkBiY,GAAE8J,GAAY,EAAVA,GAAEzrC,SAAWyb,EAAE9lB,OAAO,IAAI,MAAQ,KAAK6jB,EAAEiC,EAAEoO,MAAMkc,YAAmBqO,GAAGx6C,EAAE6hB,EAAEjC,IAAGmoB,GAAE8J,GAAY,EAAVA,GAAEzrC,SAA8B,QAAnBpG,EAAE44C,GAAG54C,EAAE6hB,EAAEjC,IAAmB5f,EAAEkwB,QAAQ,MAAK6X,GAAE8J,GAAY,EAAVA,GAAEzrC,SAAW,MAAM,KAAK,GAC7d,GADgeqc,EAAE,KAAK7C,EACrfiC,EAAEsqB,YAAe,KAAa,IAARnsC,EAAEjE,OAAW,CAAC,GAAG0mB,EAAE,OAAOm5B,GAAG57C,EAAE6hB,EAAEjC,GAAGiC,EAAE9lB,OAAO,GAAG,CAA6F,GAA1E,QAAlBgW,EAAE8P,EAAEgO,iBAAyB9d,EAAEwpC,UAAU,KAAKxpC,EAAE2pC,KAAK,KAAK3pC,EAAEyiC,WAAW,MAAMzM,GAAE8J,GAAEA,GAAEzrC,SAAYqc,EAAE,MAAW,OAAO,KAAK,KAAK,GAAG,KAAK,GAAG,OAAOZ,EAAE0qB,MAAM,EAAE2M,GAAGl5C,EAAE6hB,EAAEjC,GAAG,OAAOg5B,GAAG54C,EAAE6hB,EAAEjC,EAAE,CAwE7G4jC,CAAGxjD,EAAE6hB,EAAEjC,GAAG4sB,GAAG,KAAa,OAARxsC,EAAEjE,MAAmB,MAAMywC,IAAG,EAAGnC,IAAG,KAAa,QAARxoB,EAAE9lB,QAAgBiuC,GAAGnoB,EAAE4nB,GAAG5nB,EAAErsB,OAAiB,OAAVqsB,EAAE0qB,MAAM,EAAS1qB,EAAEtqB,KAAK,KAAK,EAAE,IAAIkrB,EAAEZ,EAAExgB,KAAKq4C,GAAG15C,EAAE6hB,GAAG7hB,EAAE6hB,EAAE+oB,aAAa,IAAI74B,EAAEq2B,GAAGvmB,EAAEomB,GAAE7hC,SAASgmC,GAAGvqB,EAAEjC,GAAG7N,EAAE+gC,GAAG,KAAKjxB,EAAEY,EAAEziB,EAAE+R,EAAE6N,GAAG,IAAIznB,EAAEg7C,KACvI,OAD4ItxB,EAAE9lB,OAAO,EAAE,kBAAkBgW,GAAG,OAAOA,GAAG,oBAAoBA,EAAE8T,aAAQ,IAAS9T,EAAEgU,UAAUlE,EAAEtqB,IAAI,EAAEsqB,EAAEgO,cAAc,KAAKhO,EAAEsrB,YAC1e,KAAK3E,GAAG/lB,IAAItqB,GAAE,EAAG2wC,GAAGjnB,IAAI1pB,GAAE,EAAG0pB,EAAEgO,cAAc,OAAO9d,EAAEjR,YAAO,IAASiR,EAAEjR,MAAMiR,EAAEjR,MAAM,KAAKosC,GAAGrrB,GAAG9P,EAAE29B,QAAQd,GAAG/sB,EAAEuM,UAAUrc,EAAEA,EAAE+8B,gBAAgBjtB,EAAEiuB,GAAGjuB,EAAEY,EAAEziB,EAAE4f,GAAGiC,EAAEi4B,GAAG,KAAKj4B,EAAEY,GAAE,EAAGtqB,EAAEynB,KAAKiC,EAAEtqB,IAAI,EAAE8yC,IAAGlyC,GAAG8xC,GAAGpoB,GAAG62B,GAAG,KAAK72B,EAAE9P,EAAE6N,GAAGiC,EAAEA,EAAEoO,OAAcpO,EAAE,KAAK,GAAGY,EAAEZ,EAAE4oB,YAAYzqC,EAAE,CAAqF,OAApF05C,GAAG15C,EAAE6hB,GAAG7hB,EAAE6hB,EAAE+oB,aAAuBnoB,GAAV1Q,EAAE0Q,EAAEyD,OAAUzD,EAAEwD,UAAUpE,EAAExgB,KAAKohB,EAAE1Q,EAAE8P,EAAEtqB,IAQtU,SAAYyI,GAAG,GAAG,oBAAoBA,EAAE,OAAO84C,GAAG94C,GAAG,EAAE,EAAE,QAAG,IAASA,GAAG,OAAOA,EAAE,CAAc,IAAbA,EAAEA,EAAE+lB,YAAgBtB,EAAG,OAAO,GAAG,GAAGzkB,IAAI4kB,EAAG,OAAO,EAAE,CAAC,OAAO,CAAC,CAR2L6+B,CAAGhhC,GAAGziB,EAAEyrC,GAAGhpB,EAAEziB,GAAU+R,GAAG,KAAK,EAAE8P,EAAEo3B,GAAG,KAAKp3B,EAAEY,EAAEziB,EAAE4f,GAAG,MAAM5f,EAAE,KAAK,EAAE6hB,EAAE43B,GAAG,KAAK53B,EAAEY,EAAEziB,EAAE4f,GAAG,MAAM5f,EAAE,KAAK,GAAG6hB,EAAE82B,GAAG,KAAK92B,EAAEY,EAAEziB,EAAE4f,GAAG,MAAM5f,EAAE,KAAK,GAAG6hB,EAAEg3B,GAAG,KAAKh3B,EAAEY,EAAEgpB,GAAGhpB,EAAEphB,KAAKrB,GAAG4f,GAAG,MAAM5f,EAAE,MAAMolB,MAAMxD,EAAE,IACvgBa,EAAE,IAAK,CAAC,OAAOZ,EAAE,KAAK,EAAE,OAAOY,EAAEZ,EAAExgB,KAAK0Q,EAAE8P,EAAE+oB,aAA2CqO,GAAGj5C,EAAE6hB,EAAEY,EAArC1Q,EAAE8P,EAAE4oB,cAAchoB,EAAE1Q,EAAE05B,GAAGhpB,EAAE1Q,GAAc6N,GAAG,KAAK,EAAE,OAAO6C,EAAEZ,EAAExgB,KAAK0Q,EAAE8P,EAAE+oB,aAA2C6O,GAAGz5C,EAAE6hB,EAAEY,EAArC1Q,EAAE8P,EAAE4oB,cAAchoB,EAAE1Q,EAAE05B,GAAGhpB,EAAE1Q,GAAc6N,GAAG,KAAK,EAAE5f,EAAE,CAAO,GAAN+5C,GAAGl4B,GAAM,OAAO7hB,EAAE,MAAMolB,MAAMxD,EAAE,MAAMa,EAAEZ,EAAE+oB,aAA+B74B,GAAlB5Z,EAAE0pB,EAAEgO,eAAkB1yB,QAAQswC,GAAGztC,EAAE6hB,GAAGqsB,GAAGrsB,EAAEY,EAAE,KAAK7C,GAAG,IAAI8C,EAAEb,EAAEgO,cAA0B,GAAZpN,EAAEC,EAAEvlB,QAAWhF,EAAE28B,aAAY,CAAC,GAAG38B,EAAE,CAACgF,QAAQslB,EAAEqS,cAAa,EAAGlX,MAAM8E,EAAE9E,MAAMslC,0BAA0BxgC,EAAEwgC,0BAA0B7J,YAAY32B,EAAE22B,aAAax3B,EAAEsrB,YAAYC,UAChfj1C,EAAE0pB,EAAEgO,cAAc13B,EAAU,IAAR0pB,EAAE9lB,MAAU,CAAuB8lB,EAAEo4B,GAAGj6C,EAAE6hB,EAAEY,EAAE7C,EAAjC7N,EAAEslC,GAAGjyB,MAAMxD,EAAE,MAAMC,IAAmB,MAAM7hB,CAAC,CAAM,GAAGyiB,IAAI1Q,EAAE,CAAuB8P,EAAEo4B,GAAGj6C,EAAE6hB,EAAEY,EAAE7C,EAAjC7N,EAAEslC,GAAGjyB,MAAMxD,EAAE,MAAMC,IAAmB,MAAM7hB,CAAC,CAAM,IAAIoqC,GAAGjD,GAAGtlB,EAAEuM,UAAU2G,cAAc/L,YAAYmhB,GAAGtoB,EAAEwoB,IAAE,EAAGC,GAAG,KAAK1qB,EAAEsxB,GAAGrvB,EAAE,KAAKY,EAAE7C,GAAGiC,EAAEoO,MAAMrQ,EAAEA,GAAGA,EAAE7jB,OAAe,EAAT6jB,EAAE7jB,MAAS,KAAK6jB,EAAEA,EAAEsQ,OAAQ,KAAI,CAAM,GAALob,KAAQ7oB,IAAI1Q,EAAE,CAAC8P,EAAE+2B,GAAG54C,EAAE6hB,EAAEjC,GAAG,MAAM5f,CAAC,CAAC04C,GAAG14C,EAAE6hB,EAAEY,EAAE7C,EAAE,CAACiC,EAAEA,EAAEoO,KAAK,CAAC,OAAOpO,EAAE,KAAK,EAAE,OAAO8vB,GAAG9vB,GAAG,OAAO7hB,GAAGirC,GAAGppB,GAAGY,EAAEZ,EAAExgB,KAAK0Q,EAAE8P,EAAE+oB,aAAazyC,EAAE,OAAO6H,EAAEA,EAAEorC,cAAc,KAAK1oB,EAAE3Q,EAAEsW,SAASme,GAAG/jB,EAAE1Q,GAAG2Q,EAAE,KAAK,OAAOvqB,GAAGquC,GAAG/jB,EAAEtqB,KAAK0pB,EAAE9lB,OAAO,IACnfy9C,GAAGx5C,EAAE6hB,GAAG62B,GAAG14C,EAAE6hB,EAAEa,EAAE9C,GAAGiC,EAAEoO,MAAM,KAAK,EAAE,OAAO,OAAOjwB,GAAGirC,GAAGppB,GAAG,KAAK,KAAK,GAAG,OAAO24B,GAAGx6C,EAAE6hB,EAAEjC,GAAG,KAAK,EAAE,OAAO4xB,GAAG3vB,EAAEA,EAAEuM,UAAU2G,eAAetS,EAAEZ,EAAE+oB,aAAa,OAAO5qC,EAAE6hB,EAAEoO,MAAMghB,GAAGpvB,EAAE,KAAKY,EAAE7C,GAAG84B,GAAG14C,EAAE6hB,EAAEY,EAAE7C,GAAGiC,EAAEoO,MAAM,KAAK,GAAG,OAAOxN,EAAEZ,EAAExgB,KAAK0Q,EAAE8P,EAAE+oB,aAA2C+N,GAAG34C,EAAE6hB,EAAEY,EAArC1Q,EAAE8P,EAAE4oB,cAAchoB,EAAE1Q,EAAE05B,GAAGhpB,EAAE1Q,GAAc6N,GAAG,KAAK,EAAE,OAAO84B,GAAG14C,EAAE6hB,EAAEA,EAAE+oB,aAAahrB,GAAGiC,EAAEoO,MAAM,KAAK,EAAmD,KAAK,GAAG,OAAOyoB,GAAG14C,EAAE6hB,EAAEA,EAAE+oB,aAAaviB,SAASzI,GAAGiC,EAAEoO,MAAM,KAAK,GAAGjwB,EAAE,CACxZ,GADyZyiB,EAAEZ,EAAExgB,KAAK2kB,SAASjU,EAAE8P,EAAE+oB,aAAazyC,EAAE0pB,EAAEupB,cAClf1oB,EAAE3Q,EAAE1c,MAAM0yC,GAAE4D,GAAGlpB,EAAEwpB,eAAexpB,EAAEwpB,cAAcvpB,EAAK,OAAOvqB,EAAE,GAAGmoC,GAAGnoC,EAAE9C,MAAMqtB,IAAI,GAAGvqB,EAAEkwB,WAAWtW,EAAEsW,WAAW6f,GAAG9hC,QAAQ,CAACyb,EAAE+2B,GAAG54C,EAAE6hB,EAAEjC,GAAG,MAAM5f,CAAC,OAAO,IAAc,QAAV7H,EAAE0pB,EAAEoO,SAAiB93B,EAAEw3B,OAAO9N,GAAG,OAAO1pB,GAAG,CAAC,IAAIstB,EAAEttB,EAAEk0C,aAAa,GAAG,OAAO5mB,EAAE,CAAC/C,EAAEvqB,EAAE83B,MAAM,IAAI,IAAIvK,EAAED,EAAE6mB,aAAa,OAAO5mB,GAAG,CAAC,GAAGA,EAAElY,UAAUiV,EAAE,CAAC,GAAG,IAAItqB,EAAEZ,IAAI,EAACmuB,EAAEnmB,IAAI,EAAEqgB,GAAGA,IAAKroB,IAAI,EAAE,IAAIiX,EAAErW,EAAEg1C,YAAY,GAAG,OAAO3+B,EAAE,CAAY,IAAInP,GAAfmP,EAAEA,EAAE/N,QAAe8sC,QAAQ,OAAOluC,EAAEqmB,EAAEinB,KAAKjnB,GAAGA,EAAEinB,KAAKttC,EAAEstC,KAAKttC,EAAEstC,KAAKjnB,GAAGlX,EAAE++B,QAAQ7nB,CAAC,CAAC,CAACvtB,EAAEo0C,OAAO3sB,EAAgB,QAAd8F,EAAEvtB,EAAEu3B,aAAqBhK,EAAE6mB,OAAO3sB,GAAGssB,GAAG/zC,EAAEw3B,OAClf/P,EAAEiC,GAAG4D,EAAE8mB,OAAO3sB,EAAE,KAAK,CAAC8F,EAAEA,EAAEinB,IAAI,CAAC,MAAM,GAAG,KAAKx0C,EAAEZ,IAAImrB,EAAEvqB,EAAEkJ,OAAOwgB,EAAExgB,KAAK,KAAKlJ,EAAE83B,WAAW,GAAG,KAAK93B,EAAEZ,IAAI,CAAY,GAAG,QAAdmrB,EAAEvqB,EAAEw3B,QAAmB,MAAMvK,MAAMxD,EAAE,MAAMc,EAAE6pB,OAAO3sB,EAAgB,QAAd6F,EAAE/C,EAAEgN,aAAqBjK,EAAE8mB,OAAO3sB,GAAGssB,GAAGxpB,EAAE9C,EAAEiC,GAAGa,EAAEvqB,EAAE+3B,OAAO,MAAMxN,EAAEvqB,EAAE83B,MAAM,GAAG,OAAOvN,EAAEA,EAAEiN,OAAOx3B,OAAO,IAAIuqB,EAAEvqB,EAAE,OAAOuqB,GAAG,CAAC,GAAGA,IAAIb,EAAE,CAACa,EAAE,KAAK,KAAK,CAAa,GAAG,QAAfvqB,EAAEuqB,EAAEwN,SAAoB,CAAC/3B,EAAEw3B,OAAOjN,EAAEiN,OAAOjN,EAAEvqB,EAAE,KAAK,CAACuqB,EAAEA,EAAEiN,MAAM,CAACx3B,EAAEuqB,CAAC,CAACg2B,GAAG14C,EAAE6hB,EAAE9P,EAAEsW,SAASzI,GAAGiC,EAAEA,EAAEoO,KAAK,CAAC,OAAOpO,EAAE,KAAK,EAAE,OAAO9P,EAAE8P,EAAExgB,KAAKohB,EAAEZ,EAAE+oB,aAAaviB,SAAS+jB,GAAGvqB,EAAEjC,GAAW6C,EAAEA,EAAV1Q,EAAE06B,GAAG16B,IAAU8P,EAAE9lB,OAAO,EAAE28C,GAAG14C,EAAE6hB,EAAEY,EAAE7C,GACpfiC,EAAEoO,MAAM,KAAK,GAAG,OAAgBle,EAAE05B,GAAXhpB,EAAEZ,EAAExgB,KAAYwgB,EAAE+oB,cAA6BiO,GAAG74C,EAAE6hB,EAAEY,EAAtB1Q,EAAE05B,GAAGhpB,EAAEphB,KAAK0Q,GAAc6N,GAAG,KAAK,GAAG,OAAOo5B,GAAGh5C,EAAE6hB,EAAEA,EAAExgB,KAAKwgB,EAAE+oB,aAAahrB,GAAG,KAAK,GAAG,OAAO6C,EAAEZ,EAAExgB,KAAK0Q,EAAE8P,EAAE+oB,aAAa74B,EAAE8P,EAAE4oB,cAAchoB,EAAE1Q,EAAE05B,GAAGhpB,EAAE1Q,GAAG2nC,GAAG15C,EAAE6hB,GAAGA,EAAEtqB,IAAI,EAAEixC,GAAG/lB,IAAIziB,GAAE,EAAG8oC,GAAGjnB,IAAI7hB,GAAE,EAAGosC,GAAGvqB,EAAEjC,GAAG4vB,GAAG3tB,EAAEY,EAAE1Q,GAAG+9B,GAAGjuB,EAAEY,EAAE1Q,EAAE6N,GAAGk6B,GAAG,KAAKj4B,EAAEY,GAAE,EAAGziB,EAAE4f,GAAG,KAAK,GAAG,OAAOg8B,GAAG57C,EAAE6hB,EAAEjC,GAAG,KAAK,GAAG,OAAOs5B,GAAGl5C,EAAE6hB,EAAEjC,GAAG,MAAMwF,MAAMxD,EAAE,IAAIC,EAAEtqB,KAAM,EAYxC,IAAImsD,GAAG,oBAAoBC,YAAYA,YAAY,SAAS3jD,GAAGy3C,QAAQhgD,MAAMuI,EAAE,EAAE,SAAS4jD,GAAG5jD,GAAGF,KAAK+jD,cAAc7jD,CAAC,CACjI,SAAS8jD,GAAG9jD,GAAGF,KAAK+jD,cAAc7jD,CAAC,CAC5J,SAAS+jD,GAAG/jD,GAAG,SAASA,GAAG,IAAIA,EAAEyR,UAAU,IAAIzR,EAAEyR,UAAU,KAAKzR,EAAEyR,SAAS,CAAC,SAASuyC,GAAGhkD,GAAG,SAASA,GAAG,IAAIA,EAAEyR,UAAU,IAAIzR,EAAEyR,UAAU,KAAKzR,EAAEyR,WAAW,IAAIzR,EAAEyR,UAAU,iCAAiCzR,EAAEspB,WAAW,CAAC,SAAS26B,KAAK,CAExa,SAASC,GAAGlkD,EAAE6hB,EAAEjC,EAAE6C,EAAE1Q,GAAG,IAAI5Z,EAAEynB,EAAEg+B,oBAAoB,GAAGzlD,EAAE,CAAC,IAAIuqB,EAAEvqB,EAAE,GAAG,oBAAoB4Z,EAAE,CAAC,IAAI0T,EAAE1T,EAAEA,EAAE,WAAW,IAAI/R,EAAEqjD,GAAG3gC,GAAG+C,EAAEtxB,KAAK6L,EAAE,CAAC,CAACojD,GAAGvhC,EAAEa,EAAE1iB,EAAE+R,EAAE,MAAM2Q,EADxJ,SAAY1iB,EAAE6hB,EAAEjC,EAAE6C,EAAE1Q,GAAG,GAAGA,EAAE,CAAC,GAAG,oBAAoB0Q,EAAE,CAAC,IAAItqB,EAAEsqB,EAAEA,EAAE,WAAW,IAAIziB,EAAEqjD,GAAG3gC,GAAGvqB,EAAEhE,KAAK6L,EAAE,CAAC,CAAC,IAAI0iB,EAAEygC,GAAGthC,EAAEY,EAAEziB,EAAE,EAAE,MAAK,EAAG,EAAG,GAAGikD,IAAmF,OAA/EjkD,EAAE49C,oBAAoBl7B,EAAE1iB,EAAEslC,IAAI5iB,EAAEtc,QAAQ4+B,GAAG,IAAIhlC,EAAEyR,SAASzR,EAAE8tB,WAAW9tB,GAAG8hD,KAAYp/B,CAAC,CAAC,KAAK3Q,EAAE/R,EAAEqpB,WAAWrpB,EAAEipB,YAAYlX,GAAG,GAAG,oBAAoB0Q,EAAE,CAAC,IAAIgD,EAAEhD,EAAEA,EAAE,WAAW,IAAIziB,EAAEqjD,GAAG39B,GAAGD,EAAEtxB,KAAK6L,EAAE,CAAC,CAAC,IAAI0lB,EAAEu9B,GAAGjjD,EAAE,GAAE,EAAG,KAAK,GAAK,EAAG,EAAG,GAAGikD,IAA0G,OAAtGjkD,EAAE49C,oBAAoBl4B,EAAE1lB,EAAEslC,IAAI5f,EAAEtf,QAAQ4+B,GAAG,IAAIhlC,EAAEyR,SAASzR,EAAE8tB,WAAW9tB,GAAG8hD,IAAG,WAAWsB,GAAGvhC,EAAE6D,EAAE9F,EAAE6C,EAAE,IAAUiD,CAAC,CACpUy+B,CAAGvkC,EAAEiC,EAAE7hB,EAAE+R,EAAE0Q,GAAG,OAAO4gC,GAAG3gC,EAAE,CAHpLohC,GAAG9vD,UAAU6xB,OAAO+9B,GAAG5vD,UAAU6xB,OAAO,SAAS7lB,GAAG,IAAI6hB,EAAE/hB,KAAK+jD,cAAc,GAAG,OAAOhiC,EAAE,MAAMuD,MAAMxD,EAAE,MAAMwhC,GAAGpjD,EAAE6hB,EAAE,KAAK,KAAK,EAAEiiC,GAAG9vD,UAAUowD,QAAQR,GAAG5vD,UAAUowD,QAAQ,WAAW,IAAIpkD,EAAEF,KAAK+jD,cAAc,GAAG,OAAO7jD,EAAE,CAACF,KAAK+jD,cAAc,KAAK,IAAIhiC,EAAE7hB,EAAE+0B,cAAc+sB,IAAG,WAAWsB,GAAG,KAAKpjD,EAAE,KAAK,KAAK,IAAG6hB,EAAEyjB,IAAI,IAAI,CAAC,EACzTwe,GAAG9vD,UAAUqwD,2BAA2B,SAASrkD,GAAG,GAAGA,EAAE,CAAC,IAAI6hB,EAAE0R,KAAKvzB,EAAE,CAACu0B,UAAU,KAAKx8B,OAAOiI,EAAE60B,SAAShT,GAAG,IAAI,IAAIjC,EAAE,EAAEA,EAAEoU,GAAG1gC,QAAQ,IAAIuuB,GAAGA,EAAEmS,GAAGpU,GAAGiV,SAASjV,KAAKoU,GAAG5gB,OAAOwM,EAAE,EAAE5f,GAAG,IAAI4f,GAAG+U,GAAG30B,EAAE,CAAC,EAEXozB,GAAG,SAASpzB,GAAG,OAAOA,EAAEzI,KAAK,KAAK,EAAE,IAAIsqB,EAAE7hB,EAAEouB,UAAU,GAAGvM,EAAEzb,QAAQypB,cAAciF,aAAa,CAAC,IAAIlV,EAAEyS,GAAGxQ,EAAE0Q,cAAc,IAAI3S,IAAIsT,GAAGrR,EAAI,EAAFjC,GAAK2gC,GAAG1+B,EAAEgP,MAAK,KAAO,EAAFkd,MAAO0O,GAAG5rB,KAAI,IAAIwY,MAAM,CAAC,MAAM,KAAK,GAAGyY,IAAG,WAAW,IAAIjgC,EAAEmrB,GAAGhtC,EAAE,GAAG,GAAG,OAAO6hB,EAAE,CAAC,IAAIjC,EAAEovB,KAAIE,GAAGrtB,EAAE7hB,EAAE,EAAE4f,EAAE,CAAC,IAAG2jC,GAAGvjD,EAAE,GAAG,EAC/bqzB,GAAG,SAASrzB,GAAG,GAAG,KAAKA,EAAEzI,IAAI,CAAC,IAAIsqB,EAAEmrB,GAAGhtC,EAAE,WAAW,GAAG,OAAO6hB,EAAaqtB,GAAGrtB,EAAE7hB,EAAE,UAAXgvC,MAAwBuU,GAAGvjD,EAAE,UAAU,CAAC,EAAEszB,GAAG,SAAStzB,GAAG,GAAG,KAAKA,EAAEzI,IAAI,CAAC,IAAIsqB,EAAEotB,GAAGjvC,GAAG4f,EAAEotB,GAAGhtC,EAAE6hB,GAAG,GAAG,OAAOjC,EAAasvB,GAAGtvB,EAAE5f,EAAE6hB,EAAXmtB,MAAgBuU,GAAGvjD,EAAE6hB,EAAE,CAAC,EAAE0R,GAAG,WAAW,OAAO58B,EAAC,EAAE68B,GAAG,SAASxzB,EAAE6hB,GAAG,IAAIjC,EAAEjpB,GAAE,IAAI,OAAOA,GAAEqJ,EAAE6hB,GAAG,CAAC,QAAQlrB,GAAEipB,CAAC,CAAC,EAClSmO,GAAG,SAAS/tB,EAAE6hB,EAAEjC,GAAG,OAAOiC,GAAG,IAAK,QAAyB,GAAjB6F,EAAG1nB,EAAE4f,GAAGiC,EAAEjC,EAAE7mB,KAAQ,UAAU6mB,EAAEve,MAAM,MAAMwgB,EAAE,CAAC,IAAIjC,EAAE5f,EAAE4f,EAAEkO,YAAYlO,EAAEA,EAAEkO,WAAsF,IAA3ElO,EAAEA,EAAE0kC,iBAAiB,cAAcC,KAAKC,UAAU,GAAG3iC,GAAG,mBAAuBA,EAAE,EAAEA,EAAEjC,EAAEtsB,OAAOuuB,IAAI,CAAC,IAAIY,EAAE7C,EAAEiC,GAAG,GAAGY,IAAIziB,GAAGyiB,EAAEgiC,OAAOzkD,EAAEykD,KAAK,CAAC,IAAI1yC,EAAEsc,GAAG5L,GAAG,IAAI1Q,EAAE,MAAMqT,MAAMxD,EAAE,KAAKgF,EAAGnE,GAAGiF,EAAGjF,EAAE1Q,EAAE,CAAC,CAAC,CAAC,MAAM,IAAK,WAAWwW,GAAGvoB,EAAE4f,GAAG,MAAM,IAAK,SAAmB,OAAViC,EAAEjC,EAAEvqB,QAAe0yB,GAAG/nB,IAAI4f,EAAEq8B,SAASp6B,GAAE,GAAI,EAAE2M,GAAGqzB,GAAGpzB,GAAGqzB,GACpa,IAAI4C,GAAG,CAACC,uBAAsB,EAAGr3C,OAAO,CAAC6gB,GAAGoR,GAAGlR,GAAGC,GAAGC,GAAGszB,KAAK+C,GAAG,CAACC,wBAAwBjwB,GAAGkwB,WAAW,EAAE/qD,QAAQ,SAASgrD,oBAAoB,aAC1IC,GAAG,CAACF,WAAWF,GAAGE,WAAW/qD,QAAQ6qD,GAAG7qD,QAAQgrD,oBAAoBH,GAAGG,oBAAoBE,eAAeL,GAAGK,eAAeC,kBAAkB,KAAKC,4BAA4B,KAAKC,4BAA4B,KAAKC,cAAc,KAAKC,wBAAwB,KAAKC,wBAAwB,KAAKC,gBAAgB,KAAKC,mBAAmB,KAAKC,eAAe,KAAKC,qBAAqB5hC,EAAGquB,uBAAuBwT,wBAAwB,SAAS5lD,GAAW,OAAO,QAAfA,EAAEgwB,GAAGhwB,IAAmB,KAAKA,EAAEouB,SAAS,EAAEy2B,wBAAwBD,GAAGC,yBARjN,WAAc,OAAO,IAAI,EASpUgB,4BAA4B,KAAKC,gBAAgB,KAAKC,aAAa,KAAKC,kBAAkB,KAAKC,gBAAgB,KAAKC,kBAAkB,kCAAkC,GAAG,qBAAqBC,+BAA+B,CAAC,IAAIC,GAAGD,+BAA+B,IAAIC,GAAGC,YAAYD,GAAGE,cAAc,IAAI30B,GAAGy0B,GAAGG,OAAOvB,IAAIpzB,GAAGw0B,EAAE,CAAC,MAAMpmD,IAAG,CAAC,CAAC1L,EAAQ0vB,mDAAmD0gC,GAC9YpwD,EAAQkyD,aAAa,SAASxmD,EAAE6hB,GAAG,IAAIjC,EAAE,EAAEvsB,UAAUC,aAAQ,IAASD,UAAU,GAAGA,UAAU,GAAG,KAAK,IAAI0wD,GAAGliC,GAAG,MAAMuD,MAAMxD,EAAE,MAAM,OAbuH,SAAY5hB,EAAE6hB,EAAEjC,GAAG,IAAI6C,EAAE,EAAEpvB,UAAUC,aAAQ,IAASD,UAAU,GAAGA,UAAU,GAAG,KAAK,MAAM,CAAC0yB,SAAS5B,EAAGjwB,IAAI,MAAMuuB,EAAE,KAAK,GAAGA,EAAE4F,SAASroB,EAAE+0B,cAAclT,EAAEivB,eAAelxB,EAAE,CAa1R6mC,CAAGzmD,EAAE6hB,EAAE,KAAKjC,EAAE,EAAEtrB,EAAQoyD,WAAW,SAAS1mD,EAAE6hB,GAAG,IAAIkiC,GAAG/jD,GAAG,MAAMolB,MAAMxD,EAAE,MAAM,IAAIhC,GAAE,EAAG6C,EAAE,GAAG1Q,EAAE2xC,GAA4P,OAAzP,OAAO7hC,QAAG,IAASA,KAAI,IAAKA,EAAE8kC,sBAAsB/mC,GAAE,QAAI,IAASiC,EAAEu1B,mBAAmB30B,EAAEZ,EAAEu1B,uBAAkB,IAASv1B,EAAE0gC,qBAAqBxwC,EAAE8P,EAAE0gC,qBAAqB1gC,EAAEohC,GAAGjjD,EAAE,GAAE,EAAG,KAAK,EAAK4f,EAAE,EAAG6C,EAAE1Q,GAAG/R,EAAEslC,IAAIzjB,EAAEzb,QAAQ4+B,GAAG,IAAIhlC,EAAEyR,SAASzR,EAAE8tB,WAAW9tB,GAAU,IAAI4jD,GAAG/hC,EAAE,EACrfvtB,EAAQsyD,YAAY,SAAS5mD,GAAG,GAAG,MAAMA,EAAE,OAAO,KAAK,GAAG,IAAIA,EAAEyR,SAAS,OAAOzR,EAAE,IAAI6hB,EAAE7hB,EAAE8uC,gBAAgB,QAAG,IAASjtB,EAAE,CAAC,GAAG,oBAAoB7hB,EAAE6lB,OAAO,MAAMT,MAAMxD,EAAE,MAAiC,MAA3B5hB,EAAEjM,OAAOmE,KAAK8H,GAAG5L,KAAK,KAAWgxB,MAAMxD,EAAE,IAAI5hB,GAAI,CAAqC,OAA5BA,EAAE,QAAVA,EAAEgwB,GAAGnO,IAAc,KAAK7hB,EAAEouB,SAAkB,EAAE95B,EAAQuyD,UAAU,SAAS7mD,GAAG,OAAO8hD,GAAG9hD,EAAE,EAAE1L,EAAQwyD,QAAQ,SAAS9mD,EAAE6hB,EAAEjC,GAAG,IAAIokC,GAAGniC,GAAG,MAAMuD,MAAMxD,EAAE,MAAM,OAAOsiC,GAAG,KAAKlkD,EAAE6hB,GAAE,EAAGjC,EAAE,EAC/YtrB,EAAQyyD,YAAY,SAAS/mD,EAAE6hB,EAAEjC,GAAG,IAAImkC,GAAG/jD,GAAG,MAAMolB,MAAMxD,EAAE,MAAM,IAAIa,EAAE,MAAM7C,GAAGA,EAAEonC,iBAAiB,KAAKj1C,GAAE,EAAG5Z,EAAE,GAAGuqB,EAAEghC,GAAyO,GAAtO,OAAO9jC,QAAG,IAASA,KAAI,IAAKA,EAAE+mC,sBAAsB50C,GAAE,QAAI,IAAS6N,EAAEw3B,mBAAmBj/C,EAAEynB,EAAEw3B,uBAAkB,IAASx3B,EAAE2iC,qBAAqB7/B,EAAE9C,EAAE2iC,qBAAqB1gC,EAAEshC,GAAGthC,EAAE,KAAK7hB,EAAE,EAAE,MAAM4f,EAAEA,EAAE,KAAK7N,EAAE,EAAG5Z,EAAEuqB,GAAG1iB,EAAEslC,IAAIzjB,EAAEzb,QAAQ4+B,GAAGhlC,GAAMyiB,EAAE,IAAIziB,EAAE,EAAEA,EAAEyiB,EAAEnvB,OAAO0M,IAA2B+R,GAAhBA,GAAP6N,EAAE6C,EAAEziB,IAAOinD,aAAgBrnC,EAAEsnC,SAAS,MAAMrlC,EAAEmhC,gCAAgCnhC,EAAEmhC,gCAAgC,CAACpjC,EAAE7N,GAAG8P,EAAEmhC,gCAAgCvvD,KAAKmsB,EACvhB7N,GAAG,OAAO,IAAI+xC,GAAGjiC,EAAE,EAAEvtB,EAAQuxB,OAAO,SAAS7lB,EAAE6hB,EAAEjC,GAAG,IAAIokC,GAAGniC,GAAG,MAAMuD,MAAMxD,EAAE,MAAM,OAAOsiC,GAAG,KAAKlkD,EAAE6hB,GAAE,EAAGjC,EAAE,EAAEtrB,EAAQ6yD,uBAAuB,SAASnnD,GAAG,IAAIgkD,GAAGhkD,GAAG,MAAMolB,MAAMxD,EAAE,KAAK,QAAO5hB,EAAE49C,sBAAqBkE,IAAG,WAAWoC,GAAG,KAAK,KAAKlkD,GAAE,GAAG,WAAWA,EAAE49C,oBAAoB,KAAK59C,EAAEslC,IAAI,IAAI,GAAE,KAAG,EAAM,EAAEhxC,EAAQ8yD,wBAAwBvF,GAC/UvtD,EAAQ+yD,oCAAoC,SAASrnD,EAAE6hB,EAAEjC,EAAE6C,GAAG,IAAIuhC,GAAGpkC,GAAG,MAAMwF,MAAMxD,EAAE,MAAM,GAAG,MAAM5hB,QAAG,IAASA,EAAE8uC,gBAAgB,MAAM1pB,MAAMxD,EAAE,KAAK,OAAOsiC,GAAGlkD,EAAE6hB,EAAEjC,GAAE,EAAG6C,EAAE,EAAEnuB,EAAQyF,QAAQ,qEChU7L,SAASutD,IAEP,GAC4C,qBAAnCnB,gCAC4C,oBAA5CA,+BAA+BmB,SAcxC,IAEEnB,+BAA+BmB,SAASA,EAC1C,CAAE,MAAOC,GAGP9P,QAAQhgD,MAAM8vD,EAChB,CACF,CAKED,GACAjzD,EAAOC,QAAU,EAAjBD,yCCzBW,IAAI8D,EAAE1D,EAAQ,MAASixB,EAAEzb,OAAOia,IAAI,iBAAiB1V,EAAEvE,OAAOia,IAAI,kBAAkB7kB,EAAEtL,OAAOC,UAAUf,eAAewM,EAAEtH,EAAE6rB,mDAAmDy0B,kBAAkB72B,EAAE,CAAC1tB,KAAI,EAAGm8C,KAAI,EAAGmX,QAAO,EAAGC,UAAS,GAChP,SAAStZ,EAAEvuB,EAAE5f,EAAE0iB,GAAG,IAAIb,EAAEY,EAAE,CAAC,EAAE1Q,EAAE,KAAK0T,EAAE,KAAiF,IAAI5D,UAAhF,IAASa,IAAI3Q,EAAE,GAAG2Q,QAAG,IAAS1iB,EAAE9L,MAAM6d,EAAE,GAAG/R,EAAE9L,UAAK,IAAS8L,EAAEqwC,MAAM5qB,EAAEzlB,EAAEqwC,KAAcrwC,EAAEX,EAAElL,KAAK6L,EAAE6hB,KAAKD,EAAE3uB,eAAe4uB,KAAKY,EAAEZ,GAAG7hB,EAAE6hB,IAAI,GAAGjC,GAAGA,EAAE8rB,aAAa,IAAI7pB,KAAK7hB,EAAE4f,EAAE8rB,kBAAe,IAASjpB,EAAEZ,KAAKY,EAAEZ,GAAG7hB,EAAE6hB,IAAI,MAAM,CAACkE,SAASL,EAAErkB,KAAKue,EAAE1rB,IAAI6d,EAAEs+B,IAAI5qB,EAAE7f,MAAM6c,EAAE6tB,OAAO7wC,EAAE2G,QAAQ,CAAC9R,EAAQozD,SAASl5C,EAAEla,EAAQqzD,IAAIxZ,EAAE75C,EAAQszD,KAAKzZ,mCCD7V,IAAI3/B,EAAEvE,OAAOia,IAAI,iBAAiBzkB,EAAEwK,OAAOia,IAAI,gBAAgBtC,EAAE3X,OAAOia,IAAI,kBAAkBiqB,EAAElkC,OAAOia,IAAI,qBAAqBkqB,EAAEnkC,OAAOia,IAAI,kBAAkBghB,EAAEj7B,OAAOia,IAAI,kBAAkBkhB,EAAEn7B,OAAOia,IAAI,iBAAiB1B,EAAEvY,OAAOia,IAAI,qBAAqBlD,EAAE/W,OAAOia,IAAI,kBAAkB3gB,EAAE0G,OAAOia,IAAI,cAAcmqB,EAAEpkC,OAAOia,IAAI,cAAchB,EAAEjZ,OAAOgB,SACzW,IAAI4lB,EAAE,CAACge,UAAU,WAAW,OAAM,CAAE,EAAEO,mBAAmB,WAAW,EAAED,oBAAoB,WAAW,EAAEJ,gBAAgB,WAAW,GAAGp4C,EAAE5C,OAAOmxB,OAAOyf,EAAE,CAAC,EAAE,SAASmD,EAAE9nC,EAAE6hB,EAAE9P,GAAGjS,KAAK8F,MAAM5F,EAAEF,KAAK0N,QAAQqU,EAAE/hB,KAAK4uC,KAAK/J,EAAE7kC,KAAK4vC,QAAQ39B,GAAG8e,CAAC,CACwI,SAASvrB,IAAI,CAAyB,SAASyiC,EAAE/nC,EAAE6hB,EAAE9P,GAAGjS,KAAK8F,MAAM5F,EAAEF,KAAK0N,QAAQqU,EAAE/hB,KAAK4uC,KAAK/J,EAAE7kC,KAAK4vC,QAAQ39B,GAAG8e,CAAC,CADxPiX,EAAE9zC,UAAU6uD,iBAAiB,CAAC,EACpQ/a,EAAE9zC,UAAU6zD,SAAS,SAAS7nD,EAAE6hB,GAAG,GAAG,kBAAkB7hB,GAAG,oBAAoBA,GAAG,MAAMA,EAAE,MAAMolB,MAAM,yHAAyHtlB,KAAK4vC,QAAQX,gBAAgBjvC,KAAKE,EAAE6hB,EAAE,WAAW,EAAEimB,EAAE9zC,UAAU8zD,YAAY,SAAS9nD,GAAGF,KAAK4vC,QAAQN,mBAAmBtvC,KAAKE,EAAE,cAAc,EAAgBsF,EAAEtR,UAAU8zC,EAAE9zC,UAAsF,IAAIi0C,EAAEF,EAAE/zC,UAAU,IAAIsR,EACrf2iC,EAAErxC,YAAYmxC,EAAEpxC,EAAEsxC,EAAEH,EAAE9zC,WAAWi0C,EAAEsH,sBAAqB,EAAG,IAAIlF,EAAE32C,MAAMC,QAAQwxC,EAAEpxC,OAAOC,UAAUf,eAAe86C,EAAE,CAAC3nC,QAAQ,MAAM4oC,EAAE,CAAC96C,KAAI,EAAGm8C,KAAI,EAAGmX,QAAO,EAAGC,UAAS,GACtK,SAAS5V,EAAE7xC,EAAE6hB,EAAE9P,GAAG,IAAI0Q,EAAE7C,EAAE,CAAC,EAAE8F,EAAE,KAAKD,EAAE,KAAK,GAAG,MAAM5D,EAAE,IAAIY,UAAK,IAASZ,EAAEwuB,MAAM5qB,EAAE5D,EAAEwuB,UAAK,IAASxuB,EAAE3tB,MAAMwxB,EAAE,GAAG7D,EAAE3tB,KAAK2tB,EAAEsjB,EAAEhxC,KAAK0tB,EAAEY,KAAKusB,EAAE/7C,eAAewvB,KAAK7C,EAAE6C,GAAGZ,EAAEY,IAAI,IAAIC,EAAErvB,UAAUC,OAAO,EAAE,GAAG,IAAIovB,EAAE9C,EAAEyI,SAAStW,OAAO,GAAG,EAAE2Q,EAAE,CAAC,IAAI,IAAIvqB,EAAEzE,MAAMgvB,GAAGrjB,EAAE,EAAEA,EAAEqjB,EAAErjB,IAAIlH,EAAEkH,GAAGhM,UAAUgM,EAAE,GAAGugB,EAAEyI,SAASlwB,CAAC,CAAC,GAAG6H,GAAGA,EAAE0rC,aAAa,IAAIjpB,KAAKC,EAAE1iB,EAAE0rC,kBAAe,IAAS9rB,EAAE6C,KAAK7C,EAAE6C,GAAGC,EAAED,IAAI,MAAM,CAACsD,SAASvX,EAAEnN,KAAKrB,EAAE9L,IAAIwxB,EAAE2qB,IAAI5qB,EAAE7f,MAAMga,EAAE0wB,OAAOvC,EAAE3nC,QAAQ,CAChV,SAAS/P,EAAE2J,GAAG,MAAM,kBAAkBA,GAAG,OAAOA,GAAGA,EAAE+lB,WAAWvX,CAAC,CAAoG,IAAIjQ,EAAE,OAAO,SAASq0C,EAAE5yC,EAAE6hB,GAAG,MAAM,kBAAkB7hB,GAAG,OAAOA,GAAG,MAAMA,EAAE9L,IAA7K,SAAgB8L,GAAG,IAAI6hB,EAAE,CAAC,IAAI,KAAK,IAAI,MAAM,MAAM,IAAI7hB,EAAEpB,QAAQ,SAAQ,SAASoB,GAAG,OAAO6hB,EAAE7hB,EAAE,GAAE,CAA+E+nD,CAAO,GAAG/nD,EAAE9L,KAAK2tB,EAAE/tB,SAAS,GAAG,CAC/W,SAASqT,EAAEnH,EAAE6hB,EAAE9P,EAAE0Q,EAAE7C,GAAG,IAAI8F,SAAS1lB,EAAK,cAAc0lB,GAAG,YAAYA,IAAE1lB,EAAE,MAAK,IAAIylB,GAAE,EAAG,GAAG,OAAOzlB,EAAEylB,GAAE,OAAQ,OAAOC,GAAG,IAAK,SAAS,IAAK,SAASD,GAAE,EAAG,MAAM,IAAK,SAAS,OAAOzlB,EAAE+lB,UAAU,KAAKvX,EAAE,KAAK/O,EAAEgmB,GAAE,GAAI,GAAGA,EAAE,OAAW7F,EAAEA,EAAN6F,EAAEzlB,GAASA,EAAE,KAAKyiB,EAAE,IAAImwB,EAAEntB,EAAE,GAAGhD,EAAE4nB,EAAEzqB,IAAI7N,EAAE,GAAG,MAAM/R,IAAI+R,EAAE/R,EAAEpB,QAAQL,EAAE,OAAO,KAAK4I,EAAEyY,EAAEiC,EAAE9P,EAAE,IAAG,SAAS/R,GAAG,OAAOA,CAAC,KAAI,MAAM4f,IAAIvpB,EAAEupB,KAAKA,EADnW,SAAW5f,EAAE6hB,GAAG,MAAM,CAACkE,SAASvX,EAAEnN,KAAKrB,EAAEqB,KAAKnN,IAAI2tB,EAAEwuB,IAAIrwC,EAAEqwC,IAAIzqC,MAAM5F,EAAE4F,MAAM0qC,OAAOtwC,EAAEswC,OAAO,CACyQiC,CAAE3yB,EAAE7N,IAAI6N,EAAE1rB,KAAKuxB,GAAGA,EAAEvxB,MAAM0rB,EAAE1rB,IAAI,IAAI,GAAG0rB,EAAE1rB,KAAK0K,QAAQL,EAAE,OAAO,KAAKyB,IAAI6hB,EAAEpuB,KAAKmsB,IAAI,EAAyB,GAAvB6F,EAAE,EAAEhD,EAAE,KAAKA,EAAE,IAAIA,EAAE,IAAO4nB,EAAErqC,GAAG,IAAI,IAAI0iB,EAAE,EAAEA,EAAE1iB,EAAE1M,OAAOovB,IAAI,CAC/e,IAAIvqB,EAAEsqB,EAAEmwB,EADweltB,EACrf1lB,EAAE0iB,GAAeA,GAAG+C,GAAGte,EAAEue,EAAE7D,EAAE9P,EAAE5Z,EAAEynB,EAAE,MAAM,GAAGznB,EAPsU,SAAW6H,GAAG,OAAG,OAAOA,GAAG,kBAAkBA,EAAS,KAAsC,oBAAjCA,EAAEkjB,GAAGljB,EAAEkjB,IAAIljB,EAAE,eAA0CA,EAAE,IAAI,CAO5b0L,CAAE1L,GAAG,oBAAoB7H,EAAE,IAAI6H,EAAE7H,EAAEhE,KAAK6L,GAAG0iB,EAAE,IAAIgD,EAAE1lB,EAAE2sC,QAAQlwC,MAA6BgpB,GAAGte,EAA1Bue,EAAEA,EAAErwB,MAA0BwsB,EAAE9P,EAAtB5Z,EAAEsqB,EAAEmwB,EAAEltB,EAAEhD,KAAkB9C,QAAQ,GAAG,WAAW8F,EAAE,MAAM7D,EAAEjsB,OAAOoK,GAAGolB,MAAM,mDAAmD,oBAAoBvD,EAAE,qBAAqB9tB,OAAOmE,KAAK8H,GAAG5L,KAAK,MAAM,IAAIytB,GAAG,6EAA6E,OAAO4D,CAAC,CACzZ,SAASlwB,EAAEyK,EAAE6hB,EAAE9P,GAAG,GAAG,MAAM/R,EAAE,OAAOA,EAAE,IAAIyiB,EAAE,GAAG7C,EAAE,EAAmD,OAAjDzY,EAAEnH,EAAEyiB,EAAE,GAAG,IAAG,SAASziB,GAAG,OAAO6hB,EAAE1tB,KAAK4d,EAAE/R,EAAE4f,IAAI,IAAU6C,CAAC,CAAC,SAAS+5B,EAAEx8C,GAAG,IAAI,IAAIA,EAAEgoD,QAAQ,CAAC,IAAInmC,EAAE7hB,EAAEioD,SAAQpmC,EAAEA,KAAMklB,MAAK,SAASllB,GAAM,IAAI7hB,EAAEgoD,UAAU,IAAIhoD,EAAEgoD,UAAQhoD,EAAEgoD,QAAQ,EAAEhoD,EAAEioD,QAAQpmC,EAAC,IAAE,SAASA,GAAM,IAAI7hB,EAAEgoD,UAAU,IAAIhoD,EAAEgoD,UAAQhoD,EAAEgoD,QAAQ,EAAEhoD,EAAEioD,QAAQpmC,EAAC,KAAI,IAAI7hB,EAAEgoD,UAAUhoD,EAAEgoD,QAAQ,EAAEhoD,EAAEioD,QAAQpmC,EAAE,CAAC,GAAG,IAAI7hB,EAAEgoD,QAAQ,OAAOhoD,EAAEioD,QAAQ1zD,QAAQ,MAAMyL,EAAEioD,OAAQ,CAC5Z,IAAIpL,EAAE,CAACz2C,QAAQ,MAAM9H,EAAE,CAACs3B,WAAW,MAAMqnB,EAAE,CAAC7K,uBAAuByK,EAAEpnB,wBAAwBn3B,EAAEm6C,kBAAkB1K,GAAGz5C,EAAQ4zD,SAAS,CAAC51C,IAAI/c,EAAEgd,QAAQ,SAASvS,EAAE6hB,EAAE9P,GAAGxc,EAAEyK,GAAE,WAAW6hB,EAAEhuB,MAAMiM,KAAKzM,UAAU,GAAE0e,EAAE,EAAEo2C,MAAM,SAASnoD,GAAG,IAAI6hB,EAAE,EAAuB,OAArBtsB,EAAEyK,GAAE,WAAW6hB,GAAG,IAAUA,CAAC,EAAEumC,QAAQ,SAASpoD,GAAG,OAAOzK,EAAEyK,GAAE,SAASA,GAAG,OAAOA,CAAC,KAAI,EAAE,EAAEqoD,KAAK,SAASroD,GAAG,IAAI3J,EAAE2J,GAAG,MAAMolB,MAAM,yEAAyE,OAAOplB,CAAC,GAAG1L,EAAQm6C,UAAU3G,EAAExzC,EAAQozD,SAAS9lC,EACnettB,EAAQg0D,SAASla,EAAE95C,EAAQi0D,cAAcxgB,EAAEzzC,EAAQk0D,WAAWra,EAAE75C,EAAQm0D,SAASznC,EAAE1sB,EAAQ0vB,mDAAmDi5B,EAC9I3oD,EAAQo0D,aAAa,SAAS1oD,EAAE6hB,EAAE9P,GAAG,GAAG,OAAO/R,QAAG,IAASA,EAAE,MAAMolB,MAAM,iFAAiFplB,EAAE,KAAK,IAAIyiB,EAAE9rB,EAAE,CAAC,EAAEqJ,EAAE4F,OAAOga,EAAE5f,EAAE9L,IAAIwxB,EAAE1lB,EAAEqwC,IAAI5qB,EAAEzlB,EAAEswC,OAAO,GAAG,MAAMzuB,EAAE,CAAoE,QAAnE,IAASA,EAAEwuB,MAAM3qB,EAAE7D,EAAEwuB,IAAI5qB,EAAEsoB,EAAE3nC,cAAS,IAASyb,EAAE3tB,MAAM0rB,EAAE,GAAGiC,EAAE3tB,KAAQ8L,EAAEqB,MAAMrB,EAAEqB,KAAKqqC,aAAa,IAAIhpB,EAAE1iB,EAAEqB,KAAKqqC,aAAa,IAAIvzC,KAAK0pB,EAAEsjB,EAAEhxC,KAAK0tB,EAAE1pB,KAAK62C,EAAE/7C,eAAekF,KAAKsqB,EAAEtqB,QAAG,IAAS0pB,EAAE1pB,SAAI,IAASuqB,EAAEA,EAAEvqB,GAAG0pB,EAAE1pB,GAAG,CAAC,IAAIA,EAAE9E,UAAUC,OAAO,EAAE,GAAG,IAAI6E,EAAEsqB,EAAE4F,SAAStW,OAAO,GAAG,EAAE5Z,EAAE,CAACuqB,EAAEhvB,MAAMyE,GACrf,IAAI,IAAIkH,EAAE,EAAEA,EAAElH,EAAEkH,IAAIqjB,EAAErjB,GAAGhM,UAAUgM,EAAE,GAAGojB,EAAE4F,SAAS3F,CAAC,CAAC,MAAM,CAACqD,SAASvX,EAAEnN,KAAKrB,EAAEqB,KAAKnN,IAAI0rB,EAAEywB,IAAI3qB,EAAE9f,MAAM6c,EAAE6tB,OAAO7qB,EAAE,EAAEnxB,EAAQq0D,cAAc,SAAS3oD,GAAqK,OAAlKA,EAAE,CAAC+lB,SAASqf,EAAE6G,cAAcjsC,EAAE4oD,eAAe5oD,EAAE6oD,aAAa,EAAEC,SAAS,KAAKC,SAAS,KAAKC,cAAc,KAAKC,YAAY,OAAQH,SAAS,CAAC/iC,SAASmf,EAAElf,SAAShmB,GAAUA,EAAE+oD,SAAS/oD,CAAC,EAAE1L,EAAQqF,cAAck4C,EAAEv9C,EAAQ40D,cAAc,SAASlpD,GAAG,IAAI6hB,EAAEgwB,EAAEl1C,KAAK,KAAKqD,GAAY,OAAT6hB,EAAExgB,KAAKrB,EAAS6hB,CAAC,EAAEvtB,EAAQ60D,UAAU,WAAW,MAAM,CAAC/iD,QAAQ,KAAK,EAC9d9R,EAAQ80D,WAAW,SAASppD,GAAG,MAAM,CAAC+lB,SAASvD,EAAEqD,OAAO7lB,EAAE,EAAE1L,EAAQ+0D,eAAehzD,EAAE/B,EAAQg1D,KAAK,SAAStpD,GAAG,MAAM,CAAC+lB,SAASsoB,EAAEpoB,SAAS,CAAC+hC,SAAS,EAAEC,QAAQjoD,GAAGkmB,MAAMs2B,EAAE,EAAEloD,EAAQi1D,KAAK,SAASvpD,EAAE6hB,GAAG,MAAM,CAACkE,SAASxiB,EAAElC,KAAKrB,EAAE+4C,aAAQ,IAASl3B,EAAE,KAAKA,EAAE,EAAEvtB,EAAQk1D,gBAAgB,SAASxpD,GAAG,IAAI6hB,EAAEvjB,EAAEs3B,WAAWt3B,EAAEs3B,WAAW,CAAC,EAAE,IAAI51B,GAAG,CAAC,QAAQ1B,EAAEs3B,WAAW/T,CAAC,CAAC,EAAEvtB,EAAQm1D,aAAa,WAAW,MAAMrkC,MAAM,2DAA4D,EAC1c9wB,EAAQ6hD,YAAY,SAASn2C,EAAE6hB,GAAG,OAAOg7B,EAAEz2C,QAAQ+vC,YAAYn2C,EAAE6hB,EAAE,EAAEvtB,EAAQ8hD,WAAW,SAASp2C,GAAG,OAAO68C,EAAEz2C,QAAQgwC,WAAWp2C,EAAE,EAAE1L,EAAQuiD,cAAc,WAAW,EAAEviD,EAAQwiD,iBAAiB,SAAS92C,GAAG,OAAO68C,EAAEz2C,QAAQ0wC,iBAAiB92C,EAAE,EAAE1L,EAAQ+hD,UAAU,SAASr2C,EAAE6hB,GAAG,OAAOg7B,EAAEz2C,QAAQiwC,UAAUr2C,EAAE6hB,EAAE,EAAEvtB,EAAQ4iD,MAAM,WAAW,OAAO2F,EAAEz2C,QAAQ8wC,OAAO,EAAE5iD,EAAQgiD,oBAAoB,SAASt2C,EAAE6hB,EAAE9P,GAAG,OAAO8qC,EAAEz2C,QAAQkwC,oBAAoBt2C,EAAE6hB,EAAE9P,EAAE,EAC7bzd,EAAQiiD,mBAAmB,SAASv2C,EAAE6hB,GAAG,OAAOg7B,EAAEz2C,QAAQmwC,mBAAmBv2C,EAAE6hB,EAAE,EAAEvtB,EAAQkiD,gBAAgB,SAASx2C,EAAE6hB,GAAG,OAAOg7B,EAAEz2C,QAAQowC,gBAAgBx2C,EAAE6hB,EAAE,EAAEvtB,EAAQmiD,QAAQ,SAASz2C,EAAE6hB,GAAG,OAAOg7B,EAAEz2C,QAAQqwC,QAAQz2C,EAAE6hB,EAAE,EAAEvtB,EAAQoiD,WAAW,SAAS12C,EAAE6hB,EAAE9P,GAAG,OAAO8qC,EAAEz2C,QAAQswC,WAAW12C,EAAE6hB,EAAE9P,EAAE,EAAEzd,EAAQqiD,OAAO,SAAS32C,GAAG,OAAO68C,EAAEz2C,QAAQuwC,OAAO32C,EAAE,EAAE1L,EAAQsiD,SAAS,SAAS52C,GAAG,OAAO68C,EAAEz2C,QAAQwwC,SAAS52C,EAAE,EAAE1L,EAAQ2iD,qBAAqB,SAASj3C,EAAE6hB,EAAE9P,GAAG,OAAO8qC,EAAEz2C,QAAQ6wC,qBAAqBj3C,EAAE6hB,EAAE9P,EAAE,EAC/ezd,EAAQyiD,cAAc,WAAW,OAAO8F,EAAEz2C,QAAQ2wC,eAAe,EAAEziD,EAAQyF,QAAQ,4CCtBjF1F,EAAOC,QAAU,EAAjBD,wCCAAA,EAAOC,QAAU,EAAjBD,uCCMW,SAAS8D,EAAE6H,EAAE6hB,GAAG,IAAIjC,EAAE5f,EAAE1M,OAAO0M,EAAEvM,KAAKouB,GAAG7hB,EAAE,KAAK,EAAE4f,GAAG,CAAC,IAAI6C,EAAE7C,EAAE,IAAI,EAAE7N,EAAE/R,EAAEyiB,GAAG,KAAG,EAAEC,EAAE3Q,EAAE8P,IAA0B,MAAM7hB,EAA7BA,EAAEyiB,GAAGZ,EAAE7hB,EAAE4f,GAAG7N,EAAE6N,EAAE6C,CAAc,CAAC,CAAC,SAASgD,EAAEzlB,GAAG,OAAO,IAAIA,EAAE1M,OAAO,KAAK0M,EAAE,EAAE,CAAC,SAAS0lB,EAAE1lB,GAAG,GAAG,IAAIA,EAAE1M,OAAO,OAAO,KAAK,IAAIuuB,EAAE7hB,EAAE,GAAG4f,EAAE5f,EAAEma,MAAM,GAAGyF,IAAIiC,EAAE,CAAC7hB,EAAE,GAAG4f,EAAE5f,EAAE,IAAI,IAAIyiB,EAAE,EAAE1Q,EAAE/R,EAAE1M,OAAO0tB,EAAEjP,IAAI,EAAE0Q,EAAEzB,GAAG,CAAC,IAAI3hB,EAAE,GAAGojB,EAAE,GAAG,EAAE9rB,EAAEqJ,EAAEX,GAAGI,EAAEJ,EAAE,EAAEkE,EAAEvD,EAAEP,GAAG,GAAG,EAAEijB,EAAE/rB,EAAEipB,GAAGngB,EAAEsS,GAAG,EAAE2Q,EAAEnf,EAAE5M,IAAIqJ,EAAEyiB,GAAGlf,EAAEvD,EAAEP,GAAGmgB,EAAE6C,EAAEhjB,IAAIO,EAAEyiB,GAAG9rB,EAAEqJ,EAAEX,GAAGugB,EAAE6C,EAAEpjB,OAAQ,MAAGI,EAAEsS,GAAG,EAAE2Q,EAAEnf,EAAEqc,IAA0B,MAAM5f,EAA7BA,EAAEyiB,GAAGlf,EAAEvD,EAAEP,GAAGmgB,EAAE6C,EAAEhjB,CAAc,EAAC,CAAC,OAAOoiB,CAAC,CAC3c,SAASa,EAAE1iB,EAAE6hB,GAAG,IAAIjC,EAAE5f,EAAE0pD,UAAU7nC,EAAE6nC,UAAU,OAAO,IAAI9pC,EAAEA,EAAE5f,EAAE6K,GAAGgX,EAAEhX,EAAE,CAAC,GAAG,kBAAkB8+C,aAAa,oBAAoBA,YAAYpuC,IAAI,CAAC,IAAI/M,EAAEm7C,YAAYr1D,EAAQw8B,aAAa,WAAW,OAAOtiB,EAAE+M,KAAK,CAAC,KAAK,CAAC,IAAIqG,EAAEpG,KAAK2yB,EAAEvsB,EAAErG,MAAMjnB,EAAQw8B,aAAa,WAAW,OAAOlP,EAAErG,MAAM4yB,CAAC,CAAC,CAAC,IAAIC,EAAE,GAAGlJ,EAAE,GAAGE,EAAE,EAAE5iB,EAAE,KAAK6rB,EAAE,EAAEnrB,GAAE,EAAGxX,GAAE,EAAGmlB,GAAE,EAAG8T,EAAE,oBAAoBjoB,WAAWA,WAAW,KAAKorB,EAAE,oBAAoB7qB,aAAaA,aAAa,KAAK3X,EAAE,qBAAqBskD,aAAaA,aAAa,KACnT,SAAS7hB,EAAE/nC,GAAG,IAAI,IAAI6hB,EAAE4D,EAAEyf,GAAG,OAAOrjB,GAAG,CAAC,GAAG,OAAOA,EAAEgsB,SAASnoB,EAAEwf,OAAQ,MAAGrjB,EAAEgoC,WAAW7pD,GAAgD,MAA9C0lB,EAAEwf,GAAGrjB,EAAE6nC,UAAU7nC,EAAEioC,eAAe3xD,EAAEi2C,EAAEvsB,EAAa,CAACA,EAAE4D,EAAEyf,EAAE,CAAC,CAAC,SAAS+C,EAAEjoC,GAAa,GAAV6wB,GAAE,EAAGkX,EAAE/nC,IAAO0L,EAAE,GAAG,OAAO+Z,EAAE2oB,GAAG1iC,GAAE,EAAG2+B,EAAElF,OAAO,CAAC,IAAItjB,EAAE4D,EAAEyf,GAAG,OAAOrjB,GAAGksB,EAAE9F,EAAEpmB,EAAEgoC,UAAU7pD,EAAE,CAAC,CACra,SAASmlC,EAAEnlC,EAAE6hB,GAAGnW,GAAE,EAAGmlB,IAAIA,GAAE,EAAGiX,EAAEkH,GAAGA,GAAG,GAAG9rB,GAAE,EAAG,IAAItD,EAAEyuB,EAAE,IAAS,IAALtG,EAAElmB,GAAOW,EAAEiD,EAAE2oB,GAAG,OAAO5rB,MAAMA,EAAEsnC,eAAejoC,IAAI7hB,IAAI6xC,MAAM,CAAC,IAAIpvB,EAAED,EAAEqrB,SAAS,GAAG,oBAAoBprB,EAAE,CAACD,EAAEqrB,SAAS,KAAKQ,EAAE7rB,EAAEunC,cAAc,IAAIh4C,EAAE0Q,EAAED,EAAEsnC,gBAAgBjoC,GAAGA,EAAEvtB,EAAQw8B,eAAe,oBAAoB/e,EAAEyQ,EAAEqrB,SAAS97B,EAAEyQ,IAAIiD,EAAE2oB,IAAI1oB,EAAE0oB,GAAGrG,EAAElmB,EAAE,MAAM6D,EAAE0oB,GAAG5rB,EAAEiD,EAAE2oB,EAAE,CAAC,GAAG,OAAO5rB,EAAE,IAAIxB,GAAE,MAAO,CAAC,IAAI3hB,EAAEomB,EAAEyf,GAAG,OAAO7lC,GAAG0uC,EAAE9F,EAAE5oC,EAAEwqD,UAAUhoC,GAAGb,GAAE,CAAE,CAAC,OAAOA,CAAC,CAAC,QAAQwB,EAAE,KAAK6rB,EAAEzuB,EAAEsD,GAAE,CAAE,CAAC,CAD1a,qBAAqBtpB,gBAAW,IAASA,UAAUowD,iBAAY,IAASpwD,UAAUowD,WAAWC,gBAAgBrwD,UAAUowD,WAAWC,eAAettD,KAAK/C,UAAUowD,YAC2Q,IACzPz0D,EAD6Pg9C,GAAE,EAAGl8C,EAAE,KAAK24C,GAAG,EAAEzwC,EAAE,EAAEq0C,GAAG,EACvc,SAASf,IAAI,QAAOv9C,EAAQw8B,eAAe8hB,EAAEr0C,EAAO,CAAC,SAAS4I,IAAI,GAAG,OAAO9Q,EAAE,CAAC,IAAI2J,EAAE1L,EAAQw8B,eAAe8hB,EAAE5yC,EAAE,IAAI6hB,GAAE,EAAG,IAAIA,EAAExrB,GAAE,EAAG2J,EAAE,CAAC,QAAQ6hB,EAAEtsB,KAAKg9C,GAAE,EAAGl8C,EAAE,KAAK,CAAC,MAAMk8C,GAAE,CAAE,CAAO,GAAG,oBAAoBjtC,EAAE/P,EAAE,WAAW+P,EAAE6B,EAAE,OAAO,GAAG,qBAAqB+iD,eAAe,CAAC,IAAI1N,EAAE,IAAI0N,eAAerN,EAAEL,EAAE2N,MAAM3N,EAAE4N,MAAMC,UAAUljD,EAAE5R,EAAE,WAAWsnD,EAAEyN,YAAY,KAAK,CAAC,MAAM/0D,EAAE,WAAWovC,EAAEx9B,EAAE,EAAE,EAAE,SAASkjC,EAAErqC,GAAG3J,EAAE2J,EAAEuyC,IAAIA,GAAE,EAAGh9C,IAAI,CAAC,SAASw4C,EAAE/tC,EAAE6hB,GAAGmtB,EAAErK,GAAE,WAAW3kC,EAAE1L,EAAQw8B,eAAe,GAAEjP,EAAE,CAC5dvtB,EAAQo9B,sBAAsB,EAAEp9B,EAAQ48B,2BAA2B,EAAE58B,EAAQk9B,qBAAqB,EAAEl9B,EAAQg9B,wBAAwB,EAAEh9B,EAAQi2D,mBAAmB,KAAKj2D,EAAQ88B,8BAA8B,EAAE98B,EAAQk8B,wBAAwB,SAASxwB,GAAGA,EAAE6tC,SAAS,IAAI,EAAEv5C,EAAQk2D,2BAA2B,WAAW9+C,GAAGwX,IAAIxX,GAAE,EAAG2+B,EAAElF,GAAG,EAC1U7wC,EAAQm2D,wBAAwB,SAASzqD,GAAG,EAAEA,GAAG,IAAIA,EAAEy3C,QAAQhgD,MAAM,mHAAmH8G,EAAE,EAAEyB,EAAErB,KAAKD,MAAM,IAAIsB,GAAG,CAAC,EAAE1L,EAAQ08B,iCAAiC,WAAW,OAAOqd,CAAC,EAAE/5C,EAAQo2D,8BAA8B,WAAW,OAAOjlC,EAAE2oB,EAAE,EAAE95C,EAAQq2D,cAAc,SAAS3qD,GAAG,OAAOquC,GAAG,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,IAAIxsB,EAAE,EAAE,MAAM,QAAQA,EAAEwsB,EAAE,IAAIzuB,EAAEyuB,EAAEA,EAAExsB,EAAE,IAAI,OAAO7hB,GAAG,CAAC,QAAQquC,EAAEzuB,CAAC,CAAC,EAAEtrB,EAAQs2D,wBAAwB,WAAW,EAC9ft2D,EAAQs8B,sBAAsB,WAAW,EAAEt8B,EAAQu2D,yBAAyB,SAAS7qD,EAAE6hB,GAAG,OAAO7hB,GAAG,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,MAAM,QAAQA,EAAE,EAAE,IAAI4f,EAAEyuB,EAAEA,EAAEruC,EAAE,IAAI,OAAO6hB,GAAG,CAAC,QAAQwsB,EAAEzuB,CAAC,CAAC,EAChMtrB,EAAQg8B,0BAA0B,SAAStwB,EAAE6hB,EAAEjC,GAAG,IAAI6C,EAAEnuB,EAAQw8B,eAA8F,OAA/E,kBAAkBlR,GAAG,OAAOA,EAAaA,EAAE,kBAAZA,EAAEA,EAAEkrC,QAA6B,EAAElrC,EAAE6C,EAAE7C,EAAE6C,EAAG7C,EAAE6C,EAASziB,GAAG,KAAK,EAAE,IAAI+R,GAAG,EAAE,MAAM,KAAK,EAAEA,EAAE,IAAI,MAAM,KAAK,EAAEA,EAAE,WAAW,MAAM,KAAK,EAAEA,EAAE,IAAI,MAAM,QAAQA,EAAE,IAAmN,OAAzM/R,EAAE,CAAC6K,GAAGu6B,IAAIyI,SAAShsB,EAAEkoC,cAAc/pD,EAAE6pD,UAAUjqC,EAAEkqC,eAAvD/3C,EAAE6N,EAAE7N,EAAoE23C,WAAW,GAAG9pC,EAAE6C,GAAGziB,EAAE0pD,UAAU9pC,EAAEznB,EAAE+sC,EAAEllC,GAAG,OAAOylB,EAAE2oB,IAAIpuC,IAAIylB,EAAEyf,KAAKrU,GAAGiX,EAAEkH,GAAGA,GAAG,GAAGne,GAAE,EAAGkd,EAAE9F,EAAEroB,EAAE6C,MAAMziB,EAAE0pD,UAAU33C,EAAE5Z,EAAEi2C,EAAEpuC,GAAG0L,GAAGwX,IAAIxX,GAAE,EAAG2+B,EAAElF,KAAYnlC,CAAC,EACne1L,EAAQo8B,qBAAqBmhB,EAAEv9C,EAAQy2D,sBAAsB,SAAS/qD,GAAG,IAAI6hB,EAAEwsB,EAAE,OAAO,WAAW,IAAIzuB,EAAEyuB,EAAEA,EAAExsB,EAAE,IAAI,OAAO7hB,EAAEnM,MAAMiM,KAAKzM,UAAU,CAAC,QAAQg7C,EAAEzuB,CAAC,CAAC,CAAC,qCCf7JvrB,EAAOC,QAAU,EAAjBD,QCFE22D,EAA2B,CAAC,EAGhC,SAASC,EAAoBC,GAE5B,IAAIC,EAAeH,EAAyBE,GAC5C,QAAqB/1D,IAAjBg2D,EACH,OAAOA,EAAa72D,QAGrB,IAAID,EAAS22D,EAAyBE,GAAY,CACjDrgD,GAAIqgD,EACJE,QAAQ,EACR92D,QAAS,CAAC,GAUX,OANA+2D,EAAoBH,GAAU72D,EAAQA,EAAOC,QAAS22D,GAGtD52D,EAAO+2D,QAAS,EAGT/2D,EAAOC,OACf,aCzBA,IACIg3D,EADAC,EAAWx3D,OAAOy3D,eAAiB,SAAS7oD,GAAO,OAAO5O,OAAOy3D,eAAe7oD,EAAM,EAAI,SAASA,GAAO,OAAOA,EAAIwL,SAAW,EAQpI88C,EAAoB/lB,EAAI,SAAS7vC,EAAO8T,GAEvC,GADU,EAAPA,IAAU9T,EAAQyK,KAAKzK,IAChB,EAAP8T,EAAU,OAAO9T,EACpB,GAAoB,kBAAVA,GAAsBA,EAAO,CACtC,GAAW,EAAP8T,GAAa9T,EAAMo2D,WAAY,OAAOp2D,EAC1C,GAAW,GAAP8T,GAAoC,oBAAf9T,EAAM0xC,KAAqB,OAAO1xC,CAC5D,CACA,IAAIq2D,EAAK33D,OAAOgB,OAAO,MACvBk2D,EAAoB7c,EAAEsd,GACtB,IAAIC,EAAM,CAAC,EACXL,EAAiBA,GAAkB,CAAC,KAAMC,EAAS,CAAC,GAAIA,EAAS,IAAKA,EAASA,IAC/E,IAAI,IAAInlD,EAAiB,EAAP+C,GAAY9T,EAAyB,iBAAX+Q,KAAyBklD,EAAeh1D,QAAQ8P,GAAUA,EAAUmlD,EAASnlD,GACxHrS,OAAOyS,oBAAoBJ,GAASmM,SAAQ,SAASre,GAAOy3D,EAAIz3D,GAAO,WAAa,OAAOmB,EAAMnB,EAAM,CAAG,IAI3G,OAFAy3D,EAAa,QAAI,WAAa,OAAOt2D,CAAO,EAC5C41D,EAAoBxoC,EAAEipC,EAAIC,GACnBD,CACR,KCxBAT,EAAoBxoC,EAAI,SAASnuB,EAASs3D,GACzC,IAAI,IAAI13D,KAAO03D,EACXX,EAAoBY,EAAED,EAAY13D,KAAS+2D,EAAoBY,EAAEv3D,EAASJ,IAC5EH,OAAOiB,eAAeV,EAASJ,EAAK,CAAEuE,YAAY,EAAMY,IAAKuyD,EAAW13D,IAG3E,ECPA+2D,EAAoBvoC,EAAI,WACvB,GAA0B,kBAAf/iB,WAAyB,OAAOA,WAC3C,IACC,OAAOG,MAAQ,IAAIrC,SAAS,cAAb,EAChB,CAAE,MAAOsU,GACR,GAAsB,kBAAXnS,OAAqB,OAAOA,MACxC,CACA,CAPuB,GCAxBqrD,EAAoBY,EAAI,SAASlpD,EAAKmpD,GAAQ,OAAO/3D,OAAOC,UAAUf,eAAekB,KAAKwO,EAAKmpD,EAAO,ECCtGb,EAAoB7c,EAAI,SAAS95C,GACX,qBAAX2V,QAA0BA,OAAOqJ,aAC1Cvf,OAAOiB,eAAeV,EAAS2V,OAAOqJ,YAAa,CAAEje,MAAO,WAE7DtB,OAAOiB,eAAeV,EAAS,aAAc,CAAEe,OAAO,GACvD,ECNA41D,EAAoBc,IAAM,SAAS13D,GAGlC,OAFAA,EAAO23D,MAAQ,GACV33D,EAAOg0B,WAAUh0B,EAAOg0B,SAAW,IACjCh0B,CACR,ECJA42D,EAAoBgB,QAAK92D,inBCAV,SAAS+2D,EAAgBxnB,EAAUynB,GAChD,KAAMznB,aAAoBynB,GACxB,MAAM,IAAIv3D,UAAU,oCAExB,CCJe,SAASw3D,EAAQzpD,GAG9B,OAAOypD,EAAU,mBAAqBniD,QAAU,iBAAmBA,OAAOgB,SAAW,SAAUtI,GAC7F,cAAcA,CAChB,EAAI,SAAUA,GACZ,OAAOA,GAAO,mBAAqBsH,QAAUtH,EAAI/L,cAAgBqT,QAAUtH,IAAQsH,OAAOjW,UAAY,gBAAkB2O,CAC1H,EAAGypD,EAAQzpD,EACb,CCNe,SAAS0pD,EAAe94D,GACrC,IAAIW,ECFS,SAAsB2S,EAAOylD,GAC1C,GAAuB,WAAnBF,EAAQvlD,IAAiC,OAAVA,EAAgB,OAAOA,EAC1D,IAAI0lD,EAAO1lD,EAAMoD,OAAOW,aACxB,QAAazV,IAATo3D,EAAoB,CACtB,IAAI1/C,EAAM0/C,EAAKp4D,KAAK0S,EAAOylD,GAAQ,WACnC,GAAqB,WAAjBF,EAAQv/C,GAAmB,OAAOA,EACtC,MAAM,IAAIjY,UAAU,+CACtB,CACA,OAAiB,WAAT03D,EAAoB12D,OAAS42D,QAAQ3lD,EAC/C,CDPY,CAAYtT,EAAK,UAC3B,MAAwB,WAAjB64D,EAAQl4D,GAAoBA,EAAM0B,OAAO1B,EAClD,CEJA,SAASu4D,EAAkB10D,EAAQ6N,GACjC,IAAK,IAAIxS,EAAI,EAAGA,EAAIwS,EAAMtS,OAAQF,IAAK,CACrC,IAAIuH,EAAaiL,EAAMxS,GACvBuH,EAAWlC,WAAakC,EAAWlC,aAAc,EACjDkC,EAAWvF,cAAe,EACtB,UAAWuF,IAAYA,EAAWjC,UAAW,GACjD3E,OAAOiB,eAAe+C,EAAQ,EAAc4C,EAAWzG,KAAMyG,EAC/D,CACF,CACe,SAAS+xD,EAAaP,EAAaQ,EAAYC,GAM5D,OALID,GAAYF,EAAkBN,EAAYn4D,UAAW24D,GACrDC,GAAaH,EAAkBN,EAAaS,GAChD74D,OAAOiB,eAAem3D,EAAa,YAAa,CAC9CzzD,UAAU,IAELyzD,CACT,CCjBe,SAASU,EAAgBhB,EAAGjqC,GAKzC,OAJAirC,EAAkB94D,OAAO+4D,eAAiB/4D,OAAO+4D,eAAenwD,OAAS,SAAyBkvD,EAAGjqC,GAEnG,OADAiqC,EAAE19C,UAAYyT,EACPiqC,CACT,EACOgB,EAAgBhB,EAAGjqC,EAC5B,CCLe,SAASmrC,EAAUC,EAAUC,GAC1C,GAA0B,oBAAfA,GAA4C,OAAfA,EACtC,MAAM,IAAIr4D,UAAU,sDAEtBo4D,EAASh5D,UAAYD,OAAOgB,OAAOk4D,GAAcA,EAAWj5D,UAAW,CACrE4C,YAAa,CACXvB,MAAO23D,EACPt0D,UAAU,EACVtD,cAAc,KAGlBrB,OAAOiB,eAAeg4D,EAAU,YAAa,CAC3Ct0D,UAAU,IAERu0D,GAAY,EAAeD,EAAUC,EAC3C,CChBe,SAASC,EAAgBrB,GAItC,OAHAqB,EAAkBn5D,OAAO+4D,eAAiB/4D,OAAOy3D,eAAe7uD,OAAS,SAAyBkvD,GAChG,OAAOA,EAAE19C,WAAapa,OAAOy3D,eAAeK,EAC9C,EACOqB,EAAgBrB,EACzB,CCLe,SAASsB,IACtB,GAAuB,qBAAZzvD,UAA4BA,QAAQ+D,UAAW,OAAO,EACjE,GAAI/D,QAAQ+D,UAAUvG,KAAM,OAAO,EACnC,GAAqB,oBAAVkyD,MAAsB,OAAO,EACxC,IAEE,OADAC,QAAQr5D,UAAUgT,QAAQ7S,KAAKuJ,QAAQ+D,UAAU4rD,QAAS,IAAI,WAAa,MACpE,CACT,CAAE,MAAOt7C,IACP,OAAO,CACT,CACF,CCVe,SAASu7C,EAAuBztD,GAC7C,QAAa,IAATA,EACF,MAAM,IAAI0tD,eAAe,6DAE3B,OAAO1tD,CACT,CCFe,SAAS2tD,EAAaC,GACnC,IAAIC,EAA4B,IAChC,OAAO,WACL,IACEl2D,EADEm2D,EAAQ,EAAeF,GAE3B,GAAIC,EAA2B,CAC7B,IAAIE,EAAY,EAAe9tD,MAAMlJ,YACrCY,EAASkG,QAAQ+D,UAAUksD,EAAOt6D,UAAWu6D,EAC/C,MACEp2D,EAASm2D,EAAM95D,MAAMiM,KAAMzM,WAE7B,OCZW,SAAoCwM,EAAM1L,GACvD,GAAIA,IAA2B,WAAlBi4D,EAAQj4D,IAAsC,oBAATA,GAChD,OAAOA,EACF,QAAa,IAATA,EACT,MAAM,IAAIS,UAAU,4DAEtB,OAAO,EAAsBiL,EAC/B,CDKW,CAA0BC,KAAMtI,EACzC,CACF,gDEhBe,SAASq2D,EAAkBC,EAAK5+C,IAClC,MAAPA,GAAeA,EAAM4+C,EAAIx6D,UAAQ4b,EAAM4+C,EAAIx6D,QAC/C,IAAK,IAAIF,EAAI,EAAG26D,EAAO,IAAIr6D,MAAMwb,GAAM9b,EAAI8b,EAAK9b,IAAK26D,EAAK36D,GAAK06D,EAAI16D,GACnE,OAAO26D,CACT,CCHe,SAASC,EAA4BnC,EAAGoC,GACrD,GAAKpC,EAAL,CACA,GAAiB,kBAANA,EAAgB,OAAO,EAAiBA,EAAGoC,GACtD,IAAIxuD,EAAI1L,OAAOC,UAAUF,SAASK,KAAK03D,GAAG70D,MAAM,GAAI,GAEpD,MADU,WAANyI,GAAkBosD,EAAEj1D,cAAa6I,EAAIosD,EAAEj1D,YAAYmC,MAC7C,QAAN0G,GAAqB,QAANA,EAAoB/L,MAAMw6D,KAAKrC,GACxC,cAANpsD,GAAqB,2CAA2C3B,KAAK2B,GAAW,EAAiBosD,EAAGoC,QAAxG,CALc,CAMhB,CCPe,SAAS,EAA2BpC,EAAGsC,GACpD,IAAIl3D,EAAuB,qBAAXgT,QAA0B4hD,EAAE5hD,OAAOgB,WAAa4gD,EAAE,cAClE,IAAK50D,EAAI,CACP,GAAIvD,MAAMC,QAAQk4D,KAAO50D,EAAK,EAA2B40D,KAAOsC,GAAkBtC,GAAyB,kBAAbA,EAAEv4D,OAAqB,CAC/G2D,IAAI40D,EAAI50D,GACZ,IAAI7D,EAAI,EACJkS,EAAI,WAAc,EACtB,MAAO,CACL8oD,EAAG9oD,EACH7F,EAAG,WACD,OAAIrM,GAAKy4D,EAAEv4D,OAAe,CACxBmJ,MAAM,GAED,CACLA,MAAM,EACNpH,MAAOw2D,EAAEz4D,KAEb,EACA2e,EAAG,SAAWs8C,GACZ,MAAMA,CACR,EACAl2D,EAAGmN,EAEP,CACA,MAAM,IAAI1Q,UAAU,wIACtB,CACA,IAEE2yD,EAFE+G,GAAmB,EACrBC,GAAS,EAEX,MAAO,CACLH,EAAG,WACDn3D,EAAKA,EAAG9C,KAAK03D,EACf,EACApsD,EAAG,WACD,IAAI+uD,EAAOv3D,EAAG01C,OAEd,OADA2hB,EAAmBE,EAAK/xD,KACjB+xD,CACT,EACAz8C,EAAG,SAAW08C,GACZF,GAAS,EACThH,EAAMkH,CACR,EACAt2D,EAAG,WACD,IACOm2D,GAAoC,MAAhBr3D,EAAW,QAAWA,EAAW,QAC5D,CAAE,QACA,GAAIs3D,EAAQ,MAAMhH,CACpB,CACF,EAEJ,CClDe,SAAS,EAAgB5kD,EAAKzO,EAAKmB,GAYhD,OAXAnB,EAAM,EAAcA,MACTyO,EACT5O,OAAOiB,eAAe2N,EAAKzO,EAAK,CAC9BmB,MAAOA,EACPoD,YAAY,EACZrD,cAAc,EACdsD,UAAU,IAGZiK,EAAIzO,GAAOmB,EAENsN,CACT,CCbA,SAAS/K,EAAQW,EAAQm2D,GACvB,IAAIx2D,EAAOnE,OAAOmE,KAAKK,GACvB,GAAIxE,OAAO0S,sBAAuB,CAChC,IAAInH,EAAUvL,OAAO0S,sBAAsBlO,GAC3Cm2D,IAAmBpvD,EAAUA,EAAQqvD,QAAO,SAAUC,GACpD,OAAO76D,OAAOqE,yBAAyBG,EAAQq2D,GAAKn2D,UACtD,KAAKP,EAAKzE,KAAKI,MAAMqE,EAAMoH,EAC7B,CACA,OAAOpH,CACT,CACe,SAAS22D,EAAe92D,GACrC,IAAK,IAAI3E,EAAI,EAAGA,EAAIC,UAAUC,OAAQF,IAAK,CACzC,IAAI4E,EAAS,MAAQ3E,UAAUD,GAAKC,UAAUD,GAAK,CAAC,EACpDA,EAAI,EAAIwE,EAAQ7D,OAAOiE,IAAS,GAAIua,SAAQ,SAAUre,GACpD,EAAe6D,EAAQ7D,EAAK8D,EAAO9D,GACrC,IAAKH,OAAO+6D,0BAA4B/6D,OAAO4R,iBAAiB5N,EAAQhE,OAAO+6D,0BAA0B92D,IAAWJ,EAAQ7D,OAAOiE,IAASua,SAAQ,SAAUre,GAC5JH,OAAOiB,eAAe+C,EAAQ7D,EAAKH,OAAOqE,yBAAyBJ,EAAQ9D,GAC7E,GACF,CACA,OAAO6D,CACT,CCPO,SAASg3D,EAAUloD,EAAYmoD,GACrC,IAC6BC,EADvBz3D,EAAc,GAAC03D,EAAAC,EACQtoD,GAAA,IAA7BuoD,EAAU,IAAAF,EAAAd,MAAAa,EAAAC,EAAAzvD,KAAAhD,MAA0B,KACZ4yD,EADHC,EAAAL,EAAA55D,MAAAk6D,EAAAJ,EACG33D,GAAA,IAAvB,IAAA+3D,EAAAnB,MAAAiB,EAAAE,EAAA9vD,KAAAhD,MAA+B,KAApB+yD,EAAAH,EAAAh6D,MACV,GAAI25D,EAASA,EAAOM,EAAME,GAAYF,IAASE,EAC9C,SAASJ,CAEX,QAAA7H,GAAAgI,EAAAx9C,EAAAw1C,EAAA,SAAAgI,EAAAp3D,GAAA,CACAX,EAAO/D,KAAK67D,EACb,QAAA/H,GAAA2H,EAAAn9C,EAAAw1C,EAAA,SAAA2H,EAAA/2D,GAAA,CACA,OAAOX,CACR,CAGO,SAASi4D,EAAW3B,GAC1B,OAAOA,EAAIa,QAAO,SAACv7D,GAAA,YAAY,IAANA,GAAyB,OAANA,CAAU,GACvD,CAGO,SAASqoD,EAAQqS,GACvB,OAAOA,EAAIA,EAAIx6D,OAAS,EACzB,CCEO,SAASo8D,EACf9xD,GAaA,OAXkB,SAAZ+xD,IACL,IACC,OAAO/xD,EAAA/J,WAAA,EAAAR,UACR,CAAE,MAAOoE,GAIR,MAHIA,aAAiB2tB,OAASA,MAAMwqC,mBACnCxqC,MAAMwqC,kBAAkBn4D,EAAOk4D,GAE1Bl4D,CACP,CACD,CAGD,CCzBO,IAAMo4D,EAA8DH,GAC1E,SAACr6D,EAAOqiB,GACP,IAAKriB,EACJ,MAAM,IAAI+vB,MAAM1N,GAAW,kBAE7B,IAIYo4C,EAAeJ,GAAmB,SAAIr6D,EAAUqiB,GAE5D,GAAa,MAATriB,EACH,MAAM,IAAI+vB,MAAM,OAAA1N,QAAA,IAAAA,EAAAA,EAAW,yBAE5B,OAAOriB,CACR,IC1Ce,SAAS06D,EAAiBC,GACvC,GAAsB,qBAAX/lD,QAAmD,MAAzB+lD,EAAK/lD,OAAOgB,WAA2C,MAAtB+kD,EAAK,cAAuB,OAAOt8D,MAAMw6D,KAAK8B,EACtH,CCEe,SAAS,EAAmBlC,GACzC,OCJa,SAA4BA,GACzC,GAAIp6D,MAAMC,QAAQm6D,GAAM,OAAO,EAAiBA,EAClD,CDES,CAAkBA,IAAQ,EAAgBA,IAAQ,EAA2BA,IELvE,WACb,MAAM,IAAIl5D,UAAU,uIACtB,CFG8F,EAC9F,CGMO,SAAS6mB,EACfoyB,EACAnyB,GAEA,IAAI5a,OAQG,EAEDlD,EAAK,WACLkD,KACJA,EAAQ,CAAC,GACFmvD,QAAU,IAAIn8C,SAAQ,SAAC2G,EAASy1C,GACtCpvD,EAAO2Z,QAAUA,EACjB3Z,EAAOovD,OAASA,CACjB,KAEDjzC,aAAanc,EAAOqvD,SAAO,QAAAC,EAAA/8D,UAAAC,OARb2b,EAAA,IAAAvb,MAAA08D,GAAAC,EAAA,EAAAA,EAAAD,EAAAC,IAAAphD,EAAAohD,GAAAh9D,UAAAg9D,GAoBd,OAXAvvD,EAAOwvD,WAAarhD,EACpBnO,EAAOqvD,QAAUzzC,YAAW,WAC3B,IAAM0xC,EAAIttD,EACVA,OAAQ,EACR,IACCstD,EAAE3zC,QAAQozB,EAAAh6C,WAAA,EAAA08D,EAAYnC,EAAEkC,aACzB,CAAE,MAAOv+C,IACRq8C,EAAE8B,OAAOn+C,GACV,CACD,GAAG2J,GAEI5a,EAAOmvD,OACf,EAKA,OAJAryD,EAAGof,OAAS,WACNlc,GACLmc,aAAanc,EAAMqvD,QACpB,EACOvyD,CACR,CChDA,IAAM4yD,EAAqB,IAAI3vD,QAOxB,SAAS4vD,EAAch5D,EAAgBi5D,GAC7C,GAAqB,kBAAVj5D,GAAgC,OAAVA,EAAjC,CAEA,IAAIk5D,EAAqBH,EAAmBn3D,IAAI5B,GAC3Ck5D,IACJA,EAAqB,CAAEC,KAAM,CAAC,EAAGC,OAAQ,CAAC,GAC1CL,EAAmBlwD,IAAI7I,EAAOk5D,IAG3BD,EAAYE,OACfD,EAAmBC,KAAAE,EAAAA,EAAA,GACfH,EAAmBC,MACnBF,EAAYE,OAGbF,EAAYG,SACfF,EAAmBE,OAAAC,EAAAA,EAAA,GACfH,EAAmBE,QACnBH,EAAYG,QAjBsC,CAoBxD,CC7BO,SAASE,EAAiB1uD,GAEhC,IADA,IAAI2uD,EAAO,EACF59D,EAAI,EAAGA,EAAIiP,EAAO/O,OAAQF,IAClC49D,GAAQA,GAAQ,GAAKA,EAAO3uD,EAAOmH,WAAWpW,GAC9C49D,GAAQ,EAET,OAAOA,EAAO,EACf,CCXe,SAASC,EAAgBnD,GACtC,GAAIp6D,MAAMC,QAAQm6D,GAAM,OAAOA,CACjC,CCFe,SAASoD,IACtB,MAAM,IAAIt8D,UAAU,4IACtB,CCEe,SAAS,EAAek5D,EAAK16D,GAC1C,OAAO,EAAe06D,ICLT,SAA+BA,EAAK16D,GACjD,IAAI+9D,EAAK,MAAQrD,EAAM,KAAO,oBAAsB7jD,QAAU6jD,EAAI7jD,OAAOgB,WAAa6iD,EAAI,cAC1F,GAAI,MAAQqD,EAAI,CACd,IAAIC,EACF/C,EACAgD,EACAC,EACAC,EAAO,GACPC,GAAK,EACLC,GAAK,EACP,IACE,GAAIJ,GAAMF,EAAKA,EAAGh9D,KAAK25D,IAAMnhB,KAAM,IAAMv5C,EAAG,CAC1C,GAAIW,OAAOo9D,KAAQA,EAAI,OACvBK,GAAK,CACP,MAAO,OAASA,GAAMJ,EAAKC,EAAGl9D,KAAKg9D,IAAK10D,QAAU80D,EAAK99D,KAAK29D,EAAG/7D,OAAQk8D,EAAKj+D,SAAWF,GAAIo+D,GAAK,GAClG,CAAE,MAAOjK,GACPkK,GAAK,EAAIpD,EAAK9G,CAChB,CAAE,QACA,IACE,IAAKiK,GAAM,MAAQL,EAAW,SAAMG,EAAKH,EAAW,SAAKp9D,OAAOu9D,KAAQA,GAAK,MAC/E,CAAE,QACA,GAAIG,EAAI,MAAMpD,CAChB,CACF,CACA,OAAOkD,CACT,CACF,CDrBgC,CAAqBzD,EAAK16D,IAAM,EAA2B06D,EAAK16D,IAAM,GACtG,CEeO,SAASs+D,IAAe,IAAXC,EAAAt+D,UAAAC,OAAA,QAAA6B,IAAA9B,UAAA,GAAAA,UAAA,GAAO,GACtBkQ,EAAI,EACJ8qC,EAAI,EACJnrB,EAAI,EACJlC,EAAI,EAER,SAAS2rB,IACR,IAAMzH,EAAI3hC,EAAKA,GAAK,GAKpB,OAJAA,EAAI8qC,EACJA,EAAInrB,EACJA,EAAIlC,GACJA,IAAOA,IAAM,GAAMkkB,EAAKA,IAAM,KAAQ,GAC1B,WAAe,CAC5B,CAEA,IAAK,IAAIxf,EAAI,EAAGA,EAAIisC,EAAKr+D,OAAS,GAAIoyB,IACrCniB,GAA0B,EAArBouD,EAAKnoD,WAAWkc,GACrBinB,IAGD,OAAOA,CACR,CAgBO,SAASilB,EAASv8D,EAAew8D,EAAkBC,GAAyC,IAAvBC,EAAA1+D,UAAAC,OAAA,QAAA6B,IAAA9B,UAAA,IAAAA,UAAA,GAC3E2+D,EAAAC,EAA4BJ,EAAA,GAArBK,EAAAF,EAAA,GAASG,EAAQH,EAAA,GACxBI,EAAAH,EAAiBH,EAAA,GAAVO,EAAAD,EAAA,GAAIE,EAAEF,EAAA,GACP56D,EAAS66D,GAAOh9D,EAAQ68D,IAAYC,EAAWD,IAAaI,EAAKD,GAEvE,OAAON,EACJM,EAAKC,EACJ3zD,KAAKuL,IAAIvL,KAAKwL,IAAI3S,EAAQ86D,GAAKD,GAC/B1zD,KAAKuL,IAAIvL,KAAKwL,IAAI3S,EAAQ66D,GAAKC,GAChC96D,CACJ,CCnEO,SAASvE,EAAe0P,EAAazO,GAC3C,OAAOH,OAAOC,UAAUf,eAAekB,KAAKwO,EAAKzO,EAClD,CAUO,SAASq+D,EAAe5vD,EAAazO,GAC3C,GAAKjB,EAAe0P,EAAKzO,GAIzB,OAAOyO,EAAIzO,EACZ,CAeO,SAASs+D,EAAsB7vD,GACrC,IAAKA,EAAK,OAAOA,EACjB,GAAIjP,MAAMC,QAAQgP,GAAM,CAGvB,IAFA,IAAMmrD,EAAiB,GACjBx6D,EAASqP,EAAIrP,OACVF,EAAI,EAAGA,EAAIE,EAAQF,IAAK06D,EAAIr6D,KAAK++D,EAAS7vD,EAAIvP,KACvD,OAAO06D,CACR,CAAO,GAAmB,kBAARnrD,EAAkB,CAInC,IAHA,IAAMzK,EAAOnE,OAAOmE,KAAKyK,GACnBrP,EAAS4E,EAAK5E,OACdm/D,EAAiB,CAAC,EACfr/D,EAAI,EAAGA,EAAIE,EAAQF,IAAK,CAChC,IAAMc,EAAMgE,EAAK9E,GACjBq/D,EAAUv+D,GAAOs+D,EAAU7vD,EAAYzO,GACxC,CACA,OAAOu+D,CACR,CACA,OAAO9vD,CACR,CAkBO,SAAS+vD,EAA2Cn6D,GAG1D,OAAOxE,OAAOihB,OAAOzc,EACtB,CAOO,SAASo6D,EAA4Cp6D,GAG3D,OAAOxE,OAAO2gB,QAAQnc,EACvB,CCrEO,SAASq6D,EAAav9D,GAC5B,OAAiB,OAAVA,CACR,CAQO,SAASw9D,EACfx9D,GAEA,OAAiB,OAAVA,QAA4B,IAAVA,CAC1B,CAGO,IAAMy9D,EACM,qBAAXlzD,QAA2BA,OAAekzD,gBAC7ClzD,OAAOkzD,gBACR,SAAI1/D,GAAA,OAAaA,EAAImxD,KAAKwO,MAAMxO,KAAKC,UAAUpxD,IAAMA,CAAA,EC9B5C4/D,EAAA,WAeZ,SAAAA,EAOkBC,GAChB/G,EAAA,KAAA8G,GAACE,EAAA,yBAjBKA,EAAA,oBAgBU,KAAAD,cAAAA,CACf,CAsGH,OAtGGvG,EAAAsG,EAAA,EAAA9+D,IAAA,MAAAmB,MAOI,WAAM,IAAA89D,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EACNC,EAAiC,QAAjCN,EAAkB,QAAlBC,EAAatzD,KAAK4zD,YAAA,IAAAN,GAAM,QAANC,EAALD,EAAWO,eAAA,IAAAN,OAAN,EAALA,EAAoBxpD,YAAA,IAAAspD,EAAAA,EAAQ,EACzCS,EAA6B,QAA7BN,EAAgB,QAAhBC,EAAWzzD,KAAK4zD,YAAA,IAAAH,GAAM,QAANC,EAALD,EAAWM,aAAA,IAAAL,OAAN,EAALA,EAAkB3pD,YAAA,IAAAypD,EAAAA,EAAQ,EAC3C,GAAmB,IAAfG,GAAiC,IAAbG,EAGxB,MAAO,CAAEv+D,MAAOyK,KAAKg0D,UAAYJ,KAAM5zD,KAAK4zD,KAC7C,IAAAx/D,IAAA,OAAAmB,MAUQ,SAAKi6D,EAASyE,GAA4B,IAAAC,EAAAC,EAK1BC,EAEhBC,EAAAC,GANF,QAALJ,EAAAl0D,KAAKg0D,iBAAA,IAAAE,IAALl0D,KAAKg0D,UAAc,IAAI//C,IAAIjU,KAAKmzD,gBAChCnzD,KAAKg0D,UAAU5+C,IAAIo6C,GAEd,QAAL2E,EAAAn0D,KAAK4zD,YAAA,IAAAO,IAALn0D,KAAK4zD,KAAS,CAAC,GACXK,GACO,QAAVG,EAAAp0D,KAAK4zD,KAAKC,eAAA,IAAAO,GAAVA,EAAmB//B,OAAOm7B,IAEhB,QAAV8E,GAAAD,EAAAr0D,KAAK4zD,MAAKG,aAAA,IAAAO,IAAVD,EAAUN,MAAU,IAAI9/C,KACxBjU,KAAK4zD,KAAKG,MAAM3+C,IAAIo6C,GAEtB,IAAAp7D,IAAA,MAAAmB,MASA,SAAIi6D,GAAS,IAAA+E,EACNN,EAAoBj0D,KAAKmzD,cAAc1yD,IAAI+uD,GACjD,GAAIyE,EAAmB,KAAAO,EAAAC,EAGtB,KAFwB,QAAlBD,EAAax0D,KAAK4zD,YAAA,IAAAY,GAAM,QAANC,EAALD,EAAWX,eAAA,IAAAY,OAAN,EAALA,EAAoBh0D,IAAI+uD,IAE1B,OACjB,OAAOxvD,KAAK00D,KAAKlF,EAAMyE,EACxB,EACgC,QAA1BM,EAAqBv0D,KAAKg0D,iBAAA,IAAAO,OAAA,EAALA,EAAgB9zD,IAAI+uD,KAI/CxvD,KAAK00D,KAAKlF,EAAMyE,EACjB,IAAA7/D,IAAA,UAAAmB,MAUQ,SAAQi6D,EAASyE,GAA4B,IAAAU,EAAAC,EAK7BC,EAAAC,EAIhBC,GARF,QAALJ,EAAA30D,KAAKg0D,iBAAA,IAAAW,IAAL30D,KAAKg0D,UAAc,IAAI//C,IAAIjU,KAAKmzD,gBAChCnzD,KAAKg0D,UAAU3/B,OAAOm7B,GAEjB,QAALoF,EAAA50D,KAAK4zD,YAAA,IAAAgB,IAAL50D,KAAK4zD,KAAS,CAAC,GACXK,IAEO,QAAVa,GAAAD,EAAA70D,KAAK4zD,MAAKC,eAAA,IAAAiB,IAAVD,EAAUhB,QAAY,IAAI5/C,KAC1BjU,KAAK4zD,KAAKC,QAAQz+C,IAAIo6C,IAGZ,QAAVuF,EAAA/0D,KAAK4zD,KAAKG,aAAA,IAAAgB,GAAVA,EAAiB1gC,OAAOm7B,EAE1B,IAAAp7D,IAAA,SAAAmB,MASA,SAAOi6D,GAAS,IAAAwF,EAAAC,EACThB,EAAoBj0D,KAAKmzD,cAAc1yD,IAAI+uD,GACjD,IAAKyE,EAAmB,KAAAiB,EAAAC,EAGvB,KAFsB,QAAhBD,EAAWl1D,KAAK4zD,YAAA,IAAAsB,GAAM,QAANC,EAALD,EAAWnB,aAAA,IAAAoB,OAAN,EAALA,EAAkB10D,IAAI+uD,IAExB,OACf,OAAOxvD,KAAKo1D,QAAQ5F,EAAMyE,EAC3B,EACmC,QAA7Be,EAAwBh1D,KAAK4zD,YAAA,IAAAoB,GAAM,QAANC,EAALD,EAAWnB,eAAA,IAAAoB,OAAN,EAALA,EAAoBx0D,IAAI+uD,KAItDxvD,KAAKo1D,QAAQ5F,EAAMyE,EACpB,KAAAf,CAAA,CA7HY,GCaTmC,EAAS,WAAH,IAAItrD,EAAIxW,UAAAC,OAAA,QAAA6B,IAAA9B,UAAA,GAAAA,UAAA,GAAG,GAAE,OACrB+hE,OAAOC,gBAAgB,IAAIliD,WAAWtJ,IAAOyrD,QAAO,SAACzqD,EAAI0qD,GAWvD,OARE1qD,IAFF0qD,GAAQ,IACG,GACHA,EAAKzhE,SAAS,IACXyhE,EAAO,IACTA,EAAO,IAAIzhE,SAAS,IAAIuvB,cACtBkyC,EAAO,GACV,IAEA,GAGV,GAAG,GAAG,EClBKC,EAAA,WAQZ,SAAAA,EAOiBC,EAChBC,GAKC,IAAAC,EAAAC,EAAA,KAAA1J,EAAA,KAAAsJ,GAAAtC,EAAA,uCAAAA,EAAA,0BAAAA,EAAA,yBAkEFA,EAAA,mBAaa,SAAC2C,GACb,OAAO,OAAAA,QAAA,IAAAA,OAAA,EAAAA,EAAQJ,YAAaG,EAAKH,QAClC,IAvFiB,KAAAA,SAAAA,EAOhB31D,KAAKg2D,wBAA0BJ,EAAOI,wBACtCh2D,KAAKi2D,WAAaL,EAAOK,WACzBj2D,KAAKk2D,UAAmB,QAAnBL,EAAYD,EAAOM,iBAAA,IAAAL,EAAAA,EAAa,CAAEM,SAAU,SAAC7nB,GAAA,OAAeA,CAAA,EAClE,CAiIA,OAjIAse,EAAA8I,EAAA,EAAAthE,IAAA,SAAAmB,MASA,SAAO6gE,GAGN,IAFA,IAAM1+D,EAAAs5D,EAAAA,EAAA,GAAchxD,KAAKg2D,2BAAwB,IAAGjrD,GAAI/K,KAAKq2D,aAE7DhF,EAAA,EAAAiF,EAAqBriE,OAAO2gB,QAAQwhD,GAAU/E,EAAAiF,EAAA9iE,OAAA69D,IAAG,CAAjD,IAAAkF,EAAApE,EAAAmE,EAAAjF,GAAA,GAAYzrC,EAAA2wC,EAAA,GAAG7zC,EAAC6zC,EAAA,QACL,IAAN7zC,IACHhrB,EAAOkuB,GAAKlD,EAEd,CAIA,OAFAhrB,EAAOi+D,SAAW31D,KAAK21D,SAEhBj+D,CACR,IAAAtD,IAAA,QAAAmB,MASA,SAAMwgE,GACL,OAAA/E,EAAAA,EAAA,GAAYgC,EAAgB+C,IAAM,IAAGhrD,GAAI/K,KAAKq2D,YAC/C,IAAAjiE,IAAA,WAAAmB,MAaA,WACC,OAAQyK,KAAK21D,SAAW,IAAMN,GAC/B,IAAAjhE,IAAA,iBAAAmB,MAaA,SAAewV,GACd,OAAQ/K,KAAK21D,SAAW,IAAM5qD,CAC/B,IAAA3W,IAAA,OAAAmB,MA4BA,SAAKwV,GACJ,IAAKA,EAAI,OAAO,EAChB,IAAK,IAAIzX,EAAI,EAAGA,EAAI0M,KAAK21D,SAASniE,OAAQF,IACzC,GAAIyX,EAAGzX,KAAO0M,KAAK21D,SAASriE,GAAI,OAAO,EAGxC,MAAoC,MAA7ByX,EAAG/K,KAAK21D,SAASniE,OACzB,IAAAY,IAAA,wBAAAmB,MAeA,SACCygE,GAEA,OAAO,IAAIN,EAA+D11D,KAAK21D,SAAU,CACxFK,wBAAAA,EACAC,WAAYj2D,KAAKi2D,WACjBC,UAAWl2D,KAAKk2D,WAElB,IAAA9hE,IAAA,WAAAmB,MAOA,SAASwgE,GACR,OAAO/1D,KAAKk2D,UAAUC,SAASJ,EAChC,KAAAL,CAAA,CA1JY,GAyKN,SAASc,EACfb,EACAC,GAKkD,IAAAa,EAClD,OAAO,IAAIf,EAAgDC,EAAU,CACpEK,wBAAyB,iBAAO,CAAC,GACjCC,WAAmB,QAAnBQ,EAAYb,EAAOK,kBAAA,IAAAQ,EAAAA,EAAc,CAAEC,eAAgB,EAAGC,aAAc,EAAGC,UAAW,CAAC,GACnFV,UAAWN,EAAOM,WAEpB,CCnMO,IAOMW,EAAA,oBAAAA,IAAAzK,EAAA,KAAAyK,GAAAzD,EAAA,iBACQ,GAAAA,EAAA,aAEsBx/D,MAVP,IAUiCw/D,EAAA,WAEvC,MAmI7B,OAnI6BxG,EAAAiK,EAAA,EAAAziE,IAAA,UAAAmF,IAO7B,WACC,GAAIyG,KAAKqS,MACR,OAA0B,IAAnBrS,KAAK82D,UAGb,GAAI92D,KAAKQ,IACR,OAAyB,IAAlBR,KAAKQ,IAAIuJ,KAGjB,MAAM,IAAIub,MAAM,kBACjB,IAAAlxB,IAAA,MAAAmB,MAQA,SAAIwhE,GACH,GAAI/2D,KAAKqS,MAIR,OAAa,IAHDrS,KAAKqS,MAAM7b,QAAQugE,KAO3B/2D,KAAK82D,UA9CwB,GAkDhC92D,KAAKqS,MAAMrS,KAAK82D,WAAaC,EAC7B/2D,KAAK82D,aAEE,IAGP92D,KAAKQ,IAAM,IAAIyT,IAAIjU,KAAKqS,OACxBrS,KAAKqS,MAAQ,KACbrS,KAAKQ,IAAI4U,IAAI2hD,IAEN,IAIT,GAAI/2D,KAAKQ,IAER,OAAIR,KAAKQ,IAAIC,IAAIs2D,KAIjB/2D,KAAKQ,IAAI4U,IAAI2hD,IACN,GAGR,MAAM,IAAIzxC,MAAM,kBACjB,IAAAlxB,IAAA,SAAAmB,MAOA,SAAOwhE,GACN,GAAI/2D,KAAKqS,MAAO,CACf,IAAM2kD,EAAMh3D,KAAKqS,MAAM7b,QAAQugE,GAG/B,OAAa,IAATC,IAIJh3D,KAAKqS,MAAM2kD,QAAO,EAClBh3D,KAAK82D,YAEDE,IAAQh3D,KAAK82D,YAGhB92D,KAAKqS,MAAM2kD,GAAOh3D,KAAKqS,MAAMrS,KAAK82D,WAClC92D,KAAKqS,MAAMrS,KAAK82D,gBAAa,IAGvB,EACR,CAEA,GAAI92D,KAAKQ,IAER,QAAKR,KAAKQ,IAAIC,IAAIs2D,KAIlB/2D,KAAKQ,IAAI6zB,OAAO0iC,IAET,GAGR,MAAM,IAAIzxC,MAAM,kBACjB,IAAAlxB,IAAA,QAAAmB,MAOA,SAAM0hE,GACL,GAAIj3D,KAAKqS,MACR,IAAK,IAAI/e,EAAI,EAAGA,EAAI0M,KAAK82D,UAAWxjE,IAAK,CACxC,IAAMyjE,EAAO/2D,KAAKqS,MAAM/e,GAEJ,qBAATyjE,GACVE,EAAQF,EAEV,KAPD,CAYA,IAAI/2D,KAAKQ,IAMT,MAAM,IAAI8kB,MAAM,mBALftlB,KAAKQ,IAAIiS,QAAQwkD,EAHlB,CASD,KAAAJ,CAAA,CAxIY,GCAb,SAASK,EAAQzzD,GAChB,OAAOA,GAAkB,kBAANA,GAAkB,YAAaA,CACnD,CAQO,SAAS0zD,EAAmBhnC,GAClC,IAAK,IAAI78B,EAAI,EAAGqM,EAAIwwB,EAAMinC,QAAQ5jE,OAAQF,EAAIqM,EAAGrM,IAKhD,GAHA68B,EAAMinC,QAAQ9jE,GAAG+jE,8BAGblnC,EAAMinC,QAAQ9jE,GAAGgkE,mBAAqBnnC,EAAMonC,aAAajkE,GAC5D,OAAO,EAIT,OAAO,CACR,CAQO,IAAMkkE,GAAS,SAATA,EAAUC,EAAqBtnC,GAE3C,GAAKsnC,EAAOlvC,SAASmvC,OAAOvnC,IAKxBsnC,EAAOlvC,SAASovC,SAAWT,EAAQO,GACtC,IAAK,IAAInkE,EAAI,EAAGqM,EAAI83D,EAAOL,QAAQ5jE,OAAQF,EAAIqM,EAAGrM,IACjDkkE,EAAOC,EAAOL,QAAQ9jE,GAAImkE,EAG7B,EAQaG,GAAS,SAATA,EAAUH,EAAqBtnC,GAE3C,GAAKsnC,EAAOlvC,SAASnT,IAAI+a,IAKrB+mC,EAAQO,GACX,IAAK,IAAInkE,EAAI,EAAGqM,EAAI83D,EAAOL,QAAQ5jE,OAAQF,EAAIqM,EAAGrM,IACjDskE,EAAOH,EAAOL,QAAQ9jE,GAAImkE,EAG7B,EAQO,SAASvI,GAAOhvD,EAAQ6hB,GAG9B,OADC7hB,IAAM6hB,GAAK9tB,OAAO05B,GAAGztB,EAAG6hB,IAAMwrC,QAAQrtD,GAAK6hB,GAAyB,oBAAb7hB,EAAEgvD,QAAyBhvD,EAAEgvD,OAAOntC,GAE7F,CAKO,IAAM81C,GAAkB5jE,OAAO6jE,OAAO,ICpFvCC,GAAY5tD,OAAOia,IAAI,cACvBlrB,GAAS2G,WAEX3G,GAAO6+D,IACVpgB,QAAQhgD,MACP,6MAGDuB,GAAO6+D,KAAa,EAGrB,IAAMC,GAAApL,GAML,SAAAoL,EAA4BC,EAAiD9nC,GAAci8B,EAAA,KAAA4L,GAAA5E,EAAA,cALlF,GAAAA,EAAA,qBACO,GAAAA,EAAA,4BAIY,KAAA6E,MAAAA,EAAiD,KAAA9nC,MAAAA,CAAe,IAGzFrZ,GAAkC,KAyB/B,SAASohD,GAA0Bp6D,GACzC,IAAMq6D,EAAWrhD,GACjBA,GAAQ,KACR,IACC,OAAOhZ,GACR,CAAE,QACDgZ,GAAQqhD,CACT,CACD,CAEO,SAASC,GAAsBjoC,GACrCrZ,GAAQ,IAAIkhD,GAAkBlhD,GAAOqZ,EACtC,CAEO,SAASkoC,KAAuB,IAAAC,EAChCC,EAAQzhD,GAKd,GAJAA,GAAQyhD,EAAMN,MAEWM,EAAMC,cAAgB,GAAKD,EAAMz+C,SAAWy+C,EAAMpoC,MAAMinC,QAAQ5jE,OAEzF,CAIA,IAAK,IAAIF,EAAIilE,EAAMz+C,OAAQxmB,EAAIilE,EAAMpoC,MAAMinC,QAAQ5jE,OAAQF,IAAK,CAC/D,IAAMwuB,EAAIy2C,EAAMpoC,MAAMinC,QAAQ9jE,GACLilE,EAAMpoC,MAAMinC,QAAQ5gE,QAAQsrB,IAAMy2C,EAAMz+C,QAEhE09C,GAAO11C,EAAGy2C,EAAMpoC,MAElB,CAKA,GAHAooC,EAAMpoC,MAAMinC,QAAQ5jE,OAAS+kE,EAAMz+C,OACnCy+C,EAAMpoC,MAAMonC,aAAa/jE,OAAS+kE,EAAMz+C,OAEpC,QAAJw+C,EAAIxhD,UAAA,IAAAwhD,GAAAA,EAAOG,aACV,IAAK,IAAInlE,EAAI,EAAGA,EAAIwjB,GAAM2hD,aAAajlE,OAAQF,IAAK,CACnD,IAAMolE,EAAqB5hD,GAAM2hD,aAAanlE,IACW,IAArDilE,EAAMpoC,MAAMinC,QAAQ5gE,QAAQkiE,IAC/BlB,GAAOkB,EAAoBH,EAAMpoC,MAEnC,CAnBD,CAqBD,CAGO,SAASwoC,GAAmB72C,GAClC,GAAIhL,GAAO,CACV,IAAMkgD,EAAMlgD,GAAMqZ,MAAMinC,QAAQ5gE,QAAQsrB,GAaxC,GAPIk1C,EAAM,IACTlgD,GAAM0hD,gBACF1hD,GAAMqZ,MAAMyoC,qBACfhB,GAAO91C,EAAGhL,GAAMqZ,QAId6mC,EAAM,GAAKA,GAAOlgD,GAAMgD,OAAQ,CACnC,GAAIk9C,IAAQlgD,GAAMgD,QAAUk9C,EAAM,EAAG,CACpC,IAAM0B,EAAqB5hD,GAAMqZ,MAAMinC,QAAQtgD,GAAMgD,QAEhDhD,GAAM2hD,cAEoD,IAApD3hD,GAAM2hD,aAAajiE,QAAQkiE,IACrC5hD,GAAM2hD,aAAa9kE,KAAK+kE,GAFxB5hD,GAAM2hD,aAAe,CAACC,EAIxB,CAEA5hD,GAAMqZ,MAAMinC,QAAQtgD,GAAMgD,QAAUgI,EACpChL,GAAMqZ,MAAMonC,aAAazgD,GAAMgD,QAAUgI,EAAEw1C,iBAC3CxgD,GAAMgD,QACP,CACD,CACD,CAsBO,SAAS++C,KAAgB,IAAAC,EACzB3oC,EAAQ,QAAR2oC,EAAQhiD,UAAA,IAAAgiD,OAAA,EAAAA,EAAO3oC,MACrB,IAAKA,EACJ,MAAM,IAAI7K,MAAM,wDAIjB,IADA,IAAMyzC,EAAiB,GACdzlE,EAAI,EAAGA,EAAI68B,EAAMinC,QAAQ5jE,OAAQF,IAAK,CAC9C,IAAMmkE,EAAStnC,EAAMinC,QAAQ9jE,GAEzBmkE,EAAOH,iBAAmBnnC,EAAMonC,aAAajkE,IAChDylE,EAAeplE,KAAK8jE,EAEtB,CAEA,GAA8B,IAA1BsB,EAAevlE,OAElBmkD,QAAQxlB,IAAKhC,EAAcl3B,KAAM,kDAC3B,CAEN0+C,QAAQxlB,IAAKhC,EAAcl3B,KAAM,uBAAqB,IAC1Bk2D,EAD0BC,EAAAC,EAC1B0J,GAAA,IAA5B,IAAA3J,EAAAd,MAAAa,EAAAC,EAAAzvD,KAAAhD,MAA4C,KAAjCq8D,EAAA7J,EAAA55D,MAEVoiD,QAAQxlB,IACP,KACC6mC,EAAsB//D,KACvB,aACA+/D,EAAc3B,8BAEhB,QAAA5P,GAAA2H,EAAAn9C,EAAAw1C,EAAA,SAAA2H,EAAA/2D,GAAA,CACD,CACD,CC7KO,IAAM4gE,GAA6B9uD,OAAO,eCIpC+uD,GAAA,WAMZ,SAAAA,EAA6BC,GAAkB/M,EAAA,KAAA8M,GAAA9F,EAAA,aAL/B,GAAAA,EAAA,sBAKa,KAAA+F,SAAAA,EAC5Bn5D,KAAK2X,OAAS,IAAI/jB,MAAMulE,EACzB,CA4EA,OA5EAvM,EAAAsM,EAAA,EAAA9kE,IAAA,YAAAmB,MASA,SAAU6jE,EAA2BC,EAAsBzF,QAC7C,IAATA,IAIAA,IAASqF,IAMbj5D,KAAK2X,OAAO3X,KAAKtK,OAAS,CAAC0jE,EAAmBC,EAAczF,GAG5D5zD,KAAKtK,OAASsK,KAAKtK,MAAQ,GAAKsK,KAAKm5D,UARpCn5D,KAAK6U,QASP,IAAAzgB,IAAA,QAAAmB,MAKA,WACCyK,KAAKtK,MAAQ,EACbsK,KAAK2X,OAAO2hD,UAAK,EAClB,IAAAllE,IAAA,kBAAAmB,MAQA,SAAgBgkE,GAIf,IAHA,IAAQ7jE,EAA4BsK,KAA5BtK,MAAOyjE,EAAqBn5D,KAArBm5D,SAAUxhD,EAAW3X,KAAX2X,OAGhBrkB,EAAI,EAAGA,EAAI6lE,EAAU7lE,IAAK,CAClC,IAAMwmB,GAAUpkB,EAAQ,EAAIyjE,EAAW7lE,GAAK6lE,EAEtCpC,EAAOp/C,EAAOmC,GAGpB,IAAKi9C,EACJ,OAAOkC,GAGR,IAAAO,EAAArH,EAA6B4E,EAAA,GAAtB0C,EAAAD,EAAA,GAAWE,EAAOF,EAAA,GAGzB,GAAU,IAANlmE,GAAWimE,GAAcG,EAC5B,MAAO,GAIR,GAAID,GAAaF,GAAcA,EAAaG,EAAS,CAIpD,IAHA,IAAMtqD,EAAM9b,EAAI,EACVoE,EAAS,IAAI9D,MAAMwb,GAEhB/B,EAAI,EAAGA,EAAI+B,EAAK/B,IACxB3V,EAAO2V,GAAKsK,GAAQmC,EAASzM,GAAK8rD,GAAW,GAG9C,OAAOzhE,CACR,CACD,CAGA,OAAOuhE,EACR,KAAAC,CAAA,CApFY,GCRAS,IAAsB,ECKxBC,GAAcD,EAGrBE,IAAmB,EAMvB,IAAMC,GAAA,WACL,SAAAA,EAA4BrC,GAA4BrL,EAAA,KAAA0N,GAAA1G,EAAA,yBACpC,IAAIr/C,KADI,KAAA0jD,OAAAA,CAA6B,CAiDzD,OAjDyD7K,EAAAkN,EAAA,EAAA1lE,IAAA,SAAAmF,IAQzD,WACC,OAAuB,OAAhByG,KAAKy3D,MACb,IAAArjE,IAAA,SAAAmB,MAOA,WAAS,IAAAugE,EAAA,KACR,GAAI91D,KAAK+5D,OAAQ,CAEhB,IAAMC,EAAQh6D,KAAKi6D,kBACnBj6D,KAAKi6D,kBAAoB,IAAIlmD,IAC7BmmD,GAAaF,EAAM5hE,OACpB,MAEC4H,KAAKi6D,kBAAkBxnD,SAAQ,SAACld,EAAO4kE,GACjCrE,EAAK2B,OAAQwC,kBAAkBx5D,IAAI05D,IACvCrE,EAAK2B,OAAQwC,kBAAkBz5D,IAAI25D,EAAM5kE,EAE3C,GAEF,IAAAnB,IAAA,QAAAmB,MAOA,WACCqkE,KAGA55D,KAAKi6D,kBAAkBxnD,SAAQ,SAACld,EAAO4kE,GAAS,IAAAC,EAC/CD,EAAK35D,IAAIjL,GACJ,QAAL6kE,EAAAD,EAAKE,qBAAA,IAAAD,GAALA,EAAoBvlD,OACrB,IAGA7U,KAAKs6D,QACN,KAAAR,CAAA,CAlDK,GA0DN,SAASI,GAAaF,GACrB,GAAIH,GACH,MAAM,IAAIv0C,MAAM,6CAGjB,IACCu0C,IAAmB,EAGnB,IAiBmB1K,EAjBboL,EAAW,IAAItmD,IAGfumD,EAAW,SAAXA,EAAY55B,GACbA,EAAK65B,qBAAuBb,KAIhCh5B,EAAK65B,mBAAqBb,GAEtB,wBAAyBh5B,EAC5B25B,EAASnlD,IAAIwrB,GAEXA,EAA4BrY,SAASmyC,MAAMF,GAE/C,EAAApL,EAAAC,EAEmB2K,GAAA,IAAnB,IAAA5K,EAAAd,MAAAa,EAAAC,EAAAzvD,KAAAhD,MAA0B,CAAfwyD,EAAA55D,MACLgzB,SAASmyC,MAAMF,EACrB,QAAA/S,GAAA2H,EAAAn9C,EAAAw1C,EAAA,SAAA2H,EAAA/2D,GAAA,KAGgBk3D,EAHhBE,EAAAJ,EAGgBkL,GAAA,IAAhB,IAAA9K,EAAAnB,MAAAiB,EAAAE,EAAA9vD,KAAAhD,MAA0B,CAAf4yD,EAAAh6D,MACRolE,qBACH,QAAAlT,GAAAgI,EAAAx9C,EAAAw1C,EAAA,SAAAgI,EAAAp3D,GAAA,CACD,CAAE,QACDwhE,IAAmB,CACpB,CACD,CAwBO,IAAIe,GAAqB,KA0EzB,SAASC,GAAe/8D,GAC9B,IAAMg9D,EAAM,IAAIhB,GAAYc,IAG5BA,GAAqBE,EAErB,IACC,IAAIC,GAAW,EAGTrjE,EAASoG,GAAG,kBAAOi9D,GAAW,CAAK,IAUzC,OARIA,EAEHD,EAAIE,QAGJF,EAAIR,SAGE5iE,CACR,CAAE,MAAOua,IAGR,MADA6oD,EAAIE,QACE/oD,EACP,CAAE,QAED2oD,GAAqBA,GAAmBnD,MACzC,CACD,CAQO,SAASwD,GAAYn9D,GAC3B,OAAI88D,GACI98D,IAED+8D,GAAY/8D,EACpB,CCpLO,IAAMo9D,GAAA,WACZ,SAAAA,EACiBjiE,EACRqN,EACRvN,GACC,IAAAoiE,EAAA/O,EAAA,KAAA8O,GAAA9H,EAAA,uBAAAA,EAAA,2BAAAA,EAAA,wBAgBiBwG,IAAAxG,EAAA,gBAER,IAAIyD,GAAgBzD,EAAA,6BArBd,KAAAn6D,KAAAA,EACR,KAAAqN,QAAAA,EAGRtG,KAAKo7D,QAAmB,QAAnBD,EAAU,OAAApiE,QAAA,IAAAA,OAAA,EAAAA,EAASqiE,eAAA,IAAAD,EAAAA,EAAW,KAE9BpiE,IAEDA,EAAQsiE,gBACXr7D,KAAKq6D,cAAgB,IAAInB,GAAcngE,EAAQsiE,gBAGhDr7D,KAAKs7D,YAAcviE,EAAQuiE,YAC5B,CAkEA,OAlEA1O,EAAAsO,EAAA,EAAA9mE,IAAA,8BAAAmB,MAYA,WACC,OAAOyK,KAAKsG,OACb,IAAAlS,IAAA,QAAAmF,IAEA,WAEC,OADAo/D,GAAmB34D,MACZA,KAAKsG,OACb,IAAAlS,IAAA,MAAAmB,MAEA,SAAIA,EAAcq+D,GAAoB,IAAA2H,EAAAC,EAUbC,EAAAC,EARxB,GAAsC,QAAtCH,EAAS,QAATC,EAAIx7D,KAAKo7D,eAAA,IAAAI,OAAA,EAALA,EAAAnnE,KAAA2L,KAAeA,KAAKsG,QAAS/Q,UAAK,IAAAgmE,EAAAA,EAAKrM,GAAOlvD,KAAKsG,QAAS/Q,GAC/D,OAAOyK,KAAKsG,SDjGdszD,KCwGK55D,KAAKq6D,gBACRr6D,KAAKq6D,cAAcsB,UAClB37D,KAAKs3D,iBACLsC,GAE2E,QAF3E6B,EACA,OAAA7H,QAAA,IAAAA,EAAAA,EACM,QADN8H,EACC17D,KAAKs7D,mBAAA,IAAAI,OAAA,EAALA,EAAArnE,KAAA2L,KAAmBA,KAAKsG,QAAS/Q,EAAOyK,KAAKs3D,iBAAkBsC,WAAW,IAAA6B,EAAAA,EAC1ExC,IAKHj5D,KAAKs3D,iBAAmBsC,GAExB,IAAMgC,EAAW57D,KAAKsG,QAMtB,OALAtG,KAAKsG,QAAU/Q,EDVV,SAAuB4kE,EAAkBhH,GAC1CyH,GAEOA,GAAmBX,kBAAkBx5D,IAAI05D,IACpDS,GAAmBX,kBAAkBz5D,IAAI25D,EAAMhH,GAF/C+G,GAAa,CAACC,GAIhB,CCOE0B,CAAc77D,KAAM47D,GAEbrmE,CACR,IAAAnB,IAAA,SAAAmB,MAEA,SAAOq6C,GACN,OAAO5vC,KAAKQ,IAAIovC,EAAQ5vC,KAAKsG,SAC9B,IAAAlS,IAAA,eAAAmB,MAEA,SAAaumE,GAAqC,IAAAC,EAAAC,EAIjD,OAHArD,GAAmB34D,MAGf87D,GAAS97D,KAAKs3D,iBACVO,GAGwC,QAAhDkE,EAAY,QAAZC,EAAOh8D,KAAKq6D,qBAAA,IAAA2B,OAAA,EAALA,EAAoBC,gBAAgBH,UAAK,IAAAC,EAAAA,EAAK9C,EACtD,KAAAiC,CAAA,CAjFY,GAsGN,SAASf,GAIflhE,EAIAwuB,EAIA1uB,GAEA,OAAO,IAAImiE,GAAMjiE,EAAMwuB,EAAc1uB,EACtC,CAMO,SAASmjE,GAAO3mE,GACtB,OAAOA,aAAiB2lE,EACzB,CCxLA,IAAMiB,GAAgBhyD,OAAO,iBA2BhBiyD,GAAkB,SAAC7mE,GAC/B,OAAOA,IAAU4mE,EAClB,EAEME,GAAAzP,GACL,SAAAyP,EAAmB9mE,EAAqBq+D,GAAYxH,EAAA,KAAAiQ,GAAjC,KAAA9mE,MAAAA,EAAqB,KAAAq+D,KAAAA,CAAa,IAyB/C,SAAS0I,GAAsB/mE,EAAcq+D,GACnD,OAAO,IAAIyI,GAAS9mE,EAAOq+D,EAC5B,CAqDO,IAAM2I,GAAA,WA2BZ,SAAAA,EAIiBtjE,EAICujE,EAIjBzjE,GACC,IAAAoiE,EAAA/O,EAAA,KAAAmQ,GAAAnJ,EAAA,wBAvCiBuG,IAAAvG,EAAA,0BACEuG,IAAAvG,EAAA,wBAKMuG,IAAAvG,EAAA,eAEG,IAACA,EAAA,oBACN,IAACA,EAAA,gBAEf,IAAIyD,GAAgBzD,EAAA,6BAM/BA,EAAA,aAGuB+I,IAAA/I,EAAA,2BAAAA,EAAA,uBAUN,KAAAn6D,KAAAA,EAIC,KAAAujE,OAAAA,EAMb,OAAAzjE,QAAA,IAAAA,GAAAA,EAASsiE,gBACZr7D,KAAKq6D,cAAgB,IAAInB,GAAcngE,EAAQsiE,gBAEhDr7D,KAAKs7D,YAAc,OAAAviE,QAAA,IAAAA,OAAA,EAAAA,EAASuiE,YAC5Bt7D,KAAKo7D,QAAmB,QAAnBD,EAAU,OAAApiE,QAAA,IAAAA,OAAA,EAAAA,EAASqiE,eAAA,IAAAD,EAAAA,EAAWjM,EACpC,CAoDA,OApDAtC,EAAA2P,EAAA,EAAAnoE,IAAA,sBAAAmF,IAhCA,WACC,OAAQyG,KAAKuoB,SAASovC,OACvB,IAAAvjE,IAAA,8BAAAmB,MAgCA,WACC,IAAMknE,EAAQz8D,KAAKs3D,mBAAqBqC,GAExC,IAAK8C,IAAUz8D,KAAK08D,mBAAqB9C,KAAgBzC,EAAmBn3D,OAE3E,OADAA,KAAK08D,iBAAmB9C,GACjB55D,KAAKgB,MAGb,IACCo3D,GAAsBp4D,MACtB,IAAMtI,EAASsI,KAAKw8D,OAAOx8D,KAAKgB,MAAOhB,KAAK08D,kBACtCC,EAAWjlE,aAAkB2kE,GAAW3kE,EAAOnC,MAAQmC,EAC7D,GAAIsI,KAAKgB,QAAUm7D,KAAkBn8D,KAAKo7D,QAAQuB,EAAU38D,KAAKgB,OAAQ,CACxE,GAAIhB,KAAKq6D,gBAAkBoC,EAAO,KAAAhB,EAAAC,EAC3B9H,EAAOl8D,aAAkB2kE,GAAW3kE,EAAOk8D,UAAO,EACxD5zD,KAAKq6D,cAAcsB,UAClB37D,KAAKs3D,iBACLsC,GAE4E,QAF5E6B,EACA,OAAA7H,QAAA,IAAAA,EAAAA,EACM,QADN8H,EACC17D,KAAKs7D,mBAAA,IAAAI,OAAA,EAALA,EAAArnE,KAAA2L,KAAmBA,KAAKgB,MAAO27D,EAAU38D,KAAK08D,iBAAkB9C,WAAW,IAAA6B,EAAAA,EAC3ExC,GAEH,CACAj5D,KAAKs3D,iBAAmBsC,GACxB55D,KAAKgB,MAAQ27D,CACd,CAGA,OAFA38D,KAAK08D,iBAAmB9C,GAEjB55D,KAAKgB,KACb,CAAE,QACDq3D,IACD,CACD,IAAAjkE,IAAA,QAAAmF,IAEA,WACC,IAAMhE,EAAQyK,KAAKq3D,8BAEnB,OADAsB,GAAmB34D,MACZzK,CACR,IAAAnB,IAAA,eAAAmB,MAEA,SAAaumE,GAAqC,IAAAC,EAAAC,EAKjD,OAFAh8D,KAAKzK,MAEDumE,GAAS97D,KAAKs3D,iBACVO,GAGwC,QAAhDkE,EAAY,QAAZC,EAAOh8D,KAAKq6D,qBAAA,IAAA2B,OAAA,EAALA,EAAoBC,gBAAgBH,UAAK,IAAAC,EAAAA,EAAK9C,EACtD,KAAAsD,CAAA,CAlGY,GAqGb,SAASK,KAKP,IAJD7jE,EAAAxF,UAAAC,OAAA,QAAA6B,IAAA9B,UAAA,GAAAA,UAAA,GAAqC,CAAC,EAEtCa,EAAAb,UAAAC,OAAA,EAAAD,UAAA,QAAA8B,EACAwF,EAAAtH,UAAAC,OAAA,EAAAD,UAAA,QAAA8B,EAEMwnE,EAAiBhiE,EAAWtB,IAC5BujE,EAAgB3yD,OAAOia,IAAI,uBAAyBhwB,GAiB1D,OAfAyG,EAAWtB,IAAM,WAChB,IAAIopB,EAAI3iB,KAAK88D,GAWb,OATKn6C,IACJA,EAAI,IAAI45C,GAAUnoE,EAAKyoE,EAAgBhgE,KAAKmD,MAAcjH,GAC1D9E,OAAOiB,eAAe8K,KAAM88D,EAAe,CAC1CnkE,YAAY,EACZrD,cAAc,EACdsD,UAAU,EACVrD,MAAOotB,KAGFA,EAAEptB,KACV,EAEOsF,CACR,CA4BO,SAASkiE,GACfl6D,EACAogB,GAGA,IAAM7uB,EAAM+V,OAAOia,IAAI,uBAAyBnB,EAAajvB,YACzDgpE,EAAOn6D,EAAIzO,GAMf,OALK4oE,IAEJn6D,EAAIogB,GACJ+5C,EAAOn6D,EAAIzO,IAEL4oE,CACR,CAmEO,SAAS5+C,KACf,GAAyB,IAArB7qB,UAAUC,OAAc,CAC3B,IAAMuF,EAAUxF,UAAU,GAC1B,OAAO,SAAC0E,EAAa7D,EAAayG,GAAA,OACjC+hE,GAAmB7jE,EAASd,EAAQ7D,EAAKyG,EAAU,CACrD,CAAO,MAA4B,kBAAjBtH,UAAU,GACpB,IAAIgpE,GAAUhpE,UAAU,GAAIA,UAAU,GAAIA,UAAU,IAEpDqpE,QAAmB,EAAWrpE,UAAU,GAAIA,UAAU,GAAIA,UAAU,GAE7E,CCvTO,IAAM0pE,GAAA,WA4BZ,SAAAA,EACiBhkE,EACCikE,EACjBnkE,GACC,IAAA+8D,EAAA,KAAA1J,EAAA,KAAA6Q,GAAA7J,EAAA,6BA/B6B,GAO/BA,EAAA,0BAEqBuG,IAAAvG,EAAA,wBAEMuG,IAAAvG,EAAA,sBACF,GAQzBA,EAAA,oBAGyB,IAACA,EAAA,eAEI,IAACA,EAAA,+BAAAA,EAAA,qBAsCR,WAEjB0C,EAAKqH,sBACVrH,EAAKsH,SACN,IAvCiB,KAAAnkE,KAAAA,EACC,KAAAikE,UAAAA,EAGjBl9D,KAAKq9D,gBAAkB,OAAAtkE,QAAA,IAAAA,OAAA,EAAAA,EAASukE,cACjC,CAyEA,OAzEA1Q,EAAAqQ,EAAA,EAAA7oE,IAAA,sBAAAmF,IA5BA,WACC,OAAOyG,KAAKm9D,oBACb,IAAA/oE,IAAA,gBAAAmF,IAWA,WACC,OAAOyG,KAAKu9D,cACb,IAAAnpE,IAAA,sBAAAmB,MAgBA,WAEMyK,KAAKm9D,sBAENn9D,KAAKw9D,mBAAqB5D,MAG1B55D,KAAKo3D,QAAQ5jE,QAAW2jE,EAAmBn3D,MAK/CA,KAAKs9D,iBAJJt9D,KAAKw9D,iBAAmB5D,GAK1B,IAAAxlE,IAAA,iBAAAmB,MAGA,WACCyK,KAAKu9D,iBACDv9D,KAAKq9D,gBAERr9D,KAAKq9D,gBAAgBr9D,KAAKy9D,cAG1Bz9D,KAAKo9D,SAEP,IAAAhpE,IAAA,SAAAmB,MAcA,WACCyK,KAAKm9D,sBAAuB,EAC5B,IAAK,IAAI7pE,EAAI,EAAGqM,EAAIK,KAAKo3D,QAAQ5jE,OAAQF,EAAIqM,EAAGrM,IAC/CskE,GAAO53D,KAAKo3D,QAAQ9jE,GAAI0M,KAE1B,IAAA5L,IAAA,SAAAmB,MAMA,WACCyK,KAAKm9D,sBAAuB,EAC5B,IAAK,IAAI7pE,EAAI,EAAGqM,EAAIK,KAAKo3D,QAAQ5jE,OAAQF,EAAIqM,EAAGrM,IAC/CkkE,GAAOx3D,KAAKo3D,QAAQ9jE,GAAI0M,KAE1B,IAAA5L,IAAA,UAAAmB,MAMA,WACC,IACC6iE,GAAsBp4D,MACtB,IAAMtI,EAASsI,KAAKk9D,UAAUl9D,KAAKw9D,kBAEnC,OADAx9D,KAAKw9D,iBAAmB5D,GACjBliE,CACR,CAAE,QACD2gE,IACD,CACD,KAAA4E,CAAA,CA3GY,GA4IN,SAASS,GACfzkE,EACA6E,EACA/E,GAEA,IAAM4kE,EAAY,IAAIV,GAAgBhkE,EAAM6E,EAAI/E,GAGhD,OAFA4kE,EAAU/F,SACV+F,EAAUL,iBACH,WACNK,EAAUnG,QACX,CACD,CAuCO,SAASoG,GACf3kE,EACA6E,EACA/E,GAEA,IAAM4kE,EAAY,IAAIV,GAAwBhkE,EAAM6E,EAAI/E,GACxD,MAAO,CACN4kE,UAAAA,EACA1gE,MAAO,SAAC4gE,GAAkC,IAAAC,EACnCC,EAAiB,QAAjBD,EAAQ,OAAAD,QAAA,IAAAA,OAAA,EAAAA,EAASE,aAAA,IAAAD,GAAAA,EACvBH,EAAU/F,SACNmG,EACHJ,EAAUL,iBAEVK,EAAUhD,qBAEZ,EACAqD,KAAM,WACLL,EAAUnG,QACX,EAEF,CCnQO,SAASyG,GAAS1oE,GACxB,OAAOA,aAAiB2lE,IAAS3lE,aAAiBgnE,EACnD,CCAA,ICTa2B,GAAA,oBAAAA,IAAA9R,EAAA,KAAA8R,GAA2B9K,EAAA,aAE/B,IAAIryD,QAAc,CAe1B,OAf0B6rD,EAAAsR,EAAA,EAAA9pE,IAAA,MAAAmB,MAS1B,SAAiBi6D,EAAS3nC,GAKzB,OAJK7nB,KAAKm+D,MAAM19D,IAAI+uD,IACnBxvD,KAAKm+D,MAAM39D,IAAIgvD,EAAM3nC,EAAG2nC,IAGlBxvD,KAAKm+D,MAAM5kE,IAAIi2D,EACvB,KAAA0O,CAAA,CAjBY,kBCWN,SAASE,GAAqCC,EAA2B5lE,GAC/E,IAAK,IAAL44D,EAAA,EAAAiF,EAA8BriE,OAAO2gB,QAAQypD,GAAKhN,EAAAiF,EAAA9iE,OAAA69D,IAAG,CAArD,IAAAkF,EAAApE,EAAAmE,EAAAjF,GAAA,GAAYj9D,EAAAmiE,EAAA,GACL+H,EADkB/H,EAAA,GAElBhhE,EAAQkD,EAAOrE,GAIrB,GAAI,OAAQkqE,GAAW/oE,IAAU+oE,EAAQpoD,GAAI,OAAO,EACpD,GAAI,QAASooD,GAAW/oE,IAAU+oE,EAAQC,IAAK,OAAO,EACtD,GAAI,OAAQD,IAA6B,kBAAV/oE,GAAsBA,GAAS+oE,EAAQE,IAAK,OAAO,CACnF,CACA,OAAO,CACR,CAEO,SAASC,GACfp+D,EACAs1D,EACA0I,GAIA,IAFA,IAAMK,EAAWzqE,OAAO0qE,YAAY1qE,OAAOmE,KAAKimE,GAAO7rD,KAAI,SAACpe,GAAA,MAAQ,CAACA,EAAK,IAAI6f,IAAM,KAEpF2qD,EAAA,EAAAC,EAA2B5qE,OAAO2gB,QAAQypD,GAAKO,EAAAC,EAAArrE,OAAAorE,IAAG,CAAlD,IAAAE,EAAA3M,EAAA0M,EAAAD,GAAA,GAAYh5C,EAAAk5C,EAAA,GAAGR,EAAOQ,EAAA,GACrB,GAAI,OAAQR,EAAS,CACpB,IACMS,EADQ1+D,EAAM3K,MAAMigE,EAAU/vC,GAClBrwB,MAAMgE,IAAI+kE,EAAQpoD,IACpC,GAAI6oD,EAAK,KACS5P,EADTC,EAAAC,EACS0P,GAAA,IAAjB,IAAA3P,EAAAd,MAAAa,EAAAC,EAAAzvD,KAAAhD,MAAsB,KAAXoO,EAAAokD,EAAA55D,MACVmpE,EAAS94C,GAAGxQ,IAAIrK,EACjB,QAAA08C,GAAA2H,EAAAn9C,EAAAw1C,EAAA,SAAA2H,EAAA/2D,GAAA,CACD,CACD,MAAO,GAAI,QAASimE,EAAS,CAC5B,IACiC/O,EADWE,EAAAJ,EAA9BhvD,EAAM3K,MAAMigE,EAAU/vC,GACHrwB,OAAA,IAAjC,IAAAk6D,EAAAnB,MAAAiB,EAAAE,EAAA9vD,KAAAhD,MAAwC,KAAAqiE,EAAA7M,EAAA5C,EAAAh6D,MAAA,GAA5BA,EAAAypE,EAAA,GAAOD,EAAGC,EAAA,GACrB,GAAIzpE,IAAU+oE,EAAQC,IAAK,KACTU,EADSC,EAAA7P,EACT0P,GAAA,IAAjB,IAAAG,EAAA5Q,MAAA2Q,EAAAC,EAAAv/D,KAAAhD,MAAsB,KAAXoO,EAAAk0D,EAAA1pE,MACVmpE,EAAS94C,GAAGxQ,IAAIrK,EACjB,QAAA08C,GAAAyX,EAAAjtD,EAAAw1C,EAAA,SAAAyX,EAAA7mE,GAAA,CACD,CACD,QAAAovD,GAAAgI,EAAAx9C,EAAAw1C,EAAA,SAAAgI,EAAAp3D,GAAA,CACD,MAAO,GAAI,OAAQimE,EAAS,CAC3B,IACiCa,EADWC,EAAA/P,EAA9BhvD,EAAM3K,MAAMigE,EAAU/vC,GACHrwB,OAAA,IAAjC,IAAA6pE,EAAA9Q,MAAA6Q,EAAAC,EAAAz/D,KAAAhD,MAAwC,KAAA0iE,EAAAlN,EAAAgN,EAAA5pE,MAAA,GAA5BA,EAAA8pE,EAAA,GAAON,EAAGM,EAAA,GACrB,GAAI9pE,EAAQ+oE,EAAQE,GAAI,KACNc,EADMC,EAAAlQ,EACN0P,GAAA,IAAjB,IAAAQ,EAAAjR,MAAAgR,EAAAC,EAAA5/D,KAAAhD,MAAsB,KAAXoO,EAAAu0D,EAAA/pE,MACVmpE,EAAS94C,GAAGxQ,IAAIrK,EACjB,QAAA08C,GAAA8X,EAAAttD,EAAAw1C,EAAA,SAAA8X,EAAAlnE,GAAA,CACD,CACD,QAAAovD,GAAA2X,EAAAntD,EAAAw1C,EAAA,SAAA2X,EAAA/mE,GAAA,CACD,CACD,CAEA,OCxDM,SAA0BmnE,GAChC,GAAoB,IAAhBA,EAAKhsE,OAAc,OAAO,IAAIygB,IAClC,IAIkBk7C,EAJZtlD,EAAQ21D,EAAK,GACbC,EAAOD,EAAKtoE,MAAM,GAClBQ,EAAS,IAAIuc,IAAOm7C,EAAAC,EAERxlD,GAAA,QAAA61D,EAAA,WAAO,IAAdz4D,EAAAkoD,EAAA55D,MACNkqE,EAAKE,OAAM,SAACn/D,GAAA,OAAQA,EAAIC,IAAIwG,EAAI,KACnCvP,EAAO0d,IAAInO,EAEb,EAJA,IAAAmoD,EAAAd,MAAAa,EAAAC,EAAAzvD,KAAAhD,MAAA+iE,GAIA,OAAAjY,GAAA2H,EAAAn9C,EAAAw1C,EAAA,SAAA2H,EAAA/2D,GAAA,CAEA,OAAOX,CACR,CD2CQkoE,CAAc3rE,OAAOihB,OAAOwpD,GACpC,CEnDyB,IAsBZmB,GAAA,WACZ,SAAAA,EACkB7F,EACA8F,GAChB1T,EAAA,KAAAyT,GAACzM,EAAA,kBAOkB,IAAIr/C,KAAwBq/C,EAAA,oBAO1B,IAAIr/C,KAhBT,KAAAimD,MAAAA,EACA,KAAA8F,QAAAA,CACf,CAoaH,OApaGlT,EAAAiT,EAAA,EAAAzrE,IAAA,gBAAAmB,MAwBI,SACNogE,GACoE,IAAAG,EAAA,KAGpE,GAAI91D,KAAK+/D,aAAat/D,IAAIk1D,GACzB,OAAO31D,KAAK+/D,aAAaxmE,IAAIo8D,GAG9B,IAAMqK,EAAW5hD,GAChB,iBAAmBu3C,GACnB,SAACsK,EAAW7G,GACX,GAAIgD,GAAgB6D,GACnB,OAAOnK,EAAKgK,QAAQvqE,MAGrB,IAAMq+D,EAAOkC,EAAKgK,QAAQI,aAAa9G,GACvC,GAAIxF,IAASqF,GAAa,OAAOnD,EAAKgK,QAAQvqE,MAE9C,IAKsB45D,EALhBpiD,EAAsB,CAAEgnD,MAAO,CAAC,EAAGF,QAAS,CAAC,EAAGsM,QAAS,CAAC,GAC5DrM,EAAW,EACXH,EAAa,EACbyM,EAAa,EAAAhR,EAAAC,EAEKuE,GAAA,IAAtB,IAAAxE,EAAAd,MAAAa,EAAAC,EAAAzvD,KAAAhD,MAA4B,CAC3B,IAD2B,IAAjB0jE,EAAAlR,EAAA55D,MACV87D,EAAA,EAAAiP,EAAoBrsE,OAAOihB,OAAOmrD,EAAQtM,OAAK1C,EAAAiP,EAAA9sE,OAAA69D,IAAG,CAAlD,IAAW0C,EAAAuM,EAAAjP,GACV,GAAI0C,EAAM4B,WAAaA,EACtB,GAAI5oD,EAAI8mD,QAAQE,EAAMhpD,IAAK,CAC1B,IAAMhO,EAAWgQ,EAAI8mD,QAAQE,EAAMhpD,WAC5BgC,EAAI8mD,QAAQE,EAAMhpD,IACzB4oD,IACI52D,IAAag3D,IAChBhnD,EAAIozD,QAAQpM,EAAMhpD,IAAM,CAAChO,EAAUg3D,GACnCqM,IAEF,MACCrzD,EAAIgnD,MAAMA,EAAMhpD,IAAMgpD,EACtBD,GAGH,CAEA,IAAK,IAAL8K,EAAA,EAAA2B,EAAyBtsE,OAAOihB,OAAOmrD,EAAQF,SAAOvB,EAAA2B,EAAA/sE,OAAAorE,IAAG,CAAzD,IAAA4B,EAAArO,EAAAoO,EAAA3B,GAAA,GAAYxQ,EAAAoS,EAAA,GAAMC,EAAED,EAAA,GACfC,EAAG9K,WAAaA,IACf5oD,EAAIgnD,MAAM0M,EAAG11D,IAChBgC,EAAIgnD,MAAM0M,EAAG11D,IAAM01D,EACT1zD,EAAIozD,QAAQM,EAAG11D,IACzBgC,EAAIozD,QAAQM,EAAG11D,IAAM,CAACgC,EAAIozD,QAAQM,EAAG11D,IAAI,GAAI01D,IAE7C1zD,EAAIozD,QAAQM,EAAG11D,IAAM,CAACqjD,EAAWqS,GACjCL,KAGH,CAEA,IAAK,IAALM,EAAA,EAAAC,EAAsB1sE,OAAOihB,OAAOmrD,EAAQxM,SAAO6M,EAAAC,EAAAntE,OAAAktE,IAAG,CAAtD,IAAW7M,EAAA8M,EAAAD,GACN7M,EAAQ8B,WAAaA,IACpB5oD,EAAIgnD,MAAMF,EAAQ9oD,YAEdgC,EAAIgnD,MAAMF,EAAQ9oD,IACzB+oD,KACU/mD,EAAIozD,QAAQtM,EAAQ9oD,KAE9BgC,EAAI8mD,QAAQA,EAAQ9oD,IAAMgC,EAAIozD,QAAQtM,EAAQ9oD,IAAI,UAC3CgC,EAAIozD,QAAQtM,EAAQ9oD,IAC3Bq1D,IACAzM,MAEA5mD,EAAI8mD,QAAQA,EAAQ9oD,IAAM8oD,EAC1BF,KAGH,CACD,QAAAlM,GAAA2H,EAAAn9C,EAAAw1C,EAAA,SAAA2H,EAAA/2D,GAAA,CAEA,OAAIy7D,GAAYH,GAAcyM,EACtB9D,GAASxG,EAAKgK,QAAQvqE,MAAOwX,GAE7BkzD,CAET,GACA,CAAE5E,cAAe,MAKlB,OAFAr7D,KAAK+/D,aAAav/D,IAAIm1D,EAAUqK,GAEzBA,CACR,IAAA5rE,IAAA,QAAAmB,MAUO,SAGLogE,EAAoBiL,GACrB,IAAMC,EAAWlL,EAAW,IAAMiL,EAElC,GAAI5gE,KAAK8gE,WAAWrgE,IAAIogE,GACvB,OAAO7gE,KAAK8gE,WAAWvnE,IAAIsnE,GAG5B,IAAMnrE,EAAQsK,KAAK+gE,uBAAuBpL,EAAUiL,GAIpD,OAFA5gE,KAAK8gE,WAAWtgE,IAAIqgE,EAAUnrE,GAEvBA,CACR,IAAAtB,IAAA,yBAAAmB,MAUA,SAGEogE,EAAoBiL,GAA2E,IAAAI,EAAA,KAG1FC,EAAcjhE,KAAKkhE,cAAcvL,GAEjCwL,EAAc,WAGnBF,EAAY1rE,MAEZ,IADA,IAAMwX,EAAM,IAAIgH,IAChBqtD,EAAA,EAAAC,EAAmBptE,OAAOihB,OAAO8rD,EAAKhH,MAAMzkE,OAAK6rE,EAAAC,EAAA7tE,OAAA4tE,IAAG,CAApD,IACOrL,EADIsL,EAAAD,GACU7rE,MACpB,GAAIwgE,EAAOJ,WAAaA,EAAU,CACjC,IAAMpgE,EAASwgE,EAAa6K,GACvB7zD,EAAItM,IAAIlL,IACZwX,EAAIvM,IAAIjL,EAAO,IAAI0e,KAEpBlH,EAAIxT,IAAIhE,GAAQ6f,IAAK2gD,EAAahrD,GACnC,CACD,CAEA,OAAOgC,CACR,EAEA,OAAOqR,GACN,SAAWu3C,EAAW,IAAMiL,GAC5B,SAACU,EAAWlI,GACX,GAAIgD,GAAgBkF,GAAY,OAAOH,IAEvC,IAAMrB,EAAUmB,EAAYf,aAAa9G,GACzC,GAAI0G,IAAY7G,GACf,OAAOkI,IAGR,IAiBsB5R,EAjBhBgS,EAAkB,IAAIxtD,IAEtBqB,EAAM,SAAC7f,EAAoBwV,GAAc,IAAAy2D,EAC1CC,EAAiBF,EAAgBhoE,IAAIhE,GACpCksE,IACJA,EAAiB,IAAIvO,EAAoD,QAApDsO,EAAiCF,EAAU/nE,IAAIhE,UAAK,IAAAisE,EAAAA,EAAK,IAAIvtD,MACnFwtD,EAAersD,IAAIrK,GACnBw2D,EAAgB/gE,IAAIjL,EAAOksE,EAC5B,EAEM/J,EAAS,SAACniE,EAAoBwV,GAAc,IAAA22D,EAC7ClhE,EAAM+gE,EAAgBhoE,IAAIhE,GACzBiL,IAAKA,EAAM,IAAI0yD,EAAoD,QAApDwO,EAAiCJ,EAAU/nE,IAAIhE,UAAK,IAAAmsE,EAAAA,EAAK,IAAIztD,MACjFzT,EAAIk3D,OAAO3sD,GACXw2D,EAAgB/gE,IAAIjL,EAAOiL,EAC5B,EAAAivD,EAAAJ,EAEsByQ,GAAA,IAAtB,IAAArQ,EAAAnB,MAAAiB,EAAAE,EAAA9vD,KAAAhD,MAA+B,CAC9B,IAD8B,IAApB0jE,EAAA9Q,EAAAh6D,MACVosE,EAAA,EAAAC,EAAqB3tE,OAAOihB,OAAOmrD,EAAQtM,OAAK4N,EAAAC,EAAApuE,OAAAmuE,IAAG,CAAnD,IAAW5L,EAAA6L,EAAAD,GACV,GAAI5L,EAAOJ,WAAaA,EAEvBvgD,EADe2gD,EAAa6K,GAChB7K,EAAahrD,GAE3B,CACA,IAAK,IAAL82D,EAAA,EAAAC,EAAyB7tE,OAAOihB,OAAOmrD,EAAQF,SAAO0B,EAAAC,EAAAtuE,OAAAquE,IAAG,CAAzD,IAAAE,EAAA5P,EAAA2P,EAAAD,GAAA,GAAYzT,EAAA2T,EAAA,GAAMtB,EAAEsB,EAAA,GACnB,GAAItB,EAAG9K,WAAaA,EAAU,CAC7B,IAAMqM,EAAQ5T,EAAWwS,GACnB/zB,EAAQ4zB,EAASG,GACnBoB,IAASn1B,IACZ6qB,EAAOsK,EAAOvB,EAAS11D,IACvBqK,EAAIy3B,EAAO4zB,EAAS11D,IAEtB,CACD,CACA,IAAK,IAALk3D,EAAA,EAAAC,EAAqBjuE,OAAOihB,OAAOmrD,EAAQxM,SAAOoO,EAAAC,EAAA1uE,OAAAyuE,IAAG,CAArD,IAAWlM,EAAAmM,EAAAD,GACV,GAAIlM,EAAOJ,WAAaA,EAEvB+B,EADe3B,EAAa6K,GACb7K,EAAahrD,GAE9B,CACD,QAAA08C,GAAAgI,EAAAx9C,EAAAw1C,EAAA,SAAAgI,EAAAp3D,GAAA,CAEA,IAGsC4mE,EAHlCjL,OAAiD,EACjDmO,OAAiD,EAAAjD,EAAA7P,EAEfkS,GAAA,IAAtC,IAAArC,EAAA5Q,MAAA2Q,EAAAC,EAAAv/D,KAAAhD,MAAuD,KAAAylE,EAAAjQ,EAAA8M,EAAA1pE,MAAA,GAA3CA,EAAA6sE,EAAA,GACL1qE,EAD0B0qE,EAAA,GACF7oE,MACzB7B,IACAs8D,IAAWA,EAAY,IAAIjgD,IAAIutD,IAC/Ba,IAAUA,EAAW,IAAIpuD,KACJ,IAAtBrc,EAAOnC,MAAMwU,KAChBiqD,EAAU3/B,OAAO9+B,GAEjBy+D,EAAUxzD,IAAIjL,EAAOmC,EAAOnC,OAE7B4sE,EAAS3hE,IAAIjL,EAAOmC,EAAOk8D,MAC5B,QAAAnM,GAAAyX,EAAAjtD,EAAAw1C,EAAA,SAAAyX,EAAA7mE,GAAA,CAEA,OAAI27D,GAAamO,EACT7F,GAAStI,EAAWmO,GAGrBb,CACR,GACA,CAAEjG,cAAe,KAEnB,IAAAjnE,IAAA,SAAAmB,MAWA,SACCogE,GAG2D,IAAA0M,EAAA,KAF3DC,EAAA/uE,UAAAC,OAAA,QAAA6B,IAAA9B,UAAA,GAAAA,UAAA,GAA0E,iBAAO,CAAC,GAClF0F,EAAA1F,UAAAC,OAAA,QAAA6B,IAAA9B,UAAA,GAAAA,UAAA,GAAO,UAAYoiE,GAAY2M,EAAe,IAAMA,EAAatuE,WAAa,IAGxE+qE,EAAM/+D,KAAK++D,IAAIpJ,EAAU2M,EAAcrpE,GAE7C,OAAOmlB,GAAwBnlB,GAAM,WAAM,IACrBkmE,EADqBC,EAAA/P,EACzB0P,EAAIxpE,OAAA,IAArB,IAAA6pE,EAAA9Q,MAAA6Q,EAAAC,EAAAz/D,KAAAhD,MAA4B,KAAA4lE,EAAjBx3D,EAAAo0D,EAAA5pE,MACV,OAA0B,QAA1BgtE,EAAOF,EAAKrI,MAAMzkE,MAAMwV,UAAE,IAAAw3D,OAAA,EAAnBA,EAAsBhtE,KAC9B,QAAAkyD,GAAA2X,EAAAntD,EAAAw1C,EAAA,SAAA2X,EAAA/mE,GAAA,CAED,GACD,IAAAjE,IAAA,UAAAmB,MASA,SACCogE,GAGsD,IAAA6M,EAAA,KAFtDF,EAAA/uE,UAAAC,OAAA,QAAA6B,IAAA9B,UAAA,GAAAA,UAAA,GAA0E,iBAAO,CAAC,GAClF0F,EAAA1F,UAAAC,OAAA,QAAA6B,IAAA9B,UAAA,GAAAA,UAAA,GAAO,WAAaoiE,GAAY2M,EAAe,IAAMA,EAAatuE,WAAa,IAGzE+qE,EAAM/+D,KAAK++D,IAAIpJ,EAAU2M,EAAc,OAASrpE,GAEtD,OAAOmlB,GAAcnlB,GAAM,WAC1B,OAAOw3D,EAAIsO,EAAIxpE,OAAOid,KAAI,SAACzH,GAC1B,IAAMovD,EAAOqI,EAAKxI,MAAMzkE,MAAMwV,GAC9B,IAAKovD,EACJ,MAAM,IAAI70C,MAAM,gCAAkCva,GAEnD,OAAOovD,EAAK5kE,KACb,GACD,GACD,IAAAnB,IAAA,MAAAmB,MASA,SACCogE,GAMC,IAAA8M,EAAA,KALDH,EAAA/uE,UAAAC,OAAA,QAAA6B,IAAA9B,UAAA,GAAAA,UAAA,GAA0E,iBAAO,CAAC,GAClF0F,EAAA1F,UAAAC,OAAA,QAAA6B,IAAA9B,UAAA,GAAAA,UAAA,GAAO,OAASoiE,GAAY2M,EAAe,IAAMA,EAAatuE,WAAa,IAOrEitE,EAAcjhE,KAAKkhE,cAAcvL,GAEjCwL,EAAc,WAEnBF,EAAY1rE,MACZ,IAAM8oE,EAA4BiE,IAClC,OAAkC,IAA9BruE,OAAOmE,KAAKimE,GAAO7qE,OACf,IAAIygB,IACVhgB,OAAOihB,OAAOutD,EAAKzI,MAAMzkE,OAAOmW,SAAQ,SAACgX,GACxC,IAAM4rB,EAAI5rB,EAAEntB,MACZ,OAAI+4C,EAAEqnB,WAAaA,EACXrnB,EAAEvjC,GAEF,EAET,KAIK0zD,GAAagE,EAAM9M,EAAU0I,EACrC,EAEMqE,EAAsB,SAACpB,GAC5B,IAAMtN,EAAYmN,IACZvN,EDlWF,SAAqBoO,EAAcn1B,GACzC,IAEkB0iB,EAFZ73D,EAA4B,CAAC,EAAA+3D,EAAAJ,EAEjBxiB,GAAA,IAAlB,IAAA4iB,EAAAnB,MAAAiB,EAAAE,EAAA9vD,KAAAhD,MAAwB,KACHgmE,EADV17D,EAAAsoD,EAAAh6D,MACLysE,EAAKvhE,IAAIwG,KACN,QAAP07D,EAAAjrE,EAAOq8D,aAAA,IAAA4O,IAAPjrE,EAAOq8D,MAAU,IAAI9/C,KACrBvc,EAAOq8D,MAAM3+C,IAAInO,GAEnB,QAAAwgD,GAAAgI,EAAAx9C,EAAAw1C,EAAA,SAAAgI,EAAAp3D,GAAA,KAEkB4mE,EAFlBC,EAAA7P,EAEkB2S,GAAA,IAAlB,IAAA9C,EAAA5Q,MAAA2Q,EAAAC,EAAAv/D,KAAAhD,MAAwB,KACHimE,EADV37D,EAAAg4D,EAAA1pE,MACLs3C,EAAKpsC,IAAIwG,KACN,QAAP27D,EAAAlrE,EAAOm8D,eAAA,IAAA+O,IAAPlrE,EAAOm8D,QAAY,IAAI5/C,KACvBvc,EAAOm8D,QAAQz+C,IAAInO,GAErB,QAAAwgD,GAAAyX,EAAAjtD,EAAAw1C,EAAA,SAAAyX,EAAA7mE,GAAA,CAEA,OAAOX,EAAOq8D,OAASr8D,EAAOm8D,QAAUn8D,OAAS,CAClD,CCgVgBmrE,CAASvB,EAAWtN,GACjC,OAAIJ,EACI0I,GAAStI,EAAWJ,GAEpB0N,CAET,EACMwB,EAAc1kD,GAAS,aAAenlB,EAAMqpE,EAAc,CAC/DlH,QAAAA,KAGD,OAAOh9C,GACN,SAAWnlB,GACX,SAACqoE,EAAWlI,GACX,IAAMiF,EAAQyE,EAAYvtE,MAC1B,GAAI6mE,GAAgBkF,GACnB,OAAOH,IAIR,GAAI/H,EAAoB0J,EAAYxL,iBACnC,OAAOoL,EAAoBpB,GAI5B,IAAMxB,EAAUmB,EAAYf,aAAa9G,GACzC,GAAI0G,IAAY7G,GACf,OAAOyJ,EAAoBpB,GAG5B,IAIsBhC,EAJhBmC,EAAiB,IAAIvO,EAC1BoO,GACD/B,EAAAlQ,EAEsByQ,GAAA,IAAtB,IAAAP,EAAAjR,MAAAgR,EAAAC,EAAA5/D,KAAAhD,MAA+B,CAC9B,IAD8B,IAApB0jE,EAAAf,EAAA/pE,MACVwtE,EAAA,EAAAC,EAAoB/uE,OAAOihB,OAAOmrD,EAAQtM,OAAKgP,EAAAC,EAAAxvE,OAAAuvE,IAAG,CAAlD,IAAWhP,EAAAiP,EAAAD,GACNhP,EAAM4B,WAAaA,GAAYyI,GAAmBC,EAAOtK,IAC5D0N,EAAersD,IAAI2+C,EAAMhpD,GAE3B,CACA,IAAK,IAALk4D,EAAA,EAAAC,EAA2BjvE,OAAOihB,OAAOmrD,EAAQF,SAAO8C,EAAAC,EAAA1vE,OAAAyvE,IAAG,CAA3D,IAAAE,EAAAhR,EAAA+Q,EAAAD,GAAA,GAAe9C,GAAHgD,EAAA,GAAUA,EAAA,IACjBhD,EAAQxK,WAAaA,IACpByI,GAAmBC,EAAO8B,GAC7BsB,EAAersD,IAAI+qD,EAAQp1D,IAE3B02D,EAAe/J,OAAOyI,EAAQp1D,IAGjC,CACA,IAAK,IAALq4D,EAAA,EAAAC,EAAsBpvE,OAAOihB,OAAOmrD,EAAQxM,SAAOuP,EAAAC,EAAA7vE,OAAA4vE,IAAG,CAAtD,IAAWvP,EAAAwP,EAAAD,GACNvP,EAAQ8B,WAAaA,GACxB8L,EAAe/J,OAAO7D,EAAQ9oD,GAEhC,CACD,QAAA08C,GAAA8X,EAAAttD,EAAAw1C,EAAA,SAAA8X,EAAAlnE,GAAA,CAEA,IAAMX,EAAS+pE,EAAeloE,MAC9B,OAAK7B,EAIE4kE,GAAS5kE,EAAOnC,MAAOmC,EAAOk8D,MAH7B0N,CAIT,GACA,CAAEjG,cAAe,IAEnB,IAAAjnE,IAAA,OAAAmB,MAEA,SACCogE,EACA0I,GAEA,IAAMU,EAAMN,GAAaz+D,KAAM21D,EAAU0I,GACzC,GAAiB,IAAbU,EAAIh1D,KACP,OAAO8tD,GAER,IAAMmC,EAAQh6D,KAAKg6D,MAAMzkE,MACzB,OAAOk7D,EAAIsO,GAAKvsD,KAAI,SAACzH,GAAA,OAAOivD,EAAMjvD,GAAIxV,KAA2C,GAClF,KAAAsqE,CAAA,CAxaY,GC6CAyD,GAAA,WAqDZ,SAAAA,EAAY1N,GAWT,IAAAE,EAAA,KAAA1J,EAAA,KAAAkX,GAhEmElQ,EAAA,aAOf+G,GAAK,cAAe,CAAC,IAAC/G,EAAA,eAQ5B+G,GAAK,UAAW,EAAG,CACnEkB,cAAe,OACfjI,EAAA,aAQgB,IAAIyM,GAAgB7/D,KAAKg6D,MAAOh6D,KAAK8/D,UAAO1M,EAAA,iBAOzC,IAAIn/C,KAAsBm/C,EAAA,0BAOjB,IAAImQ,IAAsBnQ,EAAA,8BAAAA,EAAA,sBAAAA,EAAA,qBAkFvDA,EAAA,6BAQAA,EAAA,6BAQAA,EAAA,8BAOAA,EAAA,6BAOAA,EAAA,sBAGwB,GAAAA,EAAA,YAQlB,SAACoQ,EAAcC,GACpBxI,IAAS,WAgBR,IAfA,IAOIlF,EAPE2N,EAA2C,CAAC,EAC5CC,EAA8B,CAAC,EAE/BC,EAAa9N,EAAKkE,MAAM3C,8BAC1B7kD,EAAM,KASNqxD,GAAY,EAEPvwE,EAAI,EAAGqM,EAAI6jE,EAAQhwE,OAAQF,EAAIqM,EAAGrM,IAAK,KAAAwwE,EAGzCC,GAAc,QAAdD,EAActxD,SAAA,IAAAsxD,EAAAA,EAAOF,IAF3B7N,EAASyN,EAAQlwE,IAE6ByX,IAE9C,GAAIg5D,EAAY,CAGf,IAAMt8C,EAAes8C,EAAW1M,8BAGhCtB,EAASD,EAAKkO,OAAOC,eACpBnO,EACAC,EACA,OAAA0N,QAAA,IAAAA,EAAAA,EAAiB,eACjBh8C,GAGDs8C,EAAWvjE,IAAcu1D,GAGzB,IAAMmO,EAAaH,EAAW1M,8BAG1B5vC,IAAiBy8C,IACpBL,GAAY,EACZH,EAAQ3N,EAAOhrD,IAAM,CAAC0c,EAAcy8C,GAEtC,MACCL,GAAY,EAaZF,GARA5N,EAASD,EAAKkO,OAAOC,eACpBnO,EACAC,EACA,OAAA0N,QAAA,IAAAA,EAAAA,EAAiB,eACjB,OAIgB14D,IAAMgrD,EAGlBvjD,IACJA,EAAAw+C,EAAA,GAAW4S,IAEZpxD,EAAIujD,EAAOhrD,IAAMovD,GAAK,QAAUpE,EAAOhrD,GAAIgrD,EAE7C,CAQA,GALIvjD,GACHsjD,EAAKkE,MAAMx5D,IAAIgS,GAIXqxD,EAAL,CACA/N,EAAKqO,cAAc,CAClBpQ,MAAO4P,EACPxD,QAASuD,EACT7P,QAAS,CAAC,IAGX,IAAQuQ,EAAiCtO,EAAjCsO,cAAeC,EAAkBvO,EAAlBuO,cAEnBD,GAAiBtO,EAAKwO,eAEzBrwE,OAAOihB,OAAOyuD,GAAWlxD,SAAQ,SAAC8xD,GACjCH,EAAcG,EACf,IAGGF,GAAiBvO,EAAKwO,eAEzBrwE,OAAOihB,OAAOwuD,GAASjxD,SAAQ,SAAAgpD,GAAgB,IAAA+I,EAAArS,EAAAsJ,EAAA,GAAdrN,EAAAoW,EAAA,GAAM/D,EAAE+D,EAAA,GACxCH,EAAcjW,EAAMqS,EACrB,GApBqB,CAsBvB,GACD,IAAArN,EAAA,eAQS,SAAC2L,GACT9D,IAAS,WACR,GAAInF,EAAK2O,gBAAkB3O,EAAKwO,cAAe,KAC7BnV,EAD6BC,EAAAC,EAC7B0P,GAAA,IAAjB,IAAA3P,EAAAd,MAAAa,EAAAC,EAAAzvD,KAAAhD,MAAsB,KAAXoO,EAAAokD,EAAA55D,MACJmvE,EAAO5O,EAAKkE,MAAM3C,8BAA8BtsD,GACjD25D,GAEL5O,EAAK2O,eAAeC,EAAKnvE,MAC1B,QAAAkyD,GAAA2H,EAAAn9C,EAAAw1C,EAAA,SAAA2H,EAAA/2D,GAAA,CACD,CAEA,IAAIw7D,OAAU,EAiBd,GAdAiC,EAAKkE,MAAM2K,QAAO,SAAC3K,GAAU,IAAA7R,EAGXoH,EAFb73D,OAAmC,EAAA+3D,EAAAJ,EAEtB0P,GAAA,IAAjB,IAAAtP,EAAAnB,MAAAiB,EAAAE,EAAA9vD,KAAAhD,MAAsB,KAAXoO,EAAAwkD,EAAAh6D,MACJwV,KAAMivD,IACPtiE,IAAQA,EAAAs5D,EAAA,GAAcgJ,IACtBnG,IAASA,EAAU,CAAC,UAClBn8D,EAAOqT,GACd8oD,EAAQ9oD,GAAMivD,EAAMjvD,GAAIxV,MACzB,QAAAkyD,GAAAgI,EAAAx9C,EAAAw1C,EAAA,SAAAgI,EAAAp3D,GAAA,CAEA,OAAO,QAAP8vD,EAAOzwD,SAAA,IAAAywD,EAAAA,EAAU6R,CAClB,IAEKnG,IAELiC,EAAKqO,cAAc,CAAEpQ,MAAO,CAAC,EAAGoM,QAAS,CAAC,EAAGtM,QAAAA,IAGzCiC,EAAK8O,eAAiB9O,EAAKwO,eAC9B,IAAK,IAAIhxE,EAAI,EAAGqM,EAAIo/D,EAAIvrE,OAAQF,EAAIqM,EAAGrM,IACtCwiE,EAAK8O,cAAc/Q,EAAQkL,EAAIzrE,IAGlC,GACD,IAAA8/D,EAAA,YAQM,SAAkBroD,GAAoC,IAAA85D,EAC3D,OAA0B,QAA1BA,EAAO/O,EAAKkE,MAAMzkE,MAAMwV,UAAE,IAAA85D,OAAA,EAAnBA,EAAsBtvE,KAC9B,IAAA69D,EAAA,gCAQ0B,SAAkBroD,GAAoC,IAAA+5D,EAC/E,OAA0B,QAA1BA,EAAOhP,EAAKkE,MAAMzkE,MAAMwV,UAAE,IAAA+5D,OAAA,EAAnBA,EAAsBzN,6BAC9B,IAAAjE,EAAA,kBAQY,SAACvE,GAEZ,IADA,IAAMn3D,EAA8B,CAAC,EACrC25D,EAAA,EAAAiF,EAAyBriE,OAAO2gB,QAAQkhD,EAAKkE,MAAMzkE,OAAK87D,EAAAiF,EAAA9iE,OAAA69D,IAAG,CAA3D,IAAAkF,EAAApE,EAAAmE,EAAAjF,GAAA,GAAYtmD,EAAAwrD,EAAA,GACLR,EADaQ,EAAA,GACChhE,OACE,oBAAXs5D,GAA0BA,EAAOkH,MAC5Cr+D,EAAOqT,GAAMgrD,EACd,CACA,OAAOr+D,CACR,IAAA07D,EAAA,oBAQc,SAAC2R,GACd9J,IAAS,WACRnF,EAAKjhD,QACLihD,EAAKkP,IAAI/wE,OAAOihB,OAAO6vD,GACxB,GACD,IAAA3R,EAAA,mBAQa,WACZ,OAAOn/D,OAAOihB,OAAO4gD,EAAKkE,MAAMzkE,OAAOid,KAAI,SAACkyD,GAAA,OAASA,EAAKnvE,KAAK,GAChE,IAAA69D,EAAA,cAOQ,WACP0C,EAAK4B,OAAOzjE,OAAOmE,KAAK09D,EAAKkE,MAAMzkE,OACpC,IAAA69D,EAAA,eAQS,SAAkBroD,EAAO6kC,GACjC,IAAM80B,EAAO5O,EAAKkE,MAAMzkE,MAAMwV,GACzB25D,EAIL5O,EAAKkP,IAAI,CAACp1B,EAAQ80B,EAAKrN,iCAHtB1f,QAAQhgD,MAAA,UAAA8O,OAAgBsE,EAAA,yCAI1B,IAAAqoD,EAAA,YAQM,SAAkBroD,GACvB,QAAS+qD,EAAKkE,MAAMzkE,MAAMwV,EAC3B,IAAAqoD,EAAA,eAQS,SAACrlD,GAUT,OARA+nD,EAAKmP,gBAELnP,EAAKtnD,UAAU4G,IAAIrH,GAEd+nD,EAAKoP,eAAevH,UAAU/E,qBAClC9C,EAAKoP,eAAejoE,QAGd,WACN64D,EAAKtnD,UAAU6lB,OAAOtmB,GAEM,IAAxB+nD,EAAKtnD,UAAUzE,MAClB+rD,EAAKoP,eAAelH,MAEtB,CACD,IAAA5K,EAAA,+BAEiC,GAAAA,EAAA,2BAQZ,SAACt1D,GACrB,GAAIg4D,EAAKqP,uBACR,OAAOrnE,IAGR,IACCg4D,EAAKqP,wBAAyB,EAC9BlK,GAASn9D,EACV,CAAE,QACDg4D,EAAKqP,wBAAyB,CAC/B,CACD,IAgCA/R,EAAA,4BASsB,SACrBn6D,EACAujE,GAEA,IAAM1+C,EAAQ,IAAIogD,GAClB,MAAO,CACN3kE,IAAK,SAACwR,GACL,IAAM25D,EAAO5O,EAAKkE,MAAMzkE,MAAMwV,GAC9B,GAAK25D,EAGL,OAAO5mD,EAAMvkB,IAAImrE,GAAM,kBACtBtmD,GAAwBnlB,EAAO,IAAM8R,GAAI,kBAAMyxD,EAAOkI,EAAKnvE,MAAW,OACrEA,KACH,EAEF,IAAA69D,EAAA,oCAU8B,SAC7Bn6D,EACAmsE,EACA5I,GAEA,IAAM1+C,EAAQ,IAAIogD,GAClB,MAAO,CACN3kE,IAAK,SAACwR,GACL,IAAM25D,EAAO5O,EAAKkE,MAAMzkE,MAAMwV,GAC9B,GAAK25D,EAAL,CAIA,IAAM/hD,EAAIvE,GAAwBnlB,EAAO,IAAM8R,EAAK,aAAa,kBAChEq6D,EAASV,EAAKnvE,MAAU,IAEzB,OAAOuoB,EAAMvkB,IAAImrE,GAAM,kBACtBtmD,GAAwBnlB,EAAO,IAAM8R,GAAI,kBAAMyxD,EAAO75C,EAAEptB,MAAW,OAClEA,KAPF,CAQD,EAEF,IAAA69D,EAAA,6BAO+B,GA5d9B,IAAQiS,EAAwBzP,EAAxByP,YAAarB,EAAWpO,EAAXoO,OAErBhkE,KAAKgkE,OAASA,EACdhkE,KAAK8F,MAAQ8vD,EAAO9vD,MAEhBu/D,GACHrlE,KAAKg6D,MAAMx5D,IACVvM,OAAO0qE,YACN1qE,OAAO2gB,QAAQywD,GAAa7yD,KAAI,SAAA8yD,GAAA,IAAAC,EAAApT,EAAAmT,EAAA,GAAEv6D,EAAAw6D,EAAA,GAAIxP,EAAMwP,EAAA,SAAM,CACjDx6D,EACAovD,GAAK,QAAUpvD,EAAI+qD,EAAKkO,OAAOC,eAAenO,EAAMC,EAAQ,aAAc,OAC1E,MAKJ/1D,KAAKklE,eAAiBtH,GACrB,wBACA,WAEC9H,EAAKgK,QAAQvqE,MAEbugE,EAAKmP,eACN,GACA,CAAE3H,eAAgB,SAACz1C,GAAA,OAAO29C,sBAAsB39C,EAAE,GAEpD,CA0cA,OA1cA+kC,EAAA0W,EAAA,EAAAlvE,IAAA,gBAAAmB,MAEO,WAAgB,IAAAyrE,EAAA,KAEtB,GAAIhhE,KAAKylE,mBAAmBC,aAAc,CACzC,IACkCzG,EADYC,EAAA7P,EAA9BrvD,KAAKylE,mBAAmBroD,SACN,QAAAsiD,EAAA,WAAS,IAAA0C,EAAAnD,EAAA1pE,MAA9B8qE,EAAA+B,EAAA/B,QAASnoE,EAAAkqE,EAAAlqE,OACrB8oE,EAAKxyD,UAAUiE,SAAQ,SAAC/D,GAAA,OAAMA,EAAE,CAAE2xD,QAAAA,EAASnoE,OAAAA,GAAS,GACrD,EAFA,IAAAgnE,EAAA5Q,MAAA2Q,EAAAC,EAAAv/D,KAAAhD,MAAA+iE,GAEA,OAAAjY,GAAAyX,EAAAjtD,EAAAw1C,EAAA,SAAAyX,EAAA7mE,GAAA,CACD,CACD,IAAAjE,IAAA,gBAAAmB,MAOQ,SAAc8qE,GACrBrgE,KAAKylE,mBAAmBrwD,IAAI,CAC3BirD,QAAAA,EACAnoE,OAAQ8H,KAAKmlE,uBAAyB,SAAW,SAEtB,IAAxBnlE,KAAKwO,UAAUzE,MAClB/J,KAAKylE,mBAAmB5wD,QAEzB7U,KAAK8/D,QAAQt/D,IAAIR,KAAK8/D,QAAQvqE,MAAQ,EAAG8qE,EAC1C,IAAAjsE,IAAA,WAAAmB,MAEA,SAASowE,GAAiE,IAAAtD,EAAA,KACzEriE,KAAK4lE,aAAanzD,SAAQ,SAACsjD,GAAA,OAAWsM,EAAK2B,OAAOC,eAAe5B,EAAMtM,EAAQ4P,EAAO,KAAK,GAC5F,IAAAvxE,IAAA,oBAAAmB,MAuUA,SAAkBuI,GACjB,IAAMuiE,EAAiC,GACjCwF,EAAU7lE,KAAKylE,mBAAmBK,cAAa,SAAChxD,GAAA,OAAUurD,EAAQ1sE,KAAKmhB,EAAMurD,QAAQ,IAC3F,IAEC,OADApF,GAASn9D,GACFioE,GAAkB1F,EAC1B,CAAE,QACDwF,GACD,CACD,IAAAzxE,IAAA,YAAAmB,MAEA,SAAUq+D,GAA2C,IAAA4O,EAAA,KAArBwD,IAAAzyE,UAAAC,OAAA,QAAA6B,IAAA9B,UAAA,KAAAA,UAAA,GACzB0yE,EAAmBjmE,KAAKskE,cAC9B,IACCtkE,KAAKskE,cAAgB0B,EACrB/K,IAAS,WACR,IAAMiL,EAAQjyE,OAAOihB,OAAO0+C,EAAKG,OAAOttD,OACvCxS,OAAOihB,OAAO0+C,EAAKuM,SAAS3tD,KAAI,SAAA2zD,GAAA,IAAAC,EAAAjU,EAAAgU,EAAA,GAAEC,EAAA,GAAS,OAAAA,EAAA,EAAQ,KAE9CC,EAAWpyE,OAAOmE,KAAKw7D,EAAKC,SAC9BqS,EAAM1yE,QACTgvE,EAAKwC,IAAIkB,GAENG,EAAS7yE,QACZgvE,EAAK9K,OAAO2O,EAEd,GACD,CAAE,QACDrmE,KAAKskE,cAAgB2B,CACtB,CACD,IAAA7xE,IAAA,sBAAAmB,MA2DA,WACCyK,KAAKgkE,OAAOsC,oBAAoBtmE,KACjC,IAAA5L,IAAA,0BAAAmB,MAIA,WACCyK,KAAKumE,sBAAuB,CAC7B,IAAAnyE,IAAA,sBAAAmB,MAEA,WACC,OAAOyK,KAAKumE,oBACb,KAAAjD,CAAA,CAriBY,GA+iBN,SAASyC,GAAwCS,GACvD,IAEmBrH,EAFbznE,EAAyB,CAAEq8D,MAAO,CAAC,EAAGF,QAAS,CAAC,EAAGsM,QAAS,CAAC,GAAEf,EAAA/P,EAElDmX,GAAA,IAAnB,IAAApH,EAAA9Q,MAAA6Q,EAAAC,EAAAz/D,KAAAhD,MAA0B,CACzB,IADyB,IAAfi3D,EAAAuL,EAAA5pE,MACVqpE,EAAA,EAAAC,EAA0B5qE,OAAO2gB,QAAQg/C,EAAKG,OAAK6K,EAAAC,EAAArrE,OAAAorE,IAAG,CAAtD,IAAAE,EAAA3M,EAAA0M,EAAAD,GAAA,GAAY7zD,EAAA+zD,EAAA,GAAIvpE,EAAKupE,EAAA,GACpB,GAAIpnE,EAAOm8D,QAAQ9oD,GAAK,CACvB,IAAMhO,EAAWrF,EAAOm8D,QAAQ9oD,UACzBrT,EAAOm8D,QAAQ9oD,GAClBhO,IAAaxH,IAChBmC,EAAOyoE,QAAQp1D,GAAM,CAAChO,EAAUxH,GAElC,MACCmC,EAAOq8D,MAAMhpD,GAAMxV,CAErB,CAEA,IAAK,IAALmrE,EAAA,EAAA+F,EAAgCxyE,OAAO2gB,QAAQg/C,EAAKuM,SAAOO,EAAA+F,EAAAjzE,OAAAktE,IAAG,CAA9D,IAAAgG,EAAAvU,EAAAsU,EAAA/F,GAAA,GAAY31D,EAAA27D,EAAA,GAAAC,EAAAxU,EAAAuU,EAAA,MAAYjG,GAAPkG,EAAA,GAASA,EAAA,IACrBjvE,EAAOq8D,MAAMhpD,IAChBrT,EAAOq8D,MAAMhpD,GAAM01D,SACZ/oE,EAAOyoE,QAAQp1D,UACfrT,EAAOm8D,QAAQ9oD,IAGnBrT,EAAOyoE,QAAQp1D,IAClBrT,EAAOyoE,QAAQp1D,GAAI,GAAK01D,SACjB/oE,EAAOm8D,QAAQ9oD,KAIvBrT,EAAOyoE,QAAQp1D,GAAM6oD,EAAKuM,QAAQp1D,UAC3BrT,EAAOm8D,QAAQ9oD,GACvB,CAEA,IAAK,IAALq2D,EAAA,EAAAwF,EAA0B3yE,OAAO2gB,QAAQg/C,EAAKC,SAAOuN,EAAAwF,EAAApzE,OAAA4tE,IAAG,CAAxD,IAAAyF,EAAA1U,EAAAyU,EAAAxF,GAAA,GAAYr2D,EAAA87D,EAAA,GAAItxE,EAAKsxE,EAAA,GAEhBnvE,EAAOq8D,MAAMhpD,UACTrT,EAAOq8D,MAAMhpD,GACVrT,EAAOyoE,QAAQp1D,IACzBrT,EAAOm8D,QAAQ9oD,GAAMrT,EAAOyoE,QAAQp1D,GAAI,UACjCrT,EAAOyoE,QAAQp1D,IAEtBrT,EAAOm8D,QAAQ9oD,GAAMxV,CAEvB,CACD,QAAAkyD,GAAA2X,EAAAntD,EAAAw1C,EAAA,SAAA2X,EAAA/mE,GAAA,CAEA,OAAOX,CACR,CAyCA,IAEM6rE,GAAA,oBAAAA,IAAAnX,EAAA,KAAAmX,GAAAnQ,EAAA,gBACiC,IAACA,EAAA,oBAEuB,IAAIn/C,IAAI,CAuCtE,OAvCsE24C,EAAA2W,EAAA,EAAAnvE,IAAA,eAAAmB,MAEtE,SAAauI,GAAsC,IAAA2kE,EAAA,KAElD,OADAziE,KAAK8mE,aAAa1xD,IAAItX,GACf,WACN2kE,EAAKqE,aAAazyC,OAAOv2B,EAC1B,CACD,IAAA1J,IAAA,MAAAmB,MAEA,SAAIuf,GACH9U,KAAK+mE,SAASpzE,KAAKmhB,GAAK,IACOwqD,EADPC,EAAAlQ,EACErvD,KAAK8mE,cAAA,IAA/B,IAAAvH,EAAAjR,MAAAgR,EAAAC,EAAA5/D,KAAAhD,MAA6C,EAC5CqqE,EADU1H,EAAA/pE,OACEuf,EACb,QAAA2yC,GAAA8X,EAAAttD,EAAAw1C,EAAA,SAAA8X,EAAAlnE,GAAA,CACD,IAAAjE,IAAA,QAAAmB,MAEA,WACC,IAAMuqE,EAtDR,SAAoDlrD,GAMnD,IALA,IAGIE,EAHEpd,EAA4B,GAE9B4O,EAAUsO,EAAQ,GAGbthB,EAAI,EAAGqM,EAAIiV,EAAQphB,OAAQF,EAAIqM,EAAGrM,IAC1CwhB,EAAQF,EAAQthB,GAEZgT,EAAQpO,SAAW4c,EAAM5c,QAC5BR,EAAO/D,KAAK2S,GACZA,EAAUwO,GAEVxO,EAAU,CACTpO,OAAQoO,EAAQpO,OAChBmoE,QAAS0F,GAAkB,CAACz/D,EAAQ+5D,QAASvrD,EAAMurD,WAOtD,OAFA3oE,EAAO/D,KAAK2S,GAEL5O,CACR,CA+BkBuvE,CAAqBjnE,KAAK+mE,UAE1C,OADA/mE,KAAK+mE,SAAW,GACTjH,CACR,IAAA1rE,IAAA,QAAAmB,MAEA,WACCyK,KAAK+mE,SAAW,EACjB,IAAA3yE,IAAA,aAAAmB,MAEA,WACC,OAAOyK,KAAK+mE,SAASvzE,OAAS,CAC/B,IAAAY,IAAA,sBAAAmB,MASA,WAEA,KAAAguE,CAAA,CA1CK,GCxtBS,SAAS,GAAyBrrE,EAAQgvE,GACvD,GAAc,MAAVhvE,EAAgB,MAAO,CAAC,EAC5B,IACI9D,EAAKd,EADL2E,ECHS,SAAuCC,EAAQgvE,GAC5D,GAAc,MAAVhvE,EAAgB,MAAO,CAAC,EAC5B,IAEI9D,EAAKd,EAFL2E,EAAS,CAAC,EACVkvE,EAAalzE,OAAOmE,KAAKF,GAE7B,IAAK5E,EAAI,EAAGA,EAAI6zE,EAAW3zE,OAAQF,IACjCc,EAAM+yE,EAAW7zE,GACb4zE,EAAS1wE,QAAQpC,IAAQ,IAC7B6D,EAAO7D,GAAO8D,EAAO9D,IAEvB,OAAO6D,CACT,CDRe,CAA6BC,EAAQgvE,GAElD,GAAIjzE,OAAO0S,sBAAuB,CAChC,IAAIygE,EAAmBnzE,OAAO0S,sBAAsBzO,GACpD,IAAK5E,EAAI,EAAGA,EAAI8zE,EAAiB5zE,OAAQF,IACvCc,EAAMgzE,EAAiB9zE,GACnB4zE,EAAS1wE,QAAQpC,IAAQ,GACxBH,OAAOC,UAAUkM,qBAAqB/L,KAAK6D,EAAQ9D,KACxD6D,EAAO7D,GAAO8D,EAAO9D,GAEzB,CACA,OAAO6D,CACT,0BEXO,SAASovE,GAAA5L,GAcD,IAbd9E,EAAA8E,EAAA9E,aAcA,MAAO,CAAED,eAbT+E,EAAA/E,eAayBC,aAAAA,EAAcC,UAZvC6E,EAAA7E,UAYkD0Q,WAXlD7L,EAAA6L,WAW8DC,kBAV9D9L,EAAA8L,kBAWD,CA0BO,IAAKC,GAAL,SAAKC,GAAA,OACXA,EAAA,oBAAsB,uBACtBA,EAAA,YAAc,eACdA,EAAA,oBAAsB,yBACtBA,EAAA,oBAAsB,yBACtBA,EAAA,eAAiB,kBACjBA,EAAA,oBAAsB,uBANXA,CAAA,CAAL,CAAKD,IAAA,IAgDL,SAASE,GAAAlD,GAUO,IATtBzO,EAAAyO,EAAAzO,OACAE,EAAAuO,EAAAvO,WACA0R,EAAAnD,EAAAmD,YACAC,EAAApD,EAAAoD,UAOIlR,EAAiBiR,EACrB,IC5FM,SAAkB5R,GACxB,MAAyB,kBAAXA,GAAkC,OAAXA,GAAmB,OAAQA,GAAU,aAAcA,CACzF,CD0FM8R,CAAS9R,GAAS,MAAM,IAAIzwC,MAAM,0CAIvC,IAHA,IAAQqwC,EAA4BI,EAA5BJ,SAAU5qD,EAAkBgrD,EAAlBhrD,GACd+8D,EADqBC,GAAWhS,EAAAiS,IAG7BtR,EAAiBkR,GAAW,CAClC,IAAMK,EAAcvR,EAAiB,EAC/BwR,EAAWjS,EAAWW,UAAUqR,GACtC,IAAKC,EACJ,MAAO,CACN3mE,KAAM,QACN4mE,OAAQ,0BAGVL,EAAoBI,EAASE,GAAGN,GAChCpR,EAAiBuR,CAClB,CAEA,KAAOvR,EAAiBkR,GAAW,CAClC,IAAMK,EAAcvR,EAAiB,EAC/BwR,EAAWjS,EAAWW,UAAUF,GACtC,IAAKwR,EACJ,MAAO,CACN3mE,KAAM,QACN4mE,OAAQ,0BAGVL,EAAoBI,EAASG,KAAKP,GAClCpR,EAAiBuR,CAClB,CAEA,MAAO,CACN1mE,KAAM,UACNhM,MAAAy7D,EAAAA,EAAA,GAAY8W,GAAA,IAAmB/8D,GAAAA,EAAI4qD,SAAAA,IAErC,CElIO,IA+CM2S,GAAA,WAWJ,SAAAA,EACSC,EAGCxvE,GAChBqzD,EAAA,KAAAkc,GAJe,KAAAC,MAAAA,EAGC,KAAAxvE,QAAAA,CACf,CAPH,OAOG6zD,EAAA0b,EAAA,EAAAl0E,IAAA,sBAAAmF,IAEH,WAAkC,IAAAivE,EAAAC,EACjC,OAAwC,QAAxCD,EAAoB,QAApBC,EAAOzoE,KAAKjH,QAAQ2vE,0BAAA,IAAAD,OAAA,EAAbA,EAAiC/R,sBAAA,IAAA8R,EAAAA,EAAkB,CAC3D,IAAAp0E,IAAA,iBAAAmB,MAEA,SACC8K,EACA01D,EACA4P,EACAgD,GAEA,IACC,IAAMC,EAAanW,EAAezyD,KAAKuoE,MAAOxS,EAAOJ,UACrD,IAAKiT,EACJ,MAAM,IAAItjD,MAAA,sCAAA7e,OAA4CsvD,EAAOJ,WAE9D,OAAOiT,EAAWzS,SAASJ,EAC5B,CAAE,MAAOp+D,GACR,GAAIqI,KAAKjH,QAAQ8vE,oBAChB,OAAO7oE,KAAKjH,QAAQ8vE,oBAAoB,CACvCxoE,MAAAA,EACA01D,OAAAA,EACA4P,MAAAA,EACAgD,aAAAA,EACAhxE,MAAAA,IAGD,MAAMA,CAER,CACD,IAAAvD,IAAA,yBAAAmB,MAEA,SACCwgE,EACA+S,GAEqB,IAAAC,EADrBC,EAAAz1E,UAAAC,OAAA,QAAA6B,IAAA9B,UAAA,GAAAA,UAAA,GAA2B,KAErB01E,EAAUxW,EAAezyD,KAAKuoE,MAAOxS,EAAOJ,UAC5CuT,EAAgBJ,EAAgBK,eAAepT,EAAOJ,UAC5D,IAAKuT,IAAkBD,EACtB,MAAO,CAAE1nE,KAAM,QAAS4mE,OAAQX,GAAuB4B,aAExD,IAAMC,EAAaJ,EAAQhT,WAAWS,eAChC4S,EAAmBJ,EAAcjvE,QACvC,GAAIovE,IAAeC,EAAkB,CACpC,IAAMC,EAEF7B,GADW,OAAdsB,EACoB,CACjBjT,OAAAA,EACAE,WAAYgT,EAAQhT,WACpB0R,YAAa2B,EACb1B,UAAWyB,GAEM,CACjBtT,OAAAA,EACAE,WAAYgT,EAAQhT,WACpB0R,YAAa0B,EACbzB,UAAW0B,IAEf,GAAoB,UAAhBC,EAAOhoE,KACV,OAAOgoE,EAERxT,EAASwT,EAAOh0E,KACjB,CAEA,IAAK0zE,EAAQhT,WAAWqR,WACvB,MAAO,CAAE/lE,KAAM,UAAWhM,MAAOwgE,GAOlC,IAAMyT,EACc,QADdT,EACLE,EAAQhT,WAAWsR,yBAAA,IAAAwB,OAAA,EAAnBA,EACChT,EAAOkT,EAAQhT,WAAWqR,aAGtBmC,EACL,oBAAqBP,EAClBA,EAAcQ,gBAAgB3T,EAAOkT,EAAQhT,WAAWqR,aACxD,KAMJ,QAA6B,IAAzBkC,EACH,MAAO,CAAEjoE,KAAM,QAAS4mE,OAAQX,GAAuBmC,qBAMxD,GAA+B,MAA3BF,EACH,MAAO,CAAEloE,KAAM,QAAS4mE,OAAQX,GAAuBoC,qBAGxD,IAAMlyE,EAEFgwE,GADW,OAAdsB,EACoB,CACjBjT,OAAAA,EACAE,WAAYuT,EACZ7B,YAAa8B,EACb7B,UAAW4B,EAAqB9S,gBAEf,CACjBX,OAAAA,EACAE,WAAYuT,EACZ7B,YAAa6B,EAAqB9S,eAClCkR,UAAW6B,IAGf,MAAoB,UAAhB/xE,EAAO6J,KACH7J,EAGD,CAAE6J,KAAM,UAAWhM,MAAOmC,EAAOnC,MACzC,IAAAnB,IAAA,uBAAAmB,MAEA,SACCs0E,EACAf,GACoC,IAAAgB,EAC9B7T,EAAaj2D,KAAKjH,QAAQ2vE,mBAChC,IAAKzS,EACJ,MAAO,CAAE10D,KAAM,UAAWhM,MAAOs0E,GAGlC,IAAME,EAAkB9T,EAAWS,eAC7BsT,EAAwC,QAAxCF,EAAwBhB,EAAgBmB,oBAAA,IAAAH,EAAAA,EAAgB,EAE9D,GAAIC,EAAkBC,EACrB,MAAO,CAAEzoE,KAAM,QAAS4mE,OAAQX,GAAuB0C,qBAGxD,GAAIH,EAAkBC,EAAuB,CAC5C,IAAMtyE,EFpEF,SAAS4tE,GAaf,IAHsB,IATtB/vE,EAAA+vE,EAAA/vE,MACA0gE,EAAAqP,EAAArP,WACA0R,EAAArC,EAAAqC,YACAC,EAAAtC,EAAAsC,UAOIlR,EAAiBiR,EAEdjR,EAAiBkR,GAAW,CAClC,IAAMK,EAAcvR,EAAiB,EAC/BwR,EAAWjS,EAAWW,UAAUqR,GACtC,IAAKC,EACJ,MAAO,CACN3mE,KAAM,QACN4mE,OAAQ,0BAGV5yE,EAAQ2yE,EAASE,GAAG7yE,GACpBmhE,EAAiBuR,CAClB,CAEA,KAAOvR,EAAiBkR,GAAW,CAClC,IAAMK,EAAcvR,EAAiB,EAC/BwR,EAAWjS,EAAWW,UAAUF,GACtC,IAAKwR,EACJ,MAAO,CACN3mE,KAAM,QACN4mE,OAAQ,0BAGV5yE,EAAQ2yE,EAASG,KAAK9yE,GACtBmhE,EAAiBuR,CAClB,CAEA,MAAO,CACN1mE,KAAM,UACNhM,MAAAA,EAEF,CEyBkB40E,CAA0B,CACxC50E,MAAOs0E,EACP5T,WAAAA,EACA0R,YAAaqC,EACbpC,UAAWmC,IAGZ,GAAoB,UAAhBryE,EAAO6J,KACV,OAAO7J,EAERmyE,EAAgBnyE,EAAOnC,KACxB,CAGA,IADA,IAAM4qE,EAAe,GACrB9O,EAAA,EAAAiP,EAAgBrsE,OAAOihB,OAAO20D,GAAaxY,EAAAiP,EAAA9sE,OAAA69D,IAAG,CAA9C,IAAW/iB,EAAAgyB,EAAAjP,GACJ35D,EAASsI,KAAKoqE,uBAAuB97B,EAAGw6B,GAC9C,GAAoB,UAAhBpxE,EAAO6J,KACV,OAAO7J,EACGA,EAAOnC,OAASmC,EAAOnC,QAAU+4C,GAC3C6xB,EAAQxsE,KAAK+D,EAAOnC,MAEtB,CACA,GAAI4qE,EAAQ3sE,OAAQ,CACnBq2E,EAAA7Y,EAAA,GAAqB6Y,GAAc,IACnB1a,EADmBC,EAAAC,EACnB8Q,GAAA,IAAhB,IAAA/Q,EAAAd,MAAAa,EAAAC,EAAAzvD,KAAAhD,MAAyB,KAAd2xC,EAAA6gB,EAAA55D,MACVs0E,EAAcv7B,EAAEvjC,IAAMujC,CACvB,QAAAmZ,GAAA2H,EAAAn9C,EAAAw1C,EAAA,SAAA2H,EAAA/2D,GAAA,CACD,CACA,MAAO,CAAEkJ,KAAM,UAAWhM,MAAOs0E,EAClC,IAAAz1E,IAAA,sBAAAmB,MAGA,SAAoB8K,GAA0B,IAAAgqE,EAAAC,EAChC,QAAbD,GAAAC,EAAAtqE,KAAKjH,SAAQutE,2BAAA,IAAA+D,GAAbA,EAAAh2E,KAAAi2E,EAAmCjqE,EACpC,IAAAjM,IAAA,YAAAmB,MAEA,WAA8B,IAAAg1E,EAAAC,EAC7B,MAAO,CACNC,cAAe,EACfR,aAA+C,QAA/CM,EAA2B,QAA3BC,EAAcxqE,KAAKjH,QAAQ2vE,0BAAA,IAAA8B,OAAA,EAAbA,EAAiC9T,sBAAA,IAAA6T,EAAAA,EAAkB,EACjEpB,eAAgBl1E,OAAO0qE,YACtB/L,EAAgB5yD,KAAKuoE,OAAO/1D,KAAI,SAACjR,GAAA,MAAS,CACzCA,EAAKo0D,SACLp0D,EAAK00D,WAAWqR,YAAc/lE,EAAK00D,WAAWsR,kBAC3C,CACAttE,QAASsH,EAAK00D,WAAWS,eACzB4Q,WAAY/lE,EAAK00D,WAAWqR,WAC5BoC,gBAAiBnoE,EAAK00D,WAAWsR,kBAC9BtzE,OAAO0qE,YACP1qE,OAAO2gB,QAAQrT,EAAK00D,WAAWsR,mBAAmB/0D,KAAI,SAAAipD,GAAA,IAAA+I,EAAArS,EAAAsJ,EAAA,GAAM,MAAM,CAAV+I,EAAA,GAAIA,EAAA,GAEzD9N,eACF,UAED,GAEH,CACAz8D,QAASsH,EAAK00D,WAAWS,gBAE5B,KAGJ,IAAAtiE,IAAA,2BAAAmB,MAEA,WAA6C,IAAAm1E,EAAAC,EAC5C,MAAO,CACNF,cAAe,EACfR,aAA+C,QAA/CS,EAA2B,QAA3BC,EAAc3qE,KAAKjH,QAAQ2vE,0BAAA,IAAAiC,OAAA,EAAbA,EAAiChU,oBAAA,IAAA+T,EAAAA,EAAgB,EAC/DvB,eAAgBl1E,OAAO0qE,YACtB/L,EAAgB5yD,KAAKuoE,OAAO/1D,KAAI,SAACjR,GAAA,MAAS,CACzCA,EAAKo0D,SACLp0D,EAAK00D,WAAWqR,YAAc/lE,EAAK00D,WAAWsR,kBAC3C,CACAttE,QAASsH,EAAK00D,WAAWU,aACzB2Q,WAAY/lE,EAAK00D,WAAWqR,WAC5BoC,gBAAiBnoE,EAAK00D,WAAWsR,kBAC9BtzE,OAAO0qE,YACP1qE,OAAO2gB,QAAQrT,EAAK00D,WAAWsR,mBAAmB/0D,KAAI,SAAA8yD,GAAA,IAAAC,EAAApT,EAAAmT,EAAA,GAAM,MAAM,CAAVC,EAAA,GAAIA,EAAA,GAEzD5O,aACF,UAED,GAEH,CACA18D,QAASsH,EAAK00D,WAAWU,cAE5B,KAGJ,MAAAviE,IAAA,SAAAmB,MAnPA,SAICgzE,EACAxvE,GAEA,OAAO,IAAIuvE,EAAkBC,EAAc,OAAAxvE,QAAA,IAAAA,EAAAA,EAAW,CAAC,EACxD,KAAAuvE,CAAA,CATY,GCtDAsC,GAAiB,SAAC1qE,EAAqB6hB,GACnD,GAAI7hB,EAAEuqE,cAAgB1oD,EAAE0oD,cACvB,OAAO,EAER,GAAIvqE,EAAEuqE,cAAgB1oD,EAAE0oD,cACvB,OAAQ,EAET,GAAIvqE,EAAE+pE,aAAeloD,EAAEkoD,aACtB,OAAO,EAER,GAAI/pE,EAAE+pE,aAAeloD,EAAEkoD,aACtB,OAAQ,EAET,IAAK,IAAL5Y,EAAA,EAAAwZ,EAAkB52E,OAAOmE,KAAK8H,EAAEipE,gBAAc9X,EAAAwZ,EAAAr3E,OAAA69D,IAAG,CAAjD,IAAWj9D,EAAAy2E,EAAAxZ,GACJyZ,EAAiB5qE,EAAEipE,eAAe/0E,GAClC22E,EAAiBhpD,EAAEonD,eAAe/0E,GACxC,GAAI02E,EAAe7wE,QAAU8wE,EAAe9wE,QAC3C,OAAO,EAER,GAAI6wE,EAAe7wE,QAAU8wE,EAAe9wE,QAC3C,OAAQ,EAET,GAAI,oBAAqB6wE,KAAoB,oBAAqBC,GAGjE,OAAO,EAGR,KAAM,oBAAqBD,IAAmB,oBAAqBC,EAGlE,OAAQ,EAGT,GAAM,oBAAqBD,GAAqB,oBAAqBC,EAKrE,IAAK,IAALnM,EAAA,EAAAoM,EAAsB/2E,OAAOmE,KAAK0yE,EAAepB,iBAAe9K,EAAAoM,EAAAx3E,OAAAorE,IAAG,CAAnE,IAAWqM,EAAAD,EAAApM,GACJsM,EAAkBJ,EAAepB,gBAAgBuB,GACjDE,EAAkBJ,EAAerB,gBAAgBuB,GACvD,GAAIC,EAAkBC,EACrB,OAAO,EAER,GAAID,EAAkBC,EACrB,OAAQ,CAEV,CACD,CACA,OAAO,CACR,ECpDe,SAASC,GAAWC,EAAQl8D,EAAMm8D,GAa/C,OAXEF,GADE,IACWxtE,QAAQ+D,UAAU9E,OAElB,SAAoBwuE,EAAQl8D,EAAMm8D,GAC7C,IAAIprE,EAAI,CAAC,MACTA,EAAEvM,KAAKI,MAAMmM,EAAGiP,GAChB,IACIy1B,EAAW,IADGjnC,SAASd,KAAK9I,MAAMs3E,EAAQnrE,IAG9C,OADIorE,GAAO,EAAe1mC,EAAU0mC,EAAMp3E,WACnC0wC,CACT,EAEKwmC,GAAWr3E,MAAM,KAAMR,UAChC,CCZe,SAASg4E,GAAiBD,GACvC,IAAIE,EAAwB,oBAARz3D,IAAqB,IAAIA,SAAQ1e,EAuBrD,OAtBAk2E,GAAmB,SAA0BD,GAC3C,GAAc,OAAVA,ICPkCxtE,EDOEwtE,GCNsB,IAAzD3tE,SAAS3J,SAASK,KAAKyJ,GAAItH,QAAQ,kBDMQ,OAAO80E,ECP5C,IAA2BxtE,EDQtC,GAAqB,oBAAVwtE,EACT,MAAM,IAAIx2E,UAAU,sDAEtB,GAAsB,qBAAX02E,EAAwB,CACjC,GAAIA,EAAO/qE,IAAI6qE,GAAQ,OAAOE,EAAOjyE,IAAI+xE,GACzCE,EAAOhrE,IAAI8qE,EAAOG,EACpB,CACA,SAASA,IACP,OAAO,GAAUH,EAAO/3E,UAAW,EAAeyM,MAAMlJ,YAC1D,CASA,OARA20E,EAAQv3E,UAAYD,OAAOgB,OAAOq2E,EAAMp3E,UAAW,CACjD4C,YAAa,CACXvB,MAAOk2E,EACP9yE,YAAY,EACZC,UAAU,EACVtD,cAAc,KAGX,EAAem2E,EAASH,EACjC,EACOC,GAAiBD,EAC1B,CEFA,IAGaI,GAAA,SAAAC,GAAA1e,EAAAye,EAAAC,GAAA,IAAAC,EAAAle,EAAAge,GAGZ,SAAAA,EACiBG,GAEf,IAAA/V,EADegW,EAAAv4E,UAAAC,OAAA,QAAA6B,IAAA9B,UAAA,GAAAA,UAAA,GAAuC,GAAC64D,EAAA,KAAAsf,GAExD,IAAMK,EAhCR,SAAoBD,GACnB,IAAKA,EAAKt4E,OACT,OAAO,KAER,IACmB27D,EADf4c,EAAgB,GAAA3c,EAAAC,EACDyc,GAAA,IAAnB,IAAA1c,EAAAd,MAAAa,EAAAC,EAAAzvD,KAAAhD,MAAyB,KAAd6yD,EAAAL,EAAA55D,MACU,kBAATi6D,EACVuc,GAAA,IAAAtlE,OAAqB+oD,GACXA,EAAKwc,WAAW,KACtBD,EAAcE,SAAS,KAC1BF,EAAA,GAAAtlE,OAAmBslE,EAAc70E,MAAM,GAAI,GAAC,MAAAuP,OAAM+oD,EAAKt4D,MAAM,IAE7D60E,GAAiBvc,EAGlBuc,GAAA,IAAAtlE,OAAqB+oD,EAEvB,QAAA/H,GAAA2H,EAAAn9C,EAAAw1C,EAAA,SAAA2H,EAAA/2D,GAAA,CACA,OAAI0zE,EAAcC,WAAW,KACrBD,EAAc70E,MAAM,GAErB60E,CACR,CAUwBG,CAAWJ,GAC3BK,EAAkBN,EACtBvxE,MAAM,MACNkY,KAAI,SAAC45D,EAAM94E,GAAA,OAAa,IAANA,EAAU84E,EAAA,KAAA3lE,OAAY2lE,EAAO,IAC/C93E,KAAK,MANS,OAOwD8+D,EAAA5F,EAAxEsI,EAAA8V,EAAAv3E,KAAA,KAAMy3E,EAAA,MAAArlE,OAAaslE,EAAA,MAAAtlE,OAAkB0lE,GAAoBA,IAAe,OAXzD,mBAGCrW,EAAA+V,WAAAA,EACA/V,EAAAgW,KAAAA,EAAAhW,CAQjB,QAAAlJ,EAAA8e,EAAA,CAbY,CAaZH,GAboCjmD,QAgBrC,SAAS+mD,GAAeP,EAAuBhuE,GAC9C,IACC,OAAOA,GACR,CAAE,MAAO2pD,GACR,GAAIA,aAAeikB,GAClB,MAAM,IAAIA,GAAgBjkB,EAAIokB,WAAA,CAAaC,GAAArlE,OAAAgqD,EAAShJ,EAAIqkB,QAEzD,MAAM,IAAIJ,GAAiBjkB,EAAczzD,WAAY,CAAC83E,GACvD,CACD,CAEA,SAASQ,GAAa/2E,GACrB,GAAc,OAAVA,EAAgB,MAAO,OAC3B,GAAI3B,MAAMC,QAAQ0B,GAAQ,MAAO,WACjC,IAAMgM,SAAchM,EACpB,OAAQgM,GACP,IAAK,SACL,IAAK,UACL,IAAK,WACL,IAAK,SACL,IAAK,SACL,IAAK,SACJ,MAAO,KAAPkF,OAAYlF,GACb,IAAK,SACJ,MAAO,MAAPkF,OAAalF,GACd,IAAK,YACJ,MAAO,YACR,S5CrDK,SAA+BhM,EAAcqrE,GACnD,IAAM2L,EACL3L,GAAYrrE,GAA0B,kBAAVA,GAAsBqrE,KAAYrrE,EAAQA,EAAMqrE,GAAYrrE,EACzF,MAAM,IAAI+vB,MAAA,uBAAA7e,OAA6B8lE,GACxC,C4CkDGC,CAAsBjrE,GAEzB,KAMakrE,GAAA,WACZ,SAAAA,EAAqBC,GAA8BtgB,EAAA,KAAAqgB,GAA9B,KAAAC,aAAAA,CAA+B,CA0EpD,OA1EoD9f,EAAA6f,EAAA,EAAAr4E,IAAA,WAAAmB,MAOpD,SAASA,GAKR,OAJkByK,KAAK0sE,aAAan3E,EAKrC,IAAAnB,IAAA,WAAAmB,MAMA,WAAgC,IAAAyrE,EAAA,KAC/B,OAAO,IAAIyL,GAAU,SAACl3E,GACrB,OAAc,OAAVA,EAAuB,KACpByrE,EAAK7K,SAAS5gE,EACtB,GACD,IAAAnB,IAAA,WAAAmB,MAMA,WAAqC,IAAA8sE,EAAA,KACpC,OAAO,IAAIoK,GAAU,SAACl3E,GACrB,QAAc,IAAVA,EACJ,OAAO8sE,EAAKlM,SAAS5gE,EACtB,GACD,IAAAnB,IAAA,SAAAmB,MAOA,SAAUo3E,GAAkD,IAAAnK,EAAA,KAC3D,OAAO,IAAIiK,GAAU,SAACl3E,GACrB,OAAOo3E,EAAkBnK,EAAKrM,SAAS5gE,GACxC,GACD,IAAAnB,IAAA,QAAAmB,MAgBA,SAAMq3E,EAA8CC,GACnD,MAA6B,kBAAlBD,EACH5sE,KAAK8sE,QAAO,SAACv3E,GAEnB,OADA82E,GAAA,UAAA5lE,OAAsBmmE,EAAA,MAAkB,kBAAMC,EAASt3E,EAAM,IACtDA,CACR,IAEOyK,KAAK8sE,QAAO,SAACv3E,GAEnB,OADAq3E,EAAcr3E,GACPA,CACR,GAEF,KAAAk3E,CAAA,CA3EY,GA+EAM,GAAA,SAAAC,GAAA/f,EAAA8f,EAAAC,GAAA,IAAAC,EAAAvf,EAAAqf,GACZ,SAAAA,EAAqBG,GAA6B,IAAAzK,EAA7B,OAA6BrW,EAAA,KAAA2gB,GACjDtK,EAAAwK,EAAA54E,KAAA,MAAM,SAACkB,GAEN,IADA,IAAMy4D,EAAM37C,GAAM8jD,SAAS5gE,GAAKmqE,EAAA,SAAApsE,GAE/B+4E,GAAY/4E,GAAG,kBAAM45E,EAAc/W,SAASnI,EAAI16D,GAAG,GACpD,EAFSA,EAAI,EAAGA,EAAI06D,EAAIx6D,OAAQF,IAAAosE,EAAApsE,GAGhC,OAAO06D,CACR,IAPoByU,EAAAyK,cAAAA,EAAAzK,CAQrB,CAgBA,OAhBA7V,EAAAmgB,EAAA,EAAA34E,IAAA,WAAAmB,MAEA,WACC,OAAOyK,KAAKJ,OAAM,SAACrK,GAClB,GAAqB,IAAjBA,EAAM/B,OACT,MAAM,IAAIk4E,GAAgB,6BAE5B,GACD,IAAAt3E,IAAA,qBAAAmB,MAEA,WACC,OAAOyK,KAAKJ,OAAM,SAACrK,GAClB,GAAIA,EAAM/B,QAAU,EACnB,MAAM,IAAIk4E,GAAgB,+CAE5B,GACD,KAAAqB,CAAA,CAzBY,CAA4BN,IA6B5BU,GAAA,SAAAC,GAAAngB,EAAAkgB,EAAAC,GAAA,IAAAC,EAAA3f,EAAAyf,GACZ,SAAAA,EACiBvX,GAIf,IAAA0X,EADgBC,EAAAh6E,UAAAC,OAAA,QAAA6B,IAAA9B,UAAA,IAAAA,UAAA,UAA+B64D,EAAA,KAAA+gB,IAEhDG,EAAAD,EAAAh5E,KAAA,MAAM,SAACm5E,GACN,GAAsB,kBAAXA,GAAkC,OAAXA,EACjC,MAAM,IAAI9B,GAAA,wBAAAjlE,OAAwC6lE,GAAakB,KAGhE,IAFA,IAAAC,EAAA,WAEA,IAAAlX,EAAApE,EAAAmE,EAAAjF,GAAA,GAAYj9D,EAAAmiE,EAAA,GAAKL,EAASK,EAAA,GACzB8V,GAAYj4E,GAAK,WACd8hE,EAAiCC,SAAS1D,EAAe+a,EAAQp5E,GACpE,GACD,EAJAi9D,EAAA,EAAAiF,EAA+BriE,OAAO2gB,QAAQghD,GAAMvE,EAAAiF,EAAA9iE,OAAA69D,IAAAoc,IAMpD,IAAKF,EACJ,IAAK,IAAL3O,EAAA,EAAAiM,EAAkB52E,OAAOmE,KAAKo1E,GAAM5O,EAAAiM,EAAAr3E,OAAAorE,IAAG,CAAvC,IAAWxqE,EAAAy2E,EAAAjM,GACV,IAAKzrE,EAAeyiE,EAAQxhE,GAC3B,MAAM,IAAIs3E,GAAA,sBAAuC,CAACt3E,GAEpD,CAGD,OAAOo5E,CACR,KAzBgB5X,OAAAA,EAGC0X,EAAAC,6BAAAA,EAAAD,CAuBlB,CAyBA,OAzBA1gB,EAAAugB,EAAA,EAAA/4E,IAAA,yBAAAmB,MAEA,WACC,OAAO,IAAI43E,EAAgBntE,KAAK41D,QAAQ,EACzC,IAAAxhE,IAAA,SAAAmB,MAeA,SAAkDm4E,GAGjD,OAAO,IAAIP,EAAAnc,EAAAA,EAAA,GAAqBhxD,KAAK41D,QAAW8X,GAGjD,KAAAP,CAAA,CArDY,CAA8CV,IA+D9CkB,GAAA,SAAAC,GAAA3gB,EAAA0gB,EAAAC,GAAA,IAAAC,EAAAngB,EAAAigB,GAKZ,SAAAA,EACkBv5E,EACAwhE,EACAkY,GAChB,IAAAC,EADgB,OAChB3hB,EAAA,KAAAuhB,IACDI,EAAAF,EAAAx5E,KAAA,MAAM,SAAC0S,GACN,GAAqB,kBAAVA,GAAgC,OAAVA,EAChC,MAAM,IAAI2kE,GAAA,2BAAAjlE,OAA2C6lE,GAAavlE,IAAU,IAG7E,IAAMinE,EAAUvb,EAAe1rD,EAAO3S,GACtC,GAAuB,kBAAZ45E,EACV,MAAM,IAAItC,GAAA,8BAAAjlE,OACqBrS,EAAA,WAAAqS,OAAa6lE,GAAa0B,KAI1D,IAAMC,EAAiB96E,EAAeyiE,EAAQoY,GAAWpY,EAAOoY,QAAW,EAC3E,YAAuB,IAAnBC,EACIF,EAAKD,uBAAuB/mE,EAAOinE,GAGpC3B,GAAA,IAAA5lE,OAAgBrS,EAAA,OAAAqS,OAASunE,EAAA,MAAY,kBAAMC,EAAe9X,SAASpvD,EAAM,GACjF,KAtBiB3S,IAAAA,EACA25E,EAAAnY,OAAAA,EACAmY,EAAAD,uBAAAA,EAAAC,CAqBlB,CAMA,OANAnhB,EAAA+gB,EAAA,EAAAv5E,IAAA,0BAAAmB,MAEA,SACCu4E,GAEA,OAAO,IAAIH,EAAe3tE,KAAK5L,IAAK4L,KAAK41D,OAAQkY,EAClD,KAAAH,CAAA,CAnCY,CAIHlB,IAmCGyB,GAAA,SAAAC,GAAAlhB,EAAAihB,EAAAC,GAAA,IAAAC,EAAA1gB,EAAAwgB,GACZ,SAAAA,EACiBG,EACAC,GACf,IAAAC,EADe,OACfniB,EAAA,KAAA8hB,IACDK,EAAAH,EAAA/5E,KAAA,MAAM,SAACm5E,GACN,GAAsB,kBAAXA,GAAkC,OAAXA,EACjC,MAAM,IAAI9B,GAAA,wBAAAjlE,OAAwC6lE,GAAakB,KAGhE,IAFA,IAAAgB,EAAA,WAEA,IAAA1P,EAAA3M,EAAA0M,EAAA6B,GAAA,GAAYtsE,EAAA0qE,EAAA,GAAKvpE,EAAKupE,EAAA,GACrBuN,GAAYj4E,GAAK,WAChBi6E,EAAalY,SAAS/hE,GACtBk6E,EAAenY,SAAS5gE,EACzB,GACD,EALAmrE,EAAA,EAAA7B,EAA2B5qE,OAAO2gB,QAAQ44D,GAAM9M,EAAA7B,EAAArrE,OAAAktE,IAAA8N,IAOhD,OAAOhB,CACR,KAhBgBa,aAAAA,EACAE,EAAAD,eAAAA,EAAAC,CAgBjB,QAAA3hB,EAAAshB,EAAA,CAnBY,CAAiDzB,IAsB9D,SAASgC,GAAmBltE,GAC3B,OAAO,IAAIkrE,IAAU,SAACl3E,GACrB,UAAWA,IAAUgM,EACpB,MAAM,IAAImqE,GAAA,YAAAjlE,OAA4BlF,EAAA,UAAAkF,OAAa6lE,GAAa/2E,KAEjE,OAAOA,CACR,GACD,CAMuB,IAAIk3E,IAAU,SAACl3E,GAAA,OAAUA,CAAK,IAOlC,IAAIk3E,IAAU,SAACl3E,GAAA,OAAeA,CAAK,IAP/C,IAaMgN,GAASksE,GAAwB,UAMjCjkE,GAASikE,GAAwB,UAAU7uE,OAAM,SAAC8uE,GAC9D,GAAIhiB,OAAOhpC,MAAMgrD,GAChB,MAAM,IAAIhD,GAAgB,8BAE3B,IAAKhf,OAAOiiB,SAASD,GACpB,MAAM,IAAIhD,GAAA,iCAAAjlE,OAAiDioE,GAE7D,IAKaE,GAAiBpkE,GAAO5K,OAAM,SAACrK,GAC3C,GAAIA,EAAQ,EAAG,MAAM,IAAIm2E,GAAA,mCAAAjlE,OAAmDlR,GAC7E,IAKas5E,GAAgBrkE,GAAO5K,OAAM,SAACrK,GAC1C,GAAIA,GAAS,EAAG,MAAM,IAAIm2E,GAAA,4CAAAjlE,OAA4DlR,GACvF,IAKa+U,GAAUE,GAAO5K,OAAM,SAACrK,GACpC,IAAKm3D,OAAOoiB,UAAUv5E,GAAQ,MAAM,IAAIm2E,GAAA,4BAAAjlE,OAA4ClR,GACrF,IAoBaw5E,IAfkBzkE,GAAQ1K,OAAM,SAACrK,GAC7C,GAAIA,EAAQ,EAAG,MAAM,IAAIm2E,GAAA,oCAAAjlE,OAAoDlR,GAC9E,IAK8B+U,GAAQ1K,OAAM,SAACrK,GAC5C,GAAIA,GAAS,EAAG,MAAM,IAAIm2E,GAAA,6CAAAjlE,OAA6DlR,GACxF,IAMuBk5E,GAAyB,YAK1BA,GAAwB,UAWvC,SAASO,GAA6CC,GAC5D,OAAO,IAAIxC,IAAU,SAACyC,GACrB,GAAIA,IAAgBD,EACnB,MAAM,IAAIvD,GAAA,YAAAjlE,OAA4BwoE,EAAA,UAAAxoE,OAAsBg+C,KAAKC,UAAUwqB,KAE5E,OAAOD,CACR,GACD,CAMO,IAAM58D,GAAQ,IAAIo6D,IAAqB,SAACl3E,GAC9C,IAAK3B,MAAMC,QAAQ0B,GAClB,MAAM,IAAIm2E,GAAA,0BAAAjlE,OAA0C6lE,GAAa/2E,KAElE,OAAOA,CACR,IAMO,SAAS45E,GAAWjC,GAC1B,OAAO,IAAIH,GAAiBG,EAC7B,CAG6B,IAAIT,IAAmC,SAACl3E,GACpE,GAAqB,kBAAVA,GAAgC,OAAVA,EAChC,MAAM,IAAIm2E,GAAA,wBAAAjlE,OAAwC6lE,GAAa/2E,KAEhE,OAAOA,CACR,IAMO,SAASkD,GAA6Bm9D,GAG5C,OAAO,IAAIuX,GAAgBvX,EAC5B,CAMO,SAASwZ,GACff,EACAC,GAEA,OAAO,IAAIJ,GAAcG,EAAcC,EACxC,CAeO,SAASe,GACfj7E,EACAwhE,GAEA,OAAO,IAAI+X,GAAev5E,EAAKwhE,GAAQ,SAAC0Z,EAAcC,GACrD,MAAM,IAAI7D,GAAA,mBAAAjlE,OACUxS,OAAOmE,KAAKw9D,GAC7BpjD,KAAI,SAACg9D,GAAA,OAAQ/qB,KAAKC,UAAU8qB,EAAI,IAChCl7E,KAAK,QAAM,UAAAmS,OAAUg+C,KAAKC,UAAU6qB,IACtC,CAACn7E,GAEH,GACD,CAQO,SAASq7E,GACfx2E,EACAi9D,GAEA,OAAO,IAAIuW,IAAU,SAACl3E,GAMrB,OAAO82E,GAJN92E,GAA0B,kBAAVA,GAAsB,OAAQA,GAA6B,kBAAbA,EAAMwV,GAAO,GAAAtE,OACrExN,EAAA,UAAAwN,OAAalR,EAAMwV,GAAA,KACtB9R,GAEuB,kBAAMi9D,EAAUC,SAAS5gE,EAAM,GAC3D,GACD,CAGO,SAASm6E,GAAWx6D,GAC1B,OAAO,IAAIu3D,IAAU,SAACl3E,GACrB,IAAK2f,EAAOzU,IAAIlL,GAAa,CAC5B,IAAMo6E,EAAe/7E,MAAMw6D,KAAKl5C,GAAQ,SAAC06D,GAAA,OAAUnrB,KAAKC,UAAUkrB,EAAM,IAAEt7E,KAAK,QAC/E,MAAM,IAAIo3E,GAAA,YAAAjlE,OAA4BkpE,EAAA,UAAAlpE,OAAqBlR,GAC5D,CACA,OAAOA,CACR,GACD,CAGO,IAAMs6E,GAAQp3E,GAAO,CAC3BgL,EAAG+G,GACH+jC,EAAG/jC,GACH4Y,EAAG5Y,GAAOslE,aAIEC,GAAWt3E,GAAO,CAC9BgL,EAAG+G,GACH+jC,EAAG/jC,GACH0W,EAAG1W,GACHmb,EAAGnb,KCrhBSwlE,GAAiB,IAAI/7D,IAAI,CACrC,QACA,aACA,OACA,OACA,OACA,UACA,OACA,QACA,OACA,MACA,iBACA,eACA,WAeYg8D,GAAiB,IAAIh8D,IAAI,CACrC,QACA,OACA,eACA,SACA,OACA,aACA,SACA,SACA,QACA,cACA,YACA,QAcYi8D,GAAgB,IAAIj8D,IAAI,CAAC,OAAQ,QAAS,SAAU,WAapDk8D,GAAgB,IAAIl8D,IAAI,CAAC,OAAQ,OAAQ,QAAS,YAalDm8D,GAAgB,IAAIn8D,IAAI,CAAC,IAAK,IAAK,IAAK,OAcxCo8D,GAAmB,IAAIp8D,IAAI,CAAC,MAAO,OAAQ,MAAO,OAAQ,MAa1Dq8D,GAAgB,IAAIr8D,IAAI,CAAC,OAAQ,OAAQ,QAAS,SAalDs8D,GAAiB,IAAIt8D,IAAI,CAAC,QAAS,SAAU,MAAO,YAcpDu8D,GAAe,IAAIv8D,IAAI,CACnC,YACA,UACA,WACA,UACA,WACA,UACA,UACA,OACA,UACA,YACA,OACA,YACA,cACA,aACA,WACA,aACA,UAaYw8D,GAAqB,IAAIx8D,IAAI,CACzC,QACA,WACA,SACA,MACA,OACA,UACA,WACA,MACA,SAOYy8D,GAAkB,IAAIz8D,IAAI,CAAC,QAAS,SA0BpC08D,GAAgB,IAAI18D,IAAI,CACpC,WACA,UACA,eACA,gBACA,iBACA,eACA,gBACA,aACA,cACA,SACA,WACA,UACA,oBACA,kBACA,mBACA,aACA,oBACA,aACA,qBACA,cACA,kBACA,gBACA,iBACA,WACA,UACA,QACA,cACA,YACA,mBACA,UACA,WACA,OACA,YACA,OACA,YACA,OACA,WACA,MACA,YACA,WACA,aACA,SACA,OACA,eACA,eACA,QACA,eACA,eACA,gBACA,aACA,gBACA,gBACA,iBACA,cACA,SACA,SACA,YACA,QACA,gBACA,kBACA,YACA,aACA,aACA,QACA,UACA,cACA,SACA,UACA,UACA,UACA,OACA,mBACA,oBACA,mBACA,iBACA,oBACA,kBACA,iBACA,kBACA,MACA,cACA,OACA,YACA,WACA,SACA,OACA,gBACA,gBACA,SACA,cACA,iBACA,WACA,WACA,UACA,SACA,SACA,OACA,gBACA,UACA,MACA,WACA,eACA,UACA,QACA,aACA,YACA,YACA,OACA,OACA,SACA,OACA,eACA,cACA,SACA,SACA,QACA,OACA,aACA,aACA,YACA,mBACA,SACA,SACA,QACA,OACA,aACA,OACA,aACA,QACA,cACA,UACA,OACA,QACA,QACA,OACA,YACA,SACA,MACA,SACA,SACA,YACA,SACA,OACA,WACA,OACA,SACA,OACA,SACA,UACA,OACA,UACA,MACA,aACA,WACA,MACA,OACA,iBACA,iBACA,UACA,MACA,aACA,WACA,eACA,eACA,QACA,UACA,OACA,kBACA,gBACA,gBACA,OACA,QACA,eACA,aACA,UACA,UACA,YACA,eACA,QACA,WACA,UACA,aACA,kBACA,iBACA,eACA,YACA,iBACA,QACA,YACA,cACA,OACA,cACA,cACA,OACA,SACA,QACA,UACA,QACA,cACA,aACA,SACA,SACA,aACA,YACA,MACA,OACA,WACA,SACA,OACA,SACA,WACA,UACA,QACA,aACA,SACA,eACA,gBACA,UACA,UACA,YACA,eACA,QACA,QACA,UACA,aACA,QACA,UACA,SACA,OACA,cACA,MACA,UACA,SACA,QACA,SACA,MACA,SACA,WACA,cACA,cACA,YACA,cACA,eACA,OACA,UACA,QACA,SACA,gBACA,cACA,WACA,QACA,KACA,SACA,UACA,OACA,WACA,YACA,SACA,eACA,SACA,aACA,aACA,YACA,SACA,OACA,QACA,YACA,QACA,YACA,WACA,WACA,WACA,SACA,QACA,WACA,OACA,OACA,WACA,YACA,WACA,IACA,UACA,UACA,MACA,UACA,aCzdM,SAAS28D,GACfrjE,GAEA,OAAOmvC,GAAAA,QAAgB,SAAC3xC,GACvB,IAAKA,EAAGihE,WAAA,GAAAvlE,OAAc8G,EAAA,MACrB,MAAM,IAAI+X,MAAA,GAAA7e,OAAS8G,EAAA,yBAAA9G,OAA8B8G,EAAA,OAElD,OAAOxC,CACR,GACD,CAEO,UAAM8lE,GAAkBD,GAAsB,QAExCE,GAAmBF,GAAuB,SAE1CG,GAAkBH,GAAsB,QAExCI,GAAmBJ,GAAuB,SAE1CK,GAAsBL,GAA0B,YAGhDM,GAAoBx0B,GAAAA,QAAgB,SAAC3xC,GACjD,IAAKA,EAAGihE,WAAW,WAAajhE,EAAGihE,WAAW,UAC7C,MAAM,IAAI1mD,MAAM,iDAEjB,OAAOva,CACR,IAGaomE,GAAiBz0B,GA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CA,aACA,cACA,YACA,aACA,kBACA,gBACA,oBACA,gBACA,iBACA,mBACA,8BACA,qBACA,eACA,SACA,OACA,gBACA,iBACA,QACA,mBACA,iBACA,eACA,eACA,gBACA,aACA,cACA,cACA,iBACA,OACA,SACA,QACA,UACA,UACA,QACA,cACA,cACA,YACA,aACA,UACA,wBACA,sBACA,MACA,kBACA,gBACA,mBACA,YACA,OACA,gBACA,OACA,YACA,eACA,YACA,aACA,YACA,YACA,YACA,aACA,iBACA,iBACA,kBACA,eACA,cACA,cACA,cACA,cACA,WACA,eACA,gBACA,gBACA,cACA,WACA,gBACA,eACA,YACA,SACA,QACA,SACA,QACA,cACA,OACA,aACA,OACA,OACA,QACA,QACA,OACA,OACA,OACA,uBACA,gBACA,OACA,aACA,aACA,YACA,QACA,SACA,gBACA,eACA,sBACA,sBACA,oBACA,UACA,UACA,mBACA,aACA,cACA,aACA,eACA,cACA,mBACA,iBACA,qBACA,mBACA,oBACA,qBACA,kBACA,mBACA,aACA,aACA,cACA,aACA,YACA,mBACA,YACA,aACA,YACA,cACA,eACA,YACA,QACA,gBACA,cACA,UACA,OACA,UACA,eACA,SACA,UACA,mBACA,UACA,YC3RM,IAAMC,GAAAhmN,EAAAA,EAAA,GACTgwH,IAAA,IACHqzD,MAAOpgP,OAAO0qE,YACbo4M,GAAcvkQ,KAAI,SAACvZ,GAAA,MAAS,CAACA,EAAA,eAAAwN,OAAqBxN,EAAA,QAAW,KAE9D44P,aAAc59P,OAAO0qE,YACpBkX,GAAAA,KAAc,SAACK,GAAA,MAAS,CAACA,EAAKl6C,OAAA,iBAAAv1B,OAAyByvE,EAAKl6C,OAAA,SAAc,KAE3E8lO,WAAY7tQ,OAAO0qE,YAClBke,GAAkBrqE,KAAI,SAACq5C,GAAA,MAAQ,CAACA,EAAItqD,KAAA,gBAAAkF,OAAsBolD,EAAItqD,KAAA,QAAW,OC4J3E,SAAS01Q,GAA6C5kQ,GAErD,OAAOskC,EAAAA,EAAAA,UAAQ,kBAAMtkC,CAAA,GAAOA,EAC7B,CAEO,SAAS6kQ,GACf1kB,GAEA,IAAM2kB,EAAiBF,GACT,MAAbzkB,EAAoB,GAAK5+P,MAAMC,QAAQ2+P,GAAaA,EAAY,CAACA,IAElE,OAAO77M,EAAAA,EAAAA,UAAQ,WACd,IACuBupG,EADjBk3H,EAA4D,CAAC,EAAAj3H,EAAA9wF,EAC5C8nN,GAAA,IAAvB,IAAAh3H,EAAA7xF,MAAA4xF,EAAAC,EAAAxgJ,KAAAhD,MAAuC,KAA5B06Q,EAAAn3H,EAAA3qJ,MACV,GAAI8hR,EAASxlB,aAAc,KACuCtxG,EADvCC,EAAAnxF,EACCwD,EAAiBwkN,EAASxlB,eAAY,IAAjE,IAAArxG,EAAAlyF,MAAAiyF,EAAAC,EAAA7gJ,KAAAhD,MAAoE,KAAA26Q,EAAAnlN,EAAAouF,EAAAhrJ,MAAA,GAAxDnB,EAAAkjR,EAAA,GAAK/hR,EAAK+hR,EAAA,GACjBC,EAAUH,EAAmBhjR,GAC5BmjR,IACJA,EAAUH,EAAmBhjR,GAAO,CAAC,GAEtCH,OAAOmxB,OAAOmyP,EAAShiR,EACxB,QAAAkyD,IAAA+4F,EAAAvuI,EAAAw1C,GAAA,SAAA+4F,EAAAnoJ,GAAA,CACD,CACD,QAAAovD,IAAA04F,EAAAluI,EAAAw1C,GAAA,SAAA04F,EAAA9nJ,GAAA,CACA,OAAO++Q,CACR,GAAG,CAACD,GACL,CAEO,SAASK,GACfhlB,GAEA,IAAMilB,EA1LA,WACN,IAAAC,EAA+CrmB,KAAvCJ,EAAAymB,EAAAzmB,SAAUE,EAAAumB,EAAAvmB,YAAaC,EAAAsmB,EAAAtmB,YAC/B8D,EAAgEV,KAAxDR,EAAAkB,EAAAlB,UAAWM,EAAAY,EAAAZ,aAAcF,EAAAc,EAAAd,aAAcF,EAAAgB,EAAAhB,aAEzC4O,EADa9J,KACW,EACxB1jB,EAAMC,KACZ,OAAO5+L,EAAAA,EAAAA,UACN,iBAAO,CACNs6M,SAAAA,EACAE,YAAAA,EACAC,YAAAA,EACA4C,UAAAA,EACAM,aAAAA,EACAF,aAAAA,EACAF,aAAAA,EACA5e,IAAAA,EACAwtB,SAAAA,EACD,GACA,CACC9O,EACA/C,EACAqD,EACAlD,EACA9b,EACA8e,EACAjD,EACA+C,EACA4O,GAGH,CA4JwB6U,GACjBR,EAAiBF,GACT,MAAbzkB,EAAoB,GAAK5+P,MAAMC,QAAQ2+P,GAAaA,EAAY,CAACA,IAElE,OAAO77M,EAAAA,EAAAA,UACN,kBAzHK,SACN67M,EACAilB,GAEA,IACuBtoN,EADjBioN,EAA4D,CAAC,EAAAhoN,EAAAC,EAC5CmjM,GAAA,IAAvB,IAAApjM,EAAAd,MAAAa,EAAAC,EAAAzvD,KAAAhD,MAAkC,KAAvB06Q,EAAAloN,EAAA55D,MACV,GAAI8hR,EAASxlB,aAAc,KACuC7xG,EADvCC,EAAA5wF,EACCwD,EAAiBwkN,EAASxlB,eAAY,IAAjE,IAAA5xG,EAAA3xF,MAAA0xF,EAAAC,EAAAtgJ,KAAAhD,MAAoE,KAAAi7Q,EAAAzlN,EAAA6tF,EAAAzqJ,MAAA,GAAxDnB,EAAAwjR,EAAA,GAAKriR,EAAKqiR,EAAA,GACjBL,EAAUH,EAAmBhjR,GAC5BmjR,IACJA,EAAUH,EAAmBhjR,GAAO,CAAC,GAEtCH,OAAOmxB,OAAOmyP,EAAShiR,EACxB,QAAAkyD,IAAAw4F,EAAAhuI,EAAAw1C,GAAA,SAAAw4F,EAAA5nJ,GAAA,CACD,CACD,QAAAovD,IAAA2H,EAAAn9C,EAAAw1C,GAAA,SAAA2H,EAAA/2D,GAAA,CACA,MAAO,CACNw/Q,YAAa,SAACv9K,EAAKt2B,EAAQ8zM,GAAY,IACfvoN,EADeE,EAAAJ,EACfmjM,GAAA,IAAvB,IAAA/iM,EAAAnB,MAAAiB,EAAAE,EAAA9vD,KAAAhD,MAAkC,KAAvB06Q,EAAA9nN,EAAAh6D,MACN8hR,EAASQ,cACZ7zM,EAASqzM,EAASQ,YAAYv9K,EAAKt2B,EAAAhT,EAAAA,EAAA,GAAaymN,GAAmBK,IAErE,QAAArwN,IAAAgI,EAAAx9C,EAAAw1C,GAAA,SAAAgI,EAAAp3D,GAAA,CACA,OAAO2rE,CACR,EACA2gD,QAAS,SAACrqB,EAAKt2B,GAAW,IACF/E,EADEC,EAAA7P,EACFmjM,GAAA,IAAvB,IAAAtzL,EAAA5Q,MAAA2Q,EAAAC,EAAAv/D,KAAAhD,MAAkC,KAAvB06Q,EAAAp4M,EAAA1pE,MACN8hR,EAAS1yJ,UACZ3gD,EAASqzM,EAAS1yJ,QAAQrqB,EAAKt2B,EAAQyzM,GAEzC,QAAAhwN,IAAAyX,EAAAjtD,EAAAw1C,GAAA,SAAAyX,EAAA7mE,GAAA,CACA,OAAO2rE,CACR,EACA+zM,YAAa,SAACz9K,EAAKt2B,EAAQ8zM,GAAY,IACf34M,EADeC,EAAA/P,EACfmjM,GAAA,IAAvB,IAAApzL,EAAA9Q,MAAA6Q,EAAAC,EAAAz/D,KAAAhD,MAAkC,KAAvB06Q,EAAAl4M,EAAA5pE,MACN8hR,EAASU,cACZ/zM,EAASqzM,EAASU,YAAYz9K,EAAKt2B,EAAAhT,EAAAA,EAAA,GAAaymN,GAAmBK,IAErE,QAAArwN,IAAA2X,EAAAntD,EAAAw1C,GAAA,SAAA2X,EAAA/mE,GAAA,CACA,OAAO2rE,CACR,EACAg0M,SAAU,SAAC19K,EAAKt2B,EAAQ8zM,GAAY,IACZx4M,EADYC,EAAAlQ,EACZmjM,GAAA,IAAvB,IAAAjzL,EAAAjR,MAAAgR,EAAAC,EAAA5/D,KAAAhD,MAAkC,KAAvB06Q,EAAA/3M,EAAA/pE,MACN8hR,EAASW,WACZh0M,EAASqzM,EAASW,SAAS19K,EAAKt2B,EAAAhT,EAAAA,EAAA,GAAaymN,GAAmBK,IAElE,QAAArwN,IAAA8X,EAAAttD,EAAAw1C,GAAA,SAAA8X,EAAAlnE,GAAA,CACA,OAAO2rE,CACR,EACAi0M,KAAM,SAAC39K,EAAKt2B,EAAQ8zM,GAAY,IACRr5H,EADQE,EAAAtvF,EACRmjM,GAAA,IAAvB,IAAA7zG,EAAArwF,MAAAmwF,EAAAE,EAAAh/I,KAAAhD,MAAkC,KAAvB06Q,EAAA54H,EAAAlpJ,MACN8hR,EAASY,OACZj0M,EAASqzM,EAASY,KAAK39K,EAAKt2B,EAAAhT,EAAAA,EAAA,GAAaymN,GAAmBK,IAE9D,QAAArwN,IAAAk3F,EAAA1sI,EAAAw1C,GAAA,SAAAk3F,EAAAtmJ,GAAA,CACA,OAAO2rE,CACR,EACAk0M,QAAS,SAAC59K,EAAKt2B,EAAQ8zM,GAAY,IACX/4H,EADWC,EAAA3vF,EACXmjM,GAAA,IAAvB,IAAAxzG,EAAA1wF,MAAAywF,EAAAC,EAAAr/I,KAAAhD,MAAkC,KAAvB06Q,EAAAt4H,EAAAxpJ,MACN8hR,EAASa,UACZl0M,EAASqzM,EAASa,QAAQ59K,EAAKt2B,EAAAhT,EAAAA,EAAA,GAAaymN,GAAmBK,IAEjE,QAAArwN,IAAAu3F,EAAA/sI,EAAAw1C,GAAA,SAAAu3F,EAAA3mJ,GAAA,CACA,OAAO2rE,CACR,EACAm0M,sBAAuB,SAAC79K,EAAKt2B,EAAQ8zM,GAAY,IACzBt4H,EADyBC,EAAApwF,EACzBmjM,GAAA,IAAvB,IAAA/yG,EAAAnxF,MAAAkxF,EAAAC,EAAA9/I,KAAAhD,MAAkC,KAAvB06Q,EAAA73H,EAAAjqJ,MACN8hR,EAASc,wBACZn0M,EAASqzM,EAASc,sBAAsB79K,EAAKt2B,EAAAhT,EAAAA,EAAA,GAAaymN,GAAmBK,IAE/E,QAAArwN,IAAAg4F,EAAAxtI,EAAAw1C,GAAA,SAAAg4F,EAAApnJ,GAAA,CACA,OAAO2rE,CACR,EACA8tE,MAAO,SAACx3C,EAAKt2B,EAAQ8zM,GAAY,IACTh4H,EADSC,EAAA1wF,EACTmjM,GAAA,IAAvB,IAAAzyG,EAAAzxF,MAAAwxF,EAAAC,EAAApgJ,KAAAhD,MAAkC,KAAvB06Q,EAAAv3H,EAAAvqJ,MACN8hR,EAASvlI,QACZ9tE,EAASqzM,EAASvlI,MAAMx3C,EAAKt2B,EAAAhT,EAAAA,EAAA,GAAaymN,GAAmBK,IAE/D,QAAArwN,IAAAs4F,EAAA9tI,EAAAw1C,GAAA,SAAAs4F,EAAA1nJ,GAAA,CACA,OAAO2rE,CACR,EACA6tL,aAAculB,EAEhB,CAsCQgB,CAAejB,EAAgBM,EAAc,GACnD,CAACN,EAAgBM,GAEnB,CC5LO,SAASY,GAAA58M,GAIiB,IAHhC+2L,EAAA/2L,EAAA+2L,UACA7iE,EAAAl0H,EAAAk0H,UACApnK,EAAAkzC,EAAAlzC,SAEA,OACCs/B,EAAAA,GAAAA,KAACuqM,GAAA,CAAkBziE,UAAW,OAAAA,QAAA,IAAAA,EAAAA,EAAaqnF,GAC1CzuP,UAAAs/B,EAAAA,GAAAA,KAAC0qM,GAAA,CAAoBC,UAAW0kB,GAA8B1kB,GAC7DjqO,UAAAs/B,EAAAA,GAAAA,KAACipM,GAAA,CACAvoO,UAAAs/B,EAAAA,GAAAA,KAACgsM,GAAA,CACAtrO,UAAAs/B,EAAAA,GAAAA,KAACgxM,GAAA,CACAtwO,UAAAs/B,EAAAA,GAAAA,KAACywN,GAAA,CAAkB9lB,UAAAA,EAAuBjqO,SAAAA,aAOjD,CACA,SAAS+vP,GAAA9zM,GAG8C,IAFtDguL,EAAAhuL,EAAAguL,UACAjqO,EAAAi8C,EAAAj8C,SAEMgwP,EAAkBf,GAAmBhlB,GAC3C,OACC3qM,EAAAA,GAAAA,KAACotM,GAAA,CAAgBzC,UAAW+lB,EAAgB5zJ,QAC3Cp8F,UAAAs/B,EAAAA,GAAAA,KAACm6M,GAAA,CAAcxP,UAAW+lB,EAAgBzmI,MACzCvpH,UAAAs/B,EAAAA,GAAAA,KAAC07M,GAAA,CAAsB/Q,UAAW+lB,EAAgBL,QACjD3vP,UAAAs/B,EAAAA,GAAAA,KAACuxM,GAAA,CAA0B5G,UAAW+lB,EAAgBV,YACrDtvP,UAAAs/B,EAAAA,GAAAA,KAACy6M,GAAA,CAAgC9P,UAAW+lB,EAAgBJ,sBAC3D5vP,UAAAs/B,EAAAA,GAAAA,KAACuyM,GAAA,CAA0B5H,UAAW+lB,EAAgBR,YACrDxvP,UAAAs/B,EAAAA,GAAAA,KAACk0M,GAAA,CAAuBvJ,UAAW+lB,EAAgBP,SAClDzvP,UAAAs/B,EAAAA,GAAAA,KAACg7M,GAAA,CAAmBrQ,UAAW+lB,EAAgBN,KAC7C1vP,SAAAA,iBAUX,wEC5CaiwP,GAAWr7K,EAAAA,MAAW,SAAS1hC,GASV,IARjCg9M,EAAAh9M,EAAAg9M,UACA/T,EAAAjpM,EAAAipM,qBACAn8O,EAAAkzC,EAAAlzC,SACGk3C,EAAAsI,GAAAtM,EAAAuM,IAMH,OACCngB,EAAAA,GAAAA,KAACwwN,GAAArnN,EAAAA,EAAA,GAA4ByO,GAAA,IAC5Bl3C,UAAAs/B,EAAAA,GAAAA,KAAC6wN,GAAA,CAAcD,UAAAA,EAAsB/T,qBAAAA,EACnCn8O,SAAAA,MAIL,IAOMmwP,GAAgBv7K,EAAAA,MAAW,SAAS34B,GAGS,IAFlDj8C,EAAAi8C,EAAAj8C,SACGziB,EAAAiiE,GAAAvD,EAAAgQ,IAEGm8D,EChDA,WACN,IAAuD1lC,EAAA94C,GAAvBrb,EAAAA,EAAAA,WAAkB,GAAK,GAAhD65F,EAAA1lC,EAAA,GAAU2lC,EAAW3lC,EAAA,GACtB0kF,EAAYykD,KA6BlB,OA3BA79L,EAAAA,EAAAA,YAAU,WACT,IAAIu1F,GAAY,EACD,SAAA6sI,IAgBf,OAhBeA,EAAAh4K,GAAA3Q,KAAAxL,MAAf,SAAAyL,IAAA,OAAAD,KAAA5O,MAAA,SAAAl7D,GAAA,cAAAA,EAAA87C,KAAA97C,EAAA2mB,MAAA,cAAA3mB,EAAA2mB,KAAA,EAMO74B,QAAQo7J,WACb2nG,GAAcvkQ,KAAI,SAACghE,GAClB,IAAM4F,EAAQ,IAAI+nB,MAElB,OADA/nB,EAAM/zE,IAAMsqL,EAAU0kD,MAAM7gK,GACrB4F,EAAMuqB,QACd,KACD,WAEImoC,EAAA,CAAA5lH,EAAA2mB,KAAA,eAAA3mB,EAAAk9D,OAAA,iBACJwtD,GAAY,GAAI,wBAAA1qH,EAAA83C,OAAA,GAAAiyB,EAAA,MACjBl8F,MAAA,KAAAR,UAAA,CAIA,OArBgB,WACDolR,EAAA5kR,MAAA,KAAAR,UAAA,CAkBfqlR,GAEO,WACN9sI,GAAY,CACb,CACD,GAAG,CAAC6E,EAAUg/C,IAEPh/C,CACR,CDgBkBkoI,GAEjB,OAAKloI,GAKJ7oF,EAAAA,GAAAA,MAAAF,GAAAA,SAAA,CACEr/B,SAAA,CAAAA,GACDs/B,EAAAA,GAAAA,KAACixN,GAAA9nN,EAAA,GAAoBlrD,QANf+hD,EAAAA,GAAAA,KAACqoI,GAAA,CAAc3nK,SAAA,qBASxB,IAGauwP,GAAkB37K,EAAAA,MAAW,SAAS73B,GAG1B,IAFxBmzM,EAAAnzM,EAAAmzM,UACA/T,EAAAp/L,EAAAo/L,qBAEMpqK,EAAMmE,KACN62I,EAAMC,KACNujB,EAAaE,KACb/zE,EAAiB/mF,GAAS,kBAAkB,kBAAM5D,EAAI9jB,UAAA,GAAY,IAClExC,EAAckqB,GAAS,eAAe,kBAAM5D,EAAIjiB,cAAcrE,WAAA,GAAa,IAC3EC,EAAciqB,GAAS,eAAe,kBAAM5D,EAAIjiB,cAAcpE,WAAA,GAAa,K1C5D3E,WACN,IAAMqmB,EAAMmE,KAEN48J,EAAaC,KACb32I,EAAU+zI,KACV5mH,EAAQqwH,MAEd5rN,EAAAA,EAAAA,YAAU,WAKT,IAFA,IAAMwiO,EAAuB,WAAvB,OAA6Bz+K,EAAImsD,YAAgC,OAAlBnsD,EAAI9kB,WAAsB8kB,EAAIw9D,aAAA,EAAAp4F,EAAA,WAEnF,IAAW7rB,EAAAysB,EAAAjP,GACV,OAAKxd,EAAOohM,IACRomB,IAAexnN,EAAO66L,YACtB0zB,GAAUjuQ,SAAS0/C,EAAO9oC,IADJ,gBAG1B60P,GAAQyC,GAAwBxuN,EAAOohM,MAAM,SAACnnO,GACzCirQ,MACJzhP,GAAexpB,GACf+lC,EAAO4wL,WACR,IARY,UASb,EAVApzK,EAAA,EAAAiP,EAAqBrsE,OAAOihB,OAAOyvG,GAAOtzD,EAAAiP,EAAA9sE,OAAA69D,IAAAqO,IAY1C,IAFA,IAAA+N,EAAA,WAEA,IAAWurM,EAAAz4M,EAAA3B,GACV,OAAKo6M,EAAK/jC,IAENmtB,GAAUjuQ,SAAS6kR,EAAKjuQ,IAAE,gBAE9B60P,GAAQyC,GAAwB2W,EAAK/jC,MAAM,SAACnnO,GACvCirQ,MACJzhP,GAAexpB,GACfkrQ,EAAKv0C,WACN,IARU,UASX,EAVA7lK,EAAA,EAAA2B,EAAmBtsE,OAAOihB,OAAO48H,GAAKlzE,EAAA2B,EAAA/sE,OAAAorE,IAAA6O,IAmCtC,OApBAmyL,GAAQ,KAAK,WACRmZ,KACJz+K,EAAI2qD,gBAAgB,MACrB,IAEA26G,GAAQ,iBAAiB,WACpBmZ,KACJp0J,EAAgB,OAAE8/G,UACnB,IAEAm7B,GAAQ,KAAK,WACRmZ,KACJp0J,EAAQ,WAAW8/G,UACpB,IAEAm7B,GAAQ,KAAK,WACRmZ,KACJp0J,EAAQ,YAAY8/G,UACrB,IAEO,WACNm7B,GAAQoB,QACT,CACD,GAAG,CAACr8I,EAASmtB,EAAOupH,EAAY/gK,GACjC,C0CDC2+K,GzEs6BM,WACN,IAAM3+K,EAAMmE,MAEZloD,EAAAA,EAAAA,YAAU,WACT,IAAM85M,EAAO,WACmB,IAA3B/1J,EAAIllB,YAAY5hF,QAAkC,OAAlB8mG,EAAI9kB,WAAsB6xK,GAAwB/sJ,IAEtF8tJ,GAAe9tJ,EAChB,EAEA,SAASg2J,IACuB,IAA3Bh2J,EAAIllB,YAAY5hF,QAAkC,OAAlB8mG,EAAI9kB,WAAsB6xK,GAAwB/sJ,KAEtF8tJ,GAAe9tJ,GACfA,EAAIiwC,eACL,CAEA,IAAMgmH,EAAQ,SAACziP,GACQ,OAAlBwsF,EAAI9kB,WAAsB6xK,GAAwB/sJ,KAClDxsF,EAAMusB,gBAAkBigE,EAAI4U,OAAOl2E,SACtCk2N,GAA8B50J,EAAKxsF,EAAMusB,eAEzCvgC,UAAUqpK,UAAUC,OAAOn8H,MAAK,SAAC0oN,GAC5B/7P,MAAMC,QAAQ87P,IAAmBA,EAAe,aAAchH,eACjE+G,GAA2Bp1J,EAAKq1J,EAAgBr1J,EAAI4U,OAAOwX,iBAE7D,IAEF,EAMA,OAJAjtH,SAASw1B,iBAAiB,OAAQohO,GAClC52P,SAASw1B,iBAAiB,MAAOqhO,GACjC72P,SAASw1B,iBAAiB,QAASshO,GAE5B,WACN92P,SAASy1B,oBAAoB,OAAQmhO,GACrC52P,SAASy1B,oBAAoB,MAAOohO,GACpC72P,SAASy1B,oBAAoB,QAASqhO,EACvC,CACD,GAAG,CAACj2J,GACL,CyE78BC4+K,GE3EM,WACN,IAAM5+K,EAAMmE,KACJwyJ,EAAaI,KAAbJ,UAER16M,EAAAA,EAAAA,YAAU,WACT,SAAS4iO,EAAA19M,GAAkF,IAAhExiE,EAAAwiE,EAAAxiE,KAAMovD,EAAAoT,EAAApT,MAChC4oM,EAAS,CACR/3K,MAAO,yBACPC,YAAA,0DAAA1yE,OAAuExN,EAAA,MAAAwN,OAAS4hD,EAAA,0EAElF,CAEA,SAAS+wN,EAAA50M,GAAuE,IAApDvrE,EAAAurE,EAAAvrE,KAAM27K,EAAApwG,EAAAowG,OACjCq8E,EAAS,CACR/3K,MAAO,eACPC,YAAA,YAAA1yE,OAAyBxN,EAAA,KACzB0rH,QAAS,CACR,CACC7uC,MAAO,UACPv0E,KAAM,UACN86C,QAAS,WACRi+C,EAAI9V,KAAK,eACT8V,EAAIikE,iBAAiBqW,EACtB,KAIJ,CAIA,OAFAt6E,EAAI1sF,YAAY,aAAcurQ,GAC9B7+K,EAAI1sF,YAAY,gBAAiBwrQ,GAC1B,WACN9+K,EAAIjrF,eAAe,aAAc8pQ,GACjC7+K,EAAIjrF,eAAe,gBAAiB+pQ,EACrC,CACD,GAAG,CAAC9+K,EAAK22J,GACV,CFwCCooB,GAEA,IAA6BC,EAAgB5gB,KAArC,qBAER,OACC7wM,EAAAA,GAAAA,KAAC0xN,GAAA,CACAhxP,UAAAs/B,EAAAA,GAAAA,KAAC,QACA,UAAQ,aACRoyC,UAAW7mG,GAAW,cAAe,CAAE,sBAAuB0lQ,EAAa,IAE1EvwO,SAAAyrD,GACAnsB,EAAAA,GAAAA,KAAC,OAAIoyC,UAAU,mBACd1xE,UAAAs/B,EAAAA,GAAAA,KAACgtL,GAAA,CACA56I,UAAU,oBACV/gB,MAAA,GAAAzyE,OAAU6uO,EAAI,iCACd9hK,KAAK,MACLn3B,QAASi9N,EAAY70C,cAIvB38K,EAAAA,GAAAA,MAAAF,GAAAA,SAAA,CACCr/B,SAAA,EAAAu/B,EAAAA,GAAAA,MAAC,OAAImyC,UAAU,mBACd1xE,SAAA,EAAAs/B,EAAAA,GAAAA,KAACgtN,GAAA,KACDhtN,EAAAA,GAAAA,KAAC,OAAIoyC,UAAU,iBACfpyC,EAAAA,GAAAA,KAAC,OAAIoyC,UAAU,kBAAkBglC,WAAW,EAC1C12G,SAAAkwP,QAGH3wN,EAAAA,GAAAA,MAAC,OACAmyC,UAAU,sBACV,UAAQ,cACR,mBAAiB,iBAEjB1xE,SAAA,EAAAu/B,EAAAA,GAAAA,MAAC,OAAImyC,UAAU,sBACd1xE,SAAA,EAAAs/B,EAAAA,GAAAA,KAAC4lN,GAAA,KACD5lN,EAAAA,GAAAA,KAAColN,GAAA,OAEDnU,GAAc,IAAM7zE,IACpBp9H,EAAAA,GAAAA,KAAC,OAAIoyC,UAAU,4BACd1xE,UAAAs/B,EAAAA,GAAAA,KAACqkN,GAAA,UAIJpkN,EAAAA,GAAAA,MAAC,OAAImyC,UAAU,sBACd1xE,SAAA,EAAAu/B,EAAAA,GAAAA,MAAC,OAAImyC,UAAU,4BACd1xE,SAAA,EAAAs/B,EAAAA,GAAAA,KAAC2iN,GAAA,KACD3iN,EAAAA,GAAAA,KAACguN,GAAA,IACA/c,GAAc,IAAKjxM,EAAAA,GAAAA,KAACy+M,GAAA,OAErBryL,IAAepsB,EAAAA,GAAAA,KAAC48M,GAAA,CAAWC,qBAAsB,OAAAA,QAAA,IAAAA,EAAAA,EAAwB,WAE3E78M,EAAAA,GAAAA,KAACwtN,GAAA,KACDxtN,EAAAA,GAAAA,KAAC2lN,GAAA,KACD3lN,EAAAA,GAAAA,KAACytN,GAAA,UAMP,kDGlIO,SAASkE,GACf1zQ,GAGA,IAAQyiB,EAAmFziB,EAAnFyiB,SAAAkxP,EAAmF3zQ,EAAzE4zQ,eAAAA,OAAA,IAAAD,EAAiB9kF,GAAA8kF,EAAAE,EAAwD7zQ,EAAjCmvE,WAAAA,OAAA,IAAA0kM,EAAa7kF,GAAA6kF,EAAWl6M,EAAAsI,GAASjiE,EAAAkiE,IAErF4xM,ErJ4BCrlF,GAAeh/L,MqJ1BhBokM,EAAcF,GAAmB,CACtCxkH,WAAAA,EACAjC,OAAQ4mM,EAAS7uQ,GACjB4qL,wBAAyB+jF,EACzB9jN,OAAQ9vD,EAAM8vD,SAGf,OACC/N,EAAAA,GAAAA,KAACunI,GAAAp+H,EAAAA,EAAA,GAAiByO,GAAA,IAAMwV,WAAAA,EAAwBjC,OAAQ4mM,EAAS7uQ,GAAI1K,MAAOs5L,EAC3EpxK,UAAAu/B,EAAAA,GAAAA,MAAC0wN,GAAAxnN,EAAAA,EAAA,GAAayO,GAAA,IACbl3C,SAAA,EAAAs/B,EAAAA,GAAAA,KAACo8M,GAAA,CACA17O,UAAAs/B,EAAAA,GAAAA,KAACohI,GAAA,MAED1gK,QAIL,CC/B8B,IAExBw4J,GAAG,SAAA84F,GAAA5sN,EAAA8zH,EAAA84F,GAAA,IAAAjuM,EAAAle,EAAAqzH,GAAA,SAAAA,IAAA,OAAA30H,EAAA,KAAA20H,GAAAn1G,EAAA73E,MAAA,KAAAR,UAAA,CAYN,OAZMq5D,EAAAm0H,EAAA,EAAA3sL,IAAA,SAAAmB,MACP,WACE,OACEukR,EAAAA,GAAAA,MAAA,OAAK7/K,UAAU,MAAK1xE,SAAA,EAClBwxP,EAAAA,GAAAA,KAAA,KAAG9/K,UAAU,YAAW1xE,SAAC,oCAGzBwxP,EAAAA,GAAAA,KAAA,OAAK9/K,UAAU,iBAAgB1xE,UACpCwxP,EAAAA,GAAAA,KAACP,GAAM,CAACh9N,WAAS,QAIlB,KAACukI,CAAA,CAZM,CAASpyI,EAAAA,WAelB,MChBAq1K,EAAAA,QACE+1D,EAAAA,GAAAA,KAACh5F,GAAG,IACJtnL,SAAS4rQ,eAAe","sources":["../node_modules/classnames/index.js","../node_modules/core-js/internals/a-callable.js","../node_modules/core-js/internals/add-to-unscopables.js","../node_modules/core-js/internals/advance-string-index.js","../node_modules/core-js/internals/an-object.js","../node_modules/core-js/internals/array-includes.js","../node_modules/core-js/internals/array-species-constructor.js","../node_modules/core-js/internals/array-species-create.js","../node_modules/core-js/internals/classof-raw.js","../node_modules/core-js/internals/classof.js","../node_modules/core-js/internals/copy-constructor-properties.js","../node_modules/core-js/internals/create-non-enumerable-property.js","../node_modules/core-js/internals/create-property-descriptor.js","../node_modules/core-js/internals/define-built-in.js","../node_modules/core-js/internals/define-global-property.js","../node_modules/core-js/internals/descriptors.js","../node_modules/core-js/internals/document-all.js","../node_modules/core-js/internals/document-create-element.js","../node_modules/core-js/internals/does-not-exceed-safe-integer.js","../node_modules/core-js/internals/engine-user-agent.js","../node_modules/core-js/internals/engine-v8-version.js","../node_modules/core-js/internals/enum-bug-keys.js","../node_modules/core-js/internals/export.js","../node_modules/core-js/internals/fails.js","../node_modules/core-js/internals/fix-regexp-well-known-symbol-logic.js","../node_modules/core-js/internals/flatten-into-array.js","../node_modules/core-js/internals/function-apply.js","../node_modules/core-js/internals/function-bind-context.js","../node_modules/core-js/internals/function-bind-native.js","../node_modules/core-js/internals/function-call.js","../node_modules/core-js/internals/function-name.js","../node_modules/core-js/internals/function-uncurry-this-clause.js","../node_modules/core-js/internals/function-uncurry-this.js","../node_modules/core-js/internals/get-built-in.js","../node_modules/core-js/internals/get-method.js","../node_modules/core-js/internals/get-substitution.js","../node_modules/core-js/internals/global.js","../node_modules/core-js/internals/has-own-property.js","../node_modules/core-js/internals/hidden-keys.js","../node_modules/core-js/internals/html.js","../node_modules/core-js/internals/ie8-dom-define.js","../node_modules/core-js/internals/indexed-object.js","../node_modules/core-js/internals/inspect-source.js","../node_modules/core-js/internals/internal-state.js","../node_modules/core-js/internals/is-array.js","../node_modules/core-js/internals/is-callable.js","../node_modules/core-js/internals/is-constructor.js","../node_modules/core-js/internals/is-forced.js","../node_modules/core-js/internals/is-null-or-undefined.js","../node_modules/core-js/internals/is-object.js","../node_modules/core-js/internals/is-pure.js","../node_modules/core-js/internals/is-symbol.js","../node_modules/core-js/internals/length-of-array-like.js","../node_modules/core-js/internals/make-built-in.js","../node_modules/core-js/internals/math-trunc.js","../node_modules/core-js/internals/object-create.js","../node_modules/core-js/internals/object-define-properties.js","../node_modules/core-js/internals/object-define-property.js","../node_modules/core-js/internals/object-get-own-property-descriptor.js","../node_modules/core-js/internals/object-get-own-property-names.js","../node_modules/core-js/internals/object-get-own-property-symbols.js","../node_modules/core-js/internals/object-is-prototype-of.js","../node_modules/core-js/internals/object-keys-internal.js","../node_modules/core-js/internals/object-keys.js","../node_modules/core-js/internals/object-property-is-enumerable.js","../node_modules/core-js/internals/ordinary-to-primitive.js","../node_modules/core-js/internals/own-keys.js","../node_modules/core-js/internals/regexp-exec-abstract.js","../node_modules/core-js/internals/regexp-exec.js","../node_modules/core-js/internals/regexp-flags.js","../node_modules/core-js/internals/regexp-sticky-helpers.js","../node_modules/core-js/internals/regexp-unsupported-dot-all.js","../node_modules/core-js/internals/regexp-unsupported-ncg.js","../node_modules/core-js/internals/require-object-coercible.js","../node_modules/core-js/internals/shared-key.js","../node_modules/core-js/internals/shared-store.js","../node_modules/core-js/internals/shared.js","../node_modules/core-js/internals/string-multibyte.js","../node_modules/core-js/internals/symbol-constructor-detection.js","../node_modules/core-js/internals/to-absolute-index.js","../node_modules/core-js/internals/to-indexed-object.js","../node_modules/core-js/internals/to-integer-or-infinity.js","../node_modules/core-js/internals/to-length.js","../node_modules/core-js/internals/to-object.js","../node_modules/core-js/internals/to-primitive.js","../node_modules/core-js/internals/to-property-key.js","../node_modules/core-js/internals/to-string-tag-support.js","../node_modules/core-js/internals/to-string.js","../node_modules/core-js/internals/try-to-string.js","../node_modules/core-js/internals/uid.js","../node_modules/core-js/internals/use-symbol-as-uid.js","../node_modules/core-js/internals/v8-prototype-define-bug.js","../node_modules/core-js/internals/weak-map-basic-detection.js","../node_modules/core-js/internals/well-known-symbol.js","../node_modules/core-js/modules/es.array.flat-map.js","../node_modules/core-js/modules/es.array.flat.js","../node_modules/core-js/modules/es.array.unscopables.flat-map.js","../node_modules/core-js/modules/es.array.unscopables.flat.js","../node_modules/core-js/modules/es.regexp.exec.js","../node_modules/core-js/modules/es.string.replace.js","../node_modules/eventemitter3/index.js","../node_modules/lodash.isequal/index.js","../node_modules/lodash.throttle/index.js","../node_modules/lodash.uniq/index.js","../node_modules/lz-string/libs/lz-string.js","../node_modules/react-dom/cjs/react-dom.production.min.js","../node_modules/react-dom/index.js","../node_modules/react/cjs/react-jsx-runtime.production.min.js","../node_modules/react/cjs/react.production.min.js","../node_modules/react/index.js","../node_modules/react/jsx-runtime.js","../node_modules/scheduler/cjs/scheduler.production.min.js","../node_modules/scheduler/index.js","../webpack/bootstrap","../webpack/runtime/create fake namespace object","../webpack/runtime/define property getters","../webpack/runtime/global","../webpack/runtime/hasOwnProperty shorthand","../webpack/runtime/make namespace object","../webpack/runtime/node module decorator","../webpack/runtime/nonce","../node_modules/@babel/runtime/helpers/esm/classCallCheck.js","../node_modules/@babel/runtime/helpers/esm/typeof.js","../node_modules/@babel/runtime/helpers/esm/toPropertyKey.js","../node_modules/@babel/runtime/helpers/esm/toPrimitive.js","../node_modules/@babel/runtime/helpers/esm/createClass.js","../node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","../node_modules/@babel/runtime/helpers/esm/inherits.js","../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js","../node_modules/@babel/runtime/helpers/esm/isNativeReflectConstruct.js","../node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js","../node_modules/@babel/runtime/helpers/esm/createSuper.js","../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js","../node_modules/@babel/runtime/helpers/esm/arrayLikeToArray.js","../node_modules/@babel/runtime/helpers/esm/unsupportedIterableToArray.js","../node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js","../node_modules/@babel/runtime/helpers/esm/defineProperty.js","../node_modules/@babel/runtime/helpers/esm/objectSpread2.js","../node_modules/@tldraw/utils/src/lib/array.ts","../node_modules/@tldraw/utils/src/lib/function.ts","../node_modules/@tldraw/utils/src/lib/control.ts","../node_modules/@babel/runtime/helpers/esm/iterableToArray.js","../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js","../node_modules/@babel/runtime/helpers/esm/arrayWithoutHoles.js","../node_modules/@babel/runtime/helpers/esm/nonIterableSpread.js","../node_modules/@tldraw/utils/src/lib/debounce.ts","../node_modules/@tldraw/utils/src/lib/error.ts","../node_modules/@tldraw/utils/src/lib/hash.ts","../node_modules/@babel/runtime/helpers/esm/arrayWithHoles.js","../node_modules/@babel/runtime/helpers/esm/nonIterableRest.js","../node_modules/@babel/runtime/helpers/esm/slicedToArray.js","../node_modules/@babel/runtime/helpers/esm/iterableToArrayLimit.js","../node_modules/@tldraw/utils/src/lib/number.ts","../node_modules/@tldraw/utils/src/lib/object.ts","../node_modules/@tldraw/utils/src/lib/value.ts","../node_modules/@tldraw/tlstore/src/lib/IncrementalSetConstructor.ts","../node_modules/nanoid/index.browser.js","../node_modules/@tldraw/tlstore/src/lib/RecordType.ts","../node_modules/signia/src/ArraySet.ts","../node_modules/signia/src/helpers.ts","../node_modules/signia/src/capture.ts","../node_modules/signia/src/types.ts","../node_modules/signia/src/HistoryBuffer.ts","../node_modules/signia/src/constants.ts","../node_modules/signia/src/transactions.ts","../node_modules/signia/src/Atom.ts","../node_modules/signia/src/Computed.ts","../node_modules/signia/src/EffectScheduler.ts","../node_modules/signia/src/isSignal.ts","../node_modules/signia/src/index.ts","../node_modules/@tldraw/tlstore/src/lib/Cache.ts","../node_modules/@tldraw/tlstore/src/lib/executeQuery.ts","../node_modules/@tldraw/tlstore/src/lib/setUtils.ts","../node_modules/@tldraw/tlstore/src/lib/StoreQueries.ts","../node_modules/@tldraw/tlstore/src/lib/Store.ts","../node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js","../node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js","../node_modules/@tldraw/tlstore/src/lib/migrate.ts","../node_modules/@tldraw/tlstore/src/lib/BaseRecord.ts","../node_modules/@tldraw/tlstore/src/lib/StoreSchema.ts","../node_modules/@tldraw/tlstore/src/lib/compareSchemas.ts","../node_modules/@babel/runtime/helpers/esm/construct.js","../node_modules/@babel/runtime/helpers/esm/wrapNativeSuper.js","../node_modules/@babel/runtime/helpers/esm/isNativeFunction.js","../node_modules/@tldraw/tlvalidate/src/lib/validation.ts","../node_modules/@tldraw/tlschema/src/style-types.ts","../node_modules/@tldraw/tlschema/src/validation.ts","../node_modules/@tldraw/tlschema/src/records/TLCamera.ts","../node_modules/@tldraw/tlschema/src/records/TLDocument.ts","../node_modules/@tldraw/tlschema/src/ui-types.ts","../node_modules/@tldraw/tlschema/src/records/TLInstance.ts","../node_modules/@tldraw/tlschema/src/records/TLInstancePageState.ts","../node_modules/@tldraw/tlschema/src/records/TLPage.ts","../node_modules/@tldraw/tlschema/src/languages.ts","../node_modules/@tldraw/tlschema/src/records/TLUser.ts","../node_modules/@tldraw/tlschema/src/records/TLUserDocument.ts","../node_modules/@tldraw/tlschema/src/records/TLUserPresence.ts","../node_modules/@tldraw/tlschema/src/TLStore.ts","../node_modules/@tldraw/tlschema/src/assets/asset-validation.ts","../node_modules/@tldraw/tlschema/src/assets/TLBookmarkAsset.ts","../node_modules/@tldraw/tlschema/src/assets/TLImageAsset.ts","../node_modules/@tldraw/tlschema/src/assets/TLVideoAsset.ts","../node_modules/@tldraw/tlschema/src/fixup.ts","../node_modules/@tldraw/tlschema/src/records/TLAsset.ts","../node_modules/@tldraw/tlschema/src/records/TLShape.ts","../node_modules/@tldraw/tlschema/src/schema.ts","../node_modules/@tldraw/tlschema/src/shapes/shape-validation.ts","../node_modules/@tldraw/tlschema/src/shapes/TLArrowShape.ts","../node_modules/@tldraw/tlschema/src/shapes/TLBookmarkShape.ts","../node_modules/@tldraw/tlschema/src/shapes/TLDrawShape.ts","../node_modules/@tldraw/tlschema/src/shapes/TLEmbedShape.ts","../node_modules/@tldraw/tlschema/src/shapes/TLFrameShape.ts","../node_modules/@tldraw/tlschema/src/shapes/TLGeoShape.ts","../node_modules/@tldraw/tlschema/src/shapes/TLGroupShape.ts","../node_modules/@tldraw/tlschema/src/shapes/TLIconShape.ts","../node_modules/@tldraw/tlschema/src/shapes/TLImageShape.ts","../node_modules/@tldraw/tlschema/src/shapes/TLLineShape.ts","../node_modules/@tldraw/tlschema/src/shapes/TLNoteShape.ts","../node_modules/@tldraw/tlschema/src/shapes/TLTextShape.ts","../node_modules/@tldraw/tlschema/src/shapes/TLVideoShape.ts","../node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js","../node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js","../node_modules/@babel/runtime/helpers/esm/toArray.js","../node_modules/@tldraw/primitives/src/lib/easings.ts","../node_modules/@tldraw/primitives/src/lib/Vec2d/Vec2d.ts","../node_modules/@tldraw/primitives/src/lib/utils.ts","../node_modules/@tldraw/primitives/src/lib/Box2d/Box2d.ts","../node_modules/@tldraw/primitives/src/lib/BaseSegment2d/BaseSegment2d.ts","../node_modules/@tldraw/primitives/src/lib/CubicSegment2d/CubicSegment2d.ts","../node_modules/@tldraw/primitives/src/lib/BaseSpline2d/BaseSpline2d.ts","../node_modules/@tldraw/primitives/src/lib/CubicSpline2d/CubicSpline2d.ts","../node_modules/@tldraw/primitives/src/lib/LineSegment2d/LineSegment2d.ts","../node_modules/@tldraw/primitives/src/lib/Matrix2d/Matrix2d.ts","../node_modules/@tldraw/primitives/src/lib/Polyline2d/Polyline2d.ts","../node_modules/@tldraw/primitives/src/lib/freehand/getStrokeOutlinePoints.ts","../node_modules/@tldraw/primitives/src/lib/freehand/getStrokePoints.ts","../node_modules/@tldraw/primitives/src/lib/freehand/setStrokePointRadii.ts","../node_modules/@tldraw/primitives/src/lib/freehand/getStroke.ts","../node_modules/@tldraw/primitives/src/lib/intersect.ts","../node_modules/@tldraw/editor/src/lib/components/SVGContainer/SVGContainer.tsx","../node_modules/@tldraw/editor/src/lib/config/TLShapeDefinition.ts","../node_modules/@tldraw/editor/src/lib/constants.ts","../node_modules/signia-react/src/useStateTracking.ts","../node_modules/signia-react/src/track.ts","../node_modules/signia-react/src/useAtom.ts","../node_modules/signia-react/src/useValue.ts","../node_modules/signia-react/src/wrapJsx.ts","../node_modules/@tldraw/editor/src/lib/hooks/useApp.ts","../node_modules/@tldraw/editor/src/lib/utils/WeakMapCache.ts","../node_modules/@tldraw/editor/src/lib/utils/debug-flags.ts","../node_modules/@tldraw/editor/src/lib/utils/export.ts","../node_modules/@tldraw/editor/src/lib/utils/is-gif-animated.ts","../node_modules/@tldraw/editor/src/lib/utils/assets.ts","../node_modules/@tldraw/editor/src/lib/utils/buildFromV1Document.ts","../node_modules/@tldraw/editor/src/lib/utils/data.ts","../node_modules/@tldraw/editor/src/lib/utils/dom.ts","../node_modules/@tldraw/editor/src/lib/utils/embeds.ts","../node_modules/escape-string-regexp/index.js","../node_modules/@tldraw/editor/src/lib/utils/props-for-next-shape.ts","../node_modules/@tldraw/editor/src/lib/utils/reordering/dgreensp/dgreensp.ts","../node_modules/@tldraw/editor/src/lib/utils/reordering/reordering.ts","../node_modules/@tldraw/editor/src/lib/utils/rotation.ts","../node_modules/@tldraw/editor/src/lib/utils/runtime.ts","../node_modules/@tldraw/editor/src/lib/utils/string.ts","../node_modules/@tldraw/editor/src/lib/utils/svg.ts","../node_modules/@tldraw/editor/src/lib/hooks/useContainer.tsx","../node_modules/@tldraw/editor/src/lib/hooks/useQuickReactor.ts","../node_modules/@tldraw/editor/src/lib/hooks/useCursor.ts","../node_modules/@tldraw/editor/src/lib/hooks/useDocumentEvents.ts","../node_modules/@tldraw/editor/src/lib/hooks/useFixSafariDoubleTapZoomPencilEvents.ts","../node_modules/@babel/runtime/helpers/esm/get.js","../node_modules/@babel/runtime/helpers/esm/superPropBase.js","../node_modules/@use-gesture/core/dist/maths-0ab39ae9.esm.js","../node_modules/@use-gesture/core/dist/actions-94b581a0.esm.js","../node_modules/@use-gesture/core/dist/use-gesture-core.esm.js","../node_modules/@use-gesture/react/dist/use-gesture-react.esm.js","../node_modules/@tldraw/editor/src/lib/hooks/shared.ts","../node_modules/@tldraw/editor/src/lib/hooks/useGestureEvents.ts","../node_modules/@tldraw/editor/src/lib/hooks/useHandleEvents.ts","../node_modules/@tldraw/editor/src/lib/hooks/useIsEditing.ts","../node_modules/@tldraw/editor/src/lib/hooks/usePattern.tsx","../node_modules/@tldraw/editor/src/lib/hooks/useShapeEvents.ts","../node_modules/@tldraw/editor/src/lib/app/shapeutils/shared/ShapeFill.tsx","../node_modules/@tldraw/editor/src/lib/app/shapeutils/shared/getPerfectDashProps.ts","../node_modules/@tldraw/editor/src/lib/app/shapeutils/shared/index.ts","../node_modules/@tldraw/editor/src/lib/app/shapeutils/shared/getTextSvgElement.ts","../node_modules/@tldraw/editor/src/lib/app/shapeutils/TLShapeUtil.ts","../node_modules/@tldraw/editor/src/lib/app/shapeutils/TLArrowUtil/arrow/arrowheads.ts","../node_modules/@tldraw/editor/src/lib/app/shapeutils/TLArrowUtil/arrow/shared.ts","../node_modules/@tldraw/editor/src/lib/app/shapeutils/TLArrowUtil/arrow/straight-arrow.ts","../node_modules/@tldraw/editor/src/lib/app/shapeutils/TLArrowUtil/arrow/curved-arrow.ts","../node_modules/@tldraw/editor/src/lib/app/shapeutils/TLTextUtil/TextHelpers.ts","../node_modules/@tldraw/editor/src/lib/app/shapeutils/shared/useEditableText.ts","../node_modules/@tldraw/editor/src/lib/app/shapeutils/TLArrowUtil/components/ArrowTextLabel.tsx","../node_modules/@tldraw/editor/src/lib/app/shapeutils/TLArrowUtil/TLArrowUtil.tsx","../node_modules/@tldraw/editor/src/lib/components/HTMLContainer/HTMLContainer.tsx","../node_modules/@tldraw/editor/src/lib/app/shapeutils/shared/HyperlinkButton.tsx","../node_modules/@tldraw/editor/src/lib/app/shapeutils/shared/resizeBox.ts","../node_modules/@tldraw/editor/src/lib/app/shapeutils/TLBoxUtil.tsx","../node_modules/@tldraw/editor/src/lib/app/shapeutils/TLBookmarkUtil/TLBookmarkUtil.tsx","../node_modules/@tldraw/editor/src/lib/app/shapeutils/TLDrawUtil/getPath.ts","../node_modules/@tldraw/editor/src/lib/app/shapeutils/TLDrawUtil/TLDrawUtil.tsx","../node_modules/@tldraw/editor/src/lib/components/Spinner/Spinner.tsx","../node_modules/@tldraw/editor/src/lib/app/shapeutils/TLEmbedUtil/TLEmbedUtil.tsx","../node_modules/@tldraw/editor/src/lib/app/shapeutils/TLFrameUtil/components/FrameLabelInput.tsx","../node_modules/@tldraw/editor/src/lib/app/shapeutils/TLFrameUtil/components/FrameHeading.tsx","../node_modules/@tldraw/editor/src/lib/app/shapeutils/TLFrameUtil/TLFrameUtil.tsx","../node_modules/@tldraw/editor/src/lib/app/shapeutils/shared/TextLabel.tsx","../node_modules/@tldraw/editor/src/lib/app/shapeutils/TLGeoUtil/components/DashStyleEllipse.tsx","../node_modules/@tldraw/editor/src/lib/app/shapeutils/TLGeoUtil/helpers.ts","../node_modules/@tldraw/editor/src/lib/app/shapeutils/TLGeoUtil/components/DashStyleOval.tsx","../node_modules/@tldraw/editor/src/lib/app/shapeutils/TLGeoUtil/components/DashStylePolygon.tsx","../node_modules/@tldraw/editor/src/lib/app/shapeutils/TLGeoUtil/components/DrawStyleEllipse.tsx","../node_modules/@tldraw/editor/src/lib/app/shapeutils/TLGeoUtil/components/DrawStylePolygon.tsx","../node_modules/@tldraw/editor/src/lib/app/shapeutils/TLGeoUtil/components/SolidStyleEllipse.tsx","../node_modules/@tldraw/editor/src/lib/app/shapeutils/TLGeoUtil/components/SolidStyleOval.tsx","../node_modules/@tldraw/editor/src/lib/app/shapeutils/TLGeoUtil/components/SolidStylePolygon.tsx","../node_modules/@tldraw/editor/src/lib/app/shapeutils/TLGeoUtil/TLGeoUtil.tsx","../node_modules/@tldraw/editor/src/lib/app/shapeutils/TLGroupUtil/TLGroupUtil.tsx","../node_modules/@tldraw/editor/src/lib/app/shapeutils/TLImageUtil/TLImageUtil.tsx","../node_modules/@tldraw/editor/src/lib/app/shapeutils/TLLineUtil/components/getLinePath.ts","../node_modules/@tldraw/editor/src/lib/app/shapeutils/TLLineUtil/components/getLineSvg.ts","../node_modules/@tldraw/editor/src/lib/app/shapeutils/TLLineUtil/TLLineUtil.tsx","../node_modules/@tldraw/editor/src/lib/app/shapeutils/TLNoteUtil/TLNoteUtil.tsx","../node_modules/@tldraw/editor/src/lib/app/shapeutils/TLTextUtil/TLTextUtil.tsx","../node_modules/@tldraw/editor/src/lib/app/shapeutils/shared/resizeScaled.ts","../node_modules/@tldraw/editor/src/lib/app/shapeutils/TLVideoUtil/TLVideoUtil.tsx","../node_modules/@tldraw/editor/src/lib/config/TldrawEditorConfig.tsx","../node_modules/@tldraw/editor/src/lib/app/derivations/arrowBindingsIndex.ts","../node_modules/@tldraw/editor/src/lib/app/derivations/shapeIdsInCurrentPage.ts","../node_modules/@tldraw/editor/src/lib/app/managers/ActiveAreaManager.ts","../node_modules/@tldraw/editor/src/lib/app/managers/CameraManager.ts","../node_modules/@tldraw/editor/src/lib/app/managers/ClickManager.ts","../node_modules/@tldraw/editor/src/lib/app/managers/DprManager.ts","../node_modules/@tldraw/editor/src/lib/app/managers/DragAndDropManager.ts","../node_modules/@tldraw/editor/src/lib/app/managers/Stack.ts","../node_modules/@tldraw/editor/src/lib/app/managers/HistoryManager.ts","../node_modules/@tldraw/editor/src/lib/app/managers/ScribbleManager.ts","../node_modules/@tldraw/editor/src/lib/app/managers/SnapManager.ts","../node_modules/@tldraw/editor/src/lib/app/managers/TextManager.ts","../node_modules/@tldraw/editor/src/lib/app/managers/TickManager.ts","../node_modules/@tldraw/editor/src/lib/app/types/event-types.ts","../node_modules/@tldraw/editor/src/lib/app/statechart/StateNode.ts","../node_modules/@tldraw/editor/src/lib/app/statechart/TLArrowTool/children/Idle.ts","../node_modules/@tldraw/editor/src/lib/app/statechart/TLArrowTool/children/Pointing.ts","../node_modules/@tldraw/editor/src/lib/app/statechart/TLArrowTool/TLArrowTool.ts","../node_modules/@tldraw/editor/src/lib/app/statechart/TLDrawTool/children/Drawing.ts","../node_modules/@tldraw/editor/src/lib/app/statechart/TLDrawTool/children/Idle.ts","../node_modules/@tldraw/editor/src/lib/app/statechart/TLDrawTool/TLDrawTool.ts","../node_modules/@tldraw/editor/src/lib/app/statechart/TLEraserTool/children/Erasing.ts","../node_modules/@tldraw/editor/src/lib/app/statechart/TLEraserTool/children/Idle.ts","../node_modules/@tldraw/editor/src/lib/app/statechart/TLEraserTool/children/Pointing.ts","../node_modules/@tldraw/editor/src/lib/app/statechart/TLEraserTool/TLEraserTool.ts","../node_modules/@tldraw/editor/src/lib/app/statechart/TLBoxTool/children/Idle.ts","../node_modules/@tldraw/editor/src/lib/app/statechart/TLBoxTool/children/Pointing.ts","../node_modules/@tldraw/editor/src/lib/app/statechart/TLBoxTool/TLBoxTool.ts","../node_modules/@tldraw/editor/src/lib/app/statechart/TLFrameTool/TLFrameTool.ts","../node_modules/@tldraw/editor/src/lib/app/statechart/TLGeoTool/children/Idle.ts","../node_modules/@tldraw/editor/src/lib/app/statechart/TLGeoTool/children/Pointing.ts","../node_modules/@tldraw/editor/src/lib/app/statechart/TLGeoTool/TLGeoTool.ts","../node_modules/@tldraw/editor/src/lib/app/statechart/TLHandTool/children/Dragging.ts","../node_modules/@tldraw/editor/src/lib/app/statechart/TLHandTool/children/Idle.ts","../node_modules/@tldraw/editor/src/lib/app/statechart/TLHandTool/children/Pointing.ts","../node_modules/@tldraw/editor/src/lib/app/statechart/TLHandTool/TLHandTool.ts","../node_modules/@tldraw/editor/src/lib/app/statechart/TLLineTool/children/Idle.ts","../node_modules/@tldraw/editor/src/lib/app/statechart/TLLineTool/children/Pointing.ts","../node_modules/@tldraw/editor/src/lib/app/statechart/TLLineTool/TLLineTool.ts","../node_modules/@tldraw/editor/src/lib/app/statechart/TLNoteTool/children/Idle.ts","../node_modules/@tldraw/editor/src/lib/app/statechart/TLNoteTool/children/Pointing.ts","../node_modules/@tldraw/editor/src/lib/app/statechart/TLNoteTool/TLNoteTool.ts","../node_modules/@tldraw/editor/src/lib/app/statechart/TLSelectTool/Translating.ts","../node_modules/@tldraw/editor/src/lib/app/statechart/TLSelectTool/children/Brushing.ts","../node_modules/@tldraw/editor/src/lib/app/statechart/TLSelectTool/children/DraggingHandle.ts","../node_modules/@tldraw/editor/src/lib/app/statechart/TLSelectTool/children/EditingShape.ts","../node_modules/@tldraw/editor/src/lib/app/statechart/TLSelectTool/children/Idle.ts","../node_modules/@tldraw/editor/src/lib/app/statechart/TLSelectTool/children/PointingCanvas.ts","../node_modules/@tldraw/editor/src/lib/app/statechart/TLSelectTool/children/PointingHandle.ts","../node_modules/@tldraw/editor/src/lib/app/statechart/TLSelectTool/children/PointingResizeHandle.ts","../node_modules/@tldraw/editor/src/lib/app/statechart/TLSelectTool/children/PointingRotateHandle.ts","../node_modules/@tldraw/editor/src/lib/app/statechart/TLSelectTool/children/PointingSelection.ts","../node_modules/@tldraw/editor/src/lib/app/statechart/TLSelectTool/children/PointingShape.ts","../node_modules/@tldraw/editor/src/lib/app/statechart/TLSelectTool/children/Resizing.ts","../node_modules/@tldraw/editor/src/lib/app/statechart/TLSelectTool/children/Rotating.ts","../node_modules/@tldraw/editor/src/lib/app/statechart/TLSelectTool/children/ScribbleBrushing.ts","../node_modules/@tldraw/editor/src/lib/app/statechart/TLSelectTool/TLSelectTool.ts","../node_modules/@tldraw/editor/src/lib/app/statechart/TLTextTool/children/Idle.ts","../node_modules/@tldraw/editor/src/lib/app/statechart/TLTextTool/children/Pointing.ts","../node_modules/@tldraw/editor/src/lib/app/statechart/TLTextTool/TLTextTool.ts","../node_modules/@tldraw/editor/src/lib/app/statechart/RootState.ts","../node_modules/@tldraw/editor/src/lib/app/App.ts","../node_modules/@tldraw/editor/src/lib/app/derivations/parentsToChildrenWithIndexes.ts","../node_modules/@tldraw/editor/src/lib/assetUrls.ts","../node_modules/@tldraw/editor/src/lib/components/ErrorBoundary/ErrorBoundary.tsx","../node_modules/@tldraw/editor/src/lib/components/Brush/Brush.tsx","../node_modules/@tldraw/editor/src/lib/components/Grid/Grid.tsx","../node_modules/@tldraw/editor/src/lib/components/Handle/Handle.tsx","../node_modules/@tldraw/editor/src/lib/components/Handle/HandlesContainer.tsx","../node_modules/@tldraw/editor/src/lib/components/Cursor/Cursor.tsx","../node_modules/@tldraw/editor/src/lib/components/CursorHint/CursorHint.tsx","../node_modules/@tldraw/editor/src/lib/components/ShapeIndicator/ShapeIndicator.tsx","../node_modules/@tldraw/editor/src/lib/components/LiveCollaborators/LiveCollaborators.tsx","../node_modules/@tldraw/editor/src/lib/components/Scribble/Scribble.tsx","../node_modules/@tldraw/editor/src/lib/components/Selection/SelectionBg.tsx","../node_modules/@tldraw/editor/src/lib/hooks/useSelectionEvents.ts","../node_modules/@tldraw/editor/src/lib/components/Selection/handles/MobileRotateHandle.tsx","../node_modules/@tldraw/editor/src/lib/components/Selection/handles/RotateCornerHandle.tsx","../node_modules/@tldraw/editor/src/lib/components/Selection/SelectionFg.tsx","../node_modules/@tldraw/editor/src/lib/components/ErrorBoundary/ShapeErrorFallback.tsx","../node_modules/@tldraw/editor/src/lib/components/Shape/Shape.tsx","../node_modules/@tldraw/editor/src/lib/components/SnapLine/SnapLine.tsx","../node_modules/@tldraw/editor/src/lib/components/Canvas/Canvas.tsx","../node_modules/@tldraw/editor/src/lib/hooks/useCoarsePointer.ts","../node_modules/@tldraw/editor/src/lib/hooks/useScreenBounds.ts","../node_modules/@tldraw/editor/src/lib/hooks/useCanvasEvents.ts","../node_modules/@tldraw/editor/src/lib/components/ErrorBoundary/ErrorFallback.tsx","../node_modules/@tldraw/editor/src/lib/hooks/useSafariFocusOutFix.ts","../node_modules/@tldraw/editor/src/lib/components/Layout/Layout.tsx","../node_modules/@tldraw/editor/src/lib/hooks/useZoomCss.ts","../node_modules/@tldraw/editor/src/lib/hooks/useDarkMode.ts","../node_modules/@tldraw/editor/src/lib/hooks/useForceUpdate.ts","../node_modules/@tldraw/editor/src/lib/hooks/usePreloadAssets.ts","../node_modules/@tldraw/editor/src/lib/TldrawEditor.tsx","../node_modules/@tldraw/editor/src/lib/hooks/useEvent.tsx","../node_modules/idb/build/wrap-idb-value.js","../node_modules/idb/build/index.js","../node_modules/@tldraw/tlsync-client/src/lib/persistence-constants.ts","../node_modules/@tldraw/tlsync-client/src/lib/indexedDb.ts","../node_modules/@tldraw/tlsync-client/src/lib/TLLocalSyncClient.ts","../node_modules/@tldraw/tlsync-client/src/lib/alerts.ts","../node_modules/@tldraw/tlsync-client/src/lib/hardReset.ts","../node_modules/@tldraw/tlsync-client/src/lib/hooks/useLocalSyncClient.ts","../node_modules/@babel/runtime/helpers/esm/extends.js","../node_modules/@radix-ui/primitive/dist/packages/core/primitive/src/primitive.tsx","../node_modules/@radix-ui/react-compose-refs/dist/packages/react/compose-refs/src/composeRefs.tsx","../node_modules/@radix-ui/react-context/dist/packages/react/context/src/createContext.tsx","../node_modules/@radix-ui/react-slot/dist/packages/react/slot/src/Slot.tsx","../node_modules/@radix-ui/react-collection/dist/packages/react/collection/src/Collection.tsx","../node_modules/@radix-ui/react-primitive/dist/packages/react/primitive/src/Primitive.tsx","../node_modules/@radix-ui/react-use-callback-ref/dist/packages/react/use-callback-ref/src/useCallbackRef.tsx","../node_modules/@radix-ui/react-dismissable-layer/dist/packages/react/dismissable-layer/src/DismissableLayer.tsx","../node_modules/@radix-ui/react-use-escape-keydown/dist/packages/react/use-escape-keydown/src/useEscapeKeydown.tsx","../node_modules/@radix-ui/react-portal/dist/packages/react/portal/src/Portal.tsx","../node_modules/@radix-ui/react-use-layout-effect/dist/packages/react/use-layout-effect/src/useLayoutEffect.tsx","../node_modules/@radix-ui/react-presence/dist/packages/react/presence/src/Presence.tsx","../node_modules/@radix-ui/react-presence/dist/packages/react/presence/src/useStateMachine.tsx","../node_modules/@radix-ui/react-use-controllable-state/dist/packages/react/use-controllable-state/src/useControllableState.tsx","../node_modules/@radix-ui/react-visually-hidden/dist/packages/react/visually-hidden/src/VisuallyHidden.tsx","../node_modules/@radix-ui/react-toast/dist/packages/react/toast/src/Toast.tsx","../node_modules/@radix-ui/react-direction/dist/packages/react/direction/src/Direction.tsx","../node_modules/@radix-ui/react-focus-guards/dist/packages/react/focus-guards/src/FocusGuards.tsx","../node_modules/@radix-ui/react-focus-scope/dist/packages/react/focus-scope/src/FocusScope.tsx","../node_modules/@radix-ui/react-id/dist/packages/react/id/src/id.tsx","../node_modules/@floating-ui/core/dist/floating-ui.core.browser.min.mjs","../node_modules/@floating-ui/dom/dist/floating-ui.dom.browser.min.mjs","../node_modules/@floating-ui/react-dom/dist/floating-ui.react-dom.esm.js","../node_modules/@radix-ui/react-use-size/dist/packages/react/use-size/src/useSize.tsx","../node_modules/@radix-ui/react-popper/dist/packages/react/popper/src/Popper.tsx","../node_modules/@radix-ui/react-roving-focus/dist/packages/react/roving-focus/src/RovingFocusGroup.tsx","../node_modules/aria-hidden/dist/es2015/index.js","../node_modules/tslib/tslib.es6.js","../node_modules/react-remove-scroll-bar/dist/es2015/constants.js","../node_modules/use-callback-ref/dist/es2015/useMergeRef.js","../node_modules/use-callback-ref/dist/es2015/useRef.js","../node_modules/use-callback-ref/dist/es2015/assignRef.js","../node_modules/use-sidecar/dist/es2015/medium.js","../node_modules/react-remove-scroll/dist/es2015/medium.js","../node_modules/react-remove-scroll/dist/es2015/UI.js","../node_modules/use-sidecar/dist/es2015/exports.js","../node_modules/get-nonce/dist/es2015/index.js","../node_modules/react-style-singleton/dist/es2015/singleton.js","../node_modules/react-style-singleton/dist/es2015/component.js","../node_modules/react-style-singleton/dist/es2015/hook.js","../node_modules/react-remove-scroll-bar/dist/es2015/utils.js","../node_modules/react-remove-scroll-bar/dist/es2015/component.js","../node_modules/react-remove-scroll/dist/es2015/aggresiveCapture.js","../node_modules/react-remove-scroll/dist/es2015/handleScroll.js","../node_modules/react-remove-scroll/dist/es2015/SideEffect.js","../node_modules/react-remove-scroll/dist/es2015/sidecar.js","../node_modules/react-remove-scroll/dist/es2015/Combination.js","../node_modules/@radix-ui/react-menu/dist/packages/react/menu/src/Menu.tsx","../node_modules/@radix-ui/react-context-menu/dist/packages/react/context-menu/src/ContextMenu.tsx","../node_modules/@tldraw/ui/src/lib/hooks/menuHelpers.ts","../node_modules/@radix-ui/react-dialog/dist/packages/react/dialog/src/Dialog.tsx","../node_modules/@tldraw/ui/src/lib/components/Spinner/Spinner.tsx","../node_modules/@tldraw/ui/src/lib/components/primitives/Icon/Icon.tsx","../node_modules/@tldraw/ui/src/lib/components/primitives/shared.ts","../node_modules/@tldraw/ui/src/lib/components/primitives/Kbd/Kbd.tsx","../node_modules/@tldraw/ui/src/lib/components/primitives/Button/Button.tsx","../node_modules/@tldraw/ui/src/lib/components/primitives/Dialog/Dialog.tsx","../node_modules/@radix-ui/react-dropdown-menu/dist/packages/react/dropdown-menu/src/DropdownMenu.tsx","../node_modules/@tldraw/ui/src/lib/components/primitives/DropdownMenu/DropdownMenu.tsx","../node_modules/@tldraw/ui/src/lib/components/primitives/ButtonPicker/ButtonPicker.tsx","../node_modules/@tldraw/ui/src/lib/components/primitives/Input/Input.tsx","../node_modules/@radix-ui/react-slider/dist/packages/react/slider/src/Slider.tsx","../node_modules/@radix-ui/number/dist/packages/core/number/src/number.ts","../node_modules/@radix-ui/react-use-previous/dist/packages/react/use-previous/src/usePrevious.tsx","../node_modules/@tldraw/ui/src/lib/components/primitives/Slider/Slider.tsx","../node_modules/@tldraw/ui/src/lib/components/EditLinkDialog/EditLinkDialog.tsx","../node_modules/@tldraw/ui/src/lib/hooks/useClipboardEvents.ts","../node_modules/@tldraw/ui/src/lib/hooks/useToastsProvider.tsx","../node_modules/@tldraw/ui/src/lib/hooks/useTranslation/defaultTranslation.ts","../node_modules/@tldraw/ui/src/lib/hooks/useTranslation/languages.ts","../node_modules/@tldraw/ui/src/lib/hooks/useTranslation/translations.ts","../node_modules/@tldraw/ui/src/lib/hooks/useTranslation/useLanguages.tsx","../node_modules/@tldraw/ui/src/lib/hooks/useAssetUrls.tsx","../node_modules/@tldraw/ui/src/lib/hooks/useTranslation/useTranslation.tsx","../node_modules/@tldraw/ui/src/lib/hooks/useCopyAs.ts","../node_modules/@tldraw/ui/src/lib/hooks/useDialogsProvider.tsx","../node_modules/@tldraw/ui/src/lib/hooks/useInsertMedia.ts","../node_modules/@tldraw/ui/src/lib/hooks/useActions.tsx","../node_modules/@tldraw/ui/src/lib/hooks/usePrint.ts","../node_modules/@tldraw/ui/src/lib/hooks/useExportAs.ts","../node_modules/@tldraw/editor/src/lib/utils/window-open.ts","../node_modules/@tldraw/ui/src/lib/constants.ts","../node_modules/@tldraw/ui/src/lib/hooks/useBreakpoint.tsx","../node_modules/@tldraw/ui/src/lib/hooks/useHasLinkShapeSelected.ts","../node_modules/@tldraw/ui/src/lib/hooks/useActionsMenuSchema.tsx","../node_modules/@tldraw/ui/src/lib/hooks/useCanRedo.ts","../node_modules/@tldraw/ui/src/lib/hooks/useCanUndo.ts","../node_modules/@tldraw/ui/src/lib/hooks/useShowAutoSizeToggle.ts","../node_modules/@tldraw/ui/src/lib/hooks/useContextMenuSchema.tsx","../node_modules/@tldraw/ui/src/lib/hooks/useOnlyFlippableShape.ts","../node_modules/@tldraw/ui/src/lib/components/KeyboardShortcutsDialog/KeyboardShortcutsDialog.tsx","../node_modules/@tldraw/ui/src/lib/hooks/useKeyboardShortcutsSchema.tsx","../node_modules/@tldraw/ui/src/lib/hooks/useHelpMenuSchema.tsx","../node_modules/hotkeys-js/dist/hotkeys.esm.js","../node_modules/@tldraw/ui/src/lib/hooks/useReadonly.ts","../node_modules/@tldraw/ui/src/lib/components/EmbedDialog/EmbedDialog.tsx","../node_modules/@tldraw/ui/src/lib/hooks/useTools.tsx","../node_modules/@tldraw/ui/src/lib/hooks/useKeyboardShortcuts.ts","../node_modules/@tldraw/ui/src/lib/hooks/useMenuIsOpen.ts","../node_modules/@tldraw/ui/src/lib/hooks/useMenuSchema.tsx","../node_modules/@tldraw/ui/src/lib/hooks/useToolbarSchema.tsx","../node_modules/@tldraw/ui/src/lib/components/ContextMenu/MoveToPageMenu.tsx","../node_modules/@tldraw/ui/src/lib/components/ContextMenu/ContextMenu.tsx","../node_modules/@tldraw/ui/src/lib/components/DebugPanel/DebugPanel.tsx","../node_modules/@tldraw/ui/src/lib/components/HTMLCanvas/HTMLCanvas.tsx","../node_modules/@tldraw/ui/src/lib/components/LanguageMenu/LanguageMenu.tsx","../node_modules/@tldraw/ui/src/lib/components/HelpMenu/HelpMenu.tsx","../node_modules/@tldraw/ui/src/lib/components/NavigationZone/Minimap/MinimapManager.ts","../node_modules/@tldraw/ui/src/lib/components/NavigationZone/Minimap/Minimap.tsx","../node_modules/@tldraw/ui/src/lib/components/NavigationZone/ZoomMenu/ZoomMenu.tsx","../node_modules/@tldraw/ui/src/lib/components/NavigationZone/NavigationZone.tsx","../node_modules/@tldraw/ui/src/lib/hooks/useLocalStorageState.ts","../node_modules/@tldraw/ui/src/lib/components/StylePanel/DoubleDropdownPicker/DoubleDropdownPicker.tsx","../node_modules/@tldraw/ui/src/lib/components/StylePanel/DropdownPicker/DropdownPicker.tsx","../node_modules/@tldraw/ui/src/lib/components/StylePanel/StylePanel.tsx","../node_modules/@tldraw/ui/src/lib/components/BackToContent/BackToContent.tsx","../node_modules/@tldraw/ui/src/lib/components/Dialogs/Dialogs.tsx","../node_modules/@tldraw/ui/src/lib/components/ExitPenMode/PenModeToggle.tsx","../node_modules/@radix-ui/react-popover/dist/packages/react/popover/src/Popover.tsx","../node_modules/@tldraw/ui/src/lib/components/primitives/Popover/index.tsx","../node_modules/@tldraw/ui/src/lib/components/ActionsMenu/ActionsMenu.tsx","../node_modules/@tldraw/ui/src/lib/components/DuplicateButton/DuplicateButton.tsx","../node_modules/@tldraw/ui/src/lib/components/Menu/Menu.tsx","../node_modules/@tldraw/ui/src/lib/components/PageMenu/PageItemInput.tsx","../node_modules/@tldraw/ui/src/lib/components/PageMenu/edit-pages-shared.ts","../node_modules/@tldraw/ui/src/lib/components/PageMenu/PageItemSubmenu.tsx","../node_modules/@tldraw/ui/src/lib/components/PageMenu/PageMenu.tsx","../node_modules/@tldraw/ui/src/lib/components/RedoButton/RedoButton.tsx","../node_modules/@tldraw/ui/src/lib/components/TrashButton/TrashButton.tsx","../node_modules/@tldraw/ui/src/lib/components/UndoButton/UndoButton.tsx","../node_modules/@tldraw/ui/src/lib/components/MenuZone/MenuZone.tsx","../node_modules/@tldraw/ui/src/lib/components/Toasts/Toasts.tsx","../node_modules/@tldraw/ui/src/lib/components/MobileStylePanel/MobileStylePanel.tsx","../node_modules/@tldraw/ui/src/lib/components/Toolbar/ToggleToolLockedButton.tsx","../node_modules/@tldraw/ui/src/lib/components/Toolbar/Toolbar.tsx","../node_modules/@tldraw/ui/src/lib/icon-types.ts","../node_modules/@tldraw/ui/src/lib/assetUrls.ts","../node_modules/@tldraw/ui/src/lib/overrides.ts","../node_modules/@tldraw/ui/src/lib/TldrawUi/TldrawUiContextProvider.tsx","../node_modules/@tldraw/ui/src/lib/TldrawUi/TldrawUi.tsx","../node_modules/@tldraw/ui/src/lib/hooks/usePreloadIcons.ts","../node_modules/@tldraw/ui/src/lib/hooks/useAppEvents.ts","../node_modules/@tldraw/tldraw/src/lib/Tldraw.tsx","App.js","index.js"],"sourcesContent":["/*!\n\tCopyright (c) 2018 Jed Watson.\n\tLicensed under the MIT License (MIT), see\n\thttp://jedwatson.github.io/classnames\n*/\n/* global define */\n\n(function () {\n\t'use strict';\n\n\tvar hasOwn = {}.hasOwnProperty;\n\tvar nativeCodeString = '[native code]';\n\n\tfunction classNames() {\n\t\tvar classes = [];\n\n\t\tfor (var i = 0; i < arguments.length; i++) {\n\t\t\tvar arg = arguments[i];\n\t\t\tif (!arg) continue;\n\n\t\t\tvar argType = typeof arg;\n\n\t\t\tif (argType === 'string' || argType === 'number') {\n\t\t\t\tclasses.push(arg);\n\t\t\t} else if (Array.isArray(arg)) {\n\t\t\t\tif (arg.length) {\n\t\t\t\t\tvar inner = classNames.apply(null, arg);\n\t\t\t\t\tif (inner) {\n\t\t\t\t\t\tclasses.push(inner);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if (argType === 'object') {\n\t\t\t\tif (arg.toString !== Object.prototype.toString && !arg.toString.toString().includes('[native code]')) {\n\t\t\t\t\tclasses.push(arg.toString());\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tfor (var key in arg) {\n\t\t\t\t\tif (hasOwn.call(arg, key) && arg[key]) {\n\t\t\t\t\t\tclasses.push(key);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn classes.join(' ');\n\t}\n\n\tif (typeof module !== 'undefined' && module.exports) {\n\t\tclassNames.default = classNames;\n\t\tmodule.exports = classNames;\n\t} else if (typeof define === 'function' && typeof define.amd === 'object' && define.amd) {\n\t\t// register as 'classnames', consistent with npm package name\n\t\tdefine('classnames', [], function () {\n\t\t\treturn classNames;\n\t\t});\n\t} else {\n\t\twindow.classNames = classNames;\n\t}\n}());\n","var isCallable = require('../internals/is-callable');\nvar tryToString = require('../internals/try-to-string');\n\nvar $TypeError = TypeError;\n\n// `Assert: IsCallable(argument) is true`\nmodule.exports = function (argument) {\n  if (isCallable(argument)) return argument;\n  throw $TypeError(tryToString(argument) + ' is not a function');\n};\n","var wellKnownSymbol = require('../internals/well-known-symbol');\nvar create = require('../internals/object-create');\nvar defineProperty = require('../internals/object-define-property').f;\n\nvar UNSCOPABLES = wellKnownSymbol('unscopables');\nvar ArrayPrototype = Array.prototype;\n\n// Array.prototype[@@unscopables]\n// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables\nif (ArrayPrototype[UNSCOPABLES] == undefined) {\n  defineProperty(ArrayPrototype, UNSCOPABLES, {\n    configurable: true,\n    value: create(null)\n  });\n}\n\n// add a key to Array.prototype[@@unscopables]\nmodule.exports = function (key) {\n  ArrayPrototype[UNSCOPABLES][key] = true;\n};\n","'use strict';\nvar charAt = require('../internals/string-multibyte').charAt;\n\n// `AdvanceStringIndex` abstract operation\n// https://tc39.es/ecma262/#sec-advancestringindex\nmodule.exports = function (S, index, unicode) {\n  return index + (unicode ? charAt(S, index).length : 1);\n};\n","var isObject = require('../internals/is-object');\n\nvar $String = String;\nvar $TypeError = TypeError;\n\n// `Assert: Type(argument) is Object`\nmodule.exports = function (argument) {\n  if (isObject(argument)) return argument;\n  throw $TypeError($String(argument) + ' is not an object');\n};\n","var toIndexedObject = require('../internals/to-indexed-object');\nvar toAbsoluteIndex = require('../internals/to-absolute-index');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\n\n// `Array.prototype.{ indexOf, includes }` methods implementation\nvar createMethod = function (IS_INCLUDES) {\n  return function ($this, el, fromIndex) {\n    var O = toIndexedObject($this);\n    var length = lengthOfArrayLike(O);\n    var index = toAbsoluteIndex(fromIndex, length);\n    var value;\n    // Array#includes uses SameValueZero equality algorithm\n    // eslint-disable-next-line no-self-compare -- NaN check\n    if (IS_INCLUDES && el != el) while (length > index) {\n      value = O[index++];\n      // eslint-disable-next-line no-self-compare -- NaN check\n      if (value != value) return true;\n    // Array#indexOf ignores holes, Array#includes - not\n    } else for (;length > index; index++) {\n      if ((IS_INCLUDES || index in O) && O[index] === el) return IS_INCLUDES || index || 0;\n    } return !IS_INCLUDES && -1;\n  };\n};\n\nmodule.exports = {\n  // `Array.prototype.includes` method\n  // https://tc39.es/ecma262/#sec-array.prototype.includes\n  includes: createMethod(true),\n  // `Array.prototype.indexOf` method\n  // https://tc39.es/ecma262/#sec-array.prototype.indexof\n  indexOf: createMethod(false)\n};\n","var isArray = require('../internals/is-array');\nvar isConstructor = require('../internals/is-constructor');\nvar isObject = require('../internals/is-object');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar SPECIES = wellKnownSymbol('species');\nvar $Array = Array;\n\n// a part of `ArraySpeciesCreate` abstract operation\n// https://tc39.es/ecma262/#sec-arrayspeciescreate\nmodule.exports = function (originalArray) {\n  var C;\n  if (isArray(originalArray)) {\n    C = originalArray.constructor;\n    // cross-realm fallback\n    if (isConstructor(C) && (C === $Array || isArray(C.prototype))) C = undefined;\n    else if (isObject(C)) {\n      C = C[SPECIES];\n      if (C === null) C = undefined;\n    }\n  } return C === undefined ? $Array : C;\n};\n","var arraySpeciesConstructor = require('../internals/array-species-constructor');\n\n// `ArraySpeciesCreate` abstract operation\n// https://tc39.es/ecma262/#sec-arrayspeciescreate\nmodule.exports = function (originalArray, length) {\n  return new (arraySpeciesConstructor(originalArray))(length === 0 ? 0 : length);\n};\n","var uncurryThis = require('../internals/function-uncurry-this');\n\nvar toString = uncurryThis({}.toString);\nvar stringSlice = uncurryThis(''.slice);\n\nmodule.exports = function (it) {\n  return stringSlice(toString(it), 8, -1);\n};\n","var TO_STRING_TAG_SUPPORT = require('../internals/to-string-tag-support');\nvar isCallable = require('../internals/is-callable');\nvar classofRaw = require('../internals/classof-raw');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\nvar $Object = Object;\n\n// ES3 wrong here\nvar CORRECT_ARGUMENTS = classofRaw(function () { return arguments; }()) == 'Arguments';\n\n// fallback for IE11 Script Access Denied error\nvar tryGet = function (it, key) {\n  try {\n    return it[key];\n  } catch (error) { /* empty */ }\n};\n\n// getting tag from ES6+ `Object.prototype.toString`\nmodule.exports = TO_STRING_TAG_SUPPORT ? classofRaw : function (it) {\n  var O, tag, result;\n  return it === undefined ? 'Undefined' : it === null ? 'Null'\n    // @@toStringTag case\n    : typeof (tag = tryGet(O = $Object(it), TO_STRING_TAG)) == 'string' ? tag\n    // builtinTag case\n    : CORRECT_ARGUMENTS ? classofRaw(O)\n    // ES3 arguments fallback\n    : (result = classofRaw(O)) == 'Object' && isCallable(O.callee) ? 'Arguments' : result;\n};\n","var hasOwn = require('../internals/has-own-property');\nvar ownKeys = require('../internals/own-keys');\nvar getOwnPropertyDescriptorModule = require('../internals/object-get-own-property-descriptor');\nvar definePropertyModule = require('../internals/object-define-property');\n\nmodule.exports = function (target, source, exceptions) {\n  var keys = ownKeys(source);\n  var defineProperty = definePropertyModule.f;\n  var getOwnPropertyDescriptor = getOwnPropertyDescriptorModule.f;\n  for (var i = 0; i < keys.length; i++) {\n    var key = keys[i];\n    if (!hasOwn(target, key) && !(exceptions && hasOwn(exceptions, key))) {\n      defineProperty(target, key, getOwnPropertyDescriptor(source, key));\n    }\n  }\n};\n","var DESCRIPTORS = require('../internals/descriptors');\nvar definePropertyModule = require('../internals/object-define-property');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\n\nmodule.exports = DESCRIPTORS ? function (object, key, value) {\n  return definePropertyModule.f(object, key, createPropertyDescriptor(1, value));\n} : function (object, key, value) {\n  object[key] = value;\n  return object;\n};\n","module.exports = function (bitmap, value) {\n  return {\n    enumerable: !(bitmap & 1),\n    configurable: !(bitmap & 2),\n    writable: !(bitmap & 4),\n    value: value\n  };\n};\n","var isCallable = require('../internals/is-callable');\nvar definePropertyModule = require('../internals/object-define-property');\nvar makeBuiltIn = require('../internals/make-built-in');\nvar defineGlobalProperty = require('../internals/define-global-property');\n\nmodule.exports = function (O, key, value, options) {\n  if (!options) options = {};\n  var simple = options.enumerable;\n  var name = options.name !== undefined ? options.name : key;\n  if (isCallable(value)) makeBuiltIn(value, name, options);\n  if (options.global) {\n    if (simple) O[key] = value;\n    else defineGlobalProperty(key, value);\n  } else {\n    try {\n      if (!options.unsafe) delete O[key];\n      else if (O[key]) simple = true;\n    } catch (error) { /* empty */ }\n    if (simple) O[key] = value;\n    else definePropertyModule.f(O, key, {\n      value: value,\n      enumerable: false,\n      configurable: !options.nonConfigurable,\n      writable: !options.nonWritable\n    });\n  } return O;\n};\n","var global = require('../internals/global');\n\n// eslint-disable-next-line es/no-object-defineproperty -- safe\nvar defineProperty = Object.defineProperty;\n\nmodule.exports = function (key, value) {\n  try {\n    defineProperty(global, key, { value: value, configurable: true, writable: true });\n  } catch (error) {\n    global[key] = value;\n  } return value;\n};\n","var fails = require('../internals/fails');\n\n// Detect IE8's incomplete defineProperty implementation\nmodule.exports = !fails(function () {\n  // eslint-disable-next-line es/no-object-defineproperty -- required for testing\n  return Object.defineProperty({}, 1, { get: function () { return 7; } })[1] != 7;\n});\n","var documentAll = typeof document == 'object' && document.all;\n\n// https://tc39.es/ecma262/#sec-IsHTMLDDA-internal-slot\n// eslint-disable-next-line unicorn/no-typeof-undefined -- required for testing\nvar IS_HTMLDDA = typeof documentAll == 'undefined' && documentAll !== undefined;\n\nmodule.exports = {\n  all: documentAll,\n  IS_HTMLDDA: IS_HTMLDDA\n};\n","var global = require('../internals/global');\nvar isObject = require('../internals/is-object');\n\nvar document = global.document;\n// typeof document.createElement is 'object' in old IE\nvar EXISTS = isObject(document) && isObject(document.createElement);\n\nmodule.exports = function (it) {\n  return EXISTS ? document.createElement(it) : {};\n};\n","var $TypeError = TypeError;\nvar MAX_SAFE_INTEGER = 0x1FFFFFFFFFFFFF; // 2 ** 53 - 1 == 9007199254740991\n\nmodule.exports = function (it) {\n  if (it > MAX_SAFE_INTEGER) throw $TypeError('Maximum allowed index exceeded');\n  return it;\n};\n","module.exports = typeof navigator != 'undefined' && String(navigator.userAgent) || '';\n","var global = require('../internals/global');\nvar userAgent = require('../internals/engine-user-agent');\n\nvar process = global.process;\nvar Deno = global.Deno;\nvar versions = process && process.versions || Deno && Deno.version;\nvar v8 = versions && versions.v8;\nvar match, version;\n\nif (v8) {\n  match = v8.split('.');\n  // in old Chrome, versions of V8 isn't V8 = Chrome / 10\n  // but their correct versions are not interesting for us\n  version = match[0] > 0 && match[0] < 4 ? 1 : +(match[0] + match[1]);\n}\n\n// BrowserFS NodeJS `process` polyfill incorrectly set `.v8` to `0.0`\n// so check `userAgent` even if `.v8` exists, but 0\nif (!version && userAgent) {\n  match = userAgent.match(/Edge\\/(\\d+)/);\n  if (!match || match[1] >= 74) {\n    match = userAgent.match(/Chrome\\/(\\d+)/);\n    if (match) version = +match[1];\n  }\n}\n\nmodule.exports = version;\n","// IE8- don't enum bug keys\nmodule.exports = [\n  'constructor',\n  'hasOwnProperty',\n  'isPrototypeOf',\n  'propertyIsEnumerable',\n  'toLocaleString',\n  'toString',\n  'valueOf'\n];\n","var global = require('../internals/global');\nvar getOwnPropertyDescriptor = require('../internals/object-get-own-property-descriptor').f;\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar defineBuiltIn = require('../internals/define-built-in');\nvar defineGlobalProperty = require('../internals/define-global-property');\nvar copyConstructorProperties = require('../internals/copy-constructor-properties');\nvar isForced = require('../internals/is-forced');\n\n/*\n  options.target         - name of the target object\n  options.global         - target is the global object\n  options.stat           - export as static methods of target\n  options.proto          - export as prototype methods of target\n  options.real           - real prototype method for the `pure` version\n  options.forced         - export even if the native feature is available\n  options.bind           - bind methods to the target, required for the `pure` version\n  options.wrap           - wrap constructors to preventing global pollution, required for the `pure` version\n  options.unsafe         - use the simple assignment of property instead of delete + defineProperty\n  options.sham           - add a flag to not completely full polyfills\n  options.enumerable     - export as enumerable property\n  options.dontCallGetSet - prevent calling a getter on target\n  options.name           - the .name of the function if it does not match the key\n*/\nmodule.exports = function (options, source) {\n  var TARGET = options.target;\n  var GLOBAL = options.global;\n  var STATIC = options.stat;\n  var FORCED, target, key, targetProperty, sourceProperty, descriptor;\n  if (GLOBAL) {\n    target = global;\n  } else if (STATIC) {\n    target = global[TARGET] || defineGlobalProperty(TARGET, {});\n  } else {\n    target = (global[TARGET] || {}).prototype;\n  }\n  if (target) for (key in source) {\n    sourceProperty = source[key];\n    if (options.dontCallGetSet) {\n      descriptor = getOwnPropertyDescriptor(target, key);\n      targetProperty = descriptor && descriptor.value;\n    } else targetProperty = target[key];\n    FORCED = isForced(GLOBAL ? key : TARGET + (STATIC ? '.' : '#') + key, options.forced);\n    // contained in target\n    if (!FORCED && targetProperty !== undefined) {\n      if (typeof sourceProperty == typeof targetProperty) continue;\n      copyConstructorProperties(sourceProperty, targetProperty);\n    }\n    // add a flag to not completely full polyfills\n    if (options.sham || (targetProperty && targetProperty.sham)) {\n      createNonEnumerableProperty(sourceProperty, 'sham', true);\n    }\n    defineBuiltIn(target, key, sourceProperty, options);\n  }\n};\n","module.exports = function (exec) {\n  try {\n    return !!exec();\n  } catch (error) {\n    return true;\n  }\n};\n","'use strict';\n// TODO: Remove from `core-js@4` since it's moved to entry points\nrequire('../modules/es.regexp.exec');\nvar uncurryThis = require('../internals/function-uncurry-this-clause');\nvar defineBuiltIn = require('../internals/define-built-in');\nvar regexpExec = require('../internals/regexp-exec');\nvar fails = require('../internals/fails');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\n\nvar SPECIES = wellKnownSymbol('species');\nvar RegExpPrototype = RegExp.prototype;\n\nmodule.exports = function (KEY, exec, FORCED, SHAM) {\n  var SYMBOL = wellKnownSymbol(KEY);\n\n  var DELEGATES_TO_SYMBOL = !fails(function () {\n    // String methods call symbol-named RegEp methods\n    var O = {};\n    O[SYMBOL] = function () { return 7; };\n    return ''[KEY](O) != 7;\n  });\n\n  var DELEGATES_TO_EXEC = DELEGATES_TO_SYMBOL && !fails(function () {\n    // Symbol-named RegExp methods call .exec\n    var execCalled = false;\n    var re = /a/;\n\n    if (KEY === 'split') {\n      // We can't use real regex here since it causes deoptimization\n      // and serious performance degradation in V8\n      // https://github.com/zloirock/core-js/issues/306\n      re = {};\n      // RegExp[@@split] doesn't call the regex's exec method, but first creates\n      // a new one. We need to return the patched regex when creating the new one.\n      re.constructor = {};\n      re.constructor[SPECIES] = function () { return re; };\n      re.flags = '';\n      re[SYMBOL] = /./[SYMBOL];\n    }\n\n    re.exec = function () { execCalled = true; return null; };\n\n    re[SYMBOL]('');\n    return !execCalled;\n  });\n\n  if (\n    !DELEGATES_TO_SYMBOL ||\n    !DELEGATES_TO_EXEC ||\n    FORCED\n  ) {\n    var uncurriedNativeRegExpMethod = uncurryThis(/./[SYMBOL]);\n    var methods = exec(SYMBOL, ''[KEY], function (nativeMethod, regexp, str, arg2, forceStringMethod) {\n      var uncurriedNativeMethod = uncurryThis(nativeMethod);\n      var $exec = regexp.exec;\n      if ($exec === regexpExec || $exec === RegExpPrototype.exec) {\n        if (DELEGATES_TO_SYMBOL && !forceStringMethod) {\n          // The native String method already delegates to @@method (this\n          // polyfilled function), leasing to infinite recursion.\n          // We avoid it by directly calling the native @@method method.\n          return { done: true, value: uncurriedNativeRegExpMethod(regexp, str, arg2) };\n        }\n        return { done: true, value: uncurriedNativeMethod(str, regexp, arg2) };\n      }\n      return { done: false };\n    });\n\n    defineBuiltIn(String.prototype, KEY, methods[0]);\n    defineBuiltIn(RegExpPrototype, SYMBOL, methods[1]);\n  }\n\n  if (SHAM) createNonEnumerableProperty(RegExpPrototype[SYMBOL], 'sham', true);\n};\n","'use strict';\nvar isArray = require('../internals/is-array');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar doesNotExceedSafeInteger = require('../internals/does-not-exceed-safe-integer');\nvar bind = require('../internals/function-bind-context');\n\n// `FlattenIntoArray` abstract operation\n// https://tc39.github.io/proposal-flatMap/#sec-FlattenIntoArray\nvar flattenIntoArray = function (target, original, source, sourceLen, start, depth, mapper, thisArg) {\n  var targetIndex = start;\n  var sourceIndex = 0;\n  var mapFn = mapper ? bind(mapper, thisArg) : false;\n  var element, elementLen;\n\n  while (sourceIndex < sourceLen) {\n    if (sourceIndex in source) {\n      element = mapFn ? mapFn(source[sourceIndex], sourceIndex, original) : source[sourceIndex];\n\n      if (depth > 0 && isArray(element)) {\n        elementLen = lengthOfArrayLike(element);\n        targetIndex = flattenIntoArray(target, original, element, elementLen, targetIndex, depth - 1) - 1;\n      } else {\n        doesNotExceedSafeInteger(targetIndex + 1);\n        target[targetIndex] = element;\n      }\n\n      targetIndex++;\n    }\n    sourceIndex++;\n  }\n  return targetIndex;\n};\n\nmodule.exports = flattenIntoArray;\n","var NATIVE_BIND = require('../internals/function-bind-native');\n\nvar FunctionPrototype = Function.prototype;\nvar apply = FunctionPrototype.apply;\nvar call = FunctionPrototype.call;\n\n// eslint-disable-next-line es/no-reflect -- safe\nmodule.exports = typeof Reflect == 'object' && Reflect.apply || (NATIVE_BIND ? call.bind(apply) : function () {\n  return call.apply(apply, arguments);\n});\n","var uncurryThis = require('../internals/function-uncurry-this-clause');\nvar aCallable = require('../internals/a-callable');\nvar NATIVE_BIND = require('../internals/function-bind-native');\n\nvar bind = uncurryThis(uncurryThis.bind);\n\n// optional / simple context binding\nmodule.exports = function (fn, that) {\n  aCallable(fn);\n  return that === undefined ? fn : NATIVE_BIND ? bind(fn, that) : function (/* ...args */) {\n    return fn.apply(that, arguments);\n  };\n};\n","var fails = require('../internals/fails');\n\nmodule.exports = !fails(function () {\n  // eslint-disable-next-line es/no-function-prototype-bind -- safe\n  var test = (function () { /* empty */ }).bind();\n  // eslint-disable-next-line no-prototype-builtins -- safe\n  return typeof test != 'function' || test.hasOwnProperty('prototype');\n});\n","var NATIVE_BIND = require('../internals/function-bind-native');\n\nvar call = Function.prototype.call;\n\nmodule.exports = NATIVE_BIND ? call.bind(call) : function () {\n  return call.apply(call, arguments);\n};\n","var DESCRIPTORS = require('../internals/descriptors');\nvar hasOwn = require('../internals/has-own-property');\n\nvar FunctionPrototype = Function.prototype;\n// eslint-disable-next-line es/no-object-getownpropertydescriptor -- safe\nvar getDescriptor = DESCRIPTORS && Object.getOwnPropertyDescriptor;\n\nvar EXISTS = hasOwn(FunctionPrototype, 'name');\n// additional protection from minified / mangled / dropped function names\nvar PROPER = EXISTS && (function something() { /* empty */ }).name === 'something';\nvar CONFIGURABLE = EXISTS && (!DESCRIPTORS || (DESCRIPTORS && getDescriptor(FunctionPrototype, 'name').configurable));\n\nmodule.exports = {\n  EXISTS: EXISTS,\n  PROPER: PROPER,\n  CONFIGURABLE: CONFIGURABLE\n};\n","var classofRaw = require('../internals/classof-raw');\nvar uncurryThis = require('../internals/function-uncurry-this');\n\nmodule.exports = function (fn) {\n  // Nashorn bug:\n  //   https://github.com/zloirock/core-js/issues/1128\n  //   https://github.com/zloirock/core-js/issues/1130\n  if (classofRaw(fn) === 'Function') return uncurryThis(fn);\n};\n","var NATIVE_BIND = require('../internals/function-bind-native');\n\nvar FunctionPrototype = Function.prototype;\nvar call = FunctionPrototype.call;\nvar uncurryThisWithBind = NATIVE_BIND && FunctionPrototype.bind.bind(call, call);\n\nmodule.exports = NATIVE_BIND ? uncurryThisWithBind : function (fn) {\n  return function () {\n    return call.apply(fn, arguments);\n  };\n};\n","var global = require('../internals/global');\nvar isCallable = require('../internals/is-callable');\n\nvar aFunction = function (argument) {\n  return isCallable(argument) ? argument : undefined;\n};\n\nmodule.exports = function (namespace, method) {\n  return arguments.length < 2 ? aFunction(global[namespace]) : global[namespace] && global[namespace][method];\n};\n","var aCallable = require('../internals/a-callable');\nvar isNullOrUndefined = require('../internals/is-null-or-undefined');\n\n// `GetMethod` abstract operation\n// https://tc39.es/ecma262/#sec-getmethod\nmodule.exports = function (V, P) {\n  var func = V[P];\n  return isNullOrUndefined(func) ? undefined : aCallable(func);\n};\n","var uncurryThis = require('../internals/function-uncurry-this');\nvar toObject = require('../internals/to-object');\n\nvar floor = Math.floor;\nvar charAt = uncurryThis(''.charAt);\nvar replace = uncurryThis(''.replace);\nvar stringSlice = uncurryThis(''.slice);\n// eslint-disable-next-line redos/no-vulnerable -- safe\nvar SUBSTITUTION_SYMBOLS = /\\$([$&'`]|\\d{1,2}|<[^>]*>)/g;\nvar SUBSTITUTION_SYMBOLS_NO_NAMED = /\\$([$&'`]|\\d{1,2})/g;\n\n// `GetSubstitution` abstract operation\n// https://tc39.es/ecma262/#sec-getsubstitution\nmodule.exports = function (matched, str, position, captures, namedCaptures, replacement) {\n  var tailPos = position + matched.length;\n  var m = captures.length;\n  var symbols = SUBSTITUTION_SYMBOLS_NO_NAMED;\n  if (namedCaptures !== undefined) {\n    namedCaptures = toObject(namedCaptures);\n    symbols = SUBSTITUTION_SYMBOLS;\n  }\n  return replace(replacement, symbols, function (match, ch) {\n    var capture;\n    switch (charAt(ch, 0)) {\n      case '$': return '$';\n      case '&': return matched;\n      case '`': return stringSlice(str, 0, position);\n      case \"'\": return stringSlice(str, tailPos);\n      case '<':\n        capture = namedCaptures[stringSlice(ch, 1, -1)];\n        break;\n      default: // \\d\\d?\n        var n = +ch;\n        if (n === 0) return match;\n        if (n > m) {\n          var f = floor(n / 10);\n          if (f === 0) return match;\n          if (f <= m) return captures[f - 1] === undefined ? charAt(ch, 1) : captures[f - 1] + charAt(ch, 1);\n          return match;\n        }\n        capture = captures[n - 1];\n    }\n    return capture === undefined ? '' : capture;\n  });\n};\n","var check = function (it) {\n  return it && it.Math == Math && it;\n};\n\n// https://github.com/zloirock/core-js/issues/86#issuecomment-115759028\nmodule.exports =\n  // eslint-disable-next-line es/no-global-this -- safe\n  check(typeof globalThis == 'object' && globalThis) ||\n  check(typeof window == 'object' && window) ||\n  // eslint-disable-next-line no-restricted-globals -- safe\n  check(typeof self == 'object' && self) ||\n  check(typeof global == 'object' && global) ||\n  // eslint-disable-next-line no-new-func -- fallback\n  (function () { return this; })() || Function('return this')();\n","var uncurryThis = require('../internals/function-uncurry-this');\nvar toObject = require('../internals/to-object');\n\nvar hasOwnProperty = uncurryThis({}.hasOwnProperty);\n\n// `HasOwnProperty` abstract operation\n// https://tc39.es/ecma262/#sec-hasownproperty\n// eslint-disable-next-line es/no-object-hasown -- safe\nmodule.exports = Object.hasOwn || function hasOwn(it, key) {\n  return hasOwnProperty(toObject(it), key);\n};\n","module.exports = {};\n","var getBuiltIn = require('../internals/get-built-in');\n\nmodule.exports = getBuiltIn('document', 'documentElement');\n","var DESCRIPTORS = require('../internals/descriptors');\nvar fails = require('../internals/fails');\nvar createElement = require('../internals/document-create-element');\n\n// Thanks to IE8 for its funny defineProperty\nmodule.exports = !DESCRIPTORS && !fails(function () {\n  // eslint-disable-next-line es/no-object-defineproperty -- required for testing\n  return Object.defineProperty(createElement('div'), 'a', {\n    get: function () { return 7; }\n  }).a != 7;\n});\n","var uncurryThis = require('../internals/function-uncurry-this');\nvar fails = require('../internals/fails');\nvar classof = require('../internals/classof-raw');\n\nvar $Object = Object;\nvar split = uncurryThis(''.split);\n\n// fallback for non-array-like ES3 and non-enumerable old V8 strings\nmodule.exports = fails(function () {\n  // throws an error in rhino, see https://github.com/mozilla/rhino/issues/346\n  // eslint-disable-next-line no-prototype-builtins -- safe\n  return !$Object('z').propertyIsEnumerable(0);\n}) ? function (it) {\n  return classof(it) == 'String' ? split(it, '') : $Object(it);\n} : $Object;\n","var uncurryThis = require('../internals/function-uncurry-this');\nvar isCallable = require('../internals/is-callable');\nvar store = require('../internals/shared-store');\n\nvar functionToString = uncurryThis(Function.toString);\n\n// this helper broken in `core-js@3.4.1-3.4.4`, so we can't use `shared` helper\nif (!isCallable(store.inspectSource)) {\n  store.inspectSource = function (it) {\n    return functionToString(it);\n  };\n}\n\nmodule.exports = store.inspectSource;\n","var NATIVE_WEAK_MAP = require('../internals/weak-map-basic-detection');\nvar global = require('../internals/global');\nvar isObject = require('../internals/is-object');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar hasOwn = require('../internals/has-own-property');\nvar shared = require('../internals/shared-store');\nvar sharedKey = require('../internals/shared-key');\nvar hiddenKeys = require('../internals/hidden-keys');\n\nvar OBJECT_ALREADY_INITIALIZED = 'Object already initialized';\nvar TypeError = global.TypeError;\nvar WeakMap = global.WeakMap;\nvar set, get, has;\n\nvar enforce = function (it) {\n  return has(it) ? get(it) : set(it, {});\n};\n\nvar getterFor = function (TYPE) {\n  return function (it) {\n    var state;\n    if (!isObject(it) || (state = get(it)).type !== TYPE) {\n      throw TypeError('Incompatible receiver, ' + TYPE + ' required');\n    } return state;\n  };\n};\n\nif (NATIVE_WEAK_MAP || shared.state) {\n  var store = shared.state || (shared.state = new WeakMap());\n  /* eslint-disable no-self-assign -- prototype methods protection */\n  store.get = store.get;\n  store.has = store.has;\n  store.set = store.set;\n  /* eslint-enable no-self-assign -- prototype methods protection */\n  set = function (it, metadata) {\n    if (store.has(it)) throw TypeError(OBJECT_ALREADY_INITIALIZED);\n    metadata.facade = it;\n    store.set(it, metadata);\n    return metadata;\n  };\n  get = function (it) {\n    return store.get(it) || {};\n  };\n  has = function (it) {\n    return store.has(it);\n  };\n} else {\n  var STATE = sharedKey('state');\n  hiddenKeys[STATE] = true;\n  set = function (it, metadata) {\n    if (hasOwn(it, STATE)) throw TypeError(OBJECT_ALREADY_INITIALIZED);\n    metadata.facade = it;\n    createNonEnumerableProperty(it, STATE, metadata);\n    return metadata;\n  };\n  get = function (it) {\n    return hasOwn(it, STATE) ? it[STATE] : {};\n  };\n  has = function (it) {\n    return hasOwn(it, STATE);\n  };\n}\n\nmodule.exports = {\n  set: set,\n  get: get,\n  has: has,\n  enforce: enforce,\n  getterFor: getterFor\n};\n","var classof = require('../internals/classof-raw');\n\n// `IsArray` abstract operation\n// https://tc39.es/ecma262/#sec-isarray\n// eslint-disable-next-line es/no-array-isarray -- safe\nmodule.exports = Array.isArray || function isArray(argument) {\n  return classof(argument) == 'Array';\n};\n","var $documentAll = require('../internals/document-all');\n\nvar documentAll = $documentAll.all;\n\n// `IsCallable` abstract operation\n// https://tc39.es/ecma262/#sec-iscallable\nmodule.exports = $documentAll.IS_HTMLDDA ? function (argument) {\n  return typeof argument == 'function' || argument === documentAll;\n} : function (argument) {\n  return typeof argument == 'function';\n};\n","var uncurryThis = require('../internals/function-uncurry-this');\nvar fails = require('../internals/fails');\nvar isCallable = require('../internals/is-callable');\nvar classof = require('../internals/classof');\nvar getBuiltIn = require('../internals/get-built-in');\nvar inspectSource = require('../internals/inspect-source');\n\nvar noop = function () { /* empty */ };\nvar empty = [];\nvar construct = getBuiltIn('Reflect', 'construct');\nvar constructorRegExp = /^\\s*(?:class|function)\\b/;\nvar exec = uncurryThis(constructorRegExp.exec);\nvar INCORRECT_TO_STRING = !constructorRegExp.exec(noop);\n\nvar isConstructorModern = function isConstructor(argument) {\n  if (!isCallable(argument)) return false;\n  try {\n    construct(noop, empty, argument);\n    return true;\n  } catch (error) {\n    return false;\n  }\n};\n\nvar isConstructorLegacy = function isConstructor(argument) {\n  if (!isCallable(argument)) return false;\n  switch (classof(argument)) {\n    case 'AsyncFunction':\n    case 'GeneratorFunction':\n    case 'AsyncGeneratorFunction': return false;\n  }\n  try {\n    // we can't check .prototype since constructors produced by .bind haven't it\n    // `Function#toString` throws on some built-it function in some legacy engines\n    // (for example, `DOMQuad` and similar in FF41-)\n    return INCORRECT_TO_STRING || !!exec(constructorRegExp, inspectSource(argument));\n  } catch (error) {\n    return true;\n  }\n};\n\nisConstructorLegacy.sham = true;\n\n// `IsConstructor` abstract operation\n// https://tc39.es/ecma262/#sec-isconstructor\nmodule.exports = !construct || fails(function () {\n  var called;\n  return isConstructorModern(isConstructorModern.call)\n    || !isConstructorModern(Object)\n    || !isConstructorModern(function () { called = true; })\n    || called;\n}) ? isConstructorLegacy : isConstructorModern;\n","var fails = require('../internals/fails');\nvar isCallable = require('../internals/is-callable');\n\nvar replacement = /#|\\.prototype\\./;\n\nvar isForced = function (feature, detection) {\n  var value = data[normalize(feature)];\n  return value == POLYFILL ? true\n    : value == NATIVE ? false\n    : isCallable(detection) ? fails(detection)\n    : !!detection;\n};\n\nvar normalize = isForced.normalize = function (string) {\n  return String(string).replace(replacement, '.').toLowerCase();\n};\n\nvar data = isForced.data = {};\nvar NATIVE = isForced.NATIVE = 'N';\nvar POLYFILL = isForced.POLYFILL = 'P';\n\nmodule.exports = isForced;\n","// we can't use just `it == null` since of `document.all` special case\n// https://tc39.es/ecma262/#sec-IsHTMLDDA-internal-slot-aec\nmodule.exports = function (it) {\n  return it === null || it === undefined;\n};\n","var isCallable = require('../internals/is-callable');\nvar $documentAll = require('../internals/document-all');\n\nvar documentAll = $documentAll.all;\n\nmodule.exports = $documentAll.IS_HTMLDDA ? function (it) {\n  return typeof it == 'object' ? it !== null : isCallable(it) || it === documentAll;\n} : function (it) {\n  return typeof it == 'object' ? it !== null : isCallable(it);\n};\n","module.exports = false;\n","var getBuiltIn = require('../internals/get-built-in');\nvar isCallable = require('../internals/is-callable');\nvar isPrototypeOf = require('../internals/object-is-prototype-of');\nvar USE_SYMBOL_AS_UID = require('../internals/use-symbol-as-uid');\n\nvar $Object = Object;\n\nmodule.exports = USE_SYMBOL_AS_UID ? function (it) {\n  return typeof it == 'symbol';\n} : function (it) {\n  var $Symbol = getBuiltIn('Symbol');\n  return isCallable($Symbol) && isPrototypeOf($Symbol.prototype, $Object(it));\n};\n","var toLength = require('../internals/to-length');\n\n// `LengthOfArrayLike` abstract operation\n// https://tc39.es/ecma262/#sec-lengthofarraylike\nmodule.exports = function (obj) {\n  return toLength(obj.length);\n};\n","var uncurryThis = require('../internals/function-uncurry-this');\nvar fails = require('../internals/fails');\nvar isCallable = require('../internals/is-callable');\nvar hasOwn = require('../internals/has-own-property');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar CONFIGURABLE_FUNCTION_NAME = require('../internals/function-name').CONFIGURABLE;\nvar inspectSource = require('../internals/inspect-source');\nvar InternalStateModule = require('../internals/internal-state');\n\nvar enforceInternalState = InternalStateModule.enforce;\nvar getInternalState = InternalStateModule.get;\nvar $String = String;\n// eslint-disable-next-line es/no-object-defineproperty -- safe\nvar defineProperty = Object.defineProperty;\nvar stringSlice = uncurryThis(''.slice);\nvar replace = uncurryThis(''.replace);\nvar join = uncurryThis([].join);\n\nvar CONFIGURABLE_LENGTH = DESCRIPTORS && !fails(function () {\n  return defineProperty(function () { /* empty */ }, 'length', { value: 8 }).length !== 8;\n});\n\nvar TEMPLATE = String(String).split('String');\n\nvar makeBuiltIn = module.exports = function (value, name, options) {\n  if (stringSlice($String(name), 0, 7) === 'Symbol(') {\n    name = '[' + replace($String(name), /^Symbol\\(([^)]*)\\)/, '$1') + ']';\n  }\n  if (options && options.getter) name = 'get ' + name;\n  if (options && options.setter) name = 'set ' + name;\n  if (!hasOwn(value, 'name') || (CONFIGURABLE_FUNCTION_NAME && value.name !== name)) {\n    if (DESCRIPTORS) defineProperty(value, 'name', { value: name, configurable: true });\n    else value.name = name;\n  }\n  if (CONFIGURABLE_LENGTH && options && hasOwn(options, 'arity') && value.length !== options.arity) {\n    defineProperty(value, 'length', { value: options.arity });\n  }\n  try {\n    if (options && hasOwn(options, 'constructor') && options.constructor) {\n      if (DESCRIPTORS) defineProperty(value, 'prototype', { writable: false });\n    // in V8 ~ Chrome 53, prototypes of some methods, like `Array.prototype.values`, are non-writable\n    } else if (value.prototype) value.prototype = undefined;\n  } catch (error) { /* empty */ }\n  var state = enforceInternalState(value);\n  if (!hasOwn(state, 'source')) {\n    state.source = join(TEMPLATE, typeof name == 'string' ? name : '');\n  } return value;\n};\n\n// add fake Function#toString for correct work wrapped methods / constructors with methods like LoDash isNative\n// eslint-disable-next-line no-extend-native -- required\nFunction.prototype.toString = makeBuiltIn(function toString() {\n  return isCallable(this) && getInternalState(this).source || inspectSource(this);\n}, 'toString');\n","var ceil = Math.ceil;\nvar floor = Math.floor;\n\n// `Math.trunc` method\n// https://tc39.es/ecma262/#sec-math.trunc\n// eslint-disable-next-line es/no-math-trunc -- safe\nmodule.exports = Math.trunc || function trunc(x) {\n  var n = +x;\n  return (n > 0 ? floor : ceil)(n);\n};\n","/* global ActiveXObject -- old IE, WSH */\nvar anObject = require('../internals/an-object');\nvar definePropertiesModule = require('../internals/object-define-properties');\nvar enumBugKeys = require('../internals/enum-bug-keys');\nvar hiddenKeys = require('../internals/hidden-keys');\nvar html = require('../internals/html');\nvar documentCreateElement = require('../internals/document-create-element');\nvar sharedKey = require('../internals/shared-key');\n\nvar GT = '>';\nvar LT = '<';\nvar PROTOTYPE = 'prototype';\nvar SCRIPT = 'script';\nvar IE_PROTO = sharedKey('IE_PROTO');\n\nvar EmptyConstructor = function () { /* empty */ };\n\nvar scriptTag = function (content) {\n  return LT + SCRIPT + GT + content + LT + '/' + SCRIPT + GT;\n};\n\n// Create object with fake `null` prototype: use ActiveX Object with cleared prototype\nvar NullProtoObjectViaActiveX = function (activeXDocument) {\n  activeXDocument.write(scriptTag(''));\n  activeXDocument.close();\n  var temp = activeXDocument.parentWindow.Object;\n  activeXDocument = null; // avoid memory leak\n  return temp;\n};\n\n// Create object with fake `null` prototype: use iframe Object with cleared prototype\nvar NullProtoObjectViaIFrame = function () {\n  // Thrash, waste and sodomy: IE GC bug\n  var iframe = documentCreateElement('iframe');\n  var JS = 'java' + SCRIPT + ':';\n  var iframeDocument;\n  iframe.style.display = 'none';\n  html.appendChild(iframe);\n  // https://github.com/zloirock/core-js/issues/475\n  iframe.src = String(JS);\n  iframeDocument = iframe.contentWindow.document;\n  iframeDocument.open();\n  iframeDocument.write(scriptTag('document.F=Object'));\n  iframeDocument.close();\n  return iframeDocument.F;\n};\n\n// Check for document.domain and active x support\n// No need to use active x approach when document.domain is not set\n// see https://github.com/es-shims/es5-shim/issues/150\n// variation of https://github.com/kitcambridge/es5-shim/commit/4f738ac066346\n// avoid IE GC bug\nvar activeXDocument;\nvar NullProtoObject = function () {\n  try {\n    activeXDocument = new ActiveXObject('htmlfile');\n  } catch (error) { /* ignore */ }\n  NullProtoObject = typeof document != 'undefined'\n    ? document.domain && activeXDocument\n      ? NullProtoObjectViaActiveX(activeXDocument) // old IE\n      : NullProtoObjectViaIFrame()\n    : NullProtoObjectViaActiveX(activeXDocument); // WSH\n  var length = enumBugKeys.length;\n  while (length--) delete NullProtoObject[PROTOTYPE][enumBugKeys[length]];\n  return NullProtoObject();\n};\n\nhiddenKeys[IE_PROTO] = true;\n\n// `Object.create` method\n// https://tc39.es/ecma262/#sec-object.create\n// eslint-disable-next-line es/no-object-create -- safe\nmodule.exports = Object.create || function create(O, Properties) {\n  var result;\n  if (O !== null) {\n    EmptyConstructor[PROTOTYPE] = anObject(O);\n    result = new EmptyConstructor();\n    EmptyConstructor[PROTOTYPE] = null;\n    // add \"__proto__\" for Object.getPrototypeOf polyfill\n    result[IE_PROTO] = O;\n  } else result = NullProtoObject();\n  return Properties === undefined ? result : definePropertiesModule.f(result, Properties);\n};\n","var DESCRIPTORS = require('../internals/descriptors');\nvar V8_PROTOTYPE_DEFINE_BUG = require('../internals/v8-prototype-define-bug');\nvar definePropertyModule = require('../internals/object-define-property');\nvar anObject = require('../internals/an-object');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar objectKeys = require('../internals/object-keys');\n\n// `Object.defineProperties` method\n// https://tc39.es/ecma262/#sec-object.defineproperties\n// eslint-disable-next-line es/no-object-defineproperties -- safe\nexports.f = DESCRIPTORS && !V8_PROTOTYPE_DEFINE_BUG ? Object.defineProperties : function defineProperties(O, Properties) {\n  anObject(O);\n  var props = toIndexedObject(Properties);\n  var keys = objectKeys(Properties);\n  var length = keys.length;\n  var index = 0;\n  var key;\n  while (length > index) definePropertyModule.f(O, key = keys[index++], props[key]);\n  return O;\n};\n","var DESCRIPTORS = require('../internals/descriptors');\nvar IE8_DOM_DEFINE = require('../internals/ie8-dom-define');\nvar V8_PROTOTYPE_DEFINE_BUG = require('../internals/v8-prototype-define-bug');\nvar anObject = require('../internals/an-object');\nvar toPropertyKey = require('../internals/to-property-key');\n\nvar $TypeError = TypeError;\n// eslint-disable-next-line es/no-object-defineproperty -- safe\nvar $defineProperty = Object.defineProperty;\n// eslint-disable-next-line es/no-object-getownpropertydescriptor -- safe\nvar $getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\nvar ENUMERABLE = 'enumerable';\nvar CONFIGURABLE = 'configurable';\nvar WRITABLE = 'writable';\n\n// `Object.defineProperty` method\n// https://tc39.es/ecma262/#sec-object.defineproperty\nexports.f = DESCRIPTORS ? V8_PROTOTYPE_DEFINE_BUG ? function defineProperty(O, P, Attributes) {\n  anObject(O);\n  P = toPropertyKey(P);\n  anObject(Attributes);\n  if (typeof O === 'function' && P === 'prototype' && 'value' in Attributes && WRITABLE in Attributes && !Attributes[WRITABLE]) {\n    var current = $getOwnPropertyDescriptor(O, P);\n    if (current && current[WRITABLE]) {\n      O[P] = Attributes.value;\n      Attributes = {\n        configurable: CONFIGURABLE in Attributes ? Attributes[CONFIGURABLE] : current[CONFIGURABLE],\n        enumerable: ENUMERABLE in Attributes ? Attributes[ENUMERABLE] : current[ENUMERABLE],\n        writable: false\n      };\n    }\n  } return $defineProperty(O, P, Attributes);\n} : $defineProperty : function defineProperty(O, P, Attributes) {\n  anObject(O);\n  P = toPropertyKey(P);\n  anObject(Attributes);\n  if (IE8_DOM_DEFINE) try {\n    return $defineProperty(O, P, Attributes);\n  } catch (error) { /* empty */ }\n  if ('get' in Attributes || 'set' in Attributes) throw $TypeError('Accessors not supported');\n  if ('value' in Attributes) O[P] = Attributes.value;\n  return O;\n};\n","var DESCRIPTORS = require('../internals/descriptors');\nvar call = require('../internals/function-call');\nvar propertyIsEnumerableModule = require('../internals/object-property-is-enumerable');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar toPropertyKey = require('../internals/to-property-key');\nvar hasOwn = require('../internals/has-own-property');\nvar IE8_DOM_DEFINE = require('../internals/ie8-dom-define');\n\n// eslint-disable-next-line es/no-object-getownpropertydescriptor -- safe\nvar $getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\n\n// `Object.getOwnPropertyDescriptor` method\n// https://tc39.es/ecma262/#sec-object.getownpropertydescriptor\nexports.f = DESCRIPTORS ? $getOwnPropertyDescriptor : function getOwnPropertyDescriptor(O, P) {\n  O = toIndexedObject(O);\n  P = toPropertyKey(P);\n  if (IE8_DOM_DEFINE) try {\n    return $getOwnPropertyDescriptor(O, P);\n  } catch (error) { /* empty */ }\n  if (hasOwn(O, P)) return createPropertyDescriptor(!call(propertyIsEnumerableModule.f, O, P), O[P]);\n};\n","var internalObjectKeys = require('../internals/object-keys-internal');\nvar enumBugKeys = require('../internals/enum-bug-keys');\n\nvar hiddenKeys = enumBugKeys.concat('length', 'prototype');\n\n// `Object.getOwnPropertyNames` method\n// https://tc39.es/ecma262/#sec-object.getownpropertynames\n// eslint-disable-next-line es/no-object-getownpropertynames -- safe\nexports.f = Object.getOwnPropertyNames || function getOwnPropertyNames(O) {\n  return internalObjectKeys(O, hiddenKeys);\n};\n","// eslint-disable-next-line es/no-object-getownpropertysymbols -- safe\nexports.f = Object.getOwnPropertySymbols;\n","var uncurryThis = require('../internals/function-uncurry-this');\n\nmodule.exports = uncurryThis({}.isPrototypeOf);\n","var uncurryThis = require('../internals/function-uncurry-this');\nvar hasOwn = require('../internals/has-own-property');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar indexOf = require('../internals/array-includes').indexOf;\nvar hiddenKeys = require('../internals/hidden-keys');\n\nvar push = uncurryThis([].push);\n\nmodule.exports = function (object, names) {\n  var O = toIndexedObject(object);\n  var i = 0;\n  var result = [];\n  var key;\n  for (key in O) !hasOwn(hiddenKeys, key) && hasOwn(O, key) && push(result, key);\n  // Don't enum bug & hidden keys\n  while (names.length > i) if (hasOwn(O, key = names[i++])) {\n    ~indexOf(result, key) || push(result, key);\n  }\n  return result;\n};\n","var internalObjectKeys = require('../internals/object-keys-internal');\nvar enumBugKeys = require('../internals/enum-bug-keys');\n\n// `Object.keys` method\n// https://tc39.es/ecma262/#sec-object.keys\n// eslint-disable-next-line es/no-object-keys -- safe\nmodule.exports = Object.keys || function keys(O) {\n  return internalObjectKeys(O, enumBugKeys);\n};\n","'use strict';\nvar $propertyIsEnumerable = {}.propertyIsEnumerable;\n// eslint-disable-next-line es/no-object-getownpropertydescriptor -- safe\nvar getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\n\n// Nashorn ~ JDK8 bug\nvar NASHORN_BUG = getOwnPropertyDescriptor && !$propertyIsEnumerable.call({ 1: 2 }, 1);\n\n// `Object.prototype.propertyIsEnumerable` method implementation\n// https://tc39.es/ecma262/#sec-object.prototype.propertyisenumerable\nexports.f = NASHORN_BUG ? function propertyIsEnumerable(V) {\n  var descriptor = getOwnPropertyDescriptor(this, V);\n  return !!descriptor && descriptor.enumerable;\n} : $propertyIsEnumerable;\n","var call = require('../internals/function-call');\nvar isCallable = require('../internals/is-callable');\nvar isObject = require('../internals/is-object');\n\nvar $TypeError = TypeError;\n\n// `OrdinaryToPrimitive` abstract operation\n// https://tc39.es/ecma262/#sec-ordinarytoprimitive\nmodule.exports = function (input, pref) {\n  var fn, val;\n  if (pref === 'string' && isCallable(fn = input.toString) && !isObject(val = call(fn, input))) return val;\n  if (isCallable(fn = input.valueOf) && !isObject(val = call(fn, input))) return val;\n  if (pref !== 'string' && isCallable(fn = input.toString) && !isObject(val = call(fn, input))) return val;\n  throw $TypeError(\"Can't convert object to primitive value\");\n};\n","var getBuiltIn = require('../internals/get-built-in');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar getOwnPropertyNamesModule = require('../internals/object-get-own-property-names');\nvar getOwnPropertySymbolsModule = require('../internals/object-get-own-property-symbols');\nvar anObject = require('../internals/an-object');\n\nvar concat = uncurryThis([].concat);\n\n// all object keys, includes non-enumerable and symbols\nmodule.exports = getBuiltIn('Reflect', 'ownKeys') || function ownKeys(it) {\n  var keys = getOwnPropertyNamesModule.f(anObject(it));\n  var getOwnPropertySymbols = getOwnPropertySymbolsModule.f;\n  return getOwnPropertySymbols ? concat(keys, getOwnPropertySymbols(it)) : keys;\n};\n","var call = require('../internals/function-call');\nvar anObject = require('../internals/an-object');\nvar isCallable = require('../internals/is-callable');\nvar classof = require('../internals/classof-raw');\nvar regexpExec = require('../internals/regexp-exec');\n\nvar $TypeError = TypeError;\n\n// `RegExpExec` abstract operation\n// https://tc39.es/ecma262/#sec-regexpexec\nmodule.exports = function (R, S) {\n  var exec = R.exec;\n  if (isCallable(exec)) {\n    var result = call(exec, R, S);\n    if (result !== null) anObject(result);\n    return result;\n  }\n  if (classof(R) === 'RegExp') return call(regexpExec, R, S);\n  throw $TypeError('RegExp#exec called on incompatible receiver');\n};\n","'use strict';\n/* eslint-disable regexp/no-empty-capturing-group, regexp/no-empty-group, regexp/no-lazy-ends -- testing */\n/* eslint-disable regexp/no-useless-quantifier -- testing */\nvar call = require('../internals/function-call');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar toString = require('../internals/to-string');\nvar regexpFlags = require('../internals/regexp-flags');\nvar stickyHelpers = require('../internals/regexp-sticky-helpers');\nvar shared = require('../internals/shared');\nvar create = require('../internals/object-create');\nvar getInternalState = require('../internals/internal-state').get;\nvar UNSUPPORTED_DOT_ALL = require('../internals/regexp-unsupported-dot-all');\nvar UNSUPPORTED_NCG = require('../internals/regexp-unsupported-ncg');\n\nvar nativeReplace = shared('native-string-replace', String.prototype.replace);\nvar nativeExec = RegExp.prototype.exec;\nvar patchedExec = nativeExec;\nvar charAt = uncurryThis(''.charAt);\nvar indexOf = uncurryThis(''.indexOf);\nvar replace = uncurryThis(''.replace);\nvar stringSlice = uncurryThis(''.slice);\n\nvar UPDATES_LAST_INDEX_WRONG = (function () {\n  var re1 = /a/;\n  var re2 = /b*/g;\n  call(nativeExec, re1, 'a');\n  call(nativeExec, re2, 'a');\n  return re1.lastIndex !== 0 || re2.lastIndex !== 0;\n})();\n\nvar UNSUPPORTED_Y = stickyHelpers.BROKEN_CARET;\n\n// nonparticipating capturing group, copied from es5-shim's String#split patch.\nvar NPCG_INCLUDED = /()??/.exec('')[1] !== undefined;\n\nvar PATCH = UPDATES_LAST_INDEX_WRONG || NPCG_INCLUDED || UNSUPPORTED_Y || UNSUPPORTED_DOT_ALL || UNSUPPORTED_NCG;\n\nif (PATCH) {\n  patchedExec = function exec(string) {\n    var re = this;\n    var state = getInternalState(re);\n    var str = toString(string);\n    var raw = state.raw;\n    var result, reCopy, lastIndex, match, i, object, group;\n\n    if (raw) {\n      raw.lastIndex = re.lastIndex;\n      result = call(patchedExec, raw, str);\n      re.lastIndex = raw.lastIndex;\n      return result;\n    }\n\n    var groups = state.groups;\n    var sticky = UNSUPPORTED_Y && re.sticky;\n    var flags = call(regexpFlags, re);\n    var source = re.source;\n    var charsAdded = 0;\n    var strCopy = str;\n\n    if (sticky) {\n      flags = replace(flags, 'y', '');\n      if (indexOf(flags, 'g') === -1) {\n        flags += 'g';\n      }\n\n      strCopy = stringSlice(str, re.lastIndex);\n      // Support anchored sticky behavior.\n      if (re.lastIndex > 0 && (!re.multiline || re.multiline && charAt(str, re.lastIndex - 1) !== '\\n')) {\n        source = '(?: ' + source + ')';\n        strCopy = ' ' + strCopy;\n        charsAdded++;\n      }\n      // ^(? + rx + ) is needed, in combination with some str slicing, to\n      // simulate the 'y' flag.\n      reCopy = new RegExp('^(?:' + source + ')', flags);\n    }\n\n    if (NPCG_INCLUDED) {\n      reCopy = new RegExp('^' + source + '$(?!\\\\s)', flags);\n    }\n    if (UPDATES_LAST_INDEX_WRONG) lastIndex = re.lastIndex;\n\n    match = call(nativeExec, sticky ? reCopy : re, strCopy);\n\n    if (sticky) {\n      if (match) {\n        match.input = stringSlice(match.input, charsAdded);\n        match[0] = stringSlice(match[0], charsAdded);\n        match.index = re.lastIndex;\n        re.lastIndex += match[0].length;\n      } else re.lastIndex = 0;\n    } else if (UPDATES_LAST_INDEX_WRONG && match) {\n      re.lastIndex = re.global ? match.index + match[0].length : lastIndex;\n    }\n    if (NPCG_INCLUDED && match && match.length > 1) {\n      // Fix browsers whose `exec` methods don't consistently return `undefined`\n      // for NPCG, like IE8. NOTE: This doesn't work for /(.?)?/\n      call(nativeReplace, match[0], reCopy, function () {\n        for (i = 1; i < arguments.length - 2; i++) {\n          if (arguments[i] === undefined) match[i] = undefined;\n        }\n      });\n    }\n\n    if (match && groups) {\n      match.groups = object = create(null);\n      for (i = 0; i < groups.length; i++) {\n        group = groups[i];\n        object[group[0]] = match[group[1]];\n      }\n    }\n\n    return match;\n  };\n}\n\nmodule.exports = patchedExec;\n","'use strict';\nvar anObject = require('../internals/an-object');\n\n// `RegExp.prototype.flags` getter implementation\n// https://tc39.es/ecma262/#sec-get-regexp.prototype.flags\nmodule.exports = function () {\n  var that = anObject(this);\n  var result = '';\n  if (that.hasIndices) result += 'd';\n  if (that.global) result += 'g';\n  if (that.ignoreCase) result += 'i';\n  if (that.multiline) result += 'm';\n  if (that.dotAll) result += 's';\n  if (that.unicode) result += 'u';\n  if (that.unicodeSets) result += 'v';\n  if (that.sticky) result += 'y';\n  return result;\n};\n","var fails = require('../internals/fails');\nvar global = require('../internals/global');\n\n// babel-minify and Closure Compiler transpiles RegExp('a', 'y') -> /a/y and it causes SyntaxError\nvar $RegExp = global.RegExp;\n\nvar UNSUPPORTED_Y = fails(function () {\n  var re = $RegExp('a', 'y');\n  re.lastIndex = 2;\n  return re.exec('abcd') != null;\n});\n\n// UC Browser bug\n// https://github.com/zloirock/core-js/issues/1008\nvar MISSED_STICKY = UNSUPPORTED_Y || fails(function () {\n  return !$RegExp('a', 'y').sticky;\n});\n\nvar BROKEN_CARET = UNSUPPORTED_Y || fails(function () {\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=773687\n  var re = $RegExp('^r', 'gy');\n  re.lastIndex = 2;\n  return re.exec('str') != null;\n});\n\nmodule.exports = {\n  BROKEN_CARET: BROKEN_CARET,\n  MISSED_STICKY: MISSED_STICKY,\n  UNSUPPORTED_Y: UNSUPPORTED_Y\n};\n","var fails = require('../internals/fails');\nvar global = require('../internals/global');\n\n// babel-minify and Closure Compiler transpiles RegExp('.', 's') -> /./s and it causes SyntaxError\nvar $RegExp = global.RegExp;\n\nmodule.exports = fails(function () {\n  var re = $RegExp('.', 's');\n  return !(re.dotAll && re.exec('\\n') && re.flags === 's');\n});\n","var fails = require('../internals/fails');\nvar global = require('../internals/global');\n\n// babel-minify and Closure Compiler transpiles RegExp('(?<a>b)', 'g') -> /(?<a>b)/g and it causes SyntaxError\nvar $RegExp = global.RegExp;\n\nmodule.exports = fails(function () {\n  var re = $RegExp('(?<a>b)', 'g');\n  return re.exec('b').groups.a !== 'b' ||\n    'b'.replace(re, '$<a>c') !== 'bc';\n});\n","var isNullOrUndefined = require('../internals/is-null-or-undefined');\n\nvar $TypeError = TypeError;\n\n// `RequireObjectCoercible` abstract operation\n// https://tc39.es/ecma262/#sec-requireobjectcoercible\nmodule.exports = function (it) {\n  if (isNullOrUndefined(it)) throw $TypeError(\"Can't call method on \" + it);\n  return it;\n};\n","var shared = require('../internals/shared');\nvar uid = require('../internals/uid');\n\nvar keys = shared('keys');\n\nmodule.exports = function (key) {\n  return keys[key] || (keys[key] = uid(key));\n};\n","var global = require('../internals/global');\nvar defineGlobalProperty = require('../internals/define-global-property');\n\nvar SHARED = '__core-js_shared__';\nvar store = global[SHARED] || defineGlobalProperty(SHARED, {});\n\nmodule.exports = store;\n","var IS_PURE = require('../internals/is-pure');\nvar store = require('../internals/shared-store');\n\n(module.exports = function (key, value) {\n  return store[key] || (store[key] = value !== undefined ? value : {});\n})('versions', []).push({\n  version: '3.30.1',\n  mode: IS_PURE ? 'pure' : 'global',\n  copyright: ' 2014-2023 Denis Pushkarev (zloirock.ru)',\n  license: 'https://github.com/zloirock/core-js/blob/v3.30.1/LICENSE',\n  source: 'https://github.com/zloirock/core-js'\n});\n","var uncurryThis = require('../internals/function-uncurry-this');\nvar toIntegerOrInfinity = require('../internals/to-integer-or-infinity');\nvar toString = require('../internals/to-string');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\n\nvar charAt = uncurryThis(''.charAt);\nvar charCodeAt = uncurryThis(''.charCodeAt);\nvar stringSlice = uncurryThis(''.slice);\n\nvar createMethod = function (CONVERT_TO_STRING) {\n  return function ($this, pos) {\n    var S = toString(requireObjectCoercible($this));\n    var position = toIntegerOrInfinity(pos);\n    var size = S.length;\n    var first, second;\n    if (position < 0 || position >= size) return CONVERT_TO_STRING ? '' : undefined;\n    first = charCodeAt(S, position);\n    return first < 0xD800 || first > 0xDBFF || position + 1 === size\n      || (second = charCodeAt(S, position + 1)) < 0xDC00 || second > 0xDFFF\n        ? CONVERT_TO_STRING\n          ? charAt(S, position)\n          : first\n        : CONVERT_TO_STRING\n          ? stringSlice(S, position, position + 2)\n          : (first - 0xD800 << 10) + (second - 0xDC00) + 0x10000;\n  };\n};\n\nmodule.exports = {\n  // `String.prototype.codePointAt` method\n  // https://tc39.es/ecma262/#sec-string.prototype.codepointat\n  codeAt: createMethod(false),\n  // `String.prototype.at` method\n  // https://github.com/mathiasbynens/String.prototype.at\n  charAt: createMethod(true)\n};\n","/* eslint-disable es/no-symbol -- required for testing */\nvar V8_VERSION = require('../internals/engine-v8-version');\nvar fails = require('../internals/fails');\n\n// eslint-disable-next-line es/no-object-getownpropertysymbols -- required for testing\nmodule.exports = !!Object.getOwnPropertySymbols && !fails(function () {\n  var symbol = Symbol();\n  // Chrome 38 Symbol has incorrect toString conversion\n  // `get-own-property-symbols` polyfill symbols converted to object are not Symbol instances\n  return !String(symbol) || !(Object(symbol) instanceof Symbol) ||\n    // Chrome 38-40 symbols are not inherited from DOM collections prototypes to instances\n    !Symbol.sham && V8_VERSION && V8_VERSION < 41;\n});\n","var toIntegerOrInfinity = require('../internals/to-integer-or-infinity');\n\nvar max = Math.max;\nvar min = Math.min;\n\n// Helper for a popular repeating case of the spec:\n// Let integer be ? ToInteger(index).\n// If integer < 0, let result be max((length + integer), 0); else let result be min(integer, length).\nmodule.exports = function (index, length) {\n  var integer = toIntegerOrInfinity(index);\n  return integer < 0 ? max(integer + length, 0) : min(integer, length);\n};\n","// toObject with fallback for non-array-like ES3 strings\nvar IndexedObject = require('../internals/indexed-object');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\n\nmodule.exports = function (it) {\n  return IndexedObject(requireObjectCoercible(it));\n};\n","var trunc = require('../internals/math-trunc');\n\n// `ToIntegerOrInfinity` abstract operation\n// https://tc39.es/ecma262/#sec-tointegerorinfinity\nmodule.exports = function (argument) {\n  var number = +argument;\n  // eslint-disable-next-line no-self-compare -- NaN check\n  return number !== number || number === 0 ? 0 : trunc(number);\n};\n","var toIntegerOrInfinity = require('../internals/to-integer-or-infinity');\n\nvar min = Math.min;\n\n// `ToLength` abstract operation\n// https://tc39.es/ecma262/#sec-tolength\nmodule.exports = function (argument) {\n  return argument > 0 ? min(toIntegerOrInfinity(argument), 0x1FFFFFFFFFFFFF) : 0; // 2 ** 53 - 1 == 9007199254740991\n};\n","var requireObjectCoercible = require('../internals/require-object-coercible');\n\nvar $Object = Object;\n\n// `ToObject` abstract operation\n// https://tc39.es/ecma262/#sec-toobject\nmodule.exports = function (argument) {\n  return $Object(requireObjectCoercible(argument));\n};\n","var call = require('../internals/function-call');\nvar isObject = require('../internals/is-object');\nvar isSymbol = require('../internals/is-symbol');\nvar getMethod = require('../internals/get-method');\nvar ordinaryToPrimitive = require('../internals/ordinary-to-primitive');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar $TypeError = TypeError;\nvar TO_PRIMITIVE = wellKnownSymbol('toPrimitive');\n\n// `ToPrimitive` abstract operation\n// https://tc39.es/ecma262/#sec-toprimitive\nmodule.exports = function (input, pref) {\n  if (!isObject(input) || isSymbol(input)) return input;\n  var exoticToPrim = getMethod(input, TO_PRIMITIVE);\n  var result;\n  if (exoticToPrim) {\n    if (pref === undefined) pref = 'default';\n    result = call(exoticToPrim, input, pref);\n    if (!isObject(result) || isSymbol(result)) return result;\n    throw $TypeError(\"Can't convert object to primitive value\");\n  }\n  if (pref === undefined) pref = 'number';\n  return ordinaryToPrimitive(input, pref);\n};\n","var toPrimitive = require('../internals/to-primitive');\nvar isSymbol = require('../internals/is-symbol');\n\n// `ToPropertyKey` abstract operation\n// https://tc39.es/ecma262/#sec-topropertykey\nmodule.exports = function (argument) {\n  var key = toPrimitive(argument, 'string');\n  return isSymbol(key) ? key : key + '';\n};\n","var wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\nvar test = {};\n\ntest[TO_STRING_TAG] = 'z';\n\nmodule.exports = String(test) === '[object z]';\n","var classof = require('../internals/classof');\n\nvar $String = String;\n\nmodule.exports = function (argument) {\n  if (classof(argument) === 'Symbol') throw TypeError('Cannot convert a Symbol value to a string');\n  return $String(argument);\n};\n","var $String = String;\n\nmodule.exports = function (argument) {\n  try {\n    return $String(argument);\n  } catch (error) {\n    return 'Object';\n  }\n};\n","var uncurryThis = require('../internals/function-uncurry-this');\n\nvar id = 0;\nvar postfix = Math.random();\nvar toString = uncurryThis(1.0.toString);\n\nmodule.exports = function (key) {\n  return 'Symbol(' + (key === undefined ? '' : key) + ')_' + toString(++id + postfix, 36);\n};\n","/* eslint-disable es/no-symbol -- required for testing */\nvar NATIVE_SYMBOL = require('../internals/symbol-constructor-detection');\n\nmodule.exports = NATIVE_SYMBOL\n  && !Symbol.sham\n  && typeof Symbol.iterator == 'symbol';\n","var DESCRIPTORS = require('../internals/descriptors');\nvar fails = require('../internals/fails');\n\n// V8 ~ Chrome 36-\n// https://bugs.chromium.org/p/v8/issues/detail?id=3334\nmodule.exports = DESCRIPTORS && fails(function () {\n  // eslint-disable-next-line es/no-object-defineproperty -- required for testing\n  return Object.defineProperty(function () { /* empty */ }, 'prototype', {\n    value: 42,\n    writable: false\n  }).prototype != 42;\n});\n","var global = require('../internals/global');\nvar isCallable = require('../internals/is-callable');\n\nvar WeakMap = global.WeakMap;\n\nmodule.exports = isCallable(WeakMap) && /native code/.test(String(WeakMap));\n","var global = require('../internals/global');\nvar shared = require('../internals/shared');\nvar hasOwn = require('../internals/has-own-property');\nvar uid = require('../internals/uid');\nvar NATIVE_SYMBOL = require('../internals/symbol-constructor-detection');\nvar USE_SYMBOL_AS_UID = require('../internals/use-symbol-as-uid');\n\nvar Symbol = global.Symbol;\nvar WellKnownSymbolsStore = shared('wks');\nvar createWellKnownSymbol = USE_SYMBOL_AS_UID ? Symbol['for'] || Symbol : Symbol && Symbol.withoutSetter || uid;\n\nmodule.exports = function (name) {\n  if (!hasOwn(WellKnownSymbolsStore, name)) {\n    WellKnownSymbolsStore[name] = NATIVE_SYMBOL && hasOwn(Symbol, name)\n      ? Symbol[name]\n      : createWellKnownSymbol('Symbol.' + name);\n  } return WellKnownSymbolsStore[name];\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar flattenIntoArray = require('../internals/flatten-into-array');\nvar aCallable = require('../internals/a-callable');\nvar toObject = require('../internals/to-object');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar arraySpeciesCreate = require('../internals/array-species-create');\n\n// `Array.prototype.flatMap` method\n// https://tc39.es/ecma262/#sec-array.prototype.flatmap\n$({ target: 'Array', proto: true }, {\n  flatMap: function flatMap(callbackfn /* , thisArg */) {\n    var O = toObject(this);\n    var sourceLen = lengthOfArrayLike(O);\n    var A;\n    aCallable(callbackfn);\n    A = arraySpeciesCreate(O, 0);\n    A.length = flattenIntoArray(A, O, O, sourceLen, 0, 1, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n    return A;\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar flattenIntoArray = require('../internals/flatten-into-array');\nvar toObject = require('../internals/to-object');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar toIntegerOrInfinity = require('../internals/to-integer-or-infinity');\nvar arraySpeciesCreate = require('../internals/array-species-create');\n\n// `Array.prototype.flat` method\n// https://tc39.es/ecma262/#sec-array.prototype.flat\n$({ target: 'Array', proto: true }, {\n  flat: function flat(/* depthArg = 1 */) {\n    var depthArg = arguments.length ? arguments[0] : undefined;\n    var O = toObject(this);\n    var sourceLen = lengthOfArrayLike(O);\n    var A = arraySpeciesCreate(O, 0);\n    A.length = flattenIntoArray(A, O, O, sourceLen, 0, depthArg === undefined ? 1 : toIntegerOrInfinity(depthArg));\n    return A;\n  }\n});\n","// this method was added to unscopables after implementation\n// in popular engines, so it's moved to a separate module\nvar addToUnscopables = require('../internals/add-to-unscopables');\n\n// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables('flatMap');\n","// this method was added to unscopables after implementation\n// in popular engines, so it's moved to a separate module\nvar addToUnscopables = require('../internals/add-to-unscopables');\n\n// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables('flat');\n","'use strict';\nvar $ = require('../internals/export');\nvar exec = require('../internals/regexp-exec');\n\n// `RegExp.prototype.exec` method\n// https://tc39.es/ecma262/#sec-regexp.prototype.exec\n$({ target: 'RegExp', proto: true, forced: /./.exec !== exec }, {\n  exec: exec\n});\n","'use strict';\nvar apply = require('../internals/function-apply');\nvar call = require('../internals/function-call');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar fixRegExpWellKnownSymbolLogic = require('../internals/fix-regexp-well-known-symbol-logic');\nvar fails = require('../internals/fails');\nvar anObject = require('../internals/an-object');\nvar isCallable = require('../internals/is-callable');\nvar isNullOrUndefined = require('../internals/is-null-or-undefined');\nvar toIntegerOrInfinity = require('../internals/to-integer-or-infinity');\nvar toLength = require('../internals/to-length');\nvar toString = require('../internals/to-string');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar advanceStringIndex = require('../internals/advance-string-index');\nvar getMethod = require('../internals/get-method');\nvar getSubstitution = require('../internals/get-substitution');\nvar regExpExec = require('../internals/regexp-exec-abstract');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar REPLACE = wellKnownSymbol('replace');\nvar max = Math.max;\nvar min = Math.min;\nvar concat = uncurryThis([].concat);\nvar push = uncurryThis([].push);\nvar stringIndexOf = uncurryThis(''.indexOf);\nvar stringSlice = uncurryThis(''.slice);\n\nvar maybeToString = function (it) {\n  return it === undefined ? it : String(it);\n};\n\n// IE <= 11 replaces $0 with the whole match, as if it was $&\n// https://stackoverflow.com/questions/6024666/getting-ie-to-replace-a-regex-with-the-literal-string-0\nvar REPLACE_KEEPS_$0 = (function () {\n  // eslint-disable-next-line regexp/prefer-escape-replacement-dollar-char -- required for testing\n  return 'a'.replace(/./, '$0') === '$0';\n})();\n\n// Safari <= 13.0.3(?) substitutes nth capture where n>m with an empty string\nvar REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE = (function () {\n  if (/./[REPLACE]) {\n    return /./[REPLACE]('a', '$0') === '';\n  }\n  return false;\n})();\n\nvar REPLACE_SUPPORTS_NAMED_GROUPS = !fails(function () {\n  var re = /./;\n  re.exec = function () {\n    var result = [];\n    result.groups = { a: '7' };\n    return result;\n  };\n  // eslint-disable-next-line regexp/no-useless-dollar-replacements -- false positive\n  return ''.replace(re, '$<a>') !== '7';\n});\n\n// @@replace logic\nfixRegExpWellKnownSymbolLogic('replace', function (_, nativeReplace, maybeCallNative) {\n  var UNSAFE_SUBSTITUTE = REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE ? '$' : '$0';\n\n  return [\n    // `String.prototype.replace` method\n    // https://tc39.es/ecma262/#sec-string.prototype.replace\n    function replace(searchValue, replaceValue) {\n      var O = requireObjectCoercible(this);\n      var replacer = isNullOrUndefined(searchValue) ? undefined : getMethod(searchValue, REPLACE);\n      return replacer\n        ? call(replacer, searchValue, O, replaceValue)\n        : call(nativeReplace, toString(O), searchValue, replaceValue);\n    },\n    // `RegExp.prototype[@@replace]` method\n    // https://tc39.es/ecma262/#sec-regexp.prototype-@@replace\n    function (string, replaceValue) {\n      var rx = anObject(this);\n      var S = toString(string);\n\n      if (\n        typeof replaceValue == 'string' &&\n        stringIndexOf(replaceValue, UNSAFE_SUBSTITUTE) === -1 &&\n        stringIndexOf(replaceValue, '$<') === -1\n      ) {\n        var res = maybeCallNative(nativeReplace, rx, S, replaceValue);\n        if (res.done) return res.value;\n      }\n\n      var functionalReplace = isCallable(replaceValue);\n      if (!functionalReplace) replaceValue = toString(replaceValue);\n\n      var global = rx.global;\n      if (global) {\n        var fullUnicode = rx.unicode;\n        rx.lastIndex = 0;\n      }\n      var results = [];\n      while (true) {\n        var result = regExpExec(rx, S);\n        if (result === null) break;\n\n        push(results, result);\n        if (!global) break;\n\n        var matchStr = toString(result[0]);\n        if (matchStr === '') rx.lastIndex = advanceStringIndex(S, toLength(rx.lastIndex), fullUnicode);\n      }\n\n      var accumulatedResult = '';\n      var nextSourcePosition = 0;\n      for (var i = 0; i < results.length; i++) {\n        result = results[i];\n\n        var matched = toString(result[0]);\n        var position = max(min(toIntegerOrInfinity(result.index), S.length), 0);\n        var captures = [];\n        // NOTE: This is equivalent to\n        //   captures = result.slice(1).map(maybeToString)\n        // but for some reason `nativeSlice.call(result, 1, result.length)` (called in\n        // the slice polyfill when slicing native arrays) \"doesn't work\" in safari 9 and\n        // causes a crash (https://pastebin.com/N21QzeQA) when trying to debug it.\n        for (var j = 1; j < result.length; j++) push(captures, maybeToString(result[j]));\n        var namedCaptures = result.groups;\n        if (functionalReplace) {\n          var replacerArgs = concat([matched], captures, position, S);\n          if (namedCaptures !== undefined) push(replacerArgs, namedCaptures);\n          var replacement = toString(apply(replaceValue, undefined, replacerArgs));\n        } else {\n          replacement = getSubstitution(matched, S, position, captures, namedCaptures, replaceValue);\n        }\n        if (position >= nextSourcePosition) {\n          accumulatedResult += stringSlice(S, nextSourcePosition, position) + replacement;\n          nextSourcePosition = position + matched.length;\n        }\n      }\n      return accumulatedResult + stringSlice(S, nextSourcePosition);\n    }\n  ];\n}, !REPLACE_SUPPORTS_NAMED_GROUPS || !REPLACE_KEEPS_$0 || REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE);\n","'use strict';\n\nvar has = Object.prototype.hasOwnProperty\n  , prefix = '~';\n\n/**\n * Constructor to create a storage for our `EE` objects.\n * An `Events` instance is a plain object whose properties are event names.\n *\n * @constructor\n * @private\n */\nfunction Events() {}\n\n//\n// We try to not inherit from `Object.prototype`. In some engines creating an\n// instance in this way is faster than calling `Object.create(null)` directly.\n// If `Object.create(null)` is not supported we prefix the event names with a\n// character to make sure that the built-in object properties are not\n// overridden or used as an attack vector.\n//\nif (Object.create) {\n  Events.prototype = Object.create(null);\n\n  //\n  // This hack is needed because the `__proto__` property is still inherited in\n  // some old browsers like Android 4, iPhone 5.1, Opera 11 and Safari 5.\n  //\n  if (!new Events().__proto__) prefix = false;\n}\n\n/**\n * Representation of a single event listener.\n *\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} [once=false] Specify if the listener is a one-time listener.\n * @constructor\n * @private\n */\nfunction EE(fn, context, once) {\n  this.fn = fn;\n  this.context = context;\n  this.once = once || false;\n}\n\n/**\n * Add a listener for a given event.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} once Specify if the listener is a one-time listener.\n * @returns {EventEmitter}\n * @private\n */\nfunction addListener(emitter, event, fn, context, once) {\n  if (typeof fn !== 'function') {\n    throw new TypeError('The listener must be a function');\n  }\n\n  var listener = new EE(fn, context || emitter, once)\n    , evt = prefix ? prefix + event : event;\n\n  if (!emitter._events[evt]) emitter._events[evt] = listener, emitter._eventsCount++;\n  else if (!emitter._events[evt].fn) emitter._events[evt].push(listener);\n  else emitter._events[evt] = [emitter._events[evt], listener];\n\n  return emitter;\n}\n\n/**\n * Clear event by name.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} evt The Event name.\n * @private\n */\nfunction clearEvent(emitter, evt) {\n  if (--emitter._eventsCount === 0) emitter._events = new Events();\n  else delete emitter._events[evt];\n}\n\n/**\n * Minimal `EventEmitter` interface that is molded against the Node.js\n * `EventEmitter` interface.\n *\n * @constructor\n * @public\n */\nfunction EventEmitter() {\n  this._events = new Events();\n  this._eventsCount = 0;\n}\n\n/**\n * Return an array listing the events for which the emitter has registered\n * listeners.\n *\n * @returns {Array}\n * @public\n */\nEventEmitter.prototype.eventNames = function eventNames() {\n  var names = []\n    , events\n    , name;\n\n  if (this._eventsCount === 0) return names;\n\n  for (name in (events = this._events)) {\n    if (has.call(events, name)) names.push(prefix ? name.slice(1) : name);\n  }\n\n  if (Object.getOwnPropertySymbols) {\n    return names.concat(Object.getOwnPropertySymbols(events));\n  }\n\n  return names;\n};\n\n/**\n * Return the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Array} The registered listeners.\n * @public\n */\nEventEmitter.prototype.listeners = function listeners(event) {\n  var evt = prefix ? prefix + event : event\n    , handlers = this._events[evt];\n\n  if (!handlers) return [];\n  if (handlers.fn) return [handlers.fn];\n\n  for (var i = 0, l = handlers.length, ee = new Array(l); i < l; i++) {\n    ee[i] = handlers[i].fn;\n  }\n\n  return ee;\n};\n\n/**\n * Return the number of listeners listening to a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Number} The number of listeners.\n * @public\n */\nEventEmitter.prototype.listenerCount = function listenerCount(event) {\n  var evt = prefix ? prefix + event : event\n    , listeners = this._events[evt];\n\n  if (!listeners) return 0;\n  if (listeners.fn) return 1;\n  return listeners.length;\n};\n\n/**\n * Calls each of the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Boolean} `true` if the event had listeners, else `false`.\n * @public\n */\nEventEmitter.prototype.emit = function emit(event, a1, a2, a3, a4, a5) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return false;\n\n  var listeners = this._events[evt]\n    , len = arguments.length\n    , args\n    , i;\n\n  if (listeners.fn) {\n    if (listeners.once) this.removeListener(event, listeners.fn, undefined, true);\n\n    switch (len) {\n      case 1: return listeners.fn.call(listeners.context), true;\n      case 2: return listeners.fn.call(listeners.context, a1), true;\n      case 3: return listeners.fn.call(listeners.context, a1, a2), true;\n      case 4: return listeners.fn.call(listeners.context, a1, a2, a3), true;\n      case 5: return listeners.fn.call(listeners.context, a1, a2, a3, a4), true;\n      case 6: return listeners.fn.call(listeners.context, a1, a2, a3, a4, a5), true;\n    }\n\n    for (i = 1, args = new Array(len -1); i < len; i++) {\n      args[i - 1] = arguments[i];\n    }\n\n    listeners.fn.apply(listeners.context, args);\n  } else {\n    var length = listeners.length\n      , j;\n\n    for (i = 0; i < length; i++) {\n      if (listeners[i].once) this.removeListener(event, listeners[i].fn, undefined, true);\n\n      switch (len) {\n        case 1: listeners[i].fn.call(listeners[i].context); break;\n        case 2: listeners[i].fn.call(listeners[i].context, a1); break;\n        case 3: listeners[i].fn.call(listeners[i].context, a1, a2); break;\n        case 4: listeners[i].fn.call(listeners[i].context, a1, a2, a3); break;\n        default:\n          if (!args) for (j = 1, args = new Array(len -1); j < len; j++) {\n            args[j - 1] = arguments[j];\n          }\n\n          listeners[i].fn.apply(listeners[i].context, args);\n      }\n    }\n  }\n\n  return true;\n};\n\n/**\n * Add a listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.on = function on(event, fn, context) {\n  return addListener(this, event, fn, context, false);\n};\n\n/**\n * Add a one-time listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.once = function once(event, fn, context) {\n  return addListener(this, event, fn, context, true);\n};\n\n/**\n * Remove the listeners of a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn Only remove the listeners that match this function.\n * @param {*} context Only remove the listeners that have this context.\n * @param {Boolean} once Only remove one-time listeners.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeListener = function removeListener(event, fn, context, once) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return this;\n  if (!fn) {\n    clearEvent(this, evt);\n    return this;\n  }\n\n  var listeners = this._events[evt];\n\n  if (listeners.fn) {\n    if (\n      listeners.fn === fn &&\n      (!once || listeners.once) &&\n      (!context || listeners.context === context)\n    ) {\n      clearEvent(this, evt);\n    }\n  } else {\n    for (var i = 0, events = [], length = listeners.length; i < length; i++) {\n      if (\n        listeners[i].fn !== fn ||\n        (once && !listeners[i].once) ||\n        (context && listeners[i].context !== context)\n      ) {\n        events.push(listeners[i]);\n      }\n    }\n\n    //\n    // Reset the array, or remove it completely if we have no more listeners.\n    //\n    if (events.length) this._events[evt] = events.length === 1 ? events[0] : events;\n    else clearEvent(this, evt);\n  }\n\n  return this;\n};\n\n/**\n * Remove all listeners, or those of the specified event.\n *\n * @param {(String|Symbol)} [event] The event name.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeAllListeners = function removeAllListeners(event) {\n  var evt;\n\n  if (event) {\n    evt = prefix ? prefix + event : event;\n    if (this._events[evt]) clearEvent(this, evt);\n  } else {\n    this._events = new Events();\n    this._eventsCount = 0;\n  }\n\n  return this;\n};\n\n//\n// Alias methods names because people roll like that.\n//\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\nEventEmitter.prototype.addListener = EventEmitter.prototype.on;\n\n//\n// Expose the prefix.\n//\nEventEmitter.prefixed = prefix;\n\n//\n// Allow `EventEmitter` to be imported as module namespace.\n//\nEventEmitter.EventEmitter = EventEmitter;\n\n//\n// Expose the module.\n//\nif ('undefined' !== typeof module) {\n  module.exports = EventEmitter;\n}\n","/**\n * Lodash (Custom Build) <https://lodash.com/>\n * Build: `lodash modularize exports=\"npm\" -o ./`\n * Copyright JS Foundation and other contributors <https://js.foundation/>\n * Released under MIT license <https://lodash.com/license>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n */\n\n/** Used as the size to enable large array optimizations. */\nvar LARGE_ARRAY_SIZE = 200;\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    asyncTag = '[object AsyncFunction]',\n    boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    nullTag = '[object Null]',\n    objectTag = '[object Object]',\n    promiseTag = '[object Promise]',\n    proxyTag = '[object Proxy]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    symbolTag = '[object Symbol]',\n    undefinedTag = '[object Undefined]',\n    weakMapTag = '[object WeakMap]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]',\n    float32Tag = '[object Float32Array]',\n    float64Tag = '[object Float64Array]',\n    int8Tag = '[object Int8Array]',\n    int16Tag = '[object Int16Array]',\n    int32Tag = '[object Int32Array]',\n    uint8Tag = '[object Uint8Array]',\n    uint8ClampedTag = '[object Uint8ClampedArray]',\n    uint16Tag = '[object Uint16Array]',\n    uint32Tag = '[object Uint32Array]';\n\n/**\n * Used to match `RegExp`\n * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).\n */\nvar reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g;\n\n/** Used to detect host constructors (Safari). */\nvar reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n/** Used to detect unsigned integer values. */\nvar reIsUint = /^(?:0|[1-9]\\d*)$/;\n\n/** Used to identify `toStringTag` values of typed arrays. */\nvar typedArrayTags = {};\ntypedArrayTags[float32Tag] = typedArrayTags[float64Tag] =\ntypedArrayTags[int8Tag] = typedArrayTags[int16Tag] =\ntypedArrayTags[int32Tag] = typedArrayTags[uint8Tag] =\ntypedArrayTags[uint8ClampedTag] = typedArrayTags[uint16Tag] =\ntypedArrayTags[uint32Tag] = true;\ntypedArrayTags[argsTag] = typedArrayTags[arrayTag] =\ntypedArrayTags[arrayBufferTag] = typedArrayTags[boolTag] =\ntypedArrayTags[dataViewTag] = typedArrayTags[dateTag] =\ntypedArrayTags[errorTag] = typedArrayTags[funcTag] =\ntypedArrayTags[mapTag] = typedArrayTags[numberTag] =\ntypedArrayTags[objectTag] = typedArrayTags[regexpTag] =\ntypedArrayTags[setTag] = typedArrayTags[stringTag] =\ntypedArrayTags[weakMapTag] = false;\n\n/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Detect free variable `process` from Node.js. */\nvar freeProcess = moduleExports && freeGlobal.process;\n\n/** Used to access faster Node.js helpers. */\nvar nodeUtil = (function() {\n  try {\n    return freeProcess && freeProcess.binding && freeProcess.binding('util');\n  } catch (e) {}\n}());\n\n/* Node.js helper references. */\nvar nodeIsTypedArray = nodeUtil && nodeUtil.isTypedArray;\n\n/**\n * A specialized version of `_.filter` for arrays without support for\n * iteratee shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} predicate The function invoked per iteration.\n * @returns {Array} Returns the new filtered array.\n */\nfunction arrayFilter(array, predicate) {\n  var index = -1,\n      length = array == null ? 0 : array.length,\n      resIndex = 0,\n      result = [];\n\n  while (++index < length) {\n    var value = array[index];\n    if (predicate(value, index, array)) {\n      result[resIndex++] = value;\n    }\n  }\n  return result;\n}\n\n/**\n * Appends the elements of `values` to `array`.\n *\n * @private\n * @param {Array} array The array to modify.\n * @param {Array} values The values to append.\n * @returns {Array} Returns `array`.\n */\nfunction arrayPush(array, values) {\n  var index = -1,\n      length = values.length,\n      offset = array.length;\n\n  while (++index < length) {\n    array[offset + index] = values[index];\n  }\n  return array;\n}\n\n/**\n * A specialized version of `_.some` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} predicate The function invoked per iteration.\n * @returns {boolean} Returns `true` if any element passes the predicate check,\n *  else `false`.\n */\nfunction arraySome(array, predicate) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  while (++index < length) {\n    if (predicate(array[index], index, array)) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * The base implementation of `_.times` without support for iteratee shorthands\n * or max array length checks.\n *\n * @private\n * @param {number} n The number of times to invoke `iteratee`.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the array of results.\n */\nfunction baseTimes(n, iteratee) {\n  var index = -1,\n      result = Array(n);\n\n  while (++index < n) {\n    result[index] = iteratee(index);\n  }\n  return result;\n}\n\n/**\n * The base implementation of `_.unary` without support for storing metadata.\n *\n * @private\n * @param {Function} func The function to cap arguments for.\n * @returns {Function} Returns the new capped function.\n */\nfunction baseUnary(func) {\n  return function(value) {\n    return func(value);\n  };\n}\n\n/**\n * Checks if a `cache` value for `key` exists.\n *\n * @private\n * @param {Object} cache The cache to query.\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction cacheHas(cache, key) {\n  return cache.has(key);\n}\n\n/**\n * Gets the value at `key` of `object`.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {string} key The key of the property to get.\n * @returns {*} Returns the property value.\n */\nfunction getValue(object, key) {\n  return object == null ? undefined : object[key];\n}\n\n/**\n * Converts `map` to its key-value pairs.\n *\n * @private\n * @param {Object} map The map to convert.\n * @returns {Array} Returns the key-value pairs.\n */\nfunction mapToArray(map) {\n  var index = -1,\n      result = Array(map.size);\n\n  map.forEach(function(value, key) {\n    result[++index] = [key, value];\n  });\n  return result;\n}\n\n/**\n * Creates a unary function that invokes `func` with its argument transformed.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {Function} transform The argument transform.\n * @returns {Function} Returns the new function.\n */\nfunction overArg(func, transform) {\n  return function(arg) {\n    return func(transform(arg));\n  };\n}\n\n/**\n * Converts `set` to an array of its values.\n *\n * @private\n * @param {Object} set The set to convert.\n * @returns {Array} Returns the values.\n */\nfunction setToArray(set) {\n  var index = -1,\n      result = Array(set.size);\n\n  set.forEach(function(value) {\n    result[++index] = value;\n  });\n  return result;\n}\n\n/** Used for built-in method references. */\nvar arrayProto = Array.prototype,\n    funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to detect overreaching core-js shims. */\nvar coreJsData = root['__core-js_shared__'];\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Used to detect methods masquerading as native. */\nvar maskSrcKey = (function() {\n  var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || '');\n  return uid ? ('Symbol(src)_1.' + uid) : '';\n}());\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/** Used to detect if a method is native. */\nvar reIsNative = RegExp('^' +\n  funcToString.call(hasOwnProperty).replace(reRegExpChar, '\\\\$&')\n  .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n);\n\n/** Built-in value references. */\nvar Buffer = moduleExports ? root.Buffer : undefined,\n    Symbol = root.Symbol,\n    Uint8Array = root.Uint8Array,\n    propertyIsEnumerable = objectProto.propertyIsEnumerable,\n    splice = arrayProto.splice,\n    symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeGetSymbols = Object.getOwnPropertySymbols,\n    nativeIsBuffer = Buffer ? Buffer.isBuffer : undefined,\n    nativeKeys = overArg(Object.keys, Object);\n\n/* Built-in method references that are verified to be native. */\nvar DataView = getNative(root, 'DataView'),\n    Map = getNative(root, 'Map'),\n    Promise = getNative(root, 'Promise'),\n    Set = getNative(root, 'Set'),\n    WeakMap = getNative(root, 'WeakMap'),\n    nativeCreate = getNative(Object, 'create');\n\n/** Used to detect maps, sets, and weakmaps. */\nvar dataViewCtorString = toSource(DataView),\n    mapCtorString = toSource(Map),\n    promiseCtorString = toSource(Promise),\n    setCtorString = toSource(Set),\n    weakMapCtorString = toSource(WeakMap);\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolValueOf = symbolProto ? symbolProto.valueOf : undefined;\n\n/**\n * Creates a hash object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Hash(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n/**\n * Removes all key-value entries from the hash.\n *\n * @private\n * @name clear\n * @memberOf Hash\n */\nfunction hashClear() {\n  this.__data__ = nativeCreate ? nativeCreate(null) : {};\n  this.size = 0;\n}\n\n/**\n * Removes `key` and its value from the hash.\n *\n * @private\n * @name delete\n * @memberOf Hash\n * @param {Object} hash The hash to modify.\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction hashDelete(key) {\n  var result = this.has(key) && delete this.__data__[key];\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\n/**\n * Gets the hash value for `key`.\n *\n * @private\n * @name get\n * @memberOf Hash\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction hashGet(key) {\n  var data = this.__data__;\n  if (nativeCreate) {\n    var result = data[key];\n    return result === HASH_UNDEFINED ? undefined : result;\n  }\n  return hasOwnProperty.call(data, key) ? data[key] : undefined;\n}\n\n/**\n * Checks if a hash value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Hash\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction hashHas(key) {\n  var data = this.__data__;\n  return nativeCreate ? (data[key] !== undefined) : hasOwnProperty.call(data, key);\n}\n\n/**\n * Sets the hash `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Hash\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the hash instance.\n */\nfunction hashSet(key, value) {\n  var data = this.__data__;\n  this.size += this.has(key) ? 0 : 1;\n  data[key] = (nativeCreate && value === undefined) ? HASH_UNDEFINED : value;\n  return this;\n}\n\n// Add methods to `Hash`.\nHash.prototype.clear = hashClear;\nHash.prototype['delete'] = hashDelete;\nHash.prototype.get = hashGet;\nHash.prototype.has = hashHas;\nHash.prototype.set = hashSet;\n\n/**\n * Creates an list cache object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction ListCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n/**\n * Removes all key-value entries from the list cache.\n *\n * @private\n * @name clear\n * @memberOf ListCache\n */\nfunction listCacheClear() {\n  this.__data__ = [];\n  this.size = 0;\n}\n\n/**\n * Removes `key` and its value from the list cache.\n *\n * @private\n * @name delete\n * @memberOf ListCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction listCacheDelete(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    return false;\n  }\n  var lastIndex = data.length - 1;\n  if (index == lastIndex) {\n    data.pop();\n  } else {\n    splice.call(data, index, 1);\n  }\n  --this.size;\n  return true;\n}\n\n/**\n * Gets the list cache value for `key`.\n *\n * @private\n * @name get\n * @memberOf ListCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction listCacheGet(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  return index < 0 ? undefined : data[index][1];\n}\n\n/**\n * Checks if a list cache value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf ListCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction listCacheHas(key) {\n  return assocIndexOf(this.__data__, key) > -1;\n}\n\n/**\n * Sets the list cache `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf ListCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the list cache instance.\n */\nfunction listCacheSet(key, value) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    ++this.size;\n    data.push([key, value]);\n  } else {\n    data[index][1] = value;\n  }\n  return this;\n}\n\n// Add methods to `ListCache`.\nListCache.prototype.clear = listCacheClear;\nListCache.prototype['delete'] = listCacheDelete;\nListCache.prototype.get = listCacheGet;\nListCache.prototype.has = listCacheHas;\nListCache.prototype.set = listCacheSet;\n\n/**\n * Creates a map cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction MapCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n/**\n * Removes all key-value entries from the map.\n *\n * @private\n * @name clear\n * @memberOf MapCache\n */\nfunction mapCacheClear() {\n  this.size = 0;\n  this.__data__ = {\n    'hash': new Hash,\n    'map': new (Map || ListCache),\n    'string': new Hash\n  };\n}\n\n/**\n * Removes `key` and its value from the map.\n *\n * @private\n * @name delete\n * @memberOf MapCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction mapCacheDelete(key) {\n  var result = getMapData(this, key)['delete'](key);\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\n/**\n * Gets the map value for `key`.\n *\n * @private\n * @name get\n * @memberOf MapCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction mapCacheGet(key) {\n  return getMapData(this, key).get(key);\n}\n\n/**\n * Checks if a map value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf MapCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction mapCacheHas(key) {\n  return getMapData(this, key).has(key);\n}\n\n/**\n * Sets the map `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf MapCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the map cache instance.\n */\nfunction mapCacheSet(key, value) {\n  var data = getMapData(this, key),\n      size = data.size;\n\n  data.set(key, value);\n  this.size += data.size == size ? 0 : 1;\n  return this;\n}\n\n// Add methods to `MapCache`.\nMapCache.prototype.clear = mapCacheClear;\nMapCache.prototype['delete'] = mapCacheDelete;\nMapCache.prototype.get = mapCacheGet;\nMapCache.prototype.has = mapCacheHas;\nMapCache.prototype.set = mapCacheSet;\n\n/**\n *\n * Creates an array cache object to store unique values.\n *\n * @private\n * @constructor\n * @param {Array} [values] The values to cache.\n */\nfunction SetCache(values) {\n  var index = -1,\n      length = values == null ? 0 : values.length;\n\n  this.__data__ = new MapCache;\n  while (++index < length) {\n    this.add(values[index]);\n  }\n}\n\n/**\n * Adds `value` to the array cache.\n *\n * @private\n * @name add\n * @memberOf SetCache\n * @alias push\n * @param {*} value The value to cache.\n * @returns {Object} Returns the cache instance.\n */\nfunction setCacheAdd(value) {\n  this.__data__.set(value, HASH_UNDEFINED);\n  return this;\n}\n\n/**\n * Checks if `value` is in the array cache.\n *\n * @private\n * @name has\n * @memberOf SetCache\n * @param {*} value The value to search for.\n * @returns {number} Returns `true` if `value` is found, else `false`.\n */\nfunction setCacheHas(value) {\n  return this.__data__.has(value);\n}\n\n// Add methods to `SetCache`.\nSetCache.prototype.add = SetCache.prototype.push = setCacheAdd;\nSetCache.prototype.has = setCacheHas;\n\n/**\n * Creates a stack cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Stack(entries) {\n  var data = this.__data__ = new ListCache(entries);\n  this.size = data.size;\n}\n\n/**\n * Removes all key-value entries from the stack.\n *\n * @private\n * @name clear\n * @memberOf Stack\n */\nfunction stackClear() {\n  this.__data__ = new ListCache;\n  this.size = 0;\n}\n\n/**\n * Removes `key` and its value from the stack.\n *\n * @private\n * @name delete\n * @memberOf Stack\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction stackDelete(key) {\n  var data = this.__data__,\n      result = data['delete'](key);\n\n  this.size = data.size;\n  return result;\n}\n\n/**\n * Gets the stack value for `key`.\n *\n * @private\n * @name get\n * @memberOf Stack\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction stackGet(key) {\n  return this.__data__.get(key);\n}\n\n/**\n * Checks if a stack value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Stack\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction stackHas(key) {\n  return this.__data__.has(key);\n}\n\n/**\n * Sets the stack `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Stack\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the stack cache instance.\n */\nfunction stackSet(key, value) {\n  var data = this.__data__;\n  if (data instanceof ListCache) {\n    var pairs = data.__data__;\n    if (!Map || (pairs.length < LARGE_ARRAY_SIZE - 1)) {\n      pairs.push([key, value]);\n      this.size = ++data.size;\n      return this;\n    }\n    data = this.__data__ = new MapCache(pairs);\n  }\n  data.set(key, value);\n  this.size = data.size;\n  return this;\n}\n\n// Add methods to `Stack`.\nStack.prototype.clear = stackClear;\nStack.prototype['delete'] = stackDelete;\nStack.prototype.get = stackGet;\nStack.prototype.has = stackHas;\nStack.prototype.set = stackSet;\n\n/**\n * Creates an array of the enumerable property names of the array-like `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @param {boolean} inherited Specify returning inherited property names.\n * @returns {Array} Returns the array of property names.\n */\nfunction arrayLikeKeys(value, inherited) {\n  var isArr = isArray(value),\n      isArg = !isArr && isArguments(value),\n      isBuff = !isArr && !isArg && isBuffer(value),\n      isType = !isArr && !isArg && !isBuff && isTypedArray(value),\n      skipIndexes = isArr || isArg || isBuff || isType,\n      result = skipIndexes ? baseTimes(value.length, String) : [],\n      length = result.length;\n\n  for (var key in value) {\n    if ((inherited || hasOwnProperty.call(value, key)) &&\n        !(skipIndexes && (\n           // Safari 9 has enumerable `arguments.length` in strict mode.\n           key == 'length' ||\n           // Node.js 0.10 has enumerable non-index properties on buffers.\n           (isBuff && (key == 'offset' || key == 'parent')) ||\n           // PhantomJS 2 has enumerable non-index properties on typed arrays.\n           (isType && (key == 'buffer' || key == 'byteLength' || key == 'byteOffset')) ||\n           // Skip index properties.\n           isIndex(key, length)\n        ))) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\n/**\n * Gets the index at which the `key` is found in `array` of key-value pairs.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} key The key to search for.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction assocIndexOf(array, key) {\n  var length = array.length;\n  while (length--) {\n    if (eq(array[length][0], key)) {\n      return length;\n    }\n  }\n  return -1;\n}\n\n/**\n * The base implementation of `getAllKeys` and `getAllKeysIn` which uses\n * `keysFunc` and `symbolsFunc` to get the enumerable property names and\n * symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Function} keysFunc The function to get the keys of `object`.\n * @param {Function} symbolsFunc The function to get the symbols of `object`.\n * @returns {Array} Returns the array of property names and symbols.\n */\nfunction baseGetAllKeys(object, keysFunc, symbolsFunc) {\n  var result = keysFunc(object);\n  return isArray(object) ? result : arrayPush(result, symbolsFunc(object));\n}\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return (symToStringTag && symToStringTag in Object(value))\n    ? getRawTag(value)\n    : objectToString(value);\n}\n\n/**\n * The base implementation of `_.isArguments`.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n */\nfunction baseIsArguments(value) {\n  return isObjectLike(value) && baseGetTag(value) == argsTag;\n}\n\n/**\n * The base implementation of `_.isEqual` which supports partial comparisons\n * and tracks traversed objects.\n *\n * @private\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @param {boolean} bitmask The bitmask flags.\n *  1 - Unordered comparison\n *  2 - Partial comparison\n * @param {Function} [customizer] The function to customize comparisons.\n * @param {Object} [stack] Tracks traversed `value` and `other` objects.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n */\nfunction baseIsEqual(value, other, bitmask, customizer, stack) {\n  if (value === other) {\n    return true;\n  }\n  if (value == null || other == null || (!isObjectLike(value) && !isObjectLike(other))) {\n    return value !== value && other !== other;\n  }\n  return baseIsEqualDeep(value, other, bitmask, customizer, baseIsEqual, stack);\n}\n\n/**\n * A specialized version of `baseIsEqual` for arrays and objects which performs\n * deep comparisons and tracks traversed objects enabling objects with circular\n * references to be compared.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} [stack] Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction baseIsEqualDeep(object, other, bitmask, customizer, equalFunc, stack) {\n  var objIsArr = isArray(object),\n      othIsArr = isArray(other),\n      objTag = objIsArr ? arrayTag : getTag(object),\n      othTag = othIsArr ? arrayTag : getTag(other);\n\n  objTag = objTag == argsTag ? objectTag : objTag;\n  othTag = othTag == argsTag ? objectTag : othTag;\n\n  var objIsObj = objTag == objectTag,\n      othIsObj = othTag == objectTag,\n      isSameTag = objTag == othTag;\n\n  if (isSameTag && isBuffer(object)) {\n    if (!isBuffer(other)) {\n      return false;\n    }\n    objIsArr = true;\n    objIsObj = false;\n  }\n  if (isSameTag && !objIsObj) {\n    stack || (stack = new Stack);\n    return (objIsArr || isTypedArray(object))\n      ? equalArrays(object, other, bitmask, customizer, equalFunc, stack)\n      : equalByTag(object, other, objTag, bitmask, customizer, equalFunc, stack);\n  }\n  if (!(bitmask & COMPARE_PARTIAL_FLAG)) {\n    var objIsWrapped = objIsObj && hasOwnProperty.call(object, '__wrapped__'),\n        othIsWrapped = othIsObj && hasOwnProperty.call(other, '__wrapped__');\n\n    if (objIsWrapped || othIsWrapped) {\n      var objUnwrapped = objIsWrapped ? object.value() : object,\n          othUnwrapped = othIsWrapped ? other.value() : other;\n\n      stack || (stack = new Stack);\n      return equalFunc(objUnwrapped, othUnwrapped, bitmask, customizer, stack);\n    }\n  }\n  if (!isSameTag) {\n    return false;\n  }\n  stack || (stack = new Stack);\n  return equalObjects(object, other, bitmask, customizer, equalFunc, stack);\n}\n\n/**\n * The base implementation of `_.isNative` without bad shim checks.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a native function,\n *  else `false`.\n */\nfunction baseIsNative(value) {\n  if (!isObject(value) || isMasked(value)) {\n    return false;\n  }\n  var pattern = isFunction(value) ? reIsNative : reIsHostCtor;\n  return pattern.test(toSource(value));\n}\n\n/**\n * The base implementation of `_.isTypedArray` without Node.js optimizations.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n */\nfunction baseIsTypedArray(value) {\n  return isObjectLike(value) &&\n    isLength(value.length) && !!typedArrayTags[baseGetTag(value)];\n}\n\n/**\n * The base implementation of `_.keys` which doesn't treat sparse arrays as dense.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction baseKeys(object) {\n  if (!isPrototype(object)) {\n    return nativeKeys(object);\n  }\n  var result = [];\n  for (var key in Object(object)) {\n    if (hasOwnProperty.call(object, key) && key != 'constructor') {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\n/**\n * A specialized version of `baseIsEqualDeep` for arrays with support for\n * partial deep comparisons.\n *\n * @private\n * @param {Array} array The array to compare.\n * @param {Array} other The other array to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `array` and `other` objects.\n * @returns {boolean} Returns `true` if the arrays are equivalent, else `false`.\n */\nfunction equalArrays(array, other, bitmask, customizer, equalFunc, stack) {\n  var isPartial = bitmask & COMPARE_PARTIAL_FLAG,\n      arrLength = array.length,\n      othLength = other.length;\n\n  if (arrLength != othLength && !(isPartial && othLength > arrLength)) {\n    return false;\n  }\n  // Assume cyclic values are equal.\n  var stacked = stack.get(array);\n  if (stacked && stack.get(other)) {\n    return stacked == other;\n  }\n  var index = -1,\n      result = true,\n      seen = (bitmask & COMPARE_UNORDERED_FLAG) ? new SetCache : undefined;\n\n  stack.set(array, other);\n  stack.set(other, array);\n\n  // Ignore non-index properties.\n  while (++index < arrLength) {\n    var arrValue = array[index],\n        othValue = other[index];\n\n    if (customizer) {\n      var compared = isPartial\n        ? customizer(othValue, arrValue, index, other, array, stack)\n        : customizer(arrValue, othValue, index, array, other, stack);\n    }\n    if (compared !== undefined) {\n      if (compared) {\n        continue;\n      }\n      result = false;\n      break;\n    }\n    // Recursively compare arrays (susceptible to call stack limits).\n    if (seen) {\n      if (!arraySome(other, function(othValue, othIndex) {\n            if (!cacheHas(seen, othIndex) &&\n                (arrValue === othValue || equalFunc(arrValue, othValue, bitmask, customizer, stack))) {\n              return seen.push(othIndex);\n            }\n          })) {\n        result = false;\n        break;\n      }\n    } else if (!(\n          arrValue === othValue ||\n            equalFunc(arrValue, othValue, bitmask, customizer, stack)\n        )) {\n      result = false;\n      break;\n    }\n  }\n  stack['delete'](array);\n  stack['delete'](other);\n  return result;\n}\n\n/**\n * A specialized version of `baseIsEqualDeep` for comparing objects of\n * the same `toStringTag`.\n *\n * **Note:** This function only supports comparing values with tags of\n * `Boolean`, `Date`, `Error`, `Number`, `RegExp`, or `String`.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {string} tag The `toStringTag` of the objects to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction equalByTag(object, other, tag, bitmask, customizer, equalFunc, stack) {\n  switch (tag) {\n    case dataViewTag:\n      if ((object.byteLength != other.byteLength) ||\n          (object.byteOffset != other.byteOffset)) {\n        return false;\n      }\n      object = object.buffer;\n      other = other.buffer;\n\n    case arrayBufferTag:\n      if ((object.byteLength != other.byteLength) ||\n          !equalFunc(new Uint8Array(object), new Uint8Array(other))) {\n        return false;\n      }\n      return true;\n\n    case boolTag:\n    case dateTag:\n    case numberTag:\n      // Coerce booleans to `1` or `0` and dates to milliseconds.\n      // Invalid dates are coerced to `NaN`.\n      return eq(+object, +other);\n\n    case errorTag:\n      return object.name == other.name && object.message == other.message;\n\n    case regexpTag:\n    case stringTag:\n      // Coerce regexes to strings and treat strings, primitives and objects,\n      // as equal. See http://www.ecma-international.org/ecma-262/7.0/#sec-regexp.prototype.tostring\n      // for more details.\n      return object == (other + '');\n\n    case mapTag:\n      var convert = mapToArray;\n\n    case setTag:\n      var isPartial = bitmask & COMPARE_PARTIAL_FLAG;\n      convert || (convert = setToArray);\n\n      if (object.size != other.size && !isPartial) {\n        return false;\n      }\n      // Assume cyclic values are equal.\n      var stacked = stack.get(object);\n      if (stacked) {\n        return stacked == other;\n      }\n      bitmask |= COMPARE_UNORDERED_FLAG;\n\n      // Recursively compare objects (susceptible to call stack limits).\n      stack.set(object, other);\n      var result = equalArrays(convert(object), convert(other), bitmask, customizer, equalFunc, stack);\n      stack['delete'](object);\n      return result;\n\n    case symbolTag:\n      if (symbolValueOf) {\n        return symbolValueOf.call(object) == symbolValueOf.call(other);\n      }\n  }\n  return false;\n}\n\n/**\n * A specialized version of `baseIsEqualDeep` for objects with support for\n * partial deep comparisons.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction equalObjects(object, other, bitmask, customizer, equalFunc, stack) {\n  var isPartial = bitmask & COMPARE_PARTIAL_FLAG,\n      objProps = getAllKeys(object),\n      objLength = objProps.length,\n      othProps = getAllKeys(other),\n      othLength = othProps.length;\n\n  if (objLength != othLength && !isPartial) {\n    return false;\n  }\n  var index = objLength;\n  while (index--) {\n    var key = objProps[index];\n    if (!(isPartial ? key in other : hasOwnProperty.call(other, key))) {\n      return false;\n    }\n  }\n  // Assume cyclic values are equal.\n  var stacked = stack.get(object);\n  if (stacked && stack.get(other)) {\n    return stacked == other;\n  }\n  var result = true;\n  stack.set(object, other);\n  stack.set(other, object);\n\n  var skipCtor = isPartial;\n  while (++index < objLength) {\n    key = objProps[index];\n    var objValue = object[key],\n        othValue = other[key];\n\n    if (customizer) {\n      var compared = isPartial\n        ? customizer(othValue, objValue, key, other, object, stack)\n        : customizer(objValue, othValue, key, object, other, stack);\n    }\n    // Recursively compare objects (susceptible to call stack limits).\n    if (!(compared === undefined\n          ? (objValue === othValue || equalFunc(objValue, othValue, bitmask, customizer, stack))\n          : compared\n        )) {\n      result = false;\n      break;\n    }\n    skipCtor || (skipCtor = key == 'constructor');\n  }\n  if (result && !skipCtor) {\n    var objCtor = object.constructor,\n        othCtor = other.constructor;\n\n    // Non `Object` object instances with different constructors are not equal.\n    if (objCtor != othCtor &&\n        ('constructor' in object && 'constructor' in other) &&\n        !(typeof objCtor == 'function' && objCtor instanceof objCtor &&\n          typeof othCtor == 'function' && othCtor instanceof othCtor)) {\n      result = false;\n    }\n  }\n  stack['delete'](object);\n  stack['delete'](other);\n  return result;\n}\n\n/**\n * Creates an array of own enumerable property names and symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names and symbols.\n */\nfunction getAllKeys(object) {\n  return baseGetAllKeys(object, keys, getSymbols);\n}\n\n/**\n * Gets the data for `map`.\n *\n * @private\n * @param {Object} map The map to query.\n * @param {string} key The reference key.\n * @returns {*} Returns the map data.\n */\nfunction getMapData(map, key) {\n  var data = map.__data__;\n  return isKeyable(key)\n    ? data[typeof key == 'string' ? 'string' : 'hash']\n    : data.map;\n}\n\n/**\n * Gets the native function at `key` of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {string} key The key of the method to get.\n * @returns {*} Returns the function if it's native, else `undefined`.\n */\nfunction getNative(object, key) {\n  var value = getValue(object, key);\n  return baseIsNative(value) ? value : undefined;\n}\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag),\n      tag = value[symToStringTag];\n\n  try {\n    value[symToStringTag] = undefined;\n    var unmasked = true;\n  } catch (e) {}\n\n  var result = nativeObjectToString.call(value);\n  if (unmasked) {\n    if (isOwn) {\n      value[symToStringTag] = tag;\n    } else {\n      delete value[symToStringTag];\n    }\n  }\n  return result;\n}\n\n/**\n * Creates an array of the own enumerable symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of symbols.\n */\nvar getSymbols = !nativeGetSymbols ? stubArray : function(object) {\n  if (object == null) {\n    return [];\n  }\n  object = Object(object);\n  return arrayFilter(nativeGetSymbols(object), function(symbol) {\n    return propertyIsEnumerable.call(object, symbol);\n  });\n};\n\n/**\n * Gets the `toStringTag` of `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nvar getTag = baseGetTag;\n\n// Fallback for data views, maps, sets, and weak maps in IE 11 and promises in Node.js < 6.\nif ((DataView && getTag(new DataView(new ArrayBuffer(1))) != dataViewTag) ||\n    (Map && getTag(new Map) != mapTag) ||\n    (Promise && getTag(Promise.resolve()) != promiseTag) ||\n    (Set && getTag(new Set) != setTag) ||\n    (WeakMap && getTag(new WeakMap) != weakMapTag)) {\n  getTag = function(value) {\n    var result = baseGetTag(value),\n        Ctor = result == objectTag ? value.constructor : undefined,\n        ctorString = Ctor ? toSource(Ctor) : '';\n\n    if (ctorString) {\n      switch (ctorString) {\n        case dataViewCtorString: return dataViewTag;\n        case mapCtorString: return mapTag;\n        case promiseCtorString: return promiseTag;\n        case setCtorString: return setTag;\n        case weakMapCtorString: return weakMapTag;\n      }\n    }\n    return result;\n  };\n}\n\n/**\n * Checks if `value` is a valid array-like index.\n *\n * @private\n * @param {*} value The value to check.\n * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.\n * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.\n */\nfunction isIndex(value, length) {\n  length = length == null ? MAX_SAFE_INTEGER : length;\n  return !!length &&\n    (typeof value == 'number' || reIsUint.test(value)) &&\n    (value > -1 && value % 1 == 0 && value < length);\n}\n\n/**\n * Checks if `value` is suitable for use as unique object key.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is suitable, else `false`.\n */\nfunction isKeyable(value) {\n  var type = typeof value;\n  return (type == 'string' || type == 'number' || type == 'symbol' || type == 'boolean')\n    ? (value !== '__proto__')\n    : (value === null);\n}\n\n/**\n * Checks if `func` has its source masked.\n *\n * @private\n * @param {Function} func The function to check.\n * @returns {boolean} Returns `true` if `func` is masked, else `false`.\n */\nfunction isMasked(func) {\n  return !!maskSrcKey && (maskSrcKey in func);\n}\n\n/**\n * Checks if `value` is likely a prototype object.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a prototype, else `false`.\n */\nfunction isPrototype(value) {\n  var Ctor = value && value.constructor,\n      proto = (typeof Ctor == 'function' && Ctor.prototype) || objectProto;\n\n  return value === proto;\n}\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString.call(value);\n}\n\n/**\n * Converts `func` to its source code.\n *\n * @private\n * @param {Function} func The function to convert.\n * @returns {string} Returns the source code.\n */\nfunction toSource(func) {\n  if (func != null) {\n    try {\n      return funcToString.call(func);\n    } catch (e) {}\n    try {\n      return (func + '');\n    } catch (e) {}\n  }\n  return '';\n}\n\n/**\n * Performs a\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * comparison between two values to determine if they are equivalent.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.eq(object, object);\n * // => true\n *\n * _.eq(object, other);\n * // => false\n *\n * _.eq('a', 'a');\n * // => true\n *\n * _.eq('a', Object('a'));\n * // => false\n *\n * _.eq(NaN, NaN);\n * // => true\n */\nfunction eq(value, other) {\n  return value === other || (value !== value && other !== other);\n}\n\n/**\n * Checks if `value` is likely an `arguments` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n *  else `false`.\n * @example\n *\n * _.isArguments(function() { return arguments; }());\n * // => true\n *\n * _.isArguments([1, 2, 3]);\n * // => false\n */\nvar isArguments = baseIsArguments(function() { return arguments; }()) ? baseIsArguments : function(value) {\n  return isObjectLike(value) && hasOwnProperty.call(value, 'callee') &&\n    !propertyIsEnumerable.call(value, 'callee');\n};\n\n/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\n/**\n * Checks if `value` is array-like. A value is considered array-like if it's\n * not a function and has a `value.length` that's an integer greater than or\n * equal to `0` and less than or equal to `Number.MAX_SAFE_INTEGER`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is array-like, else `false`.\n * @example\n *\n * _.isArrayLike([1, 2, 3]);\n * // => true\n *\n * _.isArrayLike(document.body.children);\n * // => true\n *\n * _.isArrayLike('abc');\n * // => true\n *\n * _.isArrayLike(_.noop);\n * // => false\n */\nfunction isArrayLike(value) {\n  return value != null && isLength(value.length) && !isFunction(value);\n}\n\n/**\n * Checks if `value` is a buffer.\n *\n * @static\n * @memberOf _\n * @since 4.3.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a buffer, else `false`.\n * @example\n *\n * _.isBuffer(new Buffer(2));\n * // => true\n *\n * _.isBuffer(new Uint8Array(2));\n * // => false\n */\nvar isBuffer = nativeIsBuffer || stubFalse;\n\n/**\n * Performs a deep comparison between two values to determine if they are\n * equivalent.\n *\n * **Note:** This method supports comparing arrays, array buffers, booleans,\n * date objects, error objects, maps, numbers, `Object` objects, regexes,\n * sets, strings, symbols, and typed arrays. `Object` objects are compared\n * by their own, not inherited, enumerable properties. Functions and DOM\n * nodes are compared by strict equality, i.e. `===`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.isEqual(object, other);\n * // => true\n *\n * object === other;\n * // => false\n */\nfunction isEqual(value, other) {\n  return baseIsEqual(value, other);\n}\n\n/**\n * Checks if `value` is classified as a `Function` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n *\n * _.isFunction(/abc/);\n * // => false\n */\nfunction isFunction(value) {\n  if (!isObject(value)) {\n    return false;\n  }\n  // The use of `Object#toString` avoids issues with the `typeof` operator\n  // in Safari 9 which returns 'object' for typed arrays and other constructors.\n  var tag = baseGetTag(value);\n  return tag == funcTag || tag == genTag || tag == asyncTag || tag == proxyTag;\n}\n\n/**\n * Checks if `value` is a valid array-like length.\n *\n * **Note:** This method is loosely based on\n * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n * @example\n *\n * _.isLength(3);\n * // => true\n *\n * _.isLength(Number.MIN_VALUE);\n * // => false\n *\n * _.isLength(Infinity);\n * // => false\n *\n * _.isLength('3');\n * // => false\n */\nfunction isLength(value) {\n  return typeof value == 'number' &&\n    value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n}\n\n/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return value != null && (type == 'object' || type == 'function');\n}\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == 'object';\n}\n\n/**\n * Checks if `value` is classified as a typed array.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n * @example\n *\n * _.isTypedArray(new Uint8Array);\n * // => true\n *\n * _.isTypedArray([]);\n * // => false\n */\nvar isTypedArray = nodeIsTypedArray ? baseUnary(nodeIsTypedArray) : baseIsTypedArray;\n\n/**\n * Creates an array of the own enumerable property names of `object`.\n *\n * **Note:** Non-object values are coerced to objects. See the\n * [ES spec](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n * for more details.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.keys(new Foo);\n * // => ['a', 'b'] (iteration order is not guaranteed)\n *\n * _.keys('hi');\n * // => ['0', '1']\n */\nfunction keys(object) {\n  return isArrayLike(object) ? arrayLikeKeys(object) : baseKeys(object);\n}\n\n/**\n * This method returns a new empty array.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {Array} Returns the new empty array.\n * @example\n *\n * var arrays = _.times(2, _.stubArray);\n *\n * console.log(arrays);\n * // => [[], []]\n *\n * console.log(arrays[0] === arrays[1]);\n * // => false\n */\nfunction stubArray() {\n  return [];\n}\n\n/**\n * This method returns `false`.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {boolean} Returns `false`.\n * @example\n *\n * _.times(2, _.stubFalse);\n * // => [false, false]\n */\nfunction stubFalse() {\n  return false;\n}\n\nmodule.exports = isEqual;\n","/**\n * lodash (Custom Build) <https://lodash.com/>\n * Build: `lodash modularize exports=\"npm\" -o ./`\n * Copyright jQuery Foundation and other contributors <https://jquery.org/>\n * Released under MIT license <https://lodash.com/license>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n */\n\n/** Used as the `TypeError` message for \"Functions\" methods. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/** Used as references for various `Number` constants. */\nvar NAN = 0 / 0;\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/** Used to match leading and trailing whitespace. */\nvar reTrim = /^\\s+|\\s+$/g;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objectToString = objectProto.toString;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max,\n    nativeMin = Math.min;\n\n/**\n * Gets the timestamp of the number of milliseconds that have elapsed since\n * the Unix epoch (1 January 1970 00:00:00 UTC).\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Date\n * @returns {number} Returns the timestamp.\n * @example\n *\n * _.defer(function(stamp) {\n *   console.log(_.now() - stamp);\n * }, _.now());\n * // => Logs the number of milliseconds it took for the deferred invocation.\n */\nvar now = function() {\n  return root.Date.now();\n};\n\n/**\n * Creates a debounced function that delays invoking `func` until after `wait`\n * milliseconds have elapsed since the last time the debounced function was\n * invoked. The debounced function comes with a `cancel` method to cancel\n * delayed `func` invocations and a `flush` method to immediately invoke them.\n * Provide `options` to indicate whether `func` should be invoked on the\n * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n * with the last arguments provided to the debounced function. Subsequent\n * calls to the debounced function return the result of the last `func`\n * invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the debounced function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.debounce` and `_.throttle`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to debounce.\n * @param {number} [wait=0] The number of milliseconds to delay.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=false]\n *  Specify invoking on the leading edge of the timeout.\n * @param {number} [options.maxWait]\n *  The maximum time `func` is allowed to be delayed before it's invoked.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new debounced function.\n * @example\n *\n * // Avoid costly calculations while the window size is in flux.\n * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n *\n * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n * jQuery(element).on('click', _.debounce(sendMail, 300, {\n *   'leading': true,\n *   'trailing': false\n * }));\n *\n * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n * var source = new EventSource('/stream');\n * jQuery(source).on('message', debounced);\n *\n * // Cancel the trailing debounced invocation.\n * jQuery(window).on('popstate', debounced.cancel);\n */\nfunction debounce(func, wait, options) {\n  var lastArgs,\n      lastThis,\n      maxWait,\n      result,\n      timerId,\n      lastCallTime,\n      lastInvokeTime = 0,\n      leading = false,\n      maxing = false,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  wait = toNumber(wait) || 0;\n  if (isObject(options)) {\n    leading = !!options.leading;\n    maxing = 'maxWait' in options;\n    maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n\n  function invokeFunc(time) {\n    var args = lastArgs,\n        thisArg = lastThis;\n\n    lastArgs = lastThis = undefined;\n    lastInvokeTime = time;\n    result = func.apply(thisArg, args);\n    return result;\n  }\n\n  function leadingEdge(time) {\n    // Reset any `maxWait` timer.\n    lastInvokeTime = time;\n    // Start the timer for the trailing edge.\n    timerId = setTimeout(timerExpired, wait);\n    // Invoke the leading edge.\n    return leading ? invokeFunc(time) : result;\n  }\n\n  function remainingWait(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime,\n        result = wait - timeSinceLastCall;\n\n    return maxing ? nativeMin(result, maxWait - timeSinceLastInvoke) : result;\n  }\n\n  function shouldInvoke(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime;\n\n    // Either this is the first call, activity has stopped and we're at the\n    // trailing edge, the system time has gone backwards and we're treating\n    // it as the trailing edge, or we've hit the `maxWait` limit.\n    return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n      (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));\n  }\n\n  function timerExpired() {\n    var time = now();\n    if (shouldInvoke(time)) {\n      return trailingEdge(time);\n    }\n    // Restart the timer.\n    timerId = setTimeout(timerExpired, remainingWait(time));\n  }\n\n  function trailingEdge(time) {\n    timerId = undefined;\n\n    // Only invoke if we have `lastArgs` which means `func` has been\n    // debounced at least once.\n    if (trailing && lastArgs) {\n      return invokeFunc(time);\n    }\n    lastArgs = lastThis = undefined;\n    return result;\n  }\n\n  function cancel() {\n    if (timerId !== undefined) {\n      clearTimeout(timerId);\n    }\n    lastInvokeTime = 0;\n    lastArgs = lastCallTime = lastThis = timerId = undefined;\n  }\n\n  function flush() {\n    return timerId === undefined ? result : trailingEdge(now());\n  }\n\n  function debounced() {\n    var time = now(),\n        isInvoking = shouldInvoke(time);\n\n    lastArgs = arguments;\n    lastThis = this;\n    lastCallTime = time;\n\n    if (isInvoking) {\n      if (timerId === undefined) {\n        return leadingEdge(lastCallTime);\n      }\n      if (maxing) {\n        // Handle invocations in a tight loop.\n        timerId = setTimeout(timerExpired, wait);\n        return invokeFunc(lastCallTime);\n      }\n    }\n    if (timerId === undefined) {\n      timerId = setTimeout(timerExpired, wait);\n    }\n    return result;\n  }\n  debounced.cancel = cancel;\n  debounced.flush = flush;\n  return debounced;\n}\n\n/**\n * Creates a throttled function that only invokes `func` at most once per\n * every `wait` milliseconds. The throttled function comes with a `cancel`\n * method to cancel delayed `func` invocations and a `flush` method to\n * immediately invoke them. Provide `options` to indicate whether `func`\n * should be invoked on the leading and/or trailing edge of the `wait`\n * timeout. The `func` is invoked with the last arguments provided to the\n * throttled function. Subsequent calls to the throttled function return the\n * result of the last `func` invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the throttled function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.throttle` and `_.debounce`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to throttle.\n * @param {number} [wait=0] The number of milliseconds to throttle invocations to.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=true]\n *  Specify invoking on the leading edge of the timeout.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new throttled function.\n * @example\n *\n * // Avoid excessively updating the position while scrolling.\n * jQuery(window).on('scroll', _.throttle(updatePosition, 100));\n *\n * // Invoke `renewToken` when the click event is fired, but not more than once every 5 minutes.\n * var throttled = _.throttle(renewToken, 300000, { 'trailing': false });\n * jQuery(element).on('click', throttled);\n *\n * // Cancel the trailing throttled invocation.\n * jQuery(window).on('popstate', throttled.cancel);\n */\nfunction throttle(func, wait, options) {\n  var leading = true,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  if (isObject(options)) {\n    leading = 'leading' in options ? !!options.leading : leading;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n  return debounce(func, wait, {\n    'leading': leading,\n    'maxWait': wait,\n    'trailing': trailing\n  });\n}\n\n/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return !!value && (type == 'object' || type == 'function');\n}\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return !!value && typeof value == 'object';\n}\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && objectToString.call(value) == symbolTag);\n}\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  if (isObject(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject(other) ? (other + '') : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = value.replace(reTrim, '');\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\nmodule.exports = throttle;\n","/**\n * lodash (Custom Build) <https://lodash.com/>\n * Build: `lodash modularize exports=\"npm\" -o ./`\n * Copyright jQuery Foundation and other contributors <https://jquery.org/>\n * Released under MIT license <https://lodash.com/license>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n */\n\n/** Used as the size to enable large array optimizations. */\nvar LARGE_ARRAY_SIZE = 200;\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/** `Object#toString` result references. */\nvar funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]';\n\n/**\n * Used to match `RegExp`\n * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).\n */\nvar reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g;\n\n/** Used to detect host constructors (Safari). */\nvar reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\n/**\n * A specialized version of `_.includes` for arrays without support for\n * specifying an index to search from.\n *\n * @private\n * @param {Array} [array] The array to inspect.\n * @param {*} target The value to search for.\n * @returns {boolean} Returns `true` if `target` is found, else `false`.\n */\nfunction arrayIncludes(array, value) {\n  var length = array ? array.length : 0;\n  return !!length && baseIndexOf(array, value, 0) > -1;\n}\n\n/**\n * This function is like `arrayIncludes` except that it accepts a comparator.\n *\n * @private\n * @param {Array} [array] The array to inspect.\n * @param {*} target The value to search for.\n * @param {Function} comparator The comparator invoked per element.\n * @returns {boolean} Returns `true` if `target` is found, else `false`.\n */\nfunction arrayIncludesWith(array, value, comparator) {\n  var index = -1,\n      length = array ? array.length : 0;\n\n  while (++index < length) {\n    if (comparator(value, array[index])) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * The base implementation of `_.findIndex` and `_.findLastIndex` without\n * support for iteratee shorthands.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {Function} predicate The function invoked per iteration.\n * @param {number} fromIndex The index to search from.\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction baseFindIndex(array, predicate, fromIndex, fromRight) {\n  var length = array.length,\n      index = fromIndex + (fromRight ? 1 : -1);\n\n  while ((fromRight ? index-- : ++index < length)) {\n    if (predicate(array[index], index, array)) {\n      return index;\n    }\n  }\n  return -1;\n}\n\n/**\n * The base implementation of `_.indexOf` without `fromIndex` bounds checks.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} value The value to search for.\n * @param {number} fromIndex The index to search from.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction baseIndexOf(array, value, fromIndex) {\n  if (value !== value) {\n    return baseFindIndex(array, baseIsNaN, fromIndex);\n  }\n  var index = fromIndex - 1,\n      length = array.length;\n\n  while (++index < length) {\n    if (array[index] === value) {\n      return index;\n    }\n  }\n  return -1;\n}\n\n/**\n * The base implementation of `_.isNaN` without support for number objects.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is `NaN`, else `false`.\n */\nfunction baseIsNaN(value) {\n  return value !== value;\n}\n\n/**\n * Checks if a cache value for `key` exists.\n *\n * @private\n * @param {Object} cache The cache to query.\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction cacheHas(cache, key) {\n  return cache.has(key);\n}\n\n/**\n * Gets the value at `key` of `object`.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {string} key The key of the property to get.\n * @returns {*} Returns the property value.\n */\nfunction getValue(object, key) {\n  return object == null ? undefined : object[key];\n}\n\n/**\n * Checks if `value` is a host object in IE < 9.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a host object, else `false`.\n */\nfunction isHostObject(value) {\n  // Many host objects are `Object` objects that can coerce to strings\n  // despite having improperly defined `toString` methods.\n  var result = false;\n  if (value != null && typeof value.toString != 'function') {\n    try {\n      result = !!(value + '');\n    } catch (e) {}\n  }\n  return result;\n}\n\n/**\n * Converts `set` to an array of its values.\n *\n * @private\n * @param {Object} set The set to convert.\n * @returns {Array} Returns the values.\n */\nfunction setToArray(set) {\n  var index = -1,\n      result = Array(set.size);\n\n  set.forEach(function(value) {\n    result[++index] = value;\n  });\n  return result;\n}\n\n/** Used for built-in method references. */\nvar arrayProto = Array.prototype,\n    funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to detect overreaching core-js shims. */\nvar coreJsData = root['__core-js_shared__'];\n\n/** Used to detect methods masquerading as native. */\nvar maskSrcKey = (function() {\n  var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || '');\n  return uid ? ('Symbol(src)_1.' + uid) : '';\n}());\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objectToString = objectProto.toString;\n\n/** Used to detect if a method is native. */\nvar reIsNative = RegExp('^' +\n  funcToString.call(hasOwnProperty).replace(reRegExpChar, '\\\\$&')\n  .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n);\n\n/** Built-in value references. */\nvar splice = arrayProto.splice;\n\n/* Built-in method references that are verified to be native. */\nvar Map = getNative(root, 'Map'),\n    Set = getNative(root, 'Set'),\n    nativeCreate = getNative(Object, 'create');\n\n/**\n * Creates a hash object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Hash(entries) {\n  var index = -1,\n      length = entries ? entries.length : 0;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n/**\n * Removes all key-value entries from the hash.\n *\n * @private\n * @name clear\n * @memberOf Hash\n */\nfunction hashClear() {\n  this.__data__ = nativeCreate ? nativeCreate(null) : {};\n}\n\n/**\n * Removes `key` and its value from the hash.\n *\n * @private\n * @name delete\n * @memberOf Hash\n * @param {Object} hash The hash to modify.\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction hashDelete(key) {\n  return this.has(key) && delete this.__data__[key];\n}\n\n/**\n * Gets the hash value for `key`.\n *\n * @private\n * @name get\n * @memberOf Hash\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction hashGet(key) {\n  var data = this.__data__;\n  if (nativeCreate) {\n    var result = data[key];\n    return result === HASH_UNDEFINED ? undefined : result;\n  }\n  return hasOwnProperty.call(data, key) ? data[key] : undefined;\n}\n\n/**\n * Checks if a hash value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Hash\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction hashHas(key) {\n  var data = this.__data__;\n  return nativeCreate ? data[key] !== undefined : hasOwnProperty.call(data, key);\n}\n\n/**\n * Sets the hash `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Hash\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the hash instance.\n */\nfunction hashSet(key, value) {\n  var data = this.__data__;\n  data[key] = (nativeCreate && value === undefined) ? HASH_UNDEFINED : value;\n  return this;\n}\n\n// Add methods to `Hash`.\nHash.prototype.clear = hashClear;\nHash.prototype['delete'] = hashDelete;\nHash.prototype.get = hashGet;\nHash.prototype.has = hashHas;\nHash.prototype.set = hashSet;\n\n/**\n * Creates an list cache object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction ListCache(entries) {\n  var index = -1,\n      length = entries ? entries.length : 0;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n/**\n * Removes all key-value entries from the list cache.\n *\n * @private\n * @name clear\n * @memberOf ListCache\n */\nfunction listCacheClear() {\n  this.__data__ = [];\n}\n\n/**\n * Removes `key` and its value from the list cache.\n *\n * @private\n * @name delete\n * @memberOf ListCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction listCacheDelete(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    return false;\n  }\n  var lastIndex = data.length - 1;\n  if (index == lastIndex) {\n    data.pop();\n  } else {\n    splice.call(data, index, 1);\n  }\n  return true;\n}\n\n/**\n * Gets the list cache value for `key`.\n *\n * @private\n * @name get\n * @memberOf ListCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction listCacheGet(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  return index < 0 ? undefined : data[index][1];\n}\n\n/**\n * Checks if a list cache value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf ListCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction listCacheHas(key) {\n  return assocIndexOf(this.__data__, key) > -1;\n}\n\n/**\n * Sets the list cache `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf ListCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the list cache instance.\n */\nfunction listCacheSet(key, value) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    data.push([key, value]);\n  } else {\n    data[index][1] = value;\n  }\n  return this;\n}\n\n// Add methods to `ListCache`.\nListCache.prototype.clear = listCacheClear;\nListCache.prototype['delete'] = listCacheDelete;\nListCache.prototype.get = listCacheGet;\nListCache.prototype.has = listCacheHas;\nListCache.prototype.set = listCacheSet;\n\n/**\n * Creates a map cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction MapCache(entries) {\n  var index = -1,\n      length = entries ? entries.length : 0;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n/**\n * Removes all key-value entries from the map.\n *\n * @private\n * @name clear\n * @memberOf MapCache\n */\nfunction mapCacheClear() {\n  this.__data__ = {\n    'hash': new Hash,\n    'map': new (Map || ListCache),\n    'string': new Hash\n  };\n}\n\n/**\n * Removes `key` and its value from the map.\n *\n * @private\n * @name delete\n * @memberOf MapCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction mapCacheDelete(key) {\n  return getMapData(this, key)['delete'](key);\n}\n\n/**\n * Gets the map value for `key`.\n *\n * @private\n * @name get\n * @memberOf MapCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction mapCacheGet(key) {\n  return getMapData(this, key).get(key);\n}\n\n/**\n * Checks if a map value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf MapCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction mapCacheHas(key) {\n  return getMapData(this, key).has(key);\n}\n\n/**\n * Sets the map `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf MapCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the map cache instance.\n */\nfunction mapCacheSet(key, value) {\n  getMapData(this, key).set(key, value);\n  return this;\n}\n\n// Add methods to `MapCache`.\nMapCache.prototype.clear = mapCacheClear;\nMapCache.prototype['delete'] = mapCacheDelete;\nMapCache.prototype.get = mapCacheGet;\nMapCache.prototype.has = mapCacheHas;\nMapCache.prototype.set = mapCacheSet;\n\n/**\n *\n * Creates an array cache object to store unique values.\n *\n * @private\n * @constructor\n * @param {Array} [values] The values to cache.\n */\nfunction SetCache(values) {\n  var index = -1,\n      length = values ? values.length : 0;\n\n  this.__data__ = new MapCache;\n  while (++index < length) {\n    this.add(values[index]);\n  }\n}\n\n/**\n * Adds `value` to the array cache.\n *\n * @private\n * @name add\n * @memberOf SetCache\n * @alias push\n * @param {*} value The value to cache.\n * @returns {Object} Returns the cache instance.\n */\nfunction setCacheAdd(value) {\n  this.__data__.set(value, HASH_UNDEFINED);\n  return this;\n}\n\n/**\n * Checks if `value` is in the array cache.\n *\n * @private\n * @name has\n * @memberOf SetCache\n * @param {*} value The value to search for.\n * @returns {number} Returns `true` if `value` is found, else `false`.\n */\nfunction setCacheHas(value) {\n  return this.__data__.has(value);\n}\n\n// Add methods to `SetCache`.\nSetCache.prototype.add = SetCache.prototype.push = setCacheAdd;\nSetCache.prototype.has = setCacheHas;\n\n/**\n * Gets the index at which the `key` is found in `array` of key-value pairs.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} key The key to search for.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction assocIndexOf(array, key) {\n  var length = array.length;\n  while (length--) {\n    if (eq(array[length][0], key)) {\n      return length;\n    }\n  }\n  return -1;\n}\n\n/**\n * The base implementation of `_.isNative` without bad shim checks.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a native function,\n *  else `false`.\n */\nfunction baseIsNative(value) {\n  if (!isObject(value) || isMasked(value)) {\n    return false;\n  }\n  var pattern = (isFunction(value) || isHostObject(value)) ? reIsNative : reIsHostCtor;\n  return pattern.test(toSource(value));\n}\n\n/**\n * The base implementation of `_.uniqBy` without support for iteratee shorthands.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {Function} [iteratee] The iteratee invoked per element.\n * @param {Function} [comparator] The comparator invoked per element.\n * @returns {Array} Returns the new duplicate free array.\n */\nfunction baseUniq(array, iteratee, comparator) {\n  var index = -1,\n      includes = arrayIncludes,\n      length = array.length,\n      isCommon = true,\n      result = [],\n      seen = result;\n\n  if (comparator) {\n    isCommon = false;\n    includes = arrayIncludesWith;\n  }\n  else if (length >= LARGE_ARRAY_SIZE) {\n    var set = iteratee ? null : createSet(array);\n    if (set) {\n      return setToArray(set);\n    }\n    isCommon = false;\n    includes = cacheHas;\n    seen = new SetCache;\n  }\n  else {\n    seen = iteratee ? [] : result;\n  }\n  outer:\n  while (++index < length) {\n    var value = array[index],\n        computed = iteratee ? iteratee(value) : value;\n\n    value = (comparator || value !== 0) ? value : 0;\n    if (isCommon && computed === computed) {\n      var seenIndex = seen.length;\n      while (seenIndex--) {\n        if (seen[seenIndex] === computed) {\n          continue outer;\n        }\n      }\n      if (iteratee) {\n        seen.push(computed);\n      }\n      result.push(value);\n    }\n    else if (!includes(seen, computed, comparator)) {\n      if (seen !== result) {\n        seen.push(computed);\n      }\n      result.push(value);\n    }\n  }\n  return result;\n}\n\n/**\n * Creates a set object of `values`.\n *\n * @private\n * @param {Array} values The values to add to the set.\n * @returns {Object} Returns the new set.\n */\nvar createSet = !(Set && (1 / setToArray(new Set([,-0]))[1]) == INFINITY) ? noop : function(values) {\n  return new Set(values);\n};\n\n/**\n * Gets the data for `map`.\n *\n * @private\n * @param {Object} map The map to query.\n * @param {string} key The reference key.\n * @returns {*} Returns the map data.\n */\nfunction getMapData(map, key) {\n  var data = map.__data__;\n  return isKeyable(key)\n    ? data[typeof key == 'string' ? 'string' : 'hash']\n    : data.map;\n}\n\n/**\n * Gets the native function at `key` of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {string} key The key of the method to get.\n * @returns {*} Returns the function if it's native, else `undefined`.\n */\nfunction getNative(object, key) {\n  var value = getValue(object, key);\n  return baseIsNative(value) ? value : undefined;\n}\n\n/**\n * Checks if `value` is suitable for use as unique object key.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is suitable, else `false`.\n */\nfunction isKeyable(value) {\n  var type = typeof value;\n  return (type == 'string' || type == 'number' || type == 'symbol' || type == 'boolean')\n    ? (value !== '__proto__')\n    : (value === null);\n}\n\n/**\n * Checks if `func` has its source masked.\n *\n * @private\n * @param {Function} func The function to check.\n * @returns {boolean} Returns `true` if `func` is masked, else `false`.\n */\nfunction isMasked(func) {\n  return !!maskSrcKey && (maskSrcKey in func);\n}\n\n/**\n * Converts `func` to its source code.\n *\n * @private\n * @param {Function} func The function to process.\n * @returns {string} Returns the source code.\n */\nfunction toSource(func) {\n  if (func != null) {\n    try {\n      return funcToString.call(func);\n    } catch (e) {}\n    try {\n      return (func + '');\n    } catch (e) {}\n  }\n  return '';\n}\n\n/**\n * Creates a duplicate-free version of an array, using\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * for equality comparisons, in which only the first occurrence of each\n * element is kept.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Array\n * @param {Array} array The array to inspect.\n * @returns {Array} Returns the new duplicate free array.\n * @example\n *\n * _.uniq([2, 1, 2]);\n * // => [2, 1]\n */\nfunction uniq(array) {\n  return (array && array.length)\n    ? baseUniq(array)\n    : [];\n}\n\n/**\n * Performs a\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * comparison between two values to determine if they are equivalent.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.eq(object, object);\n * // => true\n *\n * _.eq(object, other);\n * // => false\n *\n * _.eq('a', 'a');\n * // => true\n *\n * _.eq('a', Object('a'));\n * // => false\n *\n * _.eq(NaN, NaN);\n * // => true\n */\nfunction eq(value, other) {\n  return value === other || (value !== value && other !== other);\n}\n\n/**\n * Checks if `value` is classified as a `Function` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n *\n * _.isFunction(/abc/);\n * // => false\n */\nfunction isFunction(value) {\n  // The use of `Object#toString` avoids issues with the `typeof` operator\n  // in Safari 8-9 which returns 'object' for typed array and other constructors.\n  var tag = isObject(value) ? objectToString.call(value) : '';\n  return tag == funcTag || tag == genTag;\n}\n\n/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return !!value && (type == 'object' || type == 'function');\n}\n\n/**\n * This method returns `undefined`.\n *\n * @static\n * @memberOf _\n * @since 2.3.0\n * @category Util\n * @example\n *\n * _.times(2, _.noop);\n * // => [undefined, undefined]\n */\nfunction noop() {\n  // No operation performed.\n}\n\nmodule.exports = uniq;\n","// Copyright (c) 2013 Pieroxy <pieroxy@pieroxy.net>\n// This work is free. You can redistribute it and/or modify it\n// under the terms of the WTFPL, Version 2\n// For more information see LICENSE.txt or http://www.wtfpl.net/\n//\n// For more information, the home page:\n// http://pieroxy.net/blog/pages/lz-string/testing.html\n//\n// LZ-based compression algorithm, version 1.4.5\nvar LZString = (function() {\n\n// private property\nvar f = String.fromCharCode;\nvar keyStrBase64 = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\";\nvar keyStrUriSafe = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$\";\nvar baseReverseDic = {};\n\nfunction getBaseValue(alphabet, character) {\n  if (!baseReverseDic[alphabet]) {\n    baseReverseDic[alphabet] = {};\n    for (var i=0 ; i<alphabet.length ; i++) {\n      baseReverseDic[alphabet][alphabet.charAt(i)] = i;\n    }\n  }\n  return baseReverseDic[alphabet][character];\n}\n\nvar LZString = {\n  compressToBase64 : function (input) {\n    if (input == null) return \"\";\n    var res = LZString._compress(input, 6, function(a){return keyStrBase64.charAt(a);});\n    switch (res.length % 4) { // To produce valid Base64\n    default: // When could this happen ?\n    case 0 : return res;\n    case 1 : return res+\"===\";\n    case 2 : return res+\"==\";\n    case 3 : return res+\"=\";\n    }\n  },\n\n  decompressFromBase64 : function (input) {\n    if (input == null) return \"\";\n    if (input == \"\") return null;\n    return LZString._decompress(input.length, 32, function(index) { return getBaseValue(keyStrBase64, input.charAt(index)); });\n  },\n\n  compressToUTF16 : function (input) {\n    if (input == null) return \"\";\n    return LZString._compress(input, 15, function(a){return f(a+32);}) + \" \";\n  },\n\n  decompressFromUTF16: function (compressed) {\n    if (compressed == null) return \"\";\n    if (compressed == \"\") return null;\n    return LZString._decompress(compressed.length, 16384, function(index) { return compressed.charCodeAt(index) - 32; });\n  },\n\n  //compress into uint8array (UCS-2 big endian format)\n  compressToUint8Array: function (uncompressed) {\n    var compressed = LZString.compress(uncompressed);\n    var buf=new Uint8Array(compressed.length*2); // 2 bytes per character\n\n    for (var i=0, TotalLen=compressed.length; i<TotalLen; i++) {\n      var current_value = compressed.charCodeAt(i);\n      buf[i*2] = current_value >>> 8;\n      buf[i*2+1] = current_value % 256;\n    }\n    return buf;\n  },\n\n  //decompress from uint8array (UCS-2 big endian format)\n  decompressFromUint8Array:function (compressed) {\n    if (compressed===null || compressed===undefined){\n        return LZString.decompress(compressed);\n    } else {\n        var buf=new Array(compressed.length/2); // 2 bytes per character\n        for (var i=0, TotalLen=buf.length; i<TotalLen; i++) {\n          buf[i]=compressed[i*2]*256+compressed[i*2+1];\n        }\n\n        var result = [];\n        buf.forEach(function (c) {\n          result.push(f(c));\n        });\n        return LZString.decompress(result.join(''));\n\n    }\n\n  },\n\n\n  //compress into a string that is already URI encoded\n  compressToEncodedURIComponent: function (input) {\n    if (input == null) return \"\";\n    return LZString._compress(input, 6, function(a){return keyStrUriSafe.charAt(a);});\n  },\n\n  //decompress from an output of compressToEncodedURIComponent\n  decompressFromEncodedURIComponent:function (input) {\n    if (input == null) return \"\";\n    if (input == \"\") return null;\n    input = input.replace(/ /g, \"+\");\n    return LZString._decompress(input.length, 32, function(index) { return getBaseValue(keyStrUriSafe, input.charAt(index)); });\n  },\n\n  compress: function (uncompressed) {\n    return LZString._compress(uncompressed, 16, function(a){return f(a);});\n  },\n  _compress: function (uncompressed, bitsPerChar, getCharFromInt) {\n    if (uncompressed == null) return \"\";\n    var i, value,\n        context_dictionary= {},\n        context_dictionaryToCreate= {},\n        context_c=\"\",\n        context_wc=\"\",\n        context_w=\"\",\n        context_enlargeIn= 2, // Compensate for the first entry which should not count\n        context_dictSize= 3,\n        context_numBits= 2,\n        context_data=[],\n        context_data_val=0,\n        context_data_position=0,\n        ii;\n\n    for (ii = 0; ii < uncompressed.length; ii += 1) {\n      context_c = uncompressed.charAt(ii);\n      if (!Object.prototype.hasOwnProperty.call(context_dictionary,context_c)) {\n        context_dictionary[context_c] = context_dictSize++;\n        context_dictionaryToCreate[context_c] = true;\n      }\n\n      context_wc = context_w + context_c;\n      if (Object.prototype.hasOwnProperty.call(context_dictionary,context_wc)) {\n        context_w = context_wc;\n      } else {\n        if (Object.prototype.hasOwnProperty.call(context_dictionaryToCreate,context_w)) {\n          if (context_w.charCodeAt(0)<256) {\n            for (i=0 ; i<context_numBits ; i++) {\n              context_data_val = (context_data_val << 1);\n              if (context_data_position == bitsPerChar-1) {\n                context_data_position = 0;\n                context_data.push(getCharFromInt(context_data_val));\n                context_data_val = 0;\n              } else {\n                context_data_position++;\n              }\n            }\n            value = context_w.charCodeAt(0);\n            for (i=0 ; i<8 ; i++) {\n              context_data_val = (context_data_val << 1) | (value&1);\n              if (context_data_position == bitsPerChar-1) {\n                context_data_position = 0;\n                context_data.push(getCharFromInt(context_data_val));\n                context_data_val = 0;\n              } else {\n                context_data_position++;\n              }\n              value = value >> 1;\n            }\n          } else {\n            value = 1;\n            for (i=0 ; i<context_numBits ; i++) {\n              context_data_val = (context_data_val << 1) | value;\n              if (context_data_position ==bitsPerChar-1) {\n                context_data_position = 0;\n                context_data.push(getCharFromInt(context_data_val));\n                context_data_val = 0;\n              } else {\n                context_data_position++;\n              }\n              value = 0;\n            }\n            value = context_w.charCodeAt(0);\n            for (i=0 ; i<16 ; i++) {\n              context_data_val = (context_data_val << 1) | (value&1);\n              if (context_data_position == bitsPerChar-1) {\n                context_data_position = 0;\n                context_data.push(getCharFromInt(context_data_val));\n                context_data_val = 0;\n              } else {\n                context_data_position++;\n              }\n              value = value >> 1;\n            }\n          }\n          context_enlargeIn--;\n          if (context_enlargeIn == 0) {\n            context_enlargeIn = Math.pow(2, context_numBits);\n            context_numBits++;\n          }\n          delete context_dictionaryToCreate[context_w];\n        } else {\n          value = context_dictionary[context_w];\n          for (i=0 ; i<context_numBits ; i++) {\n            context_data_val = (context_data_val << 1) | (value&1);\n            if (context_data_position == bitsPerChar-1) {\n              context_data_position = 0;\n              context_data.push(getCharFromInt(context_data_val));\n              context_data_val = 0;\n            } else {\n              context_data_position++;\n            }\n            value = value >> 1;\n          }\n\n\n        }\n        context_enlargeIn--;\n        if (context_enlargeIn == 0) {\n          context_enlargeIn = Math.pow(2, context_numBits);\n          context_numBits++;\n        }\n        // Add wc to the dictionary.\n        context_dictionary[context_wc] = context_dictSize++;\n        context_w = String(context_c);\n      }\n    }\n\n    // Output the code for w.\n    if (context_w !== \"\") {\n      if (Object.prototype.hasOwnProperty.call(context_dictionaryToCreate,context_w)) {\n        if (context_w.charCodeAt(0)<256) {\n          for (i=0 ; i<context_numBits ; i++) {\n            context_data_val = (context_data_val << 1);\n            if (context_data_position == bitsPerChar-1) {\n              context_data_position = 0;\n              context_data.push(getCharFromInt(context_data_val));\n              context_data_val = 0;\n            } else {\n              context_data_position++;\n            }\n          }\n          value = context_w.charCodeAt(0);\n          for (i=0 ; i<8 ; i++) {\n            context_data_val = (context_data_val << 1) | (value&1);\n            if (context_data_position == bitsPerChar-1) {\n              context_data_position = 0;\n              context_data.push(getCharFromInt(context_data_val));\n              context_data_val = 0;\n            } else {\n              context_data_position++;\n            }\n            value = value >> 1;\n          }\n        } else {\n          value = 1;\n          for (i=0 ; i<context_numBits ; i++) {\n            context_data_val = (context_data_val << 1) | value;\n            if (context_data_position == bitsPerChar-1) {\n              context_data_position = 0;\n              context_data.push(getCharFromInt(context_data_val));\n              context_data_val = 0;\n            } else {\n              context_data_position++;\n            }\n            value = 0;\n          }\n          value = context_w.charCodeAt(0);\n          for (i=0 ; i<16 ; i++) {\n            context_data_val = (context_data_val << 1) | (value&1);\n            if (context_data_position == bitsPerChar-1) {\n              context_data_position = 0;\n              context_data.push(getCharFromInt(context_data_val));\n              context_data_val = 0;\n            } else {\n              context_data_position++;\n            }\n            value = value >> 1;\n          }\n        }\n        context_enlargeIn--;\n        if (context_enlargeIn == 0) {\n          context_enlargeIn = Math.pow(2, context_numBits);\n          context_numBits++;\n        }\n        delete context_dictionaryToCreate[context_w];\n      } else {\n        value = context_dictionary[context_w];\n        for (i=0 ; i<context_numBits ; i++) {\n          context_data_val = (context_data_val << 1) | (value&1);\n          if (context_data_position == bitsPerChar-1) {\n            context_data_position = 0;\n            context_data.push(getCharFromInt(context_data_val));\n            context_data_val = 0;\n          } else {\n            context_data_position++;\n          }\n          value = value >> 1;\n        }\n\n\n      }\n      context_enlargeIn--;\n      if (context_enlargeIn == 0) {\n        context_enlargeIn = Math.pow(2, context_numBits);\n        context_numBits++;\n      }\n    }\n\n    // Mark the end of the stream\n    value = 2;\n    for (i=0 ; i<context_numBits ; i++) {\n      context_data_val = (context_data_val << 1) | (value&1);\n      if (context_data_position == bitsPerChar-1) {\n        context_data_position = 0;\n        context_data.push(getCharFromInt(context_data_val));\n        context_data_val = 0;\n      } else {\n        context_data_position++;\n      }\n      value = value >> 1;\n    }\n\n    // Flush the last char\n    while (true) {\n      context_data_val = (context_data_val << 1);\n      if (context_data_position == bitsPerChar-1) {\n        context_data.push(getCharFromInt(context_data_val));\n        break;\n      }\n      else context_data_position++;\n    }\n    return context_data.join('');\n  },\n\n  decompress: function (compressed) {\n    if (compressed == null) return \"\";\n    if (compressed == \"\") return null;\n    return LZString._decompress(compressed.length, 32768, function(index) { return compressed.charCodeAt(index); });\n  },\n\n  _decompress: function (length, resetValue, getNextValue) {\n    var dictionary = [],\n        next,\n        enlargeIn = 4,\n        dictSize = 4,\n        numBits = 3,\n        entry = \"\",\n        result = [],\n        i,\n        w,\n        bits, resb, maxpower, power,\n        c,\n        data = {val:getNextValue(0), position:resetValue, index:1};\n\n    for (i = 0; i < 3; i += 1) {\n      dictionary[i] = i;\n    }\n\n    bits = 0;\n    maxpower = Math.pow(2,2);\n    power=1;\n    while (power!=maxpower) {\n      resb = data.val & data.position;\n      data.position >>= 1;\n      if (data.position == 0) {\n        data.position = resetValue;\n        data.val = getNextValue(data.index++);\n      }\n      bits |= (resb>0 ? 1 : 0) * power;\n      power <<= 1;\n    }\n\n    switch (next = bits) {\n      case 0:\n          bits = 0;\n          maxpower = Math.pow(2,8);\n          power=1;\n          while (power!=maxpower) {\n            resb = data.val & data.position;\n            data.position >>= 1;\n            if (data.position == 0) {\n              data.position = resetValue;\n              data.val = getNextValue(data.index++);\n            }\n            bits |= (resb>0 ? 1 : 0) * power;\n            power <<= 1;\n          }\n        c = f(bits);\n        break;\n      case 1:\n          bits = 0;\n          maxpower = Math.pow(2,16);\n          power=1;\n          while (power!=maxpower) {\n            resb = data.val & data.position;\n            data.position >>= 1;\n            if (data.position == 0) {\n              data.position = resetValue;\n              data.val = getNextValue(data.index++);\n            }\n            bits |= (resb>0 ? 1 : 0) * power;\n            power <<= 1;\n          }\n        c = f(bits);\n        break;\n      case 2:\n        return \"\";\n    }\n    dictionary[3] = c;\n    w = c;\n    result.push(c);\n    while (true) {\n      if (data.index > length) {\n        return \"\";\n      }\n\n      bits = 0;\n      maxpower = Math.pow(2,numBits);\n      power=1;\n      while (power!=maxpower) {\n        resb = data.val & data.position;\n        data.position >>= 1;\n        if (data.position == 0) {\n          data.position = resetValue;\n          data.val = getNextValue(data.index++);\n        }\n        bits |= (resb>0 ? 1 : 0) * power;\n        power <<= 1;\n      }\n\n      switch (c = bits) {\n        case 0:\n          bits = 0;\n          maxpower = Math.pow(2,8);\n          power=1;\n          while (power!=maxpower) {\n            resb = data.val & data.position;\n            data.position >>= 1;\n            if (data.position == 0) {\n              data.position = resetValue;\n              data.val = getNextValue(data.index++);\n            }\n            bits |= (resb>0 ? 1 : 0) * power;\n            power <<= 1;\n          }\n\n          dictionary[dictSize++] = f(bits);\n          c = dictSize-1;\n          enlargeIn--;\n          break;\n        case 1:\n          bits = 0;\n          maxpower = Math.pow(2,16);\n          power=1;\n          while (power!=maxpower) {\n            resb = data.val & data.position;\n            data.position >>= 1;\n            if (data.position == 0) {\n              data.position = resetValue;\n              data.val = getNextValue(data.index++);\n            }\n            bits |= (resb>0 ? 1 : 0) * power;\n            power <<= 1;\n          }\n          dictionary[dictSize++] = f(bits);\n          c = dictSize-1;\n          enlargeIn--;\n          break;\n        case 2:\n          return result.join('');\n      }\n\n      if (enlargeIn == 0) {\n        enlargeIn = Math.pow(2, numBits);\n        numBits++;\n      }\n\n      if (dictionary[c]) {\n        entry = dictionary[c];\n      } else {\n        if (c === dictSize) {\n          entry = w + w.charAt(0);\n        } else {\n          return null;\n        }\n      }\n      result.push(entry);\n\n      // Add w+entry[0] to the dictionary.\n      dictionary[dictSize++] = w + entry.charAt(0);\n      enlargeIn--;\n\n      w = entry;\n\n      if (enlargeIn == 0) {\n        enlargeIn = Math.pow(2, numBits);\n        numBits++;\n      }\n\n    }\n  }\n};\n  return LZString;\n})();\n\nif (typeof define === 'function' && define.amd) {\n  define(function () { return LZString; });\n} else if( typeof module !== 'undefined' && module != null ) {\n  module.exports = LZString\n} else if( typeof angular !== 'undefined' && angular != null ) {\n  angular.module('LZString', [])\n  .factory('LZString', function () {\n    return LZString;\n  });\n}\n","/**\n * @license React\n * react-dom.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n/*\n Modernizr 3.0.0pre (Custom Build) | MIT\n*/\n'use strict';var aa=require(\"react\"),ca=require(\"scheduler\");function p(a){for(var b=\"https://reactjs.org/docs/error-decoder.html?invariant=\"+a,c=1;c<arguments.length;c++)b+=\"&args[]=\"+encodeURIComponent(arguments[c]);return\"Minified React error #\"+a+\"; visit \"+b+\" for the full message or use the non-minified dev environment for full errors and additional helpful warnings.\"}var da=new Set,ea={};function fa(a,b){ha(a,b);ha(a+\"Capture\",b)}\nfunction ha(a,b){ea[a]=b;for(a=0;a<b.length;a++)da.add(b[a])}\nvar ia=!(\"undefined\"===typeof window||\"undefined\"===typeof window.document||\"undefined\"===typeof window.document.createElement),ja=Object.prototype.hasOwnProperty,ka=/^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$/,la=\n{},ma={};function oa(a){if(ja.call(ma,a))return!0;if(ja.call(la,a))return!1;if(ka.test(a))return ma[a]=!0;la[a]=!0;return!1}function pa(a,b,c,d){if(null!==c&&0===c.type)return!1;switch(typeof b){case \"function\":case \"symbol\":return!0;case \"boolean\":if(d)return!1;if(null!==c)return!c.acceptsBooleans;a=a.toLowerCase().slice(0,5);return\"data-\"!==a&&\"aria-\"!==a;default:return!1}}\nfunction qa(a,b,c,d){if(null===b||\"undefined\"===typeof b||pa(a,b,c,d))return!0;if(d)return!1;if(null!==c)switch(c.type){case 3:return!b;case 4:return!1===b;case 5:return isNaN(b);case 6:return isNaN(b)||1>b}return!1}function v(a,b,c,d,e,f,g){this.acceptsBooleans=2===b||3===b||4===b;this.attributeName=d;this.attributeNamespace=e;this.mustUseProperty=c;this.propertyName=a;this.type=b;this.sanitizeURL=f;this.removeEmptyString=g}var z={};\n\"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style\".split(\" \").forEach(function(a){z[a]=new v(a,0,!1,a,null,!1,!1)});[[\"acceptCharset\",\"accept-charset\"],[\"className\",\"class\"],[\"htmlFor\",\"for\"],[\"httpEquiv\",\"http-equiv\"]].forEach(function(a){var b=a[0];z[b]=new v(b,1,!1,a[1],null,!1,!1)});[\"contentEditable\",\"draggable\",\"spellCheck\",\"value\"].forEach(function(a){z[a]=new v(a,2,!1,a.toLowerCase(),null,!1,!1)});\n[\"autoReverse\",\"externalResourcesRequired\",\"focusable\",\"preserveAlpha\"].forEach(function(a){z[a]=new v(a,2,!1,a,null,!1,!1)});\"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope\".split(\" \").forEach(function(a){z[a]=new v(a,3,!1,a.toLowerCase(),null,!1,!1)});\n[\"checked\",\"multiple\",\"muted\",\"selected\"].forEach(function(a){z[a]=new v(a,3,!0,a,null,!1,!1)});[\"capture\",\"download\"].forEach(function(a){z[a]=new v(a,4,!1,a,null,!1,!1)});[\"cols\",\"rows\",\"size\",\"span\"].forEach(function(a){z[a]=new v(a,6,!1,a,null,!1,!1)});[\"rowSpan\",\"start\"].forEach(function(a){z[a]=new v(a,5,!1,a.toLowerCase(),null,!1,!1)});var ra=/[\\-:]([a-z])/g;function sa(a){return a[1].toUpperCase()}\n\"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height\".split(\" \").forEach(function(a){var b=a.replace(ra,\nsa);z[b]=new v(b,1,!1,a,null,!1,!1)});\"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type\".split(\" \").forEach(function(a){var b=a.replace(ra,sa);z[b]=new v(b,1,!1,a,\"http://www.w3.org/1999/xlink\",!1,!1)});[\"xml:base\",\"xml:lang\",\"xml:space\"].forEach(function(a){var b=a.replace(ra,sa);z[b]=new v(b,1,!1,a,\"http://www.w3.org/XML/1998/namespace\",!1,!1)});[\"tabIndex\",\"crossOrigin\"].forEach(function(a){z[a]=new v(a,1,!1,a.toLowerCase(),null,!1,!1)});\nz.xlinkHref=new v(\"xlinkHref\",1,!1,\"xlink:href\",\"http://www.w3.org/1999/xlink\",!0,!1);[\"src\",\"href\",\"action\",\"formAction\"].forEach(function(a){z[a]=new v(a,1,!1,a.toLowerCase(),null,!0,!0)});\nfunction ta(a,b,c,d){var e=z.hasOwnProperty(b)?z[b]:null;if(null!==e?0!==e.type:d||!(2<b.length)||\"o\"!==b[0]&&\"O\"!==b[0]||\"n\"!==b[1]&&\"N\"!==b[1])qa(b,c,e,d)&&(c=null),d||null===e?oa(b)&&(null===c?a.removeAttribute(b):a.setAttribute(b,\"\"+c)):e.mustUseProperty?a[e.propertyName]=null===c?3===e.type?!1:\"\":c:(b=e.attributeName,d=e.attributeNamespace,null===c?a.removeAttribute(b):(e=e.type,c=3===e||4===e&&!0===c?\"\":\"\"+c,d?a.setAttributeNS(d,b,c):a.setAttribute(b,c)))}\nvar ua=aa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,va=Symbol.for(\"react.element\"),wa=Symbol.for(\"react.portal\"),ya=Symbol.for(\"react.fragment\"),za=Symbol.for(\"react.strict_mode\"),Aa=Symbol.for(\"react.profiler\"),Ba=Symbol.for(\"react.provider\"),Ca=Symbol.for(\"react.context\"),Da=Symbol.for(\"react.forward_ref\"),Ea=Symbol.for(\"react.suspense\"),Fa=Symbol.for(\"react.suspense_list\"),Ga=Symbol.for(\"react.memo\"),Ha=Symbol.for(\"react.lazy\");Symbol.for(\"react.scope\");Symbol.for(\"react.debug_trace_mode\");\nvar Ia=Symbol.for(\"react.offscreen\");Symbol.for(\"react.legacy_hidden\");Symbol.for(\"react.cache\");Symbol.for(\"react.tracing_marker\");var Ja=Symbol.iterator;function Ka(a){if(null===a||\"object\"!==typeof a)return null;a=Ja&&a[Ja]||a[\"@@iterator\"];return\"function\"===typeof a?a:null}var A=Object.assign,La;function Ma(a){if(void 0===La)try{throw Error();}catch(c){var b=c.stack.trim().match(/\\n( *(at )?)/);La=b&&b[1]||\"\"}return\"\\n\"+La+a}var Na=!1;\nfunction Oa(a,b){if(!a||Na)return\"\";Na=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(b)if(b=function(){throw Error();},Object.defineProperty(b.prototype,\"props\",{set:function(){throw Error();}}),\"object\"===typeof Reflect&&Reflect.construct){try{Reflect.construct(b,[])}catch(l){var d=l}Reflect.construct(a,[],b)}else{try{b.call()}catch(l){d=l}a.call(b.prototype)}else{try{throw Error();}catch(l){d=l}a()}}catch(l){if(l&&d&&\"string\"===typeof l.stack){for(var e=l.stack.split(\"\\n\"),\nf=d.stack.split(\"\\n\"),g=e.length-1,h=f.length-1;1<=g&&0<=h&&e[g]!==f[h];)h--;for(;1<=g&&0<=h;g--,h--)if(e[g]!==f[h]){if(1!==g||1!==h){do if(g--,h--,0>h||e[g]!==f[h]){var k=\"\\n\"+e[g].replace(\" at new \",\" at \");a.displayName&&k.includes(\"<anonymous>\")&&(k=k.replace(\"<anonymous>\",a.displayName));return k}while(1<=g&&0<=h)}break}}}finally{Na=!1,Error.prepareStackTrace=c}return(a=a?a.displayName||a.name:\"\")?Ma(a):\"\"}\nfunction Pa(a){switch(a.tag){case 5:return Ma(a.type);case 16:return Ma(\"Lazy\");case 13:return Ma(\"Suspense\");case 19:return Ma(\"SuspenseList\");case 0:case 2:case 15:return a=Oa(a.type,!1),a;case 11:return a=Oa(a.type.render,!1),a;case 1:return a=Oa(a.type,!0),a;default:return\"\"}}\nfunction Qa(a){if(null==a)return null;if(\"function\"===typeof a)return a.displayName||a.name||null;if(\"string\"===typeof a)return a;switch(a){case ya:return\"Fragment\";case wa:return\"Portal\";case Aa:return\"Profiler\";case za:return\"StrictMode\";case Ea:return\"Suspense\";case Fa:return\"SuspenseList\"}if(\"object\"===typeof a)switch(a.$$typeof){case Ca:return(a.displayName||\"Context\")+\".Consumer\";case Ba:return(a._context.displayName||\"Context\")+\".Provider\";case Da:var b=a.render;a=a.displayName;a||(a=b.displayName||\nb.name||\"\",a=\"\"!==a?\"ForwardRef(\"+a+\")\":\"ForwardRef\");return a;case Ga:return b=a.displayName||null,null!==b?b:Qa(a.type)||\"Memo\";case Ha:b=a._payload;a=a._init;try{return Qa(a(b))}catch(c){}}return null}\nfunction Ra(a){var b=a.type;switch(a.tag){case 24:return\"Cache\";case 9:return(b.displayName||\"Context\")+\".Consumer\";case 10:return(b._context.displayName||\"Context\")+\".Provider\";case 18:return\"DehydratedFragment\";case 11:return a=b.render,a=a.displayName||a.name||\"\",b.displayName||(\"\"!==a?\"ForwardRef(\"+a+\")\":\"ForwardRef\");case 7:return\"Fragment\";case 5:return b;case 4:return\"Portal\";case 3:return\"Root\";case 6:return\"Text\";case 16:return Qa(b);case 8:return b===za?\"StrictMode\":\"Mode\";case 22:return\"Offscreen\";\ncase 12:return\"Profiler\";case 21:return\"Scope\";case 13:return\"Suspense\";case 19:return\"SuspenseList\";case 25:return\"TracingMarker\";case 1:case 0:case 17:case 2:case 14:case 15:if(\"function\"===typeof b)return b.displayName||b.name||null;if(\"string\"===typeof b)return b}return null}function Sa(a){switch(typeof a){case \"boolean\":case \"number\":case \"string\":case \"undefined\":return a;case \"object\":return a;default:return\"\"}}\nfunction Ta(a){var b=a.type;return(a=a.nodeName)&&\"input\"===a.toLowerCase()&&(\"checkbox\"===b||\"radio\"===b)}\nfunction Ua(a){var b=Ta(a)?\"checked\":\"value\",c=Object.getOwnPropertyDescriptor(a.constructor.prototype,b),d=\"\"+a[b];if(!a.hasOwnProperty(b)&&\"undefined\"!==typeof c&&\"function\"===typeof c.get&&\"function\"===typeof c.set){var e=c.get,f=c.set;Object.defineProperty(a,b,{configurable:!0,get:function(){return e.call(this)},set:function(a){d=\"\"+a;f.call(this,a)}});Object.defineProperty(a,b,{enumerable:c.enumerable});return{getValue:function(){return d},setValue:function(a){d=\"\"+a},stopTracking:function(){a._valueTracker=\nnull;delete a[b]}}}}function Va(a){a._valueTracker||(a._valueTracker=Ua(a))}function Wa(a){if(!a)return!1;var b=a._valueTracker;if(!b)return!0;var c=b.getValue();var d=\"\";a&&(d=Ta(a)?a.checked?\"true\":\"false\":a.value);a=d;return a!==c?(b.setValue(a),!0):!1}function Xa(a){a=a||(\"undefined\"!==typeof document?document:void 0);if(\"undefined\"===typeof a)return null;try{return a.activeElement||a.body}catch(b){return a.body}}\nfunction Ya(a,b){var c=b.checked;return A({},b,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=c?c:a._wrapperState.initialChecked})}function Za(a,b){var c=null==b.defaultValue?\"\":b.defaultValue,d=null!=b.checked?b.checked:b.defaultChecked;c=Sa(null!=b.value?b.value:c);a._wrapperState={initialChecked:d,initialValue:c,controlled:\"checkbox\"===b.type||\"radio\"===b.type?null!=b.checked:null!=b.value}}function ab(a,b){b=b.checked;null!=b&&ta(a,\"checked\",b,!1)}\nfunction bb(a,b){ab(a,b);var c=Sa(b.value),d=b.type;if(null!=c)if(\"number\"===d){if(0===c&&\"\"===a.value||a.value!=c)a.value=\"\"+c}else a.value!==\"\"+c&&(a.value=\"\"+c);else if(\"submit\"===d||\"reset\"===d){a.removeAttribute(\"value\");return}b.hasOwnProperty(\"value\")?cb(a,b.type,c):b.hasOwnProperty(\"defaultValue\")&&cb(a,b.type,Sa(b.defaultValue));null==b.checked&&null!=b.defaultChecked&&(a.defaultChecked=!!b.defaultChecked)}\nfunction db(a,b,c){if(b.hasOwnProperty(\"value\")||b.hasOwnProperty(\"defaultValue\")){var d=b.type;if(!(\"submit\"!==d&&\"reset\"!==d||void 0!==b.value&&null!==b.value))return;b=\"\"+a._wrapperState.initialValue;c||b===a.value||(a.value=b);a.defaultValue=b}c=a.name;\"\"!==c&&(a.name=\"\");a.defaultChecked=!!a._wrapperState.initialChecked;\"\"!==c&&(a.name=c)}\nfunction cb(a,b,c){if(\"number\"!==b||Xa(a.ownerDocument)!==a)null==c?a.defaultValue=\"\"+a._wrapperState.initialValue:a.defaultValue!==\"\"+c&&(a.defaultValue=\"\"+c)}var eb=Array.isArray;\nfunction fb(a,b,c,d){a=a.options;if(b){b={};for(var e=0;e<c.length;e++)b[\"$\"+c[e]]=!0;for(c=0;c<a.length;c++)e=b.hasOwnProperty(\"$\"+a[c].value),a[c].selected!==e&&(a[c].selected=e),e&&d&&(a[c].defaultSelected=!0)}else{c=\"\"+Sa(c);b=null;for(e=0;e<a.length;e++){if(a[e].value===c){a[e].selected=!0;d&&(a[e].defaultSelected=!0);return}null!==b||a[e].disabled||(b=a[e])}null!==b&&(b.selected=!0)}}\nfunction gb(a,b){if(null!=b.dangerouslySetInnerHTML)throw Error(p(91));return A({},b,{value:void 0,defaultValue:void 0,children:\"\"+a._wrapperState.initialValue})}function hb(a,b){var c=b.value;if(null==c){c=b.children;b=b.defaultValue;if(null!=c){if(null!=b)throw Error(p(92));if(eb(c)){if(1<c.length)throw Error(p(93));c=c[0]}b=c}null==b&&(b=\"\");c=b}a._wrapperState={initialValue:Sa(c)}}\nfunction ib(a,b){var c=Sa(b.value),d=Sa(b.defaultValue);null!=c&&(c=\"\"+c,c!==a.value&&(a.value=c),null==b.defaultValue&&a.defaultValue!==c&&(a.defaultValue=c));null!=d&&(a.defaultValue=\"\"+d)}function jb(a){var b=a.textContent;b===a._wrapperState.initialValue&&\"\"!==b&&null!==b&&(a.value=b)}function kb(a){switch(a){case \"svg\":return\"http://www.w3.org/2000/svg\";case \"math\":return\"http://www.w3.org/1998/Math/MathML\";default:return\"http://www.w3.org/1999/xhtml\"}}\nfunction lb(a,b){return null==a||\"http://www.w3.org/1999/xhtml\"===a?kb(b):\"http://www.w3.org/2000/svg\"===a&&\"foreignObject\"===b?\"http://www.w3.org/1999/xhtml\":a}\nvar mb,nb=function(a){return\"undefined\"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(b,c,d,e){MSApp.execUnsafeLocalFunction(function(){return a(b,c,d,e)})}:a}(function(a,b){if(\"http://www.w3.org/2000/svg\"!==a.namespaceURI||\"innerHTML\"in a)a.innerHTML=b;else{mb=mb||document.createElement(\"div\");mb.innerHTML=\"<svg>\"+b.valueOf().toString()+\"</svg>\";for(b=mb.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;b.firstChild;)a.appendChild(b.firstChild)}});\nfunction ob(a,b){if(b){var c=a.firstChild;if(c&&c===a.lastChild&&3===c.nodeType){c.nodeValue=b;return}}a.textContent=b}\nvar pb={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,\nzoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qb=[\"Webkit\",\"ms\",\"Moz\",\"O\"];Object.keys(pb).forEach(function(a){qb.forEach(function(b){b=b+a.charAt(0).toUpperCase()+a.substring(1);pb[b]=pb[a]})});function rb(a,b,c){return null==b||\"boolean\"===typeof b||\"\"===b?\"\":c||\"number\"!==typeof b||0===b||pb.hasOwnProperty(a)&&pb[a]?(\"\"+b).trim():b+\"px\"}\nfunction sb(a,b){a=a.style;for(var c in b)if(b.hasOwnProperty(c)){var d=0===c.indexOf(\"--\"),e=rb(c,b[c],d);\"float\"===c&&(c=\"cssFloat\");d?a.setProperty(c,e):a[c]=e}}var tb=A({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});\nfunction ub(a,b){if(b){if(tb[a]&&(null!=b.children||null!=b.dangerouslySetInnerHTML))throw Error(p(137,a));if(null!=b.dangerouslySetInnerHTML){if(null!=b.children)throw Error(p(60));if(\"object\"!==typeof b.dangerouslySetInnerHTML||!(\"__html\"in b.dangerouslySetInnerHTML))throw Error(p(61));}if(null!=b.style&&\"object\"!==typeof b.style)throw Error(p(62));}}\nfunction vb(a,b){if(-1===a.indexOf(\"-\"))return\"string\"===typeof b.is;switch(a){case \"annotation-xml\":case \"color-profile\":case \"font-face\":case \"font-face-src\":case \"font-face-uri\":case \"font-face-format\":case \"font-face-name\":case \"missing-glyph\":return!1;default:return!0}}var wb=null;function xb(a){a=a.target||a.srcElement||window;a.correspondingUseElement&&(a=a.correspondingUseElement);return 3===a.nodeType?a.parentNode:a}var yb=null,zb=null,Ab=null;\nfunction Bb(a){if(a=Cb(a)){if(\"function\"!==typeof yb)throw Error(p(280));var b=a.stateNode;b&&(b=Db(b),yb(a.stateNode,a.type,b))}}function Eb(a){zb?Ab?Ab.push(a):Ab=[a]:zb=a}function Fb(){if(zb){var a=zb,b=Ab;Ab=zb=null;Bb(a);if(b)for(a=0;a<b.length;a++)Bb(b[a])}}function Gb(a,b){return a(b)}function Hb(){}var Ib=!1;function Jb(a,b,c){if(Ib)return a(b,c);Ib=!0;try{return Gb(a,b,c)}finally{if(Ib=!1,null!==zb||null!==Ab)Hb(),Fb()}}\nfunction Kb(a,b){var c=a.stateNode;if(null===c)return null;var d=Db(c);if(null===d)return null;c=d[b];a:switch(b){case \"onClick\":case \"onClickCapture\":case \"onDoubleClick\":case \"onDoubleClickCapture\":case \"onMouseDown\":case \"onMouseDownCapture\":case \"onMouseMove\":case \"onMouseMoveCapture\":case \"onMouseUp\":case \"onMouseUpCapture\":case \"onMouseEnter\":(d=!d.disabled)||(a=a.type,d=!(\"button\"===a||\"input\"===a||\"select\"===a||\"textarea\"===a));a=!d;break a;default:a=!1}if(a)return null;if(c&&\"function\"!==\ntypeof c)throw Error(p(231,b,typeof c));return c}var Lb=!1;if(ia)try{var Mb={};Object.defineProperty(Mb,\"passive\",{get:function(){Lb=!0}});window.addEventListener(\"test\",Mb,Mb);window.removeEventListener(\"test\",Mb,Mb)}catch(a){Lb=!1}function Nb(a,b,c,d,e,f,g,h,k){var l=Array.prototype.slice.call(arguments,3);try{b.apply(c,l)}catch(m){this.onError(m)}}var Ob=!1,Pb=null,Qb=!1,Rb=null,Sb={onError:function(a){Ob=!0;Pb=a}};function Tb(a,b,c,d,e,f,g,h,k){Ob=!1;Pb=null;Nb.apply(Sb,arguments)}\nfunction Ub(a,b,c,d,e,f,g,h,k){Tb.apply(this,arguments);if(Ob){if(Ob){var l=Pb;Ob=!1;Pb=null}else throw Error(p(198));Qb||(Qb=!0,Rb=l)}}function Vb(a){var b=a,c=a;if(a.alternate)for(;b.return;)b=b.return;else{a=b;do b=a,0!==(b.flags&4098)&&(c=b.return),a=b.return;while(a)}return 3===b.tag?c:null}function Wb(a){if(13===a.tag){var b=a.memoizedState;null===b&&(a=a.alternate,null!==a&&(b=a.memoizedState));if(null!==b)return b.dehydrated}return null}function Xb(a){if(Vb(a)!==a)throw Error(p(188));}\nfunction Yb(a){var b=a.alternate;if(!b){b=Vb(a);if(null===b)throw Error(p(188));return b!==a?null:a}for(var c=a,d=b;;){var e=c.return;if(null===e)break;var f=e.alternate;if(null===f){d=e.return;if(null!==d){c=d;continue}break}if(e.child===f.child){for(f=e.child;f;){if(f===c)return Xb(e),a;if(f===d)return Xb(e),b;f=f.sibling}throw Error(p(188));}if(c.return!==d.return)c=e,d=f;else{for(var g=!1,h=e.child;h;){if(h===c){g=!0;c=e;d=f;break}if(h===d){g=!0;d=e;c=f;break}h=h.sibling}if(!g){for(h=f.child;h;){if(h===\nc){g=!0;c=f;d=e;break}if(h===d){g=!0;d=f;c=e;break}h=h.sibling}if(!g)throw Error(p(189));}}if(c.alternate!==d)throw Error(p(190));}if(3!==c.tag)throw Error(p(188));return c.stateNode.current===c?a:b}function Zb(a){a=Yb(a);return null!==a?$b(a):null}function $b(a){if(5===a.tag||6===a.tag)return a;for(a=a.child;null!==a;){var b=$b(a);if(null!==b)return b;a=a.sibling}return null}\nvar ac=ca.unstable_scheduleCallback,bc=ca.unstable_cancelCallback,cc=ca.unstable_shouldYield,dc=ca.unstable_requestPaint,B=ca.unstable_now,ec=ca.unstable_getCurrentPriorityLevel,fc=ca.unstable_ImmediatePriority,gc=ca.unstable_UserBlockingPriority,hc=ca.unstable_NormalPriority,ic=ca.unstable_LowPriority,jc=ca.unstable_IdlePriority,kc=null,lc=null;function mc(a){if(lc&&\"function\"===typeof lc.onCommitFiberRoot)try{lc.onCommitFiberRoot(kc,a,void 0,128===(a.current.flags&128))}catch(b){}}\nvar oc=Math.clz32?Math.clz32:nc,pc=Math.log,qc=Math.LN2;function nc(a){a>>>=0;return 0===a?32:31-(pc(a)/qc|0)|0}var rc=64,sc=4194304;\nfunction tc(a){switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return a&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;\ndefault:return a}}function uc(a,b){var c=a.pendingLanes;if(0===c)return 0;var d=0,e=a.suspendedLanes,f=a.pingedLanes,g=c&268435455;if(0!==g){var h=g&~e;0!==h?d=tc(h):(f&=g,0!==f&&(d=tc(f)))}else g=c&~e,0!==g?d=tc(g):0!==f&&(d=tc(f));if(0===d)return 0;if(0!==b&&b!==d&&0===(b&e)&&(e=d&-d,f=b&-b,e>=f||16===e&&0!==(f&4194240)))return b;0!==(d&4)&&(d|=c&16);b=a.entangledLanes;if(0!==b)for(a=a.entanglements,b&=d;0<b;)c=31-oc(b),e=1<<c,d|=a[c],b&=~e;return d}\nfunction vc(a,b){switch(a){case 1:case 2:case 4:return b+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return b+5E3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}\nfunction wc(a,b){for(var c=a.suspendedLanes,d=a.pingedLanes,e=a.expirationTimes,f=a.pendingLanes;0<f;){var g=31-oc(f),h=1<<g,k=e[g];if(-1===k){if(0===(h&c)||0!==(h&d))e[g]=vc(h,b)}else k<=b&&(a.expiredLanes|=h);f&=~h}}function xc(a){a=a.pendingLanes&-1073741825;return 0!==a?a:a&1073741824?1073741824:0}function yc(){var a=rc;rc<<=1;0===(rc&4194240)&&(rc=64);return a}function zc(a){for(var b=[],c=0;31>c;c++)b.push(a);return b}\nfunction Ac(a,b,c){a.pendingLanes|=b;536870912!==b&&(a.suspendedLanes=0,a.pingedLanes=0);a=a.eventTimes;b=31-oc(b);a[b]=c}function Bc(a,b){var c=a.pendingLanes&~b;a.pendingLanes=b;a.suspendedLanes=0;a.pingedLanes=0;a.expiredLanes&=b;a.mutableReadLanes&=b;a.entangledLanes&=b;b=a.entanglements;var d=a.eventTimes;for(a=a.expirationTimes;0<c;){var e=31-oc(c),f=1<<e;b[e]=0;d[e]=-1;a[e]=-1;c&=~f}}\nfunction Cc(a,b){var c=a.entangledLanes|=b;for(a=a.entanglements;c;){var d=31-oc(c),e=1<<d;e&b|a[d]&b&&(a[d]|=b);c&=~e}}var C=0;function Dc(a){a&=-a;return 1<a?4<a?0!==(a&268435455)?16:536870912:4:1}var Ec,Fc,Gc,Hc,Ic,Jc=!1,Kc=[],Lc=null,Mc=null,Nc=null,Oc=new Map,Pc=new Map,Qc=[],Rc=\"mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit\".split(\" \");\nfunction Sc(a,b){switch(a){case \"focusin\":case \"focusout\":Lc=null;break;case \"dragenter\":case \"dragleave\":Mc=null;break;case \"mouseover\":case \"mouseout\":Nc=null;break;case \"pointerover\":case \"pointerout\":Oc.delete(b.pointerId);break;case \"gotpointercapture\":case \"lostpointercapture\":Pc.delete(b.pointerId)}}\nfunction Tc(a,b,c,d,e,f){if(null===a||a.nativeEvent!==f)return a={blockedOn:b,domEventName:c,eventSystemFlags:d,nativeEvent:f,targetContainers:[e]},null!==b&&(b=Cb(b),null!==b&&Fc(b)),a;a.eventSystemFlags|=d;b=a.targetContainers;null!==e&&-1===b.indexOf(e)&&b.push(e);return a}\nfunction Uc(a,b,c,d,e){switch(b){case \"focusin\":return Lc=Tc(Lc,a,b,c,d,e),!0;case \"dragenter\":return Mc=Tc(Mc,a,b,c,d,e),!0;case \"mouseover\":return Nc=Tc(Nc,a,b,c,d,e),!0;case \"pointerover\":var f=e.pointerId;Oc.set(f,Tc(Oc.get(f)||null,a,b,c,d,e));return!0;case \"gotpointercapture\":return f=e.pointerId,Pc.set(f,Tc(Pc.get(f)||null,a,b,c,d,e)),!0}return!1}\nfunction Vc(a){var b=Wc(a.target);if(null!==b){var c=Vb(b);if(null!==c)if(b=c.tag,13===b){if(b=Wb(c),null!==b){a.blockedOn=b;Ic(a.priority,function(){Gc(c)});return}}else if(3===b&&c.stateNode.current.memoizedState.isDehydrated){a.blockedOn=3===c.tag?c.stateNode.containerInfo:null;return}}a.blockedOn=null}\nfunction Xc(a){if(null!==a.blockedOn)return!1;for(var b=a.targetContainers;0<b.length;){var c=Yc(a.domEventName,a.eventSystemFlags,b[0],a.nativeEvent);if(null===c){c=a.nativeEvent;var d=new c.constructor(c.type,c);wb=d;c.target.dispatchEvent(d);wb=null}else return b=Cb(c),null!==b&&Fc(b),a.blockedOn=c,!1;b.shift()}return!0}function Zc(a,b,c){Xc(a)&&c.delete(b)}function $c(){Jc=!1;null!==Lc&&Xc(Lc)&&(Lc=null);null!==Mc&&Xc(Mc)&&(Mc=null);null!==Nc&&Xc(Nc)&&(Nc=null);Oc.forEach(Zc);Pc.forEach(Zc)}\nfunction ad(a,b){a.blockedOn===b&&(a.blockedOn=null,Jc||(Jc=!0,ca.unstable_scheduleCallback(ca.unstable_NormalPriority,$c)))}\nfunction bd(a){function b(b){return ad(b,a)}if(0<Kc.length){ad(Kc[0],a);for(var c=1;c<Kc.length;c++){var d=Kc[c];d.blockedOn===a&&(d.blockedOn=null)}}null!==Lc&&ad(Lc,a);null!==Mc&&ad(Mc,a);null!==Nc&&ad(Nc,a);Oc.forEach(b);Pc.forEach(b);for(c=0;c<Qc.length;c++)d=Qc[c],d.blockedOn===a&&(d.blockedOn=null);for(;0<Qc.length&&(c=Qc[0],null===c.blockedOn);)Vc(c),null===c.blockedOn&&Qc.shift()}var cd=ua.ReactCurrentBatchConfig,dd=!0;\nfunction ed(a,b,c,d){var e=C,f=cd.transition;cd.transition=null;try{C=1,fd(a,b,c,d)}finally{C=e,cd.transition=f}}function gd(a,b,c,d){var e=C,f=cd.transition;cd.transition=null;try{C=4,fd(a,b,c,d)}finally{C=e,cd.transition=f}}\nfunction fd(a,b,c,d){if(dd){var e=Yc(a,b,c,d);if(null===e)hd(a,b,d,id,c),Sc(a,d);else if(Uc(e,a,b,c,d))d.stopPropagation();else if(Sc(a,d),b&4&&-1<Rc.indexOf(a)){for(;null!==e;){var f=Cb(e);null!==f&&Ec(f);f=Yc(a,b,c,d);null===f&&hd(a,b,d,id,c);if(f===e)break;e=f}null!==e&&d.stopPropagation()}else hd(a,b,d,null,c)}}var id=null;\nfunction Yc(a,b,c,d){id=null;a=xb(d);a=Wc(a);if(null!==a)if(b=Vb(a),null===b)a=null;else if(c=b.tag,13===c){a=Wb(b);if(null!==a)return a;a=null}else if(3===c){if(b.stateNode.current.memoizedState.isDehydrated)return 3===b.tag?b.stateNode.containerInfo:null;a=null}else b!==a&&(a=null);id=a;return null}\nfunction jd(a){switch(a){case \"cancel\":case \"click\":case \"close\":case \"contextmenu\":case \"copy\":case \"cut\":case \"auxclick\":case \"dblclick\":case \"dragend\":case \"dragstart\":case \"drop\":case \"focusin\":case \"focusout\":case \"input\":case \"invalid\":case \"keydown\":case \"keypress\":case \"keyup\":case \"mousedown\":case \"mouseup\":case \"paste\":case \"pause\":case \"play\":case \"pointercancel\":case \"pointerdown\":case \"pointerup\":case \"ratechange\":case \"reset\":case \"resize\":case \"seeked\":case \"submit\":case \"touchcancel\":case \"touchend\":case \"touchstart\":case \"volumechange\":case \"change\":case \"selectionchange\":case \"textInput\":case \"compositionstart\":case \"compositionend\":case \"compositionupdate\":case \"beforeblur\":case \"afterblur\":case \"beforeinput\":case \"blur\":case \"fullscreenchange\":case \"focus\":case \"hashchange\":case \"popstate\":case \"select\":case \"selectstart\":return 1;case \"drag\":case \"dragenter\":case \"dragexit\":case \"dragleave\":case \"dragover\":case \"mousemove\":case \"mouseout\":case \"mouseover\":case \"pointermove\":case \"pointerout\":case \"pointerover\":case \"scroll\":case \"toggle\":case \"touchmove\":case \"wheel\":case \"mouseenter\":case \"mouseleave\":case \"pointerenter\":case \"pointerleave\":return 4;\ncase \"message\":switch(ec()){case fc:return 1;case gc:return 4;case hc:case ic:return 16;case jc:return 536870912;default:return 16}default:return 16}}var kd=null,ld=null,md=null;function nd(){if(md)return md;var a,b=ld,c=b.length,d,e=\"value\"in kd?kd.value:kd.textContent,f=e.length;for(a=0;a<c&&b[a]===e[a];a++);var g=c-a;for(d=1;d<=g&&b[c-d]===e[f-d];d++);return md=e.slice(a,1<d?1-d:void 0)}\nfunction od(a){var b=a.keyCode;\"charCode\"in a?(a=a.charCode,0===a&&13===b&&(a=13)):a=b;10===a&&(a=13);return 32<=a||13===a?a:0}function pd(){return!0}function qd(){return!1}\nfunction rd(a){function b(b,d,e,f,g){this._reactName=b;this._targetInst=e;this.type=d;this.nativeEvent=f;this.target=g;this.currentTarget=null;for(var c in a)a.hasOwnProperty(c)&&(b=a[c],this[c]=b?b(f):f[c]);this.isDefaultPrevented=(null!=f.defaultPrevented?f.defaultPrevented:!1===f.returnValue)?pd:qd;this.isPropagationStopped=qd;return this}A(b.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():\"unknown\"!==typeof a.returnValue&&\n(a.returnValue=!1),this.isDefaultPrevented=pd)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():\"unknown\"!==typeof a.cancelBubble&&(a.cancelBubble=!0),this.isPropagationStopped=pd)},persist:function(){},isPersistent:pd});return b}\nvar sd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},td=rd(sd),ud=A({},sd,{view:0,detail:0}),vd=rd(ud),wd,xd,yd,Ad=A({},ud,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zd,button:0,buttons:0,relatedTarget:function(a){return void 0===a.relatedTarget?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){if(\"movementX\"in\na)return a.movementX;a!==yd&&(yd&&\"mousemove\"===a.type?(wd=a.screenX-yd.screenX,xd=a.screenY-yd.screenY):xd=wd=0,yd=a);return wd},movementY:function(a){return\"movementY\"in a?a.movementY:xd}}),Bd=rd(Ad),Cd=A({},Ad,{dataTransfer:0}),Dd=rd(Cd),Ed=A({},ud,{relatedTarget:0}),Fd=rd(Ed),Gd=A({},sd,{animationName:0,elapsedTime:0,pseudoElement:0}),Hd=rd(Gd),Id=A({},sd,{clipboardData:function(a){return\"clipboardData\"in a?a.clipboardData:window.clipboardData}}),Jd=rd(Id),Kd=A({},sd,{data:0}),Ld=rd(Kd),Md={Esc:\"Escape\",\nSpacebar:\" \",Left:\"ArrowLeft\",Up:\"ArrowUp\",Right:\"ArrowRight\",Down:\"ArrowDown\",Del:\"Delete\",Win:\"OS\",Menu:\"ContextMenu\",Apps:\"ContextMenu\",Scroll:\"ScrollLock\",MozPrintableKey:\"Unidentified\"},Nd={8:\"Backspace\",9:\"Tab\",12:\"Clear\",13:\"Enter\",16:\"Shift\",17:\"Control\",18:\"Alt\",19:\"Pause\",20:\"CapsLock\",27:\"Escape\",32:\" \",33:\"PageUp\",34:\"PageDown\",35:\"End\",36:\"Home\",37:\"ArrowLeft\",38:\"ArrowUp\",39:\"ArrowRight\",40:\"ArrowDown\",45:\"Insert\",46:\"Delete\",112:\"F1\",113:\"F2\",114:\"F3\",115:\"F4\",116:\"F5\",117:\"F6\",118:\"F7\",\n119:\"F8\",120:\"F9\",121:\"F10\",122:\"F11\",123:\"F12\",144:\"NumLock\",145:\"ScrollLock\",224:\"Meta\"},Od={Alt:\"altKey\",Control:\"ctrlKey\",Meta:\"metaKey\",Shift:\"shiftKey\"};function Pd(a){var b=this.nativeEvent;return b.getModifierState?b.getModifierState(a):(a=Od[a])?!!b[a]:!1}function zd(){return Pd}\nvar Qd=A({},ud,{key:function(a){if(a.key){var b=Md[a.key]||a.key;if(\"Unidentified\"!==b)return b}return\"keypress\"===a.type?(a=od(a),13===a?\"Enter\":String.fromCharCode(a)):\"keydown\"===a.type||\"keyup\"===a.type?Nd[a.keyCode]||\"Unidentified\":\"\"},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zd,charCode:function(a){return\"keypress\"===a.type?od(a):0},keyCode:function(a){return\"keydown\"===a.type||\"keyup\"===a.type?a.keyCode:0},which:function(a){return\"keypress\"===\na.type?od(a):\"keydown\"===a.type||\"keyup\"===a.type?a.keyCode:0}}),Rd=rd(Qd),Sd=A({},Ad,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Td=rd(Sd),Ud=A({},ud,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zd}),Vd=rd(Ud),Wd=A({},sd,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xd=rd(Wd),Yd=A({},Ad,{deltaX:function(a){return\"deltaX\"in a?a.deltaX:\"wheelDeltaX\"in a?-a.wheelDeltaX:0},\ndeltaY:function(a){return\"deltaY\"in a?a.deltaY:\"wheelDeltaY\"in a?-a.wheelDeltaY:\"wheelDelta\"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),Zd=rd(Yd),$d=[9,13,27,32],ae=ia&&\"CompositionEvent\"in window,be=null;ia&&\"documentMode\"in document&&(be=document.documentMode);var ce=ia&&\"TextEvent\"in window&&!be,de=ia&&(!ae||be&&8<be&&11>=be),ee=String.fromCharCode(32),fe=!1;\nfunction ge(a,b){switch(a){case \"keyup\":return-1!==$d.indexOf(b.keyCode);case \"keydown\":return 229!==b.keyCode;case \"keypress\":case \"mousedown\":case \"focusout\":return!0;default:return!1}}function he(a){a=a.detail;return\"object\"===typeof a&&\"data\"in a?a.data:null}var ie=!1;function je(a,b){switch(a){case \"compositionend\":return he(b);case \"keypress\":if(32!==b.which)return null;fe=!0;return ee;case \"textInput\":return a=b.data,a===ee&&fe?null:a;default:return null}}\nfunction ke(a,b){if(ie)return\"compositionend\"===a||!ae&&ge(a,b)?(a=nd(),md=ld=kd=null,ie=!1,a):null;switch(a){case \"paste\":return null;case \"keypress\":if(!(b.ctrlKey||b.altKey||b.metaKey)||b.ctrlKey&&b.altKey){if(b.char&&1<b.char.length)return b.char;if(b.which)return String.fromCharCode(b.which)}return null;case \"compositionend\":return de&&\"ko\"!==b.locale?null:b.data;default:return null}}\nvar le={color:!0,date:!0,datetime:!0,\"datetime-local\":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function me(a){var b=a&&a.nodeName&&a.nodeName.toLowerCase();return\"input\"===b?!!le[a.type]:\"textarea\"===b?!0:!1}function ne(a,b,c,d){Eb(d);b=oe(b,\"onChange\");0<b.length&&(c=new td(\"onChange\",\"change\",null,c,d),a.push({event:c,listeners:b}))}var pe=null,qe=null;function re(a){se(a,0)}function te(a){var b=ue(a);if(Wa(b))return a}\nfunction ve(a,b){if(\"change\"===a)return b}var we=!1;if(ia){var xe;if(ia){var ye=\"oninput\"in document;if(!ye){var ze=document.createElement(\"div\");ze.setAttribute(\"oninput\",\"return;\");ye=\"function\"===typeof ze.oninput}xe=ye}else xe=!1;we=xe&&(!document.documentMode||9<document.documentMode)}function Ae(){pe&&(pe.detachEvent(\"onpropertychange\",Be),qe=pe=null)}function Be(a){if(\"value\"===a.propertyName&&te(qe)){var b=[];ne(b,qe,a,xb(a));Jb(re,b)}}\nfunction Ce(a,b,c){\"focusin\"===a?(Ae(),pe=b,qe=c,pe.attachEvent(\"onpropertychange\",Be)):\"focusout\"===a&&Ae()}function De(a){if(\"selectionchange\"===a||\"keyup\"===a||\"keydown\"===a)return te(qe)}function Ee(a,b){if(\"click\"===a)return te(b)}function Fe(a,b){if(\"input\"===a||\"change\"===a)return te(b)}function Ge(a,b){return a===b&&(0!==a||1/a===1/b)||a!==a&&b!==b}var He=\"function\"===typeof Object.is?Object.is:Ge;\nfunction Ie(a,b){if(He(a,b))return!0;if(\"object\"!==typeof a||null===a||\"object\"!==typeof b||null===b)return!1;var c=Object.keys(a),d=Object.keys(b);if(c.length!==d.length)return!1;for(d=0;d<c.length;d++){var e=c[d];if(!ja.call(b,e)||!He(a[e],b[e]))return!1}return!0}function Je(a){for(;a&&a.firstChild;)a=a.firstChild;return a}\nfunction Ke(a,b){var c=Je(a);a=0;for(var d;c;){if(3===c.nodeType){d=a+c.textContent.length;if(a<=b&&d>=b)return{node:c,offset:b-a};a=d}a:{for(;c;){if(c.nextSibling){c=c.nextSibling;break a}c=c.parentNode}c=void 0}c=Je(c)}}function Le(a,b){return a&&b?a===b?!0:a&&3===a.nodeType?!1:b&&3===b.nodeType?Le(a,b.parentNode):\"contains\"in a?a.contains(b):a.compareDocumentPosition?!!(a.compareDocumentPosition(b)&16):!1:!1}\nfunction Me(){for(var a=window,b=Xa();b instanceof a.HTMLIFrameElement;){try{var c=\"string\"===typeof b.contentWindow.location.href}catch(d){c=!1}if(c)a=b.contentWindow;else break;b=Xa(a.document)}return b}function Ne(a){var b=a&&a.nodeName&&a.nodeName.toLowerCase();return b&&(\"input\"===b&&(\"text\"===a.type||\"search\"===a.type||\"tel\"===a.type||\"url\"===a.type||\"password\"===a.type)||\"textarea\"===b||\"true\"===a.contentEditable)}\nfunction Oe(a){var b=Me(),c=a.focusedElem,d=a.selectionRange;if(b!==c&&c&&c.ownerDocument&&Le(c.ownerDocument.documentElement,c)){if(null!==d&&Ne(c))if(b=d.start,a=d.end,void 0===a&&(a=b),\"selectionStart\"in c)c.selectionStart=b,c.selectionEnd=Math.min(a,c.value.length);else if(a=(b=c.ownerDocument||document)&&b.defaultView||window,a.getSelection){a=a.getSelection();var e=c.textContent.length,f=Math.min(d.start,e);d=void 0===d.end?f:Math.min(d.end,e);!a.extend&&f>d&&(e=d,d=f,f=e);e=Ke(c,f);var g=Ke(c,\nd);e&&g&&(1!==a.rangeCount||a.anchorNode!==e.node||a.anchorOffset!==e.offset||a.focusNode!==g.node||a.focusOffset!==g.offset)&&(b=b.createRange(),b.setStart(e.node,e.offset),a.removeAllRanges(),f>d?(a.addRange(b),a.extend(g.node,g.offset)):(b.setEnd(g.node,g.offset),a.addRange(b)))}b=[];for(a=c;a=a.parentNode;)1===a.nodeType&&b.push({element:a,left:a.scrollLeft,top:a.scrollTop});\"function\"===typeof c.focus&&c.focus();for(c=0;c<b.length;c++)a=b[c],a.element.scrollLeft=a.left,a.element.scrollTop=a.top}}\nvar Pe=ia&&\"documentMode\"in document&&11>=document.documentMode,Qe=null,Re=null,Se=null,Te=!1;\nfunction Ue(a,b,c){var d=c.window===c?c.document:9===c.nodeType?c:c.ownerDocument;Te||null==Qe||Qe!==Xa(d)||(d=Qe,\"selectionStart\"in d&&Ne(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),Se&&Ie(Se,d)||(Se=d,d=oe(Re,\"onSelect\"),0<d.length&&(b=new td(\"onSelect\",\"select\",null,b,c),a.push({event:b,listeners:d}),b.target=Qe)))}\nfunction Ve(a,b){var c={};c[a.toLowerCase()]=b.toLowerCase();c[\"Webkit\"+a]=\"webkit\"+b;c[\"Moz\"+a]=\"moz\"+b;return c}var We={animationend:Ve(\"Animation\",\"AnimationEnd\"),animationiteration:Ve(\"Animation\",\"AnimationIteration\"),animationstart:Ve(\"Animation\",\"AnimationStart\"),transitionend:Ve(\"Transition\",\"TransitionEnd\")},Xe={},Ye={};\nia&&(Ye=document.createElement(\"div\").style,\"AnimationEvent\"in window||(delete We.animationend.animation,delete We.animationiteration.animation,delete We.animationstart.animation),\"TransitionEvent\"in window||delete We.transitionend.transition);function Ze(a){if(Xe[a])return Xe[a];if(!We[a])return a;var b=We[a],c;for(c in b)if(b.hasOwnProperty(c)&&c in Ye)return Xe[a]=b[c];return a}var $e=Ze(\"animationend\"),af=Ze(\"animationiteration\"),bf=Ze(\"animationstart\"),cf=Ze(\"transitionend\"),df=new Map,ef=\"abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel\".split(\" \");\nfunction ff(a,b){df.set(a,b);fa(b,[a])}for(var gf=0;gf<ef.length;gf++){var hf=ef[gf],jf=hf.toLowerCase(),kf=hf[0].toUpperCase()+hf.slice(1);ff(jf,\"on\"+kf)}ff($e,\"onAnimationEnd\");ff(af,\"onAnimationIteration\");ff(bf,\"onAnimationStart\");ff(\"dblclick\",\"onDoubleClick\");ff(\"focusin\",\"onFocus\");ff(\"focusout\",\"onBlur\");ff(cf,\"onTransitionEnd\");ha(\"onMouseEnter\",[\"mouseout\",\"mouseover\"]);ha(\"onMouseLeave\",[\"mouseout\",\"mouseover\"]);ha(\"onPointerEnter\",[\"pointerout\",\"pointerover\"]);\nha(\"onPointerLeave\",[\"pointerout\",\"pointerover\"]);fa(\"onChange\",\"change click focusin focusout input keydown keyup selectionchange\".split(\" \"));fa(\"onSelect\",\"focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange\".split(\" \"));fa(\"onBeforeInput\",[\"compositionend\",\"keypress\",\"textInput\",\"paste\"]);fa(\"onCompositionEnd\",\"compositionend focusout keydown keypress keyup mousedown\".split(\" \"));fa(\"onCompositionStart\",\"compositionstart focusout keydown keypress keyup mousedown\".split(\" \"));\nfa(\"onCompositionUpdate\",\"compositionupdate focusout keydown keypress keyup mousedown\".split(\" \"));var lf=\"abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting\".split(\" \"),mf=new Set(\"cancel close invalid load scroll toggle\".split(\" \").concat(lf));\nfunction nf(a,b,c){var d=a.type||\"unknown-event\";a.currentTarget=c;Ub(d,b,void 0,a);a.currentTarget=null}\nfunction se(a,b){b=0!==(b&4);for(var c=0;c<a.length;c++){var d=a[c],e=d.event;d=d.listeners;a:{var f=void 0;if(b)for(var g=d.length-1;0<=g;g--){var h=d[g],k=h.instance,l=h.currentTarget;h=h.listener;if(k!==f&&e.isPropagationStopped())break a;nf(e,h,l);f=k}else for(g=0;g<d.length;g++){h=d[g];k=h.instance;l=h.currentTarget;h=h.listener;if(k!==f&&e.isPropagationStopped())break a;nf(e,h,l);f=k}}}if(Qb)throw a=Rb,Qb=!1,Rb=null,a;}\nfunction D(a,b){var c=b[of];void 0===c&&(c=b[of]=new Set);var d=a+\"__bubble\";c.has(d)||(pf(b,a,2,!1),c.add(d))}function qf(a,b,c){var d=0;b&&(d|=4);pf(c,a,d,b)}var rf=\"_reactListening\"+Math.random().toString(36).slice(2);function sf(a){if(!a[rf]){a[rf]=!0;da.forEach(function(b){\"selectionchange\"!==b&&(mf.has(b)||qf(b,!1,a),qf(b,!0,a))});var b=9===a.nodeType?a:a.ownerDocument;null===b||b[rf]||(b[rf]=!0,qf(\"selectionchange\",!1,b))}}\nfunction pf(a,b,c,d){switch(jd(b)){case 1:var e=ed;break;case 4:e=gd;break;default:e=fd}c=e.bind(null,b,c,a);e=void 0;!Lb||\"touchstart\"!==b&&\"touchmove\"!==b&&\"wheel\"!==b||(e=!0);d?void 0!==e?a.addEventListener(b,c,{capture:!0,passive:e}):a.addEventListener(b,c,!0):void 0!==e?a.addEventListener(b,c,{passive:e}):a.addEventListener(b,c,!1)}\nfunction hd(a,b,c,d,e){var f=d;if(0===(b&1)&&0===(b&2)&&null!==d)a:for(;;){if(null===d)return;var g=d.tag;if(3===g||4===g){var h=d.stateNode.containerInfo;if(h===e||8===h.nodeType&&h.parentNode===e)break;if(4===g)for(g=d.return;null!==g;){var k=g.tag;if(3===k||4===k)if(k=g.stateNode.containerInfo,k===e||8===k.nodeType&&k.parentNode===e)return;g=g.return}for(;null!==h;){g=Wc(h);if(null===g)return;k=g.tag;if(5===k||6===k){d=f=g;continue a}h=h.parentNode}}d=d.return}Jb(function(){var d=f,e=xb(c),g=[];\na:{var h=df.get(a);if(void 0!==h){var k=td,n=a;switch(a){case \"keypress\":if(0===od(c))break a;case \"keydown\":case \"keyup\":k=Rd;break;case \"focusin\":n=\"focus\";k=Fd;break;case \"focusout\":n=\"blur\";k=Fd;break;case \"beforeblur\":case \"afterblur\":k=Fd;break;case \"click\":if(2===c.button)break a;case \"auxclick\":case \"dblclick\":case \"mousedown\":case \"mousemove\":case \"mouseup\":case \"mouseout\":case \"mouseover\":case \"contextmenu\":k=Bd;break;case \"drag\":case \"dragend\":case \"dragenter\":case \"dragexit\":case \"dragleave\":case \"dragover\":case \"dragstart\":case \"drop\":k=\nDd;break;case \"touchcancel\":case \"touchend\":case \"touchmove\":case \"touchstart\":k=Vd;break;case $e:case af:case bf:k=Hd;break;case cf:k=Xd;break;case \"scroll\":k=vd;break;case \"wheel\":k=Zd;break;case \"copy\":case \"cut\":case \"paste\":k=Jd;break;case \"gotpointercapture\":case \"lostpointercapture\":case \"pointercancel\":case \"pointerdown\":case \"pointermove\":case \"pointerout\":case \"pointerover\":case \"pointerup\":k=Td}var t=0!==(b&4),J=!t&&\"scroll\"===a,x=t?null!==h?h+\"Capture\":null:h;t=[];for(var w=d,u;null!==\nw;){u=w;var F=u.stateNode;5===u.tag&&null!==F&&(u=F,null!==x&&(F=Kb(w,x),null!=F&&t.push(tf(w,F,u))));if(J)break;w=w.return}0<t.length&&(h=new k(h,n,null,c,e),g.push({event:h,listeners:t}))}}if(0===(b&7)){a:{h=\"mouseover\"===a||\"pointerover\"===a;k=\"mouseout\"===a||\"pointerout\"===a;if(h&&c!==wb&&(n=c.relatedTarget||c.fromElement)&&(Wc(n)||n[uf]))break a;if(k||h){h=e.window===e?e:(h=e.ownerDocument)?h.defaultView||h.parentWindow:window;if(k){if(n=c.relatedTarget||c.toElement,k=d,n=n?Wc(n):null,null!==\nn&&(J=Vb(n),n!==J||5!==n.tag&&6!==n.tag))n=null}else k=null,n=d;if(k!==n){t=Bd;F=\"onMouseLeave\";x=\"onMouseEnter\";w=\"mouse\";if(\"pointerout\"===a||\"pointerover\"===a)t=Td,F=\"onPointerLeave\",x=\"onPointerEnter\",w=\"pointer\";J=null==k?h:ue(k);u=null==n?h:ue(n);h=new t(F,w+\"leave\",k,c,e);h.target=J;h.relatedTarget=u;F=null;Wc(e)===d&&(t=new t(x,w+\"enter\",n,c,e),t.target=u,t.relatedTarget=J,F=t);J=F;if(k&&n)b:{t=k;x=n;w=0;for(u=t;u;u=vf(u))w++;u=0;for(F=x;F;F=vf(F))u++;for(;0<w-u;)t=vf(t),w--;for(;0<u-w;)x=\nvf(x),u--;for(;w--;){if(t===x||null!==x&&t===x.alternate)break b;t=vf(t);x=vf(x)}t=null}else t=null;null!==k&&wf(g,h,k,t,!1);null!==n&&null!==J&&wf(g,J,n,t,!0)}}}a:{h=d?ue(d):window;k=h.nodeName&&h.nodeName.toLowerCase();if(\"select\"===k||\"input\"===k&&\"file\"===h.type)var na=ve;else if(me(h))if(we)na=Fe;else{na=De;var xa=Ce}else(k=h.nodeName)&&\"input\"===k.toLowerCase()&&(\"checkbox\"===h.type||\"radio\"===h.type)&&(na=Ee);if(na&&(na=na(a,d))){ne(g,na,c,e);break a}xa&&xa(a,h,d);\"focusout\"===a&&(xa=h._wrapperState)&&\nxa.controlled&&\"number\"===h.type&&cb(h,\"number\",h.value)}xa=d?ue(d):window;switch(a){case \"focusin\":if(me(xa)||\"true\"===xa.contentEditable)Qe=xa,Re=d,Se=null;break;case \"focusout\":Se=Re=Qe=null;break;case \"mousedown\":Te=!0;break;case \"contextmenu\":case \"mouseup\":case \"dragend\":Te=!1;Ue(g,c,e);break;case \"selectionchange\":if(Pe)break;case \"keydown\":case \"keyup\":Ue(g,c,e)}var $a;if(ae)b:{switch(a){case \"compositionstart\":var ba=\"onCompositionStart\";break b;case \"compositionend\":ba=\"onCompositionEnd\";\nbreak b;case \"compositionupdate\":ba=\"onCompositionUpdate\";break b}ba=void 0}else ie?ge(a,c)&&(ba=\"onCompositionEnd\"):\"keydown\"===a&&229===c.keyCode&&(ba=\"onCompositionStart\");ba&&(de&&\"ko\"!==c.locale&&(ie||\"onCompositionStart\"!==ba?\"onCompositionEnd\"===ba&&ie&&($a=nd()):(kd=e,ld=\"value\"in kd?kd.value:kd.textContent,ie=!0)),xa=oe(d,ba),0<xa.length&&(ba=new Ld(ba,a,null,c,e),g.push({event:ba,listeners:xa}),$a?ba.data=$a:($a=he(c),null!==$a&&(ba.data=$a))));if($a=ce?je(a,c):ke(a,c))d=oe(d,\"onBeforeInput\"),\n0<d.length&&(e=new Ld(\"onBeforeInput\",\"beforeinput\",null,c,e),g.push({event:e,listeners:d}),e.data=$a)}se(g,b)})}function tf(a,b,c){return{instance:a,listener:b,currentTarget:c}}function oe(a,b){for(var c=b+\"Capture\",d=[];null!==a;){var e=a,f=e.stateNode;5===e.tag&&null!==f&&(e=f,f=Kb(a,c),null!=f&&d.unshift(tf(a,f,e)),f=Kb(a,b),null!=f&&d.push(tf(a,f,e)));a=a.return}return d}function vf(a){if(null===a)return null;do a=a.return;while(a&&5!==a.tag);return a?a:null}\nfunction wf(a,b,c,d,e){for(var f=b._reactName,g=[];null!==c&&c!==d;){var h=c,k=h.alternate,l=h.stateNode;if(null!==k&&k===d)break;5===h.tag&&null!==l&&(h=l,e?(k=Kb(c,f),null!=k&&g.unshift(tf(c,k,h))):e||(k=Kb(c,f),null!=k&&g.push(tf(c,k,h))));c=c.return}0!==g.length&&a.push({event:b,listeners:g})}var xf=/\\r\\n?/g,yf=/\\u0000|\\uFFFD/g;function zf(a){return(\"string\"===typeof a?a:\"\"+a).replace(xf,\"\\n\").replace(yf,\"\")}function Af(a,b,c){b=zf(b);if(zf(a)!==b&&c)throw Error(p(425));}function Bf(){}\nvar Cf=null,Df=null;function Ef(a,b){return\"textarea\"===a||\"noscript\"===a||\"string\"===typeof b.children||\"number\"===typeof b.children||\"object\"===typeof b.dangerouslySetInnerHTML&&null!==b.dangerouslySetInnerHTML&&null!=b.dangerouslySetInnerHTML.__html}\nvar Ff=\"function\"===typeof setTimeout?setTimeout:void 0,Gf=\"function\"===typeof clearTimeout?clearTimeout:void 0,Hf=\"function\"===typeof Promise?Promise:void 0,Jf=\"function\"===typeof queueMicrotask?queueMicrotask:\"undefined\"!==typeof Hf?function(a){return Hf.resolve(null).then(a).catch(If)}:Ff;function If(a){setTimeout(function(){throw a;})}\nfunction Kf(a,b){var c=b,d=0;do{var e=c.nextSibling;a.removeChild(c);if(e&&8===e.nodeType)if(c=e.data,\"/$\"===c){if(0===d){a.removeChild(e);bd(b);return}d--}else\"$\"!==c&&\"$?\"!==c&&\"$!\"!==c||d++;c=e}while(c);bd(b)}function Lf(a){for(;null!=a;a=a.nextSibling){var b=a.nodeType;if(1===b||3===b)break;if(8===b){b=a.data;if(\"$\"===b||\"$!\"===b||\"$?\"===b)break;if(\"/$\"===b)return null}}return a}\nfunction Mf(a){a=a.previousSibling;for(var b=0;a;){if(8===a.nodeType){var c=a.data;if(\"$\"===c||\"$!\"===c||\"$?\"===c){if(0===b)return a;b--}else\"/$\"===c&&b++}a=a.previousSibling}return null}var Nf=Math.random().toString(36).slice(2),Of=\"__reactFiber$\"+Nf,Pf=\"__reactProps$\"+Nf,uf=\"__reactContainer$\"+Nf,of=\"__reactEvents$\"+Nf,Qf=\"__reactListeners$\"+Nf,Rf=\"__reactHandles$\"+Nf;\nfunction Wc(a){var b=a[Of];if(b)return b;for(var c=a.parentNode;c;){if(b=c[uf]||c[Of]){c=b.alternate;if(null!==b.child||null!==c&&null!==c.child)for(a=Mf(a);null!==a;){if(c=a[Of])return c;a=Mf(a)}return b}a=c;c=a.parentNode}return null}function Cb(a){a=a[Of]||a[uf];return!a||5!==a.tag&&6!==a.tag&&13!==a.tag&&3!==a.tag?null:a}function ue(a){if(5===a.tag||6===a.tag)return a.stateNode;throw Error(p(33));}function Db(a){return a[Pf]||null}var Sf=[],Tf=-1;function Uf(a){return{current:a}}\nfunction E(a){0>Tf||(a.current=Sf[Tf],Sf[Tf]=null,Tf--)}function G(a,b){Tf++;Sf[Tf]=a.current;a.current=b}var Vf={},H=Uf(Vf),Wf=Uf(!1),Xf=Vf;function Yf(a,b){var c=a.type.contextTypes;if(!c)return Vf;var d=a.stateNode;if(d&&d.__reactInternalMemoizedUnmaskedChildContext===b)return d.__reactInternalMemoizedMaskedChildContext;var e={},f;for(f in c)e[f]=b[f];d&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=b,a.__reactInternalMemoizedMaskedChildContext=e);return e}\nfunction Zf(a){a=a.childContextTypes;return null!==a&&void 0!==a}function $f(){E(Wf);E(H)}function ag(a,b,c){if(H.current!==Vf)throw Error(p(168));G(H,b);G(Wf,c)}function bg(a,b,c){var d=a.stateNode;b=b.childContextTypes;if(\"function\"!==typeof d.getChildContext)return c;d=d.getChildContext();for(var e in d)if(!(e in b))throw Error(p(108,Ra(a)||\"Unknown\",e));return A({},c,d)}\nfunction cg(a){a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||Vf;Xf=H.current;G(H,a);G(Wf,Wf.current);return!0}function dg(a,b,c){var d=a.stateNode;if(!d)throw Error(p(169));c?(a=bg(a,b,Xf),d.__reactInternalMemoizedMergedChildContext=a,E(Wf),E(H),G(H,a)):E(Wf);G(Wf,c)}var eg=null,fg=!1,gg=!1;function hg(a){null===eg?eg=[a]:eg.push(a)}function ig(a){fg=!0;hg(a)}\nfunction jg(){if(!gg&&null!==eg){gg=!0;var a=0,b=C;try{var c=eg;for(C=1;a<c.length;a++){var d=c[a];do d=d(!0);while(null!==d)}eg=null;fg=!1}catch(e){throw null!==eg&&(eg=eg.slice(a+1)),ac(fc,jg),e;}finally{C=b,gg=!1}}return null}var kg=[],lg=0,mg=null,ng=0,og=[],pg=0,qg=null,rg=1,sg=\"\";function tg(a,b){kg[lg++]=ng;kg[lg++]=mg;mg=a;ng=b}\nfunction ug(a,b,c){og[pg++]=rg;og[pg++]=sg;og[pg++]=qg;qg=a;var d=rg;a=sg;var e=32-oc(d)-1;d&=~(1<<e);c+=1;var f=32-oc(b)+e;if(30<f){var g=e-e%5;f=(d&(1<<g)-1).toString(32);d>>=g;e-=g;rg=1<<32-oc(b)+e|c<<e|d;sg=f+a}else rg=1<<f|c<<e|d,sg=a}function vg(a){null!==a.return&&(tg(a,1),ug(a,1,0))}function wg(a){for(;a===mg;)mg=kg[--lg],kg[lg]=null,ng=kg[--lg],kg[lg]=null;for(;a===qg;)qg=og[--pg],og[pg]=null,sg=og[--pg],og[pg]=null,rg=og[--pg],og[pg]=null}var xg=null,yg=null,I=!1,zg=null;\nfunction Ag(a,b){var c=Bg(5,null,null,0);c.elementType=\"DELETED\";c.stateNode=b;c.return=a;b=a.deletions;null===b?(a.deletions=[c],a.flags|=16):b.push(c)}\nfunction Cg(a,b){switch(a.tag){case 5:var c=a.type;b=1!==b.nodeType||c.toLowerCase()!==b.nodeName.toLowerCase()?null:b;return null!==b?(a.stateNode=b,xg=a,yg=Lf(b.firstChild),!0):!1;case 6:return b=\"\"===a.pendingProps||3!==b.nodeType?null:b,null!==b?(a.stateNode=b,xg=a,yg=null,!0):!1;case 13:return b=8!==b.nodeType?null:b,null!==b?(c=null!==qg?{id:rg,overflow:sg}:null,a.memoizedState={dehydrated:b,treeContext:c,retryLane:1073741824},c=Bg(18,null,null,0),c.stateNode=b,c.return=a,a.child=c,xg=a,yg=\nnull,!0):!1;default:return!1}}function Dg(a){return 0!==(a.mode&1)&&0===(a.flags&128)}function Eg(a){if(I){var b=yg;if(b){var c=b;if(!Cg(a,b)){if(Dg(a))throw Error(p(418));b=Lf(c.nextSibling);var d=xg;b&&Cg(a,b)?Ag(d,c):(a.flags=a.flags&-4097|2,I=!1,xg=a)}}else{if(Dg(a))throw Error(p(418));a.flags=a.flags&-4097|2;I=!1;xg=a}}}function Fg(a){for(a=a.return;null!==a&&5!==a.tag&&3!==a.tag&&13!==a.tag;)a=a.return;xg=a}\nfunction Gg(a){if(a!==xg)return!1;if(!I)return Fg(a),I=!0,!1;var b;(b=3!==a.tag)&&!(b=5!==a.tag)&&(b=a.type,b=\"head\"!==b&&\"body\"!==b&&!Ef(a.type,a.memoizedProps));if(b&&(b=yg)){if(Dg(a))throw Hg(),Error(p(418));for(;b;)Ag(a,b),b=Lf(b.nextSibling)}Fg(a);if(13===a.tag){a=a.memoizedState;a=null!==a?a.dehydrated:null;if(!a)throw Error(p(317));a:{a=a.nextSibling;for(b=0;a;){if(8===a.nodeType){var c=a.data;if(\"/$\"===c){if(0===b){yg=Lf(a.nextSibling);break a}b--}else\"$\"!==c&&\"$!\"!==c&&\"$?\"!==c||b++}a=a.nextSibling}yg=\nnull}}else yg=xg?Lf(a.stateNode.nextSibling):null;return!0}function Hg(){for(var a=yg;a;)a=Lf(a.nextSibling)}function Ig(){yg=xg=null;I=!1}function Jg(a){null===zg?zg=[a]:zg.push(a)}var Kg=ua.ReactCurrentBatchConfig;function Lg(a,b){if(a&&a.defaultProps){b=A({},b);a=a.defaultProps;for(var c in a)void 0===b[c]&&(b[c]=a[c]);return b}return b}var Mg=Uf(null),Ng=null,Og=null,Pg=null;function Qg(){Pg=Og=Ng=null}function Rg(a){var b=Mg.current;E(Mg);a._currentValue=b}\nfunction Sg(a,b,c){for(;null!==a;){var d=a.alternate;(a.childLanes&b)!==b?(a.childLanes|=b,null!==d&&(d.childLanes|=b)):null!==d&&(d.childLanes&b)!==b&&(d.childLanes|=b);if(a===c)break;a=a.return}}function Tg(a,b){Ng=a;Pg=Og=null;a=a.dependencies;null!==a&&null!==a.firstContext&&(0!==(a.lanes&b)&&(Ug=!0),a.firstContext=null)}\nfunction Vg(a){var b=a._currentValue;if(Pg!==a)if(a={context:a,memoizedValue:b,next:null},null===Og){if(null===Ng)throw Error(p(308));Og=a;Ng.dependencies={lanes:0,firstContext:a}}else Og=Og.next=a;return b}var Wg=null;function Xg(a){null===Wg?Wg=[a]:Wg.push(a)}function Yg(a,b,c,d){var e=b.interleaved;null===e?(c.next=c,Xg(b)):(c.next=e.next,e.next=c);b.interleaved=c;return Zg(a,d)}\nfunction Zg(a,b){a.lanes|=b;var c=a.alternate;null!==c&&(c.lanes|=b);c=a;for(a=a.return;null!==a;)a.childLanes|=b,c=a.alternate,null!==c&&(c.childLanes|=b),c=a,a=a.return;return 3===c.tag?c.stateNode:null}var $g=!1;function ah(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}\nfunction bh(a,b){a=a.updateQueue;b.updateQueue===a&&(b.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,effects:a.effects})}function ch(a,b){return{eventTime:a,lane:b,tag:0,payload:null,callback:null,next:null}}\nfunction dh(a,b,c){var d=a.updateQueue;if(null===d)return null;d=d.shared;if(0!==(K&2)){var e=d.pending;null===e?b.next=b:(b.next=e.next,e.next=b);d.pending=b;return Zg(a,c)}e=d.interleaved;null===e?(b.next=b,Xg(d)):(b.next=e.next,e.next=b);d.interleaved=b;return Zg(a,c)}function eh(a,b,c){b=b.updateQueue;if(null!==b&&(b=b.shared,0!==(c&4194240))){var d=b.lanes;d&=a.pendingLanes;c|=d;b.lanes=c;Cc(a,c)}}\nfunction fh(a,b){var c=a.updateQueue,d=a.alternate;if(null!==d&&(d=d.updateQueue,c===d)){var e=null,f=null;c=c.firstBaseUpdate;if(null!==c){do{var g={eventTime:c.eventTime,lane:c.lane,tag:c.tag,payload:c.payload,callback:c.callback,next:null};null===f?e=f=g:f=f.next=g;c=c.next}while(null!==c);null===f?e=f=b:f=f.next=b}else e=f=b;c={baseState:d.baseState,firstBaseUpdate:e,lastBaseUpdate:f,shared:d.shared,effects:d.effects};a.updateQueue=c;return}a=c.lastBaseUpdate;null===a?c.firstBaseUpdate=b:a.next=\nb;c.lastBaseUpdate=b}\nfunction gh(a,b,c,d){var e=a.updateQueue;$g=!1;var f=e.firstBaseUpdate,g=e.lastBaseUpdate,h=e.shared.pending;if(null!==h){e.shared.pending=null;var k=h,l=k.next;k.next=null;null===g?f=l:g.next=l;g=k;var m=a.alternate;null!==m&&(m=m.updateQueue,h=m.lastBaseUpdate,h!==g&&(null===h?m.firstBaseUpdate=l:h.next=l,m.lastBaseUpdate=k))}if(null!==f){var q=e.baseState;g=0;m=l=k=null;h=f;do{var r=h.lane,y=h.eventTime;if((d&r)===r){null!==m&&(m=m.next={eventTime:y,lane:0,tag:h.tag,payload:h.payload,callback:h.callback,\nnext:null});a:{var n=a,t=h;r=b;y=c;switch(t.tag){case 1:n=t.payload;if(\"function\"===typeof n){q=n.call(y,q,r);break a}q=n;break a;case 3:n.flags=n.flags&-65537|128;case 0:n=t.payload;r=\"function\"===typeof n?n.call(y,q,r):n;if(null===r||void 0===r)break a;q=A({},q,r);break a;case 2:$g=!0}}null!==h.callback&&0!==h.lane&&(a.flags|=64,r=e.effects,null===r?e.effects=[h]:r.push(h))}else y={eventTime:y,lane:r,tag:h.tag,payload:h.payload,callback:h.callback,next:null},null===m?(l=m=y,k=q):m=m.next=y,g|=r;\nh=h.next;if(null===h)if(h=e.shared.pending,null===h)break;else r=h,h=r.next,r.next=null,e.lastBaseUpdate=r,e.shared.pending=null}while(1);null===m&&(k=q);e.baseState=k;e.firstBaseUpdate=l;e.lastBaseUpdate=m;b=e.shared.interleaved;if(null!==b){e=b;do g|=e.lane,e=e.next;while(e!==b)}else null===f&&(e.shared.lanes=0);hh|=g;a.lanes=g;a.memoizedState=q}}\nfunction ih(a,b,c){a=b.effects;b.effects=null;if(null!==a)for(b=0;b<a.length;b++){var d=a[b],e=d.callback;if(null!==e){d.callback=null;d=c;if(\"function\"!==typeof e)throw Error(p(191,e));e.call(d)}}}var jh=(new aa.Component).refs;function kh(a,b,c,d){b=a.memoizedState;c=c(d,b);c=null===c||void 0===c?b:A({},b,c);a.memoizedState=c;0===a.lanes&&(a.updateQueue.baseState=c)}\nvar nh={isMounted:function(a){return(a=a._reactInternals)?Vb(a)===a:!1},enqueueSetState:function(a,b,c){a=a._reactInternals;var d=L(),e=lh(a),f=ch(d,e);f.payload=b;void 0!==c&&null!==c&&(f.callback=c);b=dh(a,f,e);null!==b&&(mh(b,a,e,d),eh(b,a,e))},enqueueReplaceState:function(a,b,c){a=a._reactInternals;var d=L(),e=lh(a),f=ch(d,e);f.tag=1;f.payload=b;void 0!==c&&null!==c&&(f.callback=c);b=dh(a,f,e);null!==b&&(mh(b,a,e,d),eh(b,a,e))},enqueueForceUpdate:function(a,b){a=a._reactInternals;var c=L(),d=\nlh(a),e=ch(c,d);e.tag=2;void 0!==b&&null!==b&&(e.callback=b);b=dh(a,e,d);null!==b&&(mh(b,a,d,c),eh(b,a,d))}};function oh(a,b,c,d,e,f,g){a=a.stateNode;return\"function\"===typeof a.shouldComponentUpdate?a.shouldComponentUpdate(d,f,g):b.prototype&&b.prototype.isPureReactComponent?!Ie(c,d)||!Ie(e,f):!0}\nfunction ph(a,b,c){var d=!1,e=Vf;var f=b.contextType;\"object\"===typeof f&&null!==f?f=Vg(f):(e=Zf(b)?Xf:H.current,d=b.contextTypes,f=(d=null!==d&&void 0!==d)?Yf(a,e):Vf);b=new b(c,f);a.memoizedState=null!==b.state&&void 0!==b.state?b.state:null;b.updater=nh;a.stateNode=b;b._reactInternals=a;d&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=e,a.__reactInternalMemoizedMaskedChildContext=f);return b}\nfunction qh(a,b,c,d){a=b.state;\"function\"===typeof b.componentWillReceiveProps&&b.componentWillReceiveProps(c,d);\"function\"===typeof b.UNSAFE_componentWillReceiveProps&&b.UNSAFE_componentWillReceiveProps(c,d);b.state!==a&&nh.enqueueReplaceState(b,b.state,null)}\nfunction rh(a,b,c,d){var e=a.stateNode;e.props=c;e.state=a.memoizedState;e.refs=jh;ah(a);var f=b.contextType;\"object\"===typeof f&&null!==f?e.context=Vg(f):(f=Zf(b)?Xf:H.current,e.context=Yf(a,f));e.state=a.memoizedState;f=b.getDerivedStateFromProps;\"function\"===typeof f&&(kh(a,b,f,c),e.state=a.memoizedState);\"function\"===typeof b.getDerivedStateFromProps||\"function\"===typeof e.getSnapshotBeforeUpdate||\"function\"!==typeof e.UNSAFE_componentWillMount&&\"function\"!==typeof e.componentWillMount||(b=e.state,\n\"function\"===typeof e.componentWillMount&&e.componentWillMount(),\"function\"===typeof e.UNSAFE_componentWillMount&&e.UNSAFE_componentWillMount(),b!==e.state&&nh.enqueueReplaceState(e,e.state,null),gh(a,c,e,d),e.state=a.memoizedState);\"function\"===typeof e.componentDidMount&&(a.flags|=4194308)}\nfunction sh(a,b,c){a=c.ref;if(null!==a&&\"function\"!==typeof a&&\"object\"!==typeof a){if(c._owner){c=c._owner;if(c){if(1!==c.tag)throw Error(p(309));var d=c.stateNode}if(!d)throw Error(p(147,a));var e=d,f=\"\"+a;if(null!==b&&null!==b.ref&&\"function\"===typeof b.ref&&b.ref._stringRef===f)return b.ref;b=function(a){var b=e.refs;b===jh&&(b=e.refs={});null===a?delete b[f]:b[f]=a};b._stringRef=f;return b}if(\"string\"!==typeof a)throw Error(p(284));if(!c._owner)throw Error(p(290,a));}return a}\nfunction th(a,b){a=Object.prototype.toString.call(b);throw Error(p(31,\"[object Object]\"===a?\"object with keys {\"+Object.keys(b).join(\", \")+\"}\":a));}function uh(a){var b=a._init;return b(a._payload)}\nfunction vh(a){function b(b,c){if(a){var d=b.deletions;null===d?(b.deletions=[c],b.flags|=16):d.push(c)}}function c(c,d){if(!a)return null;for(;null!==d;)b(c,d),d=d.sibling;return null}function d(a,b){for(a=new Map;null!==b;)null!==b.key?a.set(b.key,b):a.set(b.index,b),b=b.sibling;return a}function e(a,b){a=wh(a,b);a.index=0;a.sibling=null;return a}function f(b,c,d){b.index=d;if(!a)return b.flags|=1048576,c;d=b.alternate;if(null!==d)return d=d.index,d<c?(b.flags|=2,c):d;b.flags|=2;return c}function g(b){a&&\nnull===b.alternate&&(b.flags|=2);return b}function h(a,b,c,d){if(null===b||6!==b.tag)return b=xh(c,a.mode,d),b.return=a,b;b=e(b,c);b.return=a;return b}function k(a,b,c,d){var f=c.type;if(f===ya)return m(a,b,c.props.children,d,c.key);if(null!==b&&(b.elementType===f||\"object\"===typeof f&&null!==f&&f.$$typeof===Ha&&uh(f)===b.type))return d=e(b,c.props),d.ref=sh(a,b,c),d.return=a,d;d=yh(c.type,c.key,c.props,null,a.mode,d);d.ref=sh(a,b,c);d.return=a;return d}function l(a,b,c,d){if(null===b||4!==b.tag||\nb.stateNode.containerInfo!==c.containerInfo||b.stateNode.implementation!==c.implementation)return b=zh(c,a.mode,d),b.return=a,b;b=e(b,c.children||[]);b.return=a;return b}function m(a,b,c,d,f){if(null===b||7!==b.tag)return b=Ah(c,a.mode,d,f),b.return=a,b;b=e(b,c);b.return=a;return b}function q(a,b,c){if(\"string\"===typeof b&&\"\"!==b||\"number\"===typeof b)return b=xh(\"\"+b,a.mode,c),b.return=a,b;if(\"object\"===typeof b&&null!==b){switch(b.$$typeof){case va:return c=yh(b.type,b.key,b.props,null,a.mode,c),\nc.ref=sh(a,null,b),c.return=a,c;case wa:return b=zh(b,a.mode,c),b.return=a,b;case Ha:var d=b._init;return q(a,d(b._payload),c)}if(eb(b)||Ka(b))return b=Ah(b,a.mode,c,null),b.return=a,b;th(a,b)}return null}function r(a,b,c,d){var e=null!==b?b.key:null;if(\"string\"===typeof c&&\"\"!==c||\"number\"===typeof c)return null!==e?null:h(a,b,\"\"+c,d);if(\"object\"===typeof c&&null!==c){switch(c.$$typeof){case va:return c.key===e?k(a,b,c,d):null;case wa:return c.key===e?l(a,b,c,d):null;case Ha:return e=c._init,r(a,\nb,e(c._payload),d)}if(eb(c)||Ka(c))return null!==e?null:m(a,b,c,d,null);th(a,c)}return null}function y(a,b,c,d,e){if(\"string\"===typeof d&&\"\"!==d||\"number\"===typeof d)return a=a.get(c)||null,h(b,a,\"\"+d,e);if(\"object\"===typeof d&&null!==d){switch(d.$$typeof){case va:return a=a.get(null===d.key?c:d.key)||null,k(b,a,d,e);case wa:return a=a.get(null===d.key?c:d.key)||null,l(b,a,d,e);case Ha:var f=d._init;return y(a,b,c,f(d._payload),e)}if(eb(d)||Ka(d))return a=a.get(c)||null,m(b,a,d,e,null);th(b,d)}return null}\nfunction n(e,g,h,k){for(var l=null,m=null,u=g,w=g=0,x=null;null!==u&&w<h.length;w++){u.index>w?(x=u,u=null):x=u.sibling;var n=r(e,u,h[w],k);if(null===n){null===u&&(u=x);break}a&&u&&null===n.alternate&&b(e,u);g=f(n,g,w);null===m?l=n:m.sibling=n;m=n;u=x}if(w===h.length)return c(e,u),I&&tg(e,w),l;if(null===u){for(;w<h.length;w++)u=q(e,h[w],k),null!==u&&(g=f(u,g,w),null===m?l=u:m.sibling=u,m=u);I&&tg(e,w);return l}for(u=d(e,u);w<h.length;w++)x=y(u,e,w,h[w],k),null!==x&&(a&&null!==x.alternate&&u.delete(null===\nx.key?w:x.key),g=f(x,g,w),null===m?l=x:m.sibling=x,m=x);a&&u.forEach(function(a){return b(e,a)});I&&tg(e,w);return l}function t(e,g,h,k){var l=Ka(h);if(\"function\"!==typeof l)throw Error(p(150));h=l.call(h);if(null==h)throw Error(p(151));for(var u=l=null,m=g,w=g=0,x=null,n=h.next();null!==m&&!n.done;w++,n=h.next()){m.index>w?(x=m,m=null):x=m.sibling;var t=r(e,m,n.value,k);if(null===t){null===m&&(m=x);break}a&&m&&null===t.alternate&&b(e,m);g=f(t,g,w);null===u?l=t:u.sibling=t;u=t;m=x}if(n.done)return c(e,\nm),I&&tg(e,w),l;if(null===m){for(;!n.done;w++,n=h.next())n=q(e,n.value,k),null!==n&&(g=f(n,g,w),null===u?l=n:u.sibling=n,u=n);I&&tg(e,w);return l}for(m=d(e,m);!n.done;w++,n=h.next())n=y(m,e,w,n.value,k),null!==n&&(a&&null!==n.alternate&&m.delete(null===n.key?w:n.key),g=f(n,g,w),null===u?l=n:u.sibling=n,u=n);a&&m.forEach(function(a){return b(e,a)});I&&tg(e,w);return l}function J(a,d,f,h){\"object\"===typeof f&&null!==f&&f.type===ya&&null===f.key&&(f=f.props.children);if(\"object\"===typeof f&&null!==f){switch(f.$$typeof){case va:a:{for(var k=\nf.key,l=d;null!==l;){if(l.key===k){k=f.type;if(k===ya){if(7===l.tag){c(a,l.sibling);d=e(l,f.props.children);d.return=a;a=d;break a}}else if(l.elementType===k||\"object\"===typeof k&&null!==k&&k.$$typeof===Ha&&uh(k)===l.type){c(a,l.sibling);d=e(l,f.props);d.ref=sh(a,l,f);d.return=a;a=d;break a}c(a,l);break}else b(a,l);l=l.sibling}f.type===ya?(d=Ah(f.props.children,a.mode,h,f.key),d.return=a,a=d):(h=yh(f.type,f.key,f.props,null,a.mode,h),h.ref=sh(a,d,f),h.return=a,a=h)}return g(a);case wa:a:{for(l=f.key;null!==\nd;){if(d.key===l)if(4===d.tag&&d.stateNode.containerInfo===f.containerInfo&&d.stateNode.implementation===f.implementation){c(a,d.sibling);d=e(d,f.children||[]);d.return=a;a=d;break a}else{c(a,d);break}else b(a,d);d=d.sibling}d=zh(f,a.mode,h);d.return=a;a=d}return g(a);case Ha:return l=f._init,J(a,d,l(f._payload),h)}if(eb(f))return n(a,d,f,h);if(Ka(f))return t(a,d,f,h);th(a,f)}return\"string\"===typeof f&&\"\"!==f||\"number\"===typeof f?(f=\"\"+f,null!==d&&6===d.tag?(c(a,d.sibling),d=e(d,f),d.return=a,a=d):\n(c(a,d),d=xh(f,a.mode,h),d.return=a,a=d),g(a)):c(a,d)}return J}var Bh=vh(!0),Ch=vh(!1),Dh={},Eh=Uf(Dh),Fh=Uf(Dh),Gh=Uf(Dh);function Hh(a){if(a===Dh)throw Error(p(174));return a}function Ih(a,b){G(Gh,b);G(Fh,a);G(Eh,Dh);a=b.nodeType;switch(a){case 9:case 11:b=(b=b.documentElement)?b.namespaceURI:lb(null,\"\");break;default:a=8===a?b.parentNode:b,b=a.namespaceURI||null,a=a.tagName,b=lb(b,a)}E(Eh);G(Eh,b)}function Jh(){E(Eh);E(Fh);E(Gh)}\nfunction Kh(a){Hh(Gh.current);var b=Hh(Eh.current);var c=lb(b,a.type);b!==c&&(G(Fh,a),G(Eh,c))}function Lh(a){Fh.current===a&&(E(Eh),E(Fh))}var M=Uf(0);\nfunction Mh(a){for(var b=a;null!==b;){if(13===b.tag){var c=b.memoizedState;if(null!==c&&(c=c.dehydrated,null===c||\"$?\"===c.data||\"$!\"===c.data))return b}else if(19===b.tag&&void 0!==b.memoizedProps.revealOrder){if(0!==(b.flags&128))return b}else if(null!==b.child){b.child.return=b;b=b.child;continue}if(b===a)break;for(;null===b.sibling;){if(null===b.return||b.return===a)return null;b=b.return}b.sibling.return=b.return;b=b.sibling}return null}var Nh=[];\nfunction Oh(){for(var a=0;a<Nh.length;a++)Nh[a]._workInProgressVersionPrimary=null;Nh.length=0}var Ph=ua.ReactCurrentDispatcher,Qh=ua.ReactCurrentBatchConfig,Rh=0,N=null,O=null,P=null,Sh=!1,Th=!1,Uh=0,Vh=0;function Q(){throw Error(p(321));}function Wh(a,b){if(null===b)return!1;for(var c=0;c<b.length&&c<a.length;c++)if(!He(a[c],b[c]))return!1;return!0}\nfunction Xh(a,b,c,d,e,f){Rh=f;N=b;b.memoizedState=null;b.updateQueue=null;b.lanes=0;Ph.current=null===a||null===a.memoizedState?Yh:Zh;a=c(d,e);if(Th){f=0;do{Th=!1;Uh=0;if(25<=f)throw Error(p(301));f+=1;P=O=null;b.updateQueue=null;Ph.current=$h;a=c(d,e)}while(Th)}Ph.current=ai;b=null!==O&&null!==O.next;Rh=0;P=O=N=null;Sh=!1;if(b)throw Error(p(300));return a}function bi(){var a=0!==Uh;Uh=0;return a}\nfunction ci(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};null===P?N.memoizedState=P=a:P=P.next=a;return P}function di(){if(null===O){var a=N.alternate;a=null!==a?a.memoizedState:null}else a=O.next;var b=null===P?N.memoizedState:P.next;if(null!==b)P=b,O=a;else{if(null===a)throw Error(p(310));O=a;a={memoizedState:O.memoizedState,baseState:O.baseState,baseQueue:O.baseQueue,queue:O.queue,next:null};null===P?N.memoizedState=P=a:P=P.next=a}return P}\nfunction ei(a,b){return\"function\"===typeof b?b(a):b}\nfunction fi(a){var b=di(),c=b.queue;if(null===c)throw Error(p(311));c.lastRenderedReducer=a;var d=O,e=d.baseQueue,f=c.pending;if(null!==f){if(null!==e){var g=e.next;e.next=f.next;f.next=g}d.baseQueue=e=f;c.pending=null}if(null!==e){f=e.next;d=d.baseState;var h=g=null,k=null,l=f;do{var m=l.lane;if((Rh&m)===m)null!==k&&(k=k.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),d=l.hasEagerState?l.eagerState:a(d,l.action);else{var q={lane:m,action:l.action,hasEagerState:l.hasEagerState,\neagerState:l.eagerState,next:null};null===k?(h=k=q,g=d):k=k.next=q;N.lanes|=m;hh|=m}l=l.next}while(null!==l&&l!==f);null===k?g=d:k.next=h;He(d,b.memoizedState)||(Ug=!0);b.memoizedState=d;b.baseState=g;b.baseQueue=k;c.lastRenderedState=d}a=c.interleaved;if(null!==a){e=a;do f=e.lane,N.lanes|=f,hh|=f,e=e.next;while(e!==a)}else null===e&&(c.lanes=0);return[b.memoizedState,c.dispatch]}\nfunction gi(a){var b=di(),c=b.queue;if(null===c)throw Error(p(311));c.lastRenderedReducer=a;var d=c.dispatch,e=c.pending,f=b.memoizedState;if(null!==e){c.pending=null;var g=e=e.next;do f=a(f,g.action),g=g.next;while(g!==e);He(f,b.memoizedState)||(Ug=!0);b.memoizedState=f;null===b.baseQueue&&(b.baseState=f);c.lastRenderedState=f}return[f,d]}function hi(){}\nfunction ii(a,b){var c=N,d=di(),e=b(),f=!He(d.memoizedState,e);f&&(d.memoizedState=e,Ug=!0);d=d.queue;ji(ki.bind(null,c,d,a),[a]);if(d.getSnapshot!==b||f||null!==P&&P.memoizedState.tag&1){c.flags|=2048;li(9,mi.bind(null,c,d,e,b),void 0,null);if(null===R)throw Error(p(349));0!==(Rh&30)||ni(c,b,e)}return e}function ni(a,b,c){a.flags|=16384;a={getSnapshot:b,value:c};b=N.updateQueue;null===b?(b={lastEffect:null,stores:null},N.updateQueue=b,b.stores=[a]):(c=b.stores,null===c?b.stores=[a]:c.push(a))}\nfunction mi(a,b,c,d){b.value=c;b.getSnapshot=d;oi(b)&&pi(a)}function ki(a,b,c){return c(function(){oi(b)&&pi(a)})}function oi(a){var b=a.getSnapshot;a=a.value;try{var c=b();return!He(a,c)}catch(d){return!0}}function pi(a){var b=Zg(a,1);null!==b&&mh(b,a,1,-1)}\nfunction qi(a){var b=ci();\"function\"===typeof a&&(a=a());b.memoizedState=b.baseState=a;a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ei,lastRenderedState:a};b.queue=a;a=a.dispatch=ri.bind(null,N,a);return[b.memoizedState,a]}\nfunction li(a,b,c,d){a={tag:a,create:b,destroy:c,deps:d,next:null};b=N.updateQueue;null===b?(b={lastEffect:null,stores:null},N.updateQueue=b,b.lastEffect=a.next=a):(c=b.lastEffect,null===c?b.lastEffect=a.next=a:(d=c.next,c.next=a,a.next=d,b.lastEffect=a));return a}function si(){return di().memoizedState}function ti(a,b,c,d){var e=ci();N.flags|=a;e.memoizedState=li(1|b,c,void 0,void 0===d?null:d)}\nfunction ui(a,b,c,d){var e=di();d=void 0===d?null:d;var f=void 0;if(null!==O){var g=O.memoizedState;f=g.destroy;if(null!==d&&Wh(d,g.deps)){e.memoizedState=li(b,c,f,d);return}}N.flags|=a;e.memoizedState=li(1|b,c,f,d)}function vi(a,b){return ti(8390656,8,a,b)}function ji(a,b){return ui(2048,8,a,b)}function wi(a,b){return ui(4,2,a,b)}function xi(a,b){return ui(4,4,a,b)}\nfunction yi(a,b){if(\"function\"===typeof b)return a=a(),b(a),function(){b(null)};if(null!==b&&void 0!==b)return a=a(),b.current=a,function(){b.current=null}}function zi(a,b,c){c=null!==c&&void 0!==c?c.concat([a]):null;return ui(4,4,yi.bind(null,b,a),c)}function Ai(){}function Bi(a,b){var c=di();b=void 0===b?null:b;var d=c.memoizedState;if(null!==d&&null!==b&&Wh(b,d[1]))return d[0];c.memoizedState=[a,b];return a}\nfunction Ci(a,b){var c=di();b=void 0===b?null:b;var d=c.memoizedState;if(null!==d&&null!==b&&Wh(b,d[1]))return d[0];a=a();c.memoizedState=[a,b];return a}function Di(a,b,c){if(0===(Rh&21))return a.baseState&&(a.baseState=!1,Ug=!0),a.memoizedState=c;He(c,b)||(c=yc(),N.lanes|=c,hh|=c,a.baseState=!0);return b}function Ei(a,b){var c=C;C=0!==c&&4>c?c:4;a(!0);var d=Qh.transition;Qh.transition={};try{a(!1),b()}finally{C=c,Qh.transition=d}}function Fi(){return di().memoizedState}\nfunction Gi(a,b,c){var d=lh(a);c={lane:d,action:c,hasEagerState:!1,eagerState:null,next:null};if(Hi(a))Ii(b,c);else if(c=Yg(a,b,c,d),null!==c){var e=L();mh(c,a,d,e);Ji(c,b,d)}}\nfunction ri(a,b,c){var d=lh(a),e={lane:d,action:c,hasEagerState:!1,eagerState:null,next:null};if(Hi(a))Ii(b,e);else{var f=a.alternate;if(0===a.lanes&&(null===f||0===f.lanes)&&(f=b.lastRenderedReducer,null!==f))try{var g=b.lastRenderedState,h=f(g,c);e.hasEagerState=!0;e.eagerState=h;if(He(h,g)){var k=b.interleaved;null===k?(e.next=e,Xg(b)):(e.next=k.next,k.next=e);b.interleaved=e;return}}catch(l){}finally{}c=Yg(a,b,e,d);null!==c&&(e=L(),mh(c,a,d,e),Ji(c,b,d))}}\nfunction Hi(a){var b=a.alternate;return a===N||null!==b&&b===N}function Ii(a,b){Th=Sh=!0;var c=a.pending;null===c?b.next=b:(b.next=c.next,c.next=b);a.pending=b}function Ji(a,b,c){if(0!==(c&4194240)){var d=b.lanes;d&=a.pendingLanes;c|=d;b.lanes=c;Cc(a,c)}}\nvar ai={readContext:Vg,useCallback:Q,useContext:Q,useEffect:Q,useImperativeHandle:Q,useInsertionEffect:Q,useLayoutEffect:Q,useMemo:Q,useReducer:Q,useRef:Q,useState:Q,useDebugValue:Q,useDeferredValue:Q,useTransition:Q,useMutableSource:Q,useSyncExternalStore:Q,useId:Q,unstable_isNewReconciler:!1},Yh={readContext:Vg,useCallback:function(a,b){ci().memoizedState=[a,void 0===b?null:b];return a},useContext:Vg,useEffect:vi,useImperativeHandle:function(a,b,c){c=null!==c&&void 0!==c?c.concat([a]):null;return ti(4194308,\n4,yi.bind(null,b,a),c)},useLayoutEffect:function(a,b){return ti(4194308,4,a,b)},useInsertionEffect:function(a,b){return ti(4,2,a,b)},useMemo:function(a,b){var c=ci();b=void 0===b?null:b;a=a();c.memoizedState=[a,b];return a},useReducer:function(a,b,c){var d=ci();b=void 0!==c?c(b):b;d.memoizedState=d.baseState=b;a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:b};d.queue=a;a=a.dispatch=Gi.bind(null,N,a);return[d.memoizedState,a]},useRef:function(a){var b=\nci();a={current:a};return b.memoizedState=a},useState:qi,useDebugValue:Ai,useDeferredValue:function(a){return ci().memoizedState=a},useTransition:function(){var a=qi(!1),b=a[0];a=Ei.bind(null,a[1]);ci().memoizedState=a;return[b,a]},useMutableSource:function(){},useSyncExternalStore:function(a,b,c){var d=N,e=ci();if(I){if(void 0===c)throw Error(p(407));c=c()}else{c=b();if(null===R)throw Error(p(349));0!==(Rh&30)||ni(d,b,c)}e.memoizedState=c;var f={value:c,getSnapshot:b};e.queue=f;vi(ki.bind(null,d,\nf,a),[a]);d.flags|=2048;li(9,mi.bind(null,d,f,c,b),void 0,null);return c},useId:function(){var a=ci(),b=R.identifierPrefix;if(I){var c=sg;var d=rg;c=(d&~(1<<32-oc(d)-1)).toString(32)+c;b=\":\"+b+\"R\"+c;c=Uh++;0<c&&(b+=\"H\"+c.toString(32));b+=\":\"}else c=Vh++,b=\":\"+b+\"r\"+c.toString(32)+\":\";return a.memoizedState=b},unstable_isNewReconciler:!1},Zh={readContext:Vg,useCallback:Bi,useContext:Vg,useEffect:ji,useImperativeHandle:zi,useInsertionEffect:wi,useLayoutEffect:xi,useMemo:Ci,useReducer:fi,useRef:si,useState:function(){return fi(ei)},\nuseDebugValue:Ai,useDeferredValue:function(a){var b=di();return Di(b,O.memoizedState,a)},useTransition:function(){var a=fi(ei)[0],b=di().memoizedState;return[a,b]},useMutableSource:hi,useSyncExternalStore:ii,useId:Fi,unstable_isNewReconciler:!1},$h={readContext:Vg,useCallback:Bi,useContext:Vg,useEffect:ji,useImperativeHandle:zi,useInsertionEffect:wi,useLayoutEffect:xi,useMemo:Ci,useReducer:gi,useRef:si,useState:function(){return gi(ei)},useDebugValue:Ai,useDeferredValue:function(a){var b=di();return null===\nO?b.memoizedState=a:Di(b,O.memoizedState,a)},useTransition:function(){var a=gi(ei)[0],b=di().memoizedState;return[a,b]},useMutableSource:hi,useSyncExternalStore:ii,useId:Fi,unstable_isNewReconciler:!1};function Ki(a,b){try{var c=\"\",d=b;do c+=Pa(d),d=d.return;while(d);var e=c}catch(f){e=\"\\nError generating stack: \"+f.message+\"\\n\"+f.stack}return{value:a,source:b,stack:e,digest:null}}function Li(a,b,c){return{value:a,source:null,stack:null!=c?c:null,digest:null!=b?b:null}}\nfunction Mi(a,b){try{console.error(b.value)}catch(c){setTimeout(function(){throw c;})}}var Ni=\"function\"===typeof WeakMap?WeakMap:Map;function Oi(a,b,c){c=ch(-1,c);c.tag=3;c.payload={element:null};var d=b.value;c.callback=function(){Pi||(Pi=!0,Qi=d);Mi(a,b)};return c}\nfunction Ri(a,b,c){c=ch(-1,c);c.tag=3;var d=a.type.getDerivedStateFromError;if(\"function\"===typeof d){var e=b.value;c.payload=function(){return d(e)};c.callback=function(){Mi(a,b)}}var f=a.stateNode;null!==f&&\"function\"===typeof f.componentDidCatch&&(c.callback=function(){Mi(a,b);\"function\"!==typeof d&&(null===Si?Si=new Set([this]):Si.add(this));var c=b.stack;this.componentDidCatch(b.value,{componentStack:null!==c?c:\"\"})});return c}\nfunction Ti(a,b,c){var d=a.pingCache;if(null===d){d=a.pingCache=new Ni;var e=new Set;d.set(b,e)}else e=d.get(b),void 0===e&&(e=new Set,d.set(b,e));e.has(c)||(e.add(c),a=Ui.bind(null,a,b,c),b.then(a,a))}function Vi(a){do{var b;if(b=13===a.tag)b=a.memoizedState,b=null!==b?null!==b.dehydrated?!0:!1:!0;if(b)return a;a=a.return}while(null!==a);return null}\nfunction Wi(a,b,c,d,e){if(0===(a.mode&1))return a===b?a.flags|=65536:(a.flags|=128,c.flags|=131072,c.flags&=-52805,1===c.tag&&(null===c.alternate?c.tag=17:(b=ch(-1,1),b.tag=2,dh(c,b,1))),c.lanes|=1),a;a.flags|=65536;a.lanes=e;return a}var Xi=ua.ReactCurrentOwner,Ug=!1;function Yi(a,b,c,d){b.child=null===a?Ch(b,null,c,d):Bh(b,a.child,c,d)}\nfunction Zi(a,b,c,d,e){c=c.render;var f=b.ref;Tg(b,e);d=Xh(a,b,c,d,f,e);c=bi();if(null!==a&&!Ug)return b.updateQueue=a.updateQueue,b.flags&=-2053,a.lanes&=~e,$i(a,b,e);I&&c&&vg(b);b.flags|=1;Yi(a,b,d,e);return b.child}\nfunction aj(a,b,c,d,e){if(null===a){var f=c.type;if(\"function\"===typeof f&&!bj(f)&&void 0===f.defaultProps&&null===c.compare&&void 0===c.defaultProps)return b.tag=15,b.type=f,cj(a,b,f,d,e);a=yh(c.type,null,d,b,b.mode,e);a.ref=b.ref;a.return=b;return b.child=a}f=a.child;if(0===(a.lanes&e)){var g=f.memoizedProps;c=c.compare;c=null!==c?c:Ie;if(c(g,d)&&a.ref===b.ref)return $i(a,b,e)}b.flags|=1;a=wh(f,d);a.ref=b.ref;a.return=b;return b.child=a}\nfunction cj(a,b,c,d,e){if(null!==a){var f=a.memoizedProps;if(Ie(f,d)&&a.ref===b.ref)if(Ug=!1,b.pendingProps=d=f,0!==(a.lanes&e))0!==(a.flags&131072)&&(Ug=!0);else return b.lanes=a.lanes,$i(a,b,e)}return dj(a,b,c,d,e)}\nfunction ej(a,b,c){var d=b.pendingProps,e=d.children,f=null!==a?a.memoizedState:null;if(\"hidden\"===d.mode)if(0===(b.mode&1))b.memoizedState={baseLanes:0,cachePool:null,transitions:null},G(fj,gj),gj|=c;else{if(0===(c&1073741824))return a=null!==f?f.baseLanes|c:c,b.lanes=b.childLanes=1073741824,b.memoizedState={baseLanes:a,cachePool:null,transitions:null},b.updateQueue=null,G(fj,gj),gj|=a,null;b.memoizedState={baseLanes:0,cachePool:null,transitions:null};d=null!==f?f.baseLanes:c;G(fj,gj);gj|=d}else null!==\nf?(d=f.baseLanes|c,b.memoizedState=null):d=c,G(fj,gj),gj|=d;Yi(a,b,e,c);return b.child}function hj(a,b){var c=b.ref;if(null===a&&null!==c||null!==a&&a.ref!==c)b.flags|=512,b.flags|=2097152}function dj(a,b,c,d,e){var f=Zf(c)?Xf:H.current;f=Yf(b,f);Tg(b,e);c=Xh(a,b,c,d,f,e);d=bi();if(null!==a&&!Ug)return b.updateQueue=a.updateQueue,b.flags&=-2053,a.lanes&=~e,$i(a,b,e);I&&d&&vg(b);b.flags|=1;Yi(a,b,c,e);return b.child}\nfunction ij(a,b,c,d,e){if(Zf(c)){var f=!0;cg(b)}else f=!1;Tg(b,e);if(null===b.stateNode)jj(a,b),ph(b,c,d),rh(b,c,d,e),d=!0;else if(null===a){var g=b.stateNode,h=b.memoizedProps;g.props=h;var k=g.context,l=c.contextType;\"object\"===typeof l&&null!==l?l=Vg(l):(l=Zf(c)?Xf:H.current,l=Yf(b,l));var m=c.getDerivedStateFromProps,q=\"function\"===typeof m||\"function\"===typeof g.getSnapshotBeforeUpdate;q||\"function\"!==typeof g.UNSAFE_componentWillReceiveProps&&\"function\"!==typeof g.componentWillReceiveProps||\n(h!==d||k!==l)&&qh(b,g,d,l);$g=!1;var r=b.memoizedState;g.state=r;gh(b,d,g,e);k=b.memoizedState;h!==d||r!==k||Wf.current||$g?(\"function\"===typeof m&&(kh(b,c,m,d),k=b.memoizedState),(h=$g||oh(b,c,h,d,r,k,l))?(q||\"function\"!==typeof g.UNSAFE_componentWillMount&&\"function\"!==typeof g.componentWillMount||(\"function\"===typeof g.componentWillMount&&g.componentWillMount(),\"function\"===typeof g.UNSAFE_componentWillMount&&g.UNSAFE_componentWillMount()),\"function\"===typeof g.componentDidMount&&(b.flags|=4194308)):\n(\"function\"===typeof g.componentDidMount&&(b.flags|=4194308),b.memoizedProps=d,b.memoizedState=k),g.props=d,g.state=k,g.context=l,d=h):(\"function\"===typeof g.componentDidMount&&(b.flags|=4194308),d=!1)}else{g=b.stateNode;bh(a,b);h=b.memoizedProps;l=b.type===b.elementType?h:Lg(b.type,h);g.props=l;q=b.pendingProps;r=g.context;k=c.contextType;\"object\"===typeof k&&null!==k?k=Vg(k):(k=Zf(c)?Xf:H.current,k=Yf(b,k));var y=c.getDerivedStateFromProps;(m=\"function\"===typeof y||\"function\"===typeof g.getSnapshotBeforeUpdate)||\n\"function\"!==typeof g.UNSAFE_componentWillReceiveProps&&\"function\"!==typeof g.componentWillReceiveProps||(h!==q||r!==k)&&qh(b,g,d,k);$g=!1;r=b.memoizedState;g.state=r;gh(b,d,g,e);var n=b.memoizedState;h!==q||r!==n||Wf.current||$g?(\"function\"===typeof y&&(kh(b,c,y,d),n=b.memoizedState),(l=$g||oh(b,c,l,d,r,n,k)||!1)?(m||\"function\"!==typeof g.UNSAFE_componentWillUpdate&&\"function\"!==typeof g.componentWillUpdate||(\"function\"===typeof g.componentWillUpdate&&g.componentWillUpdate(d,n,k),\"function\"===typeof g.UNSAFE_componentWillUpdate&&\ng.UNSAFE_componentWillUpdate(d,n,k)),\"function\"===typeof g.componentDidUpdate&&(b.flags|=4),\"function\"===typeof g.getSnapshotBeforeUpdate&&(b.flags|=1024)):(\"function\"!==typeof g.componentDidUpdate||h===a.memoizedProps&&r===a.memoizedState||(b.flags|=4),\"function\"!==typeof g.getSnapshotBeforeUpdate||h===a.memoizedProps&&r===a.memoizedState||(b.flags|=1024),b.memoizedProps=d,b.memoizedState=n),g.props=d,g.state=n,g.context=k,d=l):(\"function\"!==typeof g.componentDidUpdate||h===a.memoizedProps&&r===\na.memoizedState||(b.flags|=4),\"function\"!==typeof g.getSnapshotBeforeUpdate||h===a.memoizedProps&&r===a.memoizedState||(b.flags|=1024),d=!1)}return kj(a,b,c,d,f,e)}\nfunction kj(a,b,c,d,e,f){hj(a,b);var g=0!==(b.flags&128);if(!d&&!g)return e&&dg(b,c,!1),$i(a,b,f);d=b.stateNode;Xi.current=b;var h=g&&\"function\"!==typeof c.getDerivedStateFromError?null:d.render();b.flags|=1;null!==a&&g?(b.child=Bh(b,a.child,null,f),b.child=Bh(b,null,h,f)):Yi(a,b,h,f);b.memoizedState=d.state;e&&dg(b,c,!0);return b.child}function lj(a){var b=a.stateNode;b.pendingContext?ag(a,b.pendingContext,b.pendingContext!==b.context):b.context&&ag(a,b.context,!1);Ih(a,b.containerInfo)}\nfunction mj(a,b,c,d,e){Ig();Jg(e);b.flags|=256;Yi(a,b,c,d);return b.child}var nj={dehydrated:null,treeContext:null,retryLane:0};function oj(a){return{baseLanes:a,cachePool:null,transitions:null}}\nfunction pj(a,b,c){var d=b.pendingProps,e=M.current,f=!1,g=0!==(b.flags&128),h;(h=g)||(h=null!==a&&null===a.memoizedState?!1:0!==(e&2));if(h)f=!0,b.flags&=-129;else if(null===a||null!==a.memoizedState)e|=1;G(M,e&1);if(null===a){Eg(b);a=b.memoizedState;if(null!==a&&(a=a.dehydrated,null!==a))return 0===(b.mode&1)?b.lanes=1:\"$!\"===a.data?b.lanes=8:b.lanes=1073741824,null;g=d.children;a=d.fallback;return f?(d=b.mode,f=b.child,g={mode:\"hidden\",children:g},0===(d&1)&&null!==f?(f.childLanes=0,f.pendingProps=\ng):f=qj(g,d,0,null),a=Ah(a,d,c,null),f.return=b,a.return=b,f.sibling=a,b.child=f,b.child.memoizedState=oj(c),b.memoizedState=nj,a):rj(b,g)}e=a.memoizedState;if(null!==e&&(h=e.dehydrated,null!==h))return sj(a,b,g,d,h,e,c);if(f){f=d.fallback;g=b.mode;e=a.child;h=e.sibling;var k={mode:\"hidden\",children:d.children};0===(g&1)&&b.child!==e?(d=b.child,d.childLanes=0,d.pendingProps=k,b.deletions=null):(d=wh(e,k),d.subtreeFlags=e.subtreeFlags&14680064);null!==h?f=wh(h,f):(f=Ah(f,g,c,null),f.flags|=2);f.return=\nb;d.return=b;d.sibling=f;b.child=d;d=f;f=b.child;g=a.child.memoizedState;g=null===g?oj(c):{baseLanes:g.baseLanes|c,cachePool:null,transitions:g.transitions};f.memoizedState=g;f.childLanes=a.childLanes&~c;b.memoizedState=nj;return d}f=a.child;a=f.sibling;d=wh(f,{mode:\"visible\",children:d.children});0===(b.mode&1)&&(d.lanes=c);d.return=b;d.sibling=null;null!==a&&(c=b.deletions,null===c?(b.deletions=[a],b.flags|=16):c.push(a));b.child=d;b.memoizedState=null;return d}\nfunction rj(a,b){b=qj({mode:\"visible\",children:b},a.mode,0,null);b.return=a;return a.child=b}function tj(a,b,c,d){null!==d&&Jg(d);Bh(b,a.child,null,c);a=rj(b,b.pendingProps.children);a.flags|=2;b.memoizedState=null;return a}\nfunction sj(a,b,c,d,e,f,g){if(c){if(b.flags&256)return b.flags&=-257,d=Li(Error(p(422))),tj(a,b,g,d);if(null!==b.memoizedState)return b.child=a.child,b.flags|=128,null;f=d.fallback;e=b.mode;d=qj({mode:\"visible\",children:d.children},e,0,null);f=Ah(f,e,g,null);f.flags|=2;d.return=b;f.return=b;d.sibling=f;b.child=d;0!==(b.mode&1)&&Bh(b,a.child,null,g);b.child.memoizedState=oj(g);b.memoizedState=nj;return f}if(0===(b.mode&1))return tj(a,b,g,null);if(\"$!\"===e.data){d=e.nextSibling&&e.nextSibling.dataset;\nif(d)var h=d.dgst;d=h;f=Error(p(419));d=Li(f,d,void 0);return tj(a,b,g,d)}h=0!==(g&a.childLanes);if(Ug||h){d=R;if(null!==d){switch(g&-g){case 4:e=2;break;case 16:e=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:e=32;break;case 536870912:e=268435456;break;default:e=0}e=0!==(e&(d.suspendedLanes|g))?0:e;\n0!==e&&e!==f.retryLane&&(f.retryLane=e,Zg(a,e),mh(d,a,e,-1))}uj();d=Li(Error(p(421)));return tj(a,b,g,d)}if(\"$?\"===e.data)return b.flags|=128,b.child=a.child,b=vj.bind(null,a),e._reactRetry=b,null;a=f.treeContext;yg=Lf(e.nextSibling);xg=b;I=!0;zg=null;null!==a&&(og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,rg=a.id,sg=a.overflow,qg=b);b=rj(b,d.children);b.flags|=4096;return b}function wj(a,b,c){a.lanes|=b;var d=a.alternate;null!==d&&(d.lanes|=b);Sg(a.return,b,c)}\nfunction xj(a,b,c,d,e){var f=a.memoizedState;null===f?a.memoizedState={isBackwards:b,rendering:null,renderingStartTime:0,last:d,tail:c,tailMode:e}:(f.isBackwards=b,f.rendering=null,f.renderingStartTime=0,f.last=d,f.tail=c,f.tailMode=e)}\nfunction yj(a,b,c){var d=b.pendingProps,e=d.revealOrder,f=d.tail;Yi(a,b,d.children,c);d=M.current;if(0!==(d&2))d=d&1|2,b.flags|=128;else{if(null!==a&&0!==(a.flags&128))a:for(a=b.child;null!==a;){if(13===a.tag)null!==a.memoizedState&&wj(a,c,b);else if(19===a.tag)wj(a,c,b);else if(null!==a.child){a.child.return=a;a=a.child;continue}if(a===b)break a;for(;null===a.sibling;){if(null===a.return||a.return===b)break a;a=a.return}a.sibling.return=a.return;a=a.sibling}d&=1}G(M,d);if(0===(b.mode&1))b.memoizedState=\nnull;else switch(e){case \"forwards\":c=b.child;for(e=null;null!==c;)a=c.alternate,null!==a&&null===Mh(a)&&(e=c),c=c.sibling;c=e;null===c?(e=b.child,b.child=null):(e=c.sibling,c.sibling=null);xj(b,!1,e,c,f);break;case \"backwards\":c=null;e=b.child;for(b.child=null;null!==e;){a=e.alternate;if(null!==a&&null===Mh(a)){b.child=e;break}a=e.sibling;e.sibling=c;c=e;e=a}xj(b,!0,c,null,f);break;case \"together\":xj(b,!1,null,null,void 0);break;default:b.memoizedState=null}return b.child}\nfunction jj(a,b){0===(b.mode&1)&&null!==a&&(a.alternate=null,b.alternate=null,b.flags|=2)}function $i(a,b,c){null!==a&&(b.dependencies=a.dependencies);hh|=b.lanes;if(0===(c&b.childLanes))return null;if(null!==a&&b.child!==a.child)throw Error(p(153));if(null!==b.child){a=b.child;c=wh(a,a.pendingProps);b.child=c;for(c.return=b;null!==a.sibling;)a=a.sibling,c=c.sibling=wh(a,a.pendingProps),c.return=b;c.sibling=null}return b.child}\nfunction zj(a,b,c){switch(b.tag){case 3:lj(b);Ig();break;case 5:Kh(b);break;case 1:Zf(b.type)&&cg(b);break;case 4:Ih(b,b.stateNode.containerInfo);break;case 10:var d=b.type._context,e=b.memoizedProps.value;G(Mg,d._currentValue);d._currentValue=e;break;case 13:d=b.memoizedState;if(null!==d){if(null!==d.dehydrated)return G(M,M.current&1),b.flags|=128,null;if(0!==(c&b.child.childLanes))return pj(a,b,c);G(M,M.current&1);a=$i(a,b,c);return null!==a?a.sibling:null}G(M,M.current&1);break;case 19:d=0!==(c&\nb.childLanes);if(0!==(a.flags&128)){if(d)return yj(a,b,c);b.flags|=128}e=b.memoizedState;null!==e&&(e.rendering=null,e.tail=null,e.lastEffect=null);G(M,M.current);if(d)break;else return null;case 22:case 23:return b.lanes=0,ej(a,b,c)}return $i(a,b,c)}var Aj,Bj,Cj,Dj;\nAj=function(a,b){for(var c=b.child;null!==c;){if(5===c.tag||6===c.tag)a.appendChild(c.stateNode);else if(4!==c.tag&&null!==c.child){c.child.return=c;c=c.child;continue}if(c===b)break;for(;null===c.sibling;){if(null===c.return||c.return===b)return;c=c.return}c.sibling.return=c.return;c=c.sibling}};Bj=function(){};\nCj=function(a,b,c,d){var e=a.memoizedProps;if(e!==d){a=b.stateNode;Hh(Eh.current);var f=null;switch(c){case \"input\":e=Ya(a,e);d=Ya(a,d);f=[];break;case \"select\":e=A({},e,{value:void 0});d=A({},d,{value:void 0});f=[];break;case \"textarea\":e=gb(a,e);d=gb(a,d);f=[];break;default:\"function\"!==typeof e.onClick&&\"function\"===typeof d.onClick&&(a.onclick=Bf)}ub(c,d);var g;c=null;for(l in e)if(!d.hasOwnProperty(l)&&e.hasOwnProperty(l)&&null!=e[l])if(\"style\"===l){var h=e[l];for(g in h)h.hasOwnProperty(g)&&\n(c||(c={}),c[g]=\"\")}else\"dangerouslySetInnerHTML\"!==l&&\"children\"!==l&&\"suppressContentEditableWarning\"!==l&&\"suppressHydrationWarning\"!==l&&\"autoFocus\"!==l&&(ea.hasOwnProperty(l)?f||(f=[]):(f=f||[]).push(l,null));for(l in d){var k=d[l];h=null!=e?e[l]:void 0;if(d.hasOwnProperty(l)&&k!==h&&(null!=k||null!=h))if(\"style\"===l)if(h){for(g in h)!h.hasOwnProperty(g)||k&&k.hasOwnProperty(g)||(c||(c={}),c[g]=\"\");for(g in k)k.hasOwnProperty(g)&&h[g]!==k[g]&&(c||(c={}),c[g]=k[g])}else c||(f||(f=[]),f.push(l,\nc)),c=k;else\"dangerouslySetInnerHTML\"===l?(k=k?k.__html:void 0,h=h?h.__html:void 0,null!=k&&h!==k&&(f=f||[]).push(l,k)):\"children\"===l?\"string\"!==typeof k&&\"number\"!==typeof k||(f=f||[]).push(l,\"\"+k):\"suppressContentEditableWarning\"!==l&&\"suppressHydrationWarning\"!==l&&(ea.hasOwnProperty(l)?(null!=k&&\"onScroll\"===l&&D(\"scroll\",a),f||h===k||(f=[])):(f=f||[]).push(l,k))}c&&(f=f||[]).push(\"style\",c);var l=f;if(b.updateQueue=l)b.flags|=4}};Dj=function(a,b,c,d){c!==d&&(b.flags|=4)};\nfunction Ej(a,b){if(!I)switch(a.tailMode){case \"hidden\":b=a.tail;for(var c=null;null!==b;)null!==b.alternate&&(c=b),b=b.sibling;null===c?a.tail=null:c.sibling=null;break;case \"collapsed\":c=a.tail;for(var d=null;null!==c;)null!==c.alternate&&(d=c),c=c.sibling;null===d?b||null===a.tail?a.tail=null:a.tail.sibling=null:d.sibling=null}}\nfunction S(a){var b=null!==a.alternate&&a.alternate.child===a.child,c=0,d=0;if(b)for(var e=a.child;null!==e;)c|=e.lanes|e.childLanes,d|=e.subtreeFlags&14680064,d|=e.flags&14680064,e.return=a,e=e.sibling;else for(e=a.child;null!==e;)c|=e.lanes|e.childLanes,d|=e.subtreeFlags,d|=e.flags,e.return=a,e=e.sibling;a.subtreeFlags|=d;a.childLanes=c;return b}\nfunction Fj(a,b,c){var d=b.pendingProps;wg(b);switch(b.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return S(b),null;case 1:return Zf(b.type)&&$f(),S(b),null;case 3:d=b.stateNode;Jh();E(Wf);E(H);Oh();d.pendingContext&&(d.context=d.pendingContext,d.pendingContext=null);if(null===a||null===a.child)Gg(b)?b.flags|=4:null===a||a.memoizedState.isDehydrated&&0===(b.flags&256)||(b.flags|=1024,null!==zg&&(Gj(zg),zg=null));Bj(a,b);S(b);return null;case 5:Lh(b);var e=Hh(Gh.current);\nc=b.type;if(null!==a&&null!=b.stateNode)Cj(a,b,c,d,e),a.ref!==b.ref&&(b.flags|=512,b.flags|=2097152);else{if(!d){if(null===b.stateNode)throw Error(p(166));S(b);return null}a=Hh(Eh.current);if(Gg(b)){d=b.stateNode;c=b.type;var f=b.memoizedProps;d[Of]=b;d[Pf]=f;a=0!==(b.mode&1);switch(c){case \"dialog\":D(\"cancel\",d);D(\"close\",d);break;case \"iframe\":case \"object\":case \"embed\":D(\"load\",d);break;case \"video\":case \"audio\":for(e=0;e<lf.length;e++)D(lf[e],d);break;case \"source\":D(\"error\",d);break;case \"img\":case \"image\":case \"link\":D(\"error\",\nd);D(\"load\",d);break;case \"details\":D(\"toggle\",d);break;case \"input\":Za(d,f);D(\"invalid\",d);break;case \"select\":d._wrapperState={wasMultiple:!!f.multiple};D(\"invalid\",d);break;case \"textarea\":hb(d,f),D(\"invalid\",d)}ub(c,f);e=null;for(var g in f)if(f.hasOwnProperty(g)){var h=f[g];\"children\"===g?\"string\"===typeof h?d.textContent!==h&&(!0!==f.suppressHydrationWarning&&Af(d.textContent,h,a),e=[\"children\",h]):\"number\"===typeof h&&d.textContent!==\"\"+h&&(!0!==f.suppressHydrationWarning&&Af(d.textContent,\nh,a),e=[\"children\",\"\"+h]):ea.hasOwnProperty(g)&&null!=h&&\"onScroll\"===g&&D(\"scroll\",d)}switch(c){case \"input\":Va(d);db(d,f,!0);break;case \"textarea\":Va(d);jb(d);break;case \"select\":case \"option\":break;default:\"function\"===typeof f.onClick&&(d.onclick=Bf)}d=e;b.updateQueue=d;null!==d&&(b.flags|=4)}else{g=9===e.nodeType?e:e.ownerDocument;\"http://www.w3.org/1999/xhtml\"===a&&(a=kb(c));\"http://www.w3.org/1999/xhtml\"===a?\"script\"===c?(a=g.createElement(\"div\"),a.innerHTML=\"<script>\\x3c/script>\",a=a.removeChild(a.firstChild)):\n\"string\"===typeof d.is?a=g.createElement(c,{is:d.is}):(a=g.createElement(c),\"select\"===c&&(g=a,d.multiple?g.multiple=!0:d.size&&(g.size=d.size))):a=g.createElementNS(a,c);a[Of]=b;a[Pf]=d;Aj(a,b,!1,!1);b.stateNode=a;a:{g=vb(c,d);switch(c){case \"dialog\":D(\"cancel\",a);D(\"close\",a);e=d;break;case \"iframe\":case \"object\":case \"embed\":D(\"load\",a);e=d;break;case \"video\":case \"audio\":for(e=0;e<lf.length;e++)D(lf[e],a);e=d;break;case \"source\":D(\"error\",a);e=d;break;case \"img\":case \"image\":case \"link\":D(\"error\",\na);D(\"load\",a);e=d;break;case \"details\":D(\"toggle\",a);e=d;break;case \"input\":Za(a,d);e=Ya(a,d);D(\"invalid\",a);break;case \"option\":e=d;break;case \"select\":a._wrapperState={wasMultiple:!!d.multiple};e=A({},d,{value:void 0});D(\"invalid\",a);break;case \"textarea\":hb(a,d);e=gb(a,d);D(\"invalid\",a);break;default:e=d}ub(c,e);h=e;for(f in h)if(h.hasOwnProperty(f)){var k=h[f];\"style\"===f?sb(a,k):\"dangerouslySetInnerHTML\"===f?(k=k?k.__html:void 0,null!=k&&nb(a,k)):\"children\"===f?\"string\"===typeof k?(\"textarea\"!==\nc||\"\"!==k)&&ob(a,k):\"number\"===typeof k&&ob(a,\"\"+k):\"suppressContentEditableWarning\"!==f&&\"suppressHydrationWarning\"!==f&&\"autoFocus\"!==f&&(ea.hasOwnProperty(f)?null!=k&&\"onScroll\"===f&&D(\"scroll\",a):null!=k&&ta(a,f,k,g))}switch(c){case \"input\":Va(a);db(a,d,!1);break;case \"textarea\":Va(a);jb(a);break;case \"option\":null!=d.value&&a.setAttribute(\"value\",\"\"+Sa(d.value));break;case \"select\":a.multiple=!!d.multiple;f=d.value;null!=f?fb(a,!!d.multiple,f,!1):null!=d.defaultValue&&fb(a,!!d.multiple,d.defaultValue,\n!0);break;default:\"function\"===typeof e.onClick&&(a.onclick=Bf)}switch(c){case \"button\":case \"input\":case \"select\":case \"textarea\":d=!!d.autoFocus;break a;case \"img\":d=!0;break a;default:d=!1}}d&&(b.flags|=4)}null!==b.ref&&(b.flags|=512,b.flags|=2097152)}S(b);return null;case 6:if(a&&null!=b.stateNode)Dj(a,b,a.memoizedProps,d);else{if(\"string\"!==typeof d&&null===b.stateNode)throw Error(p(166));c=Hh(Gh.current);Hh(Eh.current);if(Gg(b)){d=b.stateNode;c=b.memoizedProps;d[Of]=b;if(f=d.nodeValue!==c)if(a=\nxg,null!==a)switch(a.tag){case 3:Af(d.nodeValue,c,0!==(a.mode&1));break;case 5:!0!==a.memoizedProps.suppressHydrationWarning&&Af(d.nodeValue,c,0!==(a.mode&1))}f&&(b.flags|=4)}else d=(9===c.nodeType?c:c.ownerDocument).createTextNode(d),d[Of]=b,b.stateNode=d}S(b);return null;case 13:E(M);d=b.memoizedState;if(null===a||null!==a.memoizedState&&null!==a.memoizedState.dehydrated){if(I&&null!==yg&&0!==(b.mode&1)&&0===(b.flags&128))Hg(),Ig(),b.flags|=98560,f=!1;else if(f=Gg(b),null!==d&&null!==d.dehydrated){if(null===\na){if(!f)throw Error(p(318));f=b.memoizedState;f=null!==f?f.dehydrated:null;if(!f)throw Error(p(317));f[Of]=b}else Ig(),0===(b.flags&128)&&(b.memoizedState=null),b.flags|=4;S(b);f=!1}else null!==zg&&(Gj(zg),zg=null),f=!0;if(!f)return b.flags&65536?b:null}if(0!==(b.flags&128))return b.lanes=c,b;d=null!==d;d!==(null!==a&&null!==a.memoizedState)&&d&&(b.child.flags|=8192,0!==(b.mode&1)&&(null===a||0!==(M.current&1)?0===T&&(T=3):uj()));null!==b.updateQueue&&(b.flags|=4);S(b);return null;case 4:return Jh(),\nBj(a,b),null===a&&sf(b.stateNode.containerInfo),S(b),null;case 10:return Rg(b.type._context),S(b),null;case 17:return Zf(b.type)&&$f(),S(b),null;case 19:E(M);f=b.memoizedState;if(null===f)return S(b),null;d=0!==(b.flags&128);g=f.rendering;if(null===g)if(d)Ej(f,!1);else{if(0!==T||null!==a&&0!==(a.flags&128))for(a=b.child;null!==a;){g=Mh(a);if(null!==g){b.flags|=128;Ej(f,!1);d=g.updateQueue;null!==d&&(b.updateQueue=d,b.flags|=4);b.subtreeFlags=0;d=c;for(c=b.child;null!==c;)f=c,a=d,f.flags&=14680066,\ng=f.alternate,null===g?(f.childLanes=0,f.lanes=a,f.child=null,f.subtreeFlags=0,f.memoizedProps=null,f.memoizedState=null,f.updateQueue=null,f.dependencies=null,f.stateNode=null):(f.childLanes=g.childLanes,f.lanes=g.lanes,f.child=g.child,f.subtreeFlags=0,f.deletions=null,f.memoizedProps=g.memoizedProps,f.memoizedState=g.memoizedState,f.updateQueue=g.updateQueue,f.type=g.type,a=g.dependencies,f.dependencies=null===a?null:{lanes:a.lanes,firstContext:a.firstContext}),c=c.sibling;G(M,M.current&1|2);return b.child}a=\na.sibling}null!==f.tail&&B()>Hj&&(b.flags|=128,d=!0,Ej(f,!1),b.lanes=4194304)}else{if(!d)if(a=Mh(g),null!==a){if(b.flags|=128,d=!0,c=a.updateQueue,null!==c&&(b.updateQueue=c,b.flags|=4),Ej(f,!0),null===f.tail&&\"hidden\"===f.tailMode&&!g.alternate&&!I)return S(b),null}else 2*B()-f.renderingStartTime>Hj&&1073741824!==c&&(b.flags|=128,d=!0,Ej(f,!1),b.lanes=4194304);f.isBackwards?(g.sibling=b.child,b.child=g):(c=f.last,null!==c?c.sibling=g:b.child=g,f.last=g)}if(null!==f.tail)return b=f.tail,f.rendering=\nb,f.tail=b.sibling,f.renderingStartTime=B(),b.sibling=null,c=M.current,G(M,d?c&1|2:c&1),b;S(b);return null;case 22:case 23:return Ij(),d=null!==b.memoizedState,null!==a&&null!==a.memoizedState!==d&&(b.flags|=8192),d&&0!==(b.mode&1)?0!==(gj&1073741824)&&(S(b),b.subtreeFlags&6&&(b.flags|=8192)):S(b),null;case 24:return null;case 25:return null}throw Error(p(156,b.tag));}\nfunction Jj(a,b){wg(b);switch(b.tag){case 1:return Zf(b.type)&&$f(),a=b.flags,a&65536?(b.flags=a&-65537|128,b):null;case 3:return Jh(),E(Wf),E(H),Oh(),a=b.flags,0!==(a&65536)&&0===(a&128)?(b.flags=a&-65537|128,b):null;case 5:return Lh(b),null;case 13:E(M);a=b.memoizedState;if(null!==a&&null!==a.dehydrated){if(null===b.alternate)throw Error(p(340));Ig()}a=b.flags;return a&65536?(b.flags=a&-65537|128,b):null;case 19:return E(M),null;case 4:return Jh(),null;case 10:return Rg(b.type._context),null;case 22:case 23:return Ij(),\nnull;case 24:return null;default:return null}}var Kj=!1,U=!1,Lj=\"function\"===typeof WeakSet?WeakSet:Set,V=null;function Mj(a,b){var c=a.ref;if(null!==c)if(\"function\"===typeof c)try{c(null)}catch(d){W(a,b,d)}else c.current=null}function Nj(a,b,c){try{c()}catch(d){W(a,b,d)}}var Oj=!1;\nfunction Pj(a,b){Cf=dd;a=Me();if(Ne(a)){if(\"selectionStart\"in a)var c={start:a.selectionStart,end:a.selectionEnd};else a:{c=(c=a.ownerDocument)&&c.defaultView||window;var d=c.getSelection&&c.getSelection();if(d&&0!==d.rangeCount){c=d.anchorNode;var e=d.anchorOffset,f=d.focusNode;d=d.focusOffset;try{c.nodeType,f.nodeType}catch(F){c=null;break a}var g=0,h=-1,k=-1,l=0,m=0,q=a,r=null;b:for(;;){for(var y;;){q!==c||0!==e&&3!==q.nodeType||(h=g+e);q!==f||0!==d&&3!==q.nodeType||(k=g+d);3===q.nodeType&&(g+=\nq.nodeValue.length);if(null===(y=q.firstChild))break;r=q;q=y}for(;;){if(q===a)break b;r===c&&++l===e&&(h=g);r===f&&++m===d&&(k=g);if(null!==(y=q.nextSibling))break;q=r;r=q.parentNode}q=y}c=-1===h||-1===k?null:{start:h,end:k}}else c=null}c=c||{start:0,end:0}}else c=null;Df={focusedElem:a,selectionRange:c};dd=!1;for(V=b;null!==V;)if(b=V,a=b.child,0!==(b.subtreeFlags&1028)&&null!==a)a.return=b,V=a;else for(;null!==V;){b=V;try{var n=b.alternate;if(0!==(b.flags&1024))switch(b.tag){case 0:case 11:case 15:break;\ncase 1:if(null!==n){var t=n.memoizedProps,J=n.memoizedState,x=b.stateNode,w=x.getSnapshotBeforeUpdate(b.elementType===b.type?t:Lg(b.type,t),J);x.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var u=b.stateNode.containerInfo;1===u.nodeType?u.textContent=\"\":9===u.nodeType&&u.documentElement&&u.removeChild(u.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(p(163));}}catch(F){W(b,b.return,F)}a=b.sibling;if(null!==a){a.return=b.return;V=a;break}V=b.return}n=Oj;Oj=!1;return n}\nfunction Qj(a,b,c){var d=b.updateQueue;d=null!==d?d.lastEffect:null;if(null!==d){var e=d=d.next;do{if((e.tag&a)===a){var f=e.destroy;e.destroy=void 0;void 0!==f&&Nj(b,c,f)}e=e.next}while(e!==d)}}function Rj(a,b){b=b.updateQueue;b=null!==b?b.lastEffect:null;if(null!==b){var c=b=b.next;do{if((c.tag&a)===a){var d=c.create;c.destroy=d()}c=c.next}while(c!==b)}}function Sj(a){var b=a.ref;if(null!==b){var c=a.stateNode;switch(a.tag){case 5:a=c;break;default:a=c}\"function\"===typeof b?b(a):b.current=a}}\nfunction Tj(a){var b=a.alternate;null!==b&&(a.alternate=null,Tj(b));a.child=null;a.deletions=null;a.sibling=null;5===a.tag&&(b=a.stateNode,null!==b&&(delete b[Of],delete b[Pf],delete b[of],delete b[Qf],delete b[Rf]));a.stateNode=null;a.return=null;a.dependencies=null;a.memoizedProps=null;a.memoizedState=null;a.pendingProps=null;a.stateNode=null;a.updateQueue=null}function Uj(a){return 5===a.tag||3===a.tag||4===a.tag}\nfunction Vj(a){a:for(;;){for(;null===a.sibling;){if(null===a.return||Uj(a.return))return null;a=a.return}a.sibling.return=a.return;for(a=a.sibling;5!==a.tag&&6!==a.tag&&18!==a.tag;){if(a.flags&2)continue a;if(null===a.child||4===a.tag)continue a;else a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}\nfunction Wj(a,b,c){var d=a.tag;if(5===d||6===d)a=a.stateNode,b?8===c.nodeType?c.parentNode.insertBefore(a,b):c.insertBefore(a,b):(8===c.nodeType?(b=c.parentNode,b.insertBefore(a,c)):(b=c,b.appendChild(a)),c=c._reactRootContainer,null!==c&&void 0!==c||null!==b.onclick||(b.onclick=Bf));else if(4!==d&&(a=a.child,null!==a))for(Wj(a,b,c),a=a.sibling;null!==a;)Wj(a,b,c),a=a.sibling}\nfunction Xj(a,b,c){var d=a.tag;if(5===d||6===d)a=a.stateNode,b?c.insertBefore(a,b):c.appendChild(a);else if(4!==d&&(a=a.child,null!==a))for(Xj(a,b,c),a=a.sibling;null!==a;)Xj(a,b,c),a=a.sibling}var X=null,Yj=!1;function Zj(a,b,c){for(c=c.child;null!==c;)ak(a,b,c),c=c.sibling}\nfunction ak(a,b,c){if(lc&&\"function\"===typeof lc.onCommitFiberUnmount)try{lc.onCommitFiberUnmount(kc,c)}catch(h){}switch(c.tag){case 5:U||Mj(c,b);case 6:var d=X,e=Yj;X=null;Zj(a,b,c);X=d;Yj=e;null!==X&&(Yj?(a=X,c=c.stateNode,8===a.nodeType?a.parentNode.removeChild(c):a.removeChild(c)):X.removeChild(c.stateNode));break;case 18:null!==X&&(Yj?(a=X,c=c.stateNode,8===a.nodeType?Kf(a.parentNode,c):1===a.nodeType&&Kf(a,c),bd(a)):Kf(X,c.stateNode));break;case 4:d=X;e=Yj;X=c.stateNode.containerInfo;Yj=!0;\nZj(a,b,c);X=d;Yj=e;break;case 0:case 11:case 14:case 15:if(!U&&(d=c.updateQueue,null!==d&&(d=d.lastEffect,null!==d))){e=d=d.next;do{var f=e,g=f.destroy;f=f.tag;void 0!==g&&(0!==(f&2)?Nj(c,b,g):0!==(f&4)&&Nj(c,b,g));e=e.next}while(e!==d)}Zj(a,b,c);break;case 1:if(!U&&(Mj(c,b),d=c.stateNode,\"function\"===typeof d.componentWillUnmount))try{d.props=c.memoizedProps,d.state=c.memoizedState,d.componentWillUnmount()}catch(h){W(c,b,h)}Zj(a,b,c);break;case 21:Zj(a,b,c);break;case 22:c.mode&1?(U=(d=U)||null!==\nc.memoizedState,Zj(a,b,c),U=d):Zj(a,b,c);break;default:Zj(a,b,c)}}function bk(a){var b=a.updateQueue;if(null!==b){a.updateQueue=null;var c=a.stateNode;null===c&&(c=a.stateNode=new Lj);b.forEach(function(b){var d=ck.bind(null,a,b);c.has(b)||(c.add(b),b.then(d,d))})}}\nfunction dk(a,b){var c=b.deletions;if(null!==c)for(var d=0;d<c.length;d++){var e=c[d];try{var f=a,g=b,h=g;a:for(;null!==h;){switch(h.tag){case 5:X=h.stateNode;Yj=!1;break a;case 3:X=h.stateNode.containerInfo;Yj=!0;break a;case 4:X=h.stateNode.containerInfo;Yj=!0;break a}h=h.return}if(null===X)throw Error(p(160));ak(f,g,e);X=null;Yj=!1;var k=e.alternate;null!==k&&(k.return=null);e.return=null}catch(l){W(e,b,l)}}if(b.subtreeFlags&12854)for(b=b.child;null!==b;)ek(b,a),b=b.sibling}\nfunction ek(a,b){var c=a.alternate,d=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:dk(b,a);fk(a);if(d&4){try{Qj(3,a,a.return),Rj(3,a)}catch(t){W(a,a.return,t)}try{Qj(5,a,a.return)}catch(t){W(a,a.return,t)}}break;case 1:dk(b,a);fk(a);d&512&&null!==c&&Mj(c,c.return);break;case 5:dk(b,a);fk(a);d&512&&null!==c&&Mj(c,c.return);if(a.flags&32){var e=a.stateNode;try{ob(e,\"\")}catch(t){W(a,a.return,t)}}if(d&4&&(e=a.stateNode,null!=e)){var f=a.memoizedProps,g=null!==c?c.memoizedProps:f,h=a.type,k=a.updateQueue;\na.updateQueue=null;if(null!==k)try{\"input\"===h&&\"radio\"===f.type&&null!=f.name&&ab(e,f);vb(h,g);var l=vb(h,f);for(g=0;g<k.length;g+=2){var m=k[g],q=k[g+1];\"style\"===m?sb(e,q):\"dangerouslySetInnerHTML\"===m?nb(e,q):\"children\"===m?ob(e,q):ta(e,m,q,l)}switch(h){case \"input\":bb(e,f);break;case \"textarea\":ib(e,f);break;case \"select\":var r=e._wrapperState.wasMultiple;e._wrapperState.wasMultiple=!!f.multiple;var y=f.value;null!=y?fb(e,!!f.multiple,y,!1):r!==!!f.multiple&&(null!=f.defaultValue?fb(e,!!f.multiple,\nf.defaultValue,!0):fb(e,!!f.multiple,f.multiple?[]:\"\",!1))}e[Pf]=f}catch(t){W(a,a.return,t)}}break;case 6:dk(b,a);fk(a);if(d&4){if(null===a.stateNode)throw Error(p(162));e=a.stateNode;f=a.memoizedProps;try{e.nodeValue=f}catch(t){W(a,a.return,t)}}break;case 3:dk(b,a);fk(a);if(d&4&&null!==c&&c.memoizedState.isDehydrated)try{bd(b.containerInfo)}catch(t){W(a,a.return,t)}break;case 4:dk(b,a);fk(a);break;case 13:dk(b,a);fk(a);e=a.child;e.flags&8192&&(f=null!==e.memoizedState,e.stateNode.isHidden=f,!f||\nnull!==e.alternate&&null!==e.alternate.memoizedState||(gk=B()));d&4&&bk(a);break;case 22:m=null!==c&&null!==c.memoizedState;a.mode&1?(U=(l=U)||m,dk(b,a),U=l):dk(b,a);fk(a);if(d&8192){l=null!==a.memoizedState;if((a.stateNode.isHidden=l)&&!m&&0!==(a.mode&1))for(V=a,m=a.child;null!==m;){for(q=V=m;null!==V;){r=V;y=r.child;switch(r.tag){case 0:case 11:case 14:case 15:Qj(4,r,r.return);break;case 1:Mj(r,r.return);var n=r.stateNode;if(\"function\"===typeof n.componentWillUnmount){d=r;c=r.return;try{b=d,n.props=\nb.memoizedProps,n.state=b.memoizedState,n.componentWillUnmount()}catch(t){W(d,c,t)}}break;case 5:Mj(r,r.return);break;case 22:if(null!==r.memoizedState){hk(q);continue}}null!==y?(y.return=r,V=y):hk(q)}m=m.sibling}a:for(m=null,q=a;;){if(5===q.tag){if(null===m){m=q;try{e=q.stateNode,l?(f=e.style,\"function\"===typeof f.setProperty?f.setProperty(\"display\",\"none\",\"important\"):f.display=\"none\"):(h=q.stateNode,k=q.memoizedProps.style,g=void 0!==k&&null!==k&&k.hasOwnProperty(\"display\")?k.display:null,h.style.display=\nrb(\"display\",g))}catch(t){W(a,a.return,t)}}}else if(6===q.tag){if(null===m)try{q.stateNode.nodeValue=l?\"\":q.memoizedProps}catch(t){W(a,a.return,t)}}else if((22!==q.tag&&23!==q.tag||null===q.memoizedState||q===a)&&null!==q.child){q.child.return=q;q=q.child;continue}if(q===a)break a;for(;null===q.sibling;){if(null===q.return||q.return===a)break a;m===q&&(m=null);q=q.return}m===q&&(m=null);q.sibling.return=q.return;q=q.sibling}}break;case 19:dk(b,a);fk(a);d&4&&bk(a);break;case 21:break;default:dk(b,\na),fk(a)}}function fk(a){var b=a.flags;if(b&2){try{a:{for(var c=a.return;null!==c;){if(Uj(c)){var d=c;break a}c=c.return}throw Error(p(160));}switch(d.tag){case 5:var e=d.stateNode;d.flags&32&&(ob(e,\"\"),d.flags&=-33);var f=Vj(a);Xj(a,f,e);break;case 3:case 4:var g=d.stateNode.containerInfo,h=Vj(a);Wj(a,h,g);break;default:throw Error(p(161));}}catch(k){W(a,a.return,k)}a.flags&=-3}b&4096&&(a.flags&=-4097)}function ik(a,b,c){V=a;jk(a,b,c)}\nfunction jk(a,b,c){for(var d=0!==(a.mode&1);null!==V;){var e=V,f=e.child;if(22===e.tag&&d){var g=null!==e.memoizedState||Kj;if(!g){var h=e.alternate,k=null!==h&&null!==h.memoizedState||U;h=Kj;var l=U;Kj=g;if((U=k)&&!l)for(V=e;null!==V;)g=V,k=g.child,22===g.tag&&null!==g.memoizedState?kk(e):null!==k?(k.return=g,V=k):kk(e);for(;null!==f;)V=f,jk(f,b,c),f=f.sibling;V=e;Kj=h;U=l}lk(a,b,c)}else 0!==(e.subtreeFlags&8772)&&null!==f?(f.return=e,V=f):lk(a,b,c)}}\nfunction lk(a){for(;null!==V;){var b=V;if(0!==(b.flags&8772)){var c=b.alternate;try{if(0!==(b.flags&8772))switch(b.tag){case 0:case 11:case 15:U||Rj(5,b);break;case 1:var d=b.stateNode;if(b.flags&4&&!U)if(null===c)d.componentDidMount();else{var e=b.elementType===b.type?c.memoizedProps:Lg(b.type,c.memoizedProps);d.componentDidUpdate(e,c.memoizedState,d.__reactInternalSnapshotBeforeUpdate)}var f=b.updateQueue;null!==f&&ih(b,f,d);break;case 3:var g=b.updateQueue;if(null!==g){c=null;if(null!==b.child)switch(b.child.tag){case 5:c=\nb.child.stateNode;break;case 1:c=b.child.stateNode}ih(b,g,c)}break;case 5:var h=b.stateNode;if(null===c&&b.flags&4){c=h;var k=b.memoizedProps;switch(b.type){case \"button\":case \"input\":case \"select\":case \"textarea\":k.autoFocus&&c.focus();break;case \"img\":k.src&&(c.src=k.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(null===b.memoizedState){var l=b.alternate;if(null!==l){var m=l.memoizedState;if(null!==m){var q=m.dehydrated;null!==q&&bd(q)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;\ndefault:throw Error(p(163));}U||b.flags&512&&Sj(b)}catch(r){W(b,b.return,r)}}if(b===a){V=null;break}c=b.sibling;if(null!==c){c.return=b.return;V=c;break}V=b.return}}function hk(a){for(;null!==V;){var b=V;if(b===a){V=null;break}var c=b.sibling;if(null!==c){c.return=b.return;V=c;break}V=b.return}}\nfunction kk(a){for(;null!==V;){var b=V;try{switch(b.tag){case 0:case 11:case 15:var c=b.return;try{Rj(4,b)}catch(k){W(b,c,k)}break;case 1:var d=b.stateNode;if(\"function\"===typeof d.componentDidMount){var e=b.return;try{d.componentDidMount()}catch(k){W(b,e,k)}}var f=b.return;try{Sj(b)}catch(k){W(b,f,k)}break;case 5:var g=b.return;try{Sj(b)}catch(k){W(b,g,k)}}}catch(k){W(b,b.return,k)}if(b===a){V=null;break}var h=b.sibling;if(null!==h){h.return=b.return;V=h;break}V=b.return}}\nvar mk=Math.ceil,nk=ua.ReactCurrentDispatcher,ok=ua.ReactCurrentOwner,pk=ua.ReactCurrentBatchConfig,K=0,R=null,Y=null,Z=0,gj=0,fj=Uf(0),T=0,qk=null,hh=0,rk=0,sk=0,tk=null,uk=null,gk=0,Hj=Infinity,vk=null,Pi=!1,Qi=null,Si=null,wk=!1,xk=null,yk=0,zk=0,Ak=null,Bk=-1,Ck=0;function L(){return 0!==(K&6)?B():-1!==Bk?Bk:Bk=B()}\nfunction lh(a){if(0===(a.mode&1))return 1;if(0!==(K&2)&&0!==Z)return Z&-Z;if(null!==Kg.transition)return 0===Ck&&(Ck=yc()),Ck;a=C;if(0!==a)return a;a=window.event;a=void 0===a?16:jd(a.type);return a}function mh(a,b,c,d){if(50<zk)throw zk=0,Ak=null,Error(p(185));Ac(a,c,d);if(0===(K&2)||a!==R)a===R&&(0===(K&2)&&(rk|=c),4===T&&Dk(a,Z)),Ek(a,d),1===c&&0===K&&0===(b.mode&1)&&(Hj=B()+500,fg&&jg())}\nfunction Ek(a,b){var c=a.callbackNode;wc(a,b);var d=uc(a,a===R?Z:0);if(0===d)null!==c&&bc(c),a.callbackNode=null,a.callbackPriority=0;else if(b=d&-d,a.callbackPriority!==b){null!=c&&bc(c);if(1===b)0===a.tag?ig(Fk.bind(null,a)):hg(Fk.bind(null,a)),Jf(function(){0===(K&6)&&jg()}),c=null;else{switch(Dc(d)){case 1:c=fc;break;case 4:c=gc;break;case 16:c=hc;break;case 536870912:c=jc;break;default:c=hc}c=Gk(c,Hk.bind(null,a))}a.callbackPriority=b;a.callbackNode=c}}\nfunction Hk(a,b){Bk=-1;Ck=0;if(0!==(K&6))throw Error(p(327));var c=a.callbackNode;if(Ik()&&a.callbackNode!==c)return null;var d=uc(a,a===R?Z:0);if(0===d)return null;if(0!==(d&30)||0!==(d&a.expiredLanes)||b)b=Jk(a,d);else{b=d;var e=K;K|=2;var f=Kk();if(R!==a||Z!==b)vk=null,Hj=B()+500,Lk(a,b);do try{Mk();break}catch(h){Nk(a,h)}while(1);Qg();nk.current=f;K=e;null!==Y?b=0:(R=null,Z=0,b=T)}if(0!==b){2===b&&(e=xc(a),0!==e&&(d=e,b=Ok(a,e)));if(1===b)throw c=qk,Lk(a,0),Dk(a,d),Ek(a,B()),c;if(6===b)Dk(a,d);\nelse{e=a.current.alternate;if(0===(d&30)&&!Pk(e)&&(b=Jk(a,d),2===b&&(f=xc(a),0!==f&&(d=f,b=Ok(a,f))),1===b))throw c=qk,Lk(a,0),Dk(a,d),Ek(a,B()),c;a.finishedWork=e;a.finishedLanes=d;switch(b){case 0:case 1:throw Error(p(345));case 2:Qk(a,uk,vk);break;case 3:Dk(a,d);if((d&130023424)===d&&(b=gk+500-B(),10<b)){if(0!==uc(a,0))break;e=a.suspendedLanes;if((e&d)!==d){L();a.pingedLanes|=a.suspendedLanes&e;break}a.timeoutHandle=Ff(Qk.bind(null,a,uk,vk),b);break}Qk(a,uk,vk);break;case 4:Dk(a,d);if((d&4194240)===\nd)break;b=a.eventTimes;for(e=-1;0<d;){var g=31-oc(d);f=1<<g;g=b[g];g>e&&(e=g);d&=~f}d=e;d=B()-d;d=(120>d?120:480>d?480:1080>d?1080:1920>d?1920:3E3>d?3E3:4320>d?4320:1960*mk(d/1960))-d;if(10<d){a.timeoutHandle=Ff(Qk.bind(null,a,uk,vk),d);break}Qk(a,uk,vk);break;case 5:Qk(a,uk,vk);break;default:throw Error(p(329));}}}Ek(a,B());return a.callbackNode===c?Hk.bind(null,a):null}\nfunction Ok(a,b){var c=tk;a.current.memoizedState.isDehydrated&&(Lk(a,b).flags|=256);a=Jk(a,b);2!==a&&(b=uk,uk=c,null!==b&&Gj(b));return a}function Gj(a){null===uk?uk=a:uk.push.apply(uk,a)}\nfunction Pk(a){for(var b=a;;){if(b.flags&16384){var c=b.updateQueue;if(null!==c&&(c=c.stores,null!==c))for(var d=0;d<c.length;d++){var e=c[d],f=e.getSnapshot;e=e.value;try{if(!He(f(),e))return!1}catch(g){return!1}}}c=b.child;if(b.subtreeFlags&16384&&null!==c)c.return=b,b=c;else{if(b===a)break;for(;null===b.sibling;){if(null===b.return||b.return===a)return!0;b=b.return}b.sibling.return=b.return;b=b.sibling}}return!0}\nfunction Dk(a,b){b&=~sk;b&=~rk;a.suspendedLanes|=b;a.pingedLanes&=~b;for(a=a.expirationTimes;0<b;){var c=31-oc(b),d=1<<c;a[c]=-1;b&=~d}}function Fk(a){if(0!==(K&6))throw Error(p(327));Ik();var b=uc(a,0);if(0===(b&1))return Ek(a,B()),null;var c=Jk(a,b);if(0!==a.tag&&2===c){var d=xc(a);0!==d&&(b=d,c=Ok(a,d))}if(1===c)throw c=qk,Lk(a,0),Dk(a,b),Ek(a,B()),c;if(6===c)throw Error(p(345));a.finishedWork=a.current.alternate;a.finishedLanes=b;Qk(a,uk,vk);Ek(a,B());return null}\nfunction Rk(a,b){var c=K;K|=1;try{return a(b)}finally{K=c,0===K&&(Hj=B()+500,fg&&jg())}}function Sk(a){null!==xk&&0===xk.tag&&0===(K&6)&&Ik();var b=K;K|=1;var c=pk.transition,d=C;try{if(pk.transition=null,C=1,a)return a()}finally{C=d,pk.transition=c,K=b,0===(K&6)&&jg()}}function Ij(){gj=fj.current;E(fj)}\nfunction Lk(a,b){a.finishedWork=null;a.finishedLanes=0;var c=a.timeoutHandle;-1!==c&&(a.timeoutHandle=-1,Gf(c));if(null!==Y)for(c=Y.return;null!==c;){var d=c;wg(d);switch(d.tag){case 1:d=d.type.childContextTypes;null!==d&&void 0!==d&&$f();break;case 3:Jh();E(Wf);E(H);Oh();break;case 5:Lh(d);break;case 4:Jh();break;case 13:E(M);break;case 19:E(M);break;case 10:Rg(d.type._context);break;case 22:case 23:Ij()}c=c.return}R=a;Y=a=wh(a.current,null);Z=gj=b;T=0;qk=null;sk=rk=hh=0;uk=tk=null;if(null!==Wg){for(b=\n0;b<Wg.length;b++)if(c=Wg[b],d=c.interleaved,null!==d){c.interleaved=null;var e=d.next,f=c.pending;if(null!==f){var g=f.next;f.next=e;d.next=g}c.pending=d}Wg=null}return a}\nfunction Nk(a,b){do{var c=Y;try{Qg();Ph.current=ai;if(Sh){for(var d=N.memoizedState;null!==d;){var e=d.queue;null!==e&&(e.pending=null);d=d.next}Sh=!1}Rh=0;P=O=N=null;Th=!1;Uh=0;ok.current=null;if(null===c||null===c.return){T=1;qk=b;Y=null;break}a:{var f=a,g=c.return,h=c,k=b;b=Z;h.flags|=32768;if(null!==k&&\"object\"===typeof k&&\"function\"===typeof k.then){var l=k,m=h,q=m.tag;if(0===(m.mode&1)&&(0===q||11===q||15===q)){var r=m.alternate;r?(m.updateQueue=r.updateQueue,m.memoizedState=r.memoizedState,\nm.lanes=r.lanes):(m.updateQueue=null,m.memoizedState=null)}var y=Vi(g);if(null!==y){y.flags&=-257;Wi(y,g,h,f,b);y.mode&1&&Ti(f,l,b);b=y;k=l;var n=b.updateQueue;if(null===n){var t=new Set;t.add(k);b.updateQueue=t}else n.add(k);break a}else{if(0===(b&1)){Ti(f,l,b);uj();break a}k=Error(p(426))}}else if(I&&h.mode&1){var J=Vi(g);if(null!==J){0===(J.flags&65536)&&(J.flags|=256);Wi(J,g,h,f,b);Jg(Ki(k,h));break a}}f=k=Ki(k,h);4!==T&&(T=2);null===tk?tk=[f]:tk.push(f);f=g;do{switch(f.tag){case 3:f.flags|=65536;\nb&=-b;f.lanes|=b;var x=Oi(f,k,b);fh(f,x);break a;case 1:h=k;var w=f.type,u=f.stateNode;if(0===(f.flags&128)&&(\"function\"===typeof w.getDerivedStateFromError||null!==u&&\"function\"===typeof u.componentDidCatch&&(null===Si||!Si.has(u)))){f.flags|=65536;b&=-b;f.lanes|=b;var F=Ri(f,h,b);fh(f,F);break a}}f=f.return}while(null!==f)}Tk(c)}catch(na){b=na;Y===c&&null!==c&&(Y=c=c.return);continue}break}while(1)}function Kk(){var a=nk.current;nk.current=ai;return null===a?ai:a}\nfunction uj(){if(0===T||3===T||2===T)T=4;null===R||0===(hh&268435455)&&0===(rk&268435455)||Dk(R,Z)}function Jk(a,b){var c=K;K|=2;var d=Kk();if(R!==a||Z!==b)vk=null,Lk(a,b);do try{Uk();break}catch(e){Nk(a,e)}while(1);Qg();K=c;nk.current=d;if(null!==Y)throw Error(p(261));R=null;Z=0;return T}function Uk(){for(;null!==Y;)Vk(Y)}function Mk(){for(;null!==Y&&!cc();)Vk(Y)}function Vk(a){var b=Wk(a.alternate,a,gj);a.memoizedProps=a.pendingProps;null===b?Tk(a):Y=b;ok.current=null}\nfunction Tk(a){var b=a;do{var c=b.alternate;a=b.return;if(0===(b.flags&32768)){if(c=Fj(c,b,gj),null!==c){Y=c;return}}else{c=Jj(c,b);if(null!==c){c.flags&=32767;Y=c;return}if(null!==a)a.flags|=32768,a.subtreeFlags=0,a.deletions=null;else{T=6;Y=null;return}}b=b.sibling;if(null!==b){Y=b;return}Y=b=a}while(null!==b);0===T&&(T=5)}function Qk(a,b,c){var d=C,e=pk.transition;try{pk.transition=null,C=1,Xk(a,b,c,d)}finally{pk.transition=e,C=d}return null}\nfunction Xk(a,b,c,d){do Ik();while(null!==xk);if(0!==(K&6))throw Error(p(327));c=a.finishedWork;var e=a.finishedLanes;if(null===c)return null;a.finishedWork=null;a.finishedLanes=0;if(c===a.current)throw Error(p(177));a.callbackNode=null;a.callbackPriority=0;var f=c.lanes|c.childLanes;Bc(a,f);a===R&&(Y=R=null,Z=0);0===(c.subtreeFlags&2064)&&0===(c.flags&2064)||wk||(wk=!0,Gk(hc,function(){Ik();return null}));f=0!==(c.flags&15990);if(0!==(c.subtreeFlags&15990)||f){f=pk.transition;pk.transition=null;\nvar g=C;C=1;var h=K;K|=4;ok.current=null;Pj(a,c);ek(c,a);Oe(Df);dd=!!Cf;Df=Cf=null;a.current=c;ik(c,a,e);dc();K=h;C=g;pk.transition=f}else a.current=c;wk&&(wk=!1,xk=a,yk=e);f=a.pendingLanes;0===f&&(Si=null);mc(c.stateNode,d);Ek(a,B());if(null!==b)for(d=a.onRecoverableError,c=0;c<b.length;c++)e=b[c],d(e.value,{componentStack:e.stack,digest:e.digest});if(Pi)throw Pi=!1,a=Qi,Qi=null,a;0!==(yk&1)&&0!==a.tag&&Ik();f=a.pendingLanes;0!==(f&1)?a===Ak?zk++:(zk=0,Ak=a):zk=0;jg();return null}\nfunction Ik(){if(null!==xk){var a=Dc(yk),b=pk.transition,c=C;try{pk.transition=null;C=16>a?16:a;if(null===xk)var d=!1;else{a=xk;xk=null;yk=0;if(0!==(K&6))throw Error(p(331));var e=K;K|=4;for(V=a.current;null!==V;){var f=V,g=f.child;if(0!==(V.flags&16)){var h=f.deletions;if(null!==h){for(var k=0;k<h.length;k++){var l=h[k];for(V=l;null!==V;){var m=V;switch(m.tag){case 0:case 11:case 15:Qj(8,m,f)}var q=m.child;if(null!==q)q.return=m,V=q;else for(;null!==V;){m=V;var r=m.sibling,y=m.return;Tj(m);if(m===\nl){V=null;break}if(null!==r){r.return=y;V=r;break}V=y}}}var n=f.alternate;if(null!==n){var t=n.child;if(null!==t){n.child=null;do{var J=t.sibling;t.sibling=null;t=J}while(null!==t)}}V=f}}if(0!==(f.subtreeFlags&2064)&&null!==g)g.return=f,V=g;else b:for(;null!==V;){f=V;if(0!==(f.flags&2048))switch(f.tag){case 0:case 11:case 15:Qj(9,f,f.return)}var x=f.sibling;if(null!==x){x.return=f.return;V=x;break b}V=f.return}}var w=a.current;for(V=w;null!==V;){g=V;var u=g.child;if(0!==(g.subtreeFlags&2064)&&null!==\nu)u.return=g,V=u;else b:for(g=w;null!==V;){h=V;if(0!==(h.flags&2048))try{switch(h.tag){case 0:case 11:case 15:Rj(9,h)}}catch(na){W(h,h.return,na)}if(h===g){V=null;break b}var F=h.sibling;if(null!==F){F.return=h.return;V=F;break b}V=h.return}}K=e;jg();if(lc&&\"function\"===typeof lc.onPostCommitFiberRoot)try{lc.onPostCommitFiberRoot(kc,a)}catch(na){}d=!0}return d}finally{C=c,pk.transition=b}}return!1}function Yk(a,b,c){b=Ki(c,b);b=Oi(a,b,1);a=dh(a,b,1);b=L();null!==a&&(Ac(a,1,b),Ek(a,b))}\nfunction W(a,b,c){if(3===a.tag)Yk(a,a,c);else for(;null!==b;){if(3===b.tag){Yk(b,a,c);break}else if(1===b.tag){var d=b.stateNode;if(\"function\"===typeof b.type.getDerivedStateFromError||\"function\"===typeof d.componentDidCatch&&(null===Si||!Si.has(d))){a=Ki(c,a);a=Ri(b,a,1);b=dh(b,a,1);a=L();null!==b&&(Ac(b,1,a),Ek(b,a));break}}b=b.return}}\nfunction Ui(a,b,c){var d=a.pingCache;null!==d&&d.delete(b);b=L();a.pingedLanes|=a.suspendedLanes&c;R===a&&(Z&c)===c&&(4===T||3===T&&(Z&130023424)===Z&&500>B()-gk?Lk(a,0):sk|=c);Ek(a,b)}function Zk(a,b){0===b&&(0===(a.mode&1)?b=1:(b=sc,sc<<=1,0===(sc&130023424)&&(sc=4194304)));var c=L();a=Zg(a,b);null!==a&&(Ac(a,b,c),Ek(a,c))}function vj(a){var b=a.memoizedState,c=0;null!==b&&(c=b.retryLane);Zk(a,c)}\nfunction ck(a,b){var c=0;switch(a.tag){case 13:var d=a.stateNode;var e=a.memoizedState;null!==e&&(c=e.retryLane);break;case 19:d=a.stateNode;break;default:throw Error(p(314));}null!==d&&d.delete(b);Zk(a,c)}var Wk;\nWk=function(a,b,c){if(null!==a)if(a.memoizedProps!==b.pendingProps||Wf.current)Ug=!0;else{if(0===(a.lanes&c)&&0===(b.flags&128))return Ug=!1,zj(a,b,c);Ug=0!==(a.flags&131072)?!0:!1}else Ug=!1,I&&0!==(b.flags&1048576)&&ug(b,ng,b.index);b.lanes=0;switch(b.tag){case 2:var d=b.type;jj(a,b);a=b.pendingProps;var e=Yf(b,H.current);Tg(b,c);e=Xh(null,b,d,a,e,c);var f=bi();b.flags|=1;\"object\"===typeof e&&null!==e&&\"function\"===typeof e.render&&void 0===e.$$typeof?(b.tag=1,b.memoizedState=null,b.updateQueue=\nnull,Zf(d)?(f=!0,cg(b)):f=!1,b.memoizedState=null!==e.state&&void 0!==e.state?e.state:null,ah(b),e.updater=nh,b.stateNode=e,e._reactInternals=b,rh(b,d,a,c),b=kj(null,b,d,!0,f,c)):(b.tag=0,I&&f&&vg(b),Yi(null,b,e,c),b=b.child);return b;case 16:d=b.elementType;a:{jj(a,b);a=b.pendingProps;e=d._init;d=e(d._payload);b.type=d;e=b.tag=$k(d);a=Lg(d,a);switch(e){case 0:b=dj(null,b,d,a,c);break a;case 1:b=ij(null,b,d,a,c);break a;case 11:b=Zi(null,b,d,a,c);break a;case 14:b=aj(null,b,d,Lg(d.type,a),c);break a}throw Error(p(306,\nd,\"\"));}return b;case 0:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:Lg(d,e),dj(a,b,d,e,c);case 1:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:Lg(d,e),ij(a,b,d,e,c);case 3:a:{lj(b);if(null===a)throw Error(p(387));d=b.pendingProps;f=b.memoizedState;e=f.element;bh(a,b);gh(b,d,null,c);var g=b.memoizedState;d=g.element;if(f.isDehydrated)if(f={element:d,isDehydrated:!1,cache:g.cache,pendingSuspenseBoundaries:g.pendingSuspenseBoundaries,transitions:g.transitions},b.updateQueue.baseState=\nf,b.memoizedState=f,b.flags&256){e=Ki(Error(p(423)),b);b=mj(a,b,d,c,e);break a}else if(d!==e){e=Ki(Error(p(424)),b);b=mj(a,b,d,c,e);break a}else for(yg=Lf(b.stateNode.containerInfo.firstChild),xg=b,I=!0,zg=null,c=Ch(b,null,d,c),b.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling;else{Ig();if(d===e){b=$i(a,b,c);break a}Yi(a,b,d,c)}b=b.child}return b;case 5:return Kh(b),null===a&&Eg(b),d=b.type,e=b.pendingProps,f=null!==a?a.memoizedProps:null,g=e.children,Ef(d,e)?g=null:null!==f&&Ef(d,f)&&(b.flags|=32),\nhj(a,b),Yi(a,b,g,c),b.child;case 6:return null===a&&Eg(b),null;case 13:return pj(a,b,c);case 4:return Ih(b,b.stateNode.containerInfo),d=b.pendingProps,null===a?b.child=Bh(b,null,d,c):Yi(a,b,d,c),b.child;case 11:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:Lg(d,e),Zi(a,b,d,e,c);case 7:return Yi(a,b,b.pendingProps,c),b.child;case 8:return Yi(a,b,b.pendingProps.children,c),b.child;case 12:return Yi(a,b,b.pendingProps.children,c),b.child;case 10:a:{d=b.type._context;e=b.pendingProps;f=b.memoizedProps;\ng=e.value;G(Mg,d._currentValue);d._currentValue=g;if(null!==f)if(He(f.value,g)){if(f.children===e.children&&!Wf.current){b=$i(a,b,c);break a}}else for(f=b.child,null!==f&&(f.return=b);null!==f;){var h=f.dependencies;if(null!==h){g=f.child;for(var k=h.firstContext;null!==k;){if(k.context===d){if(1===f.tag){k=ch(-1,c&-c);k.tag=2;var l=f.updateQueue;if(null!==l){l=l.shared;var m=l.pending;null===m?k.next=k:(k.next=m.next,m.next=k);l.pending=k}}f.lanes|=c;k=f.alternate;null!==k&&(k.lanes|=c);Sg(f.return,\nc,b);h.lanes|=c;break}k=k.next}}else if(10===f.tag)g=f.type===b.type?null:f.child;else if(18===f.tag){g=f.return;if(null===g)throw Error(p(341));g.lanes|=c;h=g.alternate;null!==h&&(h.lanes|=c);Sg(g,c,b);g=f.sibling}else g=f.child;if(null!==g)g.return=f;else for(g=f;null!==g;){if(g===b){g=null;break}f=g.sibling;if(null!==f){f.return=g.return;g=f;break}g=g.return}f=g}Yi(a,b,e.children,c);b=b.child}return b;case 9:return e=b.type,d=b.pendingProps.children,Tg(b,c),e=Vg(e),d=d(e),b.flags|=1,Yi(a,b,d,c),\nb.child;case 14:return d=b.type,e=Lg(d,b.pendingProps),e=Lg(d.type,e),aj(a,b,d,e,c);case 15:return cj(a,b,b.type,b.pendingProps,c);case 17:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:Lg(d,e),jj(a,b),b.tag=1,Zf(d)?(a=!0,cg(b)):a=!1,Tg(b,c),ph(b,d,e),rh(b,d,e,c),kj(null,b,d,!0,a,c);case 19:return yj(a,b,c);case 22:return ej(a,b,c)}throw Error(p(156,b.tag));};function Gk(a,b){return ac(a,b)}\nfunction al(a,b,c,d){this.tag=a;this.key=c;this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null;this.index=0;this.ref=null;this.pendingProps=b;this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null;this.mode=d;this.subtreeFlags=this.flags=0;this.deletions=null;this.childLanes=this.lanes=0;this.alternate=null}function Bg(a,b,c,d){return new al(a,b,c,d)}function bj(a){a=a.prototype;return!(!a||!a.isReactComponent)}\nfunction $k(a){if(\"function\"===typeof a)return bj(a)?1:0;if(void 0!==a&&null!==a){a=a.$$typeof;if(a===Da)return 11;if(a===Ga)return 14}return 2}\nfunction wh(a,b){var c=a.alternate;null===c?(c=Bg(a.tag,b,a.key,a.mode),c.elementType=a.elementType,c.type=a.type,c.stateNode=a.stateNode,c.alternate=a,a.alternate=c):(c.pendingProps=b,c.type=a.type,c.flags=0,c.subtreeFlags=0,c.deletions=null);c.flags=a.flags&14680064;c.childLanes=a.childLanes;c.lanes=a.lanes;c.child=a.child;c.memoizedProps=a.memoizedProps;c.memoizedState=a.memoizedState;c.updateQueue=a.updateQueue;b=a.dependencies;c.dependencies=null===b?null:{lanes:b.lanes,firstContext:b.firstContext};\nc.sibling=a.sibling;c.index=a.index;c.ref=a.ref;return c}\nfunction yh(a,b,c,d,e,f){var g=2;d=a;if(\"function\"===typeof a)bj(a)&&(g=1);else if(\"string\"===typeof a)g=5;else a:switch(a){case ya:return Ah(c.children,e,f,b);case za:g=8;e|=8;break;case Aa:return a=Bg(12,c,b,e|2),a.elementType=Aa,a.lanes=f,a;case Ea:return a=Bg(13,c,b,e),a.elementType=Ea,a.lanes=f,a;case Fa:return a=Bg(19,c,b,e),a.elementType=Fa,a.lanes=f,a;case Ia:return qj(c,e,f,b);default:if(\"object\"===typeof a&&null!==a)switch(a.$$typeof){case Ba:g=10;break a;case Ca:g=9;break a;case Da:g=11;\nbreak a;case Ga:g=14;break a;case Ha:g=16;d=null;break a}throw Error(p(130,null==a?a:typeof a,\"\"));}b=Bg(g,c,b,e);b.elementType=a;b.type=d;b.lanes=f;return b}function Ah(a,b,c,d){a=Bg(7,a,d,b);a.lanes=c;return a}function qj(a,b,c,d){a=Bg(22,a,d,b);a.elementType=Ia;a.lanes=c;a.stateNode={isHidden:!1};return a}function xh(a,b,c){a=Bg(6,a,null,b);a.lanes=c;return a}\nfunction zh(a,b,c){b=Bg(4,null!==a.children?a.children:[],a.key,b);b.lanes=c;b.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation};return b}\nfunction bl(a,b,c,d,e){this.tag=b;this.containerInfo=a;this.finishedWork=this.pingCache=this.current=this.pendingChildren=null;this.timeoutHandle=-1;this.callbackNode=this.pendingContext=this.context=null;this.callbackPriority=0;this.eventTimes=zc(0);this.expirationTimes=zc(-1);this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0;this.entanglements=zc(0);this.identifierPrefix=d;this.onRecoverableError=e;this.mutableSourceEagerHydrationData=\nnull}function cl(a,b,c,d,e,f,g,h,k){a=new bl(a,b,c,h,k);1===b?(b=1,!0===f&&(b|=8)):b=0;f=Bg(3,null,null,b);a.current=f;f.stateNode=a;f.memoizedState={element:d,isDehydrated:c,cache:null,transitions:null,pendingSuspenseBoundaries:null};ah(f);return a}function dl(a,b,c){var d=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:wa,key:null==d?null:\"\"+d,children:a,containerInfo:b,implementation:c}}\nfunction el(a){if(!a)return Vf;a=a._reactInternals;a:{if(Vb(a)!==a||1!==a.tag)throw Error(p(170));var b=a;do{switch(b.tag){case 3:b=b.stateNode.context;break a;case 1:if(Zf(b.type)){b=b.stateNode.__reactInternalMemoizedMergedChildContext;break a}}b=b.return}while(null!==b);throw Error(p(171));}if(1===a.tag){var c=a.type;if(Zf(c))return bg(a,c,b)}return b}\nfunction fl(a,b,c,d,e,f,g,h,k){a=cl(c,d,!0,a,e,f,g,h,k);a.context=el(null);c=a.current;d=L();e=lh(c);f=ch(d,e);f.callback=void 0!==b&&null!==b?b:null;dh(c,f,e);a.current.lanes=e;Ac(a,e,d);Ek(a,d);return a}function gl(a,b,c,d){var e=b.current,f=L(),g=lh(e);c=el(c);null===b.context?b.context=c:b.pendingContext=c;b=ch(f,g);b.payload={element:a};d=void 0===d?null:d;null!==d&&(b.callback=d);a=dh(e,b,g);null!==a&&(mh(a,e,g,f),eh(a,e,g));return g}\nfunction hl(a){a=a.current;if(!a.child)return null;switch(a.child.tag){case 5:return a.child.stateNode;default:return a.child.stateNode}}function il(a,b){a=a.memoizedState;if(null!==a&&null!==a.dehydrated){var c=a.retryLane;a.retryLane=0!==c&&c<b?c:b}}function jl(a,b){il(a,b);(a=a.alternate)&&il(a,b)}function kl(){return null}var ll=\"function\"===typeof reportError?reportError:function(a){console.error(a)};function ml(a){this._internalRoot=a}\nnl.prototype.render=ml.prototype.render=function(a){var b=this._internalRoot;if(null===b)throw Error(p(409));gl(a,b,null,null)};nl.prototype.unmount=ml.prototype.unmount=function(){var a=this._internalRoot;if(null!==a){this._internalRoot=null;var b=a.containerInfo;Sk(function(){gl(null,a,null,null)});b[uf]=null}};function nl(a){this._internalRoot=a}\nnl.prototype.unstable_scheduleHydration=function(a){if(a){var b=Hc();a={blockedOn:null,target:a,priority:b};for(var c=0;c<Qc.length&&0!==b&&b<Qc[c].priority;c++);Qc.splice(c,0,a);0===c&&Vc(a)}};function ol(a){return!(!a||1!==a.nodeType&&9!==a.nodeType&&11!==a.nodeType)}function pl(a){return!(!a||1!==a.nodeType&&9!==a.nodeType&&11!==a.nodeType&&(8!==a.nodeType||\" react-mount-point-unstable \"!==a.nodeValue))}function ql(){}\nfunction rl(a,b,c,d,e){if(e){if(\"function\"===typeof d){var f=d;d=function(){var a=hl(g);f.call(a)}}var g=fl(b,d,a,0,null,!1,!1,\"\",ql);a._reactRootContainer=g;a[uf]=g.current;sf(8===a.nodeType?a.parentNode:a);Sk();return g}for(;e=a.lastChild;)a.removeChild(e);if(\"function\"===typeof d){var h=d;d=function(){var a=hl(k);h.call(a)}}var k=cl(a,0,!1,null,null,!1,!1,\"\",ql);a._reactRootContainer=k;a[uf]=k.current;sf(8===a.nodeType?a.parentNode:a);Sk(function(){gl(b,k,c,d)});return k}\nfunction sl(a,b,c,d,e){var f=c._reactRootContainer;if(f){var g=f;if(\"function\"===typeof e){var h=e;e=function(){var a=hl(g);h.call(a)}}gl(b,g,a,e)}else g=rl(c,b,a,e,d);return hl(g)}Ec=function(a){switch(a.tag){case 3:var b=a.stateNode;if(b.current.memoizedState.isDehydrated){var c=tc(b.pendingLanes);0!==c&&(Cc(b,c|1),Ek(b,B()),0===(K&6)&&(Hj=B()+500,jg()))}break;case 13:Sk(function(){var b=Zg(a,1);if(null!==b){var c=L();mh(b,a,1,c)}}),jl(a,1)}};\nFc=function(a){if(13===a.tag){var b=Zg(a,134217728);if(null!==b){var c=L();mh(b,a,134217728,c)}jl(a,134217728)}};Gc=function(a){if(13===a.tag){var b=lh(a),c=Zg(a,b);if(null!==c){var d=L();mh(c,a,b,d)}jl(a,b)}};Hc=function(){return C};Ic=function(a,b){var c=C;try{return C=a,b()}finally{C=c}};\nyb=function(a,b,c){switch(b){case \"input\":bb(a,c);b=c.name;if(\"radio\"===c.type&&null!=b){for(c=a;c.parentNode;)c=c.parentNode;c=c.querySelectorAll(\"input[name=\"+JSON.stringify(\"\"+b)+'][type=\"radio\"]');for(b=0;b<c.length;b++){var d=c[b];if(d!==a&&d.form===a.form){var e=Db(d);if(!e)throw Error(p(90));Wa(d);bb(d,e)}}}break;case \"textarea\":ib(a,c);break;case \"select\":b=c.value,null!=b&&fb(a,!!c.multiple,b,!1)}};Gb=Rk;Hb=Sk;\nvar tl={usingClientEntryPoint:!1,Events:[Cb,ue,Db,Eb,Fb,Rk]},ul={findFiberByHostInstance:Wc,bundleType:0,version:\"18.2.0\",rendererPackageName:\"react-dom\"};\nvar vl={bundleType:ul.bundleType,version:ul.version,rendererPackageName:ul.rendererPackageName,rendererConfig:ul.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ua.ReactCurrentDispatcher,findHostInstanceByFiber:function(a){a=Zb(a);return null===a?null:a.stateNode},findFiberByHostInstance:ul.findFiberByHostInstance||\nkl,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:\"18.2.0-next-9e3b772b8-20220608\"};if(\"undefined\"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var wl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!wl.isDisabled&&wl.supportsFiber)try{kc=wl.inject(vl),lc=wl}catch(a){}}exports.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tl;\nexports.createPortal=function(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!ol(b))throw Error(p(200));return dl(a,b,null,c)};exports.createRoot=function(a,b){if(!ol(a))throw Error(p(299));var c=!1,d=\"\",e=ll;null!==b&&void 0!==b&&(!0===b.unstable_strictMode&&(c=!0),void 0!==b.identifierPrefix&&(d=b.identifierPrefix),void 0!==b.onRecoverableError&&(e=b.onRecoverableError));b=cl(a,1,!1,null,null,c,!1,d,e);a[uf]=b.current;sf(8===a.nodeType?a.parentNode:a);return new ml(b)};\nexports.findDOMNode=function(a){if(null==a)return null;if(1===a.nodeType)return a;var b=a._reactInternals;if(void 0===b){if(\"function\"===typeof a.render)throw Error(p(188));a=Object.keys(a).join(\",\");throw Error(p(268,a));}a=Zb(b);a=null===a?null:a.stateNode;return a};exports.flushSync=function(a){return Sk(a)};exports.hydrate=function(a,b,c){if(!pl(b))throw Error(p(200));return sl(null,a,b,!0,c)};\nexports.hydrateRoot=function(a,b,c){if(!ol(a))throw Error(p(405));var d=null!=c&&c.hydratedSources||null,e=!1,f=\"\",g=ll;null!==c&&void 0!==c&&(!0===c.unstable_strictMode&&(e=!0),void 0!==c.identifierPrefix&&(f=c.identifierPrefix),void 0!==c.onRecoverableError&&(g=c.onRecoverableError));b=fl(b,null,a,1,null!=c?c:null,e,!1,f,g);a[uf]=b.current;sf(a);if(d)for(a=0;a<d.length;a++)c=d[a],e=c._getVersion,e=e(c._source),null==b.mutableSourceEagerHydrationData?b.mutableSourceEagerHydrationData=[c,e]:b.mutableSourceEagerHydrationData.push(c,\ne);return new nl(b)};exports.render=function(a,b,c){if(!pl(b))throw Error(p(200));return sl(null,a,b,!1,c)};exports.unmountComponentAtNode=function(a){if(!pl(a))throw Error(p(40));return a._reactRootContainer?(Sk(function(){sl(null,null,a,!1,function(){a._reactRootContainer=null;a[uf]=null})}),!0):!1};exports.unstable_batchedUpdates=Rk;\nexports.unstable_renderSubtreeIntoContainer=function(a,b,c,d){if(!pl(c))throw Error(p(200));if(null==a||void 0===a._reactInternals)throw Error(p(38));return sl(a,b,c,!1,d)};exports.version=\"18.2.0-next-9e3b772b8-20220608\";\n","'use strict';\n\nfunction checkDCE() {\n  /* global __REACT_DEVTOOLS_GLOBAL_HOOK__ */\n  if (\n    typeof __REACT_DEVTOOLS_GLOBAL_HOOK__ === 'undefined' ||\n    typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE !== 'function'\n  ) {\n    return;\n  }\n  if (process.env.NODE_ENV !== 'production') {\n    // This branch is unreachable because this function is only called\n    // in production, but the condition is true only in development.\n    // Therefore if the branch is still here, dead code elimination wasn't\n    // properly applied.\n    // Don't change the message. React DevTools relies on it. Also make sure\n    // this message doesn't occur elsewhere in this function, or it will cause\n    // a false positive.\n    throw new Error('^_^');\n  }\n  try {\n    // Verify that the code above has been dead code eliminated (DCE'd).\n    __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(checkDCE);\n  } catch (err) {\n    // DevTools shouldn't crash React, no matter what.\n    // We should still report in case we break this code.\n    console.error(err);\n  }\n}\n\nif (process.env.NODE_ENV === 'production') {\n  // DCE check should happen before ReactDOM bundle executes so that\n  // DevTools can report bad minification during injection.\n  checkDCE();\n  module.exports = require('./cjs/react-dom.production.min.js');\n} else {\n  module.exports = require('./cjs/react-dom.development.js');\n}\n","/**\n * @license React\n * react-jsx-runtime.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n'use strict';var f=require(\"react\"),k=Symbol.for(\"react.element\"),l=Symbol.for(\"react.fragment\"),m=Object.prototype.hasOwnProperty,n=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p={key:!0,ref:!0,__self:!0,__source:!0};\nfunction q(c,a,g){var b,d={},e=null,h=null;void 0!==g&&(e=\"\"+g);void 0!==a.key&&(e=\"\"+a.key);void 0!==a.ref&&(h=a.ref);for(b in a)m.call(a,b)&&!p.hasOwnProperty(b)&&(d[b]=a[b]);if(c&&c.defaultProps)for(b in a=c.defaultProps,a)void 0===d[b]&&(d[b]=a[b]);return{$$typeof:k,type:c,key:e,ref:h,props:d,_owner:n.current}}exports.Fragment=l;exports.jsx=q;exports.jsxs=q;\n","/**\n * @license React\n * react.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n'use strict';var l=Symbol.for(\"react.element\"),n=Symbol.for(\"react.portal\"),p=Symbol.for(\"react.fragment\"),q=Symbol.for(\"react.strict_mode\"),r=Symbol.for(\"react.profiler\"),t=Symbol.for(\"react.provider\"),u=Symbol.for(\"react.context\"),v=Symbol.for(\"react.forward_ref\"),w=Symbol.for(\"react.suspense\"),x=Symbol.for(\"react.memo\"),y=Symbol.for(\"react.lazy\"),z=Symbol.iterator;function A(a){if(null===a||\"object\"!==typeof a)return null;a=z&&a[z]||a[\"@@iterator\"];return\"function\"===typeof a?a:null}\nvar B={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C=Object.assign,D={};function E(a,b,e){this.props=a;this.context=b;this.refs=D;this.updater=e||B}E.prototype.isReactComponent={};\nE.prototype.setState=function(a,b){if(\"object\"!==typeof a&&\"function\"!==typeof a&&null!=a)throw Error(\"setState(...): takes an object of state variables to update or a function which returns an object of state variables.\");this.updater.enqueueSetState(this,a,b,\"setState\")};E.prototype.forceUpdate=function(a){this.updater.enqueueForceUpdate(this,a,\"forceUpdate\")};function F(){}F.prototype=E.prototype;function G(a,b,e){this.props=a;this.context=b;this.refs=D;this.updater=e||B}var H=G.prototype=new F;\nH.constructor=G;C(H,E.prototype);H.isPureReactComponent=!0;var I=Array.isArray,J=Object.prototype.hasOwnProperty,K={current:null},L={key:!0,ref:!0,__self:!0,__source:!0};\nfunction M(a,b,e){var d,c={},k=null,h=null;if(null!=b)for(d in void 0!==b.ref&&(h=b.ref),void 0!==b.key&&(k=\"\"+b.key),b)J.call(b,d)&&!L.hasOwnProperty(d)&&(c[d]=b[d]);var g=arguments.length-2;if(1===g)c.children=e;else if(1<g){for(var f=Array(g),m=0;m<g;m++)f[m]=arguments[m+2];c.children=f}if(a&&a.defaultProps)for(d in g=a.defaultProps,g)void 0===c[d]&&(c[d]=g[d]);return{$$typeof:l,type:a,key:k,ref:h,props:c,_owner:K.current}}\nfunction N(a,b){return{$$typeof:l,type:a.type,key:b,ref:a.ref,props:a.props,_owner:a._owner}}function O(a){return\"object\"===typeof a&&null!==a&&a.$$typeof===l}function escape(a){var b={\"=\":\"=0\",\":\":\"=2\"};return\"$\"+a.replace(/[=:]/g,function(a){return b[a]})}var P=/\\/+/g;function Q(a,b){return\"object\"===typeof a&&null!==a&&null!=a.key?escape(\"\"+a.key):b.toString(36)}\nfunction R(a,b,e,d,c){var k=typeof a;if(\"undefined\"===k||\"boolean\"===k)a=null;var h=!1;if(null===a)h=!0;else switch(k){case \"string\":case \"number\":h=!0;break;case \"object\":switch(a.$$typeof){case l:case n:h=!0}}if(h)return h=a,c=c(h),a=\"\"===d?\".\"+Q(h,0):d,I(c)?(e=\"\",null!=a&&(e=a.replace(P,\"$&/\")+\"/\"),R(c,b,e,\"\",function(a){return a})):null!=c&&(O(c)&&(c=N(c,e+(!c.key||h&&h.key===c.key?\"\":(\"\"+c.key).replace(P,\"$&/\")+\"/\")+a)),b.push(c)),1;h=0;d=\"\"===d?\".\":d+\":\";if(I(a))for(var g=0;g<a.length;g++){k=\na[g];var f=d+Q(k,g);h+=R(k,b,e,f,c)}else if(f=A(a),\"function\"===typeof f)for(a=f.call(a),g=0;!(k=a.next()).done;)k=k.value,f=d+Q(k,g++),h+=R(k,b,e,f,c);else if(\"object\"===k)throw b=String(a),Error(\"Objects are not valid as a React child (found: \"+(\"[object Object]\"===b?\"object with keys {\"+Object.keys(a).join(\", \")+\"}\":b)+\"). If you meant to render a collection of children, use an array instead.\");return h}\nfunction S(a,b,e){if(null==a)return a;var d=[],c=0;R(a,d,\"\",\"\",function(a){return b.call(e,a,c++)});return d}function T(a){if(-1===a._status){var b=a._result;b=b();b.then(function(b){if(0===a._status||-1===a._status)a._status=1,a._result=b},function(b){if(0===a._status||-1===a._status)a._status=2,a._result=b});-1===a._status&&(a._status=0,a._result=b)}if(1===a._status)return a._result.default;throw a._result;}\nvar U={current:null},V={transition:null},W={ReactCurrentDispatcher:U,ReactCurrentBatchConfig:V,ReactCurrentOwner:K};exports.Children={map:S,forEach:function(a,b,e){S(a,function(){b.apply(this,arguments)},e)},count:function(a){var b=0;S(a,function(){b++});return b},toArray:function(a){return S(a,function(a){return a})||[]},only:function(a){if(!O(a))throw Error(\"React.Children.only expected to receive a single React element child.\");return a}};exports.Component=E;exports.Fragment=p;\nexports.Profiler=r;exports.PureComponent=G;exports.StrictMode=q;exports.Suspense=w;exports.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W;\nexports.cloneElement=function(a,b,e){if(null===a||void 0===a)throw Error(\"React.cloneElement(...): The argument must be a React element, but you passed \"+a+\".\");var d=C({},a.props),c=a.key,k=a.ref,h=a._owner;if(null!=b){void 0!==b.ref&&(k=b.ref,h=K.current);void 0!==b.key&&(c=\"\"+b.key);if(a.type&&a.type.defaultProps)var g=a.type.defaultProps;for(f in b)J.call(b,f)&&!L.hasOwnProperty(f)&&(d[f]=void 0===b[f]&&void 0!==g?g[f]:b[f])}var f=arguments.length-2;if(1===f)d.children=e;else if(1<f){g=Array(f);\nfor(var m=0;m<f;m++)g[m]=arguments[m+2];d.children=g}return{$$typeof:l,type:a.type,key:c,ref:k,props:d,_owner:h}};exports.createContext=function(a){a={$$typeof:u,_currentValue:a,_currentValue2:a,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null};a.Provider={$$typeof:t,_context:a};return a.Consumer=a};exports.createElement=M;exports.createFactory=function(a){var b=M.bind(null,a);b.type=a;return b};exports.createRef=function(){return{current:null}};\nexports.forwardRef=function(a){return{$$typeof:v,render:a}};exports.isValidElement=O;exports.lazy=function(a){return{$$typeof:y,_payload:{_status:-1,_result:a},_init:T}};exports.memo=function(a,b){return{$$typeof:x,type:a,compare:void 0===b?null:b}};exports.startTransition=function(a){var b=V.transition;V.transition={};try{a()}finally{V.transition=b}};exports.unstable_act=function(){throw Error(\"act(...) is not supported in production builds of React.\");};\nexports.useCallback=function(a,b){return U.current.useCallback(a,b)};exports.useContext=function(a){return U.current.useContext(a)};exports.useDebugValue=function(){};exports.useDeferredValue=function(a){return U.current.useDeferredValue(a)};exports.useEffect=function(a,b){return U.current.useEffect(a,b)};exports.useId=function(){return U.current.useId()};exports.useImperativeHandle=function(a,b,e){return U.current.useImperativeHandle(a,b,e)};\nexports.useInsertionEffect=function(a,b){return U.current.useInsertionEffect(a,b)};exports.useLayoutEffect=function(a,b){return U.current.useLayoutEffect(a,b)};exports.useMemo=function(a,b){return U.current.useMemo(a,b)};exports.useReducer=function(a,b,e){return U.current.useReducer(a,b,e)};exports.useRef=function(a){return U.current.useRef(a)};exports.useState=function(a){return U.current.useState(a)};exports.useSyncExternalStore=function(a,b,e){return U.current.useSyncExternalStore(a,b,e)};\nexports.useTransition=function(){return U.current.useTransition()};exports.version=\"18.2.0\";\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/react.production.min.js');\n} else {\n  module.exports = require('./cjs/react.development.js');\n}\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/react-jsx-runtime.production.min.js');\n} else {\n  module.exports = require('./cjs/react-jsx-runtime.development.js');\n}\n","/**\n * @license React\n * scheduler.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n'use strict';function f(a,b){var c=a.length;a.push(b);a:for(;0<c;){var d=c-1>>>1,e=a[d];if(0<g(e,b))a[d]=b,a[c]=e,c=d;else break a}}function h(a){return 0===a.length?null:a[0]}function k(a){if(0===a.length)return null;var b=a[0],c=a.pop();if(c!==b){a[0]=c;a:for(var d=0,e=a.length,w=e>>>1;d<w;){var m=2*(d+1)-1,C=a[m],n=m+1,x=a[n];if(0>g(C,c))n<e&&0>g(x,C)?(a[d]=x,a[n]=c,d=n):(a[d]=C,a[m]=c,d=m);else if(n<e&&0>g(x,c))a[d]=x,a[n]=c,d=n;else break a}}return b}\nfunction g(a,b){var c=a.sortIndex-b.sortIndex;return 0!==c?c:a.id-b.id}if(\"object\"===typeof performance&&\"function\"===typeof performance.now){var l=performance;exports.unstable_now=function(){return l.now()}}else{var p=Date,q=p.now();exports.unstable_now=function(){return p.now()-q}}var r=[],t=[],u=1,v=null,y=3,z=!1,A=!1,B=!1,D=\"function\"===typeof setTimeout?setTimeout:null,E=\"function\"===typeof clearTimeout?clearTimeout:null,F=\"undefined\"!==typeof setImmediate?setImmediate:null;\n\"undefined\"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function G(a){for(var b=h(t);null!==b;){if(null===b.callback)k(t);else if(b.startTime<=a)k(t),b.sortIndex=b.expirationTime,f(r,b);else break;b=h(t)}}function H(a){B=!1;G(a);if(!A)if(null!==h(r))A=!0,I(J);else{var b=h(t);null!==b&&K(H,b.startTime-a)}}\nfunction J(a,b){A=!1;B&&(B=!1,E(L),L=-1);z=!0;var c=y;try{G(b);for(v=h(r);null!==v&&(!(v.expirationTime>b)||a&&!M());){var d=v.callback;if(\"function\"===typeof d){v.callback=null;y=v.priorityLevel;var e=d(v.expirationTime<=b);b=exports.unstable_now();\"function\"===typeof e?v.callback=e:v===h(r)&&k(r);G(b)}else k(r);v=h(r)}if(null!==v)var w=!0;else{var m=h(t);null!==m&&K(H,m.startTime-b);w=!1}return w}finally{v=null,y=c,z=!1}}var N=!1,O=null,L=-1,P=5,Q=-1;\nfunction M(){return exports.unstable_now()-Q<P?!1:!0}function R(){if(null!==O){var a=exports.unstable_now();Q=a;var b=!0;try{b=O(!0,a)}finally{b?S():(N=!1,O=null)}}else N=!1}var S;if(\"function\"===typeof F)S=function(){F(R)};else if(\"undefined\"!==typeof MessageChannel){var T=new MessageChannel,U=T.port2;T.port1.onmessage=R;S=function(){U.postMessage(null)}}else S=function(){D(R,0)};function I(a){O=a;N||(N=!0,S())}function K(a,b){L=D(function(){a(exports.unstable_now())},b)}\nexports.unstable_IdlePriority=5;exports.unstable_ImmediatePriority=1;exports.unstable_LowPriority=4;exports.unstable_NormalPriority=3;exports.unstable_Profiling=null;exports.unstable_UserBlockingPriority=2;exports.unstable_cancelCallback=function(a){a.callback=null};exports.unstable_continueExecution=function(){A||z||(A=!0,I(J))};\nexports.unstable_forceFrameRate=function(a){0>a||125<a?console.error(\"forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported\"):P=0<a?Math.floor(1E3/a):5};exports.unstable_getCurrentPriorityLevel=function(){return y};exports.unstable_getFirstCallbackNode=function(){return h(r)};exports.unstable_next=function(a){switch(y){case 1:case 2:case 3:var b=3;break;default:b=y}var c=y;y=b;try{return a()}finally{y=c}};exports.unstable_pauseExecution=function(){};\nexports.unstable_requestPaint=function(){};exports.unstable_runWithPriority=function(a,b){switch(a){case 1:case 2:case 3:case 4:case 5:break;default:a=3}var c=y;y=a;try{return b()}finally{y=c}};\nexports.unstable_scheduleCallback=function(a,b,c){var d=exports.unstable_now();\"object\"===typeof c&&null!==c?(c=c.delay,c=\"number\"===typeof c&&0<c?d+c:d):c=d;switch(a){case 1:var e=-1;break;case 2:e=250;break;case 5:e=1073741823;break;case 4:e=1E4;break;default:e=5E3}e=c+e;a={id:u++,callback:b,priorityLevel:a,startTime:c,expirationTime:e,sortIndex:-1};c>d?(a.sortIndex=c,f(t,a),null===h(r)&&a===h(t)&&(B?(E(L),L=-1):B=!0,K(H,c-d))):(a.sortIndex=e,f(r,a),A||z||(A=!0,I(J)));return a};\nexports.unstable_shouldYield=M;exports.unstable_wrapCallback=function(a){var b=y;return function(){var c=y;y=b;try{return a.apply(this,arguments)}finally{y=c}}};\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/scheduler.production.min.js');\n} else {\n  module.exports = require('./cjs/scheduler.development.js');\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\tloaded: false,\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","var getProto = Object.getPrototypeOf ? function(obj) { return Object.getPrototypeOf(obj); } : function(obj) { return obj.__proto__; };\nvar leafPrototypes;\n// create a fake namespace object\n// mode & 1: value is a module id, require it\n// mode & 2: merge all properties of value into the ns\n// mode & 4: return value when already ns object\n// mode & 16: return value when it's Promise-like\n// mode & 8|1: behave like require\n__webpack_require__.t = function(value, mode) {\n\tif(mode & 1) value = this(value);\n\tif(mode & 8) return value;\n\tif(typeof value === 'object' && value) {\n\t\tif((mode & 4) && value.__esModule) return value;\n\t\tif((mode & 16) && typeof value.then === 'function') return value;\n\t}\n\tvar ns = Object.create(null);\n\t__webpack_require__.r(ns);\n\tvar def = {};\n\tleafPrototypes = leafPrototypes || [null, getProto({}), getProto([]), getProto(getProto)];\n\tfor(var current = mode & 2 && value; typeof current == 'object' && !~leafPrototypes.indexOf(current); current = getProto(current)) {\n\t\tObject.getOwnPropertyNames(current).forEach(function(key) { def[key] = function() { return value[key]; }; });\n\t}\n\tdef['default'] = function() { return value; };\n\t__webpack_require__.d(ns, def);\n\treturn ns;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.nmd = function(module) {\n\tmodule.paths = [];\n\tif (!module.children) module.children = [];\n\treturn module;\n};","__webpack_require__.nc = undefined;","export default function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}","export default function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, _typeof(obj);\n}","import _typeof from \"./typeof.js\";\nimport toPrimitive from \"./toPrimitive.js\";\nexport default function _toPropertyKey(arg) {\n  var key = toPrimitive(arg, \"string\");\n  return _typeof(key) === \"symbol\" ? key : String(key);\n}","import _typeof from \"./typeof.js\";\nexport default function _toPrimitive(input, hint) {\n  if (_typeof(input) !== \"object\" || input === null) return input;\n  var prim = input[Symbol.toPrimitive];\n  if (prim !== undefined) {\n    var res = prim.call(input, hint || \"default\");\n    if (_typeof(res) !== \"object\") return res;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (hint === \"string\" ? String : Number)(input);\n}","import toPropertyKey from \"./toPropertyKey.js\";\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, toPropertyKey(descriptor.key), descriptor);\n  }\n}\nexport default function _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  Object.defineProperty(subClass, \"prototype\", {\n    writable: false\n  });\n  if (superClass) setPrototypeOf(subClass, superClass);\n}","export default function _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}","export default function _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}","export default function _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n  return self;\n}","import getPrototypeOf from \"./getPrototypeOf.js\";\nimport isNativeReflectConstruct from \"./isNativeReflectConstruct.js\";\nimport possibleConstructorReturn from \"./possibleConstructorReturn.js\";\nexport default function _createSuper(Derived) {\n  var hasNativeReflectConstruct = isNativeReflectConstruct();\n  return function _createSuperInternal() {\n    var Super = getPrototypeOf(Derived),\n      result;\n    if (hasNativeReflectConstruct) {\n      var NewTarget = getPrototypeOf(this).constructor;\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n    return possibleConstructorReturn(this, result);\n  };\n}","import _typeof from \"./typeof.js\";\nimport assertThisInitialized from \"./assertThisInitialized.js\";\nexport default function _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  } else if (call !== void 0) {\n    throw new TypeError(\"Derived constructors may only return object or undefined\");\n  }\n  return assertThisInitialized(self);\n}","export default function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n  return arr2;\n}","import arrayLikeToArray from \"./arrayLikeToArray.js\";\nexport default function _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}","import unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nexport default function _createForOfIteratorHelper(o, allowArrayLike) {\n  var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"];\n  if (!it) {\n    if (Array.isArray(o) || (it = unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") {\n      if (it) o = it;\n      var i = 0;\n      var F = function F() {};\n      return {\n        s: F,\n        n: function n() {\n          if (i >= o.length) return {\n            done: true\n          };\n          return {\n            done: false,\n            value: o[i++]\n          };\n        },\n        e: function e(_e) {\n          throw _e;\n        },\n        f: F\n      };\n    }\n    throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n  }\n  var normalCompletion = true,\n    didErr = false,\n    err;\n  return {\n    s: function s() {\n      it = it.call(o);\n    },\n    n: function n() {\n      var step = it.next();\n      normalCompletion = step.done;\n      return step;\n    },\n    e: function e(_e2) {\n      didErr = true;\n      err = _e2;\n    },\n    f: function f() {\n      try {\n        if (!normalCompletion && it[\"return\"] != null) it[\"return\"]();\n      } finally {\n        if (didErr) throw err;\n      }\n    }\n  };\n}","import toPropertyKey from \"./toPropertyKey.js\";\nexport default function _defineProperty(obj, key, value) {\n  key = toPropertyKey(key);\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}","import defineProperty from \"./defineProperty.js\";\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    enumerableOnly && (symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    })), keys.push.apply(keys, symbols);\n  }\n  return keys;\n}\nexport default function _objectSpread2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = null != arguments[i] ? arguments[i] : {};\n    i % 2 ? ownKeys(Object(source), !0).forEach(function (key) {\n      defineProperty(target, key, source[key]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) {\n      Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n    });\n  }\n  return target;\n}","/**\n * Rotate the contents of an array.\n *\n * @public\n */\nexport function rotateArray<T>(arr: T[], offset: number): T[] {\n\treturn arr.map((_, i) => arr[(i + offset) % arr.length])\n}\n\n/**\n * Deduplicate the items in an array\n *\n * @public\n */\nexport function dedupe<T>(input: T[], equals?: (a: any, b: any) => boolean): T[] {\n\tconst result: T[] = []\n\tmainLoop: for (const item of input) {\n\t\tfor (const existing of result) {\n\t\t\tif (equals ? equals(item, existing) : item === existing) {\n\t\t\t\tcontinue mainLoop\n\t\t\t}\n\t\t}\n\t\tresult.push(item)\n\t}\n\treturn result\n}\n\n/** @internal */\nexport function compact<T>(arr: T[]): NonNullable<T>[] {\n\treturn arr.filter((i) => i !== undefined && i !== null) as any\n}\n\n/** @internal */\nexport function last<T>(arr: readonly T[]): T | undefined {\n\treturn arr[arr.length - 1]\n}\n\n/** @internal */\nexport function minBy<T>(arr: readonly T[], fn: (item: T) => number): T | undefined {\n\tlet min: T | undefined\n\tlet minVal = Infinity\n\tfor (const item of arr) {\n\t\tconst val = fn(item)\n\t\tif (val < minVal) {\n\t\t\tmin = item\n\t\t\tminVal = val\n\t\t}\n\t}\n\treturn min\n}\n\n/**\n * Partitions an array into two arrays, one with items that satisfy the predicate, and one with items that do not.\n *\n * @param arr - The array to partition\n * @param predicate - The predicate to use to partition the array\n * @returns A tuple of two arrays, the first one with items that satisfy the predicate and the second one with the ones that dont\n *\n * @internal */\nexport function partition<T>(arr: T[], predicate: (item: T) => boolean): [T[], T[]] {\n\tconst satisfies: T[] = []\n\tconst doesNotSatisfy: T[] = []\n\tfor (const item of arr) {\n\t\tif (predicate(item)) {\n\t\t\tsatisfies.push(item)\n\t\t} else {\n\t\t\tdoesNotSatisfy.push(item)\n\t\t}\n\t}\n\treturn [satisfies, doesNotSatisfy]\n}\n","/**\n * Throttle a function.\n *\n * @example\n * ```ts\n * const A = throttle(myFunction, 1000)\n * ```\n *\n * @public\n * @see source - https://github.com/bameyrick/throttle-typescript\n */\nexport function throttle<T extends (...args: any) => any>(\n\tfunc: T,\n\tlimit: number\n): (...args: Parameters<T>) => ReturnType<T> {\n\tlet inThrottle: boolean\n\tlet lastResult: ReturnType<T>\n\treturn function (this: any, ...args: any[]): ReturnType<T> {\n\t\tif (!inThrottle) {\n\t\t\tinThrottle = true\n\t\t\tsetTimeout(() => (inThrottle = false), limit)\n\t\t\tlastResult = func(...args)\n\t\t}\n\t\treturn lastResult\n\t}\n}\n\n/**\n * When a function is wrapped in `omitFromStackTrace`, if it throws an error the\n * stack trace won't include the function itself or any stack frames above it.\n * Useful for assertion-style function where the error will ideally originate\n * from the call-site rather than within the implementation of the assert fn.\n *\n * Only works in platforms that support `Error.captureStackTrace` (ie v8).\n *\n * @internal\n */\nexport function omitFromStackTrace<Args extends Array<unknown>, Return>(\n\tfn: (...args: Args) => Return\n): (...args: Args) => Return {\n\tconst wrappedFn = (...args: Args) => {\n\t\ttry {\n\t\t\treturn fn(...args)\n\t\t} catch (error) {\n\t\t\tif (error instanceof Error && Error.captureStackTrace) {\n\t\t\t\tError.captureStackTrace(error, wrappedFn)\n\t\t\t}\n\t\t\tthrow error\n\t\t}\n\t}\n\n\treturn wrappedFn\n}\n","import { omitFromStackTrace } from './function'\n\n/** @public */\nexport type OkResult<T> = { readonly ok: true; readonly value: T }\n/** @public */\nexport type ErrorResult<E> = { readonly ok: false; readonly error: E }\n/** @public */\nexport type Result<T, E> = OkResult<T> | ErrorResult<E>\n\n/** @public */\nexport const Result = {\n\tok<T>(value: T): OkResult<T> {\n\t\treturn { ok: true, value }\n\t},\n\terr<E>(error: E): ErrorResult<E> {\n\t\treturn { ok: false, error }\n\t},\n}\n\n/** @internal */\nexport function exhaustiveSwitchError(value: never, property?: string): never {\n\tconst debugValue =\n\t\tproperty && value && typeof value === 'object' && property in value ? value[property] : value\n\tthrow new Error(`Unknown switch case ${debugValue}`)\n}\n\n/** @internal */\nexport const assert: (value: unknown, message?: string) => asserts value = omitFromStackTrace(\n\t(value, message) => {\n\t\tif (!value) {\n\t\t\tthrow new Error(message || 'Assertion Error')\n\t\t}\n\t}\n)\n\n/** @internal */\nexport const assertExists = omitFromStackTrace(<T>(value: T, message?: string): NonNullable<T> => {\n\t// note that value == null is equivilent to value === null || value === undefined\n\tif (value == null) {\n\t\tthrow new Error(message ?? 'value must be defined')\n\t}\n\treturn value as NonNullable<T>\n})\n\n/** @internal */\nexport function promiseWithResolve<T>(): Promise<T> & {\n\tresolve: (value: T) => void\n\treject: (reason?: any) => void\n} {\n\tlet resolve: (value: T) => void\n\tlet reject: (reason?: any) => void\n\tconst promise = new Promise<T>((res, rej) => {\n\t\tresolve = res\n\t\treject = rej\n\t})\n\treturn Object.assign(promise, {\n\t\tresolve: resolve!,\n\t\treject: reject!,\n\t})\n}\n","export default function _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}","import arrayWithoutHoles from \"./arrayWithoutHoles.js\";\nimport iterableToArray from \"./iterableToArray.js\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nimport nonIterableSpread from \"./nonIterableSpread.js\";\nexport default function _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableSpread();\n}","import arrayLikeToArray from \"./arrayLikeToArray.js\";\nexport default function _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return arrayLikeToArray(arr);\n}","export default function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}","/**\n * Debounce a function.\n *\n * @example\n * ```ts\n * const A = debounce(myFunction, 1000)\n * ```\n *\n *\n * @public\n * @see source - https://gist.github.com/ca0v/73a31f57b397606c9813472f7493a940\n */\nexport function debounce<T extends unknown[], U>(\n\tcallback: (...args: T) => PromiseLike<U> | U,\n\twait: number\n) {\n\tlet state:\n\t\t| undefined\n\t\t| {\n\t\t\t\ttimeout: ReturnType<typeof setTimeout>\n\t\t\t\tpromise: Promise<U>\n\t\t\t\tresolve: (value: U | PromiseLike<U>) => void\n\t\t\t\treject: (value: any) => void\n\t\t\t\tlatestArgs: T\n\t\t  } = undefined\n\n\tconst fn = (...args: T): Promise<U> => {\n\t\tif (!state) {\n\t\t\tstate = {} as any\n\t\t\tstate!.promise = new Promise((resolve, reject) => {\n\t\t\t\tstate!.resolve = resolve\n\t\t\t\tstate!.reject = reject\n\t\t\t})\n\t\t}\n\t\tclearTimeout(state!.timeout)\n\t\tstate!.latestArgs = args\n\t\tstate!.timeout = setTimeout(() => {\n\t\t\tconst s = state!\n\t\t\tstate = undefined\n\t\t\ttry {\n\t\t\t\ts.resolve(callback(...s.latestArgs))\n\t\t\t} catch (e) {\n\t\t\t\ts.reject(e)\n\t\t\t}\n\t\t}, wait)\n\n\t\treturn state!.promise\n\t}\n\tfn.cancel = () => {\n\t\tif (!state) return\n\t\tclearTimeout(state.timeout)\n\t}\n\treturn fn\n}\n","type ErrorAnnotations = {\n\ttags: Record<string, number | string | boolean | bigint | symbol | null | undefined>\n\textras: Record<string, unknown>\n}\n\nconst annotationsByError = new WeakMap<object, ErrorAnnotations>()\n\n/**\n * Annotate an error with tags and additional data. Annotations won't overwrite\n * existing ones. Retrieve them with `getErrorAnnotations`.\n * @internal\n */\nexport function annotateError(error: unknown, annotations: Partial<ErrorAnnotations>) {\n\tif (typeof error !== 'object' || error === null) return\n\n\tlet currentAnnotations = annotationsByError.get(error)\n\tif (!currentAnnotations) {\n\t\tcurrentAnnotations = { tags: {}, extras: {} }\n\t\tannotationsByError.set(error, currentAnnotations)\n\t}\n\n\tif (annotations.tags) {\n\t\tcurrentAnnotations.tags = {\n\t\t\t...currentAnnotations.tags,\n\t\t\t...annotations.tags,\n\t\t}\n\t}\n\tif (annotations.extras) {\n\t\tcurrentAnnotations.extras = {\n\t\t\t...currentAnnotations.extras,\n\t\t\t...annotations.extras,\n\t\t}\n\t}\n}\n\n/** @internal */\nexport function getErrorAnnotations(error: Error): ErrorAnnotations {\n\treturn annotationsByError.get(error) ?? { tags: {}, extras: {} }\n}\n","/**\n * Hash a string using the FNV-1a algorithm.\n * @public\n */\nexport function getHashForString(string: string) {\n\tlet hash = 0\n\tfor (let i = 0; i < string.length; i++) {\n\t\thash = (hash << 5) - hash + string.charCodeAt(i)\n\t\thash |= 0 // Convert to 32bit integer\n\t}\n\treturn hash + ''\n}\n\n/**\n * Hash a string using the FNV-1a algorithm.\n * @public\n */\nexport function getHashForObject(obj: any) {\n\treturn getHashForString(JSON.stringify(obj))\n}\n\n/** @public */\nexport function lns(str: string) {\n\tconst result = str.split('')\n\tresult.push(...result.splice(0, Math.round(result.length / 5)))\n\tresult.push(...result.splice(0, Math.round(result.length / 4)))\n\tresult.push(...result.splice(0, Math.round(result.length / 3)))\n\tresult.push(...result.splice(0, Math.round(result.length / 2)))\n\treturn result\n\t\t.reverse()\n\t\t.map((n) => (+n ? (+n < 5 ? 5 + +n : +n > 5 ? +n - 5 : n) : n))\n\t\t.join('')\n}\n","export default function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}","export default function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}","import arrayWithHoles from \"./arrayWithHoles.js\";\nimport iterableToArrayLimit from \"./iterableToArrayLimit.js\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nimport nonIterableRest from \"./nonIterableRest.js\";\nexport default function _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || unsupportedIterableToArray(arr, i) || nonIterableRest();\n}","export default function _iterableToArrayLimit(arr, i) {\n  var _i = null == arr ? null : \"undefined\" != typeof Symbol && arr[Symbol.iterator] || arr[\"@@iterator\"];\n  if (null != _i) {\n    var _s,\n      _e,\n      _x,\n      _r,\n      _arr = [],\n      _n = !0,\n      _d = !1;\n    try {\n      if (_x = (_i = _i.call(arr)).next, 0 === i) {\n        if (Object(_i) !== _i) return;\n        _n = !1;\n      } else for (; !(_n = (_s = _x.call(_i)).done) && (_arr.push(_s.value), _arr.length !== i); _n = !0);\n    } catch (err) {\n      _d = !0, _e = err;\n    } finally {\n      try {\n        if (!_n && null != _i[\"return\"] && (_r = _i[\"return\"](), Object(_r) !== _r)) return;\n      } finally {\n        if (_d) throw _e;\n      }\n    }\n    return _arr;\n  }\n}","/**\n * Linear interpolate between two values.\n *\n * @example\n * ```ts\n * const A = lerp(0, 1, 0.5)\n * ```\n *\n * @public\n */\nexport function lerp(a: number, b: number, t: number) {\n\treturn a + (b - a) * t\n}\n\n/**\n * Seeded random number generator, using [xorshift](https://en.wikipedia.org/wiki/Xorshift). The\n * result will always be betweeen -1 and 1.\n *\n * Adapted from [seedrandom](https://github.com/davidbau/seedrandom).\n * @public\n */\nexport function rng(seed = '') {\n\tlet x = 0\n\tlet y = 0\n\tlet z = 0\n\tlet w = 0\n\n\tfunction next() {\n\t\tconst t = x ^ (x << 11)\n\t\tx = y\n\t\ty = z\n\t\tz = w\n\t\tw ^= ((w >>> 19) ^ t ^ (t >>> 8)) >>> 0\n\t\treturn (w / 0x100000000) * 2\n\t}\n\n\tfor (let k = 0; k < seed.length + 64; k++) {\n\t\tx ^= seed.charCodeAt(k) | 0\n\t\tnext()\n\t}\n\n\treturn next\n}\n\n/**\n * Modulate a value between two ranges.\n *\n * @example\n * ```ts\n * const A = modulate(0, [0, 1], [0, 100])\n * ```\n *\n * @param value - The interpolation value.\n * @param rangeA - From [low, high]\n * @param rangeB - To [low, high]\n * @param clamp - Whether to clamp the the result to [low, high]\n * @public\n */\nexport function modulate(value: number, rangeA: number[], rangeB: number[], clamp = false): number {\n\tconst [fromLow, fromHigh] = rangeA\n\tconst [v0, v1] = rangeB\n\tconst result = v0 + ((value - fromLow) / (fromHigh - fromLow)) * (v1 - v0)\n\n\treturn clamp\n\t\t? v0 < v1\n\t\t\t? Math.max(Math.min(result, v1), v0)\n\t\t\t: Math.max(Math.min(result, v0), v1)\n\t\t: result\n}\n","/** @internal */\nexport function hasOwnProperty(obj: object, key: string): boolean {\n\treturn Object.prototype.hasOwnProperty.call(obj, key)\n}\n\n/** @internal */\nexport function getOwnProperty<K extends string, V>(\n\tobj: Partial<Record<K, V>>,\n\tkey: K\n): V | undefined\n/** @internal */\nexport function getOwnProperty(obj: object, key: string): unknown\n/** @internal */\nexport function getOwnProperty(obj: object, key: string): unknown {\n\tif (!hasOwnProperty(obj, key)) {\n\t\treturn undefined\n\t}\n\t// @ts-expect-error we know the property exists\n\treturn obj[key]\n}\n\n/**\n * Deep copy function for TypeScript.\n *\n * @example\n * ```ts\n * const A = deepCopy({ a: 1, b: { c: 2 } })\n * ```\n *\n * @param obj - Target value to be copied.\n * @public\n * @see Source - project, ts-deeply https://github.com/ykdr2017/ts-deepcopy\n * @see Code - pen https://codepen.io/erikvullings/pen/ejyBYg\n */\nexport function deepCopy<T = unknown>(obj: T): T {\n\tif (!obj) return obj\n\tif (Array.isArray(obj)) {\n\t\tconst arr: unknown[] = []\n\t\tconst length = obj.length\n\t\tfor (let i = 0; i < length; i++) arr.push(deepCopy(obj[i]))\n\t\treturn arr as unknown as T\n\t} else if (typeof obj === 'object') {\n\t\tconst keys = Object.keys(obj!)\n\t\tconst length = keys.length\n\t\tconst newObject: any = {}\n\t\tfor (let i = 0; i < length; i++) {\n\t\t\tconst key = keys[i]\n\t\t\tnewObject[key] = deepCopy((obj as any)[key])\n\t\t}\n\t\treturn newObject\n\t}\n\treturn obj\n}\n\n/**\n * An alias for `Object.keys` that treats the object as a map and so\n * preserves the type of the keys.\n * @internal\n */\nexport function objectMapKeys<Key extends string>(object: {\n\treadonly [K in Key]: unknown\n}): Array<Key> {\n\treturn Object.keys(object) as Key[]\n}\n\n/**\n * An alias for `Object.values` that treats the object as a map and so\n * preserves the type of the keys.\n * @internal\n */\nexport function objectMapValues<Key extends string, Value>(object: {\n\t[K in Key]: Value\n}): Array<Value> {\n\treturn Object.values(object) as Value[]\n}\n\n/**\n * An alias for `Object.entries` that treats the object as a map and so\n * preserves the type of the keys.\n * @internal\n */\nexport function objectMapEntries<Key extends string, Value>(object: {\n\t[K in Key]: Value\n}): Array<[Key, Value]> {\n\treturn Object.entries(object) as [Key, Value][]\n}\n","/**\n * Get whether a value is not undefined.\n *\n * @param value - The value to check.\n * @public\n */\nexport function isDefined<T>(value: T): value is typeof value extends undefined ? never : T {\n\treturn value !== undefined\n}\n\n/**\n * Get whether a value is null\n *\n * @param value - The value to check.\n * @public\n */\nexport function isNonNull<T>(value: T): value is typeof value extends null ? never : T {\n\treturn value !== null\n}\n\n/**\n * Get whether a value is nullish (null, undefined).\n *\n * @param value - The value to check.\n * @public\n */\nexport function isNonNullish<T>(\n\tvalue: T\n): value is typeof value extends undefined ? never : typeof value extends null ? never : T {\n\treturn value !== null && value !== undefined\n}\n\n/** @public */\nexport const structuredClone =\n\ttypeof window !== 'undefined' && (window as any).structuredClone\n\t\t? (window.structuredClone as <T>(i: T) => T)\n\t\t: <T>(i: T): T => (i ? JSON.parse(JSON.stringify(i)) : i)\n","import { CollectionDiff } from './Store'\n\n/**\n * A class that can be used to incrementally construct a set of records.\n * @internal\n */\nexport class IncrementalSetConstructor<T> {\n\t/**\n\t * The next value of the set.\n\t *\n\t * @internal\n\t */\n\tprivate nextValue?: Set<T>\n\n\t/**\n\t * The diff of the set.\n\t *\n\t * @internal\n\t */\n\tprivate diff?: CollectionDiff<T>\n\n\tconstructor(\n\t\t/**\n\t\t * The previous value of the set.\n\t\t *\n\t\t * @internal\n\t\t * @readonly\n\t\t */\n\t\tprivate readonly previousValue: Set<T>\n\t) {}\n\n\t/**\n\t * Get the next value of the set.\n\t *\n\t * @public\n\t */\n\tpublic get() {\n\t\tconst numRemoved = this.diff?.removed?.size ?? 0\n\t\tconst numAdded = this.diff?.added?.size ?? 0\n\t\tif (numRemoved === 0 && numAdded === 0) {\n\t\t\treturn undefined\n\t\t}\n\t\treturn { value: this.nextValue!, diff: this.diff! }\n\t}\n\n\t/**\n\t * Add an item to the set.\n\t *\n\t * @param item - The item to add.\n\t * @param wasAlreadyPresent - Whether the item was already present in the set.\n\t *\n\t * @internal\n\t */\n\tprivate _add(item: T, wasAlreadyPresent: boolean) {\n\t\tthis.nextValue ??= new Set(this.previousValue)\n\t\tthis.nextValue.add(item)\n\n\t\tthis.diff ??= {}\n\t\tif (wasAlreadyPresent) {\n\t\t\tthis.diff.removed?.delete(item)\n\t\t} else {\n\t\t\tthis.diff.added ??= new Set()\n\t\t\tthis.diff.added.add(item)\n\t\t}\n\t}\n\n\t/**\n\t * Add an item to the set.\n\t *\n\t * @param item - The item to add.\n\t *\n\t * @public\n\t */\n\tadd(item: T) {\n\t\tconst wasAlreadyPresent = this.previousValue.has(item)\n\t\tif (wasAlreadyPresent) {\n\t\t\tconst wasRemoved = this.diff?.removed?.has(item)\n\t\t\t// if it wasn't removed during the lifetime of this set constructor, there's no need to add it again\n\t\t\tif (!wasRemoved) return\n\t\t\treturn this._add(item, wasAlreadyPresent)\n\t\t}\n\t\tconst isCurrentlyPresent = this.nextValue?.has(item)\n\t\t// if it's already there, no need to add it again\n\t\tif (isCurrentlyPresent) return\n\t\t// otherwise add it\n\t\tthis._add(item, wasAlreadyPresent)\n\t}\n\n\t/**\n\t * Remove an item from the set.\n\t *\n\t * @param item - The item to remove.\n\t * @param wasAlreadyPresent - Whether the item was already present in the set.\n\t *\n\t * @internal\n\t */\n\tprivate _remove(item: T, wasAlreadyPresent: boolean) {\n\t\tthis.nextValue ??= new Set(this.previousValue)\n\t\tthis.nextValue.delete(item)\n\n\t\tthis.diff ??= {}\n\t\tif (wasAlreadyPresent) {\n\t\t\t// it was in the original set, so we need to add it to the removed diff\n\t\t\tthis.diff.removed ??= new Set()\n\t\t\tthis.diff.removed.add(item)\n\t\t} else {\n\t\t\t// if it was added during the lifetime of this set constructor, we need to remove it from the added diff\n\t\t\tthis.diff.added?.delete(item)\n\t\t}\n\t}\n\n\t/**\n\t * Remove an item from the set.\n\t *\n\t * @param item - The item to remove.\n\t *\n\t * @public\n\t */\n\tremove(item: T) {\n\t\tconst wasAlreadyPresent = this.previousValue.has(item)\n\t\tif (!wasAlreadyPresent) {\n\t\t\tconst wasAdded = this.diff?.added?.has(item)\n\t\t\t// if it wasn't added during the lifetime of this set constructor, there's no need to remove it\n\t\t\tif (!wasAdded) return\n\t\t\treturn this._remove(item, wasAlreadyPresent)\n\t\t}\n\t\tconst hasAlreadyBeenRemoved = this.diff?.removed?.has(item)\n\t\t// if it's already removed, no need to remove it again\n\t\tif (hasAlreadyBeenRemoved) return\n\t\t// otherwise remove it\n\t\tthis._remove(item, wasAlreadyPresent)\n\t}\n}\n","import { urlAlphabet } from './url-alphabet/index.js'\nlet random = bytes => crypto.getRandomValues(new Uint8Array(bytes))\nlet customRandom = (alphabet, defaultSize, getRandom) => {\n  let mask = (2 << (Math.log(alphabet.length - 1) / Math.LN2)) - 1\n  let step = -~((1.6 * mask * defaultSize) / alphabet.length)\n  return (size = defaultSize) => {\n    let id = ''\n    while (true) {\n      let bytes = getRandom(step)\n      let j = step\n      while (j--) {\n        id += alphabet[bytes[j] & mask] || ''\n        if (id.length === size) return id\n      }\n    }\n  }\n}\nlet customAlphabet = (alphabet, size = 21) =>\n  customRandom(alphabet, size, random)\nlet nanoid = (size = 21) =>\n  crypto.getRandomValues(new Uint8Array(size)).reduce((id, byte) => {\n    byte &= 63\n    if (byte < 36) {\n      id += byte.toString(36)\n    } else if (byte < 62) {\n      id += (byte - 26).toString(36).toUpperCase()\n    } else if (byte > 62) {\n      id += '-'\n    } else {\n      id += '_'\n    }\n    return id\n  }, '')\nexport { nanoid, customAlphabet, customRandom, urlAlphabet, random }\n","import { structuredClone } from '@tldraw/utils'\nimport { nanoid } from 'nanoid'\nimport { BaseRecord, ID, OmitMeta } from './BaseRecord'\nimport { StoreValidator } from './Store'\nimport { Migrations } from './migrate'\n\nexport type RecordTypeRecord<R extends RecordType<any, any>> = ReturnType<R['create']>\n\n/**\n * A record type is a type that can be stored in a record store. It is created with\n * `createRecordType`.\n *\n * @public\n */\nexport class RecordType<\n\tR extends BaseRecord,\n\tRequiredProperties extends keyof Omit<R, 'id' | 'typeName'>\n> {\n\treadonly createDefaultProperties: () => Exclude<OmitMeta<R>, RequiredProperties>\n\treadonly migrations: Migrations\n\treadonly validator: StoreValidator<R> | { validate: (r: unknown) => R }\n\n\tconstructor(\n\t\t/**\n\t\t * The unique type associated with this record.\n\t\t *\n\t\t * @public\n\t\t * @readonly\n\t\t */\n\t\tpublic readonly typeName: R['typeName'],\n\t\tconfig: {\n\t\t\treadonly createDefaultProperties: () => Exclude<OmitMeta<R>, RequiredProperties>\n\t\t\treadonly migrations: Migrations\n\t\t\treadonly validator?: StoreValidator<R> | { validate: (r: unknown) => R }\n\t\t}\n\t) {\n\t\tthis.createDefaultProperties = config.createDefaultProperties\n\t\tthis.migrations = config.migrations\n\t\tthis.validator = config.validator ?? { validate: (r: unknown) => r as R }\n\t}\n\n\t/**\n\t * Create a new record of this type.\n\t *\n\t * @param properties - The properties of the record.\n\t *\n\t * @returns The new record.\n\t */\n\tcreate(properties: Pick<R, RequiredProperties> & Omit<Partial<R>, RequiredProperties>): R {\n\t\tconst result = { ...this.createDefaultProperties(), id: this.createId() } as any\n\n\t\tfor (const [k, v] of Object.entries(properties)) {\n\t\t\tif (v !== undefined) {\n\t\t\t\tresult[k] = v\n\t\t\t}\n\t\t}\n\n\t\tresult.typeName = this.typeName\n\n\t\treturn result as R\n\t}\n\n\t/**\n\t * Clone a record of this type.\n\t *\n\t * @param record - The record to clone.\n\t * @public\n\t * @returns The cloned record.\n\t */\n\tclone(record: R): R {\n\t\treturn { ...structuredClone(record), id: this.createId() }\n\t}\n\n\t/**\n\t * Create a new ID for this record type.\n\t *\n\t * @example\n\t * ```ts\n\t * const id = recordType.createId()\n\t * ```\n\t *\n\t * @public\n\t * @returns The new ID.\n\t */\n\tcreateId(): ID<R> {\n\t\treturn (this.typeName + ':' + nanoid()) as ID<R>\n\t}\n\n\t/**\n\t * Create a new ID for this record type based on the given ID.\n\t *\n\t * @example\n\t * ```ts\n\t * const id = recordType.createCustomId(\"myId\")\n\t * ```\n\t *\n\t * @param id - The ID to base the new ID on.\n\t * @returns The new ID.\n\t */\n\tcreateCustomId(id: string): ID<R> {\n\t\treturn (this.typeName + ':' + id) as ID<R>\n\t}\n\n\t/**\n\t * Check whether a record is an instance of this record type.\n\t *\n\t * @example\n\t * ```ts\n\t * const result = recordType.isInstance(someRecord)\n\t * ```\n\t *\n\t * @param record - The record to check.\n\t * @returns Whether the record is an instance of this record type.\n\t */\n\tisInstance = (record?: BaseRecord): record is R => {\n\t\treturn record?.typeName === this.typeName\n\t}\n\n\t/**\n\t * Check whether an id is an id of this type.\n\t *\n\t * @example\n\t * ```ts\n\t * const result = recordType.isIn(\"someId\")\n\t * ```\n\t *\n\t * @param id - The id to check.\n\t * @returns Whether the id is an id of this type.\n\t */\n\tisId(id?: string): id is ID<R> {\n\t\tif (!id) return false\n\t\tfor (let i = 0; i < this.typeName.length; i++) {\n\t\t\tif (id[i] !== this.typeName[i]) return false\n\t\t}\n\n\t\treturn id[this.typeName.length] === ':'\n\t}\n\n\t/**\n\t * Create a new RecordType that has the same type name as this RecordType and includes the given default properties.\n\t *\n\t * @example\n\t * ```ts\n\t * const authorType = createRecordType('author', () => ({ living: true }))\n\t * const deadAuthorType = authorType.withDefaultProperties({ living: false })\n\t * ```\n\t *\n\t * @param fn - A function that returns the default properties of the new RecordType.\n\t *\n\t * @returns The new RecordType.\n\t */\n\twithDefaultProperties<DefaultProps extends Omit<Partial<R>, 'typeName' | 'id'>>(\n\t\tcreateDefaultProperties: () => DefaultProps\n\t): RecordType<R, Exclude<RequiredProperties, keyof DefaultProps>> {\n\t\treturn new RecordType<R, Exclude<RequiredProperties, keyof DefaultProps>>(this.typeName, {\n\t\t\tcreateDefaultProperties: createDefaultProperties as any,\n\t\t\tmigrations: this.migrations,\n\t\t\tvalidator: this.validator,\n\t\t})\n\t}\n\n\t/**\n\t * Check that the passed in record passes the validations for this type.\n\t * Returns its input correctly typed if it does, but throws an error\n\t * otherwise.\n\t */\n\tvalidate(record: unknown): R {\n\t\treturn this.validator.validate(record)\n\t}\n}\n\n/**\n * Create a record type.\n *\n * @example\n * ```ts\n *   const Book = createRecordType<Book>('book')\n * ```\n *\n * @param typeName - The name of the type to create.\n *\n * @public\n */\nexport function createRecordType<R extends BaseRecord>(\n\ttypeName: R['typeName'],\n\tconfig: {\n\t\tmigrations?: Migrations\n\t\t// todo: optional validations\n\t\tvalidator: StoreValidator<R>\n\t}\n): RecordType<R, keyof Omit<R, 'id' | 'typeName'>> {\n\treturn new RecordType<R, keyof Omit<R, 'id' | 'typeName'>>(typeName, {\n\t\tcreateDefaultProperties: () => ({} as any),\n\t\tmigrations: config.migrations ?? { currentVersion: 0, firstVersion: 0, migrators: {} },\n\t\tvalidator: config.validator,\n\t})\n}\n\n/**\n * Assert whether an id correspond to a record type.\n *\n * @example\n * ```ts\n *   assertIdType(myId, ID<MyRecord>)\n * ```\n *\n * @param id - The id to check.\n * @param type - The type of the record.\n *\n * @public\n */\nexport function assertIdType<R extends BaseRecord>(\n\tid: string | undefined,\n\ttype: RecordType<R, any>\n): asserts id is ID<R> {\n\tif (!id || !type.isId(id)) {\n\t\tthrow new Error(`string ${JSON.stringify(id)} is not a valid ${type.typeName} id`)\n\t}\n}\n","// The maximum size for an array in an ArraySet\nexport const ARRAY_SIZE_THRESHOLD = 8\n\n/**\n * An ArraySet operates as an array until it reaches a certain size, after which a Set is used\n * instead. In either case, the same methods are used to get, set, remove, and visit the items.\n * @internal\n */\nexport class ArraySet<T> {\n\tprivate arraySize = 0\n\n\tprivate array: (T | undefined)[] | null = Array(ARRAY_SIZE_THRESHOLD)\n\n\tprivate set: Set<T> | null = null\n\n\t/**\n\t * Get whether this ArraySet has any elements.\n\t *\n\t * @returns True if this ArraySet has any elements, false otherwise.\n\t */\n\tget isEmpty() {\n\t\tif (this.array) {\n\t\t\treturn this.arraySize === 0\n\t\t}\n\n\t\tif (this.set) {\n\t\t\treturn this.set.size === 0\n\t\t}\n\n\t\tthrow new Error('no set or array')\n\t}\n\n\t/**\n\t * Add an item to the ArraySet if it is not already present.\n\t *\n\t * @param elem - The element to add.\n\t */\n\n\tadd(elem: T) {\n\t\tif (this.array) {\n\t\t\tconst idx = this.array.indexOf(elem)\n\n\t\t\t// Return false if the element is already in the array.\n\t\t\tif (idx !== -1) {\n\t\t\t\treturn false\n\t\t\t}\n\n\t\t\tif (this.arraySize < ARRAY_SIZE_THRESHOLD) {\n\t\t\t\t// If the array is below the size threshold, push items into the array.\n\n\t\t\t\t// Insert the element into the array's next available slot.\n\t\t\t\tthis.array[this.arraySize] = elem\n\t\t\t\tthis.arraySize++\n\n\t\t\t\treturn true\n\t\t\t} else {\n\t\t\t\t// If the array is full, convert it to a set and remove the array.\n\t\t\t\tthis.set = new Set(this.array as any)\n\t\t\t\tthis.array = null\n\t\t\t\tthis.set.add(elem)\n\n\t\t\t\treturn true\n\t\t\t}\n\t\t}\n\n\t\tif (this.set) {\n\t\t\t// Return false if the element is already in the set.\n\t\t\tif (this.set.has(elem)) {\n\t\t\t\treturn false\n\t\t\t}\n\n\t\t\tthis.set.add(elem)\n\t\t\treturn true\n\t\t}\n\n\t\tthrow new Error('no set or array')\n\t}\n\n\t/**\n\t * Remove an item from the ArraySet if it is present.\n\t *\n\t * @param elem - The element to remove\n\t */\n\tremove(elem: T) {\n\t\tif (this.array) {\n\t\t\tconst idx = this.array.indexOf(elem)\n\n\t\t\t// If the item is not in the array, return false.\n\t\t\tif (idx === -1) {\n\t\t\t\treturn false\n\t\t\t}\n\n\t\t\tthis.array[idx] = undefined\n\t\t\tthis.arraySize--\n\n\t\t\tif (idx !== this.arraySize) {\n\t\t\t\t// If the item is not the last item in the array, move the last item into the\n\t\t\t\t// removed item's slot.\n\t\t\t\tthis.array[idx] = this.array[this.arraySize]\n\t\t\t\tthis.array[this.arraySize] = undefined\n\t\t\t}\n\n\t\t\treturn true\n\t\t}\n\n\t\tif (this.set) {\n\t\t\t// If the item is not in the set, return false.\n\t\t\tif (!this.set.has(elem)) {\n\t\t\t\treturn false\n\t\t\t}\n\n\t\t\tthis.set.delete(elem)\n\n\t\t\treturn true\n\t\t}\n\n\t\tthrow new Error('no set or array')\n\t}\n\n\t/**\n\t * Run a callback for each element in the ArraySet.\n\t *\n\t * @param visitor The callback to run for each element.\n\t */\n\tvisit(visitor: (item: T) => void) {\n\t\tif (this.array) {\n\t\t\tfor (let i = 0; i < this.arraySize; i++) {\n\t\t\t\tconst elem = this.array[i]\n\n\t\t\t\tif (typeof elem !== 'undefined') {\n\t\t\t\t\tvisitor(elem)\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn\n\t\t}\n\n\t\tif (this.set) {\n\t\t\tthis.set.forEach(visitor)\n\n\t\t\treturn\n\t\t}\n\n\t\tthrow new Error('no set or array')\n\t}\n}\n","import { Child, Signal } from './types.js'\n\n/**\n * Get whether the given value is a child.\n *\n * @param x The value to check.\n * @returns True if the value is a child, false otherwise.\n */\nfunction isChild(x: any): x is Child {\n\treturn x && typeof x === 'object' && 'parents' in x\n}\n\n/**\n * Get whether a child's parents have changed.\n *\n * @param child The child to check.\n * @returns True if the child's parents have changed, false otherwise.\n */\nexport function haveParentsChanged(child: Child) {\n\tfor (let i = 0, n = child.parents.length; i < n; i++) {\n\t\t// Get the parent's value without capturing it.\n\t\tchild.parents[i].__unsafe__getWithoutCapture()\n\n\t\t// If the parent's epoch does not match the child's view of the parent's epoch, then the parent has changed.\n\t\tif (child.parents[i].lastChangedEpoch !== child.parentEpochs[i]) {\n\t\t\treturn true\n\t\t}\n\t}\n\n\treturn false\n}\n\n/**\n * Detach a child from a parent.\n *\n * @param parent The parent to detach from.\n * @param child The child to detach.\n */\nexport const detach = (parent: Signal<any>, child: Child) => {\n\t// If the child is not attached to the parent, do nothing.\n\tif (!parent.children.remove(child)) {\n\t\treturn\n\t}\n\n\t// If the parent has no more children, then detach the parent from its parents.\n\tif (parent.children.isEmpty && isChild(parent)) {\n\t\tfor (let i = 0, n = parent.parents.length; i < n; i++) {\n\t\t\tdetach(parent.parents[i], parent)\n\t\t}\n\t}\n}\n\n/**\n * Attach a child to a parent.\n *\n * @param parent The parent to attach to.\n * @param child The child to attach.\n */\nexport const attach = (parent: Signal<any>, child: Child) => {\n\t// If the child is already attached to the parent, do nothing.\n\tif (!parent.children.add(child)) {\n\t\treturn\n\t}\n\n\t// If the parent itself is a child, add the parent to the parent's parents.\n\tif (isChild(parent)) {\n\t\tfor (let i = 0, n = parent.parents.length; i < n; i++) {\n\t\t\tattach(parent.parents[i], parent)\n\t\t}\n\t}\n}\n\n/**\n * Get whether two values are equal (insofar as signia is concerned).\n *\n * @param a The first value.\n * @param b The second value.\n */\nexport function equals(a: any, b: any): boolean {\n\tconst shallowEquals =\n\t\ta === b || Object.is(a, b) || Boolean(a && b && typeof a.equals === 'function' && a.equals(b))\n\treturn shallowEquals\n}\n\nexport declare function assertNever(x: never): never\n\n/** @public */\nexport const EMPTY_ARRAY: [] = Object.freeze([]) as any\n","import { attach, detach } from './helpers.js'\nimport { Child, Signal } from './types.js'\n\nconst signiaKey = Symbol.for('__signia__')\nconst global = globalThis as { [signiaKey]?: true }\n\nif (global[signiaKey]) {\n\tconsole.error(\n\t\t'Multiple versions of signia detected. This will cause unexpected behavior. Please add \"resolutions\" (yarn/pnpm) or \"overrides\" (npm) in your package.json to ensure only one version of signia is loaded.'\n\t)\n} else {\n\tglobal[signiaKey] = true\n}\n\nclass CaptureStackFrame {\n\toffset = 0\n\tnumNewParents = 0\n\n\tmaybeRemoved?: Signal<any>[]\n\n\tconstructor(public readonly below: CaptureStackFrame | null, public readonly child: Child) {}\n}\n\nlet stack: CaptureStackFrame | null = null\n\n/**\n * Executes the given function without capturing any parents in the current capture context.\n *\n * This is mainly useful if you want to run an effect only when certain signals change while also\n * dereferencing other signals which should not cause the effect to rerun on their own.\n *\n * @example\n * ```ts\n * const name = atom('name', 'Sam')\n * const time = atom('time', () => new Date().getTime())\n *\n * setInterval(() => {\n *   time.set(new Date().getTime())\n * })\n *\n * react('log name changes', () => {\n * \t console.log(name.value, 'was changed at', unsafe__withoutCapture(() => time.value))\n * })\n *\n * ```\n *\n * @public\n */\nexport function unsafe__withoutCapture<T>(fn: () => T): T {\n\tconst oldStack = stack\n\tstack = null\n\ttry {\n\t\treturn fn()\n\t} finally {\n\t\tstack = oldStack\n\t}\n}\n\nexport function startCapturingParents(child: Child) {\n\tstack = new CaptureStackFrame(stack, child)\n}\n\nexport function stopCapturingParents() {\n\tconst frame = stack!\n\tstack = frame.below\n\n\tconst didParentsChange = frame.numNewParents > 0 || frame.offset !== frame.child.parents.length\n\n\tif (!didParentsChange) {\n\t\treturn\n\t}\n\n\tfor (let i = frame.offset; i < frame.child.parents.length; i++) {\n\t\tconst p = frame.child.parents[i]\n\t\tconst parentWasRemoved = frame.child.parents.indexOf(p) >= frame.offset\n\t\tif (parentWasRemoved) {\n\t\t\tdetach(p, frame.child)\n\t\t}\n\t}\n\n\tframe.child.parents.length = frame.offset\n\tframe.child.parentEpochs.length = frame.offset\n\n\tif (stack?.maybeRemoved) {\n\t\tfor (let i = 0; i < stack.maybeRemoved.length; i++) {\n\t\t\tconst maybeRemovedParent = stack.maybeRemoved[i]\n\t\t\tif (frame.child.parents.indexOf(maybeRemovedParent) === -1) {\n\t\t\t\tdetach(maybeRemovedParent, frame.child)\n\t\t\t}\n\t\t}\n\t}\n}\n\n// this must be called after the parent is up to date\nexport function maybeCaptureParent(p: Signal<any, any>) {\n\tif (stack) {\n\t\tconst idx = stack.child.parents.indexOf(p)\n\t\t// if the child didn't deref this parent last time it executed, then idx will be -1\n\t\t// if the child did deref this parent last time but in a different order relative to other parents, then idx will be greater than stack.offset\n\t\t// if the child did deref this parent last time in the same order, then idx will be the same as stack.offset\n\t\t// if the child did deref this parent already during this capture session then 0 <= idx < stack.offset\n\n\t\tif (idx < 0) {\n\t\t\tstack.numNewParents++\n\t\t\tif (stack.child.isActivelyListening) {\n\t\t\t\tattach(p, stack.child)\n\t\t\t}\n\t\t}\n\n\t\tif (idx < 0 || idx >= stack.offset) {\n\t\t\tif (idx !== stack.offset && idx > 0) {\n\t\t\t\tconst maybeRemovedParent = stack.child.parents[stack.offset]\n\n\t\t\t\tif (!stack.maybeRemoved) {\n\t\t\t\t\tstack.maybeRemoved = [maybeRemovedParent]\n\t\t\t\t} else if (stack.maybeRemoved.indexOf(maybeRemovedParent) === -1) {\n\t\t\t\t\tstack.maybeRemoved.push(maybeRemovedParent)\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tstack.child.parents[stack.offset] = p\n\t\t\tstack.child.parentEpochs[stack.offset] = p.lastChangedEpoch\n\t\t\tstack.offset++\n\t\t}\n\t}\n}\n\n/**\n * A debugging tool that tells you why a computed signal or effect is running.\n * Call in the body of a computed signal or effect function.\n *\n * @example\n * ```ts\n * const name = atom('name', 'Bob')\n * react('greeting', () => {\n * \twhyAmIRunning()\n *\tconsole.log('Hello', name.value)\n * })\n *\n * name.set('Alice')\n *\n * // 'greeting' is running because:\n * //     'name' changed => 'Alice'\n * ```\n *\n * @public\n */\nexport function whyAmIRunning() {\n\tconst child = stack?.child\n\tif (!child) {\n\t\tthrow new Error('whyAmIRunning() called outside of a reactive context')\n\t}\n\n\tconst changedParents = []\n\tfor (let i = 0; i < child.parents.length; i++) {\n\t\tconst parent = child.parents[i]\n\n\t\tif (parent.lastChangedEpoch > child.parentEpochs[i]) {\n\t\t\tchangedParents.push(parent)\n\t\t}\n\t}\n\n\tif (changedParents.length === 0) {\n\t\t// eslint-disable-next-line no-console\n\t\tconsole.log((child as any).name, 'is running but none of the parents changed')\n\t} else {\n\t\t// eslint-disable-next-line no-console\n\t\tconsole.log((child as any).name, 'is running because:')\n\t\tfor (const changedParent of changedParents) {\n\t\t\t// eslint-disable-next-line no-console\n\t\t\tconsole.log(\n\t\t\t\t'\\t',\n\t\t\t\t(changedParent as any).name,\n\t\t\t\t'changed =>',\n\t\t\t\tchangedParent.__unsafe__getWithoutCapture()\n\t\t\t)\n\t\t}\n\t}\n}\n","import { ArraySet } from './ArraySet.js'\nimport { _Computed } from './Computed.js'\nimport { EffectScheduler } from './EffectScheduler.js'\n\n/** @public */\nexport const RESET_VALUE: unique symbol = Symbol('RESET_VALUE')\n\n/** @public */\nexport type RESET_VALUE = typeof RESET_VALUE\n\n/**\n * A Signal is a reactive value container. The value may change over time, and it may keep track of the diffs between sequential values.\n *\n * There are two types of signal:\n *\n * - Atomic signals, created using [[atom]]. These are mutable references to values that can be changed using [[Atom.set]].\n * - Computed signals, created using [[computed]]. These are values that are computed from other signals. They are recomputed lazily if their dependencies change.\n *\n * @public\n */\nexport interface Signal<Value, Diff = unknown> {\n\t/**\n\t * The name of the signal. This is used at runtime for debugging and perf profiling only. It does not need to be globally unique.\n\t */\n\tname: string\n\t/**\n\t * The current value of the signal. This is a reactive value, and will update when the signal changes.\n\t * Any computed signal that depends on this signal will be lazily recomputed if this signal changes.\n\t * Any effect that depends on this signal will be rescheduled if this signal changes.\n\t */\n\treadonly value: Value\n\t/**\n\t * The epoch when this signal's value last changed. Note tha this is not the same as when the value was last computed.\n\t * A signal may recopmute it's value without changing it.\n\t */\n\tlastChangedEpoch: number\n\t/**\n\t * Returns the sequence of diffs between the the value at the given epoch and the current value.\n\t * Returns the [[RESET_VALUE]] constant if there is not enough information to compute the diff sequence.\n\t * @param epoch\n\t */\n\tgetDiffSince(epoch: number): RESET_VALUE | Diff[]\n\t/**\n\t * Returns the current value of the signal without capturing it as a dependency.\n\t * Use this if you need to retrieve the signal's value in a hot loop where the performance overhead of dependency tracking is too high.\n\t */\n\t__unsafe__getWithoutCapture(): Value\n\t/** @internal */\n\tchildren: ArraySet<Child>\n}\n\n/** @internal */\nexport type Child = EffectScheduler<any> | _Computed<any>\n\n/**\n * Computes the diff between the previous and current value.\n *\n * If the diff cannot be computed for whatever reason, it should return [[RESET_VALUE]].\n *\n * @public\n */\nexport type ComputeDiff<Value, Diff> = (\n\tpreviousValue: Value,\n\tcurrentValue: Value,\n\tlastComputedEpoch: number,\n\tcurrentEpoch: number\n) => Diff | RESET_VALUE\n","import { RESET_VALUE } from './types.js'\n\ntype RangeTuple<Diff> = [fromEpoch: number, toEpoch: number, diff: Diff]\n\n/**\n * A structure that stores diffs between values of an atom.\n *\n * @internal\n */\nexport class HistoryBuffer<Diff> {\n\tprivate index = 0\n\n\t// use a wrap around buffer to store the last N values\n\tbuffer: Array<RangeTuple<Diff> | undefined>\n\n\tconstructor(private readonly capacity: number) {\n\t\tthis.buffer = new Array(capacity)\n\t}\n\n\t/**\n\t * Add a diff to the history buffer.\n\t *\n\t * @param lastComputedEpoch The epoch when the diff was computed.\n\t * @param currentEpoch The current epoch.\n\t * @param diff (optional) The diff to add, or else a reset value.\n\t */\n\tpushEntry(lastComputedEpoch: number, currentEpoch: number, diff: Diff | RESET_VALUE) {\n\t\tif (diff === undefined) {\n\t\t\treturn\n\t\t}\n\n\t\tif (diff === RESET_VALUE) {\n\t\t\tthis.clear()\n\t\t\treturn\n\t\t}\n\n\t\t// Add the diff to the buffer as a range tuple.\n\t\tthis.buffer[this.index] = [lastComputedEpoch, currentEpoch, diff]\n\n\t\t// Bump the index, wrapping around if necessary.\n\t\tthis.index = (this.index + 1) % this.capacity\n\t}\n\n\t/**\n\t * Clear the history buffer.\n\t */\n\tclear() {\n\t\tthis.index = 0\n\t\tthis.buffer.fill(undefined)\n\t}\n\n\t/**\n\t * Get the diffs since the given epoch.\n\t *\n\t * @param epoch The epoch to get diffs since.\n\t * @returns An array of diffs or a flag to reset the history buffer.\n\t */\n\tgetChangesSince(sinceEpoch: number): RESET_VALUE | Diff[] {\n\t\tconst { index, capacity, buffer } = this\n\n\t\t// For each item in the buffer...\n\t\tfor (let i = 0; i < capacity; i++) {\n\t\t\tconst offset = (index - 1 + capacity - i) % capacity\n\n\t\t\tconst elem = buffer[offset]\n\n\t\t\t// If there's no element in the offset position, return the reset value\n\t\t\tif (!elem) {\n\t\t\t\treturn RESET_VALUE\n\t\t\t}\n\n\t\t\tconst [fromEpoch, toEpoch] = elem\n\n\t\t\t// If the first element is already too early, bail\n\t\t\tif (i === 0 && sinceEpoch >= toEpoch) {\n\t\t\t\treturn []\n\t\t\t}\n\n\t\t\t// If the element is since the given epoch, return an array with all diffs from this element and all following elements\n\t\t\tif (fromEpoch <= sinceEpoch && sinceEpoch < toEpoch) {\n\t\t\t\tconst len = i + 1\n\t\t\t\tconst result = new Array(len)\n\n\t\t\t\tfor (let j = 0; j < len; j++) {\n\t\t\t\t\tresult[j] = buffer[(offset + j) % capacity]![2]\n\t\t\t\t}\n\n\t\t\t\treturn result\n\t\t\t}\n\t\t}\n\n\t\t// If we haven't returned yet, return the reset value\n\t\treturn RESET_VALUE\n\t}\n}\n","// Derivations start on GLOBAL_START_EPOCH so they are dirty before having been computed\nexport const GLOBAL_START_EPOCH = -1\n","import { _Atom } from './Atom.js'\nimport { GLOBAL_START_EPOCH } from './constants.js'\nimport { EffectScheduler } from './EffectScheduler.js'\nimport { Child, Signal } from './types.js'\n\n// The current epoch (global to all atoms).\nexport let globalEpoch = GLOBAL_START_EPOCH + 1\n\n// Whether any transaction is reacting.\nlet globalIsReacting = false\n\nexport function advanceGlobalEpoch() {\n\tglobalEpoch++\n}\n\nclass Transaction {\n\tconstructor(public readonly parent: Transaction | null) {}\n\tinitialAtomValues = new Map<_Atom<any>, any>()\n\n\t/**\n\t * Get whether this transaction is a root (no parents).\n\t *\n\t * @public\n\t */\n\tget isRoot() {\n\t\treturn this.parent === null\n\t}\n\n\t/**\n\t * Commit the transaction's changes.\n\t *\n\t * @public\n\t */\n\tcommit() {\n\t\tif (this.isRoot) {\n\t\t\t// For root transactions, flush changes to each of the atom's initial values.\n\t\t\tconst atoms = this.initialAtomValues\n\t\t\tthis.initialAtomValues = new Map()\n\t\t\tflushChanges(atoms.keys())\n\t\t} else {\n\t\t\t// For transaction's with parents, add the transaction's initial values to the parent's.\n\t\t\tthis.initialAtomValues.forEach((value, atom) => {\n\t\t\t\tif (!this.parent!.initialAtomValues.has(atom)) {\n\t\t\t\t\tthis.parent!.initialAtomValues.set(atom, value)\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\t}\n\n\t/**\n\t * Abort the transaction.\n\t *\n\t * @public\n\t */\n\tabort() {\n\t\tglobalEpoch++\n\n\t\t// Reset each of the transaction's atoms to its initial value.\n\t\tthis.initialAtomValues.forEach((value, atom) => {\n\t\t\tatom.set(value)\n\t\t\tatom.historyBuffer?.clear()\n\t\t})\n\n\t\t// Commit the changes.\n\t\tthis.commit()\n\t}\n}\n\n/**\n * Collect all of the reactors that need to run for an atom and run them.\n *\n * @param atom The atom to flush changes for.\n */\nfunction flushChanges(atoms: Iterable<_Atom<any>>) {\n\tif (globalIsReacting) {\n\t\tthrow new Error('cannot change atoms during reaction cycle')\n\t}\n\n\ttry {\n\t\tglobalIsReacting = true\n\n\t\t// Collect all of the visited reactors.\n\t\tconst reactors = new Set<EffectScheduler<unknown>>()\n\n\t\t// Visit each descendant of the atom, collecting reactors.\n\t\tconst traverse = (node: Child) => {\n\t\t\tif (node.lastTraversedEpoch === globalEpoch) {\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tnode.lastTraversedEpoch = globalEpoch\n\n\t\t\tif ('maybeScheduleEffect' in node) {\n\t\t\t\treactors.add(node)\n\t\t\t} else {\n\t\t\t\t;(node as any as Signal<any>).children.visit(traverse)\n\t\t\t}\n\t\t}\n\n\t\tfor (const atom of atoms) {\n\t\t\tatom.children.visit(traverse)\n\t\t}\n\n\t\t// Run each reactor.\n\t\tfor (const r of reactors) {\n\t\t\tr.maybeScheduleEffect()\n\t\t}\n\t} finally {\n\t\tglobalIsReacting = false\n\t}\n}\n\n/**\n * Handle a change to an atom.\n *\n * @param atom The atom that changed.\n * @param previousValue The atom's previous value.\n *\n * @internal\n */\nexport function atomDidChange(atom: _Atom<any>, previousValue: any) {\n\tif (!currentTransaction) {\n\t\tflushChanges([atom])\n\t} else if (!currentTransaction.initialAtomValues.has(atom)) {\n\t\tcurrentTransaction.initialAtomValues.set(atom, previousValue)\n\t}\n}\n\n/**\n * The current transaction, if there is one.\n *\n * @global\n * @public\n */\nexport let currentTransaction = null as Transaction | null\n\n/**\n * Batches state updates, deferring side effects until after the transaction completes.\n *\n * @example\n * ```ts\n * const firstName = atom('John')\n * const lastName = atom('Doe')\n *\n * react('greet', () => {\n *   console.log(`Hello, ${firstName.value} ${lastName.value}!`)\n * })\n *\n * // Logs \"Hello, John Doe!\"\n *\n * transaction(() => {\n *  firstName.set('Jane')\n *  lastName.set('Smith')\n * })\n *\n * // Logs \"Hello, Jane Smith!\"\n * ```\n *\n * If the function throws, the transaction is aborted and any signals that were updated during the transaction revert to their state before the transaction began.\n *\n * @example\n * ```ts\n * const firstName = atom('John')\n * const lastName = atom('Doe')\n *\n * react('greet', () => {\n *   console.log(`Hello, ${firstName.value} ${lastName.value}!`)\n * })\n *\n * // Logs \"Hello, John Doe!\"\n *\n * transaction(() => {\n *  firstName.set('Jane')\n *  throw new Error('oops')\n * })\n *\n * // Does not log\n * // firstName.value === 'John'\n * ```\n *\n * A `rollback` callback is passed into the function.\n * Calling this will prevent the transaction from committing and will revert any signals that were updated during the transaction to their state before the transaction began.\n *\n *  * @example\n * ```ts\n * const firstName = atom('John')\n * const lastName = atom('Doe')\n *\n * react('greet', () => {\n *   console.log(`Hello, ${firstName.value} ${lastName.value}!`)\n * })\n *\n * // Logs \"Hello, John Doe!\"\n *\n * transaction((rollback) => {\n *  firstName.set('Jane')\n *  lastName.set('Smith')\n *  rollback()\n * })\n *\n * // Does not log\n * // firstName.value === 'John'\n * // lastName.value === 'Doe'\n * ```\n *\n * @param fn The function to run in a transaction, called with a function to roll back the change.\n * @public\n */\nexport function transaction<T>(fn: (rollback: () => void) => T) {\n\tconst txn = new Transaction(currentTransaction)\n\n\t// Set the current transaction to the transaction\n\tcurrentTransaction = txn\n\n\ttry {\n\t\tlet rollback = false\n\n\t\t// Run the function.\n\t\tconst result = fn(() => (rollback = true))\n\n\t\tif (rollback) {\n\t\t\t// If the rollback was triggered, abort the transaction.\n\t\t\ttxn.abort()\n\t\t} else {\n\t\t\t// Otherwise, commit the transaction.\n\t\t\ttxn.commit()\n\t\t}\n\n\t\treturn result\n\t} catch (e) {\n\t\t// Abort the transaction if the function throws.\n\t\ttxn.abort()\n\t\tthrow e\n\t} finally {\n\t\t// Set the current transaction to the transaction's parent.\n\t\tcurrentTransaction = currentTransaction.parent\n\t}\n}\n\n/**\n * Like [transaction](#transaction), but does not create a new transaction if there is already one in progress.\n *\n * @param fn\n * @public\n */\nexport function transact<T>(fn: () => T): T {\n\tif (currentTransaction) {\n\t\treturn fn()\n\t}\n\treturn transaction(fn)\n}\n","import { ArraySet } from './ArraySet.js'\nimport { maybeCaptureParent } from './capture.js'\nimport { EMPTY_ARRAY, equals } from './helpers.js'\nimport { HistoryBuffer } from './HistoryBuffer.js'\nimport { advanceGlobalEpoch, atomDidChange, globalEpoch } from './transactions.js'\nimport { Child, ComputeDiff, RESET_VALUE, Signal } from './types.js'\n\n/**\n * The options to configure an atom, passed into the [[atom]] function.\n * @public\n */\nexport interface AtomOptions<Value, Diff> {\n\t/**\n\t * The maximum number of diffs to keep in the history buffer.\n\t *\n\t * If you don't need to compute diffs, or if you will supply diffs manually via [[Atom.set]], you can leave this as `undefined` and no history buffer will be created.\n\t *\n\t * If you expect the value to be part of an active effect subscription all the time, and to not change multiple times inside of a single transaction, you can set this to a relatively low number (e.g. 10).\n\t *\n\t * Otherwise, set this to a higher number based on your usage pattern and memory constraints.\n\t *\n\t */\n\thistoryLength?: number\n\t/**\n\t * A method used to compute a diff between the atom's old and new values. If provided, it will not be used unless you also specify [[AtomOptions.historyLength]].\n\t */\n\tcomputeDiff?: ComputeDiff<Value, Diff>\n\t/**\n\t * If provided, this will be used to compare the old and new values of the atom to determine if the value has changed.\n\t * By default, values are compared using first using strict equality (`===`), then `Object.is`, and finally any `.equals` method present in the object's prototype chain.\n\t * @param a\n\t * @param b\n\t * @returns\n\t */\n\tisEqual?: (a: any, b: any) => boolean\n}\n\n/**\n * An Atom is a signal that can be updated directly by calling [[Atom.set]] or [[Atom.update]].\n *\n * Atoms are created using the [[atom]] function.\n *\n * @example\n * ```ts\n * const name = atom('name', 'John')\n *\n * console.log(name.value) // 'John'\n * ```\n *\n * @public\n */\nexport interface Atom<Value, Diff = unknown> extends Signal<Value, Diff> {\n\t/**\n\t * Sets the value of this atom to the given value. If the value is the same as the current value, this is a no-op.\n\t *\n\t * @param value - The new value to set.\n\t * @param diff - The diff to use for the update. If not provided, the diff will be computed using [[AtomOptions.computeDiff]].\n\t */\n\tset(value: Value, diff?: Diff): Value\n\t/**\n\t * Updates the value of this atom using the given updater function. If the returned value is the same as the current value, this is a no-op.\n\t *\n\t * @param updater - A function that takes the current value and returns the new value.\n\t */\n\tupdate(updater: (value: Value) => Value): Value\n}\n\n/**\n * @internal\n */\nexport class _Atom<Value, Diff = unknown> implements Atom<Value, Diff> {\n\tconstructor(\n\t\tpublic readonly name: string,\n\t\tprivate current: Value,\n\t\toptions?: AtomOptions<Value, Diff>\n\t) {\n\t\tthis.isEqual = options?.isEqual ?? null\n\n\t\tif (!options) return\n\n\t\tif (options.historyLength) {\n\t\t\tthis.historyBuffer = new HistoryBuffer(options.historyLength)\n\t\t}\n\n\t\tthis.computeDiff = options.computeDiff\n\t}\n\n\treadonly isEqual: null | ((a: any, b: any) => boolean)\n\n\tcomputeDiff?: ComputeDiff<Value, Diff>\n\n\tlastChangedEpoch = globalEpoch\n\n\tchildren = new ArraySet<Child>()\n\n\thistoryBuffer?: HistoryBuffer<Diff>\n\n\t__unsafe__getWithoutCapture(): Value {\n\t\treturn this.current\n\t}\n\n\tget value() {\n\t\tmaybeCaptureParent(this)\n\t\treturn this.current\n\t}\n\n\tset(value: Value, diff?: Diff): Value {\n\t\t// If the value has not changed, do nothing.\n\t\tif (this.isEqual?.(this.current, value) ?? equals(this.current, value)) {\n\t\t\treturn this.current\n\t\t}\n\n\t\t// Tick forward the global epoch\n\t\tadvanceGlobalEpoch()\n\n\t\t// Add the diff to the history buffer.\n\t\tif (this.historyBuffer) {\n\t\t\tthis.historyBuffer.pushEntry(\n\t\t\t\tthis.lastChangedEpoch,\n\t\t\t\tglobalEpoch,\n\t\t\t\tdiff ??\n\t\t\t\t\tthis.computeDiff?.(this.current, value, this.lastChangedEpoch, globalEpoch) ??\n\t\t\t\t\tRESET_VALUE\n\t\t\t)\n\t\t}\n\n\t\t// Update the atom's record of the epoch when last changed.\n\t\tthis.lastChangedEpoch = globalEpoch\n\n\t\tconst oldValue = this.current\n\t\tthis.current = value\n\n\t\t// Notify all children that this atom has changed.\n\t\tatomDidChange(this, oldValue)\n\n\t\treturn value\n\t}\n\n\tupdate(updater: (value: Value) => Value): Value {\n\t\treturn this.set(updater(this.current))\n\t}\n\n\tgetDiffSince(epoch: number): RESET_VALUE | Diff[] {\n\t\tmaybeCaptureParent(this)\n\n\t\t// If no changes have occurred since the given epoch, return an empty array.\n\t\tif (epoch >= this.lastChangedEpoch) {\n\t\t\treturn EMPTY_ARRAY\n\t\t}\n\n\t\treturn this.historyBuffer?.getChangesSince(epoch) ?? RESET_VALUE\n\t}\n}\n\n/**\n * Creates a new [[Atom]].\n *\n * An Atom is a signal that can be updated directly by calling [[Atom.set]] or [[Atom.update]].\n *\n * @example\n * ```ts\n * const name = atom('name', 'John')\n *\n * name.value // 'John'\n *\n * name.set('Jane')\n *\n * name.value // 'Jane'\n * ```\n *\n * @public\n */\nexport function atom<Value, Diff = unknown>(\n\t/**\n\t * A name for the signal. This is used for debugging and profiling purposes, it does not need to be unique.\n\t */\n\tname: string,\n\t/**\n\t * The initial value of the signal.\n\t */\n\tinitialValue: Value,\n\t/**\n\t * The options to configure the atom. See [[AtomOptions]].\n\t */\n\toptions?: AtomOptions<Value, Diff>\n): Atom<Value, Diff> {\n\treturn new _Atom(name, initialValue, options)\n}\n\n/**\n * Returns true if the given value is an [[Atom]].\n * @public\n */\nexport function isAtom(value: unknown): value is Atom<unknown> {\n\treturn value instanceof _Atom\n}\n","/* eslint-disable prefer-rest-params */\nimport { Child, ComputeDiff, RESET_VALUE, Signal } from './types.js'\n\nimport { maybeCaptureParent, startCapturingParents, stopCapturingParents } from './capture.js'\n\nimport { ArraySet } from './ArraySet.js'\nimport { GLOBAL_START_EPOCH } from './constants.js'\nimport { EMPTY_ARRAY, equals, haveParentsChanged } from './helpers.js'\nimport { HistoryBuffer } from './HistoryBuffer.js'\nimport { globalEpoch } from './transactions.js'\n\nconst UNINITIALIZED = Symbol('UNINITIALIZED')\n/**\n * The type of the first value passed to a computed signal function as the 'prevValue' parameter.\n *\n * @see [[isUninitialized]].\n * @public\n */\ntype UNINITIALIZED = typeof UNINITIALIZED\n\n/**\n * Call this inside a computed signal function to determine whether it is the first time the function is being called.\n *\n * Mainly useful for incremental signal computation.\n *\n * @example\n * ```ts\n * const count = atom('count', 0)\n * const double = computed('double', (prevValue) => {\n *   if (isUninitialized(prevValue)) {\n *     console.log('First time!')\n *   }\n *   return count.value * 2\n * })\n *\n * @param value - The value to check.\n * @public\n */\nexport const isUninitialized = (value: any): value is UNINITIALIZED => {\n\treturn value === UNINITIALIZED\n}\n\nclass WithDiff<Value, Diff> {\n\tconstructor(public value: Value, public diff: Diff) {}\n}\n\n/**\n * When writing incrementally-computed signals it is convenient (and usually more performant) to incrementally compute the diff too.\n *\n * You can use this function to wrap the return value of a computed signal function to indicate that the diff should be used instead of calculating a new one with [[AtomOptions.computeDiff]].\n *\n * @example\n * ```ts\n * const count = atom('count', 0)\n * const double = computed('double', (prevValue) => {\n *   const nextValue = count.value * 2\n *   if (isUninitialized(prevValue)) {\n *     return nextValue\n *   }\n *   return withDiff(nextValue, nextValue - prevValue)\n * }, { historyLength: 10 })\n * ```\n *\n *\n * @param value - The value.\n * @param diff - The diff.\n * @public\n */\nexport function withDiff<Value, Diff>(value: Value, diff: Diff): WithDiff<Value, Diff> {\n\treturn new WithDiff(value, diff)\n}\n\n/**\n * Options for creating computed signals. Used when calling [[computed]].\n * @public\n */\nexport interface ComputedOptions<Value, Diff> {\n\t/**\n\t * The maximum number of diffs to keep in the history buffer.\n\t *\n\t * If you don't need to compute diffs, or if you will supply diffs manually via [[Atom.set]], you can leave this as `undefined` and no history buffer will be created.\n\t *\n\t * If you expect the value to be part of an active effect subscription all the time, and to not change multiple times inside of a single transaction, you can set this to a relatively low number (e.g. 10).\n\t *\n\t * Otherwise, set this to a higher number based on your usage pattern and memory constraints.\n\t *\n\t */\n\thistoryLength?: number\n\t/**\n\t * A method used to compute a diff between the atom's old and new values. If provided, it will not be used unless you also specify [[AtomOptions.historyLength]].\n\t */\n\tcomputeDiff?: ComputeDiff<Value, Diff>\n\t/**\n\t * If provided, this will be used to compare the old and new values of the atom to determine if the value has changed.\n\t * By default, values are compared using first using strict equality (`===`), then `Object.is`, and finally any `.equals` method present in the object's prototype chain.\n\t * @param a\n\t * @param b\n\t * @returns\n\t */\n\tisEqual?: (a: any, b: any) => boolean\n}\n\n/**\n * A computed signal created via [[computed]].\n *\n * @public\n */\nexport interface Computed<Value, Diff = unknown> extends Signal<Value, Diff> {\n\t/**\n\t * Whether this computed child is involved in an actively-running effect graph.\n\t * @public\n\t */\n\treadonly isActivelyListening: boolean\n\n\t/** @internal */\n\treadonly parents: Signal<any, any>[]\n\t/** @internal */\n\treadonly parentEpochs: number[]\n}\n\n/**\n * @internal\n */\nexport class _Computed<Value, Diff = unknown> implements Computed<Value, Diff> {\n\tlastChangedEpoch = GLOBAL_START_EPOCH\n\tlastTraversedEpoch = GLOBAL_START_EPOCH\n\n\t/**\n\t * The epoch when the reactor was last checked.\n\t */\n\tprivate lastCheckedEpoch = GLOBAL_START_EPOCH\n\n\tparents: Signal<any, any>[] = []\n\tparentEpochs: number[] = []\n\n\tchildren = new ArraySet<Child>()\n\n\tget isActivelyListening(): boolean {\n\t\treturn !this.children.isEmpty\n\t}\n\n\thistoryBuffer?: HistoryBuffer<Diff>\n\n\t// The last-computed value of this signal.\n\tprivate state: Value = UNINITIALIZED as unknown as Value\n\n\tprivate computeDiff?: ComputeDiff<Value, Diff>\n\n\tprivate readonly isEqual: (a: any, b: any) => boolean\n\n\tconstructor(\n\t\t/**\n\t\t * The name of the signal. This is used for debugging and performance profiling purposes. It does not need to be globally unique.\n\t\t */\n\t\tpublic readonly name: string,\n\t\t/**\n\t\t * The function that computes the value of the signal.\n\t\t */\n\t\tprivate readonly derive: (\n\t\t\tpreviousValue: Value | UNINITIALIZED,\n\t\t\tlastComputedEpoch: number\n\t\t) => Value | WithDiff<Value, Diff>,\n\t\toptions?: ComputedOptions<Value, Diff>\n\t) {\n\t\tif (options?.historyLength) {\n\t\t\tthis.historyBuffer = new HistoryBuffer(options.historyLength)\n\t\t}\n\t\tthis.computeDiff = options?.computeDiff\n\t\tthis.isEqual = options?.isEqual ?? equals\n\t}\n\n\t__unsafe__getWithoutCapture(): Value {\n\t\tconst isNew = this.lastChangedEpoch === GLOBAL_START_EPOCH\n\n\t\tif (!isNew && (this.lastCheckedEpoch === globalEpoch || !haveParentsChanged(this))) {\n\t\t\tthis.lastCheckedEpoch = globalEpoch\n\t\t\treturn this.state\n\t\t}\n\n\t\ttry {\n\t\t\tstartCapturingParents(this)\n\t\t\tconst result = this.derive(this.state, this.lastCheckedEpoch)\n\t\t\tconst newState = result instanceof WithDiff ? result.value : result\n\t\t\tif (this.state === UNINITIALIZED || !this.isEqual(newState, this.state)) {\n\t\t\t\tif (this.historyBuffer && !isNew) {\n\t\t\t\t\tconst diff = result instanceof WithDiff ? result.diff : undefined\n\t\t\t\t\tthis.historyBuffer.pushEntry(\n\t\t\t\t\t\tthis.lastChangedEpoch,\n\t\t\t\t\t\tglobalEpoch,\n\t\t\t\t\t\tdiff ??\n\t\t\t\t\t\t\tthis.computeDiff?.(this.state, newState, this.lastCheckedEpoch, globalEpoch) ??\n\t\t\t\t\t\t\tRESET_VALUE\n\t\t\t\t\t)\n\t\t\t\t}\n\t\t\t\tthis.lastChangedEpoch = globalEpoch\n\t\t\t\tthis.state = newState\n\t\t\t}\n\t\t\tthis.lastCheckedEpoch = globalEpoch\n\n\t\t\treturn this.state\n\t\t} finally {\n\t\t\tstopCapturingParents()\n\t\t}\n\t}\n\n\tget value(): Value {\n\t\tconst value = this.__unsafe__getWithoutCapture()\n\t\tmaybeCaptureParent(this)\n\t\treturn value\n\t}\n\n\tgetDiffSince(epoch: number): RESET_VALUE | Diff[] {\n\t\t// need to call .value to ensure both that this derivation is up to date\n\t\t// and that tracking happens correctly\n\t\tthis.value\n\n\t\tif (epoch >= this.lastChangedEpoch) {\n\t\t\treturn EMPTY_ARRAY\n\t\t}\n\n\t\treturn this.historyBuffer?.getChangesSince(epoch) ?? RESET_VALUE\n\t}\n}\n\nfunction computedAnnotation(\n\toptions: ComputedOptions<any, any> = {},\n\t_target: any,\n\tkey: string,\n\tdescriptor: PropertyDescriptor\n) {\n\tconst originalMethod = descriptor.get\n\tconst derivationKey = Symbol.for('__signia__computed__' + key)\n\n\tdescriptor.get = function (this: any) {\n\t\tlet d = this[derivationKey] as _Computed<any> | undefined\n\n\t\tif (!d) {\n\t\t\td = new _Computed(key, originalMethod!.bind(this) as any, options)\n\t\t\tObject.defineProperty(this, derivationKey, {\n\t\t\t\tenumerable: false,\n\t\t\t\tconfigurable: false,\n\t\t\t\twritable: false,\n\t\t\t\tvalue: d,\n\t\t\t})\n\t\t}\n\t\treturn d.value\n\t}\n\n\treturn descriptor\n}\n\n/**\n * Retrieves the underlying computed instance for a given property created with the [[computed]]\n * decorator.\n *\n * @example\n * ```ts\n * class Counter {\n *   max = 100\n *   count = atom(0)\n *\n *   @computed get remaining() {\n *     return this.max - this.count.value\n *   }\n * }\n *\n * const c = new Counter()\n * const remaining = getComputedInstance(c, 'remaining')\n * remaining.value === 100 // true\n * c.count.set(13)\n * remaining.value === 87 // true\n * ```\n *\n * @param obj\n * @param propertyName\n * @public\n */\nexport function getComputedInstance<Obj extends object, Prop extends keyof Obj>(\n\tobj: Obj,\n\tpropertyName: Prop\n): Computed<Obj[Prop]> {\n\t// deref to make sure it exists first\n\tconst key = Symbol.for('__signia__computed__' + propertyName.toString())\n\tlet inst = obj[key as keyof typeof obj] as _Computed<Obj[Prop]> | undefined\n\tif (!inst) {\n\t\t// deref to make sure it exists first\n\t\tobj[propertyName]\n\t\tinst = obj[key as keyof typeof obj] as _Computed<Obj[Prop]> | undefined\n\t}\n\treturn inst as any\n}\n\n/**\n * Creates a computed signal.\n *\n * @example\n * ```ts\n * const name = atom('name', 'John')\n * const greeting = computed('greeting', () => `Hello ${name.value}!`)\n * console.log(greeting.value) // 'Hello John!'\n * ```\n *\n * `computed` may also be used as a decorator for creating computed class properties.\n *\n * @example\n * ```ts\n * class Counter {\n *   max = 100\n *   count = atom<number>(0)\n *\n *   @computed get remaining() {\n *     return this.max - this.count.value\n *   }\n * }\n * ```\n *\n * You may optionally pass in a [[ComputedOptions]] when used as a decorator:\n *\n * @example\n * ```ts\n * class Counter {\n *   max = 100\n *   count = atom<number>(0)\n *\n *   @computed({isEqual: (a, b) => a === b})\n *   get remaining() {\n *     return this.max - this.count.value\n *   }\n * }\n * ```\n *\n * @param name - The name of the signal.\n * @param compute - The function that computes the value of the signal.\n * @param options - Options for the signal.\n *\n * @public\n */\nexport function computed<Value, Diff = unknown>(\n\tname: string,\n\tcompute: (\n\t\tpreviousValue: Value | typeof UNINITIALIZED,\n\t\tlastComputedEpoch: number\n\t) => Value | WithDiff<Value, Diff>,\n\toptions?: ComputedOptions<Value, Diff>\n): Computed<Value, Diff>\n\n/** @public */\nexport function computed(\n\ttarget: any,\n\tkey: string,\n\tdescriptor: PropertyDescriptor\n): PropertyDescriptor\n/** @public */\nexport function computed<Value, Diff = unknown>(\n\toptions?: ComputedOptions<Value, Diff>\n): (target: any, key: string, descriptor: PropertyDescriptor) => PropertyDescriptor\n/** @public */\nexport function computed() {\n\tif (arguments.length === 1) {\n\t\tconst options = arguments[0]\n\t\treturn (target: any, key: string, descriptor: PropertyDescriptor) =>\n\t\t\tcomputedAnnotation(options, target, key, descriptor)\n\t} else if (typeof arguments[0] === 'string') {\n\t\treturn new _Computed(arguments[0], arguments[1], arguments[2])\n\t} else {\n\t\treturn computedAnnotation(undefined, arguments[0], arguments[1], arguments[2])\n\t}\n}\n\n/**\n * Returns true if the given value is a computed signal.\n *\n * @param value\n * @returns {value is Computed<any>}\n * @public\n */\nexport function isComputed(value: any): value is Computed<any> {\n\treturn value && value instanceof _Computed\n}\n","import { startCapturingParents, stopCapturingParents } from './capture.js'\nimport { GLOBAL_START_EPOCH } from './constants.js'\nimport { attach, detach, haveParentsChanged } from './helpers.js'\nimport { globalEpoch } from './transactions.js'\nimport { Signal } from './types.js'\n\ninterface EffectSchedulerOptions {\n\t/**\n\t * scheduleEffect is a function that will be called when the effect is scheduled.\n\t *\n\t * It can be used to defer running effects until a later time, for example to batch them together with requestAnimationFrame.\n\t *\n\t *\n\t * @example\n\t * ```ts\n\t * let isRafScheduled = false\n\t * const scheduledEffects: Array<() => void> = []\n\t * const scheduleEffect = (runEffect: () => void) => {\n\t * \tscheduledEffects.push(runEffect)\n\t * \tif (!isRafScheduled) {\n\t * \t\tisRafScheduled = true\n\t * \t\trequestAnimationFrame(() => {\n\t * \t\t\tisRafScheduled = false\n\t * \t\t\tscheduledEffects.forEach((runEffect) => runEffect())\n\t * \t\t\tscheduledEffects.length = 0\n\t * \t\t})\n\t * \t}\n\t * }\n\t * const stop = react('set page title', () => {\n\t * \tdocument.title = doc.title,\n\t * }, scheduleEffect)\n\t * ```\n\t *\n\t * @param execute\n\t * @returns\n\t */\n\tscheduleEffect?: (execute: () => void) => void\n}\n\n/**\n * An EffectScheduler is responsible for executing side effects in response to changes in state.\n *\n * You probably don't need to use this directly unless you're integrating Signia with a framework of some kind.\n *\n * Instead, use the [[react]] and [[reactor]] functions.\n *\n * @example\n * ```ts\n * const render = new EffectScheduler('render', drawToCanvas)\n *\n * render.attach()\n * render.execute()\n * ```\n *\n * @public\n */\nexport class EffectScheduler<Result> {\n\tprivate _isActivelyListening = false\n\t/**\n\t * Whether this scheduler is attached and actively listening to its parents.\n\t * @public\n\t */\n\tget isActivelyListening() {\n\t\treturn this._isActivelyListening\n\t}\n\t/** @internal */\n\tlastTraversedEpoch = GLOBAL_START_EPOCH\n\n\tprivate lastReactedEpoch = GLOBAL_START_EPOCH\n\tprivate _scheduleCount = 0\n\n\t/**\n\t * The number of times this effect has been scheduled.\n\t * @public\n\t */\n\tget scheduleCount() {\n\t\treturn this._scheduleCount\n\t}\n\n\t/** @internal */\n\tparentEpochs: number[] = []\n\t/** @internal */\n\tparents: Signal<any, any>[] = []\n\tprivate readonly _scheduleEffect?: (execute: () => void) => void\n\tconstructor(\n\t\tpublic readonly name: string,\n\t\tprivate readonly runEffect: (lastReactedEpoch: number) => Result,\n\t\toptions?: EffectSchedulerOptions\n\t) {\n\t\tthis._scheduleEffect = options?.scheduleEffect\n\t}\n\n\t/** @internal */\n\tmaybeScheduleEffect() {\n\t\t// bail out if we have been cancelled by another effect\n\t\tif (!this._isActivelyListening) return\n\t\t// bail out if no atoms have changed since the last time we ran this effect\n\t\tif (this.lastReactedEpoch === globalEpoch) return\n\n\t\t// bail out if we have parents and they have not changed since last time\n\t\tif (this.parents.length && !haveParentsChanged(this)) {\n\t\t\tthis.lastReactedEpoch = globalEpoch\n\t\t\treturn\n\t\t}\n\t\t// if we don't have parents it's probably the first time this is running.\n\t\tthis.scheduleEffect()\n\t}\n\n\t/** @internal */\n\tscheduleEffect() {\n\t\tthis._scheduleCount++\n\t\tif (this._scheduleEffect) {\n\t\t\t// if the effect should be deferred (e.g. until a react render), do so\n\t\t\tthis._scheduleEffect(this.maybeExecute)\n\t\t} else {\n\t\t\t// otherwise execute right now!\n\t\t\tthis.execute()\n\t\t}\n\t}\n\n\tprivate maybeExecute = () => {\n\t\t// bail out if we have been detached before this runs\n\t\tif (!this._isActivelyListening) return\n\t\tthis.execute()\n\t}\n\n\t/**\n\t * Makes this scheduler become 'actively listening' to its parents.\n\t * If it has been executed before it will immediately become eligible to receive 'maybeScheduleEffect' calls.\n\t * If it has not executed before it will need to be manually executed once to become eligible for scheduling, i.e. by calling [[EffectScheduler.execute]].\n\t * @public\n\t */\n\tattach() {\n\t\tthis._isActivelyListening = true\n\t\tfor (let i = 0, n = this.parents.length; i < n; i++) {\n\t\t\tattach(this.parents[i], this)\n\t\t}\n\t}\n\n\t/**\n\t * Makes this scheduler stop 'actively listening' to its parents.\n\t * It will no longer be eligible to receive 'maybeScheduleEffect' calls until [[EffectScheduler.attach]] is called again.\n\t */\n\tdetach() {\n\t\tthis._isActivelyListening = false\n\t\tfor (let i = 0, n = this.parents.length; i < n; i++) {\n\t\t\tdetach(this.parents[i], this)\n\t\t}\n\t}\n\n\t/**\n\t * Executes the effect immediately and returns the result.\n\t * @returns The result of the effect.\n\t */\n\texecute(): Result {\n\t\ttry {\n\t\t\tstartCapturingParents(this)\n\t\t\tconst result = this.runEffect(this.lastReactedEpoch)\n\t\t\tthis.lastReactedEpoch = globalEpoch\n\t\t\treturn result\n\t\t} finally {\n\t\t\tstopCapturingParents()\n\t\t}\n\t}\n}\n\n/**\n * Starts a new effect scheduler, scheduling the effect immediately.\n *\n * Returns a function that can be called to stop the scheduler.\n *\n * @example\n * ```ts\n * const color = atom('color', 'red')\n * const stop = react('set style', () => {\n *   divElem.style.color = color.value\n * })\n * color.set('blue')\n * // divElem.style.color === 'blue'\n * stop()\n * color.set('green')\n * // divElem.style.color === 'blue'\n * ```\n *\n *\n * Also useful in React applications for running effects outside of the render cycle.\n *\n * @example\n * ```ts\n * useEffect(() => react('set style', () => {\n *   divRef.current.style.color = color.value\n * }), [])\n * ```\n *\n * @public\n */\nexport function react(\n\tname: string,\n\tfn: (lastReactedEpoch: number) => any,\n\toptions?: EffectSchedulerOptions\n) {\n\tconst scheduler = new EffectScheduler(name, fn, options)\n\tscheduler.attach()\n\tscheduler.scheduleEffect()\n\treturn () => {\n\t\tscheduler.detach()\n\t}\n}\n\n/**\n * The reactor is a user-friendly interface for starting and stopping an [[EffectScheduler]].\n *\n * Calling .start() will attach the scheduler and execute the effect immediately the first time it is called.\n *\n * If the reactor is stopped, calling `.start()` will re-attach the scheduler but will only execute the effect if any of its parents have changed since it was stopped.\n *\n * You can create a reactor with [[reactor]].\n * @public\n */\nexport interface Reactor<T = unknown> {\n\t/**\n\t * The underlying effect scheduler.\n\t * @public\n\t */\n\tscheduler: EffectScheduler<T>\n\t/**\n\t * Start the scheduler. The first time this is called the effect will be scheduled immediately.\n\t *\n\t * If the reactor is stopped, calling this will start the scheduler again but will only execute the effect if any of its parents have changed since it was stopped.\n\t *\n\t * If you need to force re-execution of the effect, pass `{ force: true }`.\n\t * @public\n\t */\n\tstart(options?: { force?: boolean }): void\n\t/**\n\t * Stop the scheduler.\n\t * @public\n\t */\n\tstop(): void\n}\n\n/**\n * Creates a [[Reactor]], which is a thin wrapper around an [[EffectScheduler]].\n *\n * @public\n */\nexport function reactor<Result>(\n\tname: string,\n\tfn: (lastReactedEpoch: number) => Result,\n\toptions?: EffectSchedulerOptions\n): Reactor<Result> {\n\tconst scheduler = new EffectScheduler<Result>(name, fn, options)\n\treturn {\n\t\tscheduler,\n\t\tstart: (options?: { force?: boolean }) => {\n\t\t\tconst force = options?.force ?? false\n\t\t\tscheduler.attach()\n\t\t\tif (force) {\n\t\t\t\tscheduler.scheduleEffect()\n\t\t\t} else {\n\t\t\t\tscheduler.maybeScheduleEffect()\n\t\t\t}\n\t\t},\n\t\tstop: () => {\n\t\t\tscheduler.detach()\n\t\t},\n\t}\n}\n","import { _Atom } from './Atom.js'\nimport { _Computed } from './Computed.js'\nimport { Signal } from './types.js'\n\n/**\n * Returns true if the given value is a signal (either an Atom or a Computed).\n * @public\n */\nexport function isSignal(value: any): value is Signal<any> {\n\treturn value instanceof _Atom || value instanceof _Computed\n}\n","/**\n * **signia** is a reactive signals library for TypeScript.\n *\n * See [the github repo](https://github.com/tldraw/signia) for more information.\n *\n * @packageDocumentation\n */\n\nexport * from './api.js'\nimport * as signia from './api.js'\nexport default signia\n","/** A micro cache used when storing records in memory (using a WeakMap). */\nexport class Cache<T extends object, K> {\n\t/** The map of items to their cached values. */\n\titems = new WeakMap<T, K>()\n\n\t/**\n\t * Get the cached value for a given record. If the record is not present in the map, the callback\n\t * will be used to create the value (with the result being stored in the cache for next time).\n\t *\n\t * @param item - The item to get.\n\t * @param cb - The callback to use to create the value when a cached value is not found.\n\t */\n\tget<P extends T>(item: P, cb: (item: P) => K) {\n\t\tif (!this.items.has(item)) {\n\t\t\tthis.items.set(item, cb(item))\n\t\t}\n\n\t\treturn this.items.get(item)!\n\t}\n}\n","import { BaseRecord, ID } from './BaseRecord'\nimport { intersectSets } from './setUtils'\nimport { StoreQueries } from './StoreQueries'\n\nexport type ValueMatcher<T> = { eq: T } | { neq: T } | { gt: number }\n\nexport type QueryExpression<R extends object> = {\n\t[k in keyof R & string]?: ValueMatcher<R[k]>\n\t// todo: handle nesting\n\t// | (R[k] extends object ? { match: QueryExpression<R[k]> } : never)\n}\n\nexport function objectMatchesQuery<T extends object>(query: QueryExpression<T>, object: T) {\n\tfor (const [key, _matcher] of Object.entries(query)) {\n\t\tconst matcher = _matcher as ValueMatcher<T>\n\t\tconst value = object[key as keyof T]\n\t\t// if you add matching logic here, make sure you also update executeQuery,\n\t\t// where initial data is pulled out of the indexes, since that requires different\n\t\t// matching logic\n\t\tif ('eq' in matcher && value !== matcher.eq) return false\n\t\tif ('neq' in matcher && value === matcher.neq) return false\n\t\tif ('gt' in matcher && (typeof value !== 'number' || value <= matcher.gt)) return false\n\t}\n\treturn true\n}\n\nexport function executeQuery<R extends BaseRecord, TypeName extends R['typeName']>(\n\tstore: StoreQueries<R>,\n\ttypeName: TypeName,\n\tquery: QueryExpression<Extract<R, { typeName: TypeName }>>\n): Set<ID<Extract<R, { typeName: TypeName }>>> {\n\tconst matchIds = Object.fromEntries(Object.keys(query).map((key) => [key, new Set()]))\n\n\tfor (const [k, matcher] of Object.entries(query)) {\n\t\tif ('eq' in matcher) {\n\t\t\tconst index = store.index(typeName, k as any)\n\t\t\tconst ids = index.value.get(matcher.eq)\n\t\t\tif (ids) {\n\t\t\t\tfor (const id of ids) {\n\t\t\t\t\tmatchIds[k].add(id)\n\t\t\t\t}\n\t\t\t}\n\t\t} else if ('neq' in matcher) {\n\t\t\tconst index = store.index(typeName, k as any)\n\t\t\tfor (const [value, ids] of index.value) {\n\t\t\t\tif (value !== matcher.neq) {\n\t\t\t\t\tfor (const id of ids) {\n\t\t\t\t\t\tmatchIds[k].add(id)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} else if ('gt' in matcher) {\n\t\t\tconst index = store.index(typeName, k as any)\n\t\t\tfor (const [value, ids] of index.value) {\n\t\t\t\tif (value > matcher.gt) {\n\t\t\t\t\tfor (const id of ids) {\n\t\t\t\t\t\tmatchIds[k].add(id)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn intersectSets(Object.values(matchIds)) as Set<ID<Extract<R, { typeName: TypeName }>>>\n}\n","import { CollectionDiff } from './Store'\n\n/**\n * Combine multiple sets into a single set containing only the common elements of all sets.\n *\n * @param sets - The sets to combine.\n */\nexport function intersectSets<T>(sets: Set<T>[]) {\n\tif (sets.length === 0) return new Set<T>()\n\tconst first = sets[0]\n\tconst rest = sets.slice(1)\n\tconst result = new Set<T>()\n\n\tfor (const val of first) {\n\t\tif (rest.every((set) => set.has(val))) {\n\t\t\tresult.add(val)\n\t\t}\n\t}\n\n\treturn result\n}\n\n/**\n * Calculates a diff between two sets.\n *\n * @param prev - The previous set\n * @param next - The next set\n */\nexport function diffSets<T>(prev: Set<T>, next: Set<T>): CollectionDiff<T> | undefined {\n\tconst result: CollectionDiff<T> = {}\n\n\tfor (const val of next) {\n\t\tif (!prev.has(val)) {\n\t\t\tresult.added ??= new Set()\n\t\t\tresult.added.add(val)\n\t\t}\n\t}\n\n\tfor (const val of prev) {\n\t\tif (!next.has(val)) {\n\t\t\tresult.removed ??= new Set()\n\t\t\tresult.removed.add(val)\n\t\t}\n\t}\n\n\treturn result.added || result.removed ? result : undefined\n}\n","import isEqual from 'lodash.isequal'\nimport {\n\tAtom,\n\tcomputed,\n\tComputed,\n\tEMPTY_ARRAY,\n\tisUninitialized,\n\tRESET_VALUE,\n\twithDiff,\n} from 'signia'\nimport { BaseRecord, ID } from './BaseRecord'\nimport { executeQuery, objectMatchesQuery, QueryExpression } from './executeQuery'\nimport { IncrementalSetConstructor } from './IncrementalSetConstructor'\nimport { diffSets } from './setUtils'\nimport { CollectionDiff, RecordsDiff } from './Store'\n\nexport type RSIndexDiff<\n\tR extends BaseRecord = BaseRecord,\n\tProperty extends string & keyof R = string & keyof R\n> = Map<R[Property], CollectionDiff<ID<R>>>\n\nexport type RSIndexMap<\n\tR extends BaseRecord = BaseRecord,\n\tProperty extends string & keyof R = string & keyof R\n> = Map<R[Property], Set<ID<R>>>\n\nexport type RSIndex<\n\tR extends BaseRecord = BaseRecord,\n\tProperty extends string & keyof R = string & keyof R\n> = Computed<Map<R[Property], Set<ID<R>>>, RSIndexDiff<R, Property>>\n\n/**\n * A class that provides a 'namespace' for the various kinds of indexes\n * one may wish to derive from the record store.\n */\nexport class StoreQueries<R extends BaseRecord = BaseRecord> {\n\tconstructor(\n\t\tprivate readonly atoms: Atom<Record<ID<R>, Atom<R>>>,\n\t\tprivate readonly history: Atom<number, RecordsDiff<R>>\n\t) {}\n\n\t/**\n\t * A cache of derivations (indexes).\n\t *\n\t * @internal\n\t */\n\tprivate indexCache = new Map<string, RSIndex<R>>()\n\n\t/**\n\t * A cache of derivations (filtered histories).\n\t *\n\t * @internal\n\t */\n\tprivate historyCache = new Map<string, Computed<number, RecordsDiff<R>>>()\n\n\t/**\n\t * Create a derivation that contains the hisotry for a given type\n\t *\n\t * @param typeName - The name of the type to filter by.\n\t *\n\t * @returns A derivation that returns the ids of all records of the given type.\n\t * @public\n\t */\n\tpublic filterHistory<TypeName extends R['typeName']>(\n\t\ttypeName: TypeName\n\t): Computed<number, RecordsDiff<Extract<R, { typeName: TypeName }>>> {\n\t\ttype S = Extract<R, { typeName: TypeName }>\n\n\t\tif (this.historyCache.has(typeName)) {\n\t\t\treturn this.historyCache.get(typeName) as any\n\t\t}\n\n\t\tconst filtered = computed<number, RecordsDiff<S>>(\n\t\t\t'filterHistory:' + typeName,\n\t\t\t(lastValue, lastComputedEpoch) => {\n\t\t\t\tif (isUninitialized(lastValue)) {\n\t\t\t\t\treturn this.history.value\n\t\t\t\t}\n\n\t\t\t\tconst diff = this.history.getDiffSince(lastComputedEpoch)\n\t\t\t\tif (diff === RESET_VALUE) return this.history.value\n\n\t\t\t\tconst res: RecordsDiff<S> = { added: {}, removed: {}, updated: {} }\n\t\t\t\tlet numAdded = 0\n\t\t\t\tlet numRemoved = 0\n\t\t\t\tlet numUpdated = 0\n\n\t\t\t\tfor (const changes of diff) {\n\t\t\t\t\tfor (const added of Object.values(changes.added)) {\n\t\t\t\t\t\tif (added.typeName === typeName) {\n\t\t\t\t\t\t\tif (res.removed[added.id]) {\n\t\t\t\t\t\t\t\tconst original = res.removed[added.id]\n\t\t\t\t\t\t\t\tdelete res.removed[added.id]\n\t\t\t\t\t\t\t\tnumRemoved--\n\t\t\t\t\t\t\t\tif (original !== added) {\n\t\t\t\t\t\t\t\t\tres.updated[added.id] = [original, added as S]\n\t\t\t\t\t\t\t\t\tnumUpdated++\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tres.added[added.id] = added as S\n\t\t\t\t\t\t\t\tnumAdded++\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tfor (const [from, to] of Object.values(changes.updated)) {\n\t\t\t\t\t\tif (to.typeName === typeName) {\n\t\t\t\t\t\t\tif (res.added[to.id]) {\n\t\t\t\t\t\t\t\tres.added[to.id] = to as S\n\t\t\t\t\t\t\t} else if (res.updated[to.id]) {\n\t\t\t\t\t\t\t\tres.updated[to.id] = [res.updated[to.id][0], to as S]\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tres.updated[to.id] = [from as S, to as S]\n\t\t\t\t\t\t\t\tnumUpdated++\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tfor (const removed of Object.values(changes.removed)) {\n\t\t\t\t\t\tif (removed.typeName === typeName) {\n\t\t\t\t\t\t\tif (res.added[removed.id]) {\n\t\t\t\t\t\t\t\t// was added during this diff sequence, so just undo the add\n\t\t\t\t\t\t\t\tdelete res.added[removed.id]\n\t\t\t\t\t\t\t\tnumAdded--\n\t\t\t\t\t\t\t} else if (res.updated[removed.id]) {\n\t\t\t\t\t\t\t\t// remove oldest version\n\t\t\t\t\t\t\t\tres.removed[removed.id] = res.updated[removed.id][0]\n\t\t\t\t\t\t\t\tdelete res.updated[removed.id]\n\t\t\t\t\t\t\t\tnumUpdated--\n\t\t\t\t\t\t\t\tnumRemoved++\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tres.removed[removed.id] = removed as S\n\t\t\t\t\t\t\t\tnumRemoved++\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (numAdded || numRemoved || numUpdated) {\n\t\t\t\t\treturn withDiff(this.history.value, res)\n\t\t\t\t} else {\n\t\t\t\t\treturn lastValue\n\t\t\t\t}\n\t\t\t},\n\t\t\t{ historyLength: 100 }\n\t\t)\n\n\t\tthis.historyCache.set(typeName, filtered)\n\n\t\treturn filtered\n\t}\n\n\t/**\n\t * Create a derivation that returns an index on a property for the given type.\n\t *\n\t * @param typeName - The name of the type.\n\t * @param property - The name of the property.\n\t *\n\t * @public\n\t */\n\tpublic index<\n\t\tTypeName extends R['typeName'],\n\t\tProperty extends string & keyof Extract<R, { typeName: TypeName }>\n\t>(typeName: TypeName, property: Property): RSIndex<Extract<R, { typeName: TypeName }>, Property> {\n\t\tconst cacheKey = typeName + ':' + property\n\n\t\tif (this.indexCache.has(cacheKey)) {\n\t\t\treturn this.indexCache.get(cacheKey) as any\n\t\t}\n\n\t\tconst index = this.__uncached_createIndex(typeName, property)\n\n\t\tthis.indexCache.set(cacheKey, index as any)\n\n\t\treturn index\n\t}\n\n\t/**\n\t * Create a derivation that returns an index on a property for the given type.\n\t *\n\t * @param typeName - The name of the type?.\n\t * @param property - The name of the property?.\n\t *\n\t * @internal\n\t */\n\t__uncached_createIndex<\n\t\tTypeName extends R['typeName'],\n\t\tProperty extends string & keyof Extract<R, { typeName: TypeName }>\n\t>(typeName: TypeName, property: Property): RSIndex<Extract<R, { typeName: TypeName }>, Property> {\n\t\ttype S = Extract<R, { typeName: TypeName }>\n\n\t\tconst typeHistory = this.filterHistory(typeName)\n\n\t\tconst fromScratch = () => {\n\t\t\t// deref typeHistory early so that the first time the incremental version runs\n\t\t\t// it gets a diff to work with instead of having to bail to this from-scratch version\n\t\t\ttypeHistory.value\n\t\t\tconst res = new Map<S[Property], Set<ID<S>>>()\n\t\t\tfor (const atom of Object.values(this.atoms.value)) {\n\t\t\t\tconst record = atom.value\n\t\t\t\tif (record.typeName === typeName) {\n\t\t\t\t\tconst value = (record as S)[property]\n\t\t\t\t\tif (!res.has(value)) {\n\t\t\t\t\t\tres.set(value, new Set())\n\t\t\t\t\t}\n\t\t\t\t\tres.get(value)!.add((record as S).id)\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn res\n\t\t}\n\n\t\treturn computed<RSIndexMap<S, Property>, RSIndexDiff<S, Property>>(\n\t\t\t'index:' + typeName + ':' + property,\n\t\t\t(prevValue, lastComputedEpoch) => {\n\t\t\t\tif (isUninitialized(prevValue)) return fromScratch()\n\n\t\t\t\tconst history = typeHistory.getDiffSince(lastComputedEpoch)\n\t\t\t\tif (history === RESET_VALUE) {\n\t\t\t\t\treturn fromScratch()\n\t\t\t\t}\n\n\t\t\t\tconst setConstructors = new Map<any, IncrementalSetConstructor<ID<S>>>()\n\n\t\t\t\tconst add = (value: S[Property], id: ID<S>) => {\n\t\t\t\t\tlet setConstructor = setConstructors.get(value)\n\t\t\t\t\tif (!setConstructor)\n\t\t\t\t\t\tsetConstructor = new IncrementalSetConstructor<ID<S>>(prevValue.get(value) ?? new Set())\n\t\t\t\t\tsetConstructor.add(id)\n\t\t\t\t\tsetConstructors.set(value, setConstructor)\n\t\t\t\t}\n\n\t\t\t\tconst remove = (value: S[Property], id: ID<S>) => {\n\t\t\t\t\tlet set = setConstructors.get(value)\n\t\t\t\t\tif (!set) set = new IncrementalSetConstructor<ID<S>>(prevValue.get(value) ?? new Set())\n\t\t\t\t\tset.remove(id)\n\t\t\t\t\tsetConstructors.set(value, set)\n\t\t\t\t}\n\n\t\t\t\tfor (const changes of history) {\n\t\t\t\t\tfor (const record of Object.values(changes.added)) {\n\t\t\t\t\t\tif (record.typeName === typeName) {\n\t\t\t\t\t\t\tconst value = (record as S)[property]\n\t\t\t\t\t\t\tadd(value, (record as S).id)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tfor (const [from, to] of Object.values(changes.updated)) {\n\t\t\t\t\t\tif (to.typeName === typeName) {\n\t\t\t\t\t\t\tconst prev = (from as S)[property]\n\t\t\t\t\t\t\tconst next = (to as S)[property]\n\t\t\t\t\t\t\tif (prev !== next) {\n\t\t\t\t\t\t\t\tremove(prev, (to as S).id)\n\t\t\t\t\t\t\t\tadd(next, (to as S).id)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tfor (const record of Object.values(changes.removed)) {\n\t\t\t\t\t\tif (record.typeName === typeName) {\n\t\t\t\t\t\t\tconst value = (record as S)[property]\n\t\t\t\t\t\t\tremove(value, (record as S).id)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tlet nextValue: undefined | RSIndexMap<S, Property> = undefined\n\t\t\t\tlet nextDiff: undefined | RSIndexDiff<S, Property> = undefined\n\n\t\t\t\tfor (const [value, setConstructor] of setConstructors) {\n\t\t\t\t\tconst result = setConstructor.get()\n\t\t\t\t\tif (!result) continue\n\t\t\t\t\tif (!nextValue) nextValue = new Map(prevValue)\n\t\t\t\t\tif (!nextDiff) nextDiff = new Map()\n\t\t\t\t\tif (result.value.size === 0) {\n\t\t\t\t\t\tnextValue.delete(value)\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnextValue.set(value, result.value)\n\t\t\t\t\t}\n\t\t\t\t\tnextDiff.set(value, result.diff)\n\t\t\t\t}\n\n\t\t\t\tif (nextValue && nextDiff) {\n\t\t\t\t\treturn withDiff(nextValue, nextDiff)\n\t\t\t\t}\n\n\t\t\t\treturn prevValue\n\t\t\t},\n\t\t\t{ historyLength: 100 }\n\t\t)\n\t}\n\n\t/**\n\t * Create a derivation that will return a signle record matching the given query.\n\t *\n\t * It will return undefined if there is no matching record\n\t *\n\t * @param typeName - The name of the type?\n\t * @param queryCreator - A function that returns the query expression.\n\t * @param name - (optinal) The name of the query.\n\t */\n\trecord<TypeName extends R['typeName']>(\n\t\ttypeName: TypeName,\n\t\tqueryCreator: () => QueryExpression<Extract<R, { typeName: TypeName }>> = () => ({}),\n\t\tname = 'record:' + typeName + (queryCreator ? ':' + queryCreator.toString() : '')\n\t): Computed<Extract<R, { typeName: TypeName }> | undefined> {\n\t\ttype S = Extract<R, { typeName: TypeName }>\n\t\tconst ids = this.ids(typeName, queryCreator, name)\n\n\t\treturn computed<S | undefined>(name, () => {\n\t\t\tfor (const id of ids.value) {\n\t\t\t\treturn this.atoms.value[id]?.value as S\n\t\t\t}\n\t\t\treturn undefined\n\t\t})\n\t}\n\n\t/**\n\t * Create a derivation that will return an array of records matching the given query\n\t *\n\t * @param typeName - The name of the type?\n\t * @param queryCreator - A function that returns the query expression.\n\t * @param name - (optinal) The name of the query.\n\t */\n\trecords<TypeName extends R['typeName']>(\n\t\ttypeName: TypeName,\n\t\tqueryCreator: () => QueryExpression<Extract<R, { typeName: TypeName }>> = () => ({}),\n\t\tname = 'records:' + typeName + (queryCreator ? ':' + queryCreator.toString() : '')\n\t): Computed<Array<Extract<R, { typeName: TypeName }>>> {\n\t\ttype S = Extract<R, { typeName: TypeName }>\n\t\tconst ids = this.ids(typeName, queryCreator, 'ids:' + name)\n\n\t\treturn computed<S[]>(name, () => {\n\t\t\treturn [...ids.value].map((id) => {\n\t\t\t\tconst atom = this.atoms.value[id]\n\t\t\t\tif (!atom) {\n\t\t\t\t\tthrow new Error('no atom found for record id: ' + id)\n\t\t\t\t}\n\t\t\t\treturn atom.value as S\n\t\t\t})\n\t\t})\n\t}\n\n\t/**\n\t * Create a derivation that will return the ids of all records of the given type.\n\t *\n\t * @param typeName - The name of the type.\n\t * @param queryCreator - A function that returns the query expression.\n\t * @param name - (optinal) The name of the query.\n\t */\n\tids<TypeName extends R['typeName']>(\n\t\ttypeName: TypeName,\n\t\tqueryCreator: () => QueryExpression<Extract<R, { typeName: TypeName }>> = () => ({}),\n\t\tname = 'ids:' + typeName + (queryCreator ? ':' + queryCreator.toString() : '')\n\t): Computed<\n\t\tSet<ID<Extract<R, { typeName: TypeName }>>>,\n\t\tCollectionDiff<ID<Extract<R, { typeName: TypeName }>>>\n\t> {\n\t\ttype S = Extract<R, { typeName: TypeName }>\n\n\t\tconst typeHistory = this.filterHistory(typeName)\n\n\t\tconst fromScratch = () => {\n\t\t\t// deref type history early to allow first incremental update to use diffs\n\t\t\ttypeHistory.value\n\t\t\tconst query: QueryExpression<S> = queryCreator()\n\t\t\tif (Object.keys(query).length === 0) {\n\t\t\t\treturn new Set<ID<S>>(\n\t\t\t\t\tObject.values(this.atoms.value).flatMap((v) => {\n\t\t\t\t\t\tconst r = v.value\n\t\t\t\t\t\tif (r.typeName === typeName) {\n\t\t\t\t\t\t\treturn r.id as ID<S>\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn []\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t)\n\t\t\t}\n\n\t\t\treturn executeQuery(this, typeName, query)\n\t\t}\n\n\t\tconst fromScratchWithDiff = (prevValue: Set<ID<S>>) => {\n\t\t\tconst nextValue = fromScratch()\n\t\t\tconst diff = diffSets(prevValue, nextValue)\n\t\t\tif (diff) {\n\t\t\t\treturn withDiff(nextValue, diff)\n\t\t\t} else {\n\t\t\t\treturn prevValue\n\t\t\t}\n\t\t}\n\t\tconst cachedQuery = computed('ids_query:' + name, queryCreator, {\n\t\t\tisEqual,\n\t\t})\n\n\t\treturn computed(\n\t\t\t'query:' + name,\n\t\t\t(prevValue, lastComputedEpoch) => {\n\t\t\t\tconst query = cachedQuery.value\n\t\t\t\tif (isUninitialized(prevValue)) {\n\t\t\t\t\treturn fromScratch()\n\t\t\t\t}\n\n\t\t\t\t// if the query changed since last time this ran then we need to start again\n\t\t\t\tif (lastComputedEpoch < cachedQuery.lastChangedEpoch) {\n\t\t\t\t\treturn fromScratchWithDiff(prevValue)\n\t\t\t\t}\n\n\t\t\t\t// otherwise iterate over the changes from the store and apply them to the previous value if needed\n\t\t\t\tconst history = typeHistory.getDiffSince(lastComputedEpoch)\n\t\t\t\tif (history === RESET_VALUE) {\n\t\t\t\t\treturn fromScratchWithDiff(prevValue)\n\t\t\t\t}\n\n\t\t\t\tconst setConstructor = new IncrementalSetConstructor<ID<S>>(\n\t\t\t\t\tprevValue\n\t\t\t\t) as IncrementalSetConstructor<ID<S>>\n\n\t\t\t\tfor (const changes of history) {\n\t\t\t\t\tfor (const added of Object.values(changes.added)) {\n\t\t\t\t\t\tif (added.typeName === typeName && objectMatchesQuery(query, added)) {\n\t\t\t\t\t\t\tsetConstructor.add(added.id as ID<S>)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tfor (const [_, updated] of Object.values(changes.updated)) {\n\t\t\t\t\t\tif (updated.typeName === typeName) {\n\t\t\t\t\t\t\tif (objectMatchesQuery(query, updated)) {\n\t\t\t\t\t\t\t\tsetConstructor.add(updated.id as ID<S>)\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tsetConstructor.remove(updated.id as ID<S>)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tfor (const removed of Object.values(changes.removed)) {\n\t\t\t\t\t\tif (removed.typeName === typeName) {\n\t\t\t\t\t\t\tsetConstructor.remove(removed.id as ID<S>)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tconst result = setConstructor.get()\n\t\t\t\tif (!result) {\n\t\t\t\t\treturn prevValue\n\t\t\t\t}\n\n\t\t\t\treturn withDiff(result.value, result.diff)\n\t\t\t},\n\t\t\t{ historyLength: 50 }\n\t\t)\n\t}\n\n\texec<TypeName extends R['typeName']>(\n\t\ttypeName: TypeName,\n\t\tquery: QueryExpression<Extract<R, { typeName: TypeName }>>\n\t): Array<Extract<R, { typeName: TypeName }>> {\n\t\tconst ids = executeQuery(this, typeName, query)\n\t\tif (ids.size === 0) {\n\t\t\treturn EMPTY_ARRAY\n\t\t}\n\t\tconst atoms = this.atoms.value\n\t\treturn [...ids].map((id) => atoms[id].value as Extract<R, { typeName: TypeName }>)\n\t}\n}\n","import { atom, Atom, computed, Computed, Reactor, reactor, transact } from 'signia'\nimport { BaseRecord, ID } from './BaseRecord'\nimport { Cache } from './Cache'\nimport { devFreeze } from './devFreeze'\nimport { StoreQueries } from './StoreQueries'\nimport { StoreSchema } from './StoreSchema'\n\ntype RecFromId<K extends ID> = K extends ID<infer R> ? R : never\n\n/**\n * A diff describing the changes to a record.\n * @public\n */\nexport type RecordsDiff<R extends BaseRecord> = {\n\tadded: Record<string, R>\n\tupdated: Record<string, [from: R, to: R]>\n\tremoved: Record<string, R>\n}\n\n/**\n * A diff describing the changes to a collection.\n * @public\n */\nexport type CollectionDiff<T> = { added?: Set<T>; removed?: Set<T> }\n\n/**\n * An entry containing changes that originated either by user actions or remote changes.\n * @public\n */\nexport type HistoryEntry<R extends BaseRecord = BaseRecord> = {\n\tchanges: RecordsDiff<R>\n\tsource: 'user' | 'remote'\n}\n\n/**\n * A function that will be called when the history changes.\n * @public\n */\nexport type StoreListener<R extends BaseRecord> = (entry: HistoryEntry<R>) => void\n\n/**\n * A record store is a collection of records of different types.\n * @public\n */\nexport type ComputedCache<Data, R extends BaseRecord> = {\n\tget(id: ID<R>): Data | undefined\n}\n\n/**\n * A serialized snapshot of the record store's values.\n * @public\n */\nexport type StoreSnapshot<R extends BaseRecord> = Record<string, R>\n\n/** @public */\nexport type StoreValidator<R extends BaseRecord> = {\n\tvalidate: (record: unknown) => R\n}\n\n/** @public */\nexport type StoreValidators<R extends BaseRecord> = {\n\t[K in R['typeName']]: StoreValidator<Extract<R, { typeName: K }>>\n}\n\n/** @public */\nexport type StoreError = {\n\terror: Error\n\tphase: 'initialize' | 'createRecord' | 'updateRecord' | 'tests'\n\trecordBefore?: unknown\n\trecordAfter: unknown\n\tisExistingValidationIssue: boolean\n}\n\n/** @internal */\nexport type StoreRecord<S extends Store<any>> = S extends Store<infer R> ? R : never\n\n/**\n * A store of records.\n * @public\n */\nexport class Store<R extends BaseRecord = BaseRecord, Props = unknown> {\n\t/**\n\t * An atom containing the store's atoms.\n\t *\n\t * @internal\n\t * @readonly\n\t */\n\tprivate readonly atoms: Atom<Record<ID<R>, Atom<R>>> = atom('store_atoms', {})\n\n\t/**\n\t * An atom containing the store's history.\n\t *\n\t * @public\n\t * @readonly\n\t */\n\treadonly history: Atom<number, RecordsDiff<R>> = atom('history', 0, {\n\t\thistoryLength: 1000,\n\t})\n\n\t/**\n\t * A StoreQueries instance for this store.\n\t *\n\t * @public\n\t * @readonly\n\t */\n\treadonly query = new StoreQueries<R>(this.atoms, this.history)\n\n\t/**\n\t * A set containing listeners that have been added to this store.\n\t *\n\t * @internal\n\t */\n\tprivate listeners = new Set<StoreListener<R>>()\n\n\t/**\n\t * An array of history entries that have not yet been flushed.\n\t *\n\t * @internal\n\t */\n\tprivate historyAccumulator = new HistoryAccumulator<R>()\n\n\t/**\n\t * A reactor that responds to changes to the history by squashing the\n\t * accumulated history and notifying listeners of the changes.\n\t *\n\t * @internal\n\t */\n\tprivate historyReactor: Reactor\n\n\treadonly schema: StoreSchema<R, Props>\n\n\treadonly props: Props\n\n\tconstructor(config: {\n\t\t/**\n\t\t * The store's initial data.\n\t\t */\n\t\tinitialData?: StoreSnapshot<R>\n\t\t/**\n\t\t * A map of validators for each record type. A record's validator will be\n\t\t * called when the record is created or updated. It should throw an error if the record is invalid.\n\t\t */\n\t\tschema: StoreSchema<R, Props>\n\t\tprops: Props\n\t}) {\n\t\tconst { initialData, schema } = config\n\n\t\tthis.schema = schema\n\t\tthis.props = config.props\n\n\t\tif (initialData) {\n\t\t\tthis.atoms.set(\n\t\t\t\tObject.fromEntries(\n\t\t\t\t\tObject.entries(initialData).map(([id, record]) => [\n\t\t\t\t\t\tid,\n\t\t\t\t\t\tatom('atom:' + id, this.schema.validateRecord(this, record, 'initialize', null)),\n\t\t\t\t\t])\n\t\t\t\t)\n\t\t\t)\n\t\t}\n\n\t\tthis.historyReactor = reactor(\n\t\t\t'Store.historyReactor',\n\t\t\t() => {\n\t\t\t\t// deref to make sure we're subscribed regardless of whether we need to propagate\n\t\t\t\tthis.history.value\n\t\t\t\t// If we have accumulated history, flush it and update listeners\n\t\t\t\tthis._flushHistory()\n\t\t\t},\n\t\t\t{ scheduleEffect: (cb) => requestAnimationFrame(cb) }\n\t\t)\n\t}\n\n\tpublic _flushHistory() {\n\t\t// If we have accumulated history, flush it and update listeners\n\t\tif (this.historyAccumulator.hasChanges()) {\n\t\t\tconst entries = this.historyAccumulator.flush()\n\t\t\tfor (const { changes, source } of entries) {\n\t\t\t\tthis.listeners.forEach((l) => l({ changes, source }))\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Update the history with a diff of changes.\n\t *\n\t * @param changes - The changes to add to the history.\n\t */\n\tprivate updateHistory(changes: RecordsDiff<R>): void {\n\t\tthis.historyAccumulator.add({\n\t\t\tchanges,\n\t\t\tsource: this.isMergingRemoteChanges ? 'remote' : 'user',\n\t\t})\n\t\tif (this.listeners.size === 0) {\n\t\t\tthis.historyAccumulator.clear()\n\t\t}\n\t\tthis.history.set(this.history.value + 1, changes)\n\t}\n\n\tvalidate(phase: 'initialize' | 'createRecord' | 'updateRecord' | 'tests') {\n\t\tthis.allRecords().forEach((record) => this.schema.validateRecord(this, record, phase, null))\n\t}\n\n\t/**\n\t * A callback fired after a record is created. Use this to perform\n\t * related updates to other records in the store.\n\t *\n\t * @param record - The record to be created\n\t */\n\tonAfterCreate?: (record: R) => void\n\n\t/**\n\t * A callback fired after each record's change.\n\t *\n\t * @param prev - The previous value, if any.\n\t * @param next - The next value.\n\t */\n\tonAfterChange?: (prev: R, next: R) => void\n\n\t/**\n\t * A callback fired before a record is deleted.\n\t *\n\t * @param prev - The record that will be deleted.\n\t */\n\tonBeforeDelete?: (prev: R) => void\n\n\t/**\n\t * A callback fired after a record is deleted.\n\t *\n\t * @param prev - The record that will be deleted.\n\t */\n\tonAfterDelete?: (prev: R) => void\n\n\t// used to avoid running callbacks when rolling back changes in sync client\n\tprivate _runCallbacks = true\n\n\t/**\n\t * Add some records to the store. It's an error if they already exist.\n\t *\n\t * @param records - The records to add.\n\t * @public\n\t */\n\tput = (records: R[], phaseOverride?: 'initialize'): void => {\n\t\ttransact(() => {\n\t\t\tconst updates: Record<ID<R>, [from: R, to: R]> = {}\n\t\t\tconst additions: Record<ID<R>, R> = {}\n\n\t\t\tconst currentMap = this.atoms.__unsafe__getWithoutCapture()\n\t\t\tlet map = null as null | Record<ID<R>, Atom<R>>\n\n\t\t\t// Iterate through all records, creating, updating or removing as needed\n\t\t\tlet record: R\n\n\t\t\t// There's a chance that, despite having records, all of the values are\n\t\t\t// identical to what they were before; and so we'd end up with an \"empty\"\n\t\t\t// history entry. Let's keep track of whether we've actually made any\n\t\t\t// changes (e.g. additions, deletions, or updates that produce a new value).\n\t\t\tlet didChange = false\n\n\t\t\tfor (let i = 0, n = records.length; i < n; i++) {\n\t\t\t\trecord = records[i]\n\n\t\t\t\tconst recordAtom = (map ?? currentMap)[record.id]\n\n\t\t\t\tif (recordAtom) {\n\t\t\t\t\t// If we already have an atom for this record, update its value.\n\n\t\t\t\t\tconst initialValue = recordAtom.__unsafe__getWithoutCapture()\n\n\t\t\t\t\t// Validate the record\n\t\t\t\t\trecord = this.schema.validateRecord(\n\t\t\t\t\t\tthis,\n\t\t\t\t\t\trecord,\n\t\t\t\t\t\tphaseOverride ?? 'updateRecord',\n\t\t\t\t\t\tinitialValue\n\t\t\t\t\t)\n\n\t\t\t\t\trecordAtom.set(devFreeze(record))\n\n\t\t\t\t\t// need to deref atom in case nextValue is not identical but is .equals?\n\t\t\t\t\tconst finalValue = recordAtom.__unsafe__getWithoutCapture()\n\n\t\t\t\t\t// If the value has changed, assign it to updates.\n\t\t\t\t\tif (initialValue !== finalValue) {\n\t\t\t\t\t\tdidChange = true\n\t\t\t\t\t\tupdates[record.id] = [initialValue, finalValue]\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tdidChange = true\n\n\t\t\t\t\t// If we don't have an atom, create one.\n\n\t\t\t\t\t// Validate the record\n\t\t\t\t\trecord = this.schema.validateRecord(\n\t\t\t\t\t\tthis,\n\t\t\t\t\t\trecord as R,\n\t\t\t\t\t\tphaseOverride ?? 'createRecord',\n\t\t\t\t\t\tnull\n\t\t\t\t\t)\n\n\t\t\t\t\t// Mark the change as a new addition.\n\t\t\t\t\tadditions[record.id] = record\n\n\t\t\t\t\t// Assign the atom to the map under the record's id.\n\t\t\t\t\tif (!map) {\n\t\t\t\t\t\tmap = { ...currentMap }\n\t\t\t\t\t}\n\t\t\t\t\tmap[record.id] = atom('atom:' + record.id, record)\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Set the map of atoms to the store.\n\t\t\tif (map) {\n\t\t\t\tthis.atoms.set(map)\n\t\t\t}\n\n\t\t\t// If we did change, update the history\n\t\t\tif (!didChange) return\n\t\t\tthis.updateHistory({\n\t\t\t\tadded: additions,\n\t\t\t\tupdated: updates,\n\t\t\t\tremoved: {},\n\t\t\t})\n\n\t\t\tconst { onAfterCreate, onAfterChange } = this\n\n\t\t\tif (onAfterCreate && this._runCallbacks) {\n\t\t\t\t// Run the onAfterChange callback for addition.\n\t\t\t\tObject.values(additions).forEach((record) => {\n\t\t\t\t\tonAfterCreate(record)\n\t\t\t\t})\n\t\t\t}\n\n\t\t\tif (onAfterChange && this._runCallbacks) {\n\t\t\t\t// Run the onAfterChange callback for update.\n\t\t\t\tObject.values(updates).forEach(([from, to]) => {\n\t\t\t\t\tonAfterChange(from, to)\n\t\t\t\t})\n\t\t\t}\n\t\t})\n\t}\n\n\t/**\n\t * Remove some records from the store via their ids.\n\t *\n\t * @param ids - The ids of the records to remove.\n\t * @public\n\t */\n\tremove = (ids: ID<R>[]): void => {\n\t\ttransact(() => {\n\t\t\tif (this.onBeforeDelete && this._runCallbacks) {\n\t\t\t\tfor (const id of ids) {\n\t\t\t\t\tconst atom = this.atoms.__unsafe__getWithoutCapture()[id]\n\t\t\t\t\tif (!atom) continue\n\n\t\t\t\t\tthis.onBeforeDelete(atom.value)\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlet removed = undefined as undefined | RecordsDiff<R>['removed']\n\n\t\t\t// For each map in our atoms, remove the ids that we are removing.\n\t\t\tthis.atoms.update((atoms) => {\n\t\t\t\tlet result: typeof atoms | undefined = undefined\n\n\t\t\t\tfor (const id of ids) {\n\t\t\t\t\tif (!(id in atoms)) continue\n\t\t\t\t\tif (!result) result = { ...atoms }\n\t\t\t\t\tif (!removed) removed = {}\n\t\t\t\t\tdelete result[id]\n\t\t\t\t\tremoved[id] = atoms[id].value\n\t\t\t\t}\n\n\t\t\t\treturn result ?? atoms\n\t\t\t})\n\n\t\t\tif (!removed) return\n\t\t\t// Update the history with the removed records.\n\t\t\tthis.updateHistory({ added: {}, updated: {}, removed })\n\n\t\t\t// If we have an onAfterChange, run it for each removed record.\n\t\t\tif (this.onAfterDelete && this._runCallbacks) {\n\t\t\t\tfor (let i = 0, n = ids.length; i < n; i++) {\n\t\t\t\t\tthis.onAfterDelete(removed[ids[i]])\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\t}\n\n\t/**\n\t * Get the value of a store record by its id.\n\t *\n\t * @param id - The id of the record to get.\n\t * @public\n\t */\n\tget = <K extends ID<R>>(id: K): RecFromId<K> | undefined => {\n\t\treturn this.atoms.value[id]?.value as any\n\t}\n\n\t/**\n\t * Get the value of a store record by its id without updating its epoch.\n\t *\n\t * @param id - The id of the record to get.\n\t * @public\n\t */\n\tunsafeGetWithoutCapture = <K extends ID<R>>(id: K): RecFromId<K> | undefined => {\n\t\treturn this.atoms.value[id]?.__unsafe__getWithoutCapture() as any\n\t}\n\n\t/**\n\t * Opposite of `deserialize`. Creates a JSON payload from the record store.\n\t *\n\t * @param filter - A function to filter structs that do not satisfy the predicate.\n\t * @returns The record store snapshot as a JSON payload.\n\t */\n\tserialize = (filter?: (record: R) => boolean): StoreSnapshot<R> => {\n\t\tconst result: Record<string, any> = {}\n\t\tfor (const [id, atom] of Object.entries(this.atoms.value)) {\n\t\t\tconst record = atom.value\n\t\t\tif (typeof filter === 'function' && !filter(record)) continue\n\t\t\tresult[id] = record\n\t\t}\n\t\treturn result\n\t}\n\n\t/**\n\t * Opposite of `serialize`. Replace the store's current records with records as defined by a simple JSON structure into the stores.\n\t *\n\t * @param snapshot - The JSON snapshot to deserialize.\n\t * @public\n\t */\n\tdeserialize = (snapshot: StoreSnapshot<R>): void => {\n\t\ttransact(() => {\n\t\t\tthis.clear()\n\t\t\tthis.put(Object.values(snapshot))\n\t\t})\n\t}\n\n\t/**\n\t * Get an array of all values in the store.\n\t *\n\t * @public\n\t * @returns An array of all values in the store.\n\t */\n\tallRecords = (): R[] => {\n\t\treturn Object.values(this.atoms.value).map((atom) => atom.value)\n\t}\n\n\t/**\n\t * Removes all records from the store.\n\t *\n\t * @public\n\t */\n\tclear = (): void => {\n\t\tthis.remove(Object.keys(this.atoms.value) as any)\n\t}\n\n\t/**\n\t * Update a record. To update multiple records at once, use the `update` method of the `TypedStore` class.\n\t *\n\t * @param id - The id of the record to update.\n\t * @param updater - A function that updates the record.\n\t */\n\tupdate = <K extends ID<R>>(id: K, updater: (record: RecFromId<K>) => RecFromId<K>) => {\n\t\tconst atom = this.atoms.value[id]\n\t\tif (!atom) {\n\t\t\tconsole.error(`Record ${id} not found. This is probably an error`)\n\t\t\treturn\n\t\t}\n\t\tthis.put([updater(atom.__unsafe__getWithoutCapture() as any as RecFromId<K>) as any])\n\t}\n\n\t/**\n\t * Get whether the record store has a id.\n\t *\n\t * @param id - The id of the record to check.\n\t * @public\n\t */\n\thas = <K extends ID<R>>(id: K): boolean => {\n\t\treturn !!this.atoms.value[id]\n\t}\n\n\t/**\n\t * Add a new listener to the store.\n\t *\n\t * @param listener - The listener to call when the store updates.\n\t * @returns A function to remove the listener.\n\t */\n\tlisten = (listener: StoreListener<R>) => {\n\t\t// flush history so that this listener's history starts from exactly now\n\t\tthis._flushHistory()\n\n\t\tthis.listeners.add(listener)\n\n\t\tif (!this.historyReactor.scheduler.isActivelyListening) {\n\t\t\tthis.historyReactor.start()\n\t\t}\n\n\t\treturn () => {\n\t\t\tthis.listeners.delete(listener)\n\n\t\t\tif (this.listeners.size === 0) {\n\t\t\t\tthis.historyReactor.stop()\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate isMergingRemoteChanges = false\n\n\t/**\n\t * Merge changes from a remote source without triggering listeners.\n\t *\n\t * @param fn - A function that merges the external changes.\n\t * @public\n\t */\n\tmergeRemoteChanges = (fn: () => void) => {\n\t\tif (this.isMergingRemoteChanges) {\n\t\t\treturn fn()\n\t\t}\n\n\t\ttry {\n\t\t\tthis.isMergingRemoteChanges = true\n\t\t\ttransact(fn)\n\t\t} finally {\n\t\t\tthis.isMergingRemoteChanges = false\n\t\t}\n\t}\n\n\textractingChanges(fn: () => void): RecordsDiff<R> {\n\t\tconst changes: Array<RecordsDiff<R>> = []\n\t\tconst dispose = this.historyAccumulator.intercepting((entry) => changes.push(entry.changes))\n\t\ttry {\n\t\t\ttransact(fn)\n\t\t\treturn squashRecordDiffs(changes)\n\t\t} finally {\n\t\t\tdispose()\n\t\t}\n\t}\n\n\tapplyDiff(diff: RecordsDiff<R>, runCallbacks = true) {\n\t\tconst prevRunCallbacks = this._runCallbacks\n\t\ttry {\n\t\t\tthis._runCallbacks = runCallbacks\n\t\t\ttransact(() => {\n\t\t\t\tconst toPut = Object.values(diff.added).concat(\n\t\t\t\t\tObject.values(diff.updated).map(([_from, to]) => to)\n\t\t\t\t)\n\t\t\t\tconst toRemove = Object.keys(diff.removed) as ID<R>[]\n\t\t\t\tif (toPut.length) {\n\t\t\t\t\tthis.put(toPut)\n\t\t\t\t}\n\t\t\t\tif (toRemove.length) {\n\t\t\t\t\tthis.remove(toRemove)\n\t\t\t\t}\n\t\t\t})\n\t\t} finally {\n\t\t\tthis._runCallbacks = prevRunCallbacks\n\t\t}\n\t}\n\n\t/**\n\t * Create a computed cache.\n\t *\n\t * @param name - The name of the derivation cache.\n\t * @param derive - A function used to derive the value of the cache.\n\t * @public\n\t */\n\tcreateComputedCache = <T, V extends R = R>(\n\t\tname: string,\n\t\tderive: (record: V) => T | undefined\n\t): ComputedCache<T, V> => {\n\t\tconst cache = new Cache<Atom<any>, Computed<T | undefined>>()\n\t\treturn {\n\t\t\tget: (id: ID<V>) => {\n\t\t\t\tconst atom = this.atoms.value[id]\n\t\t\t\tif (!atom) {\n\t\t\t\t\treturn undefined\n\t\t\t\t}\n\t\t\t\treturn cache.get(atom, () =>\n\t\t\t\t\tcomputed<T | undefined>(name + ':' + id, () => derive(atom.value as V))\n\t\t\t\t).value\n\t\t\t},\n\t\t}\n\t}\n\n\t/**\n\t * Create a computed cache from a selector\n\t *\n\t * @param name - The name of the derivation cache.\n\t * @param selector - A function that returns a subset of the original shape\n\t * @param derive - A function used to derive the value of the cache.\n\t * @public\n\t */\n\tcreateSelectedComputedCache = <T, J, V extends R = R>(\n\t\tname: string,\n\t\tselector: (record: V) => T | undefined,\n\t\tderive: (input: T) => J | undefined\n\t): ComputedCache<J, V> => {\n\t\tconst cache = new Cache<Atom<any>, Computed<J | undefined>>()\n\t\treturn {\n\t\t\tget: (id: ID<V>) => {\n\t\t\t\tconst atom = this.atoms.value[id]\n\t\t\t\tif (!atom) {\n\t\t\t\t\treturn undefined\n\t\t\t\t}\n\n\t\t\t\tconst d = computed<T | undefined>(name + ':' + id + ':selector', () =>\n\t\t\t\t\tselector(atom.value as V)\n\t\t\t\t)\n\t\t\t\treturn cache.get(atom, () =>\n\t\t\t\t\tcomputed<J | undefined>(name + ':' + id, () => derive(d.value as T))\n\t\t\t\t).value\n\t\t\t},\n\t\t}\n\t}\n\n\t/** @internal */\n\tensureStoreIsUsable() {\n\t\tthis.schema.ensureStoreIsUsable(this)\n\t}\n\n\tprivate _isPossiblyCorrupted = false\n\t/** @internal */\n\tmarkAsPossiblyCorrupted() {\n\t\tthis._isPossiblyCorrupted = true\n\t}\n\t/** @internal */\n\tisPossiblyCorrupted() {\n\t\treturn this._isPossiblyCorrupted\n\t}\n}\n\n/**\n * Squash a collection of diffs into a single diff.\n *\n * @param diffs - An array of diffs to squash.\n * @returns A single diff that represents the squashed diffs.\n * @public\n */\nexport function squashRecordDiffs<T extends BaseRecord>(diffs: RecordsDiff<T>[]): RecordsDiff<T> {\n\tconst result: RecordsDiff<T> = { added: {}, removed: {}, updated: {} }\n\n\tfor (const diff of diffs) {\n\t\tfor (const [id, value] of Object.entries(diff.added)) {\n\t\t\tif (result.removed[id]) {\n\t\t\t\tconst original = result.removed[id]\n\t\t\t\tdelete result.removed[id]\n\t\t\t\tif (original !== value) {\n\t\t\t\t\tresult.updated[id] = [original, value]\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tresult.added[id] = value\n\t\t\t}\n\t\t}\n\n\t\tfor (const [id, [_from, to]] of Object.entries(diff.updated)) {\n\t\t\tif (result.added[id]) {\n\t\t\t\tresult.added[id] = to\n\t\t\t\tdelete result.updated[id]\n\t\t\t\tdelete result.removed[id]\n\t\t\t\tcontinue\n\t\t\t}\n\t\t\tif (result.updated[id]) {\n\t\t\t\tresult.updated[id][1] = to\n\t\t\t\tdelete result.removed[id]\n\t\t\t\tcontinue\n\t\t\t}\n\n\t\t\tresult.updated[id] = diff.updated[id]\n\t\t\tdelete result.removed[id]\n\t\t}\n\n\t\tfor (const [id, value] of Object.entries(diff.removed)) {\n\t\t\t// the same record was added in this diff sequence, just drop it\n\t\t\tif (result.added[id]) {\n\t\t\t\tdelete result.added[id]\n\t\t\t} else if (result.updated[id]) {\n\t\t\t\tresult.removed[id] = result.updated[id][0]\n\t\t\t\tdelete result.updated[id]\n\t\t\t} else {\n\t\t\t\tresult.removed[id] = value\n\t\t\t}\n\t\t}\n\t}\n\n\treturn result\n}\n\n/**\n * Collect all history entries by their sources.\n *\n * @param entries - The array of history entries.\n * @returns A map of history entries by their sources.\n * @public\n */\nfunction squashHistoryEntries<T extends BaseRecord>(entries: HistoryEntry<T>[]): HistoryEntry<T>[] {\n\tconst result: HistoryEntry<T>[] = []\n\n\tlet current = entries[0]\n\tlet entry: HistoryEntry<T>\n\n\tfor (let i = 1, n = entries.length; i < n; i++) {\n\t\tentry = entries[i]\n\n\t\tif (current.source !== entry.source) {\n\t\t\tresult.push(current)\n\t\t\tcurrent = entry\n\t\t} else {\n\t\t\tcurrent = {\n\t\t\t\tsource: current.source,\n\t\t\t\tchanges: squashRecordDiffs([current.changes, entry.changes]),\n\t\t\t}\n\t\t}\n\t}\n\n\tresult.push(current)\n\n\treturn result\n}\n\n/** @public */\nexport function reverseRecordsDiff(diff: RecordsDiff<any>) {\n\tconst result: RecordsDiff<any> = { added: diff.removed, removed: diff.added, updated: {} }\n\tfor (const [from, to] of Object.values(diff.updated)) {\n\t\tresult.updated[from.id] = [to, from]\n\t}\n\treturn result\n}\n\nclass HistoryAccumulator<T extends BaseRecord> {\n\tprivate _history: HistoryEntry<T>[] = []\n\n\tprivate _inteceptors: Set<(entry: HistoryEntry<T>) => void> = new Set()\n\n\tintercepting(fn: (entry: HistoryEntry<T>) => void) {\n\t\tthis._inteceptors.add(fn)\n\t\treturn () => {\n\t\t\tthis._inteceptors.delete(fn)\n\t\t}\n\t}\n\n\tadd(entry: HistoryEntry<T>) {\n\t\tthis._history.push(entry)\n\t\tfor (const interceptor of this._inteceptors) {\n\t\t\tinterceptor(entry)\n\t\t}\n\t}\n\n\tflush() {\n\t\tconst history = squashHistoryEntries(this._history)\n\t\tthis._history = []\n\t\treturn history\n\t}\n\n\tclear() {\n\t\tthis._history = []\n\t}\n\n\thasChanges() {\n\t\treturn this._history.length > 0\n\t}\n\n\t/**\n\t * Ensure that the store is usable. A class that extends this store should override this method.\n\t *\n\t * @param config - The configuration object. This can be any object that allows the store to validate that it is usable; the extending class should specify the type.\n\t *\n\t * @public\n\t */\n\tensureStoreIsUsable(_config = {} as any): void {\n\t\treturn\n\t}\n}\n","import objectWithoutPropertiesLoose from \"./objectWithoutPropertiesLoose.js\";\nexport default function _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n  var target = objectWithoutPropertiesLoose(source, excluded);\n  var key, i;\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n  return target;\n}","export default function _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n  return target;\n}","import { BaseRecord, isRecord } from './BaseRecord'\nimport { SerializedSchema } from './StoreSchema'\n\n/** @public */\nexport function defineMigrations<FirstVersion extends number, CurrentVersion extends number>({\n\tfirstVersion,\n\tcurrentVersion,\n\tmigrators,\n\tsubTypeKey,\n\tsubTypeMigrations,\n}: {\n\tfirstVersion: FirstVersion\n\tcurrentVersion: CurrentVersion\n\tmigrators: {\n\t\t[version in Exclude<Range<FirstVersion, CurrentVersion>, FirstVersion>]: Migration\n\t}\n\tsubTypeKey?: string\n\tsubTypeMigrations?: Record<string, BaseMigrationsInfo>\n}): Migrations {\n\treturn { currentVersion, firstVersion, migrators, subTypeKey, subTypeMigrations }\n}\n\n/** @public */\nexport type Migration<T = any> = {\n\tup: (oldState: T) => T\n\tdown: (newState: T) => T\n}\n\ninterface BaseMigrationsInfo {\n\tfirstVersion: number\n\tcurrentVersion: number\n\tmigrators: { [version: number]: Migration }\n}\n\n/** @public */\nexport interface Migrations extends BaseMigrationsInfo {\n\tsubTypeKey?: string\n\tsubTypeMigrations?: Record<string, BaseMigrationsInfo>\n}\n\n/** @public */\nexport type MigrationResult<T> =\n\t| { type: 'success'; value: T }\n\t| { type: 'error'; reason: MigrationFailureReason }\n\n/** @public */\nexport enum MigrationFailureReason {\n\tIncompatibleSubtype = 'incompatible-subtype',\n\tUnknownType = 'unknown-type',\n\tTargetVersionTooNew = 'target-version-too-new',\n\tTargetVersionTooOld = 'target-version-too-old',\n\tMigrationError = 'migration-error',\n\tUnrecognizedSubtype = 'unrecognized-subtype',\n}\n\n/** @public */\nexport type RecordVersion = { rootVersion: number; subTypeVersion?: number }\n/** @public */\nexport function getRecordVersion(\n\trecord: BaseRecord,\n\tserializedSchema: SerializedSchema\n): RecordVersion {\n\tconst persistedType = serializedSchema.recordVersions[record.typeName]\n\tif (!persistedType) {\n\t\treturn { rootVersion: 0 }\n\t}\n\tif ('subTypeKey' in persistedType) {\n\t\tconst subType = record[persistedType.subTypeKey as keyof typeof record]\n\t\tconst subTypeVersion = persistedType.subTypeVersions[subType]\n\t\treturn { rootVersion: persistedType.version, subTypeVersion }\n\t}\n\treturn { rootVersion: persistedType.version }\n}\n\n/** @public */\nexport function compareRecordVersions(a: RecordVersion, b: RecordVersion) {\n\tif (a.rootVersion > b.rootVersion) {\n\t\treturn 1\n\t}\n\tif (a.rootVersion < b.rootVersion) {\n\t\treturn -1\n\t}\n\tif (a.subTypeVersion != null && b.subTypeVersion != null) {\n\t\tif (a.subTypeVersion > b.subTypeVersion) {\n\t\t\treturn 1\n\t\t}\n\t\tif (a.subTypeVersion < b.subTypeVersion) {\n\t\t\treturn -1\n\t\t}\n\t}\n\treturn 0\n}\n\n/** @public */\nexport function migrateRecord<R extends BaseRecord>({\n\trecord,\n\tmigrations,\n\tfromVersion,\n\ttoVersion,\n}: {\n\trecord: unknown\n\tmigrations: Migrations\n\tfromVersion: number\n\ttoVersion: number\n}): MigrationResult<R> {\n\tlet currentVersion = fromVersion\n\tif (!isRecord(record)) throw new Error('[migrateRecord] object is not a record')\n\tconst { typeName, id, ...others } = record\n\tlet recordWithoutMeta = others\n\n\twhile (currentVersion < toVersion) {\n\t\tconst nextVersion = currentVersion + 1\n\t\tconst migrator = migrations.migrators[nextVersion]\n\t\tif (!migrator) {\n\t\t\treturn {\n\t\t\t\ttype: 'error',\n\t\t\t\treason: MigrationFailureReason.TargetVersionTooNew,\n\t\t\t}\n\t\t}\n\t\trecordWithoutMeta = migrator.up(recordWithoutMeta) as any\n\t\tcurrentVersion = nextVersion\n\t}\n\n\twhile (currentVersion > toVersion) {\n\t\tconst nextVersion = currentVersion - 1\n\t\tconst migrator = migrations.migrators[currentVersion]\n\t\tif (!migrator) {\n\t\t\treturn {\n\t\t\t\ttype: 'error',\n\t\t\t\treason: MigrationFailureReason.TargetVersionTooOld,\n\t\t\t}\n\t\t}\n\t\trecordWithoutMeta = migrator.down(recordWithoutMeta) as any\n\t\tcurrentVersion = nextVersion\n\t}\n\n\treturn {\n\t\ttype: 'success',\n\t\tvalue: { ...recordWithoutMeta, id, typeName } as any,\n\t}\n}\n\n/** @public */\nexport function migrate<T>({\n\tvalue,\n\tmigrations,\n\tfromVersion,\n\ttoVersion,\n}: {\n\tvalue: unknown\n\tmigrations: Migrations\n\tfromVersion: number\n\ttoVersion: number\n}): MigrationResult<T> {\n\tlet currentVersion = fromVersion\n\n\twhile (currentVersion < toVersion) {\n\t\tconst nextVersion = currentVersion + 1\n\t\tconst migrator = migrations.migrators[nextVersion]\n\t\tif (!migrator) {\n\t\t\treturn {\n\t\t\t\ttype: 'error',\n\t\t\t\treason: MigrationFailureReason.TargetVersionTooNew,\n\t\t\t}\n\t\t}\n\t\tvalue = migrator.up(value)\n\t\tcurrentVersion = nextVersion\n\t}\n\n\twhile (currentVersion > toVersion) {\n\t\tconst nextVersion = currentVersion - 1\n\t\tconst migrator = migrations.migrators[currentVersion]\n\t\tif (!migrator) {\n\t\t\treturn {\n\t\t\t\ttype: 'error',\n\t\t\t\treason: MigrationFailureReason.TargetVersionTooOld,\n\t\t\t}\n\t\t}\n\t\tvalue = migrator.down(value)\n\t\tcurrentVersion = nextVersion\n\t}\n\n\treturn {\n\t\ttype: 'success',\n\t\tvalue: value as T,\n\t}\n}\n\ntype Range<From extends number, To extends number> = To extends From\n\t? From\n\t: To | Range<From, Decrement<To>>\n\ntype Decrement<n extends number> = n extends 0\n\t? never\n\t: n extends 1\n\t? 0\n\t: n extends 2\n\t? 1\n\t: n extends 3\n\t? 2\n\t: n extends 4\n\t? 3\n\t: n extends 5\n\t? 4\n\t: n extends 6\n\t? 5\n\t: n extends 7\n\t? 6\n\t: n extends 8\n\t? 7\n\t: n extends 9\n\t? 8\n\t: n extends 10\n\t? 9\n\t: n extends 11\n\t? 10\n\t: n extends 12\n\t? 11\n\t: n extends 13\n\t? 12\n\t: n extends 14\n\t? 13\n\t: n extends 15\n\t? 14\n\t: n extends 16\n\t? 15\n\t: n extends 17\n\t? 16\n\t: n extends 18\n\t? 17\n\t: n extends 19\n\t? 18\n\t: n extends 20\n\t? 19\n\t: n extends 21\n\t? 20\n\t: n extends 22\n\t? 21\n\t: n extends 23\n\t? 22\n\t: n extends 24\n\t? 23\n\t: n extends 25\n\t? 24\n\t: n extends 26\n\t? 25\n\t: n extends 27\n\t? 26\n\t: n extends 28\n\t? 27\n\t: n extends 29\n\t? 28\n\t: n extends 30\n\t? 29\n\t: n extends 31\n\t? 30\n\t: n extends 32\n\t? 31\n\t: n extends 33\n\t? 32\n\t: n extends 34\n\t? 33\n\t: n extends 35\n\t? 34\n\t: n extends 36\n\t? 35\n\t: n extends 37\n\t? 36\n\t: n extends 38\n\t? 37\n\t: n extends 39\n\t? 38\n\t: n extends 40\n\t? 39\n\t: n extends 41\n\t? 40\n\t: n extends 42\n\t? 41\n\t: n extends 43\n\t? 42\n\t: n extends 44\n\t? 43\n\t: n extends 45\n\t? 44\n\t: n extends 46\n\t? 45\n\t: n extends 47\n\t? 46\n\t: n extends 48\n\t? 47\n\t: n extends 49\n\t? 48\n\t: n extends 50\n\t? 49\n\t: n extends 51\n\t? 50\n\t: never\n","/** @public */\nexport type ID<R extends BaseRecord = BaseRecord> = string & { __type__: R }\n\n/**\n * The base record that all records must extend.\n * @public\n */\nexport interface BaseRecord<TypeName extends string = string> {\n\treadonly id: ID<this>\n\treadonly typeName: TypeName\n}\n\nexport type OmitMeta<R extends BaseRecord> = R extends R ? Omit<R, 'id' | 'typeName'> : R\n\nexport function isRecord(record: unknown): record is BaseRecord {\n\treturn typeof record === 'object' && record !== null && 'id' in record && 'typeName' in record\n}\n","import { getOwnProperty, objectMapValues } from '@tldraw/utils'\nimport { BaseRecord } from './BaseRecord'\nimport { RecordType } from './RecordType'\nimport { Store, StoreSnapshot } from './Store'\nimport {\n\tMigrationFailureReason,\n\tMigrationResult,\n\tMigrations,\n\tmigrate,\n\tmigrateRecord,\n} from './migrate'\n\n/** @public */\nexport interface SerializedSchema {\n\t/**\n\t * Schema version is the version for this type you're looking at right now\n\t */\n\tschemaVersion: number\n\t/**\n\t * Store version is the version for the structure of the store. e.g. higher level\n\t * structure like removing or renaming a record type.\n\t */\n\tstoreVersion: number\n\t/**\n\t * Record versions are the versions for each record type. e.g. adding a new field to a record\n\t */\n\trecordVersions: Record<\n\t\tstring,\n\t\t| {\n\t\t\t\tversion: number\n\t\t  }\n\t\t| {\n\t\t\t\t// subtypes are used for migrating shape and asset props\n\t\t\t\tversion: number\n\t\t\t\tsubTypeVersions: Record<string, number>\n\t\t\t\tsubTypeKey: string\n\t\t  }\n\t>\n}\n\n/** @public */\nexport type StoreSchemaOptions<R extends BaseRecord, P> = {\n\t/** @public */\n\tsnapshotMigrations?: Migrations\n\t/** @public */\n\tonValidationFailure?: (data: {\n\t\terror: unknown\n\t\tstore: Store<R>\n\t\trecord: R\n\t\tphase: 'initialize' | 'createRecord' | 'updateRecord' | 'tests'\n\t\trecordBefore: R | null\n\t}) => R\n\t/** @internal */\n\tensureStoreIsUsable?: (store: Store<R, P>) => void\n}\n\n/** @public */\nexport class StoreSchema<R extends BaseRecord, P = unknown> {\n\tstatic create<R extends BaseRecord, P = unknown>(\n\t\t// HACK: making this param work with RecordType is an enormous pain\n\t\t// let's just settle for making sure each typeName has a corresponding RecordType\n\t\t// and accept that this function won't be able to infer the record type from it's arguments\n\t\ttypes: { [TypeName in R['typeName']]: { createId: any } },\n\t\toptions?: StoreSchemaOptions<R, P>\n\t): StoreSchema<R, P> {\n\t\treturn new StoreSchema<R, P>(types as any, options ?? {})\n\t}\n\n\tprivate constructor(\n\t\tpublic readonly types: {\n\t\t\t[Record in R as Record['typeName']]: RecordType<R, any>\n\t\t},\n\t\tprivate readonly options: StoreSchemaOptions<R, P>\n\t) {}\n\n\tget currentStoreVersion(): number {\n\t\treturn this.options.snapshotMigrations?.currentVersion ?? 0\n\t}\n\n\tvalidateRecord(\n\t\tstore: Store<R>,\n\t\trecord: R,\n\t\tphase: 'initialize' | 'createRecord' | 'updateRecord' | 'tests',\n\t\trecordBefore: R | null\n\t): R {\n\t\ttry {\n\t\t\tconst recordType = getOwnProperty(this.types, record.typeName)\n\t\t\tif (!recordType) {\n\t\t\t\tthrow new Error(`Missing definition for record type ${record.typeName}`)\n\t\t\t}\n\t\t\treturn recordType.validate(record)\n\t\t} catch (error: unknown) {\n\t\t\tif (this.options.onValidationFailure) {\n\t\t\t\treturn this.options.onValidationFailure({\n\t\t\t\t\tstore,\n\t\t\t\t\trecord,\n\t\t\t\t\tphase,\n\t\t\t\t\trecordBefore,\n\t\t\t\t\terror,\n\t\t\t\t})\n\t\t\t} else {\n\t\t\t\tthrow error\n\t\t\t}\n\t\t}\n\t}\n\n\tmigratePersistedRecord(\n\t\trecord: R,\n\t\tpersistedSchema: SerializedSchema,\n\t\tdirection: 'up' | 'down' = 'up'\n\t): MigrationResult<R> {\n\t\tconst ourType = getOwnProperty(this.types, record.typeName)\n\t\tconst persistedType = persistedSchema.recordVersions[record.typeName]\n\t\tif (!persistedType || !ourType) {\n\t\t\treturn { type: 'error', reason: MigrationFailureReason.UnknownType }\n\t\t}\n\t\tconst ourVersion = ourType.migrations.currentVersion\n\t\tconst persistedVersion = persistedType.version\n\t\tif (ourVersion !== persistedVersion) {\n\t\t\tconst result =\n\t\t\t\tdirection === 'up'\n\t\t\t\t\t? migrateRecord<R>({\n\t\t\t\t\t\t\trecord,\n\t\t\t\t\t\t\tmigrations: ourType.migrations,\n\t\t\t\t\t\t\tfromVersion: persistedVersion,\n\t\t\t\t\t\t\ttoVersion: ourVersion,\n\t\t\t\t\t  })\n\t\t\t\t\t: migrateRecord<R>({\n\t\t\t\t\t\t\trecord,\n\t\t\t\t\t\t\tmigrations: ourType.migrations,\n\t\t\t\t\t\t\tfromVersion: ourVersion,\n\t\t\t\t\t\t\ttoVersion: persistedVersion,\n\t\t\t\t\t  })\n\t\t\tif (result.type === 'error') {\n\t\t\t\treturn result\n\t\t\t}\n\t\t\trecord = result.value\n\t\t}\n\n\t\tif (!ourType.migrations.subTypeKey) {\n\t\t\treturn { type: 'success', value: record }\n\t\t}\n\n\t\t// we've handled the main version migration, now we need to handle subtypes\n\t\t// subtypes are used by shape and asset types to migrate the props shape, which is configurable\n\t\t// by library consumers.\n\n\t\tconst ourSubTypeMigrations =\n\t\t\tourType.migrations.subTypeMigrations?.[\n\t\t\t\trecord[ourType.migrations.subTypeKey as keyof R] as string\n\t\t\t]\n\n\t\tconst persistedSubTypeVersion =\n\t\t\t'subTypeVersions' in persistedType\n\t\t\t\t? persistedType.subTypeVersions[record[ourType.migrations.subTypeKey as keyof R] as string]\n\t\t\t\t: null\n\n\t\t// if ourSubTypeMigrations is undefined then we don't have access to the migrations for this subtype\n\t\t// that is almost certainly because we are running on the server and this type was supplied by a 3rd party.\n\t\t// It could also be that we are running in a client that is outdated. Either way, we can't migrate this record\n\t\t// and we need to let the consumer know so they can handle it.\n\t\tif (ourSubTypeMigrations === undefined) {\n\t\t\treturn { type: 'error', reason: MigrationFailureReason.UnrecognizedSubtype }\n\t\t}\n\n\t\t// if the persistedSubTypeVersion is undefined then the record was either created after the schema\n\t\t// was persisted, or it was created in a different place to where the schema was persisted.\n\t\t// either way we don't know what to do with it safely, so let's return failure.\n\t\tif (persistedSubTypeVersion == null) {\n\t\t\treturn { type: 'error', reason: MigrationFailureReason.IncompatibleSubtype }\n\t\t}\n\n\t\tconst result =\n\t\t\tdirection === 'up'\n\t\t\t\t? migrateRecord<R>({\n\t\t\t\t\t\trecord,\n\t\t\t\t\t\tmigrations: ourSubTypeMigrations,\n\t\t\t\t\t\tfromVersion: persistedSubTypeVersion,\n\t\t\t\t\t\ttoVersion: ourSubTypeMigrations.currentVersion,\n\t\t\t\t  })\n\t\t\t\t: migrateRecord<R>({\n\t\t\t\t\t\trecord,\n\t\t\t\t\t\tmigrations: ourSubTypeMigrations,\n\t\t\t\t\t\tfromVersion: ourSubTypeMigrations.currentVersion,\n\t\t\t\t\t\ttoVersion: persistedSubTypeVersion,\n\t\t\t\t  })\n\n\t\tif (result.type === 'error') {\n\t\t\treturn result\n\t\t}\n\n\t\treturn { type: 'success', value: result.value }\n\t}\n\n\tmigrateStoreSnapshot(\n\t\tstoreSnapshot: StoreSnapshot<R>,\n\t\tpersistedSchema: SerializedSchema\n\t): MigrationResult<StoreSnapshot<R>> {\n\t\tconst migrations = this.options.snapshotMigrations\n\t\tif (!migrations) {\n\t\t\treturn { type: 'success', value: storeSnapshot }\n\t\t}\n\t\t// apply store migrations first\n\t\tconst ourStoreVersion = migrations.currentVersion\n\t\tconst persistedStoreVersion = persistedSchema.storeVersion ?? 0\n\n\t\tif (ourStoreVersion < persistedStoreVersion) {\n\t\t\treturn { type: 'error', reason: MigrationFailureReason.TargetVersionTooOld }\n\t\t}\n\n\t\tif (ourStoreVersion > persistedStoreVersion) {\n\t\t\tconst result = migrate<StoreSnapshot<R>>({\n\t\t\t\tvalue: storeSnapshot,\n\t\t\t\tmigrations,\n\t\t\t\tfromVersion: persistedStoreVersion,\n\t\t\t\ttoVersion: ourStoreVersion,\n\t\t\t})\n\n\t\t\tif (result.type === 'error') {\n\t\t\t\treturn result\n\t\t\t}\n\t\t\tstoreSnapshot = result.value\n\t\t}\n\n\t\tconst updated: R[] = []\n\t\tfor (const r of Object.values(storeSnapshot)) {\n\t\t\tconst result = this.migratePersistedRecord(r, persistedSchema)\n\t\t\tif (result.type === 'error') {\n\t\t\t\treturn result\n\t\t\t} else if (result.value && result.value !== r) {\n\t\t\t\tupdated.push(result.value)\n\t\t\t}\n\t\t}\n\t\tif (updated.length) {\n\t\t\tstoreSnapshot = { ...storeSnapshot }\n\t\t\tfor (const r of updated) {\n\t\t\t\tstoreSnapshot[r.id] = r\n\t\t\t}\n\t\t}\n\t\treturn { type: 'success', value: storeSnapshot }\n\t}\n\n\t/** @internal */\n\tensureStoreIsUsable(store: Store<R, P>): void {\n\t\tthis.options.ensureStoreIsUsable?.(store)\n\t}\n\n\tserialize(): SerializedSchema {\n\t\treturn {\n\t\t\tschemaVersion: 1,\n\t\t\tstoreVersion: this.options.snapshotMigrations?.currentVersion ?? 0,\n\t\t\trecordVersions: Object.fromEntries(\n\t\t\t\tobjectMapValues(this.types).map((type) => [\n\t\t\t\t\ttype.typeName,\n\t\t\t\t\ttype.migrations.subTypeKey && type.migrations.subTypeMigrations\n\t\t\t\t\t\t? {\n\t\t\t\t\t\t\t\tversion: type.migrations.currentVersion,\n\t\t\t\t\t\t\t\tsubTypeKey: type.migrations.subTypeKey,\n\t\t\t\t\t\t\t\tsubTypeVersions: type.migrations.subTypeMigrations\n\t\t\t\t\t\t\t\t\t? Object.fromEntries(\n\t\t\t\t\t\t\t\t\t\t\tObject.entries(type.migrations.subTypeMigrations).map(([k, v]) => [\n\t\t\t\t\t\t\t\t\t\t\t\tk,\n\t\t\t\t\t\t\t\t\t\t\t\tv.currentVersion,\n\t\t\t\t\t\t\t\t\t\t\t])\n\t\t\t\t\t\t\t\t\t  )\n\t\t\t\t\t\t\t\t\t: undefined,\n\t\t\t\t\t\t  }\n\t\t\t\t\t\t: {\n\t\t\t\t\t\t\t\tversion: type.migrations.currentVersion,\n\t\t\t\t\t\t  },\n\t\t\t\t])\n\t\t\t),\n\t\t}\n\t}\n\n\tserializeEarliestVersion(): SerializedSchema {\n\t\treturn {\n\t\t\tschemaVersion: 1,\n\t\t\tstoreVersion: this.options.snapshotMigrations?.firstVersion ?? 0,\n\t\t\trecordVersions: Object.fromEntries(\n\t\t\t\tobjectMapValues(this.types).map((type) => [\n\t\t\t\t\ttype.typeName,\n\t\t\t\t\ttype.migrations.subTypeKey && type.migrations.subTypeMigrations\n\t\t\t\t\t\t? {\n\t\t\t\t\t\t\t\tversion: type.migrations.firstVersion,\n\t\t\t\t\t\t\t\tsubTypeKey: type.migrations.subTypeKey,\n\t\t\t\t\t\t\t\tsubTypeVersions: type.migrations.subTypeMigrations\n\t\t\t\t\t\t\t\t\t? Object.fromEntries(\n\t\t\t\t\t\t\t\t\t\t\tObject.entries(type.migrations.subTypeMigrations).map(([k, v]) => [\n\t\t\t\t\t\t\t\t\t\t\t\tk,\n\t\t\t\t\t\t\t\t\t\t\t\tv.firstVersion,\n\t\t\t\t\t\t\t\t\t\t\t])\n\t\t\t\t\t\t\t\t\t  )\n\t\t\t\t\t\t\t\t\t: undefined,\n\t\t\t\t\t\t  }\n\t\t\t\t\t\t: {\n\t\t\t\t\t\t\t\tversion: type.migrations.firstVersion,\n\t\t\t\t\t\t  },\n\t\t\t\t])\n\t\t\t),\n\t\t}\n\t}\n}\n","import { SerializedSchema } from './StoreSchema'\n\n/** @public */\nexport const compareSchemas = (a: SerializedSchema, b: SerializedSchema): number => {\n\tif (a.schemaVersion > b.schemaVersion) {\n\t\treturn 1\n\t}\n\tif (a.schemaVersion < b.schemaVersion) {\n\t\treturn -1\n\t}\n\tif (a.storeVersion > b.storeVersion) {\n\t\treturn 1\n\t}\n\tif (a.storeVersion < b.storeVersion) {\n\t\treturn -1\n\t}\n\tfor (const key of Object.keys(a.recordVersions)) {\n\t\tconst aRecordVersion = a.recordVersions[key]\n\t\tconst bRecordVersion = b.recordVersions[key]\n\t\tif (aRecordVersion.version > bRecordVersion.version) {\n\t\t\treturn 1\n\t\t}\n\t\tif (aRecordVersion.version < bRecordVersion.version) {\n\t\t\treturn -1\n\t\t}\n\t\tif ('subTypeVersions' in aRecordVersion && !('subTypeVersions' in bRecordVersion)) {\n\t\t\t// todo: this assumes that subtypes were added in an up migration rather than removed. We should probably\n\t\t\t// make sure that in either case the parent version is bumped\n\t\t\treturn 1\n\t\t}\n\n\t\tif (!('subTypeVersions' in aRecordVersion) && 'subTypeVersions' in bRecordVersion) {\n\t\t\t// todo: this assumes that subtypes were added in an up migration rather than removed. We should probably\n\t\t\t// make sure that in either case the parent version is bumped\n\t\t\treturn -1\n\t\t}\n\n\t\tif (!('subTypeVersions' in aRecordVersion) || !('subTypeVersions' in bRecordVersion)) {\n\t\t\t// this will never happen\n\t\t\tcontinue\n\t\t}\n\n\t\tfor (const subType of Object.keys(aRecordVersion.subTypeVersions)) {\n\t\t\tconst aSubTypeVersion = aRecordVersion.subTypeVersions[subType]\n\t\t\tconst bSubTypeVersion = bRecordVersion.subTypeVersions[subType]\n\t\t\tif (aSubTypeVersion > bSubTypeVersion) {\n\t\t\t\treturn 1\n\t\t\t}\n\t\t\tif (aSubTypeVersion < bSubTypeVersion) {\n\t\t\t\treturn -1\n\t\t\t}\n\t\t}\n\t}\n\treturn 0\n}\n","import setPrototypeOf from \"./setPrototypeOf.js\";\nimport isNativeReflectConstruct from \"./isNativeReflectConstruct.js\";\nexport default function _construct(Parent, args, Class) {\n  if (isNativeReflectConstruct()) {\n    _construct = Reflect.construct.bind();\n  } else {\n    _construct = function _construct(Parent, args, Class) {\n      var a = [null];\n      a.push.apply(a, args);\n      var Constructor = Function.bind.apply(Parent, a);\n      var instance = new Constructor();\n      if (Class) setPrototypeOf(instance, Class.prototype);\n      return instance;\n    };\n  }\n  return _construct.apply(null, arguments);\n}","import getPrototypeOf from \"./getPrototypeOf.js\";\nimport setPrototypeOf from \"./setPrototypeOf.js\";\nimport isNativeFunction from \"./isNativeFunction.js\";\nimport construct from \"./construct.js\";\nexport default function _wrapNativeSuper(Class) {\n  var _cache = typeof Map === \"function\" ? new Map() : undefined;\n  _wrapNativeSuper = function _wrapNativeSuper(Class) {\n    if (Class === null || !isNativeFunction(Class)) return Class;\n    if (typeof Class !== \"function\") {\n      throw new TypeError(\"Super expression must either be null or a function\");\n    }\n    if (typeof _cache !== \"undefined\") {\n      if (_cache.has(Class)) return _cache.get(Class);\n      _cache.set(Class, Wrapper);\n    }\n    function Wrapper() {\n      return construct(Class, arguments, getPrototypeOf(this).constructor);\n    }\n    Wrapper.prototype = Object.create(Class.prototype, {\n      constructor: {\n        value: Wrapper,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n    return setPrototypeOf(Wrapper, Class);\n  };\n  return _wrapNativeSuper(Class);\n}","export default function _isNativeFunction(fn) {\n  return Function.toString.call(fn).indexOf(\"[native code]\") !== -1;\n}","import { exhaustiveSwitchError, getOwnProperty, hasOwnProperty } from '@tldraw/utils'\n\n/** @public */\nexport type ValidatorFn<T> = (value: unknown) => T\n\nfunction formatPath(path: ReadonlyArray<number | string>): string | null {\n\tif (!path.length) {\n\t\treturn null\n\t}\n\tlet formattedPath = ''\n\tfor (const item of path) {\n\t\tif (typeof item === 'number') {\n\t\t\tformattedPath += `.${item}`\n\t\t} else if (item.startsWith('(')) {\n\t\t\tif (formattedPath.endsWith(')')) {\n\t\t\t\tformattedPath = `${formattedPath.slice(0, -1)}, ${item.slice(1)}`\n\t\t\t} else {\n\t\t\t\tformattedPath += item\n\t\t\t}\n\t\t} else {\n\t\t\tformattedPath += `.${item}`\n\t\t}\n\t}\n\tif (formattedPath.startsWith('.')) {\n\t\treturn formattedPath.slice(1)\n\t}\n\treturn formattedPath\n}\n\n/** @public */\nexport class ValidationError extends Error {\n\toverride name = 'ValidationError'\n\n\tconstructor(\n\t\tpublic readonly rawMessage: string,\n\t\tpublic readonly path: ReadonlyArray<number | string> = []\n\t) {\n\t\tconst formattedPath = formatPath(path)\n\t\tconst indentedMessage = rawMessage\n\t\t\t.split('\\n')\n\t\t\t.map((line, i) => (i === 0 ? line : `  ${line}`))\n\t\t\t.join('\\n')\n\t\tsuper(path ? `At ${formattedPath}: ${indentedMessage}` : indentedMessage)\n\t}\n}\n\nfunction prefixError<T>(path: string | number, fn: () => T): T {\n\ttry {\n\t\treturn fn()\n\t} catch (err) {\n\t\tif (err instanceof ValidationError) {\n\t\t\tthrow new ValidationError(err.rawMessage, [path, ...err.path])\n\t\t}\n\t\tthrow new ValidationError((err as Error).toString(), [path])\n\t}\n}\n\nfunction typeToString(value: unknown): string {\n\tif (value === null) return 'null'\n\tif (Array.isArray(value)) return 'an array'\n\tconst type = typeof value\n\tswitch (type) {\n\t\tcase 'bigint':\n\t\tcase 'boolean':\n\t\tcase 'function':\n\t\tcase 'number':\n\t\tcase 'string':\n\t\tcase 'symbol':\n\t\t\treturn `a ${type}`\n\t\tcase 'object':\n\t\t\treturn `an ${type}`\n\t\tcase 'undefined':\n\t\t\treturn 'undefined'\n\t\tdefault:\n\t\t\texhaustiveSwitchError(type)\n\t}\n}\n\n/** @public */\nexport type TypeOf<V extends Validator<unknown>> = V extends Validator<infer T> ? T : never\n\n/** @public */\nexport class Validator<T> {\n\tconstructor(readonly validationFn: ValidatorFn<T>) {}\n\n\t/**\n\t * Asserts that the passed value is of the correct type and returns it. The\n\t * returned value is guaranteed to be referentially equal to the passed\n\t * value.\n\t */\n\tvalidate(value: unknown): T {\n\t\tconst validated = this.validationFn(value)\n\t\tif (process.env.NODE_ENV !== 'production' && !Object.is(value, validated)) {\n\t\t\tthrow new ValidationError('Validator functions must return the same value they were passed')\n\t\t}\n\t\treturn validated\n\t}\n\n\t/**\n\t * Returns a new validator that also accepts null or undefined. The\n\t * resulting value will always be null.\n\t */\n\tnullable(): Validator<T | null> {\n\t\treturn new Validator((value) => {\n\t\t\tif (value === null) return null\n\t\t\treturn this.validate(value)\n\t\t})\n\t}\n\n\t/**\n\t * Returns a new validator that also accepts null or undefined. The\n\t * resulting value will always be null.\n\t */\n\toptional(): Validator<T | undefined> {\n\t\treturn new Validator((value) => {\n\t\t\tif (value === undefined) return undefined\n\t\t\treturn this.validate(value)\n\t\t})\n\t}\n\n\t/**\n\t * Refine this validation to a new type. The passed-in validation function\n\t * should throw an error if the value can't be converted to the new type, or\n\t * return the new type otherwise.\n\t */\n\trefine<U>(otherValidationFn: (value: T) => U): Validator<U> {\n\t\treturn new Validator((value) => {\n\t\t\treturn otherValidationFn(this.validate(value))\n\t\t})\n\t}\n\n\t/**\n\t * Refine this validation with an additional check that doesn't change the resulting value.\n\t *\n\t * @example\n\t * ```ts\n\t *  const numberLessThan10Validator = T.number.check((value) => {\n\t *      if (value >= 10) {\n\t *         throw new ValidationError(`Expected number less than 10, got ${value}`)\n\t *      }\n\t *  })\n\t * ```\n\t */\n\tcheck(name: string, checkFn: (value: T) => void): Validator<T>\n\tcheck(checkFn: (value: T) => void): Validator<T>\n\tcheck(nameOrCheckFn: string | ((value: T) => void), checkFn?: (value: T) => void): Validator<T> {\n\t\tif (typeof nameOrCheckFn === 'string') {\n\t\t\treturn this.refine((value) => {\n\t\t\t\tprefixError(`(check ${nameOrCheckFn})`, () => checkFn!(value))\n\t\t\t\treturn value\n\t\t\t})\n\t\t} else {\n\t\t\treturn this.refine((value) => {\n\t\t\t\tnameOrCheckFn(value)\n\t\t\t\treturn value\n\t\t\t})\n\t\t}\n\t}\n}\n\n/** @public */\nexport class ArrayOfValidator<T> extends Validator<T[]> {\n\tconstructor(readonly itemValidator: Validator<T>) {\n\t\tsuper((value) => {\n\t\t\tconst arr = array.validate(value)\n\t\t\tfor (let i = 0; i < arr.length; i++) {\n\t\t\t\tprefixError(i, () => itemValidator.validate(arr[i]))\n\t\t\t}\n\t\t\treturn arr as T[]\n\t\t})\n\t}\n\n\tnonEmpty() {\n\t\treturn this.check((value) => {\n\t\t\tif (value.length === 0) {\n\t\t\t\tthrow new ValidationError('Expected a non-empty array')\n\t\t\t}\n\t\t})\n\t}\n\n\tlengthGreaterThan1() {\n\t\treturn this.check((value) => {\n\t\t\tif (value.length <= 1) {\n\t\t\t\tthrow new ValidationError('Expected an array with length greater than 1')\n\t\t\t}\n\t\t})\n\t}\n}\n\n/** @public */\nexport class ObjectValidator<Shape extends object> extends Validator<Shape> {\n\tconstructor(\n\t\tpublic readonly config: {\n\t\t\treadonly [K in keyof Shape]: Validator<Shape[K]>\n\t\t},\n\t\tprivate readonly shouldAllowUnknownProperties = false\n\t) {\n\t\tsuper((object) => {\n\t\t\tif (typeof object !== 'object' || object === null) {\n\t\t\t\tthrow new ValidationError(`Expected object, got ${typeToString(object)}`)\n\t\t\t}\n\n\t\t\tfor (const [key, validator] of Object.entries(config)) {\n\t\t\t\tprefixError(key, () => {\n\t\t\t\t\t;(validator as Validator<unknown>).validate(getOwnProperty(object, key))\n\t\t\t\t})\n\t\t\t}\n\n\t\t\tif (!shouldAllowUnknownProperties) {\n\t\t\t\tfor (const key of Object.keys(object)) {\n\t\t\t\t\tif (!hasOwnProperty(config, key)) {\n\t\t\t\t\t\tthrow new ValidationError(`Unexpected property`, [key])\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn object as Shape\n\t\t})\n\t}\n\n\tallowUnknownProperties() {\n\t\treturn new ObjectValidator(this.config, true)\n\t}\n\n\t/**\n\t * Extend an object validator by adding additional properties.\n\t *\n\t * @example\n\t * ```ts\n\t *  const animalValidator = T.object({\n\t *      name: T.string,\n\t *  })\n\t *  const catValidator = animalValidator.extend({\n\t *      meowVolume: T.number,\n\t *  })\n\t * ```\n\t */\n\textend<Extension extends Record<string, unknown>>(extension: {\n\t\treadonly [K in keyof Extension]: Validator<Extension[K]>\n\t}): ObjectValidator<Shape & Extension> {\n\t\treturn new ObjectValidator({ ...this.config, ...extension }) as ObjectValidator<\n\t\t\tShape & Extension\n\t\t>\n\t}\n}\n\n// pass this into itself e.g. Config extends UnionObjectSchemaConfig<Key, Config>\ntype UnionValidatorConfig<Key extends string, Config> = {\n\treadonly [Variant in keyof Config]: Validator<any> & {\n\t\tvalidate: (input: any) => { readonly [K in Key]: Variant }\n\t}\n}\n/** @public */\nexport class UnionValidator<\n\tKey extends string,\n\tConfig extends UnionValidatorConfig<Key, Config>,\n\tUnknownValue = never\n> extends Validator<TypeOf<Config[keyof Config]> | UnknownValue> {\n\tconstructor(\n\t\tprivate readonly key: Key,\n\t\tprivate readonly config: Config,\n\t\tprivate readonly unknownValueValidation: (value: object, variant: string) => UnknownValue\n\t) {\n\t\tsuper((input) => {\n\t\t\tif (typeof input !== 'object' || input === null) {\n\t\t\t\tthrow new ValidationError(`Expected an object, got ${typeToString(input)}`, [])\n\t\t\t}\n\n\t\t\tconst variant = getOwnProperty(input, key) as keyof Config | undefined\n\t\t\tif (typeof variant !== 'string') {\n\t\t\t\tthrow new ValidationError(\n\t\t\t\t\t`Expected a string for key \"${key}\", got ${typeToString(variant)}`\n\t\t\t\t)\n\t\t\t}\n\n\t\t\tconst matchingSchema = hasOwnProperty(config, variant) ? config[variant] : undefined\n\t\t\tif (matchingSchema === undefined) {\n\t\t\t\treturn this.unknownValueValidation(input, variant)\n\t\t\t}\n\n\t\t\treturn prefixError(`(${key} = ${variant})`, () => matchingSchema.validate(input))\n\t\t})\n\t}\n\n\tvalidateUnknownVariants<Unknown>(\n\t\tunknownValueValidation: (value: object, variant: string) => Unknown\n\t): UnionValidator<Key, Config, Unknown> {\n\t\treturn new UnionValidator(this.key, this.config, unknownValueValidation)\n\t}\n}\n\n/** @public */\nexport class DictValidator<Key extends string, Value> extends Validator<Record<Key, Value>> {\n\tconstructor(\n\t\tpublic readonly keyValidator: Validator<Key>,\n\t\tpublic readonly valueValidator: Validator<Value>\n\t) {\n\t\tsuper((object) => {\n\t\t\tif (typeof object !== 'object' || object === null) {\n\t\t\t\tthrow new ValidationError(`Expected object, got ${typeToString(object)}`)\n\t\t\t}\n\n\t\t\tfor (const [key, value] of Object.entries(object)) {\n\t\t\t\tprefixError(key, () => {\n\t\t\t\t\tkeyValidator.validate(key)\n\t\t\t\t\tvalueValidator.validate(value)\n\t\t\t\t})\n\t\t\t}\n\n\t\t\treturn object as Record<Key, Value>\n\t\t})\n\t}\n}\n\nfunction typeofValidator<T>(type: string): Validator<T> {\n\treturn new Validator((value) => {\n\t\tif (typeof value !== type) {\n\t\t\tthrow new ValidationError(`Expected ${type}, got ${typeToString(value)}`)\n\t\t}\n\t\treturn value as T\n\t})\n}\n\n/**\n * Validation that accepts any value. Useful as a starting point for building your own custom validations.\n * @public\n */\nexport const unknown = new Validator((value) => value)\n/**\n * Validation that accepts any value. Generally this should be avoided, but you\n * can use it as an escape hatch if you want to work without validations for\n * e.g. a prototype.\n * @public\n */\nexport const any = new Validator((value): any => value)\n\n/**\n * Validates that a value is a string.\n * @public\n */\nexport const string = typeofValidator<string>('string')\n\n/**\n * Validates that a value is a finite non-NaN number.\n * @public\n */\nexport const number = typeofValidator<number>('number').check((number) => {\n\tif (Number.isNaN(number)) {\n\t\tthrow new ValidationError('Expected a number, got NaN')\n\t}\n\tif (!Number.isFinite(number)) {\n\t\tthrow new ValidationError(`Expected a finite number, got ${number}`)\n\t}\n})\n/**\n * Fails if value \\< 0\n * @public\n */\nexport const positiveNumber = number.check((value) => {\n\tif (value < 0) throw new ValidationError(`Expected a positive number, got ${value}`)\n})\n/**\n * Fails if value \\<= 0\n * @public\n */\nexport const nonZeroNumber = number.check((value) => {\n\tif (value <= 0) throw new ValidationError(`Expected a non-zero positive number, got ${value}`)\n})\n/**\n * Fails if number is not an integer\n * @public\n */\nexport const integer = number.check((value) => {\n\tif (!Number.isInteger(value)) throw new ValidationError(`Expected an integer, got ${value}`)\n})\n/**\n * Fails if value \\< 0 and is not an integer\n * @public\n */\nexport const positiveInteger = integer.check((value) => {\n\tif (value < 0) throw new ValidationError(`Expected a positive integer, got ${value}`)\n})\n/**\n * Fails if value \\<= 0 and is not an integer\n * @public\n */\nexport const nonZeroInteger = integer.check((value) => {\n\tif (value <= 0) throw new ValidationError(`Expected a non-zero positive integer, got ${value}`)\n})\n\n/**\n * Validates that a value is boolean.\n * @public\n */\nexport const boolean = typeofValidator<boolean>('boolean')\n/**\n * Validates that a value is a bigint.\n * @public\n */\nexport const bigint = typeofValidator<bigint>('bigint')\n/**\n * Validates that a value matches another that was passed in.\n *\n * @example\n * ```ts\n * const trueValidator = T.literal(true)\n * ```\n *\n * @public\n */\nexport function literal<T extends string | number | boolean>(expectedValue: T): Validator<T> {\n\treturn new Validator((actualValue) => {\n\t\tif (actualValue !== expectedValue) {\n\t\t\tthrow new ValidationError(`Expected ${expectedValue}, got ${JSON.stringify(actualValue)}`)\n\t\t}\n\t\treturn expectedValue\n\t})\n}\n\n/**\n * Validates that a value is an array. To check the contents of the array, use T.arrayOf.\n * @public\n */\nexport const array = new Validator<unknown[]>((value) => {\n\tif (!Array.isArray(value)) {\n\t\tthrow new ValidationError(`Expected an array, got ${typeToString(value)}`)\n\t}\n\treturn value\n})\n\n/**\n * Validates that a value is an array whose contents matches the passed-in validator.\n * @public\n */\nexport function arrayOf<T>(itemValidator: Validator<T>): ArrayOfValidator<T> {\n\treturn new ArrayOfValidator(itemValidator)\n}\n\n/** @public */\nexport const unknownObject = new Validator<Record<string, unknown>>((value) => {\n\tif (typeof value !== 'object' || value === null) {\n\t\tthrow new ValidationError(`Expected object, got ${typeToString(value)}`)\n\t}\n\treturn value as Record<string, unknown>\n})\n\n/**\n * Validate an object has a particular shape.\n * @public\n */\nexport function object<Shape extends object>(config: {\n\treadonly [K in keyof Shape]: Validator<Shape[K]>\n}): ObjectValidator<Shape> {\n\treturn new ObjectValidator(config)\n}\n\n/**\n * Validation that an option is a dict with particular keys and values.\n * @public\n */\nexport function dict<Key extends string, Value>(\n\tkeyValidator: Validator<Key>,\n\tvalueValidator: Validator<Value>\n): DictValidator<Key, Value> {\n\treturn new DictValidator(keyValidator, valueValidator)\n}\n\n/**\n * Validate a union of several object types. Each object must have a property\n * matching `key` which should be a unique string.\n *\n * @example\n * ```ts\n * const catValidator = T.object({ kind: T.value('cat'), meow: T.boolean })\n * const dogValidator = T.object({ kind: T.value('dog'), bark: T.boolean })\n * const animalValidator = T.union('kind', {cat: catValidator, dog: dogValidator})\n * ```\n *\n * @public\n */\nexport function union<Key extends string, Config extends UnionValidatorConfig<Key, Config>>(\n\tkey: Key,\n\tconfig: Config\n): UnionValidator<Key, Config> {\n\treturn new UnionValidator(key, config, (unknownValue, unknownVariant) => {\n\t\tthrow new ValidationError(\n\t\t\t`Expected one of ${Object.keys(config)\n\t\t\t\t.map((key) => JSON.stringify(key))\n\t\t\t\t.join(' or ')}, got ${JSON.stringify(unknownVariant)}`,\n\t\t\t[key]\n\t\t)\n\t})\n}\n\n/**\n * A named object with an ID. Errors will be reported as being part of the\n * object with the given name.\n *\n * @public\n */\nexport function model<T extends { readonly id: string }>(\n\tname: string,\n\tvalidator: Validator<T>\n): Validator<T> {\n\treturn new Validator((value) => {\n\t\tconst prefix =\n\t\t\tvalue && typeof value === 'object' && 'id' in value && typeof value.id === 'string'\n\t\t\t\t? `${name}(id = ${value.id})`\n\t\t\t\t: name\n\n\t\treturn prefixError(prefix, () => validator.validate(value))\n\t})\n}\n\n/** @public */\nexport function setEnum<T>(values: ReadonlySet<T>): Validator<T> {\n\treturn new Validator((value) => {\n\t\tif (!values.has(value as T)) {\n\t\t\tconst valuesString = Array.from(values, (value) => JSON.stringify(value)).join(' or ')\n\t\t\tthrow new ValidationError(`Expected ${valuesString}, got ${value}`)\n\t\t}\n\t\treturn value as T\n\t})\n}\n\n/** @public */\nexport const point = object({\n\tx: number,\n\ty: number,\n\tz: number.optional(),\n})\n\n/** @public */\nexport const boxModel = object({\n\tx: number,\n\ty: number,\n\tw: number,\n\th: number,\n})\n","import { TLShapeProps } from './records/TLShape'\nimport { SetValue } from './util-types'\n\n/** @public */\nexport const TL_STYLE_TYPES = new Set([\n\t'color',\n\t'labelColor',\n\t'dash',\n\t'fill',\n\t'size',\n\t'opacity',\n\t'font',\n\t'align',\n\t'icon',\n\t'geo',\n\t'arrowheadStart',\n\t'arrowheadEnd',\n\t'spline',\n] as const)\n\n/** @public */\nexport type TLStyleType = SetValue<typeof TL_STYLE_TYPES>\n\n/** @public */\nexport interface TLBaseStyle {\n\ttype: TLStyleType\n\ticon: string\n}\n\n// Color\n\n/** @public */\nexport const TL_COLOR_TYPES = new Set([\n\t'black',\n\t'grey',\n\t'light-violet',\n\t'violet',\n\t'blue',\n\t'light-blue',\n\t'yellow',\n\t'orange',\n\t'green',\n\t'light-green',\n\t'light-red',\n\t'red',\n] as const)\n\n/** @public */\nexport type TLColorType = SetValue<typeof TL_COLOR_TYPES>\n\n/** @public */\nexport interface TLColorStyle extends TLBaseStyle {\n\tid: TLColorType\n\ttype: 'color'\n}\n\n// Dash\n/** @public */\nexport const TL_DASH_TYPES = new Set(['draw', 'solid', 'dashed', 'dotted'] as const)\n\n/** @public */\nexport type TLDashType = SetValue<typeof TL_DASH_TYPES>\n\n/** @public */\nexport interface TLDashStyle extends TLBaseStyle {\n\tid: TLDashType\n\ttype: 'dash'\n}\n\n// Fill\n/** @public */\nexport const TL_FILL_TYPES = new Set(['none', 'semi', 'solid', 'pattern'] as const)\n\n/** @public */\nexport type TLFillType = SetValue<typeof TL_FILL_TYPES>\n\n/** @public */\nexport interface TLFillStyle extends TLBaseStyle {\n\tid: TLFillType\n\ttype: 'fill'\n}\n\n// Size\n/** @public */\nexport const TL_SIZE_TYPES = new Set(['s', 'm', 'l', 'xl'] as const)\n\n/** @public */\nexport type TLSizeType = SetValue<typeof TL_SIZE_TYPES>\n\n/** @public */\nexport interface TLSizeStyle extends TLBaseStyle {\n\tid: TLSizeType\n\ttype: 'size'\n}\n\n// Opacity\n\n/** @public */\nexport const TL_OPACITY_TYPES = new Set(['0.1', '0.25', '0.5', '0.75', '1'] as const)\n\n/** @public */\nexport type TLOpacityType = SetValue<typeof TL_OPACITY_TYPES>\n\n/** @public */\nexport interface TLOpacityStyle extends TLBaseStyle {\n\tid: TLOpacityType\n\ttype: 'opacity'\n}\n\n// Font\n/** @public */\nexport const TL_FONT_TYPES = new Set(['draw', 'sans', 'serif', 'mono'] as const)\n\n/** @public */\nexport type TLFontType = SetValue<typeof TL_FONT_TYPES>\n\n/** @public */\nexport interface TLFontStyle extends TLBaseStyle {\n\tid: TLFontType\n\ttype: 'font'\n}\n\n// Text Align\n/** @public */\nexport const TL_ALIGN_TYPES = new Set(['start', 'middle', 'end', 'justify'] as const)\n\n/** @public */\nexport type TLAlignType = SetValue<typeof TL_ALIGN_TYPES>\n\n/** @public */\nexport interface TLAlignStyle extends TLBaseStyle {\n\tid: TLAlignType\n\ttype: 'align'\n}\n\n// Geo\n\n/** @public */\nexport const TL_GEO_TYPES = new Set([\n\t'rectangle',\n\t'ellipse',\n\t'triangle',\n\t'diamond',\n\t'pentagon',\n\t'hexagon',\n\t'octagon',\n\t'star',\n\t'rhombus',\n\t'rhombus-2',\n\t'oval',\n\t'trapezoid',\n\t'arrow-right',\n\t'arrow-left',\n\t'arrow-up',\n\t'arrow-down',\n\t'x-box',\n] as const)\n\n/** @public */\nexport type TLGeoType = SetValue<typeof TL_GEO_TYPES>\n\n/** @public */\nexport interface TLGeoStyle extends TLBaseStyle {\n\tid: TLGeoType\n\ttype: 'geo'\n}\n\n/** @public */\nexport const TL_ARROWHEAD_TYPES = new Set([\n\t'arrow',\n\t'triangle',\n\t'square',\n\t'dot',\n\t'pipe',\n\t'diamond',\n\t'inverted',\n\t'bar',\n\t'none',\n] as const)\n\n/** @public */\nexport type TLArrowheadType = SetValue<typeof TL_ARROWHEAD_TYPES>\n\n/** @public */\nexport const TL_SPLINE_TYPES = new Set(['cubic', 'line'] as const)\n\n/** @public */\nexport type TLSplineType = SetValue<typeof TL_SPLINE_TYPES>\n\n/** @public */\nexport interface TLArrowheadStartStyle extends TLBaseStyle {\n\tid: TLArrowheadType\n\ttype: 'arrowheadStart'\n}\n\n/** @public */\nexport interface TLArrowheadEndStyle extends TLBaseStyle {\n\tid: TLArrowheadType\n\ttype: 'arrowheadEnd'\n}\n\n/** @public */\nexport interface TLSplineTypeStyle extends TLBaseStyle {\n\tid: TLSplineType\n\ttype: 'spline'\n}\n\n// Text Align\n\n/** @public */\nexport const TL_ICON_TYPES = new Set([\n\t'activity',\n\t'airplay',\n\t'alert-circle',\n\t'alert-octagon',\n\t'alert-triangle',\n\t'align-center',\n\t'align-justify',\n\t'align-left',\n\t'align-right',\n\t'anchor',\n\t'aperture',\n\t'archive',\n\t'arrow-down-circle',\n\t'arrow-down-left',\n\t'arrow-down-right',\n\t'arrow-down',\n\t'arrow-left-circle',\n\t'arrow-left',\n\t'arrow-right-circle',\n\t'arrow-right',\n\t'arrow-up-circle',\n\t'arrow-up-left',\n\t'arrow-up-right',\n\t'arrow-up',\n\t'at-sign',\n\t'award',\n\t'bar-chart-2',\n\t'bar-chart',\n\t'battery-charging',\n\t'battery',\n\t'bell-off',\n\t'bell',\n\t'bluetooth',\n\t'bold',\n\t'book-open',\n\t'book',\n\t'bookmark',\n\t'geo',\n\t'briefcase',\n\t'calendar',\n\t'camera-off',\n\t'camera',\n\t'cast',\n\t'check-circle',\n\t'check-square',\n\t'check',\n\t'chevron-down',\n\t'chevron-left',\n\t'chevron-right',\n\t'chevron-up',\n\t'chevrons-down',\n\t'chevrons-left',\n\t'chevrons-right',\n\t'chevrons-up',\n\t'chrome',\n\t'circle',\n\t'clipboard',\n\t'clock',\n\t'cloud-drizzle',\n\t'cloud-lightning',\n\t'cloud-off',\n\t'cloud-rain',\n\t'cloud-snow',\n\t'cloud',\n\t'codepen',\n\t'codesandbox',\n\t'coffee',\n\t'columns',\n\t'command',\n\t'compass',\n\t'copy',\n\t'corner-down-left',\n\t'corner-down-right',\n\t'corner-left-down',\n\t'corner-left-up',\n\t'corner-right-down',\n\t'corner-right-up',\n\t'corner-up-left',\n\t'corner-up-right',\n\t'cpu',\n\t'credit-card',\n\t'crop',\n\t'crosshair',\n\t'database',\n\t'delete',\n\t'disc',\n\t'divide-circle',\n\t'divide-square',\n\t'divide',\n\t'dollar-sign',\n\t'download-cloud',\n\t'download',\n\t'dribbble',\n\t'droplet',\n\t'edit-2',\n\t'edit-3',\n\t'edit',\n\t'external-link',\n\t'eye-off',\n\t'eye',\n\t'facebook',\n\t'fast-forward',\n\t'feather',\n\t'figma',\n\t'file-minus',\n\t'file-plus',\n\t'file-text',\n\t'file',\n\t'film',\n\t'filter',\n\t'flag',\n\t'folder-minus',\n\t'folder-plus',\n\t'folder',\n\t'framer',\n\t'frown',\n\t'gift',\n\t'git-branch',\n\t'git-commit',\n\t'git-merge',\n\t'git-pull-request',\n\t'github',\n\t'gitlab',\n\t'globe',\n\t'grid',\n\t'hard-drive',\n\t'hash',\n\t'headphones',\n\t'heart',\n\t'help-circle',\n\t'hexagon',\n\t'home',\n\t'image',\n\t'inbox',\n\t'info',\n\t'instagram',\n\t'italic',\n\t'key',\n\t'layers',\n\t'layout',\n\t'life-buoy',\n\t'link-2',\n\t'link',\n\t'linkedin',\n\t'list',\n\t'loader',\n\t'lock',\n\t'log-in',\n\t'log-out',\n\t'mail',\n\t'map-pin',\n\t'map',\n\t'maximize-2',\n\t'maximize',\n\t'meh',\n\t'menu',\n\t'message-circle',\n\t'message-square',\n\t'mic-off',\n\t'mic',\n\t'minimize-2',\n\t'minimize',\n\t'minus-circle',\n\t'minus-square',\n\t'minus',\n\t'monitor',\n\t'moon',\n\t'more-horizontal',\n\t'more-vertical',\n\t'mouse-pointer',\n\t'move',\n\t'music',\n\t'navigation-2',\n\t'navigation',\n\t'octagon',\n\t'package',\n\t'paperclip',\n\t'pause-circle',\n\t'pause',\n\t'pen-tool',\n\t'percent',\n\t'phone-call',\n\t'phone-forwarded',\n\t'phone-incoming',\n\t'phone-missed',\n\t'phone-off',\n\t'phone-outgoing',\n\t'phone',\n\t'pie-chart',\n\t'play-circle',\n\t'play',\n\t'plus-circle',\n\t'plus-square',\n\t'plus',\n\t'pocket',\n\t'power',\n\t'printer',\n\t'radio',\n\t'refresh-ccw',\n\t'refresh-cw',\n\t'repeat',\n\t'rewind',\n\t'rotate-ccw',\n\t'rotate-cw',\n\t'rss',\n\t'save',\n\t'scissors',\n\t'search',\n\t'send',\n\t'server',\n\t'settings',\n\t'share-2',\n\t'share',\n\t'shield-off',\n\t'shield',\n\t'shopping-bag',\n\t'shopping-cart',\n\t'shuffle',\n\t'sidebar',\n\t'skip-back',\n\t'skip-forward',\n\t'slack',\n\t'slash',\n\t'sliders',\n\t'smartphone',\n\t'smile',\n\t'speaker',\n\t'square',\n\t'star',\n\t'stop-circle',\n\t'sun',\n\t'sunrise',\n\t'sunset',\n\t'table',\n\t'tablet',\n\t'tag',\n\t'target',\n\t'terminal',\n\t'thermometer',\n\t'thumbs-down',\n\t'thumbs-up',\n\t'toggle-left',\n\t'toggle-right',\n\t'tool',\n\t'trash-2',\n\t'trash',\n\t'trello',\n\t'trending-down',\n\t'trending-up',\n\t'triangle',\n\t'truck',\n\t'tv',\n\t'twitch',\n\t'twitter',\n\t'type',\n\t'umbrella',\n\t'underline',\n\t'unlock',\n\t'upload-cloud',\n\t'upload',\n\t'user-check',\n\t'user-minus',\n\t'user-plus',\n\t'user-x',\n\t'user',\n\t'users',\n\t'video-off',\n\t'video',\n\t'voicemail',\n\t'volume-1',\n\t'volume-2',\n\t'volume-x',\n\t'volume',\n\t'watch',\n\t'wifi-off',\n\t'wifi',\n\t'wind',\n\t'x-circle',\n\t'x-octagon',\n\t'x-square',\n\t'x',\n\t'youtube',\n\t'zap-off',\n\t'zap',\n\t'zoom-in',\n\t'zoom-out',\n] as const)\n\n/** @public */\nexport type TLIconType = SetValue<typeof TL_ICON_TYPES>\n\n/** @public */\nexport interface TLIconStyle extends TLBaseStyle {\n\tid: TLIconType\n\ttype: 'icon'\n}\n\n/** @public */\nexport type TLStyleItem =\n\t| TLColorStyle\n\t| TLDashStyle\n\t| TLFillStyle\n\t| TLSizeStyle\n\t| TLOpacityStyle\n\t| TLFontStyle\n\t| TLAlignStyle\n//\t| TLIconStyle\n\n/** @public */\nexport interface TLStyleCollections {\n\tcolor: TLColorStyle[]\n\tfill: TLFillStyle[]\n\tdash: TLDashStyle[]\n\tsize: TLSizeStyle[]\n\topacity: TLOpacityStyle[]\n\tfont: TLFontStyle[]\n\talign: TLAlignStyle[]\n\tgeo: TLGeoStyle[]\n\tarrowheadStart: TLArrowheadStartStyle[]\n\tarrowheadEnd: TLArrowheadEndStyle[]\n\tspline: TLSplineTypeStyle[]\n}\n\n/** @public */\nexport type TLStyleProps = Pick<TLShapeProps, TLStyleType>\n","import type { ID } from '@tldraw/tlstore'\nimport { BaseRecord } from '@tldraw/tlstore'\nimport { T } from '@tldraw/tlvalidate'\nimport type { TLAssetId } from './records/TLAsset'\nimport type { TLInstanceId } from './records/TLInstance'\nimport type { TLPageId } from './records/TLPage'\nimport type { TLParentId, TLShapeId } from './records/TLShape'\nimport type { TLUserId } from './records/TLUser'\nimport {\n\tTL_ALIGN_TYPES,\n\tTL_ARROWHEAD_TYPES,\n\tTL_COLOR_TYPES,\n\tTL_DASH_TYPES,\n\tTL_FILL_TYPES,\n\tTL_FONT_TYPES,\n\tTL_GEO_TYPES,\n\tTL_ICON_TYPES,\n\tTL_OPACITY_TYPES,\n\tTL_SIZE_TYPES,\n\tTL_SPLINE_TYPES,\n} from './style-types'\n\n/** @internal */\nexport function idValidator<Id extends ID<BaseRecord<any>>>(\n\tprefix: Id['__type__']['typeName']\n): T.Validator<Id> {\n\treturn T.string.refine((id) => {\n\t\tif (!id.startsWith(`${prefix}:`)) {\n\t\t\tthrow new Error(`${prefix} ID must start with \"${prefix}:\"`)\n\t\t}\n\t\treturn id as Id\n\t})\n}\n/** @internal */\nexport const userIdValidator = idValidator<TLUserId>('user')\n/** @internal */\nexport const assetIdValidator = idValidator<TLAssetId>('asset')\n/** @internal */\nexport const pageIdValidator = idValidator<TLPageId>('page')\n/** @internal */\nexport const shapeIdValidator = idValidator<TLShapeId>('shape')\n/** @internal */\nexport const instanceIdValidator = idValidator<TLInstanceId>('instance')\n\n/** @internal */\nexport const parentIdValidator = T.string.refine((id) => {\n\tif (!id.startsWith('page:') && !id.startsWith('shape:')) {\n\t\tthrow new Error('Parent ID must start with \"page:\" or \"shape:\"')\n\t}\n\treturn id as TLParentId\n})\n\n/** @internal */\nexport const colorValidator = T.setEnum(TL_COLOR_TYPES)\n/** @internal */\nexport const dashValidator = T.setEnum(TL_DASH_TYPES)\n/** @internal */\nexport const fillValidator = T.setEnum(TL_FILL_TYPES)\n/** @internal */\nexport const geoValidator = T.setEnum(TL_GEO_TYPES)\n/** @internal */\nexport const sizeValidator = T.setEnum(TL_SIZE_TYPES)\n/** @internal */\nexport const fontValidator = T.setEnum(TL_FONT_TYPES)\n/** @internal */\nexport const alignValidator = T.setEnum(TL_ALIGN_TYPES)\n/** @internal */\nexport const arrowheadValidator = T.setEnum(TL_ARROWHEAD_TYPES)\n/** @internal */\nexport const opacityValidator = T.setEnum(TL_OPACITY_TYPES)\n/** @internal */\nexport const iconValidator = T.setEnum(TL_ICON_TYPES)\n/** @internal */\nexport const splineValidator = T.setEnum(TL_SPLINE_TYPES)\n","import { BaseRecord, createRecordType, defineMigrations, ID } from '@tldraw/tlstore'\nimport { T } from '@tldraw/tlvalidate'\nimport { idValidator } from '../validation'\n\n/**\n * TLCamera\n * @public\n */\nexport interface TLCamera extends BaseRecord<'camera'> {\n\tx: number\n\ty: number\n\tz: number\n}\n\n/** @public */\nexport type TLCameraId = ID<TLCamera>\n\n// --- VALIDATION ---\n/** @public */\nexport const cameraTypeValidator: T.Validator<TLCamera> = T.model(\n\t'camera',\n\tT.object({\n\t\ttypeName: T.literal('camera'),\n\t\tid: idValidator<TLCameraId>('camera'),\n\t\tx: T.number,\n\t\ty: T.number,\n\t\tz: T.number,\n\t})\n)\n\n// --- MIGRATIONS ---\n// STEP 1: Add a new version number here, give it a meaningful name.\n// It should be 1 higher than the current version\nconst Versions = {\n\tInitial: 0,\n} as const\n\n/** @public */\nexport const cameraTypeMigrations = defineMigrations({\n\tfirstVersion: Versions.Initial,\n\t// STEP 2: Update the current version to point to your latest version\n\tcurrentVersion: Versions.Initial,\n\t// STEP 3: Add an up+down migration for the new version here\n\tmigrators: {},\n})\n\n/** @public */\nexport const TLCamera = createRecordType<TLCamera>('camera', {\n\tmigrations: cameraTypeMigrations,\n\tvalidator: cameraTypeValidator,\n}).withDefaultProperties(\n\t(): Omit<TLCamera, 'id' | 'typeName'> => ({\n\t\tx: 0,\n\t\ty: 0,\n\t\tz: 1,\n\t})\n)\n","import { BaseRecord, createRecordType, defineMigrations, ID } from '@tldraw/tlstore'\nimport { T } from '@tldraw/tlvalidate'\n\n/**\n * TLDocument\n * @public\n */\nexport interface TLDocument extends BaseRecord<'document'> {\n\tgridSize: number\n}\n\n// --- VALIDATION ---\n/** @public */\nexport const documentTypeValidator: T.Validator<TLDocument> = T.model(\n\t'document',\n\tT.object({\n\t\ttypeName: T.literal('document'),\n\t\tid: T.literal('document:document' as ID<TLDocument>),\n\t\tgridSize: T.number,\n\t})\n)\n\n// --- MIGRATIONS ---\n// STEP 1: Add a new version number here, give it a meaningful name.\n// It should be 1 higher than the current version\nconst Versions = {\n\tInitial: 0,\n} as const\n\n/** @public */\nexport const documentTypeMigrations = defineMigrations({\n\tfirstVersion: Versions.Initial,\n\t// STEP 2: Update the current version to point to your latest version\n\tcurrentVersion: Versions.Initial,\n\t// STEP 3: Add an up+down migration for the new version here\n\tmigrators: {},\n})\n\n/** @public */\nexport const TLDocument = createRecordType<TLDocument>('document', {\n\tmigrations: documentTypeMigrations,\n\tvalidator: documentTypeValidator,\n}).withDefaultProperties(\n\t(): Omit<TLDocument, 'id' | 'typeName'> => ({\n\t\tgridSize: 10,\n\t})\n)\n\n// all document records have the same ID: 'document:document'\n/** @public */\nexport const TLDOCUMENT_ID: ID<TLDocument> = TLDocument.createCustomId('document')\n","import { T } from '@tldraw/tlvalidate'\nimport { Vec2dModel } from './geometry-types'\nimport { SetValue } from './util-types'\n\n/** @public */\nexport const TL_UI_COLOR_TYPES = new Set([\n\t'accent',\n\t'white',\n\t'black',\n\t'selection-stroke',\n\t'selection-fill',\n\t'muted-1',\n] as const)\n\n/** @public */\nexport type TLUiColorType = SetValue<typeof TL_UI_COLOR_TYPES>\n/** @public */\nexport const uiColorTypeValidator = T.setEnum(TL_UI_COLOR_TYPES)\n\n/** @public */\nexport const TL_CURSOR_TYPES = new Set([\n\t'none',\n\t'default',\n\t'pointer',\n\t'cross',\n\t'grab',\n\t'rotate',\n\t'grabbing',\n\t'resize-edge',\n\t'resize-corner',\n\t'text',\n\t'move',\n\t'ew-resize',\n\t'ns-resize',\n\t'nesw-resize',\n\t'nwse-resize',\n\t'nesw-rotate',\n\t'nwse-rotate',\n\t'swne-rotate',\n\t'senw-rotate',\n])\n\n/** @public */\nexport type TLCursorType = SetValue<typeof TL_CURSOR_TYPES>\n/** @public */\nexport const cursorTypeValidator = T.setEnum(TL_CURSOR_TYPES)\n\n/** @public */\nexport interface TLCursor {\n\tcolor: TLUiColorType\n\ttype: TLCursorType\n\trotation: number\n}\n/** @public */\nexport const cursorValidator: T.Validator<TLCursor> = T.object({\n\tcolor: uiColorTypeValidator,\n\ttype: cursorTypeValidator,\n\trotation: T.number,\n})\n\n/** @public */\nexport const TL_SCRIBBLE_STATES = new Set(['starting', 'paused', 'active', 'stopping'] as const)\n\n/** @public */\nexport type TLScribble = {\n\tpoints: Vec2dModel[]\n\tsize: number\n\tcolor: TLUiColorType\n\topacity: number\n\tstate: SetValue<typeof TL_SCRIBBLE_STATES>\n}\n\n/** @public */\nexport const scribbleTypeValidator: T.Validator<TLScribble> = T.object({\n\tpoints: T.arrayOf(T.point),\n\tsize: T.positiveNumber,\n\tcolor: uiColorTypeValidator,\n\topacity: T.number,\n\tstate: T.setEnum(TL_SCRIBBLE_STATES),\n})\n\n/** @public */\nexport const TL_HANDLE_TYPES = new Set(['vertex', 'virtual', 'create'] as const)\n\n/** @public */\nexport type TLHandleType = SetValue<typeof TL_HANDLE_TYPES>\n\n/**\n * A base interface for a shape's handles.\n *\n * @public\n */\nexport interface TLHandle {\n\t/** A unique identifier for the handle. */\n\tid: string\n\ttype: TLHandleType\n\tcanBind?: boolean\n\tindex: string\n\tx: number\n\ty: number\n}\n/** @public */\nexport const handleTypeValidator: T.Validator<TLHandle> = T.object({\n\tid: T.string,\n\ttype: T.setEnum(TL_HANDLE_TYPES),\n\tcanBind: T.boolean.optional(),\n\tindex: T.string,\n\tx: T.number,\n\ty: T.number,\n})\n\n/**\n * A base interface for a shape's handles.\n *\n * @public\n */\nexport interface TLHandlePartial {\n\t/** A unique identifier for the handle. */\n\t// id: string\n\t// index: string\n\tx: number\n\ty: number\n}\n","import { BaseRecord, createRecordType, defineMigrations, ID } from '@tldraw/tlstore'\nimport { T } from '@tldraw/tlvalidate'\nimport { Box2dModel } from '../geometry-types'\nimport { TL_STYLE_TYPES, TLStyleType } from '../style-types'\nimport { cursorValidator, scribbleTypeValidator, TLCursor, TLScribble } from '../ui-types'\nimport {\n\talignValidator,\n\tarrowheadValidator,\n\tcolorValidator,\n\tdashValidator,\n\tfillValidator,\n\tfontValidator,\n\tgeoValidator,\n\ticonValidator,\n\tidValidator,\n\topacityValidator,\n\tpageIdValidator,\n\tsizeValidator,\n\tsplineValidator,\n\tuserIdValidator,\n} from '../validation'\nimport { TLPageId } from './TLPage'\nimport { TLShapeProps } from './TLShape'\nimport { TLUserId } from './TLUser'\n\n/** @public */\nexport type TLInstancePropsForNextShape = Pick<TLShapeProps, TLStyleType>\n\n/**\n * TLInstance\n *\n * State that is particular to a single browser tab\n *\n * @public\n */\nexport interface TLInstance extends BaseRecord<'instance'> {\n\tuserId: TLUserId\n\tcurrentPageId: TLPageId\n\tbrush: Box2dModel | null\n\tpropsForNextShape: TLInstancePropsForNextShape\n\tcursor: TLCursor\n\tscribble: TLScribble | null\n\tisFocusMode: boolean\n\tisDebugMode: boolean\n\tisToolLocked: boolean\n\texportBackground: boolean\n\tscreenBounds: Box2dModel\n}\n\n/** @public */\nexport type TLInstanceId = ID<TLInstance>\n\n// --- VALIDATION ---\n/** @public */\nexport const instanceTypeValidator: T.Validator<TLInstance> = T.model(\n\t'instance',\n\tT.object({\n\t\ttypeName: T.literal('instance'),\n\t\tid: idValidator<TLInstanceId>('instance'),\n\t\tuserId: userIdValidator,\n\t\tcurrentPageId: pageIdValidator,\n\t\tbrush: T.boxModel.nullable(),\n\t\tpropsForNextShape: T.object({\n\t\t\tcolor: colorValidator,\n\t\t\tlabelColor: colorValidator,\n\t\t\tdash: dashValidator,\n\t\t\tfill: fillValidator,\n\t\t\tsize: sizeValidator,\n\t\t\topacity: opacityValidator,\n\t\t\tfont: fontValidator,\n\t\t\talign: alignValidator,\n\t\t\ticon: iconValidator,\n\t\t\tgeo: geoValidator,\n\t\t\tarrowheadStart: arrowheadValidator,\n\t\t\tarrowheadEnd: arrowheadValidator,\n\t\t\tspline: splineValidator,\n\t\t}),\n\t\tcursor: cursorValidator,\n\t\tscribble: scribbleTypeValidator.nullable(),\n\t\tisFocusMode: T.boolean,\n\t\tisDebugMode: T.boolean,\n\t\tisToolLocked: T.boolean,\n\t\texportBackground: T.boolean,\n\t\tscreenBounds: T.boxModel,\n\t})\n)\n\n// --- MIGRATIONS ---\n// STEP 1: Add a new version number here, give it a meaningful name.\n// It should be 1 higher than the current version\nconst Versions = {\n\tInitial: 0,\n\tAddTransparentExportBgs: 1,\n\tRemoveDialog: 2,\n\tAddToolLockMode: 3,\n\tRemoveExtraPropsForNextShape: 4,\n\tAddLabelColor: 5,\n} as const\n\n/** @public */\nexport const instanceTypeMigrations = defineMigrations({\n\tfirstVersion: Versions.Initial,\n\t// STEP 2: Update the current version to point to your latest version\n\tcurrentVersion: Versions.AddLabelColor,\n\t// STEP 3: Add an up+down migration for the new version here\n\tmigrators: {\n\t\t[Versions.AddTransparentExportBgs]: {\n\t\t\tup: (instance: TLInstance) => {\n\t\t\t\treturn { ...instance, exportBackground: true }\n\t\t\t},\n\t\t\tdown: ({ exportBackground: _, ...instance }: TLInstance) => {\n\t\t\t\treturn instance\n\t\t\t},\n\t\t},\n\t\t[Versions.RemoveDialog]: {\n\t\t\tup: ({ dialog: _, ...instance }: any) => {\n\t\t\t\treturn instance\n\t\t\t},\n\t\t\tdown: (instance: TLInstance) => {\n\t\t\t\treturn { ...instance, dialog: null }\n\t\t\t},\n\t\t},\n\t\t[Versions.AddToolLockMode]: {\n\t\t\tup: (instance: TLInstance) => {\n\t\t\t\treturn { ...instance, isToolLocked: false }\n\t\t\t},\n\t\t\tdown: ({ isToolLocked: _, ...instance }: TLInstance) => {\n\t\t\t\treturn instance\n\t\t\t},\n\t\t},\n\t\t[Versions.RemoveExtraPropsForNextShape]: {\n\t\t\tup: ({ propsForNextShape, ...instance }: any) => {\n\t\t\t\treturn {\n\t\t\t\t\t...instance,\n\t\t\t\t\tpropsForNextShape: Object.fromEntries(\n\t\t\t\t\t\tObject.entries(propsForNextShape).filter(([key]) =>\n\t\t\t\t\t\t\tTL_STYLE_TYPES.has(key as TLStyleType)\n\t\t\t\t\t\t)\n\t\t\t\t\t),\n\t\t\t\t}\n\t\t\t},\n\t\t\tdown: (instance: TLInstance) => {\n\t\t\t\t// we can't restore these, so do nothing :/\n\t\t\t\treturn instance\n\t\t\t},\n\t\t},\n\t\t[Versions.AddLabelColor]: {\n\t\t\tup: ({ propsForNextShape, ...instance }: any) => {\n\t\t\t\treturn {\n\t\t\t\t\t...instance,\n\t\t\t\t\tpropsForNextShape: {\n\t\t\t\t\t\t...propsForNextShape,\n\t\t\t\t\t\tlabelColor: 'black',\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t},\n\t\t\tdown: (instance: TLInstance) => {\n\t\t\t\tconst { labelColor: _, ...rest } = instance.propsForNextShape\n\t\t\t\treturn {\n\t\t\t\t\t...instance,\n\t\t\t\t\tpropsForNextShape: {\n\t\t\t\t\t\t...rest,\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t},\n\t\t},\n\t},\n})\n\n/** @public */\nexport const TLInstance = createRecordType<TLInstance>('instance', {\n\tmigrations: instanceTypeMigrations,\n\tvalidator: instanceTypeValidator,\n}).withDefaultProperties(\n\t(): Omit<TLInstance, 'typeName' | 'id' | 'userId' | 'currentPageId'> => ({\n\t\tpropsForNextShape: {\n\t\t\topacity: '1',\n\t\t\tcolor: 'black',\n\t\t\tlabelColor: 'black',\n\t\t\tdash: 'draw',\n\t\t\tfill: 'none',\n\t\t\tsize: 'm',\n\t\t\ticon: 'file',\n\t\t\tfont: 'draw',\n\t\t\talign: 'middle',\n\t\t\tgeo: 'rectangle',\n\t\t\tarrowheadStart: 'none',\n\t\t\tarrowheadEnd: 'arrow',\n\t\t\tspline: 'line',\n\t\t},\n\t\tbrush: null,\n\t\tscribble: null,\n\t\tcursor: {\n\t\t\ttype: 'default',\n\t\t\tcolor: 'black',\n\t\t\trotation: 0,\n\t\t},\n\t\tisFocusMode: false,\n\t\texportBackground: false,\n\t\tisDebugMode: process.env.NODE_ENV === 'development',\n\t\tisToolLocked: false,\n\t\tscreenBounds: { x: 0, y: 0, w: 1080, h: 720 },\n\t})\n)\n","import { BaseRecord, createRecordType, defineMigrations, ID } from '@tldraw/tlstore'\nimport { T } from '@tldraw/tlvalidate'\nimport { idValidator, instanceIdValidator, pageIdValidator, shapeIdValidator } from '../validation'\nimport { TLCamera, TLCameraId } from './TLCamera'\nimport { TLInstance } from './TLInstance'\nimport { TLPage } from './TLPage'\nimport { TLShapeId } from './TLShape'\n\n/**\n * TLInstancePageState\n *\n * State that is unique to a particular page of the document in a particular browser tab\n * @public\n */\nexport interface TLInstancePageState extends BaseRecord<'instance_page_state'> {\n\tinstanceId: ID<TLInstance>\n\tpageId: ID<TLPage>\n\tcameraId: ID<TLCamera>\n\tselectedIds: TLShapeId[]\n\thintingIds: TLShapeId[]\n\terasingIds: TLShapeId[]\n\thoveredId: TLShapeId | null\n\teditingId: TLShapeId | null\n\tfocusLayerId: TLShapeId | null\n}\n\n// --- VALIDATION ---\n/** @public */\nexport const instancePageStateTypeValidator: T.Validator<TLInstancePageState> = T.model(\n\t'instance_page_state',\n\tT.object({\n\t\ttypeName: T.literal('instance_page_state'),\n\t\tid: idValidator<TLInstancePageStateId>('instance_page_state'),\n\t\tinstanceId: instanceIdValidator,\n\t\tpageId: pageIdValidator,\n\t\tcameraId: idValidator<TLCameraId>('camera'),\n\t\tselectedIds: T.arrayOf(shapeIdValidator),\n\t\thintingIds: T.arrayOf(shapeIdValidator),\n\t\terasingIds: T.arrayOf(shapeIdValidator),\n\t\thoveredId: shapeIdValidator.nullable(),\n\t\teditingId: shapeIdValidator.nullable(),\n\t\tfocusLayerId: shapeIdValidator.nullable(),\n\t})\n)\n\n// --- MIGRATIONS ---\n// STEP 1: Add a new version number here, give it a meaningful name.\n// It should be 1 higher than the current version\nconst Versions = {\n\tInitial: 0,\n} as const\n\n/** @public */\nexport const instancePageStateMigrations = defineMigrations({\n\tcurrentVersion: Versions.Initial,\n\t// STEP 2: Update the current version to point to your latest version\n\tfirstVersion: Versions.Initial,\n\t// STEP 3: Add an up+down migration for the new version here\n\tmigrators: {},\n})\n\n/** @public */\nexport const TLInstancePageState = createRecordType<TLInstancePageState>('instance_page_state', {\n\tmigrations: instancePageStateMigrations,\n\tvalidator: instancePageStateTypeValidator,\n}).withDefaultProperties(\n\t(): Omit<\n\t\tTLInstancePageState,\n\t\t'id' | 'typeName' | 'userId' | 'instanceId' | 'cameraId' | 'pageId'\n\t> => ({\n\t\teditingId: null,\n\t\tselectedIds: [],\n\t\thoveredId: null,\n\t\terasingIds: [],\n\t\thintingIds: [],\n\t\tfocusLayerId: null,\n\t})\n)\n\n/** @public */\nexport type TLInstancePageStateId = ID<TLInstancePageState>\n","import { BaseRecord, createRecordType, defineMigrations, ID } from '@tldraw/tlstore'\nimport { T } from '@tldraw/tlvalidate'\nimport { pageIdValidator } from '../validation'\n\n/**\n * TLPage\n * @public\n */\nexport interface TLPage extends BaseRecord<'page'> {\n\tname: string\n\tindex: string\n}\n\n/** @public */\nexport type TLPageId = ID<TLPage>\n\n// --- VALIDATION ---\n/** @public */\nexport const pageTypeValidator: T.Validator<TLPage> = T.model(\n\t'page',\n\tT.object({\n\t\ttypeName: T.literal('page'),\n\t\tid: pageIdValidator,\n\t\tname: T.string,\n\t\tindex: T.string,\n\t})\n)\n\n// --- MIGRATIONS ---\n// STEP 1: Add a new version number here, give it a meaningful name.\n// It should be 1 higher than the current version\nconst Versions = {\n\tInitial: 0,\n} as const\n\n/** @public */\nexport const pageTypeMigrations = defineMigrations({\n\tfirstVersion: Versions.Initial,\n\t// STEP 2: Update the current version to point to your latest version\n\tcurrentVersion: Versions.Initial,\n\t// STEP 3: Add an up+down migration for the new version here\n\tmigrators: {},\n})\n\n/** @public */\nexport const TLPage = createRecordType<TLPage>('page', {\n\tmigrations: pageTypeMigrations,\n\tvalidator: pageTypeValidator,\n})\n","// This file is automatically generated by scripts/refresh-assets.ts.\n// Do not edit manually.\n\n/** @public */\nexport const LANGUAGES = [\n\t{ locale: 'ar', label: '' },\n\t{ locale: 'ca', label: 'Catal' },\n\t{ locale: 'da', label: 'Danish' },\n\t{ locale: 'de', label: 'Deutsch' },\n\t{ locale: 'en', label: 'English' },\n\t{ locale: 'es', label: 'Espaol' },\n\t{ locale: 'fa', label: '' },\n\t{ locale: 'fi', label: 'Suomi' },\n\t{ locale: 'fr', label: 'Franais' },\n\t{ locale: 'gl', label: 'Galego' },\n\t{ locale: 'he', label: '' },\n\t{ locale: 'it', label: 'Italiano' },\n\t{ locale: 'ja', label: '' },\n\t{ locale: 'ko-kr', label: '' },\n\t{ locale: 'ku', label: '' },\n\t{ locale: 'hi-in', label: '' },\n\t{ locale: 'hu', label: 'Magyar' },\n\t{ locale: 'my', label: '' },\n\t{ locale: 'ne', label: '' },\n\t{ locale: 'no', label: 'Norwegian' },\n\t{ locale: 'pl', label: 'Polski' },\n\t{ locale: 'pt-br', label: 'Portugus - Brasil' },\n\t{ locale: 'pt-pt', label: 'Portugus - Europeu' },\n\t{ locale: 'ro', label: 'Romn' },\n\t{ locale: 'ru', label: 'Russian' },\n\t{ locale: 'sv', label: 'Svenska' },\n\t{ locale: 'te', label: '' },\n\t{ locale: 'th', label: '' },\n\t{ locale: 'tr', label: 'Trke' },\n\t{ locale: 'uk', label: 'Ukrainian' },\n\t{ locale: 'vi', label: 'Ting Vit' },\n\t{ locale: 'zh-cn', label: 'Chinese - Simplified' },\n\t{ locale: 'zh-tw', label: ' ()' },\n] as const\n","import { BaseRecord, createRecordType, defineMigrations, ID } from '@tldraw/tlstore'\nimport { T } from '@tldraw/tlvalidate'\nimport { LANGUAGES } from '../languages'\nimport { userIdValidator } from '../validation'\n\n/**\n * A user of tldraw\n * @public\n */\nexport interface TLUser extends BaseRecord<'user'> {\n\tname: string\n\tlocale: string\n}\n/** @public */\nexport type TLUserId = ID<TLUser>\n\n// --- VALIDATION ---\n/** @public */\nexport const userTypeValidator: T.Validator<TLUser> = T.model(\n\t'user',\n\tT.object({\n\t\ttypeName: T.literal('user'),\n\t\tid: userIdValidator,\n\t\tname: T.string,\n\t\tlocale: T.string,\n\t})\n)\n\n// --- MIGRATIONS ---\n// STEP 1: Add a new version number here, give it a meaningful name.\n// It should be 1 higher than the current version\nconst Versions = {\n\tInitial: 0,\n} as const\n\n/** @public */\nexport const userTypeMigrations = defineMigrations({\n\t// STEP 2: Update the current version to point to your latest version\n\tcurrentVersion: Versions.Initial,\n\tfirstVersion: Versions.Initial,\n\tmigrators: {\n\t\t// STEP 3: Add an up+down migration for the new version here\n\t},\n})\n\n/** @public */\nexport const TLUser = createRecordType<TLUser>('user', {\n\tmigrations: userTypeMigrations,\n\tvalidator: userTypeValidator,\n}).withDefaultProperties((): Omit<TLUser, 'id' | 'typeName'> => {\n\tlet lang\n\tif (typeof window !== 'undefined' && window.navigator) {\n\t\tconst availLocales = LANGUAGES.map(({ locale }) => locale) as string[]\n\t\tlang = window.navigator.languages.find((lang) => {\n\t\t\treturn availLocales.indexOf(lang) > -1\n\t\t})\n\t}\n\treturn {\n\t\tname: 'New User',\n\t\tlocale: lang ?? 'en',\n\t}\n})\n","import { BaseRecord, createRecordType, defineMigrations, ID } from '@tldraw/tlstore'\nimport { T } from '@tldraw/tlvalidate'\nimport { idValidator, instanceIdValidator, pageIdValidator, userIdValidator } from '../validation'\nimport { TLInstance } from './TLInstance'\nimport { TLPage } from './TLPage'\nimport { TLUserId } from './TLUser'\n\n/**\n * TLUserDocument\n *\n * Settings that apply to this document for only the specified user\n * @public\n */\nexport interface TLUserDocument extends BaseRecord<'user_document'> {\n\tuserId: TLUserId\n\tisReadOnly: boolean\n\tisPenMode: boolean\n\tisGridMode: boolean\n\tisDarkMode: boolean\n\tisMobileMode: boolean\n\tisSnapMode: boolean\n\tlastUpdatedPageId: ID<TLPage> | null\n\tlastUsedTabId: ID<TLInstance> | null\n}\n\n/** @public */\nexport type TLUserDocumentId = ID<TLUserDocument>\n\n// --- VALIDATION ---\n/** @public */\nexport const userDocumentTypeValidator: T.Validator<TLUserDocument> = T.model(\n\t'user_document',\n\tT.object({\n\t\ttypeName: T.literal('user_document'),\n\t\tid: idValidator<TLUserDocumentId>('user_document'),\n\t\tuserId: userIdValidator,\n\t\tisReadOnly: T.boolean,\n\t\tisPenMode: T.boolean,\n\t\tisGridMode: T.boolean,\n\t\tisDarkMode: T.boolean,\n\t\tisMobileMode: T.boolean,\n\t\tisSnapMode: T.boolean,\n\t\tlastUpdatedPageId: pageIdValidator.nullable(),\n\t\tlastUsedTabId: instanceIdValidator.nullable(),\n\t})\n)\n\n// --- MIGRATIONS ---\n// STEP 1: Add a new version number here, give it a meaningful name.\n// It should be 1 higher than the current version\nconst Versions = {\n\tInitial: 0,\n\tAddSnapMode: 1,\n\tAddMissingIsMobileMode: 2,\n} as const\n\n/** @public */\nexport const userDocumentTypeMigrations = defineMigrations({\n\tfirstVersion: Versions.Initial,\n\t// STEP 2: Update the current version to point to your latest version\n\tcurrentVersion: Versions.AddMissingIsMobileMode,\n\t// STEP 3: Add an up+down migration for the new version here\n\tmigrators: {\n\t\t[Versions.AddSnapMode]: {\n\t\t\tup: (userDocument: TLUserDocument) => {\n\t\t\t\treturn { ...userDocument, isSnapMode: false }\n\t\t\t},\n\t\t\tdown: ({ isSnapMode: _, ...userDocument }: TLUserDocument) => {\n\t\t\t\treturn userDocument\n\t\t\t},\n\t\t},\n\t\t[Versions.AddMissingIsMobileMode]: {\n\t\t\tup: (userDocument: TLUserDocument) => {\n\t\t\t\treturn { ...userDocument, isMobileMode: userDocument.isMobileMode ?? false }\n\t\t\t},\n\t\t\tdown: ({ isMobileMode: _, ...userDocument }: TLUserDocument) => {\n\t\t\t\treturn userDocument\n\t\t\t},\n\t\t},\n\t},\n})\n/* STEP 4: Add your changes to the record type */\n\n/* STEP 5: Add up + down migrations for your new version */\n/** @public */\nexport const TLUserDocument = createRecordType<TLUserDocument>('user_document', {\n\tmigrations: userDocumentTypeMigrations,\n\tvalidator: userDocumentTypeValidator,\n}).withDefaultProperties(\n\t(): Omit<TLUserDocument, 'id' | 'typeName' | 'userId'> => ({\n\t\t/* STEP 6: Add any new default values for properties here */\n\t\tisReadOnly: false,\n\t\tisPenMode: false,\n\t\tisGridMode: false,\n\t\tisDarkMode: false,\n\t\tisMobileMode: false,\n\t\tisSnapMode: false,\n\t\tlastUpdatedPageId: null,\n\t\tlastUsedTabId: null,\n\t})\n)\n","import { BaseRecord, createRecordType, defineMigrations, ID } from '@tldraw/tlstore'\nimport { T } from '@tldraw/tlvalidate'\nimport { Vec2dModel } from '../geometry-types'\nimport { idValidator, instanceIdValidator, userIdValidator } from '../validation'\nimport { TLInstanceId } from './TLInstance'\nimport { TLUserId } from './TLUser'\n\n/** @public */\nexport interface TLUserPresence extends BaseRecord<'user_presence'> {\n\tuserId: TLUserId\n\tlastUsedInstanceId: TLInstanceId | null\n\tlastActivityTimestamp: number\n\tcursor: Vec2dModel\n\tcolor: string // can be any hex color\n}\n\n/** @public */\nexport type TLUserPresenceId = ID<TLUserPresence>\n\n// --- VALIDATION ---\n/** @public */\nexport const userPresenceTypeValidator: T.Validator<TLUserPresence> = T.model(\n\t'user_presence',\n\tT.object({\n\t\ttypeName: T.literal('user_presence'),\n\t\tid: idValidator<TLUserPresenceId>('user_presence'),\n\t\tuserId: userIdValidator,\n\t\tlastUsedInstanceId: instanceIdValidator.nullable(),\n\t\tlastActivityTimestamp: T.number,\n\t\tcursor: T.point,\n\t\tcolor: T.string,\n\t})\n)\n\n// --- MIGRATIONS ---\n// STEP 1: Add a new version number here, give it a meaningful name.\n// It should be 1 higher than the current version\nconst Versions = {\n\tInitial: 0,\n} as const\n\n/** @public */\nexport const userPresenceTypeMigrations = defineMigrations({\n\t// STEP 2: Update the current version to point to your latest version\n\tcurrentVersion: Versions.Initial,\n\tfirstVersion: Versions.Initial,\n\tmigrators: {\n\t\t// STEP 3: Add an up+down migration for the new version here\n\t},\n})\n\n/** @public */\nexport const TLUserPresence = createRecordType<TLUserPresence>('user_presence', {\n\tmigrations: userPresenceTypeMigrations,\n\tvalidator: userPresenceTypeValidator,\n}).withDefaultProperties(\n\t(): Omit<TLUserPresence, 'id' | 'typeName' | 'userId'> => ({\n\t\tlastUsedInstanceId: null,\n\t\tlastActivityTimestamp: 0,\n\t\tcursor: { x: 0, y: 0 },\n\t\tcolor: '#000000',\n\t})\n)\n","import { Store, StoreSchema, StoreSchemaOptions, StoreSnapshot } from '@tldraw/tlstore'\nimport { annotateError, structuredClone } from '@tldraw/utils'\nimport { TLRecord } from './TLRecord'\nimport { TLCamera } from './records/TLCamera'\nimport { TLDOCUMENT_ID, TLDocument } from './records/TLDocument'\nimport { TLInstance, TLInstanceId } from './records/TLInstance'\nimport { TLInstancePageState } from './records/TLInstancePageState'\nimport { TLPage } from './records/TLPage'\nimport { TLUser, TLUserId } from './records/TLUser'\nimport { TLUserDocument } from './records/TLUserDocument'\nimport { TLUserPresence } from './records/TLUserPresence'\n\nfunction sortByIndex<T extends { index: string }>(a: T, b: T) {\n\tif (a.index < b.index) {\n\t\treturn -1\n\t} else if (a.index > b.index) {\n\t\treturn 1\n\t}\n\treturn 0\n}\n\n/** @internal */\nexport const USER_COLORS = [\n\t'#FF802B',\n\t'#EC5E41',\n\t'#F2555A',\n\t'#F04F88',\n\t'#E34BA9',\n\t'#BD54C6',\n\t'#9D5BD2',\n\t'#7B66DC',\n\t'#02B1CC',\n\t'#11B3A3',\n\t'#39B178',\n\t'#55B467',\n]\n\nfunction redactRecordForErrorReporting(record: any) {\n\tif (record.typeName === 'asset') {\n\t\tif ('src' in record) {\n\t\t\trecord.src = '<redacted>'\n\t\t}\n\n\t\tif ('src' in record.props) {\n\t\t\trecord.props.src = '<redacted>'\n\t\t}\n\t}\n}\n\n/** @public */\nexport type TLStoreSchema = StoreSchema<TLRecord, TLStoreProps>\n\n/**\t@public */\nexport type TLStoreSnapshot = StoreSnapshot<TLRecord>\n\n/**\t@public */\nexport type TLStoreProps = {\n\tuserId: TLUserId\n\tinstanceId: TLInstanceId\n\tdocumentId: typeof TLDOCUMENT_ID\n}\n\n/** @public */\nexport type TLStore = Store<TLRecord, TLStoreProps>\n\n/** @public */\nexport const onValidationFailure: StoreSchemaOptions<\n\tTLRecord,\n\tTLStoreProps\n>['onValidationFailure'] = ({ error, phase, record, recordBefore }): TLRecord => {\n\tconst isExistingValidationIssue =\n\t\t// if we're initializing the store for the first time, we should\n\t\t// allow invalid records so people can load old buggy data:\n\t\tphase === 'initialize'\n\n\tannotateError(error, {\n\t\ttags: {\n\t\t\torigin: 'store.validateRecord',\n\t\t\tstorePhase: phase,\n\t\t\tisExistingValidationIssue,\n\t\t},\n\t\textras: {\n\t\t\trecordBefore: recordBefore\n\t\t\t\t? redactRecordForErrorReporting(structuredClone(recordBefore))\n\t\t\t\t: undefined,\n\t\t\trecordAfter: redactRecordForErrorReporting(structuredClone(record)),\n\t\t},\n\t})\n\n\tthrow error\n}\n\nfunction getRandomColor() {\n\treturn USER_COLORS[Math.floor(Math.random() * USER_COLORS.length)]\n}\n\nfunction getDefaultPages() {\n\treturn [TLPage.create({ name: 'Page 1', index: 'a1' })]\n}\n\n/** @internal */\nexport function ensureStoreIsUsable(store: TLStore): void {\n\tconst { userId, instanceId: tabId } = store.props\n\t// make sure we have exactly one document\n\tif (!store.has(TLDOCUMENT_ID)) {\n\t\tstore.put([TLDocument.create({ id: TLDOCUMENT_ID })])\n\t\treturn ensureStoreIsUsable(store)\n\t}\n\n\tconst allRecords = store.allRecords()\n\n\t// make sure we have document state for the current user\n\tconst userDocumentSettings = allRecords\n\t\t.filter(TLUserDocument.isInstance)\n\t\t.find((ud) => ud.userId === userId)\n\n\tif (!userDocumentSettings) {\n\t\tstore.put([TLUserDocument.create({ userId })])\n\t\treturn ensureStoreIsUsable(store)\n\t}\n\n\t// make sure there is at least one page\n\tconst pages = allRecords.filter(TLPage.isInstance).sort(sortByIndex)\n\tif (pages.length === 0) {\n\t\tstore.put(getDefaultPages())\n\t\treturn ensureStoreIsUsable(store)\n\t}\n\n\t// make sure we have state for the current user's current tab\n\tconst instanceState = allRecords.filter(TLInstance.isInstance).find((t) => t.id === tabId)\n\tif (!instanceState) {\n\t\t// The tab props are either the the last used tab's props or undefined\n\t\tconst propsForNextShape = userDocumentSettings.lastUsedTabId\n\t\t\t? store.get(userDocumentSettings.lastUsedTabId)?.propsForNextShape\n\t\t\t: undefined\n\n\t\t// The current page is either the last updated page or the first page\n\t\tconst currentPageId = userDocumentSettings?.lastUpdatedPageId ?? pages[0].id!\n\n\t\tstore.put([\n\t\t\tTLInstance.create({\n\t\t\t\tid: tabId,\n\t\t\t\tuserId,\n\t\t\t\tcurrentPageId,\n\t\t\t\tpropsForNextShape,\n\t\t\t\texportBackground: true,\n\t\t\t}),\n\t\t])\n\n\t\treturn ensureStoreIsUsable(store)\n\t}\n\n\t// make sure the user's currentPageId is still valid\n\tlet currentPageId = instanceState.currentPageId\n\tif (!pages.find((p) => p.id === currentPageId)) {\n\t\tcurrentPageId = pages[0].id!\n\t\tstore.put([{ ...instanceState, currentPageId }])\n\t\treturn ensureStoreIsUsable(store)\n\t}\n\n\t// make sure we have a user state record for the current user\n\tif (!allRecords.find((u) => u.id === userId)) {\n\t\tstore.put([TLUser.create({ id: userId })])\n\t\treturn ensureStoreIsUsable(store)\n\t}\n\n\tconst userPresences = allRecords\n\t\t.filter(TLUserPresence.isInstance)\n\t\t.filter((r) => r.userId === userId)\n\tif (userPresences.length === 0) {\n\t\tstore.put([TLUserPresence.create({ userId, color: getRandomColor() })])\n\t\treturn ensureStoreIsUsable(store)\n\t} else if (userPresences.length > 1) {\n\t\t// make sure we don't duplicate user presences\n\t\tstore.remove(userPresences.slice(1).map((r) => r.id))\n\t}\n\n\t// make sure each page has a instancePageState and camera\n\tfor (const page of pages) {\n\t\tconst instancePageStates = allRecords\n\t\t\t.filter(TLInstancePageState.isInstance)\n\t\t\t.filter((tps) => tps.pageId === page.id && tps.instanceId === tabId)\n\t\tif (instancePageStates.length > 1) {\n\t\t\t// make sure we only have one instancePageState per instance per page\n\t\t\tstore.remove(instancePageStates.slice(1).map((ips) => ips.id))\n\t\t} else if (instancePageStates.length === 0) {\n\t\t\tconst camera = TLCamera.create({})\n\t\t\tstore.put([\n\t\t\t\tcamera,\n\t\t\t\tTLInstancePageState.create({ pageId: page.id, instanceId: tabId, cameraId: camera.id }),\n\t\t\t])\n\t\t\treturn ensureStoreIsUsable(store)\n\t\t}\n\n\t\t// clear ephemeral state\n\t\tstore.put([\n\t\t\t{\n\t\t\t\t...instancePageStates[0],\n\t\t\t\terasingIds: [],\n\t\t\t\thoveredId: null,\n\t\t\t\teditingId: null,\n\t\t\t},\n\t\t])\n\n\t\t// make sure the camera exists\n\t\tconst camera = store.get(instancePageStates[0].cameraId)\n\t\tif (!camera) {\n\t\t\tstore.put([TLCamera.create({ id: instancePageStates[0].cameraId })])\n\t\t\treturn ensureStoreIsUsable(store)\n\t\t}\n\t}\n}\n","import { BaseRecord } from '@tldraw/tlstore'\nimport { T } from '@tldraw/tlvalidate'\nimport { TLAssetId } from '../records/TLAsset'\nimport { assetIdValidator } from '../validation'\n\n/** @public */\nexport interface TLBaseAsset<Type extends string, Props> extends BaseRecord<'asset'> {\n\ttype: Type\n\tprops: Props\n}\n\n/** @public */\nexport function createAssetValidator<Type extends string, Props extends object>(\n\ttype: Type,\n\tprops: T.Validator<Props>\n): T.ObjectValidator<{\n\tid: TLAssetId\n\ttypeName: 'asset'\n\ttype: Type\n\tprops: Props\n}> {\n\treturn T.object({\n\t\tid: assetIdValidator,\n\t\ttypeName: T.literal('asset'),\n\t\ttype: T.literal(type),\n\t\tprops,\n\t})\n}\n","import { defineMigrations } from '@tldraw/tlstore'\nimport { T } from '@tldraw/tlvalidate'\nimport { createAssetValidator, TLBaseAsset } from './asset-validation'\n\n// --- DEFINITION ---\n/** @public */\nexport type TLBookmarkAsset = TLBaseAsset<\n\t'bookmark',\n\t{\n\t\ttitle: string\n\t\tdescription: string\n\t\timage: string\n\t\tsrc: string | null\n\t}\n>\n\n// --- VALIDATION ---\n/** @public */\nexport const bookmarkAssetTypeValidator: T.Validator<TLBookmarkAsset> = createAssetValidator(\n\t'bookmark',\n\tT.object({\n\t\ttitle: T.string,\n\t\tdescription: T.string,\n\t\timage: T.string,\n\t\tsrc: T.string.nullable(),\n\t})\n)\n\n// --- MIGRATIONS ---\n// STEP 1: Add a new version number here, give it a meaningful name.\n// It should be 1 higher than the current version\nconst Versions = {\n\tInitial: 0,\n} as const\n\n/** @public */\nexport const bookmarkAssetMigrations = defineMigrations({\n\tfirstVersion: Versions.Initial,\n\t// STEP 2: Update the current version to point to your latest version\n\tcurrentVersion: Versions.Initial,\n\t// STEP 3: Add an up+down migration for the new version here\n\tmigrators: {},\n})\n","import { defineMigrations } from '@tldraw/tlstore'\nimport { T } from '@tldraw/tlvalidate'\nimport { createAssetValidator, TLBaseAsset } from './asset-validation'\n\n// --- DEFINITION ---\n/** @public */\nexport type TLImageAsset = TLBaseAsset<\n\t'image',\n\t{\n\t\tw: number\n\t\th: number\n\t\tname: string\n\t\tisAnimated: boolean\n\t\tmimeType: string | null\n\t\tsrc: string | null\n\t}\n>\n\n// --- VALIDATION ---\n/** @public */\nexport const imageAssetTypeValidator: T.Validator<TLImageAsset> = createAssetValidator(\n\t'image',\n\tT.object({\n\t\tw: T.number,\n\t\th: T.number,\n\t\tname: T.string,\n\t\tisAnimated: T.boolean,\n\t\tmimeType: T.string.nullable(),\n\t\tsrc: T.string.nullable(),\n\t})\n)\n\n// --- MIGRATIONS ---\n// STEP 1: Add a new version number here, give it a meaningful name.\n// It should be 1 higher than the current version\nconst Versions = {\n\tInitial: 0,\n\tAddIsAnimated: 1,\n\tRenameWidthHeight: 2,\n} as const\n\n/** @public */\nexport const imageAssetMigrations = defineMigrations({\n\tfirstVersion: Versions.Initial,\n\t// STEP 2: Update the current version to point to your latest version\n\tcurrentVersion: Versions.RenameWidthHeight,\n\t// STEP 3: Add an up+down migration for the new version here\n\tmigrators: {\n\t\t[Versions.AddIsAnimated]: {\n\t\t\tup: (asset) => {\n\t\t\t\treturn {\n\t\t\t\t\t...asset,\n\t\t\t\t\tprops: {\n\t\t\t\t\t\t...asset.props,\n\t\t\t\t\t\tisAnimated: false,\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t},\n\t\t\tdown: (asset) => {\n\t\t\t\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\n\t\t\t\tconst { isAnimated, ...rest } = asset.props\n\t\t\t\treturn {\n\t\t\t\t\t...asset,\n\t\t\t\t\tprops: rest,\n\t\t\t\t}\n\t\t\t},\n\t\t},\n\t\t[Versions.RenameWidthHeight]: {\n\t\t\tup: (asset) => {\n\t\t\t\tconst { width, height, ...others } = asset.props\n\t\t\t\treturn { ...asset, props: { w: width, h: height, ...others } }\n\t\t\t},\n\t\t\tdown: (asset) => {\n\t\t\t\tconst { w, h, ...others } = asset.props\n\t\t\t\treturn { ...asset, props: { width: w, height: h, ...others } }\n\t\t\t},\n\t\t},\n\t},\n})\n","import { defineMigrations } from '@tldraw/tlstore'\nimport { T } from '@tldraw/tlvalidate'\nimport { createAssetValidator, TLBaseAsset } from './asset-validation'\n\n// --- DEFINITION ---\n// TODO: figure out what is actually being used\n/** @public */\nexport type TLVideoAsset = TLBaseAsset<\n\t'video',\n\t{\n\t\tw: number\n\t\th: number\n\t\tname: string\n\t\tisAnimated: boolean\n\t\tmimeType: string | null\n\t\tsrc: string | null\n\t}\n>\n\n// --- VALIDATION ---\n/** @public */\nexport const videoAssetTypeValidator: T.Validator<TLVideoAsset> = createAssetValidator(\n\t'video',\n\tT.object({\n\t\tw: T.number,\n\t\th: T.number,\n\t\tname: T.string,\n\t\tisAnimated: T.boolean,\n\t\tmimeType: T.string.nullable(),\n\t\tsrc: T.string.nullable(),\n\t})\n)\n\n// --- MIGRATIONS ---\n// STEP 1: Add a new version number here, give it a meaningful name.\n// It should be 1 higher than the current version\nconst Versions = {\n\tInitial: 0,\n\tAddIsAnimated: 1,\n\tRenameWidthHeight: 2,\n} as const\n\n/** @public */\nexport const videoAssetMigrations = defineMigrations({\n\tfirstVersion: Versions.Initial,\n\t// STEP 2: Update the current version to point to your latest version\n\tcurrentVersion: Versions.RenameWidthHeight,\n\t// STEP 3: Add an up+down migration for the new version here\n\tmigrators: {\n\t\t[Versions.AddIsAnimated]: {\n\t\t\tup: (asset) => {\n\t\t\t\treturn {\n\t\t\t\t\t...asset,\n\t\t\t\t\tprops: {\n\t\t\t\t\t\t...asset.props,\n\t\t\t\t\t\tisAnimated: false,\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t},\n\t\t\tdown: (asset) => {\n\t\t\t\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\n\t\t\t\tconst { isAnimated, ...rest } = asset.props\n\t\t\t\treturn {\n\t\t\t\t\t...asset,\n\t\t\t\t\tprops: rest,\n\t\t\t\t}\n\t\t\t},\n\t\t},\n\t\t[Versions.RenameWidthHeight]: {\n\t\t\tup: (asset) => {\n\t\t\t\tconst { width, height, ...others } = asset.props\n\t\t\t\treturn { ...asset, props: { w: width, h: height, ...others } }\n\t\t\t},\n\t\t\tdown: (asset) => {\n\t\t\t\tconst { w, h, ...others } = asset.props\n\t\t\t\treturn { ...asset, props: { width: w, height: h, ...others } }\n\t\t\t},\n\t\t},\n\t},\n})\n","import { StoreSnapshot } from '@tldraw/tlstore'\nimport { TLRecord } from './TLRecord'\nimport { Vec2dModel } from './geometry-types'\n\n/** @internal */\nexport function CLIENT_FIXUP_SCRIPT(persistedStore: StoreSnapshot<TLRecord>) {\n\tconst records = Object.values(persistedStore)\n\n\tfor (let i = 0; i < records.length; i++) {\n\t\tif (!records[i]) continue\n\n\t\tconst { record } = fixupRecord(records[i])\n\n\t\tif (record) {\n\t\t\tpersistedStore[records[i].id] = record\n\t\t} else {\n\t\t\tdelete persistedStore[records[i].id]\n\t\t}\n\t}\n\n\treturn persistedStore\n}\n\n/** @internal */\nexport function fixupRecord(oldRecord: TLRecord) {\n\tconst issues: string[] = []\n\n\tlet record = JSON.parse(JSON.stringify(oldRecord))\n\n\tswitch (record.typeName) {\n\t\tcase 'user_presence': {\n\t\t\tif (!record.cursor) {\n\t\t\t\tissues.push('no cursor')\n\t\t\t\trecord.cursor = { x: 0, y: 0 }\n\t\t\t}\n\n\t\t\tif (record.cursor.x === undefined || record.cursor.x === null) {\n\t\t\t\tissues.push('no cursor x')\n\t\t\t\trecord.cursor.x = 0\n\t\t\t}\n\t\t\tif (record.cursor.y === undefined || record.cursor.y === null) {\n\t\t\t\tissues.push('no cursor y')\n\t\t\t\trecord.cursor.y = 0\n\t\t\t}\n\n\t\t\tbreak\n\t\t}\n\n\t\tcase 'asset': {\n\t\t\tswitch (record.type) {\n\t\t\t\tcase 'image':\n\t\t\t\tcase 'video': {\n\t\t\t\t\tif (!record.props) {\n\t\t\t\t\t\tissues.push('no props in asset')\n\t\t\t\t\t\trecord.props = {\n\t\t\t\t\t\t\tw: 100,\n\t\t\t\t\t\t\th: 100,\n\t\t\t\t\t\t\tname: 'old_asset',\n\t\t\t\t\t\t\tisAnimated: false,\n\t\t\t\t\t\t\tmimeType: null,\n\t\t\t\t\t\t\tsrc: null,\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!record.props.mimeType) {\n\t\t\t\t\t\tissues.push('no mimeType in asset props')\n\t\t\t\t\t\trecord.props.mimeType = 'image/png'\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!record.props.src) {\n\t\t\t\t\t\tissues.push('no src in asset props')\n\t\t\t\t\t\trecord.props.src = ''\n\t\t\t\t\t}\n\n\t\t\t\t\tif (record.props.isAnimated == null) {\n\t\t\t\t\t\tissues.push('no isAnimated in asset props')\n\t\t\t\t\t\trecord.props.isAnimated = false\n\t\t\t\t\t}\n\n\t\t\t\t\tif (record.props.name === undefined) {\n\t\t\t\t\t\trecord.props.name = 'asset'\n\t\t\t\t\t}\n\n\t\t\t\t\tif ('width' in record) {\n\t\t\t\t\t\tissues.push('width in asset')\n\t\t\t\t\t\trecord.props.w = record.width\n\t\t\t\t\t\tdelete record.width\n\t\t\t\t\t}\n\t\t\t\t\tif (\n\t\t\t\t\t\t'width' in record.props &&\n\t\t\t\t\t\ttypeof record.props.width === 'number' &&\n\t\t\t\t\t\trecord.props.width\n\t\t\t\t\t) {\n\t\t\t\t\t\tissues.push('no w in asset props')\n\t\t\t\t\t\trecord.props.w = record.props.width\n\t\t\t\t\t\tdelete record.props.width\n\t\t\t\t\t}\n\n\t\t\t\t\tif ('height' in record) {\n\t\t\t\t\t\tissues.push('height in asset')\n\t\t\t\t\t\trecord.props.h = record.height\n\t\t\t\t\t\tdelete record.height\n\t\t\t\t\t}\n\n\t\t\t\t\tif (\n\t\t\t\t\t\t'height' in record.props &&\n\t\t\t\t\t\ttypeof record.props.height === 'number' &&\n\t\t\t\t\t\trecord.props.height\n\t\t\t\t\t) {\n\t\t\t\t\t\tissues.push('no h in asset props')\n\t\t\t\t\t\trecord.props.h = record.props.height\n\t\t\t\t\t\tdelete record.props.height\n\t\t\t\t\t}\n\t\t\t\t\tif (!record.props.w) {\n\t\t\t\t\t\tissues.push('no w in asset props')\n\t\t\t\t\t\trecord.props.w = 100\n\t\t\t\t\t}\n\t\t\t\t\tif (!record.props.h) {\n\t\t\t\t\t\tissues.push('no h in asset props')\n\t\t\t\t\t\trecord.props.h = 100\n\t\t\t\t\t}\n\n\t\t\t\t\tif ('src' in record) {\n\t\t\t\t\t\tissues.push('src in asset')\n\t\t\t\t\t\trecord.props.src = record.src\n\t\t\t\t\t\tdelete record.src\n\t\t\t\t\t}\n\n\t\t\t\t\tif ('name' in record) {\n\t\t\t\t\t\tissues.push('name in asset')\n\t\t\t\t\t\tdelete record.name\n\t\t\t\t\t}\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t\tcase 'bookmark':\n\t\t\t\t\tif (!record.props) {\n\t\t\t\t\t\tissues.push('no asset props')\n\t\t\t\t\t\trecord.props = {\n\t\t\t\t\t\t\ttitle: '',\n\t\t\t\t\t\t\tdescription: '',\n\t\t\t\t\t\t\timage: '',\n\t\t\t\t\t\t\tsrc: 'url' in record && typeof record.url === 'string' ? record.url : '',\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!record.props.title) {\n\t\t\t\t\t\tissues.push('no title in bookmark asset props')\n\t\t\t\t\t\trecord.props.title = ''\n\t\t\t\t\t}\n\t\t\t\t\tif (!record.props.description) {\n\t\t\t\t\t\tissues.push('no description in bookmark asset props')\n\t\t\t\t\t\trecord.props.description = ''\n\t\t\t\t\t}\n\t\t\t\t\tif (!record.props.image) {\n\t\t\t\t\t\tissues.push('no image in bookmark asset props')\n\t\t\t\t\t\trecord.props.image = ''\n\t\t\t\t\t}\n\n\t\t\t\t\tif ('src' in record) {\n\t\t\t\t\t\tissues.push('leftover src in bookmark asset')\n\t\t\t\t\t\tdelete record.src\n\t\t\t\t\t}\n\t\t\t\t\tif ('width' in record) {\n\t\t\t\t\t\tissues.push('leftover width in bookmark asset')\n\t\t\t\t\t\tdelete record.width\n\t\t\t\t\t}\n\t\t\t\t\tif ('height' in record) {\n\t\t\t\t\t\tissues.push('leftover height in bookmark asset')\n\t\t\t\t\t\tdelete record.height\n\t\t\t\t\t}\n\t\t\t\t\tif ('name' in record) {\n\t\t\t\t\t\tissues.push('leftover name in bookmark asset')\n\t\t\t\t\t\tdelete record.name\n\t\t\t\t\t}\n\n\t\t\t\t\tif ('meta' in record) {\n\t\t\t\t\t\tdelete record.meta\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak\n\t\t\t}\n\t\t\tbreak\n\t\t}\n\t\tcase 'camera': {\n\t\t\tif (record.x === undefined || record.x === null) {\n\t\t\t\tissues.push('no x in camera')\n\t\t\t\trecord.x = 0\n\t\t\t}\n\t\t\tif (record.y === undefined || record.y === null) {\n\t\t\t\tissues.push('no y in camera')\n\t\t\t\trecord.y = 0\n\t\t\t}\n\t\t\tbreak\n\t\t}\n\t\tcase 'instance': {\n\t\t\tif ('props' in record) {\n\t\t\t\tissues.push('leftover props in instance')\n\t\t\t\tdelete record.props\n\t\t\t}\n\n\t\t\tif (record.isToolLocked === undefined) {\n\t\t\t\tissues.push('no isToolLocked in instance')\n\t\t\t\trecord.isToolLocked = false\n\t\t\t}\n\n\t\t\tif (record.propsForNextShape === undefined) {\n\t\t\t\tissues.push('no props in instance')\n\t\t\t\trecord.propsForNextShape = {\n\t\t\t\t\topacity: '1',\n\t\t\t\t\tcolor: 'black',\n\t\t\t\t\tdash: 'draw',\n\t\t\t\t\tfill: 'none',\n\t\t\t\t\tsize: 'm',\n\t\t\t\t\ticon: 'file',\n\t\t\t\t\tfont: 'draw',\n\t\t\t\t\talign: 'middle',\n\t\t\t\t\tgeo: 'rectangle',\n\t\t\t\t\tarrowheadStart: 'none',\n\t\t\t\t\tarrowheadEnd: 'arrow',\n\t\t\t\t\tspline: 'line',\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ('url' in record.propsForNextShape) {\n\t\t\t\tissues.push('leftover url in instance.propsForNextShape')\n\t\t\t\tdelete record.propsForNextShape.url\n\t\t\t}\n\n\t\t\tif ('lang' in record.propsForNextShape) {\n\t\t\t\tissues.push('leftover lang in instance.propsForNextShape')\n\t\t\t\tdelete record.propsForNextShape.lang\n\t\t\t}\n\n\t\t\tif (record.exportBackground === undefined) {\n\t\t\t\tissues.push(`no export background in ${record.typeName}`)\n\t\t\t\trecord.exportBackground = false\n\t\t\t}\n\t\t\tif (record.brush === undefined) {\n\t\t\t\tissues.push(`no brush in ${record.typeName}`)\n\t\t\t\trecord.brush = null\n\t\t\t}\n\t\t\tif (record.scribble === undefined) {\n\t\t\t\tissues.push(`no scribble in ${record.typeName}`)\n\t\t\t\trecord.scribble = null\n\t\t\t}\n\n\t\t\tif (record.dialog !== undefined) {\n\t\t\t\tissues.push(`no dialog in ${record.typeName}`)\n\t\t\t\tdelete record.dialog\n\t\t\t}\n\n\t\t\tif (record.screenBounds === undefined) {\n\t\t\t\tissues.push(`no screen bounds in ${record.typeName}`)\n\t\t\t\trecord.screenBounds = { x: 0, y: 0, w: 1080, h: 720 }\n\t\t\t}\n\n\t\t\tbreak\n\t\t}\n\t\tcase 'user': {\n\t\t\tif (!record.name) {\n\t\t\t\tissues.push(`no name in user`)\n\t\t\t\trecord.name = 'User'\n\t\t\t}\n\t\t\tif (!record.locale) {\n\t\t\t\tissues.push(`no locale in user`)\n\t\t\t\trecord.locale = 'en'\n\t\t\t}\n\t\t\tif ('cursor' in record) {\n\t\t\t\tissues.push('leftover cursor in user')\n\t\t\t\tdelete record.cursor\n\t\t\t}\n\t\t\tif ('color' in record) {\n\t\t\t\tissues.push('leftover color in user')\n\t\t\t\tdelete record.color\n\t\t\t}\n\t\t\tif ('brush' in record) {\n\t\t\t\tissues.push('leftover brush in user')\n\t\t\t\tdelete record.brush\n\t\t\t}\n\t\t\tif ('selectedIds' in record) {\n\t\t\t\tissues.push('leftover selectedIds in user')\n\t\t\t\tdelete record.selectedIds\n\t\t\t}\n\t\t\tif ('scribble' in record) {\n\t\t\t\tissues.push('leftover scribble in user')\n\t\t\t\tdelete record.scribble\n\t\t\t}\n\t\t\tif ('currentPageId' in record) {\n\t\t\t\tissues.push('leftover currentPageId in user')\n\t\t\t\tdelete record.currentPageId\n\t\t\t}\n\t\t\tbreak\n\t\t}\n\t\tcase 'user_document': {\n\t\t\tif (record.isMobileMode === undefined) {\n\t\t\t\tissues.push(`no ismobilemode in user document`)\n\t\t\t\trecord.isMobileMode = false\n\t\t\t}\n\n\t\t\tif (record.isSnapMode === undefined) {\n\t\t\t\tissues.push(`no issnapmode in user document`)\n\t\t\t\trecord.isSnapMode = false\n\t\t\t}\n\t\t\tbreak\n\t\t}\n\t\tcase 'shape': {\n\t\t\tif ('url' in record) {\n\t\t\t\tdelete record.url\n\t\t\t}\n\n\t\t\tif (record.x === undefined || record.x === null) {\n\t\t\t\tissues.push(`some bug in ${record.typeName} ${record.type}`)\n\t\t\t\trecord.x = 0\n\t\t\t}\n\t\t\tif (record.y === undefined || record.y === null) {\n\t\t\t\tissues.push(`some bug in ${record.typeName} ${record.type}`)\n\t\t\t\trecord.y = 0\n\t\t\t}\n\n\t\t\tif (record.type === 'image') {\n\t\t\t\tif (record.props.playing === undefined) {\n\t\t\t\t\tissues.push(`some bug in ${record.typeName} ${record.type}`)\n\t\t\t\t\trecord.props.playing = false\n\t\t\t\t}\n\n\t\t\t\tif ('loaded' in record.props) {\n\t\t\t\t\tdelete record.props.loaded\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (record.type === 'arrow') {\n\t\t\t\tif (record.props.start.type === 'binding') {\n\t\t\t\t\tif (\n\t\t\t\t\t\trecord.props.start.normalizedAnchor.x === undefined ||\n\t\t\t\t\t\trecord.props.start.normalizedAnchor.x === null\n\t\t\t\t\t) {\n\t\t\t\t\t\tissues.push(`some bug in ${record.typeName} ${record.type}`)\n\t\t\t\t\t\trecord.props.start.normalizedAnchor.x = 0\n\t\t\t\t\t}\n\t\t\t\t\tif (\n\t\t\t\t\t\trecord.props.start.normalizedAnchor.y === undefined ||\n\t\t\t\t\t\trecord.props.start.normalizedAnchor.y === null\n\t\t\t\t\t) {\n\t\t\t\t\t\tissues.push(`some bug in ${record.typeName} ${record.type}`)\n\t\t\t\t\t\trecord.props.start.normalizedAnchor.y = 0\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (record.props.start.x === undefined || record.props.start.x === null) {\n\t\t\t\t\t\tissues.push(`some bug in ${record.typeName} ${record.type}`)\n\t\t\t\t\t\trecord.props.start.x = 0\n\t\t\t\t\t}\n\t\t\t\t\tif (record.props.start.y === undefined || record.props.start.y === null) {\n\t\t\t\t\t\tissues.push(`some bug in ${record.typeName} ${record.type}`)\n\t\t\t\t\t\trecord.props.start.y = 0\n\t\t\t\t\t}\n\t\t\t\t\tif ('boundShapeId' in record.props.start) {\n\t\t\t\t\t\tissues.push(`leftover bound shape id in arrow`)\n\t\t\t\t\t\tdelete record.props.start.boundShapeId\n\t\t\t\t\t}\n\t\t\t\t\tif ('normalizedAnchor' in record.props.start) {\n\t\t\t\t\t\tissues.push(`leftover normalize anchor in arrow`)\n\t\t\t\t\t\tdelete record.props.start.normalizedAnchor\n\t\t\t\t\t}\n\t\t\t\t\tif ('isExact' in record.props.start) {\n\t\t\t\t\t\tissues.push(`leftover isExact in arrow`)\n\t\t\t\t\t\tdelete record.props.start.isExact\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (record.props.end.type === 'binding') {\n\t\t\t\t\tif (\n\t\t\t\t\t\trecord.props.end.normalizedAnchor.x === undefined ||\n\t\t\t\t\t\trecord.props.end.normalizedAnchor.x === null\n\t\t\t\t\t) {\n\t\t\t\t\t\tissues.push(`some bug in ${record.typeName}  ${record.type}`)\n\t\t\t\t\t\trecord.props.end.normalizedAnchor.x = 0\n\t\t\t\t\t}\n\t\t\t\t\tif (\n\t\t\t\t\t\trecord.props.end.normalizedAnchor.y === undefined ||\n\t\t\t\t\t\trecord.props.end.normalizedAnchor.y === null\n\t\t\t\t\t) {\n\t\t\t\t\t\tissues.push(`some bug in ${record.typeName} ${record.type}`)\n\t\t\t\t\t\trecord.props.end.normalizedAnchor.y = 0\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (record.props.end.x === undefined || record.props.end.x === null) {\n\t\t\t\t\t\tissues.push(`no x in arrow end`)\n\t\t\t\t\t\trecord.props.end.x = 0\n\t\t\t\t\t}\n\t\t\t\t\tif (record.props.end.y === undefined || record.props.end.y === null) {\n\t\t\t\t\t\tissues.push(`no y in arrow end`)\n\t\t\t\t\t\trecord.props.end.y = 0\n\t\t\t\t\t}\n\t\t\t\t\tif ('boundShapeId' in record.props.end) {\n\t\t\t\t\t\tissues.push(`leftover bound shape id in arrow`)\n\t\t\t\t\t\tdelete record.props.end.boundShapeId\n\t\t\t\t\t}\n\t\t\t\t\tif ('normalizedAnchor' in record.props.end) {\n\t\t\t\t\t\tissues.push(`leftover normalize anchor in arrow`)\n\t\t\t\t\t\tdelete record.props.end.normalizedAnchor\n\t\t\t\t\t}\n\t\t\t\t\tif ('isExact' in record.props.end) {\n\t\t\t\t\t\tissues.push(`leftover isExact in arrow`)\n\t\t\t\t\t\tdelete record.props.end.isExact\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\trecord.type === 'note' ||\n\t\t\t\trecord.type === 'video' ||\n\t\t\t\trecord.type === 'image' ||\n\t\t\t\trecord.type === 'geo' ||\n\t\t\t\trecord.type === 'bookmark'\n\t\t\t) {\n\t\t\t\tif (record.props.url === undefined) {\n\t\t\t\t\tissues.push(`missing url prop in ${record.type} shape`)\n\t\t\t\t\trecord.props.url = ''\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (record.type === 'bookmark') {\n\t\t\t\tif (record.props.assetId === undefined) {\n\t\t\t\t\tissues.push(`some bug in ${record.typeName}  ${record.type}`)\n\t\t\t\t\trecord.props.assetId = null\n\t\t\t\t}\n\n\t\t\t\tif ('src' in record) {\n\t\t\t\t\tissues.push(`leftover src in bookmark`)\n\t\t\t\t\tdelete record.src\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (record.type === 'geo') {\n\t\t\t\tif ('width' in record.props) {\n\t\t\t\t\tissues.push(`leftover width in geo`)\n\t\t\t\t\tdelete record.props.width\n\t\t\t\t}\n\t\t\t\tif ('height' in record.props) {\n\t\t\t\t\tissues.push(`leftover height in geo`)\n\t\t\t\t\tdelete record.props.height\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (record.type === 'draw') {\n\t\t\t\tif (record.props.segments === undefined) {\n\t\t\t\t\tissues.push(`some bug in ${record.typeName}  ${record.type}`)\n\t\t\t\t\trecord.props.segments = [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tpoints: [\n\t\t\t\t\t\t\t\t{ x: 0, y: 0, z: 0.5 },\n\t\t\t\t\t\t\t\t{ x: 1, y: 1, z: 0.5 },\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\ttype: 'free',\n\t\t\t\t\t\t},\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t\tfor (const segment of record.props.segments) {\n\t\t\t\t\tfor (const point of segment.points) {\n\t\t\t\t\t\tif (point.x === undefined || point.y === null) {\n\t\t\t\t\t\t\tissues.push(`some bug in ${record.typeName}`)\n\t\t\t\t\t\t\tpoint.x = 0\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (point.y === undefined || point.y === null) {\n\t\t\t\t\t\t\tissues.push(`some bug in ${record.typeName}`)\n\t\t\t\t\t\t\tpoint.y = 0\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif ('points' in record.props) {\n\t\t\t\t\tdelete record.props.points\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (record.type === 'bookmark') {\n\t\t\t\tif ('loaded' in record.props) {\n\t\t\t\t\tissues.push('leftover loaded in bookmark')\n\t\t\t\t\tdelete record.props.loaded\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (record.type === 'draw') {\n\t\t\t\tif ('points' in record.props && record.props.segments === undefined) {\n\t\t\t\t\trecord.props.segments = [{ type: 'free', points: record.props.points as Vec2dModel[] }]\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (record.type === 'image') {\n\t\t\t\tif (record.props.w < 1) {\n\t\t\t\t\trecord.props.w = 1\n\t\t\t\t\tissues.push(`zero w image in ${record.typeName}`)\n\t\t\t\t}\n\t\t\t\tif (record.props.h < 1) {\n\t\t\t\t\trecord.props.h = 1\n\t\t\t\t\tissues.push(`zero h image in ${record.typeName}`)\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (record.type === 'embed') {\n\t\t\t\tif ('loaded' in record.props) {\n\t\t\t\t\tissues.push('leftover loaded in embed')\n\t\t\t\t\tdelete record.props.loaded\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tbreak\n\t\t}\n\t\tcase undefined: {\n\t\t\trecord = null\n\t\t}\n\t}\n\n\t// Assign the new record into the store\n\treturn { record, issues }\n}\n","import { createRecordType, defineMigrations, ID } from '@tldraw/tlstore'\nimport { T } from '@tldraw/tlvalidate'\nimport { TLBaseAsset } from '../assets/asset-validation'\nimport {\n\tbookmarkAssetMigrations,\n\tbookmarkAssetTypeValidator,\n\tTLBookmarkAsset,\n} from '../assets/TLBookmarkAsset'\nimport { imageAssetMigrations, imageAssetTypeValidator, TLImageAsset } from '../assets/TLImageAsset'\nimport { TLVideoAsset, videoAssetMigrations, videoAssetTypeValidator } from '../assets/TLVideoAsset'\nimport { TLShape } from './TLShape'\n\n// --- DEFINITION ---\n/** @public */\nexport type TLAsset = TLImageAsset | TLVideoAsset | TLBookmarkAsset\n\n// --- VALIDATION ---\n/** @public */\nexport const assetTypeValidator: T.Validator<TLAsset> = T.model(\n\t'asset',\n\tT.union('type', {\n\t\timage: imageAssetTypeValidator,\n\t\tvideo: videoAssetTypeValidator,\n\t\tbookmark: bookmarkAssetTypeValidator,\n\t})\n)\n\n// --- MIGRATIONS ---\n// STEP 1: Add a new version number here, give it a meaningful name.\n// It should be 1 higher than the current version\nconst Versions = {\n\tInitial: 0,\n} as const\n\n/** @public */\nexport const assetTypeMigrations = defineMigrations({\n\tfirstVersion: Versions.Initial,\n\t// STEP 2: Update the current version to point to your latest version\n\tcurrentVersion: Versions.Initial,\n\t// STEP 3: Add an up+down migration for the new version here\n\tmigrators: {},\n\tsubTypeKey: 'type',\n\tsubTypeMigrations: {\n\t\timage: imageAssetMigrations,\n\t\tvideo: videoAssetMigrations,\n\t\tbookmark: bookmarkAssetMigrations,\n\t},\n})\n\n/** @public */\nexport type TLAssetPartial<T extends TLAsset = TLAsset> = T extends T\n\t? {\n\t\t\tid: TLAssetId\n\t\t\ttype: T['type']\n\t\t\tprops?: Partial<T['props']>\n\t  } & Partial<Omit<T, 'type' | 'id' | 'props'>>\n\t: never\n\n/** @public */\nexport const TLAsset = createRecordType<TLAsset>('asset', {\n\tmigrations: assetTypeMigrations,\n\tvalidator: assetTypeValidator,\n})\n\n/** @public */\nexport type TLAssetId = ID<TLBaseAsset<any, any>>\n\n/** @public */\nexport type TLAssetShape = Extract<TLShape, { props: { assetId: TLAssetId } }>\n","import { BaseRecord, defineMigrations, ID } from '@tldraw/tlstore'\nimport { nanoid } from 'nanoid'\nimport { TLBaseShape } from '../shapes/shape-validation'\nimport { TLArrowShape } from '../shapes/TLArrowShape'\nimport { TLBookmarkShape } from '../shapes/TLBookmarkShape'\nimport { TLDrawShape } from '../shapes/TLDrawShape'\nimport { TLEmbedShape } from '../shapes/TLEmbedShape'\nimport { TLFrameShape } from '../shapes/TLFrameShape'\nimport { TLGeoShape } from '../shapes/TLGeoShape'\nimport { TLGroupShape } from '../shapes/TLGroupShape'\nimport { TLIconShape } from '../shapes/TLIconShape'\nimport { TLImageShape } from '../shapes/TLImageShape'\nimport { TLLineShape } from '../shapes/TLLineShape'\nimport { TLNoteShape } from '../shapes/TLNoteShape'\nimport { TLTextShape } from '../shapes/TLTextShape'\nimport { TLVideoShape } from '../shapes/TLVideoShape'\nimport { SmooshedUnionObject } from '../util-types'\nimport { TLPageId } from './TLPage'\n\n/** @public */\nexport type TLUnknownShape = TLBaseShape<string, object>\n\n/**\n * TLShape\n * @public\n */\nexport type TLShape =\n\t| TLArrowShape\n\t| TLBookmarkShape\n\t| TLDrawShape\n\t| TLEmbedShape\n\t| TLFrameShape\n\t| TLGeoShape\n\t| TLGroupShape\n\t| TLIconShape\n\t| TLImageShape\n\t| TLLineShape\n\t| TLNoteShape\n\t| TLTextShape\n\t| TLVideoShape\n\t| TLUnknownShape\n\n/** @public */\nexport type TLShapeType = TLShape['type']\n\n/** @public */\nexport type TLShapePartial<T extends TLShape = TLShape> = T extends T\n\t? {\n\t\t\tid: TLShapeId\n\t\t\ttype: T['type']\n\t\t\tprops?: Partial<T['props']>\n\t  } & Partial<Omit<T, 'type' | 'id' | 'props'>>\n\t: never\n\n/** @public */\nexport type TLShapeId = ID<TLBaseShape<any, any>>\n\n/** @public */\nexport type TLShapeProps = SmooshedUnionObject<TLShape['props']>\n\n/** @public */\nexport type TLShapeProp = keyof TLShapeProps\n\n/** @public */\nexport type TLParentId = TLPageId | TLShapeId\n\n/** @public */\nexport type TLNullableShapeProps = { [K in TLShapeProp]?: TLShapeProps[K] | null }\n\n// --- MIGRATIONS ---\n// STEP 1: Add a new version number here, give it a meaningful name.\n// It should be 1 higher than the current version\nconst Versions = {\n\tInitial: 0,\n\tAddIsLocked: 1,\n} as const\n\n/** @internal */\nexport const rootShapeTypeMigrations = defineMigrations({\n\t// STEP 2: Update the current version to point to your latest version\n\tcurrentVersion: Versions.AddIsLocked,\n\tfirstVersion: Versions.Initial,\n\tmigrators: {\n\t\t// STEP 3: Add an up+down migration for the new version here\n\t\t[Versions.AddIsLocked]: {\n\t\t\tup: (record) => {\n\t\t\t\treturn {\n\t\t\t\t\t...record,\n\t\t\t\t\tisLocked: false,\n\t\t\t\t}\n\t\t\t},\n\t\t\tdown: (record) => {\n\t\t\t\tconst { isLocked: _, ...rest } = record\n\t\t\t\treturn {\n\t\t\t\t\t...rest,\n\t\t\t\t}\n\t\t\t},\n\t\t},\n\t},\n})\n\n/** @public */\nexport function isShape(record?: BaseRecord<string>): record is TLShape {\n\tif (!record) return false\n\treturn record.typeName === 'shape'\n}\n\n/** @public */\nexport function isShapeId(id?: string): id is TLShapeId {\n\tif (!id) return false\n\treturn id.startsWith('shape:')\n}\n\n/** @public */\nexport function createShapeId(): TLShapeId {\n\treturn `shape:${nanoid()}` as TLShapeId\n}\n\n/** @public */\nexport function createCustomShapeId(id: string): TLShapeId {\n\treturn `shape:${id}` as TLShapeId\n}\n","import { defineMigrations, StoreSnapshot } from '@tldraw/tlstore'\nimport { TLRecord } from './TLRecord'\n\n// --- MIGRATIONS ---\n// STEP 1: Add a new version number here, give it a meaningful name.\n// It should be 1 higher than the current version\nconst Versions = {\n\tInitial: 0,\n\tRemoveCodeAndIconShapeTypes: 1,\n} as const\n\n/** @public */\nexport const storeMigrations = defineMigrations({\n\t// STEP 2: Update the current version to point to your latest version\n\tfirstVersion: Versions.Initial,\n\tcurrentVersion: Versions.RemoveCodeAndIconShapeTypes,\n\tmigrators: {\n\t\t// STEP 3: Add an up+down migration for the new version here\n\t\t[Versions.RemoveCodeAndIconShapeTypes]: {\n\t\t\tup: (store: StoreSnapshot<TLRecord>) => {\n\t\t\t\treturn Object.fromEntries(\n\t\t\t\t\tObject.entries(store).filter(\n\t\t\t\t\t\t([_, v]) => v.typeName !== 'shape' || (v.type !== 'icon' && v.type !== 'code')\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t},\n\t\t\tdown: (store: StoreSnapshot<TLRecord>) => {\n\t\t\t\t// noop\n\t\t\t\treturn store\n\t\t\t},\n\t\t},\n\t},\n})\n","import { BaseRecord } from '@tldraw/tlstore'\nimport { T } from '@tldraw/tlvalidate'\nimport { TLParentId } from '../records/TLShape'\nimport { parentIdValidator, shapeIdValidator } from '../validation'\n\n/** @public */\nexport interface TLBaseShape<Type extends string, Props extends object>\n\textends BaseRecord<'shape'> {\n\ttype: Type\n\tx: number\n\ty: number\n\trotation: number\n\tindex: string\n\tparentId: TLParentId\n\tisLocked: boolean\n\tprops: Props\n}\n\n/** @public */\nexport function createShapeValidator<Type extends string, Props extends object>(\n\ttype: Type,\n\tprops: T.Validator<Props>\n) {\n\treturn T.object({\n\t\tid: shapeIdValidator,\n\t\ttypeName: T.literal('shape'),\n\t\tx: T.number,\n\t\ty: T.number,\n\t\trotation: T.number,\n\t\tindex: T.string,\n\t\tparentId: parentIdValidator,\n\t\ttype: T.literal(type),\n\t\tisLocked: T.boolean,\n\t\tprops,\n\t})\n}\n","import { defineMigrations } from '@tldraw/tlstore'\nimport { T } from '@tldraw/tlvalidate'\nimport { Vec2dModel } from '../geometry-types'\nimport { TLShapeId } from '../records/TLShape'\nimport {\n\tTLArrowheadType,\n\tTLColorType,\n\tTLDashType,\n\tTLFillType,\n\tTLFontType,\n\tTLOpacityType,\n\tTLSizeType,\n} from '../style-types'\nimport { SetValue } from '../util-types'\nimport {\n\tarrowheadValidator,\n\tcolorValidator,\n\tdashValidator,\n\tfillValidator,\n\tfontValidator,\n\topacityValidator,\n\tshapeIdValidator,\n\tsizeValidator,\n} from '../validation'\nimport { TLBaseShape, createShapeValidator } from './shape-validation'\n\n/** @public */\nexport type TLArrowShapeProps = {\n\tlabelColor: TLColorType\n\tcolor: TLColorType\n\tfill: TLFillType\n\tdash: TLDashType\n\tsize: TLSizeType\n\topacity: TLOpacityType\n\tarrowheadStart: TLArrowheadType\n\tarrowheadEnd: TLArrowheadType\n\tfont: TLFontType\n\tstart: TLArrowTerminal\n\tend: TLArrowTerminal\n\tbend: number\n\ttext: string\n}\n\n/** @public */\nexport type TLArrowShape = TLBaseShape<'arrow', TLArrowShapeProps>\n\n/** @public */\nexport const TL_ARROW_TERMINAL_TYPE = new Set(['binding', 'point'] as const)\n\n/** @public */\nexport type TLArrowTerminalType = SetValue<typeof TL_ARROW_TERMINAL_TYPE>\n\n/** @public */\nexport type TLArrowTerminal =\n\t| {\n\t\t\ttype: 'binding'\n\t\t\tboundShapeId: TLShapeId\n\t\t\tnormalizedAnchor: Vec2dModel\n\t\t\tisExact: boolean\n\t  }\n\t| { type: 'point'; x: number; y: number }\n\n/**\n * A base interface for a shape's arrowheads.\n *\n * @public\n */\nexport interface TLArrowHeadModel {\n\tid: string\n\ttype: TLArrowheadType\n}\n\n// --- VALIDATION ---\n/** @public */\nexport const arrowTerminalTypeValidator: T.Validator<TLArrowTerminal> = T.union('type', {\n\tbinding: T.object({\n\t\ttype: T.literal('binding'),\n\t\tboundShapeId: shapeIdValidator,\n\t\tnormalizedAnchor: T.point,\n\t\tisExact: T.boolean,\n\t}),\n\tpoint: T.object({\n\t\ttype: T.literal('point'),\n\t\tx: T.number,\n\t\ty: T.number,\n\t}),\n})\n\n/** @public */\nexport const arrowShapeTypeValidator: T.Validator<TLArrowShape> = createShapeValidator(\n\t'arrow',\n\tT.object({\n\t\tlabelColor: colorValidator,\n\t\tcolor: colorValidator,\n\t\tfill: fillValidator,\n\t\tdash: dashValidator,\n\t\tsize: sizeValidator,\n\t\topacity: opacityValidator,\n\t\tarrowheadStart: arrowheadValidator,\n\t\tarrowheadEnd: arrowheadValidator,\n\t\tfont: fontValidator,\n\t\tstart: arrowTerminalTypeValidator,\n\t\tend: arrowTerminalTypeValidator,\n\t\tbend: T.number,\n\t\ttext: T.string,\n\t})\n)\n\n// --- MIGRATIONS ---\n// STEP 1: Add a new version number here, give it a meaningful name.\n// It should be 1 higher than the current version\nconst Versions = {\n\tInitial: 0,\n\tAddLabelColor: 1,\n} as const\n\n/** @public */\nexport const arrowShapeMigrations = defineMigrations({\n\t// STEP 2: Update the current version to point to your latest version\n\tcurrentVersion: Versions.AddLabelColor,\n\tfirstVersion: Versions.Initial,\n\tmigrators: {\n\t\t// STEP 3: Add an up+down migration for the new version here\n\t\t[Versions.AddLabelColor]: {\n\t\t\tup: (record) => {\n\t\t\t\treturn {\n\t\t\t\t\t...record,\n\t\t\t\t\tprops: {\n\t\t\t\t\t\t...record.props,\n\t\t\t\t\t\tlabelColor: 'black',\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t},\n\t\t\tdown: (record) => {\n\t\t\t\tconst { labelColor: _, ...props } = record.props\n\t\t\t\treturn {\n\t\t\t\t\t...record,\n\t\t\t\t\tprops,\n\t\t\t\t}\n\t\t\t},\n\t\t},\n\t},\n})\n","import { defineMigrations } from '@tldraw/tlstore'\nimport { T } from '@tldraw/tlvalidate'\nimport { TLAssetId } from '../records/TLAsset'\nimport { TLOpacityType } from '../style-types'\nimport { assetIdValidator, opacityValidator } from '../validation'\nimport { TLBaseShape, createShapeValidator } from './shape-validation'\n\n/** @public */\nexport type TLBookmarkShapeProps = {\n\topacity: TLOpacityType\n\tw: number\n\th: number\n\tassetId: TLAssetId | null\n\turl: string\n}\n\n/** @public */\nexport type TLBookmarkShape = TLBaseShape<'bookmark', TLBookmarkShapeProps>\n\n// --- VALIDATION ---\n/** @public */\nexport const bookmarkShapeTypeValidator: T.Validator<TLBookmarkShape> = createShapeValidator(\n\t'bookmark',\n\tT.object({\n\t\topacity: opacityValidator,\n\t\tw: T.nonZeroNumber,\n\t\th: T.nonZeroNumber,\n\t\tassetId: assetIdValidator.nullable(),\n\t\turl: T.string,\n\t})\n)\n\n// --- MIGRATIONS ---\n// STEP 1: Add a new version number here, give it a meaningful name.\n// It should be 1 higher than the current version\nconst Versions = {\n\tInitial: 0,\n\tNullAssetId: 1,\n} as const\n\n/** @public */\nexport const bookmarkShapeMigrations = defineMigrations({\n\tfirstVersion: Versions.Initial,\n\t// STEP 2: Update the current version to point to your latest version\n\tcurrentVersion: Versions.NullAssetId,\n\t// STEP 3: Add an up+down migration for the new version here\n\tmigrators: {\n\t\t[Versions.NullAssetId]: {\n\t\t\tup: (shape: TLBookmarkShape) => {\n\t\t\t\tif (shape.props.assetId === undefined) {\n\t\t\t\t\treturn { ...shape, props: { ...shape.props, assetId: null } } as typeof shape\n\t\t\t\t}\n\t\t\t\treturn shape\n\t\t\t},\n\t\t\tdown: (shape: TLBookmarkShape) => {\n\t\t\t\tif (shape.props.assetId === null) {\n\t\t\t\t\tconst { assetId: _, ...props } = shape.props\n\t\t\t\t\treturn { ...shape, props } as typeof shape\n\t\t\t\t}\n\t\t\t\treturn shape\n\t\t\t},\n\t\t},\n\t},\n})\n","import { defineMigrations } from '@tldraw/tlstore'\nimport { T } from '@tldraw/tlvalidate'\nimport { Vec2dModel } from '../geometry-types'\nimport { TLColorType, TLDashType, TLFillType, TLOpacityType, TLSizeType } from '../style-types'\nimport { SetValue } from '../util-types'\nimport {\n\tcolorValidator,\n\tdashValidator,\n\tfillValidator,\n\topacityValidator,\n\tsizeValidator,\n} from '../validation'\nimport { TLBaseShape, createShapeValidator } from './shape-validation'\n\n/** @public */\nexport const TL_DRAW_SHAPE_SEGMENT_TYPE = new Set(['free', 'straight'] as const)\n\n/** @public */\nexport type TLDrawShapeSegment = {\n\ttype: SetValue<typeof TL_DRAW_SHAPE_SEGMENT_TYPE>\n\tpoints: Vec2dModel[]\n}\n\n/** @public */\nexport type TLDrawShapeProps = {\n\tcolor: TLColorType\n\tfill: TLFillType\n\tdash: TLDashType\n\tsize: TLSizeType\n\topacity: TLOpacityType\n\tsegments: TLDrawShapeSegment[]\n\tisComplete: boolean\n\tisClosed: boolean\n\tisPen: boolean\n}\n\n/** @public */\nexport type TLDrawShape = TLBaseShape<'draw', TLDrawShapeProps>\n\n// --- VALIDATION ---\n/** @public */\nexport const drawShapeTypeValidator: T.Validator<TLDrawShape> = createShapeValidator(\n\t'draw',\n\tT.object({\n\t\tcolor: colorValidator,\n\t\tfill: fillValidator,\n\t\tdash: dashValidator,\n\t\tsize: sizeValidator,\n\t\topacity: opacityValidator,\n\t\tsegments: T.arrayOf(\n\t\t\tT.object({\n\t\t\t\ttype: T.setEnum(TL_DRAW_SHAPE_SEGMENT_TYPE),\n\t\t\t\tpoints: T.arrayOf(T.point),\n\t\t\t})\n\t\t),\n\t\tisComplete: T.boolean,\n\t\tisClosed: T.boolean,\n\t\tisPen: T.boolean,\n\t})\n)\n\n// --- MIGRATIONS ---\n// STEP 1: Add a new version number here, give it a meaningful name.\n// It should be 1 higher than the current version\nconst Versions = {\n\tInitial: 0,\n\tAddInPen: 1,\n} as const\n\n/** @public */\nexport const drawShapeMigrations = defineMigrations({\n\t// STEP 2: Update the current version to point to your latest version\n\tfirstVersion: Versions.Initial,\n\tcurrentVersion: Versions.AddInPen,\n\tmigrators: {\n\t\t// STEP 3: Add an up+down migration for the new version here\n\t\t[Versions.AddInPen]: {\n\t\t\tup: (shape) => {\n\t\t\t\t// Rather than checking to see whether the shape is a pen at runtime,\n\t\t\t\t// from now on we're going to use the type of device reported to us\n\t\t\t\t// as well as the pressure data received; but for existing shapes we\n\t\t\t\t// need to check the pressure data to see if it's a pen or not.\n\n\t\t\t\tconst { points } = shape.props.segments[0]\n\n\t\t\t\tif (points.length === 0) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\t...shape,\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t...shape.props,\n\t\t\t\t\t\t\tisPen: false,\n\t\t\t\t\t\t},\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tlet isPen = !(points[0].z === 0 || points[0].z === 0.5)\n\n\t\t\t\tif (points[1]) {\n\t\t\t\t\t// Double check if we have a second point (we probably should)\n\t\t\t\t\tisPen = isPen && !(points[1].z === 0 || points[1].z === 0.5)\n\t\t\t\t}\n\n\t\t\t\treturn {\n\t\t\t\t\t...shape,\n\t\t\t\t\tprops: {\n\t\t\t\t\t\t...shape.props,\n\t\t\t\t\t\tisPen,\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t},\n\t\t\tdown: (shape) => {\n\t\t\t\tconst { isPen: _isPen, ...propsWithOutIsPen } = shape.props\n\t\t\t\treturn {\n\t\t\t\t\t...shape,\n\t\t\t\t\tprops: {\n\t\t\t\t\t\t...propsWithOutIsPen,\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t},\n\t\t},\n\t},\n})\n","import { defineMigrations } from '@tldraw/tlstore'\nimport { T } from '@tldraw/tlvalidate'\nimport { TLOpacityType } from '../style-types'\nimport { opacityValidator } from '../validation'\nimport { createShapeValidator, TLBaseShape } from './shape-validation'\n\n/**\n * Permissions with note inline from https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe#attr-sandbox\n * @public\n */\nexport const tlEmbedShapePermissionDefaults = {\n\t// ========================================================================================\n\t// Disabled permissions\n\t// ========================================================================================\n\t// [MDN] Experimental: Allows for downloads to occur without a gesture from the user.\n\t// [REASON] Disabled because otherwise the <iframe/> trick the user on behalf of us to performing an action\n\t'allow-downloads-without-user-activation': false,\n\t// [MDN] Allows for downloads to occur with a gesture from the user.\n\t// [REASON] Disabled because otherwise the <iframe/> trick the user on behalf of us to performing an action\n\t'allow-downloads': false,\n\t// [MDN] Lets the resource open modal windows.\n\t// [REASON] The <iframe/> could 'window.prompt(\"Enter your tldraw password\")'\n\t'allow-modals': false,\n\t// [MDN] Lets the resource lock the screen orientation.\n\t// [REASON] Would interfer with tldraw interface\n\t'allow-orientation-lock': false,\n\t// [MDN] Lets the resource use the Pointer Lock API.\n\t// [REASON] Maybe we should allow this for games embeds (scratch/codepen/codesandbox)\n\t'allow-pointer-lock': false,\n\t// [MDN] Allows popups (such as window.open(), target=\"_blank\", or showModalDialog()). If this keyword is not used, the popup will silently fail to open.\n\t// [REASON] We shouldn't allow popups as a embed could pretend to be us by opening a mocked version of tldraw. This is very unobvious when it is performed as an action within out app\n\t'allow-popups': true,\n\t// [MDN] Lets the sandboxed document open new windows without those windows inheriting the sandboxing. For example, this can safely sandbox an advertisement without forcing the same restrictions upon the page the ad links to.\n\t// [REASON] We're alread disabling popups.\n\t'allow-popups-to-escape-sandbox': false,\n\t// [MDN] Lets the resource start a presentation session.\n\t// [REASON] Prevents embed from navigating away from tldraw and pretending to be us\n\t'allow-presentation': false,\n\t// [MDN] Experimental: Lets the resource request access to the parent's storage capabilities with the Storage Access API.\n\t// [REASON] We don't want anyone else to access our storage\n\t'allow-storage-access-by-user-activation': false,\n\t// [MDN] Lets the resource navigate the top-level browsing context (the one named _top).\n\t// [REASON] Prevents embed from navigating away from tldraw and pretending to be us\n\t'allow-top-navigation': false,\n\t// [MDN] Lets the resource navigate the top-level browsing context, but only if initiated by a user gesture.\n\t// [REASON] Prevents embed from navigating away from tldraw and pretending to be us\n\t'allow-top-navigation-by-user-activation': false,\n\t// ========================================================================================\n\t// Enabled permissions\n\t// ========================================================================================\n\t// [MDN] Lets the resource run scripts (but not create popup windows).\n\t'allow-scripts': true,\n\t// [MDN] If this token is not used, the resource is treated as being from a special origin that always fails the same-origin policy (potentially preventing access to data storage/cookies and some JavaScript APIs).\n\t'allow-same-origin': true,\n\t// [MDN] Allows the resource to submit forms. If this keyword is not used, form submission is blocked.\n\t'allow-forms': true,\n} as const\n\n/** @public */\nexport type TLEmbedShapePermissionName = keyof typeof tlEmbedShapePermissionDefaults\n/** @public */\nexport type TLEmbedShapePermissions = { [K in TLEmbedShapePermissionName]?: boolean }\n\n/** @public */\nexport type TLEmbedShapeProps = {\n\topacity: TLOpacityType\n\tw: number\n\th: number\n\turl: string\n\t// TODO: This is to store during migration in case anything goes wrong so we can revert.\n\ttmpOldUrl?: string\n\tdoesResize: boolean\n\toverridePermissions?: TLEmbedShapePermissions\n}\n\n/** @public */\nexport type TLEmbedShape = TLBaseShape<'embed', TLEmbedShapeProps>\n\n// --- VALIDATION ---\n/** @public */\nexport const embedShapeTypeValidator: T.Validator<TLEmbedShape> = createShapeValidator(\n\t'embed',\n\tT.object({\n\t\topacity: opacityValidator,\n\t\tw: T.nonZeroNumber,\n\t\th: T.nonZeroNumber,\n\t\turl: T.string,\n\t\ttmpOldUrl: T.string.optional(),\n\t\tdoesResize: T.boolean,\n\t\toverridePermissions: T.dict(\n\t\t\tT.setEnum(\n\t\t\t\tnew Set(Object.keys(tlEmbedShapePermissionDefaults) as TLEmbedShapePermissionName[])\n\t\t\t),\n\t\t\tT.boolean.optional()\n\t\t).optional(),\n\t})\n)\n\n/** @public */\nexport type EmbedDefinition = {\n\treadonly type: string\n\treadonly title: string\n\treadonly hostnames: readonly string[]\n\treadonly minWidth?: number\n\treadonly minHeight?: number\n\treadonly width: number\n\treadonly height: number\n\treadonly doesResize: boolean\n\treadonly isAspectRatioLocked?: boolean\n\treadonly overridePermissions?: TLEmbedShapePermissions\n\treadonly instructionLink?: string\n\treadonly backgroundColor?: string\n\t// TODO: FIXME this is ugly be required because some embeds have their own border radius for example spotify embeds\n\treadonly overrideOutlineRadius?: number\n\treadonly toEmbedUrl: (url: string) => string | undefined\n\treadonly fromEmbedUrl: (url: string) => string | undefined\n}\n\n// Only allow multiplayer embeds. If we add additional routes later for example '/help' this won't match\nconst TLDRAW_APP_RE = /(^\\/r\\/[^/]+\\/?$)/\n\nconst safeParseUrl = (url: string) => {\n\ttry {\n\t\treturn new URL(url)\n\t} catch (err) {\n\t\treturn\n\t}\n}\n\n/** @public */\nexport const EMBED_DEFINITIONS = [\n\t{\n\t\ttype: 'tldraw',\n\t\ttitle: 'tldraw',\n\t\thostnames: ['beta.tldraw.com', 'lite.tldraw.com'],\n\t\tminWidth: 300,\n\t\tminHeight: 300,\n\t\twidth: 720,\n\t\theight: 500,\n\t\tdoesResize: true,\n\t\ttoEmbedUrl: (url) => {\n\t\t\tconst urlObj = safeParseUrl(url)\n\t\t\tif (urlObj && urlObj.pathname.match(TLDRAW_APP_RE)) {\n\t\t\t\treturn url\n\t\t\t}\n\t\t\treturn\n\t\t},\n\t\tfromEmbedUrl: (url) => {\n\t\t\tconst urlObj = safeParseUrl(url)\n\t\t\tif (urlObj && urlObj.pathname.match(TLDRAW_APP_RE)) {\n\t\t\t\treturn url\n\t\t\t}\n\t\t\treturn\n\t\t},\n\t},\n\t{\n\t\ttype: 'codesandbox',\n\t\ttitle: 'CodeSandbox',\n\t\thostnames: ['codesandbox.io'],\n\t\tminWidth: 300,\n\t\tminHeight: 300,\n\t\twidth: 720,\n\t\theight: 500,\n\t\tdoesResize: true,\n\t\ttoEmbedUrl: (url) => {\n\t\t\tconst urlObj = safeParseUrl(url)\n\t\t\tconst matches = urlObj && urlObj.pathname.match(/\\/s\\/([^/]+)\\/?/)\n\t\t\tif (matches) {\n\t\t\t\treturn `https://codesandbox.io/embed/${matches[1]}`\n\t\t\t}\n\t\t\treturn\n\t\t},\n\t\tfromEmbedUrl: (url) => {\n\t\t\tconst urlObj = safeParseUrl(url)\n\t\t\tconst matches = urlObj && urlObj.pathname.match(/\\/embed\\/([^/]+)\\/?/)\n\t\t\tif (matches) {\n\t\t\t\treturn `https://codesandbox.io/s/${matches[1]}`\n\t\t\t}\n\t\t\treturn\n\t\t},\n\t},\n\t{\n\t\ttype: 'codepen',\n\t\ttitle: 'Codepen',\n\t\thostnames: ['codepen.io'],\n\t\tminWidth: 300,\n\t\tminHeight: 300,\n\t\twidth: 520,\n\t\theight: 400,\n\t\tdoesResize: true,\n\t\ttoEmbedUrl: (url) => {\n\t\t\tconst CODEPEN_URL_REGEXP = /https:\\/\\/codepen.io\\/([^/]+)\\/pen\\/([^/]+)/\n\t\t\tconst matches = url.match(CODEPEN_URL_REGEXP)\n\t\t\tif (matches) {\n\t\t\t\tconst [_, user, id] = matches\n\t\t\t\treturn `https://codepen.io/${user}/embed/${id}`\n\t\t\t}\n\t\t\treturn\n\t\t},\n\t\tfromEmbedUrl: (url) => {\n\t\t\tconst CODEPEN_EMBED_REGEXP = /https:\\/\\/codepen.io\\/([^/]+)\\/embed\\/([^/]+)/\n\t\t\tconst matches = url.match(CODEPEN_EMBED_REGEXP)\n\t\t\tif (matches) {\n\t\t\t\tconst [_, user, id] = matches\n\t\t\t\treturn `https://codepen.io/${user}/pen/${id}`\n\t\t\t}\n\t\t\treturn\n\t\t},\n\t},\n\t{\n\t\ttype: 'scratch',\n\t\ttitle: 'Scratch',\n\t\thostnames: ['scratch.mit.edu'],\n\t\twidth: 520,\n\t\theight: 400,\n\t\tdoesResize: false,\n\t\ttoEmbedUrl: (url) => {\n\t\t\tconst SCRATCH_URL_REGEXP = /https?:\\/\\/scratch.mit.edu\\/projects\\/([^/]+)/\n\t\t\tconst matches = url.match(SCRATCH_URL_REGEXP)\n\t\t\tif (matches) {\n\t\t\t\tconst [_, id] = matches\n\t\t\t\treturn `https://scratch.mit.edu/projects/embed/${id}`\n\t\t\t}\n\t\t\treturn\n\t\t},\n\t\tfromEmbedUrl: (url) => {\n\t\t\tconst SCRATCH_EMBED_REGEXP = /https:\\/\\/scratch.mit.edu\\/projects\\/embed\\/([^/]+)/\n\t\t\tconst matches = url.match(SCRATCH_EMBED_REGEXP)\n\t\t\tif (matches) {\n\t\t\t\tconst [_, id] = matches\n\t\t\t\treturn `https://scratch.mit.edu/projects/${id}`\n\t\t\t}\n\t\t\treturn\n\t\t},\n\t},\n\t{\n\t\ttype: 'youtube',\n\t\ttitle: 'YouTube',\n\t\thostnames: ['*.youtube.com', 'youtube.com', 'youtu.be'],\n\t\twidth: 800,\n\t\theight: 450,\n\t\tdoesResize: true,\n\t\toverridePermissions: {\n\t\t\t'allow-presentation': true,\n\t\t},\n\t\tisAspectRatioLocked: true,\n\t\ttoEmbedUrl: (url) => {\n\t\t\tconst urlObj = safeParseUrl(url)\n\t\t\tif (!urlObj) return\n\n\t\t\tconst hostname = urlObj.hostname.replace(/^www./, '')\n\t\t\tif (hostname === 'youtu.be') {\n\t\t\t\tconst videoId = urlObj.pathname.split('/').filter(Boolean)[0]\n\t\t\t\treturn `https://www.youtube.com/embed/${videoId}`\n\t\t\t} else if (\n\t\t\t\t(hostname === 'youtube.com' || hostname === 'm.youtube.com') &&\n\t\t\t\turlObj.pathname.match(/^\\/watch/)\n\t\t\t) {\n\t\t\t\tconst videoId = urlObj.searchParams.get('v')\n\t\t\t\treturn `https://www.youtube.com/embed/${videoId}`\n\t\t\t}\n\t\t\treturn\n\t\t},\n\t\tfromEmbedUrl: (url) => {\n\t\t\tconst urlObj = safeParseUrl(url)\n\t\t\tif (!urlObj) return\n\n\t\t\tconst hostname = urlObj.hostname.replace(/^www./, '')\n\t\t\tif (hostname === 'youtube.com') {\n\t\t\t\tconst matches = urlObj.pathname.match(/^\\/embed\\/([^/]+)\\/?/)\n\t\t\t\tif (matches) {\n\t\t\t\t\treturn `https://www.youtube.com/watch?v=${matches[1]}`\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn\n\t\t},\n\t},\n\t{\n\t\ttype: 'figma',\n\t\ttitle: 'Figma',\n\t\thostnames: ['figma.com'],\n\t\twidth: 720,\n\t\theight: 500,\n\t\tdoesResize: true,\n\t\ttoEmbedUrl: (url) => {\n\t\t\tif (\n\t\t\t\t!!url.match(\n\t\t\t\t\t// eslint-disable-next-line no-useless-escape\n\t\t\t\t\t/https:\\/\\/([\\w\\.-]+\\.)?figma.com\\/(file|proto)\\/([0-9a-zA-Z]{22,128})(?:\\/.*)?$/\n\t\t\t\t) &&\n\t\t\t\t!url.includes('figma.com/embed')\n\t\t\t) {\n\t\t\t\treturn `https://www.figma.com/embed?embed_host=share&url=${url}`\n\t\t\t}\n\t\t\treturn\n\t\t},\n\t\tfromEmbedUrl: (url) => {\n\t\t\tconst urlObj = safeParseUrl(url)\n\t\t\tif (urlObj && urlObj.pathname.match(/^\\/embed\\/?$/)) {\n\t\t\t\tconst outUrl = urlObj.searchParams.get('url')\n\t\t\t\tif (outUrl) {\n\t\t\t\t\treturn outUrl\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn\n\t\t},\n\t},\n\t{\n\t\ttype: 'google_maps',\n\t\ttitle: 'Google Maps',\n\t\thostnames: ['google.*'],\n\t\twidth: 720,\n\t\theight: 500,\n\t\tdoesResize: true,\n\t\ttoEmbedUrl: (url) => {\n\t\t\tif (url.includes('/maps/')) {\n\t\t\t\tconst match = url.match(/@(.*),(.*),(.*)z/)\n\t\t\t\tlet result: string\n\t\t\t\tif (match) {\n\t\t\t\t\tconst [, lat, lng, z] = match\n\t\t\t\t\tconst host = new URL(url).host.replace('www.', '')\n\t\t\t\t\tresult = `https://${host}/maps/embed/v1/view?key=${process.env.NEXT_PUBLIC_GC_API_KEY}&center=${lat},${lng}&zoom=${z}`\n\t\t\t\t} else {\n\t\t\t\t\tresult = ''\n\t\t\t\t}\n\n\t\t\t\treturn result\n\t\t\t}\n\t\t\treturn\n\t\t},\n\t\tfromEmbedUrl: (url) => {\n\t\t\tconst urlObj = safeParseUrl(url)\n\t\t\tif (!urlObj) return\n\n\t\t\tconst matches = urlObj.pathname.match(/^\\/maps\\/embed\\/v1\\/view\\/?$/)\n\t\t\tif (matches && urlObj.searchParams.has('center') && urlObj.searchParams.get('zoom')) {\n\t\t\t\tconst zoom = urlObj.searchParams.get('zoom')\n\t\t\t\tconst [lat, lon] = urlObj.searchParams.get('center')!.split(',')\n\t\t\t\treturn `https://www.google.com/maps/@${lat},${lon},${zoom}z`\n\t\t\t}\n\t\t\treturn\n\t\t},\n\t},\n\t{\n\t\ttype: 'google_calendar',\n\t\ttitle: 'Google Calendar',\n\t\thostnames: ['calendar.google.*'],\n\t\twidth: 720,\n\t\theight: 500,\n\t\tminWidth: 460,\n\t\tminHeight: 360,\n\t\tdoesResize: true,\n\t\tinstructionLink: 'https://support.google.com/calendar/answer/41207?hl=en',\n\t\ttoEmbedUrl: (url) => {\n\t\t\tconst urlObj = safeParseUrl(url)\n\t\t\tconst cidQs = urlObj?.searchParams.get('cid')\n\n\t\t\tif (urlObj?.pathname.match(/\\/calendar\\/u\\/0/) && cidQs) {\n\t\t\t\turlObj.pathname = '/calendar/embed'\n\n\t\t\t\tconst keys = Array.from(urlObj.searchParams.keys())\n\t\t\t\tfor (const key of keys) {\n\t\t\t\t\turlObj.searchParams.delete(key)\n\t\t\t\t}\n\t\t\t\turlObj.searchParams.set('src', cidQs)\n\t\t\t\treturn urlObj.href\n\t\t\t}\n\t\t\treturn\n\t\t},\n\t\tfromEmbedUrl: (url) => {\n\t\t\tconst urlObj = safeParseUrl(url)\n\t\t\tconst srcQs = urlObj?.searchParams.get('src')\n\n\t\t\tif (urlObj?.pathname.match(/\\/calendar\\/embed/) && srcQs) {\n\t\t\t\turlObj.pathname = '/calendar/u/0'\n\t\t\t\tconst keys = Array.from(urlObj.searchParams.keys())\n\t\t\t\tfor (const key of keys) {\n\t\t\t\t\turlObj.searchParams.delete(key)\n\t\t\t\t}\n\t\t\t\turlObj.searchParams.set('cid', srcQs)\n\t\t\t\treturn urlObj.href\n\t\t\t}\n\t\t\treturn\n\t\t},\n\t},\n\t{\n\t\ttype: 'google_slides',\n\t\ttitle: 'Google Slides',\n\t\thostnames: ['docs.google.*'],\n\t\twidth: 720,\n\t\theight: 500,\n\t\tminWidth: 460,\n\t\tminHeight: 360,\n\t\tdoesResize: true,\n\t\ttoEmbedUrl: (url) => {\n\t\t\tconst urlObj = safeParseUrl(url)\n\n\t\t\tif (urlObj?.pathname.match(/^\\/presentation/) && urlObj?.pathname.match(/\\/pub\\/?$/)) {\n\t\t\t\turlObj.pathname = urlObj.pathname.replace(/\\/pub$/, '/embed')\n\t\t\t\tconst keys = Array.from(urlObj.searchParams.keys())\n\t\t\t\tfor (const key of keys) {\n\t\t\t\t\turlObj.searchParams.delete(key)\n\t\t\t\t}\n\t\t\t\treturn urlObj.href\n\t\t\t}\n\t\t\treturn\n\t\t},\n\t\tfromEmbedUrl: (url) => {\n\t\t\tconst urlObj = safeParseUrl(url)\n\n\t\t\tif (urlObj?.pathname.match(/^\\/presentation/) && urlObj?.pathname.match(/\\/embed\\/?$/)) {\n\t\t\t\turlObj.pathname = urlObj.pathname.replace(/\\/embed$/, '/pub')\n\t\t\t\tconst keys = Array.from(urlObj.searchParams.keys())\n\t\t\t\tfor (const key of keys) {\n\t\t\t\t\turlObj.searchParams.delete(key)\n\t\t\t\t}\n\t\t\t\treturn urlObj.href\n\t\t\t}\n\t\t\treturn\n\t\t},\n\t},\n\t{\n\t\ttype: 'github_gist',\n\t\ttitle: 'GitHub Gist',\n\t\thostnames: ['gist.github.com'],\n\t\twidth: 720,\n\t\theight: 500,\n\t\tdoesResize: true,\n\t\ttoEmbedUrl: (url) => {\n\t\t\tconst urlObj = safeParseUrl(url)\n\t\t\tif (urlObj && urlObj.pathname.match(/\\/([^/]+)\\/([^/]+)/)) {\n\t\t\t\treturn url\n\t\t\t}\n\t\t\treturn\n\t\t},\n\t\tfromEmbedUrl: (url) => {\n\t\t\tconst urlObj = safeParseUrl(url)\n\t\t\tif (urlObj && urlObj.pathname.match(/\\/([^/]+)\\/([^/]+)/)) {\n\t\t\t\treturn url\n\t\t\t}\n\t\t\treturn\n\t\t},\n\t},\n\t{\n\t\ttype: 'replit',\n\t\ttitle: 'Replit',\n\t\thostnames: ['replit.com'],\n\t\twidth: 720,\n\t\theight: 500,\n\t\tdoesResize: true,\n\t\ttoEmbedUrl: (url) => {\n\t\t\tconst urlObj = safeParseUrl(url)\n\t\t\tif (urlObj && urlObj.pathname.match(/\\/@([^/]+)\\/([^/]+)/)) {\n\t\t\t\treturn `${url}?embed=true`\n\t\t\t}\n\t\t\treturn\n\t\t},\n\t\tfromEmbedUrl: (url) => {\n\t\t\tconst urlObj = safeParseUrl(url)\n\t\t\tif (\n\t\t\t\turlObj &&\n\t\t\t\turlObj.pathname.match(/\\/@([^/]+)\\/([^/]+)/) &&\n\t\t\t\turlObj.searchParams.has('embed')\n\t\t\t) {\n\t\t\t\turlObj.searchParams.delete('embed')\n\t\t\t\treturn urlObj.href\n\t\t\t}\n\t\t\treturn\n\t\t},\n\t},\n\t{\n\t\ttype: 'felt',\n\t\ttitle: 'Felt',\n\t\thostnames: ['felt.com'],\n\t\twidth: 720,\n\t\theight: 500,\n\t\tdoesResize: true,\n\t\ttoEmbedUrl: (url) => {\n\t\t\tconst urlObj = safeParseUrl(url)\n\t\t\tif (urlObj && urlObj.pathname.match(/^\\/map\\//)) {\n\t\t\t\treturn urlObj.origin + '/embed' + urlObj.pathname\n\t\t\t}\n\t\t\treturn\n\t\t},\n\t\tfromEmbedUrl: (url) => {\n\t\t\tconst urlObj = safeParseUrl(url)\n\t\t\tif (urlObj && urlObj.pathname.match(/^\\/embed\\/map\\//)) {\n\t\t\t\turlObj.pathname = urlObj.pathname.replace(/^\\/embed/, '')\n\t\t\t\treturn urlObj.href\n\t\t\t}\n\t\t\treturn\n\t\t},\n\t},\n\t{\n\t\ttype: 'spotify',\n\t\ttitle: 'Spotify',\n\t\thostnames: ['open.spotify.com'],\n\t\twidth: 720,\n\t\theight: 500,\n\t\tminHeight: 500,\n\t\toverrideOutlineRadius: 12,\n\t\tdoesResize: true,\n\t\ttoEmbedUrl: (url) => {\n\t\t\tconst urlObj = safeParseUrl(url)\n\t\t\tif (urlObj && urlObj.pathname.match(/^\\/(artist|album)\\//)) {\n\t\t\t\treturn urlObj.origin + '/embed' + urlObj.pathname\n\t\t\t}\n\t\t\treturn\n\t\t},\n\t\tfromEmbedUrl: (url) => {\n\t\t\tconst urlObj = safeParseUrl(url)\n\t\t\tif (urlObj && urlObj.pathname.match(/^\\/embed\\/(artist|album)\\//)) {\n\t\t\t\treturn urlObj.origin + urlObj.pathname.replace(/^\\/embed/, '')\n\t\t\t}\n\t\t\treturn\n\t\t},\n\t},\n\t{\n\t\ttype: 'vimeo',\n\t\ttitle: 'Vimeo',\n\t\thostnames: ['vimeo.com', 'player.vimeo.com'],\n\t\twidth: 640,\n\t\theight: 360,\n\t\tdoesResize: true,\n\t\tisAspectRatioLocked: true,\n\t\ttoEmbedUrl: (url) => {\n\t\t\tconst urlObj = safeParseUrl(url)\n\t\t\tif (urlObj && urlObj.hostname === 'vimeo.com') {\n\t\t\t\tif (urlObj.pathname.match(/^\\/[0-9]+/)) {\n\t\t\t\t\treturn (\n\t\t\t\t\t\t'https://player.vimeo.com/video/' + urlObj.pathname.split('/')[1] + '?title=0&byline=0'\n\t\t\t\t\t)\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn\n\t\t},\n\t\tfromEmbedUrl: (url) => {\n\t\t\tconst urlObj = safeParseUrl(url)\n\t\t\tif (urlObj && urlObj.hostname === 'player.vimeo.com') {\n\t\t\t\tconst matches = urlObj.pathname.match(/^\\/video\\/([^/]+)\\/?$/)\n\t\t\t\tif (matches) {\n\t\t\t\t\treturn 'https://vimeo.com/' + matches[1]\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn\n\t\t},\n\t},\n\t{\n\t\ttype: 'excalidraw',\n\t\ttitle: 'Excalidraw',\n\t\thostnames: ['excalidraw.com'],\n\t\twidth: 720,\n\t\theight: 500,\n\t\tdoesResize: true,\n\t\tisAspectRatioLocked: true,\n\t\ttoEmbedUrl: (url) => {\n\t\t\tconst urlObj = safeParseUrl(url)\n\t\t\tif (urlObj && urlObj.hash.match(/#room=/)) {\n\t\t\t\treturn url\n\t\t\t}\n\t\t\treturn\n\t\t},\n\t\tfromEmbedUrl: (url) => {\n\t\t\tconst urlObj = safeParseUrl(url)\n\t\t\tif (urlObj && urlObj.hash.match(/#room=/)) {\n\t\t\t\treturn url\n\t\t\t}\n\t\t\treturn\n\t\t},\n\t},\n\t{\n\t\ttype: 'observable',\n\t\ttitle: 'Observable',\n\t\thostnames: ['observablehq.com'],\n\t\twidth: 720,\n\t\theight: 500,\n\t\tdoesResize: true,\n\t\tisAspectRatioLocked: false,\n\t\tbackgroundColor: '#fff',\n\t\ttoEmbedUrl: (url) => {\n\t\t\tconst urlObj = safeParseUrl(url)\n\t\t\tif (urlObj && urlObj.pathname.match(/^\\/@([^/]+)\\/([^/]+)\\/?$/)) {\n\t\t\t\treturn `${urlObj.origin}/embed${urlObj.pathname}?cell=*`\n\t\t\t}\n\t\t\tif (urlObj && urlObj.pathname.match(/^\\/d\\/([^/]+)\\/?$/)) {\n\t\t\t\tconst pathName = urlObj.pathname.replace(/^\\/d/, '')\n\t\t\t\treturn `${urlObj.origin}/embed${pathName}?cell=*`\n\t\t\t}\n\n\t\t\treturn\n\t\t},\n\t\tfromEmbedUrl: (url) => {\n\t\t\tconst urlObj = safeParseUrl(url)\n\t\t\tif (urlObj && urlObj.pathname.match(/^\\/embed\\/@([^/]+)\\/([^/]+)\\/?$/)) {\n\t\t\t\treturn `${urlObj.origin}${urlObj.pathname.replace('/embed', '')}#cell-*`\n\t\t\t}\n\t\t\tif (urlObj && urlObj.pathname.match(/^\\/embed\\/([^/]+)\\/?$/)) {\n\t\t\t\treturn `${urlObj.origin}${urlObj.pathname.replace('/embed', '/d')}#cell-*`\n\t\t\t}\n\n\t\t\treturn\n\t\t},\n\t},\n] as const satisfies readonly EmbedDefinition[]\n\n// --- MIGRATIONS ---\n// STEP 1: Add a new version number here, give it a meaningful name.\n// It should be 1 higher than the current version\nconst Versions = {\n\tInitial: 0,\n\tGenOriginalUrlInEmbed: 1,\n} as const\n\n/** @public */\nexport const embedShapeMigrations = defineMigrations({\n\t// STEP 2: Update the current version to point to your latest version\n\tcurrentVersion: Versions.GenOriginalUrlInEmbed,\n\tfirstVersion: Versions.Initial,\n\tmigrators: {\n\t\t// STEP 3: Add an up+down migration for the new version here\n\t\t[Versions.GenOriginalUrlInEmbed]: {\n\t\t\t// add tmpOldUrl property\n\t\t\tup: (shape) => {\n\t\t\t\tconst url = shape.props.url\n\t\t\t\tconst host = new URL(url).host.replace('www.', '')\n\t\t\t\tlet originalUrl\n\t\t\t\tfor (const localEmbedDef of EMBED_DEFINITIONS) {\n\t\t\t\t\tif ((localEmbedDef as EmbedDefinition).hostnames.includes(host)) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\toriginalUrl = localEmbedDef.fromEmbedUrl(url)\n\t\t\t\t\t\t} catch (err) {\n\t\t\t\t\t\t\tconsole.warn(err)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn {\n\t\t\t\t\t...shape,\n\t\t\t\t\tprops: {\n\t\t\t\t\t\t...shape.props,\n\t\t\t\t\t\ttmpOldUrl: shape.props.url,\n\t\t\t\t\t\turl: originalUrl ?? '',\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t},\n\t\t\t// remove tmpOldUrl property\n\t\t\tdown: (shape) => {\n\t\t\t\tlet newUrl = shape.props.tmpOldUrl\n\t\t\t\tif (!newUrl || newUrl === '') {\n\t\t\t\t\tconst url = shape.props.url\n\t\t\t\t\tconst host = new URL(url).host.replace('www.', '')\n\n\t\t\t\t\tfor (const localEmbedDef of EMBED_DEFINITIONS) {\n\t\t\t\t\t\tif ((localEmbedDef as EmbedDefinition).hostnames.includes(host)) {\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\tnewUrl = localEmbedDef.toEmbedUrl(url)\n\t\t\t\t\t\t\t} catch (err) {\n\t\t\t\t\t\t\t\tconsole.warn(err)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\n\t\t\t\tconst { tmpOldUrl, ...props } = shape.props\n\t\t\t\treturn {\n\t\t\t\t\t...shape,\n\t\t\t\t\tprops: {\n\t\t\t\t\t\t...props,\n\t\t\t\t\t\turl: newUrl ?? '',\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t},\n\t\t},\n\t},\n})\n","import { defineMigrations } from '@tldraw/tlstore'\nimport { T } from '@tldraw/tlvalidate'\nimport { TLOpacityType } from '../style-types'\nimport { opacityValidator } from '../validation'\nimport { createShapeValidator, TLBaseShape } from './shape-validation'\n\n/** @public */\nexport type TLFrameShapeProps = {\n\topacity: TLOpacityType\n\tw: number\n\th: number\n\tname: string\n}\n\n/** @public */\nexport type TLFrameShape = TLBaseShape<'frame', TLFrameShapeProps>\n\n// --- VALIDATION ---\n/** @public */\nexport const frameShapeTypeValidator: T.Validator<TLFrameShape> = createShapeValidator(\n\t'frame',\n\tT.object({\n\t\topacity: opacityValidator,\n\t\tw: T.nonZeroNumber,\n\t\th: T.nonZeroNumber,\n\t\tname: T.string,\n\t})\n)\n\n// --- MIGRATIONS ---\n// STEP 1: Add a new version number here, give it a meaningful name.\n// It should be 1 higher than the current version\nconst Versions = {\n\tInitial: 0,\n} as const\n\n/** @public */\nexport const frameShapeMigrations = defineMigrations({\n\t// STEP 2: Update the current version to point to your latest version\n\tcurrentVersion: Versions.Initial,\n\tfirstVersion: Versions.Initial,\n\tmigrators: {\n\t\t// STEP 3: Add an up+down migration for the new version here\n\t},\n})\n","import { defineMigrations } from '@tldraw/tlstore'\nimport { T } from '@tldraw/tlvalidate'\nimport {\n\tTLAlignType,\n\tTLColorType,\n\tTLDashType,\n\tTLFillType,\n\tTLFontType,\n\tTLGeoType,\n\tTLOpacityType,\n\tTLSizeType,\n} from '../style-types'\nimport {\n\talignValidator,\n\tcolorValidator,\n\tdashValidator,\n\tfillValidator,\n\tfontValidator,\n\tgeoValidator,\n\topacityValidator,\n\tsizeValidator,\n} from '../validation'\nimport { TLBaseShape, createShapeValidator } from './shape-validation'\n\n/** @public */\nexport type TLGeoShapeProps = {\n\tgeo: TLGeoType\n\tlabelColor: TLColorType\n\tcolor: TLColorType\n\tfill: TLFillType\n\tdash: TLDashType\n\tsize: TLSizeType\n\topacity: TLOpacityType\n\tfont: TLFontType\n\talign: TLAlignType\n\turl: string\n\tw: number\n\th: number\n\ttext: string\n\tgrowY: number\n}\n\n/** @public */\nexport type TLGeoShape = TLBaseShape<'geo', TLGeoShapeProps>\n\n// --- VALIDATION ---\n/** @public */\nexport const geoShapeTypeValidator: T.Validator<TLGeoShape> = createShapeValidator(\n\t'geo',\n\tT.object({\n\t\tgeo: geoValidator,\n\t\tlabelColor: colorValidator,\n\t\tcolor: colorValidator,\n\t\tfill: fillValidator,\n\t\tdash: dashValidator,\n\t\tsize: sizeValidator,\n\t\topacity: opacityValidator,\n\t\tfont: fontValidator,\n\t\talign: alignValidator,\n\t\turl: T.string,\n\t\tw: T.nonZeroNumber,\n\t\th: T.nonZeroNumber,\n\t\tgrowY: T.positiveNumber,\n\t\ttext: T.string,\n\t})\n)\n\n// --- MIGRATIONS ---\n// STEP 1: Add a new version number here, give it a meaningful name.\n// It should be 1 higher than the current version\nconst Versions = {\n\tInitial: 0,\n\tAddUrlProp: 1,\n\tAddLabelColor: 2,\n} as const\n\n/** @public */\nexport const geoShapeMigrations = defineMigrations({\n\t// STEP 2: Update the current version to point to your latest version\n\tfirstVersion: Versions.Initial,\n\tcurrentVersion: Versions.AddLabelColor,\n\tmigrators: {\n\t\t// STEP 3: Add an up+down migration for the new version here\n\t\t[Versions.AddUrlProp]: {\n\t\t\tup: (shape) => {\n\t\t\t\treturn { ...shape, props: { ...shape.props, url: '' } }\n\t\t\t},\n\t\t\tdown: (shape) => {\n\t\t\t\tconst { url: _, ...props } = shape.props\n\t\t\t\treturn { ...shape, props }\n\t\t\t},\n\t\t},\n\t\t[Versions.AddLabelColor]: {\n\t\t\tup: (record) => {\n\t\t\t\treturn {\n\t\t\t\t\t...record,\n\t\t\t\t\tprops: {\n\t\t\t\t\t\t...record.props,\n\t\t\t\t\t\tlabelColor: 'black',\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t},\n\t\t\tdown: (record) => {\n\t\t\t\tconst { labelColor: _, ...props } = record.props\n\t\t\t\treturn {\n\t\t\t\t\t...record,\n\t\t\t\t\tprops,\n\t\t\t\t}\n\t\t\t},\n\t\t},\n\t},\n})\n","import { defineMigrations } from '@tldraw/tlstore'\nimport { T } from '@tldraw/tlvalidate'\nimport { TLOpacityType } from '../style-types'\nimport { opacityValidator } from '../validation'\nimport { createShapeValidator, TLBaseShape } from './shape-validation'\n\n/** @public */\nexport type TLGroupShapeProps = {\n\topacity: TLOpacityType\n}\n\n/** @public */\nexport type TLGroupShape = TLBaseShape<'group', TLGroupShapeProps>\n\n// --- VALIDATION ---\n/** @public */\nexport const groupShapeTypeValidator: T.Validator<TLGroupShape> = createShapeValidator(\n\t'group',\n\tT.object({\n\t\topacity: opacityValidator,\n\t})\n)\n\n// --- MIGRATIONS ---\n// STEP 1: Add a new version number here, give it a meaningful name.\n// It should be 1 higher than the current version\nconst Versions = {\n\tInitial: 0,\n} as const\n\n/** @public */\nexport const groupShapeMigrations = defineMigrations({\n\t// STEP 2: Update the current version to point to your latest version\n\tcurrentVersion: Versions.Initial,\n\tfirstVersion: Versions.Initial,\n\tmigrators: {\n\t\t// STEP 3: Add an up+down migration for the new version here\n\t},\n})\n","import { defineMigrations } from '@tldraw/tlstore'\nimport { T } from '@tldraw/tlvalidate'\nimport { TLColorType, TLDashType, TLIconType, TLOpacityType, TLSizeType } from '../style-types'\nimport {\n\tcolorValidator,\n\tdashValidator,\n\ticonValidator,\n\topacityValidator,\n\tsizeValidator,\n} from '../validation'\nimport { TLBaseShape, createShapeValidator } from './shape-validation'\n\n/** @public */\nexport type TLIconShapeProps = {\n\tsize: TLSizeType\n\ticon: TLIconType\n\tdash: TLDashType\n\tcolor: TLColorType\n\topacity: TLOpacityType\n\tscale: number\n}\n\n/** @public */\nexport type TLIconShape = TLBaseShape<'icon', TLIconShapeProps>\n\n// --- VALIDATION ---\n/** @public */\nexport const iconShapeTypeValidator: T.Validator<TLIconShape> = createShapeValidator(\n\t'icon',\n\tT.object({\n\t\tsize: sizeValidator,\n\t\ticon: iconValidator,\n\t\tdash: dashValidator,\n\t\tcolor: colorValidator,\n\t\topacity: opacityValidator,\n\t\tscale: T.number,\n\t})\n)\n\n// --- MIGRATIONS ---\n// STEP 1: Add a new version number here, give it a meaningful name.\n// It should be 1 higher than the current version\nconst Versions = {\n\tInitial: 0,\n} as const\n\n/** @public */\nexport const iconShapeMigrations = defineMigrations({\n\t// STEP 2: Update the current version to point to your latest version\n\tcurrentVersion: Versions.Initial,\n\tfirstVersion: Versions.Initial,\n\tmigrators: {\n\t\t// STEP 3: Add an up+down migration for the new version here\n\t},\n})\n","import { defineMigrations } from '@tldraw/tlstore'\nimport { T } from '@tldraw/tlvalidate'\nimport { TLAssetId } from '../records/TLAsset'\nimport { TLOpacityType } from '../style-types'\nimport { assetIdValidator, opacityValidator } from '../validation'\nimport { TLBaseShape, createShapeValidator } from './shape-validation'\n\n/** @public */\nexport type TLImageShapeProps = {\n\topacity: TLOpacityType\n\turl: string\n\tplaying: boolean\n\tw: number\n\th: number\n\tassetId: TLAssetId | null\n}\n\n/** @public */\nexport type TLImageShape = TLBaseShape<'image', TLImageShapeProps>\n\n// --- VALIDATION ---\n/** @public */\nexport const imageShapeTypeValidator: T.Validator<TLImageShape> = createShapeValidator(\n\t'image',\n\tT.object({\n\t\topacity: opacityValidator,\n\t\tw: T.nonZeroNumber,\n\t\th: T.nonZeroNumber,\n\t\tplaying: T.boolean,\n\t\turl: T.string,\n\t\tassetId: assetIdValidator.nullable(),\n\t})\n)\n\n// --- MIGRATIONS ---\n// STEP 1: Add a new version number here, give it a meaningful name.\n// It should be 1 higher than the current version\nconst Versions = {\n\tInitial: 0,\n\tAddUrlProp: 1,\n} as const\n\n/** @public */\nexport const imageShapeMigrations = defineMigrations({\n\t// STEP 2: Update the current version to point to your latest version\n\tfirstVersion: Versions.Initial,\n\tcurrentVersion: Versions.AddUrlProp,\n\tmigrators: {\n\t\t// STEP 3: Add an up+down migration for the new version here\n\t\t[Versions.AddUrlProp]: {\n\t\t\tup: (shape) => {\n\t\t\t\treturn { ...shape, props: { ...shape.props, url: '' } }\n\t\t\t},\n\t\t\tdown: (shape) => {\n\t\t\t\tconst { url: _, ...props } = shape.props\n\t\t\t\treturn { ...shape, props }\n\t\t\t},\n\t\t},\n\t},\n})\n","import { defineMigrations } from '@tldraw/tlstore'\nimport { T } from '@tldraw/tlvalidate'\nimport { TLColorType, TLDashType, TLOpacityType, TLSizeType, TLSplineType } from '../style-types'\nimport { TLHandle, handleTypeValidator } from '../ui-types'\nimport {\n\tcolorValidator,\n\tdashValidator,\n\topacityValidator,\n\tsizeValidator,\n\tsplineValidator,\n} from '../validation'\nimport { TLBaseShape, createShapeValidator } from './shape-validation'\n\n/** @public */\nexport type TLLineShapeProps = {\n\tcolor: TLColorType\n\tdash: TLDashType\n\tsize: TLSizeType\n\topacity: TLOpacityType\n\tspline: TLSplineType\n\thandles: {\n\t\t[key: string]: TLHandle\n\t}\n}\n\n/** @public */\nexport type TLLineShape = TLBaseShape<'line', TLLineShapeProps>\n\n// --- VALIDATION ---\n/** @public */\nexport const lineShapeTypeValidator: T.Validator<TLLineShape> = createShapeValidator(\n\t'line',\n\tT.object({\n\t\tcolor: colorValidator,\n\t\tdash: dashValidator,\n\t\tsize: sizeValidator,\n\t\topacity: opacityValidator,\n\t\tspline: splineValidator,\n\t\thandles: T.dict(T.string, handleTypeValidator),\n\t})\n)\n\n// --- MIGRATIONS ---\n// STEP 1: Add a new version number here, give it a meaningful name.\n// It should be 1 higher than the current version\nconst Versions = {\n\tInitial: 0,\n} as const\n\n/** @public */\nexport const lineShapeMigrations = defineMigrations({\n\t// STEP 2: Update the current version to point to your latest version\n\tcurrentVersion: Versions.Initial,\n\tfirstVersion: Versions.Initial,\n\tmigrators: {\n\t\t// STEP 3: Add an up+down migration for the new version here\n\t},\n})\n","import { defineMigrations } from '@tldraw/tlstore'\nimport { T } from '@tldraw/tlvalidate'\nimport { TLAlignType, TLColorType, TLFontType, TLOpacityType, TLSizeType } from '../style-types'\nimport {\n\talignValidator,\n\tcolorValidator,\n\tfontValidator,\n\topacityValidator,\n\tsizeValidator,\n} from '../validation'\nimport { TLBaseShape, createShapeValidator } from './shape-validation'\n\n/** @public */\nexport type TLNoteShapeProps = {\n\tcolor: TLColorType\n\tsize: TLSizeType\n\tfont: TLFontType\n\talign: TLAlignType\n\topacity: TLOpacityType\n\tgrowY: number\n\turl: string\n\ttext: string\n}\n\n/** @public */\nexport type TLNoteShape = TLBaseShape<'note', TLNoteShapeProps>\n\n// --- VALIDATION ---\n/** @public */\nexport const noteShapeTypeValidator: T.Validator<TLNoteShape> = createShapeValidator(\n\t'note',\n\tT.object({\n\t\tcolor: colorValidator,\n\t\tsize: sizeValidator,\n\t\tfont: fontValidator,\n\t\talign: alignValidator,\n\t\topacity: opacityValidator,\n\t\tgrowY: T.positiveNumber,\n\t\turl: T.string,\n\t\ttext: T.string,\n\t})\n)\n\n// --- MIGRATIONS ---\n// STEP 1: Add a new version number here, give it a meaningful name.\n// It should be 1 higher than the current version\nconst Versions = {\n\tInitial: 0,\n\tAddUrlProp: 1,\n} as const\n\n/** @public */\nexport const noteShapeMigrations = defineMigrations({\n\t// STEP 2: Update the current version to point to your latest version\n\tfirstVersion: Versions.Initial,\n\tcurrentVersion: Versions.AddUrlProp,\n\tmigrators: {\n\t\t// STEP 3: Add an up+down migration for the new version here\n\t\t[Versions.AddUrlProp]: {\n\t\t\tup: (shape) => {\n\t\t\t\treturn { ...shape, props: { ...shape.props, url: '' } }\n\t\t\t},\n\t\t\tdown: (shape) => {\n\t\t\t\tconst { url: _, ...props } = shape.props\n\t\t\t\treturn { ...shape, props }\n\t\t\t},\n\t\t},\n\t},\n})\n","import { defineMigrations } from '@tldraw/tlstore'\nimport { T } from '@tldraw/tlvalidate'\nimport { TLAlignType, TLColorType, TLFontType, TLOpacityType, TLSizeType } from '../style-types'\nimport {\n\talignValidator,\n\tcolorValidator,\n\tfontValidator,\n\topacityValidator,\n\tsizeValidator,\n} from '../validation'\nimport { TLBaseShape, createShapeValidator } from './shape-validation'\n\n/** @public */\nexport type TLTextShapeProps = {\n\tcolor: TLColorType\n\tsize: TLSizeType\n\tfont: TLFontType\n\talign: TLAlignType\n\topacity: TLOpacityType\n\tw: number\n\ttext: string\n\tscale: number\n\tautoSize: boolean\n}\n\n/** @public */\nexport type TLTextShape = TLBaseShape<'text', TLTextShapeProps>\n\n// --- VALIDATION ---\n/** @public */\nexport const textShapeTypeValidator: T.Validator<TLTextShape> = createShapeValidator(\n\t'text',\n\tT.object({\n\t\tcolor: colorValidator,\n\t\tsize: sizeValidator,\n\t\tfont: fontValidator,\n\t\talign: alignValidator,\n\t\topacity: opacityValidator,\n\t\tw: T.nonZeroNumber,\n\t\ttext: T.string,\n\t\tscale: T.nonZeroNumber,\n\t\tautoSize: T.boolean,\n\t})\n)\n\n// --- MIGRATIONS ---\n// STEP 1: Add a new version number here, give it a meaningful name.\n// It should be 1 higher than the current version\nconst Versions = {\n\tInitial: 0,\n} as const\n\n/** @public */\nexport const textShapeMigrations = defineMigrations({\n\t// STEP 2: Update the current version to point to your latest version\n\tfirstVersion: Versions.Initial,\n\tcurrentVersion: Versions.Initial,\n\tmigrators: {},\n})\n","import { defineMigrations } from '@tldraw/tlstore'\nimport { T } from '@tldraw/tlvalidate'\nimport { TLAssetId } from '../records/TLAsset'\nimport { TLOpacityType } from '../style-types'\nimport { assetIdValidator, opacityValidator } from '../validation'\nimport { TLBaseShape, createShapeValidator } from './shape-validation'\n\n/** @public */\nexport type TLVideoShapeProps = {\n\topacity: TLOpacityType\n\tw: number\n\th: number\n\ttime: number\n\tplaying: boolean\n\turl: string\n\tassetId: TLAssetId | null\n}\n\n/** @public */\nexport type TLVideoShape = TLBaseShape<'video', TLVideoShapeProps>\n\n// --- VALIDATION ---\n/** @public */\nexport const videoShapeTypeValidator: T.Validator<TLVideoShape> = createShapeValidator(\n\t'video',\n\tT.object({\n\t\topacity: opacityValidator,\n\t\tw: T.nonZeroNumber,\n\t\th: T.nonZeroNumber,\n\t\ttime: T.number,\n\t\tplaying: T.boolean,\n\t\turl: T.string,\n\t\tassetId: assetIdValidator.nullable(),\n\t})\n)\n\n// --- MIGRATIONS ---\n// STEP 1: Add a new version number here, give it a meaningful name.\n// It should be 1 higher than the current version\nconst Versions = {\n\tInitial: 0,\n\tAddUrlProp: 1,\n} as const\n\n/** @public */\nexport const videoShapeMigrations = defineMigrations({\n\t// STEP 2: Update the current version to point to your latest version\n\tfirstVersion: Versions.Initial,\n\tcurrentVersion: Versions.AddUrlProp,\n\tmigrators: {\n\t\t// STEP 3: Add an up+down migration for the new version here\n\t\t[Versions.AddUrlProp]: {\n\t\t\tup: (shape) => {\n\t\t\t\treturn { ...shape, props: { ...shape.props, url: '' } }\n\t\t\t},\n\t\t\tdown: (shape) => {\n\t\t\t\tconst { url: _, ...props } = shape.props\n\t\t\t\treturn { ...shape, props }\n\t\t\t},\n\t\t},\n\t},\n})\n","import _typeof from \"./typeof.js\";\nexport default function _regeneratorRuntime() {\n  \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */\n  _regeneratorRuntime = function _regeneratorRuntime() {\n    return exports;\n  };\n  var exports = {},\n    Op = Object.prototype,\n    hasOwn = Op.hasOwnProperty,\n    defineProperty = Object.defineProperty || function (obj, key, desc) {\n      obj[key] = desc.value;\n    },\n    $Symbol = \"function\" == typeof Symbol ? Symbol : {},\n    iteratorSymbol = $Symbol.iterator || \"@@iterator\",\n    asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\",\n    toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n  function define(obj, key, value) {\n    return Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: !0,\n      configurable: !0,\n      writable: !0\n    }), obj[key];\n  }\n  try {\n    define({}, \"\");\n  } catch (err) {\n    define = function define(obj, key, value) {\n      return obj[key] = value;\n    };\n  }\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator,\n      generator = Object.create(protoGenerator.prototype),\n      context = new Context(tryLocsList || []);\n    return defineProperty(generator, \"_invoke\", {\n      value: makeInvokeMethod(innerFn, self, context)\n    }), generator;\n  }\n  function tryCatch(fn, obj, arg) {\n    try {\n      return {\n        type: \"normal\",\n        arg: fn.call(obj, arg)\n      };\n    } catch (err) {\n      return {\n        type: \"throw\",\n        arg: err\n      };\n    }\n  }\n  exports.wrap = wrap;\n  var ContinueSentinel = {};\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n  var IteratorPrototype = {};\n  define(IteratorPrototype, iteratorSymbol, function () {\n    return this;\n  });\n  var getProto = Object.getPrototypeOf,\n    NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  NativeIteratorPrototype && NativeIteratorPrototype !== Op && hasOwn.call(NativeIteratorPrototype, iteratorSymbol) && (IteratorPrototype = NativeIteratorPrototype);\n  var Gp = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(IteratorPrototype);\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function (method) {\n      define(prototype, method, function (arg) {\n        return this._invoke(method, arg);\n      });\n    });\n  }\n  function AsyncIterator(generator, PromiseImpl) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (\"throw\" !== record.type) {\n        var result = record.arg,\n          value = result.value;\n        return value && \"object\" == _typeof(value) && hasOwn.call(value, \"__await\") ? PromiseImpl.resolve(value.__await).then(function (value) {\n          invoke(\"next\", value, resolve, reject);\n        }, function (err) {\n          invoke(\"throw\", err, resolve, reject);\n        }) : PromiseImpl.resolve(value).then(function (unwrapped) {\n          result.value = unwrapped, resolve(result);\n        }, function (error) {\n          return invoke(\"throw\", error, resolve, reject);\n        });\n      }\n      reject(record.arg);\n    }\n    var previousPromise;\n    defineProperty(this, \"_invoke\", {\n      value: function value(method, arg) {\n        function callInvokeWithMethodAndArg() {\n          return new PromiseImpl(function (resolve, reject) {\n            invoke(method, arg, resolve, reject);\n          });\n        }\n        return previousPromise = previousPromise ? previousPromise.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg();\n      }\n    });\n  }\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = \"suspendedStart\";\n    return function (method, arg) {\n      if (\"executing\" === state) throw new Error(\"Generator is already running\");\n      if (\"completed\" === state) {\n        if (\"throw\" === method) throw arg;\n        return doneResult();\n      }\n      for (context.method = method, context.arg = arg;;) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n        if (\"next\" === context.method) context.sent = context._sent = context.arg;else if (\"throw\" === context.method) {\n          if (\"suspendedStart\" === state) throw state = \"completed\", context.arg;\n          context.dispatchException(context.arg);\n        } else \"return\" === context.method && context.abrupt(\"return\", context.arg);\n        state = \"executing\";\n        var record = tryCatch(innerFn, self, context);\n        if (\"normal\" === record.type) {\n          if (state = context.done ? \"completed\" : \"suspendedYield\", record.arg === ContinueSentinel) continue;\n          return {\n            value: record.arg,\n            done: context.done\n          };\n        }\n        \"throw\" === record.type && (state = \"completed\", context.method = \"throw\", context.arg = record.arg);\n      }\n    };\n  }\n  function maybeInvokeDelegate(delegate, context) {\n    var methodName = context.method,\n      method = delegate.iterator[methodName];\n    if (undefined === method) return context.delegate = null, \"throw\" === methodName && delegate.iterator[\"return\"] && (context.method = \"return\", context.arg = undefined, maybeInvokeDelegate(delegate, context), \"throw\" === context.method) || \"return\" !== methodName && (context.method = \"throw\", context.arg = new TypeError(\"The iterator does not provide a '\" + methodName + \"' method\")), ContinueSentinel;\n    var record = tryCatch(method, delegate.iterator, context.arg);\n    if (\"throw\" === record.type) return context.method = \"throw\", context.arg = record.arg, context.delegate = null, ContinueSentinel;\n    var info = record.arg;\n    return info ? info.done ? (context[delegate.resultName] = info.value, context.next = delegate.nextLoc, \"return\" !== context.method && (context.method = \"next\", context.arg = undefined), context.delegate = null, ContinueSentinel) : info : (context.method = \"throw\", context.arg = new TypeError(\"iterator result is not an object\"), context.delegate = null, ContinueSentinel);\n  }\n  function pushTryEntry(locs) {\n    var entry = {\n      tryLoc: locs[0]\n    };\n    1 in locs && (entry.catchLoc = locs[1]), 2 in locs && (entry.finallyLoc = locs[2], entry.afterLoc = locs[3]), this.tryEntries.push(entry);\n  }\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\", delete record.arg, entry.completion = record;\n  }\n  function Context(tryLocsList) {\n    this.tryEntries = [{\n      tryLoc: \"root\"\n    }], tryLocsList.forEach(pushTryEntry, this), this.reset(!0);\n  }\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) return iteratorMethod.call(iterable);\n      if (\"function\" == typeof iterable.next) return iterable;\n      if (!isNaN(iterable.length)) {\n        var i = -1,\n          next = function next() {\n            for (; ++i < iterable.length;) if (hasOwn.call(iterable, i)) return next.value = iterable[i], next.done = !1, next;\n            return next.value = undefined, next.done = !0, next;\n          };\n        return next.next = next;\n      }\n    }\n    return {\n      next: doneResult\n    };\n  }\n  function doneResult() {\n    return {\n      value: undefined,\n      done: !0\n    };\n  }\n  return GeneratorFunction.prototype = GeneratorFunctionPrototype, defineProperty(Gp, \"constructor\", {\n    value: GeneratorFunctionPrototype,\n    configurable: !0\n  }), defineProperty(GeneratorFunctionPrototype, \"constructor\", {\n    value: GeneratorFunction,\n    configurable: !0\n  }), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, toStringTagSymbol, \"GeneratorFunction\"), exports.isGeneratorFunction = function (genFun) {\n    var ctor = \"function\" == typeof genFun && genFun.constructor;\n    return !!ctor && (ctor === GeneratorFunction || \"GeneratorFunction\" === (ctor.displayName || ctor.name));\n  }, exports.mark = function (genFun) {\n    return Object.setPrototypeOf ? Object.setPrototypeOf(genFun, GeneratorFunctionPrototype) : (genFun.__proto__ = GeneratorFunctionPrototype, define(genFun, toStringTagSymbol, \"GeneratorFunction\")), genFun.prototype = Object.create(Gp), genFun;\n  }, exports.awrap = function (arg) {\n    return {\n      __await: arg\n    };\n  }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, asyncIteratorSymbol, function () {\n    return this;\n  }), exports.AsyncIterator = AsyncIterator, exports.async = function (innerFn, outerFn, self, tryLocsList, PromiseImpl) {\n    void 0 === PromiseImpl && (PromiseImpl = Promise);\n    var iter = new AsyncIterator(wrap(innerFn, outerFn, self, tryLocsList), PromiseImpl);\n    return exports.isGeneratorFunction(outerFn) ? iter : iter.next().then(function (result) {\n      return result.done ? result.value : iter.next();\n    });\n  }, defineIteratorMethods(Gp), define(Gp, toStringTagSymbol, \"Generator\"), define(Gp, iteratorSymbol, function () {\n    return this;\n  }), define(Gp, \"toString\", function () {\n    return \"[object Generator]\";\n  }), exports.keys = function (val) {\n    var object = Object(val),\n      keys = [];\n    for (var key in object) keys.push(key);\n    return keys.reverse(), function next() {\n      for (; keys.length;) {\n        var key = keys.pop();\n        if (key in object) return next.value = key, next.done = !1, next;\n      }\n      return next.done = !0, next;\n    };\n  }, exports.values = values, Context.prototype = {\n    constructor: Context,\n    reset: function reset(skipTempReset) {\n      if (this.prev = 0, this.next = 0, this.sent = this._sent = undefined, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = undefined, this.tryEntries.forEach(resetTryEntry), !skipTempReset) for (var name in this) \"t\" === name.charAt(0) && hasOwn.call(this, name) && !isNaN(+name.slice(1)) && (this[name] = undefined);\n    },\n    stop: function stop() {\n      this.done = !0;\n      var rootRecord = this.tryEntries[0].completion;\n      if (\"throw\" === rootRecord.type) throw rootRecord.arg;\n      return this.rval;\n    },\n    dispatchException: function dispatchException(exception) {\n      if (this.done) throw exception;\n      var context = this;\n      function handle(loc, caught) {\n        return record.type = \"throw\", record.arg = exception, context.next = loc, caught && (context.method = \"next\", context.arg = undefined), !!caught;\n      }\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i],\n          record = entry.completion;\n        if (\"root\" === entry.tryLoc) return handle(\"end\");\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\"),\n            hasFinally = hasOwn.call(entry, \"finallyLoc\");\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) return handle(entry.catchLoc, !0);\n            if (this.prev < entry.finallyLoc) return handle(entry.finallyLoc);\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) return handle(entry.catchLoc, !0);\n          } else {\n            if (!hasFinally) throw new Error(\"try statement without catch or finally\");\n            if (this.prev < entry.finallyLoc) return handle(entry.finallyLoc);\n          }\n        }\n      }\n    },\n    abrupt: function abrupt(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev && hasOwn.call(entry, \"finallyLoc\") && this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n      finallyEntry && (\"break\" === type || \"continue\" === type) && finallyEntry.tryLoc <= arg && arg <= finallyEntry.finallyLoc && (finallyEntry = null);\n      var record = finallyEntry ? finallyEntry.completion : {};\n      return record.type = type, record.arg = arg, finallyEntry ? (this.method = \"next\", this.next = finallyEntry.finallyLoc, ContinueSentinel) : this.complete(record);\n    },\n    complete: function complete(record, afterLoc) {\n      if (\"throw\" === record.type) throw record.arg;\n      return \"break\" === record.type || \"continue\" === record.type ? this.next = record.arg : \"return\" === record.type ? (this.rval = this.arg = record.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === record.type && afterLoc && (this.next = afterLoc), ContinueSentinel;\n    },\n    finish: function finish(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) return this.complete(entry.completion, entry.afterLoc), resetTryEntry(entry), ContinueSentinel;\n      }\n    },\n    \"catch\": function _catch(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (\"throw\" === record.type) {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n      throw new Error(\"illegal catch attempt\");\n    },\n    delegateYield: function delegateYield(iterable, resultName, nextLoc) {\n      return this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      }, \"next\" === this.method && (this.arg = undefined), ContinueSentinel;\n    }\n  }, exports;\n}","function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\nexport default function _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n      args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n      _next(undefined);\n    });\n  };\n}","import arrayWithHoles from \"./arrayWithHoles.js\";\nimport iterableToArray from \"./iterableToArray.js\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nimport nonIterableRest from \"./nonIterableRest.js\";\nexport default function _toArray(arr) {\n  return arrayWithHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableRest();\n}","/** @public */\nexport const EASINGS = {\n\tlinear: (t: number) => t,\n\teaseInQuad: (t: number) => t * t,\n\teaseOutQuad: (t: number) => t * (2 - t),\n\teaseInOutQuad: (t: number) => (t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t),\n\teaseInCubic: (t: number) => t * t * t,\n\teaseOutCubic: (t: number) => --t * t * t + 1,\n\teaseInOutCubic: (t: number) =>\n\t\tt < 0.5 ? 4 * t * t * t : (t - 1) * (2 * t - 2) * (2 * t - 2) + 1,\n\teaseInQuart: (t: number) => t * t * t * t,\n\teaseOutQuart: (t: number) => 1 - --t * t * t * t,\n\teaseInOutQuart: (t: number) => (t < 0.5 ? 8 * t * t * t * t : 1 - 8 * --t * t * t * t),\n\teaseInQuint: (t: number) => t * t * t * t * t,\n\teaseOutQuint: (t: number) => 1 + --t * t * t * t * t,\n\teaseInOutQuint: (t: number) => (t < 0.5 ? 16 * t * t * t * t * t : 1 + 16 * --t * t * t * t * t),\n\teaseInSine: (t: number) => 1 - Math.cos((t * Math.PI) / 2),\n\teaseOutSine: (t: number) => Math.sin((t * Math.PI) / 2),\n\teaseInOutSine: (t: number) => -(Math.cos(Math.PI * t) - 1) / 2,\n\teaseInExpo: (t: number) => (t <= 0 ? 0 : Math.pow(2, 10 * t - 10)),\n\teaseOutExpo: (t: number) => (t >= 1 ? 1 : 1 - Math.pow(2, -10 * t)),\n\teaseInOutExpo: (t: number) =>\n\t\tt <= 0\n\t\t\t? 0\n\t\t\t: t >= 1\n\t\t\t? 1\n\t\t\t: t < 0.5\n\t\t\t? Math.pow(2, 20 * t - 10) / 2\n\t\t\t: (2 - Math.pow(2, -20 * t + 10)) / 2,\n} as const\n\n/** @public */\nexport type EasingType = keyof typeof EASINGS\n","import { Vec2dModel } from '@tldraw/tlschema'\nimport { EASINGS } from '../easings'\n\n/** @public */\nexport type VecLike = Vec2d | Vec2dModel\n\n/** @public */\nexport class Vec2d {\n\tconstructor(public x = 0, public y = 0, public z = 1) {}\n\n\tget pressure() {\n\t\treturn this.z\n\t}\n\n\tset(x = this.x, y = this.y, z = this.z) {\n\t\tthis.x = x\n\t\tthis.y = y\n\t\tthis.z = z\n\t\treturn this\n\t}\n\n\tsetTo({ x = 0, y = 0, z = 1 }: VecLike) {\n\t\tthis.x = x\n\t\tthis.y = y\n\t\tthis.z = z\n\t\treturn this\n\t}\n\n\trot(r: number) {\n\t\tif (r === 0) return this\n\t\tconst { x, y } = this\n\t\tconst s = Math.sin(r)\n\t\tconst c = Math.cos(r)\n\t\tthis.x = x * c - y * s\n\t\tthis.y = x * s + y * c\n\t\treturn this\n\t}\n\n\trotWith(C: VecLike, r: number) {\n\t\tif (r === 0) return this\n\t\tconst x = this.x - C.x\n\t\tconst y = this.y - C.y\n\t\tconst s = Math.sin(r)\n\t\tconst c = Math.cos(r)\n\t\tthis.x = C.x + (x * c - y * s)\n\t\tthis.y = C.y + (x * s + y * c)\n\t\treturn this\n\t}\n\n\tclone(): Vec2d {\n\t\tconst { x, y, z } = this\n\t\treturn new Vec2d(x, y, z)\n\t}\n\n\tsub(V: VecLike) {\n\t\tthis.x -= V.x\n\t\tthis.y -= V.y\n\t\treturn this\n\t}\n\n\tsubXY(x: number, y: number) {\n\t\tthis.x -= x\n\t\tthis.y -= y\n\t\treturn this\n\t}\n\n\tsubScalar(n: number) {\n\t\tthis.x -= n\n\t\tthis.y -= n\n\t\t// this.z -= n\n\n\t\treturn this\n\t}\n\n\tadd(V: VecLike) {\n\t\tthis.x += V.x\n\t\tthis.y += V.y\n\t\treturn this\n\t}\n\n\taddXY(x: number, y: number) {\n\t\tthis.x += x\n\t\tthis.y += y\n\t\treturn this\n\t}\n\n\taddScalar(n: number) {\n\t\tthis.x += n\n\t\tthis.y += n\n\t\t// this.z += n\n\n\t\treturn this\n\t}\n\n\tclamp(min: number, max?: number) {\n\t\tthis.x = Math.min(Math.max(this.x, min), max ?? this.x)\n\t\tthis.y = Math.min(Math.max(this.y, min), max ?? this.y)\n\t\t// this.z = Math.min(Math.max(this.z, min), max ?? this.z)\n\t\t// this.z = clamp(this.z, min, max)\n\n\t\treturn this\n\t}\n\n\tdiv(t: number) {\n\t\tthis.x /= t\n\t\tthis.y /= t\n\t\t// this.z /= t\n\t\treturn this\n\t}\n\n\tdivV(V: VecLike) {\n\t\tthis.x /= V.x\n\t\tthis.y /= V.y\n\t\t// this.z /= V.z\n\t\treturn this\n\t}\n\n\tmul(t: number) {\n\t\tthis.x *= t\n\t\tthis.y *= t\n\t\t// this.z *= t\n\t\treturn this\n\t}\n\n\tmulV(V: VecLike) {\n\t\tthis.x *= V.x\n\t\tthis.y *= V.y\n\t\t// this.z *= V.z\n\t\treturn this\n\t}\n\n\tabs() {\n\t\tthis.x = Math.abs(this.x)\n\t\tthis.y = Math.abs(this.y)\n\t\treturn this\n\t}\n\n\tnudge(B: VecLike, distance: number) {\n\t\tconst tan = Vec2d.Tan(B, this)\n\t\treturn this.add(tan.mul(distance))\n\t}\n\n\tneg() {\n\t\tthis.x *= -1\n\t\tthis.y *= -1\n\t\t// this.z *= -1\n\t\treturn this\n\t}\n\n\tcross(V: VecLike) {\n\t\tthis.x = this.y * V.z! - this.z * V.y\n\t\tthis.y = this.z * V.x - this.x * V.z!\n\t\t// this.z = this.x * V.y - this.y * V.x\n\t\treturn this\n\t}\n\n\tdpr(V: VecLike): number {\n\t\treturn Vec2d.Dpr(this, V)\n\t}\n\n\tcpr(V: VecLike) {\n\t\treturn Vec2d.Cpr(this, V)\n\t}\n\n\tlen2(): number {\n\t\treturn Vec2d.Len2(this)\n\t}\n\n\tlen(): number {\n\t\treturn Vec2d.Len(this)\n\t}\n\n\tpry(V: VecLike): number {\n\t\treturn Vec2d.Pry(this, V)\n\t}\n\n\tper() {\n\t\tconst { x, y } = this\n\t\tthis.x = y\n\t\tthis.y = -x\n\t\treturn this\n\t}\n\n\tuni() {\n\t\treturn Vec2d.Uni(this)\n\t}\n\n\ttan(V: VecLike): Vec2d {\n\t\treturn Vec2d.Tan(this, V)\n\t}\n\n\tdist(V: VecLike): number {\n\t\treturn Vec2d.Dist(this, V)\n\t}\n\n\tdistanceToLineSegment(A: VecLike, B: VecLike): number {\n\t\treturn Vec2d.DistanceToLineSegment(A, B, this)\n\t}\n\n\tslope(B: VecLike): number {\n\t\treturn Vec2d.Slope(this, B)\n\t}\n\n\tsnapToGrid(gridSize: number) {\n\t\tthis.x = Math.round(this.x / gridSize) * gridSize\n\t\tthis.y = Math.round(this.y / gridSize) * gridSize\n\t\treturn this\n\t}\n\n\tangle(B: VecLike): number {\n\t\treturn Vec2d.Angle(this, B)\n\t}\n\n\ttoAngle() {\n\t\treturn Vec2d.ToAngle(this)\n\t}\n\n\tlrp(B: VecLike, t: number): Vec2d {\n\t\tthis.x = this.x + (B.x - this.x) * t\n\t\tthis.y = this.y + (B.y - this.y) * t\n\t\treturn this\n\t}\n\n\tequals(B: VecLike) {\n\t\treturn Vec2d.Equals(this, B)\n\t}\n\n\tequalsXY(x: number, y: number) {\n\t\treturn Vec2d.EqualsXY(this, x, y)\n\t}\n\n\tnorm() {\n\t\tconst l = this.len()\n\t\tthis.x = l === 0 ? 0 : this.x / l\n\t\tthis.y = l === 0 ? 0 : this.y / l\n\t\treturn this\n\t}\n\n\ttoFixed() {\n\t\treturn Vec2d.ToFixed(this)\n\t}\n\n\ttoString() {\n\t\treturn Vec2d.ToString(Vec2d.ToFixed(this))\n\t}\n\n\ttoJson(): Vec2dModel {\n\t\treturn Vec2d.ToJson(this)\n\t}\n\n\ttoArray(): number[] {\n\t\treturn Vec2d.ToArray(this)\n\t}\n\n\tstatic Add(A: VecLike, B: VecLike): Vec2d {\n\t\treturn new Vec2d(A.x + B.x, A.y + B.y)\n\t}\n\n\tstatic AddXY(A: VecLike, x: number, y: number): Vec2d {\n\t\treturn new Vec2d(A.x + x, A.y + y)\n\t}\n\n\tstatic Sub(A: VecLike, B: VecLike): Vec2d {\n\t\treturn new Vec2d(A.x - B.x, A.y - B.y)\n\t}\n\n\tstatic SubXY(A: VecLike, x: number, y: number): Vec2d {\n\t\treturn new Vec2d(A.x - x, A.y - y)\n\t}\n\n\tstatic AddScalar(A: VecLike, n: number): Vec2d {\n\t\treturn new Vec2d(A.x + n, A.y + n)\n\t}\n\n\tstatic SubScalar(A: VecLike, n: number): Vec2d {\n\t\treturn new Vec2d(A.x - n, A.y - n)\n\t}\n\n\tstatic Div(A: VecLike, t: number): Vec2d {\n\t\treturn new Vec2d(A.x / t, A.y / t)\n\t}\n\n\tstatic Mul(A: VecLike, t: number): Vec2d {\n\t\treturn new Vec2d(A.x * t, A.y * t)\n\t}\n\n\tstatic DivV(A: VecLike, B: VecLike): Vec2d {\n\t\treturn new Vec2d(A.x / B.x, A.y / B.y)\n\t}\n\n\tstatic MulV(A: VecLike, B: VecLike): Vec2d {\n\t\treturn new Vec2d(A.x * B.x, A.y * B.y)\n\t}\n\n\tstatic Neg(A: VecLike): Vec2d {\n\t\treturn new Vec2d(-A.x, -A.y)\n\t}\n\n\tstatic Per(A: VecLike): Vec2d {\n\t\treturn new Vec2d(A.y, -A.x)\n\t}\n\n\tstatic Dist2(A: VecLike, B: VecLike): number {\n\t\treturn Vec2d.Sub(A, B).len2()\n\t}\n\n\tstatic Abs(A: VecLike): Vec2d {\n\t\treturn new Vec2d(Math.abs(A.x), Math.abs(A.y))\n\t}\n\n\tstatic Dist(A: VecLike, B: VecLike): number {\n\t\treturn Math.hypot(A.y - B.y, A.x - B.x)\n\t}\n\n\tstatic Dpr(A: VecLike, B: VecLike): number {\n\t\treturn A.x * B.x + A.y * B.y\n\t}\n\n\tstatic Cross(A: VecLike, V: VecLike) {\n\t\treturn new Vec2d(\n\t\t\tA.y * V.z! - A.z! * V.y,\n\t\t\tA.z! * V.x - A.x * V.z!\n\t\t\t// A.z = A.x * V.y - A.y * V.x\n\t\t)\n\t}\n\n\tstatic Cpr(A: VecLike, B: VecLike) {\n\t\treturn A.x * B.y - B.x * A.y\n\t}\n\n\tstatic Len2(A: VecLike): number {\n\t\treturn A.x * A.x + A.y * A.y\n\t}\n\n\tstatic Len(A: VecLike): number {\n\t\treturn Math.sqrt(Vec2d.Len2(A))\n\t}\n\n\tstatic Pry(A: VecLike, B: VecLike): number {\n\t\treturn Vec2d.Dpr(A, B) / Vec2d.Len(B)\n\t}\n\n\tstatic Uni(A: VecLike) {\n\t\treturn Vec2d.Div(A, Vec2d.Len(A))\n\t}\n\n\tstatic Tan(A: VecLike, B: VecLike): Vec2d {\n\t\treturn Vec2d.Uni(Vec2d.Sub(A, B))\n\t}\n\n\tstatic Min(A: VecLike, B: VecLike): Vec2d {\n\t\treturn new Vec2d(Math.min(A.x, B.x), Math.min(A.y, B.y))\n\t}\n\n\tstatic Max(A: VecLike, B: VecLike): Vec2d {\n\t\treturn new Vec2d(Math.max(A.x, B.x), Math.max(A.y, B.y))\n\t}\n\n\tstatic From({ x, y, z = 1 }: Vec2dModel) {\n\t\treturn new Vec2d(x, y, z)\n\t}\n\n\tstatic FromArray(v: number[]): Vec2d {\n\t\treturn new Vec2d(v[0], v[1])\n\t}\n\n\tstatic Rot(A: VecLike, r = 0): Vec2d {\n\t\tconst s = Math.sin(r)\n\t\tconst c = Math.cos(r)\n\t\treturn new Vec2d(A.x * c - A.y * s, A.x * s + A.y * c)\n\t}\n\n\tstatic RotWith(A: VecLike, C: VecLike, r: number): Vec2d {\n\t\tconst x = A.x - C.x\n\t\tconst y = A.y - C.y\n\t\tconst s = Math.sin(r)\n\t\tconst c = Math.cos(r)\n\t\treturn new Vec2d(C.x + (x * c - y * s), C.y + (x * s + y * c))\n\t}\n\n\t/**\n\t * Get the nearest point on a line with a known unit vector that passes through point A\n\t *\n\t * ```ts\n\t * Vec.nearestPointOnLineThroughPoint(A, u, Point)\n\t * ```\n\t *\n\t * @param A - Any point on the line\n\t * @param u - The unit vector for the line.\n\t * @param P - A point not on the line to test.\n\t */\n\tstatic NearestPointOnLineThroughPoint(A: VecLike, u: VecLike, P: VecLike): Vec2d {\n\t\treturn Vec2d.Mul(u, Vec2d.Sub(P, A).pry(u)).add(A)\n\t}\n\n\tstatic NearestPointOnLineSegment(A: VecLike, B: VecLike, P: VecLike, clamp = true): Vec2d {\n\t\tconst u = Vec2d.Tan(B, A)\n\t\tconst C = Vec2d.Add(A, Vec2d.Mul(u, Vec2d.Sub(P, A).pry(u)))\n\n\t\t// todo: fix error P is B or A, which leads to a NaN value\n\n\t\tif (clamp) {\n\t\t\tif (C.x < Math.min(A.x, B.x)) return Vec2d.Cast(A.x < B.x ? A : B)\n\t\t\tif (C.x > Math.max(A.x, B.x)) return Vec2d.Cast(A.x > B.x ? A : B)\n\t\t\tif (C.y < Math.min(A.y, B.y)) return Vec2d.Cast(A.y < B.y ? A : B)\n\t\t\tif (C.y > Math.max(A.y, B.y)) return Vec2d.Cast(A.y > B.y ? A : B)\n\t\t}\n\n\t\treturn C\n\t}\n\n\tstatic DistanceToLineThroughPoint(A: VecLike, u: VecLike, P: VecLike): number {\n\t\treturn Vec2d.Dist(P, Vec2d.NearestPointOnLineThroughPoint(A, u, P))\n\t}\n\n\tstatic DistanceToLineSegment(A: VecLike, B: VecLike, P: VecLike, clamp = true): number {\n\t\treturn Vec2d.Dist(P, Vec2d.NearestPointOnLineSegment(A, B, P, clamp))\n\t}\n\n\tstatic Snap(A: VecLike, step = 1) {\n\t\treturn new Vec2d(Math.round(A.x / step) * step, Math.round(A.y / step) * step)\n\t}\n\n\tstatic Cast(A: VecLike): Vec2d {\n\t\tif (A instanceof Vec2d) return A\n\t\treturn Vec2d.From(A)\n\t}\n\n\tstatic Slope(A: VecLike, B: VecLike): number {\n\t\tif (A.x === B.y) return NaN\n\t\treturn (A.y - B.y) / (A.x - B.x)\n\t}\n\n\tstatic Angle(A: VecLike, B: VecLike): number {\n\t\treturn Math.atan2(B.y - A.y, B.x - A.x)\n\t}\n\n\tstatic Lrp(A: VecLike, B: VecLike, t: number): Vec2d {\n\t\treturn Vec2d.Sub(B, A).mul(t).add(A)\n\t}\n\n\tstatic Med(A: VecLike, B: VecLike): Vec2d {\n\t\treturn new Vec2d((A.x + B.x) / 2, (A.y + B.y) / 2)\n\t}\n\n\tstatic Equals(A: VecLike, B: VecLike): boolean {\n\t\treturn Math.abs(A.x - B.x) < 0.0001 && Math.abs(A.y - B.y) < 0.0001\n\t}\n\n\tstatic EqualsXY(A: VecLike, x: number, y: number): boolean {\n\t\treturn A.x === x && A.y === y\n\t}\n\n\tstatic Clockwise(A: VecLike, B: VecLike, C: VecLike): boolean {\n\t\treturn (C.x - A.x) * (B.y - A.y) - (B.x - A.x) * (C.y - A.y) < 0\n\t}\n\n\tstatic Rescale(A: VecLike, n: number) {\n\t\tconst l = Vec2d.Len(A)\n\t\treturn new Vec2d((n * A.x) / l, (n * A.y) / l)\n\t}\n\n\tstatic ScaleWithOrigin(A: VecLike, scale: number, origin: VecLike) {\n\t\treturn Vec2d.Sub(A, origin).mul(scale).add(origin)\n\t}\n\n\tstatic ToFixed(A: VecLike, n = 2) {\n\t\treturn new Vec2d(+A.x.toFixed(n), +A.y.toFixed(n), +A.z!.toFixed(n))\n\t}\n\n\tstatic Nudge(A: VecLike, B: VecLike, distance: number) {\n\t\treturn Vec2d.Add(A, Vec2d.Tan(B, A).mul(distance))\n\t}\n\n\tstatic ToString(A: VecLike) {\n\t\treturn `${A.x}, ${A.y}`\n\t}\n\n\tstatic ToAngle(A: VecLike) {\n\t\tlet r = Math.atan2(A.y, A.x)\n\t\tif (r < 0) r += Math.PI * 2\n\n\t\treturn r\n\t}\n\n\tstatic ToArray(A: VecLike) {\n\t\treturn [A.x, A.y, A.z!]\n\t}\n\n\tstatic ToJson(A: VecLike) {\n\t\tconst { x, y, z } = A\n\t\treturn { x, y, z }\n\t}\n\n\tstatic Average(arr: VecLike[]) {\n\t\tconst len = arr.length\n\t\tconst avg = new Vec2d(0, 0)\n\t\tfor (let i = 0; i < len; i++) {\n\t\t\tavg.add(arr[i])\n\t\t}\n\t\treturn avg.div(len)\n\t}\n\n\tstatic Clamp(A: Vec2d, min: number, max?: number) {\n\t\treturn new Vec2d(\n\t\t\tMath.min(Math.max(A.x, min), max ?? A.x),\n\t\t\tMath.min(Math.max(A.y, min), max ?? A.y)\n\t\t)\n\t}\n\n\t/**\n\t * Get an array of points (with simulated pressure) between two points.\n\t *\n\t * @param A - The first point.\n\t * @param B - The second point.\n\t * @param steps - The number of points to return.\n\t */\n\tstatic PointsBetween(A: Vec2dModel, B: Vec2dModel, steps = 6): Vec2d[] {\n\t\tconst results: Vec2d[] = []\n\n\t\tfor (let i = 0; i < steps; i++) {\n\t\t\tconst t = EASINGS.easeInQuad(i / (steps - 1))\n\t\t\tconst point = Vec2d.Lrp(A, B, t)\n\t\t\tpoint.z = Math.min(1, 0.5 + Math.abs(0.5 - ease(t)) * 0.65)\n\t\t\tresults.push(point)\n\t\t}\n\n\t\treturn results\n\t}\n\n\tstatic SnapToGrid(A: VecLike, gridSize = 8) {\n\t\treturn new Vec2d(Math.round(A.x / gridSize) * gridSize, Math.round(A.y / gridSize) * gridSize)\n\t}\n}\n\nconst ease = (t: number) => (t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t)\n","import { Box2d } from './Box2d'\nimport { Vec2d, VecLike } from './Vec2d'\n\n/** @public */\nexport const PI = Math.PI\n/** @public */\nexport const TAU = PI / 2\n/** @public */\nexport const PI2 = PI * 2\n/** @public */\nexport const EPSILON = Math.PI / 180\n/**@public */\nexport const SIN = Math.sin\n\n/**\n * Clamp a value into a range.\n * @example\n * ```ts\n * const A = clamp(0, 1) // 1\n * ```\n *\n * @param n - The number to clamp.\n * @param min - The minimum value.\n * @public\n */\nexport function clamp(n: number, min: number): number\n/**\n * Clamp a value into a range.\n *\n * @example\n * ```ts\n * const A = clamp(0, 1, 10) // 1\n * const B = clamp(11, 1, 10) // 10\n * const C = clamp(5, 1, 10) // 5\n * ```\n *\n * @param n - The number to clamp.\n * @param min - The minimum value.\n * @param max - The maximum value.\n * @public\n */\nexport function clamp(n: number, min: number, max: number): number\nexport function clamp(n: number, min: number, max?: number): number {\n\treturn Math.max(min, typeof max !== 'undefined' ? Math.min(n, max) : n)\n}\n\n/**\n * Get a number to a precision.\n *\n * @param n - The number.\n * @param precision - The precision.\n * @public\n */\nexport function toPrecision(n: number, precision = 10000000000) {\n\tif (!n) return 0\n\treturn Math.round(n * precision) / precision\n}\n\n/**\n * Whether two numbers numbers a and b are approximately equal.\n *\n * @param a - The first point.\n * @param b - The second point.\n * @public\n */\nexport function approximately(a: number, b: number, precision = 0.000001) {\n\treturn Math.abs(a - b) <= precision\n}\n\n/**\n * Find the approximate perimeter of an ellipse.\n *\n * @param rx - The ellipse's x radius.\n * @param ry - The ellipse's y radius.\n * @public\n */\nexport function perimeterOfEllipse(rx: number, ry: number): number {\n\tconst h = Math.pow(rx - ry, 2) / Math.pow(rx + ry, 2)\n\tconst p = PI * (rx + ry) * (1 + (3 * h) / (10 + Math.sqrt(4 - 3 * h)))\n\treturn p\n}\n\n/**\n * @param a - Any angle in radians\n * @returns A number between 0 and 2 * PI\n * @public\n */\nexport function canolicalizeRotation(a: number) {\n\ta = a % PI2\n\tif (a < 0) {\n\t\ta = a + PI2\n\t} else if (a === 0) {\n\t\t// prevent negative zero\n\t\ta = 0\n\t}\n\treturn a\n}\n\n/**\n * Get the short angle distance between two angles.\n *\n * @param a0 - The first angle.\n * @param a1 - The second angle.\n * @public\n */\nexport function shortAngleDist(a0: number, a1: number): number {\n\tconst da = (a1 - a0) % PI2\n\treturn ((2 * da) % PI2) - da\n}\n\n/**\n * Get the long angle distance between two angles.\n *\n * @param a0 - The first angle.\n * @param a1 - The second angle.\n * @public\n */\nexport function longAngleDist(a0: number, a1: number): number {\n\treturn PI2 - shortAngleDist(a0, a1)\n}\n\n/**\n * Interpolate an angle between two angles.\n *\n * @param a0 - The first angle.\n * @param a1 - The second angle.\n * @param t - The interpolation value.\n * @public\n */\nexport function lerpAngles(a0: number, a1: number, t: number): number {\n\treturn a0 + shortAngleDist(a0, a1) * t\n}\n\n/**\n * Get the short distance between two angles.\n *\n * @param a0 - The first angle.\n * @param a1 - The second angle.\n * @public\n */\nexport function angleDelta(a0: number, a1: number): number {\n\treturn shortAngleDist(a0, a1)\n}\n\n/**\n * Get the \"sweep\" or short distance between two points on a circle's perimeter.\n *\n * @param C - The center of the circle.\n * @param A - The first point.\n * @param B - The second point.\n * @public\n */\nexport function getSweep(C: VecLike, A: VecLike, B: VecLike): number {\n\treturn angleDelta(Vec2d.Angle(C, A), Vec2d.Angle(C, B))\n}\n\n/**\n * Clamp radians within 0 and 2PI\n *\n * @param r - The radian value.\n * @public\n */\nexport function clampRadians(r: number): number {\n\treturn (PI2 + r) % PI2\n}\n\n/**\n * Clamp rotation to even segments.\n *\n * @param r - The rotation in radians.\n * @param segments - The number of segments.\n * @public\n */\nexport function snapAngle(r: number, segments: number): number {\n\tconst seg = PI2 / segments\n\tlet ang = (Math.floor((clampRadians(r) + seg / 2) / seg) * seg) % PI2\n\tif (ang < PI) ang += PI2\n\tif (ang > PI) ang -= PI2\n\treturn ang\n}\n\n/**\n * Checks whether two angles are approximately at right-angles or parallel to each other\n * @param a - angle a (radians)\n * @param b - angle b (radians)\n * @returns true iff the angles are approximately at right-angles or parallel to each other\n * @public\n */\nexport function areAnglesCompatible(a: number, b: number) {\n\treturn a === b || approximately((a % (Math.PI / 2)) - (b % (Math.PI / 2)), 0)\n}\n\n/**\n * Is angle c between angles a and b?\n *\n * @param a - The first angle.\n * @param b - The second angle.\n * @param c - The third angle.\n * @public\n */\nexport function isAngleBetween(a: number, b: number, c: number): boolean {\n\tif (c === a || c === b) return true\n\n\tconst AB = (b - a + TAU) % TAU\n\tconst AC = (c - a + TAU) % TAU\n\treturn AB <= PI !== AC > AB\n}\n\n/**\n * Convert degrees to radians.\n *\n * @param d - The degree in degrees.\n * @public\n */\nexport function degreesToRadians(d: number): number {\n\treturn (d * PI) / 180\n}\n\n/**\n * Convert radians to degrees.\n *\n * @param r - The degree in radians.\n * @public\n */\nexport function radiansToDegrees(r: number): number {\n\treturn (r * 180) / PI\n}\n\n/**\n * Get the length of an arc between two points on a circle's perimeter.\n *\n * @param C - The circle's center as [x, y].\n * @param r - The circle's radius.\n * @param A - The first point.\n * @param B - The second point.\n * @public\n */\nexport function getArcLength(C: VecLike, r: number, A: VecLike, B: VecLike): number {\n\tconst sweep = getSweep(C, A, B)\n\treturn r * PI2 * (sweep / PI2)\n}\n\n/**\n * Get a point on the perimeter of a circle.\n *\n * @param cx - The center x of the circle.\n * @param cy - The center y of the circle.\n * @param r - The radius of the circle.\n * @param a - The normalized point on the circle.\n * @public\n */\nexport function getPointOnCircle(cx: number, cy: number, r: number, a: number) {\n\treturn new Vec2d(cx + r * Math.cos(a), cy + r * Math.sin(a))\n}\n/** @public */\nexport function getPolygonVertices(width: number, height: number, sides: number) {\n\tconst cx = width / 2\n\tconst cy = height / 2\n\tconst pointsOnPerimeter = []\n\tfor (let i = 0; i < sides; i++) {\n\t\tconst step = PI2 / sides\n\t\tconst t = -TAU + i * step\n\t\tpointsOnPerimeter.push(new Vec2d(cx + cx * Math.cos(t), cy + cy * Math.sin(t)))\n\t}\n\treturn pointsOnPerimeter\n}\n\n/**\n * @param a0 - The start point in the A range\n * @param a1 - The end point in the A range\n * @param b0 - The start point in the B range\n * @param b1 - The end point in the B range\n * @returns True if the ranges overlap\n * @public\n */\nexport function rangesOverlap(a0: number, a1: number, b0: number, b1: number): boolean {\n\treturn a0 < b1 && b0 < a1\n}\n\n/**\n * Finds the intersection of two ranges.\n *\n * @param a0 - The start point in the A range\n * @param a1 - The end point in the A range\n * @param b0 - The start point in the B range\n * @param b1 - The end point in the B range\n * @returns The intersection of the ranges, or null if no intersection\n * @public\n */\nexport function rangeIntersection(\n\ta0: number,\n\ta1: number,\n\tb0: number,\n\tb1: number\n): [number, number] | null {\n\tconst min = Math.max(a0, b0)\n\tconst max = Math.min(a1, b1)\n\tif (min <= max) {\n\t\treturn [min, max]\n\t}\n\treturn null\n}\n\n/**\n * Gets the width/height of a star given its input bounds.\n *\n * @param sides - number of sides\n * @param w - t target width\n * @param h - target height\n * @returns Box2d\n * @public\n */\nexport const getStarBounds = (sides: number, w: number, h: number): Box2d => {\n\tconst step = PI2 / sides / 2\n\tconst rightMostIndex = Math.floor(sides / 4) * 2\n\tconst leftMostIndex = sides * 2 - rightMostIndex\n\tconst topMostIndex = 0\n\tconst bottomMostIndex = Math.floor(sides / 2) * 2\n\tconst maxX = (Math.cos(-TAU + rightMostIndex * step) * w) / 2\n\tconst minX = (Math.cos(-TAU + leftMostIndex * step) * w) / 2\n\tconst minY = (Math.sin(-TAU + topMostIndex * step) * h) / 2\n\tconst maxY = (Math.sin(-TAU + bottomMostIndex * step) * h) / 2\n\treturn new Box2d(0, 0, maxX - minX, maxY - minY)\n}\n\n/**\n * Helper for point in polygon\n */\nfunction cross(x: VecLike, y: VecLike, z: VecLike): number {\n\treturn (y.x - x.x) * (z.y - x.y) - (z.x - x.x) * (y.y - x.y)\n}\n\n/**\n * Utils for working with points.\n *\n * @public\n */\n/**\n * Get whether a point is inside of a circle.\n *\n * @param A - The point to check.\n * @param C - The circle's center point as [x, y].\n * @param r - The circle's radius.\n * @returns Boolean\n * @public\n */\nexport function pointInCircle(A: VecLike, C: VecLike, r: number): boolean {\n\treturn Vec2d.Dist(A, C) <= r\n}\n\n/**\n * Get whether a point is inside of an ellipse.\n *\n * @param point - The point to check.\n * @param center - The ellipse's center point as [x, y].\n * @param rx - The ellipse's x radius.\n * @param ry - The ellipse's y radius.\n * @param rotation - The ellipse's rotation.\n * @returns Boolean\n * @public\n */\nexport function pointInEllipse(\n\tA: VecLike,\n\tC: VecLike,\n\trx: number,\n\try: number,\n\trotation = 0\n): boolean {\n\trotation = rotation || 0\n\tconst cos = Math.cos(rotation)\n\tconst sin = Math.sin(rotation)\n\tconst delta = Vec2d.Sub(A, C)\n\tconst tdx = cos * delta.x + sin * delta.y\n\tconst tdy = sin * delta.x - cos * delta.y\n\n\treturn (tdx * tdx) / (rx * rx) + (tdy * tdy) / (ry * ry) <= 1\n}\n\n/**\n * Get whether a point is inside of a rectangle.\n *\n * @param A - The point to check.\n * @param point - The rectangle's top left point as [x, y].\n * @param size - The rectangle's size as [width, height].\n * @public\n */\nexport function pointInRect(A: VecLike, point: VecLike, size: VecLike): boolean {\n\treturn !(A.x < point.x || A.x > point.x + size.x || A.y < point.y || A.y > point.y + size.y)\n}\n\n/**\n * Get whether a point is inside of a polygon.\n *\n * ```ts\n * const result = pointInPolygon(myPoint, myPoints)\n * ```\n *\n * @public\n */\nexport function pointInPolygon(A: VecLike, points: VecLike[]): boolean {\n\tlet windingNumber = 0\n\tlet a: VecLike\n\tlet b: VecLike\n\n\tfor (let i = 0; i < points.length; i++) {\n\t\ta = points[i]\n\t\tb = points[(i + 1) % points.length]\n\n\t\tif (a.y <= A.y) {\n\t\t\tif (b.y > A.y && cross(a, b, A) > 0) {\n\t\t\t\twindingNumber += 1\n\t\t\t}\n\t\t} else if (b.y <= A.y && cross(a, b, A) < 0) {\n\t\t\twindingNumber -= 1\n\t\t}\n\t}\n\n\treturn windingNumber !== 0\n}\n\n/**\n * Get whether a point is inside of a bounds.\n *\n * @param A - The point to check.\n * @param b - The bounds to check.\n * @returns Boolean\n * @public\n */\nexport function pointInBounds(A: VecLike, b: Box2d): boolean {\n\treturn !(A.x < b.minX || A.x > b.maxX || A.y < b.minY || A.y > b.maxY)\n}\n\n/**\n * Hit test a point and a polyline using a minimum distance.\n *\n * @param A - The point to check.\n * @param points - The points that make up the polyline.\n * @param distance - The mininum distance that qualifies a hit.\n * @returns Boolean\n * @public\n */\nexport function pointInPolyline(A: VecLike, points: VecLike[], distance = 3): boolean {\n\tfor (let i = 1; i < points.length; i++) {\n\t\tif (Vec2d.DistanceToLineSegment(points[i - 1], points[i], A) < distance) {\n\t\t\treturn true\n\t\t}\n\t}\n\treturn false\n}\n\n/**\n * Get whether a point is within a certain distance from a polyline.\n *\n * @param A - The point to check.\n * @param points - The points that make up the polyline.\n * @param distance - The mininum distance that qualifies a hit.\n * @public\n */\nexport function pointNearToPolyline(A: VecLike, points: VecLike[], distance = 8) {\n\tconst len = points.length\n\tfor (let i = 1; i < len; i++) {\n\t\tconst p1 = points[i - 1]\n\t\tconst p2 = points[i]\n\t\tconst d = Vec2d.DistanceToLineSegment(p1, p2, A)\n\t\tif (d < distance) return true\n\t}\n\treturn false\n}\n\n/**\n * Get whether a point is within a certain distance from a line segment.\n *\n * @param A - The point to check.\n * @param p1 - The polyline's first point.\n * @param p2 - The polyline's second point.\n * @param distance - The mininum distance that qualifies a hit.\n * @public\n */\nexport function pointNearToLineSegment(A: VecLike, p1: VecLike, p2: VecLike, distance = 8) {\n\tconst d = Vec2d.DistanceToLineSegment(p1, p2, A)\n\tif (d < distance) return true\n\treturn false\n}\n\n/**\n * Simplify a line (using Ramer-Douglas-Peucker algorithm).\n *\n * @param points - An array of points as [x, y, ...][]\n * @param tolerance - The minimum line distance (also called epsilon).\n * @returns Simplified array as [x, y, ...][]\n * @public\n */\nexport function simplify(points: VecLike[], tolerance = 1): VecLike[] {\n\tconst len = points.length\n\tconst a = points[0]\n\tconst b = points[len - 1]\n\tconst { x: x1, y: y1 } = a\n\tconst { x: x2, y: y2 } = b\n\tif (len > 2) {\n\t\tlet distance = 0\n\t\tlet index = 0\n\t\tconst max = new Vec2d(y2 - y1, x2 - x1).len2()\n\t\tfor (let i = 1; i < len - 1; i++) {\n\t\t\tconst { x: x0, y: y0 } = points[i]\n\t\t\tconst d = Math.pow(x0 * (y2 - y1) + x1 * (y0 - y2) + x2 * (y1 - y0), 2) / max\n\t\t\tif (distance > d) continue\n\t\t\tdistance = d\n\t\t\tindex = i\n\t\t}\n\t\tif (distance > tolerance) {\n\t\t\tconst l0 = simplify(points.slice(0, index + 1), tolerance)\n\t\t\tconst l1 = simplify(points.slice(index + 1), tolerance)\n\t\t\treturn l0.concat(l1.slice(1))\n\t\t}\n\t}\n\treturn [a, b]\n}\n\nfunction _getSqSegDist(p: VecLike, p1: VecLike, p2: VecLike) {\n\tlet x = p1.x\n\tlet y = p1.y\n\tlet dx = p2.x - x\n\tlet dy = p2.y - y\n\tif (dx !== 0 || dy !== 0) {\n\t\tconst t = ((p.x - x) * dx + (p.y - y) * dy) / (dx * dx + dy * dy)\n\t\tif (t > 1) {\n\t\t\tx = p2.x\n\t\t\ty = p2.y\n\t\t} else if (t > 0) {\n\t\t\tx += dx * t\n\t\t\ty += dy * t\n\t\t}\n\t}\n\tdx = p.x - x\n\tdy = p.y - y\n\treturn dx * dx + dy * dy\n}\n\nfunction _simplifyStep(\n\tpoints: VecLike[],\n\tfirst: number,\n\tlast: number,\n\tsqTolerance: number,\n\tresult: VecLike[]\n) {\n\tlet maxSqDist = sqTolerance\n\tlet index = -1\n\tfor (let i = first + 1; i < last; i++) {\n\t\tconst sqDist = _getSqSegDist(points[i], points[first], points[last])\n\t\tif (sqDist > maxSqDist) {\n\t\t\tindex = i\n\t\t\tmaxSqDist = sqDist\n\t\t}\n\t}\n\tif (index > -1 && maxSqDist > sqTolerance) {\n\t\tif (index - first > 1) _simplifyStep(points, first, index, sqTolerance, result)\n\t\tresult.push(points[index])\n\t\tif (last - index > 1) _simplifyStep(points, index, last, sqTolerance, result)\n\t}\n}\n\n/** @public */\nexport function simplify2(points: VecLike[], tolerance = 1) {\n\tif (points.length <= 2) return points\n\tconst sqTolerance = tolerance * tolerance\n\t// Radial distance\n\tlet A = points[0]\n\tlet B = points[1]\n\tconst newPoints = [A]\n\tfor (let i = 1, len = points.length; i < len; i++) {\n\t\tB = points[i]\n\t\tif ((B.x - A.x) * (B.x - A.x) + (B.y - A.y) * (B.y - A.y) > sqTolerance) {\n\t\t\tnewPoints.push(B)\n\t\t\tA = B\n\t\t}\n\t}\n\tif (A !== B) newPoints.push(B)\n\t// Ramer-Douglas-Peucker\n\tconst last = newPoints.length - 1\n\tconst result = [newPoints[0]]\n\t_simplifyStep(newPoints, 0, last, sqTolerance, result)\n\tresult.push(newPoints[last], points[points.length - 1])\n\treturn result\n}\n\n/** @public */\nexport function getMinX(pts: VecLike[]) {\n\tlet top = pts[0]\n\tfor (let i = 1; i < pts.length; i++) {\n\t\tif (pts[i].x < top.x) {\n\t\t\ttop = pts[i]\n\t\t}\n\t}\n\treturn top.x\n}\n\n/** @public */\nexport function getMinY(pts: VecLike[]) {\n\tlet top = pts[0]\n\tfor (let i = 1; i < pts.length; i++) {\n\t\tif (pts[i].y < top.y) {\n\t\t\ttop = pts[i]\n\t\t}\n\t}\n\treturn top.y\n}\n\n/** @public */\nexport function getMaxX(pts: VecLike[]) {\n\tlet top = pts[0]\n\tfor (let i = 1; i < pts.length; i++) {\n\t\tif (pts[i].x > top.x) {\n\t\t\ttop = pts[i]\n\t\t}\n\t}\n\treturn top.x\n}\n\n/** @public */\nexport function getMaxY(pts: VecLike[]) {\n\tlet top = pts[0]\n\tfor (let i = 1; i < pts.length; i++) {\n\t\tif (pts[i].y > top.y) {\n\t\t\ttop = pts[i]\n\t\t}\n\t}\n\treturn top.y\n}\n\n/** @public */\nexport function getMidX(pts: VecLike[]) {\n\tconst a = getMinX(pts)\n\tconst b = getMaxX(pts)\n\n\treturn a + (b - a) / 2\n}\n\n/** @public */\nexport function getMidY(pts: VecLike[]) {\n\tconst a = getMinY(pts)\n\tconst b = getMaxY(pts)\n\n\treturn a + (b - a) / 2\n}\n\n/** @public */\nexport function getWidth(pts: VecLike[]) {\n\tconst a = getMinX(pts)\n\tconst b = getMaxX(pts)\n\treturn b - a\n}\n\n/** @public */\nexport function getHeight(pts: VecLike[]) {\n\tconst a = getMinY(pts)\n\tconst b = getMaxY(pts)\n\treturn b - a\n}\n\n/**\n * The DOM likes values to be fixed to 3 decimal places\n * @public\n */\nexport function toDomPrecision(v: number) {\n\treturn +v.toFixed(4)\n}\n","import { Box2dModel } from '@tldraw/tlschema'\nimport { Vec2d, VecLike } from '../Vec2d'\nimport { PI, PI2, toPrecision } from '../utils'\n\n/** @public */\nexport type SelectionEdge = 'top' | 'right' | 'bottom' | 'left'\n\n/** @public */\nexport type SelectionCorner = 'top_left' | 'top_right' | 'bottom_right' | 'bottom_left'\n\n/** @public */\nexport type SelectionHandle = SelectionEdge | SelectionCorner\n\n/** @public */\nexport type RotateCorner =\n\t| 'top_left_rotate'\n\t| 'top_right_rotate'\n\t| 'bottom_right_rotate'\n\t| 'bottom_left_rotate'\n\t| 'mobile_rotate'\n\n/** @public */\nexport class Box2d {\n\tconstructor(x = 0, y = 0, w = 0, h = 0) {\n\t\tthis.x = x\n\t\tthis.y = y\n\t\tthis.w = w\n\t\tthis.h = h\n\t}\n\n\tx = 0\n\ty = 0\n\tw = 0\n\th = 0\n\n\tget point() {\n\t\treturn new Vec2d(this.x, this.y)\n\t}\n\n\tset point(val: Vec2d) {\n\t\tthis.x = val.x\n\t\tthis.y = val.y\n\t}\n\n\tget minX() {\n\t\treturn this.x\n\t}\n\n\tset minX(n: number) {\n\t\tthis.x = n\n\t}\n\n\tget midX() {\n\t\treturn this.x + this.w / 2\n\t}\n\n\tget maxX() {\n\t\treturn this.x + this.w\n\t}\n\n\tget minY() {\n\t\treturn this.y\n\t}\n\n\tset minY(n: number) {\n\t\tthis.y = n\n\t}\n\n\tget midY() {\n\t\treturn this.y + this.h / 2\n\t}\n\n\tget maxY() {\n\t\treturn this.y + this.h\n\t}\n\n\tget width() {\n\t\treturn this.w\n\t}\n\n\tset width(n: number) {\n\t\tthis.w = n\n\t}\n\n\tget height() {\n\t\treturn this.h\n\t}\n\n\tset height(n: number) {\n\t\tthis.h = n\n\t}\n\n\tget aspectRatio() {\n\t\treturn this.width / this.height\n\t}\n\n\tget center() {\n\t\treturn new Vec2d(this.midX, this.midY)\n\t}\n\n\tset center(v: Vec2d) {\n\t\tthis.minX = v.x - this.width / 2\n\t\tthis.minY = v.y - this.height / 2\n\t}\n\n\tget corners() {\n\t\treturn [\n\t\t\tnew Vec2d(this.minX, this.minY),\n\t\t\tnew Vec2d(this.maxX, this.minY),\n\t\t\tnew Vec2d(this.maxX, this.maxY),\n\t\t\tnew Vec2d(this.minX, this.maxY),\n\t\t]\n\t}\n\n\tget snapPoints() {\n\t\treturn [\n\t\t\tnew Vec2d(this.minX, this.minY),\n\t\t\tnew Vec2d(this.maxX, this.minY),\n\t\t\tnew Vec2d(this.maxX, this.maxY),\n\t\t\tnew Vec2d(this.minX, this.maxY),\n\t\t\tthis.center,\n\t\t]\n\t}\n\n\tget sides(): Array<[Vec2d, Vec2d]> {\n\t\tconst { corners } = this\n\t\treturn [\n\t\t\t[corners[0], corners[1]],\n\t\t\t[corners[1], corners[2]],\n\t\t\t[corners[2], corners[3]],\n\t\t\t[corners[3], corners[0]],\n\t\t]\n\t}\n\n\tget size(): Vec2d {\n\t\treturn new Vec2d(this.w, this.h)\n\t}\n\n\ttoFixed() {\n\t\tthis.x = toPrecision(this.x)\n\t\tthis.y = toPrecision(this.y)\n\t\tthis.w = toPrecision(this.w)\n\t\tthis.h = toPrecision(this.h)\n\t\treturn this\n\t}\n\n\tsetTo(B: Box2d) {\n\t\tthis.x = B.x\n\t\tthis.y = B.y\n\t\tthis.w = B.w\n\t\tthis.h = B.h\n\t\treturn this\n\t}\n\n\tset(x = 0, y = 0, w = 0, h = 0) {\n\t\tthis.x = x\n\t\tthis.y = y\n\t\tthis.w = w\n\t\tthis.h = h\n\t\treturn this\n\t}\n\n\texpand(A: Box2d) {\n\t\tconst minX = Math.min(this.minX, A.minX)\n\t\tconst minY = Math.min(this.minY, A.minY)\n\t\tconst maxX = Math.max(this.maxX, A.maxX)\n\t\tconst maxY = Math.max(this.maxY, A.maxY)\n\n\t\tthis.x = minX\n\t\tthis.y = minY\n\t\tthis.w = maxX - minX\n\t\tthis.h = maxY - minY\n\t\treturn this\n\t}\n\n\texpandBy(n: number) {\n\t\tthis.x -= n\n\t\tthis.y -= n\n\t\tthis.w += n * 2\n\t\tthis.h += n * 2\n\t\treturn this\n\t}\n\n\tscale(n: number) {\n\t\tthis.x /= n\n\t\tthis.y /= n\n\t\tthis.w /= n\n\t\tthis.h /= n\n\t\treturn this\n\t}\n\n\tclone() {\n\t\tconst { x, y, w, h } = this\n\t\treturn new Box2d(x, y, w, h)\n\t}\n\n\ttranslate(delta: VecLike) {\n\t\tthis.x += delta.x\n\t\tthis.y += delta.y\n\t\treturn this\n\t}\n\n\tsnapToGrid(size: number) {\n\t\tconst minX = Math.round(this.minX / size) * size\n\t\tconst minY = Math.round(this.minY / size) * size\n\t\tconst maxX = Math.round(this.maxX / size) * size\n\t\tconst maxY = Math.round(this.maxY / size) * size\n\t\tthis.minX = minX\n\t\tthis.minY = minY\n\t\tthis.width = Math.max(1, maxX - minX)\n\t\tthis.height = Math.max(1, maxY - minY)\n\t}\n\n\tcollides(B: Box2d) {\n\t\treturn Box2d.Collides(this, B)\n\t}\n\n\tcontains(B: Box2d) {\n\t\treturn Box2d.Contains(this, B)\n\t}\n\n\tincludes(B: Box2d) {\n\t\treturn Box2d.Includes(this, B)\n\t}\n\n\tcontainsPoint(V: VecLike | number, y?: number) {\n\t\treturn Box2d.ContainsPoint(this, V, y)\n\t}\n\n\tgetHandlePoint(handle: SelectionCorner | SelectionEdge) {\n\t\tswitch (handle) {\n\t\t\tcase 'top_left':\n\t\t\t\treturn new Vec2d(this.minX, this.minY)\n\t\t\tcase 'top_right':\n\t\t\t\treturn new Vec2d(this.maxX, this.minY)\n\t\t\tcase 'bottom_left':\n\t\t\t\treturn new Vec2d(this.minX, this.maxY)\n\t\t\tcase 'bottom_right':\n\t\t\t\treturn new Vec2d(this.maxX, this.maxY)\n\t\t\tcase 'top':\n\t\t\t\treturn new Vec2d(this.midX, this.minY)\n\t\t\tcase 'right':\n\t\t\t\treturn new Vec2d(this.maxX, this.midY)\n\t\t\tcase 'bottom':\n\t\t\t\treturn new Vec2d(this.midX, this.maxY)\n\t\t\tcase 'left':\n\t\t\t\treturn new Vec2d(this.minX, this.midY)\n\t\t}\n\t}\n\n\ttoJson(): Box2dModel {\n\t\treturn { x: this.minX, y: this.minY, w: this.w, h: this.h }\n\t}\n\n\tresize(handle: SelectionCorner | SelectionEdge | string, dx: number, dy: number) {\n\t\tconst { minX: a0x, minY: a0y, maxX: a1x, maxY: a1y } = this\n\t\tlet { minX: b0x, minY: b0y, maxX: b1x, maxY: b1y } = this\n\n\t\t// Use the delta to adjust the new box by changing its corners.\n\t\t// The dragging handle (corner or edge) will determine which\n\t\t// corners should change.\n\t\tswitch (handle) {\n\t\t\tcase 'left':\n\t\t\tcase 'top_left':\n\t\t\tcase 'bottom_left': {\n\t\t\t\tb0x += dx\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tcase 'right':\n\t\t\tcase 'top_right':\n\t\t\tcase 'bottom_right': {\n\t\t\t\tb1x += dx\n\t\t\t\tbreak\n\t\t\t}\n\t\t}\n\t\tswitch (handle) {\n\t\t\tcase 'top':\n\t\t\tcase 'top_left':\n\t\t\tcase 'top_right': {\n\t\t\t\tb0y += dy\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tcase 'bottom':\n\t\t\tcase 'bottom_left':\n\t\t\tcase 'bottom_right': {\n\t\t\t\tb1y += dy\n\t\t\t\tbreak\n\t\t\t}\n\t\t}\n\n\t\tconst scaleX = (b1x - b0x) / (a1x - a0x)\n\t\tconst scaleY = (b1y - b0y) / (a1y - a0y)\n\n\t\tconst flipX = scaleX < 0\n\t\tconst flipY = scaleY < 0\n\n\t\tif (flipX) {\n\t\t\tconst t = b1x\n\t\t\tb1x = b0x\n\t\t\tb0x = t\n\t\t}\n\n\t\tif (flipY) {\n\t\t\tconst t = b1y\n\t\t\tb1y = b0y\n\t\t\tb0y = t\n\t\t}\n\n\t\tthis.minX = b0x\n\t\tthis.minY = b0y\n\t\tthis.width = Math.abs(b1x - b0x)\n\t\tthis.height = Math.abs(b1y - b0y)\n\t}\n\n\tstatic From(box: Box2dModel) {\n\t\treturn new Box2d(box.x, box.y, box.w, box.h)\n\t}\n\n\tstatic FromPoints(points: VecLike[]) {\n\t\tif (points.length === 0) return new Box2d()\n\t\tlet minX = Infinity\n\t\tlet minY = Infinity\n\t\tlet maxX = -Infinity\n\t\tlet maxY = -Infinity\n\t\tlet point: VecLike\n\t\tfor (let i = 0, n = points.length; i < n; i++) {\n\t\t\tpoint = points[i]\n\t\t\tminX = Math.min(point.x, minX)\n\t\t\tminY = Math.min(point.y, minY)\n\t\t\tmaxX = Math.max(point.x, maxX)\n\t\t\tmaxY = Math.max(point.y, maxY)\n\t\t}\n\n\t\treturn new Box2d(minX, minY, maxX - minX, maxY - minY)\n\t}\n\n\tstatic Expand(A: Box2d, B: Box2d) {\n\t\tconst minX = Math.min(B.minX, A.minX)\n\t\tconst minY = Math.min(B.minY, A.minY)\n\t\tconst maxX = Math.max(B.maxX, A.maxX)\n\t\tconst maxY = Math.max(B.maxY, A.maxY)\n\n\t\treturn new Box2d(minX, minY, maxX - minX, maxY - minY)\n\t}\n\n\tstatic ExpandBy(A: Box2d, n: number) {\n\t\treturn new Box2d(A.minX - n, A.minY - n, A.width + n * 2, A.height + n * 2)\n\t}\n\n\tstatic Collides = (A: Box2d, B: Box2d) => {\n\t\treturn !(A.maxX < B.minX || A.minX > B.maxX || A.maxY < B.minY || A.minY > B.maxY)\n\t}\n\n\tstatic Contains = (A: Box2d, B: Box2d) => {\n\t\treturn A.minX < B.minX && A.minY < B.minY && A.maxY > B.maxY && A.maxX > B.maxX\n\t}\n\n\tstatic Includes = (A: Box2d, B: Box2d) => {\n\t\treturn Box2d.Collides(A, B) || Box2d.Contains(A, B)\n\t}\n\n\tstatic ContainsPoint = (A: Box2d, B: VecLike | number, y?: number) => {\n\t\tif (typeof B === 'number') {\n\t\t\treturn !(B < A.minX || y! < A.minY || B > A.maxX || y! > A.maxY)\n\t\t}\n\t\treturn !(B.x < A.minX || B.y < A.minY || B.x > A.maxX || B.y > A.maxY)\n\t}\n\n\tstatic Common = (boxes: Box2d[]): Box2d => {\n\t\tlet minX = Infinity\n\t\tlet minY = Infinity\n\t\tlet maxX = -Infinity\n\t\tlet maxY = -Infinity\n\n\t\tfor (let i = 0; i < boxes.length; i++) {\n\t\t\tconst B = boxes[i]\n\t\t\tminX = Math.min(minX, B.minX)\n\t\t\tminY = Math.min(minY, B.minY)\n\t\t\tmaxX = Math.max(maxX, B.maxX)\n\t\t\tmaxY = Math.max(maxY, B.maxY)\n\t\t}\n\n\t\treturn new Box2d(minX, minY, maxX - minX, maxY - minY)\n\t}\n\n\tstatic Sides = (A: Box2d, inset = 0) => {\n\t\tconst { corners } = A\n\t\tif (inset) {\n\t\t\t// TODO: Inset the corners by the inset amount.\n\t\t}\n\n\t\treturn [\n\t\t\t[corners[0], corners[1]],\n\t\t\t[corners[1], corners[2]],\n\t\t\t[corners[2], corners[3]],\n\t\t\t[corners[3], corners[0]],\n\t\t]\n\t}\n\n\tstatic Resize(\n\t\tbox: Box2d,\n\t\thandle: SelectionCorner | SelectionEdge | string,\n\t\tdx: number,\n\t\tdy: number,\n\t\tisAspectRatioLocked = false\n\t) {\n\t\tconst { minX: a0x, minY: a0y, maxX: a1x, maxY: a1y } = box\n\t\tlet { minX: b0x, minY: b0y, maxX: b1x, maxY: b1y } = box\n\n\t\t// Use the delta to adjust the new box by changing its corners.\n\t\t// The dragging handle (corner or edge) will determine which\n\t\t// corners should change.\n\t\tswitch (handle) {\n\t\t\tcase 'left':\n\t\t\tcase 'top_left':\n\t\t\tcase 'bottom_left': {\n\t\t\t\tb0x += dx\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tcase 'right':\n\t\t\tcase 'top_right':\n\t\t\tcase 'bottom_right': {\n\t\t\t\tb1x += dx\n\t\t\t\tbreak\n\t\t\t}\n\t\t}\n\t\tswitch (handle) {\n\t\t\tcase 'top':\n\t\t\tcase 'top_left':\n\t\t\tcase 'top_right': {\n\t\t\t\tb0y += dy\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tcase 'bottom':\n\t\t\tcase 'bottom_left':\n\t\t\tcase 'bottom_right': {\n\t\t\t\tb1y += dy\n\t\t\t\tbreak\n\t\t\t}\n\t\t}\n\n\t\tconst scaleX = (b1x - b0x) / (a1x - a0x)\n\t\tconst scaleY = (b1y - b0y) / (a1y - a0y)\n\n\t\tconst flipX = scaleX < 0\n\t\tconst flipY = scaleY < 0\n\n\t\t/*\n    2. Aspect ratio\n    If the aspect ratio is locked, adjust the corners so that the\n    new box's aspect ratio matches the original aspect ratio.\n    */\n\t\tif (isAspectRatioLocked) {\n\t\t\tconst aspectRatio = (a1x - a0x) / (a1y - a0y)\n\t\t\tconst bw = Math.abs(b1x - b0x)\n\t\t\tconst bh = Math.abs(b1y - b0y)\n\t\t\tconst tw = bw * (scaleY < 0 ? 1 : -1) * (1 / aspectRatio)\n\t\t\tconst th = bh * (scaleX < 0 ? 1 : -1) * aspectRatio\n\t\t\tconst isTall = aspectRatio < bw / bh\n\n\t\t\tswitch (handle) {\n\t\t\t\tcase 'top_left': {\n\t\t\t\t\tif (isTall) b0y = b1y + tw\n\t\t\t\t\telse b0x = b1x + th\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t\tcase 'top_right': {\n\t\t\t\t\tif (isTall) b0y = b1y + tw\n\t\t\t\t\telse b1x = b0x - th\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t\tcase 'bottom_right': {\n\t\t\t\t\tif (isTall) b1y = b0y - tw\n\t\t\t\t\telse b1x = b0x - th\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t\tcase 'bottom_left': {\n\t\t\t\t\tif (isTall) b1y = b0y - tw\n\t\t\t\t\telse b0x = b1x + th\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t\tcase 'bottom':\n\t\t\t\tcase 'top': {\n\t\t\t\t\tconst m = (b0x + b1x) / 2\n\t\t\t\t\tconst w = bh * aspectRatio\n\t\t\t\t\tb0x = m - w / 2\n\t\t\t\t\tb1x = m + w / 2\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t\tcase 'left':\n\t\t\t\tcase 'right': {\n\t\t\t\t\tconst m = (b0y + b1y) / 2\n\t\t\t\t\tconst h = bw / aspectRatio\n\t\t\t\t\tb0y = m - h / 2\n\t\t\t\t\tb1y = m + h / 2\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (flipX) {\n\t\t\tconst t = b1x\n\t\t\tb1x = b0x\n\t\t\tb0x = t\n\t\t}\n\n\t\tif (flipY) {\n\t\t\tconst t = b1y\n\t\t\tb1y = b0y\n\t\t\tb0y = t\n\t\t}\n\n\t\tconst final = new Box2d(b0x, b0y, Math.abs(b1x - b0x), Math.abs(b1y - b0y))\n\n\t\treturn {\n\t\t\tbox: final,\n\t\t\tscaleX: +((final.width / box.width) * (scaleX > 0 ? 1 : -1)).toFixed(5),\n\t\t\tscaleY: +((final.height / box.height) * (scaleY > 0 ? 1 : -1)).toFixed(5),\n\t\t}\n\t}\n\n\tequals(other: Box2d | Box2dModel) {\n\t\treturn Box2d.Equals(this, other)\n\t}\n\n\tstatic Equals(a: Box2d | Box2dModel, b: Box2d | Box2dModel) {\n\t\treturn b.x === a.x && b.y === a.y && b.w === a.w && b.h === a.h\n\t}\n}\n\n/** @public */\nexport function flipSelectionHandleY(handle: SelectionHandle) {\n\tswitch (handle) {\n\t\tcase 'top':\n\t\t\treturn 'bottom'\n\t\tcase 'bottom':\n\t\t\treturn 'top'\n\t\tcase 'top_left':\n\t\t\treturn 'bottom_left'\n\t\tcase 'top_right':\n\t\t\treturn 'bottom_right'\n\t\tcase 'bottom_left':\n\t\t\treturn 'top_left'\n\t\tcase 'bottom_right':\n\t\t\treturn 'top_right'\n\t\tdefault:\n\t\t\treturn handle\n\t}\n}\n\n/** @public */\nexport function flipSelectionHandleX(handle: SelectionHandle) {\n\tswitch (handle) {\n\t\tcase 'left':\n\t\t\treturn 'right'\n\t\tcase 'right':\n\t\t\treturn 'left'\n\t\tcase 'top_left':\n\t\t\treturn 'top_right'\n\t\tcase 'top_right':\n\t\t\treturn 'top_left'\n\t\tcase 'bottom_left':\n\t\t\treturn 'bottom_right'\n\t\tcase 'bottom_right':\n\t\t\treturn 'bottom_left'\n\t\tdefault:\n\t\t\treturn handle\n\t}\n}\n\nconst ORDERED_SELECTION_HANDLES = [\n\t'top',\n\t'top_right',\n\t'right',\n\t'bottom_right',\n\t'bottom',\n\t'bottom_left',\n\t'left',\n\t'top_left',\n] as const\n\n/** @public */\nexport function rotateSelectionHandle(handle: SelectionHandle, rotation: number): SelectionHandle {\n\t// first find out how many tau we need to rotate by\n\trotation = rotation % PI2\n\tconst numSteps = Math.round(rotation / (PI / 4))\n\n\tconst currentIndex = ORDERED_SELECTION_HANDLES.indexOf(handle)\n\treturn ORDERED_SELECTION_HANDLES[(currentIndex + numSteps) % ORDERED_SELECTION_HANDLES.length]\n}\n\n/** @public */\nexport function isSelectionCorner(selection: string): selection is SelectionCorner {\n\treturn (\n\t\tselection === 'top_left' ||\n\t\tselection === 'top_right' ||\n\t\tselection === 'bottom_right' ||\n\t\tselection === 'bottom_left'\n\t)\n}\n\n/** @public */\nexport const ROTATE_CORNER_TO_SELECTION_CORNER = {\n\ttop_left_rotate: 'top_left',\n\ttop_right_rotate: 'top_right',\n\tbottom_right_rotate: 'bottom_right',\n\tbottom_left_rotate: 'bottom_left',\n\tmobile_rotate: 'top_left',\n} as const\n","import { Box2d } from '../Box2d'\nimport { Vec2d, VecLike } from '../Vec2d'\n\n/**\n * A base segment used for cubic and quadradic curves.\n *\n * @public\n */\nexport abstract class BaseSegment2d<T extends { p: number }> {\n\tconstructor(values: T) {\n\t\tthis._values = values\n\t}\n\n\t/**\n\t * The segment's values. Do not modify these directly. Instead, use the `values` setter or `update` method.\n\t *\n\t * @internal\n\t */\n\tprotected _values: T\n\n\t/**\n\t * A private set of cached values, used for lookups and computations. Changing any of the\n\t * segment's values will clear this object.\n\t *\n\t * @internal\n\t */\n\tprotected _computed: {\n\t\tlength?: number\n\t\tbounds?: Box2d\n\t\tpath?: string\n\t\tlut?: Vec2d[]\n\t\tmidPoint?: Vec2d\n\t} = {}\n\n\t/**\n\t * The values for the curve segment.\n\t *\n\t * @public\n\t */\n\tget values() {\n\t\treturn this._values\n\t}\n\n\tset values(values: T) {\n\t\tthis._values = values\n\t\tthis._computed = {}\n\t}\n\n\t/**\n\t * The length of the curve segment.\n\t *\n\t * @public\n\t */\n\tget length(): number {\n\t\tif (this._computed.length !== undefined) {\n\t\t\treturn this._computed.length\n\t\t}\n\n\t\tconst { lut } = this\n\n\t\tlet prev = lut[0]\n\t\tlet result = 0\n\n\t\tfor (let i = 1; i < lut.length; i++) {\n\t\t\tconst curr = lut[i]\n\t\t\tresult += prev.dist(curr)\n\t\t\tprev = curr\n\t\t}\n\n\t\tthis._computed.length = result\n\n\t\treturn result\n\t}\n\n\t/**\n\t * The bounding box containing the curve segment.\n\t *\n\t * @public\n\t */\n\tget bounds(): Box2d {\n\t\tif (this._computed.bounds !== undefined) {\n\t\t\treturn this._computed.bounds\n\t\t}\n\n\t\tlet minX = Infinity\n\t\tlet minY = Infinity\n\t\tlet maxX = -Infinity\n\t\tlet maxY = -Infinity\n\n\t\tconst { lut } = this\n\n\t\tfor (const pt of lut) {\n\t\t\tminX = Math.min(pt.x, minX)\n\t\t\tminY = Math.min(pt.y, minY)\n\t\t\tmaxX = Math.max(pt.x, maxX)\n\t\t\tmaxY = Math.max(pt.y, maxY)\n\t\t}\n\n\t\tconst result = new Box2d(minX, minY, maxX - minX, maxY - minY)\n\n\t\tthis._computed.bounds = result\n\n\t\treturn result\n\t}\n\n\t/**\n\t * A lookup table consisting of values.p points along the segment. Used to compute lengths,\n\t * closest points, etc. This should only be _computed once (when first requested) per set of values.\n\t *\n\t * @public\n\t */\n\tget lut() {\n\t\tif (this._computed.lut) {\n\t\t\treturn this._computed.lut\n\t\t}\n\n\t\tconst { p } = this.values\n\n\t\tconst result: Vec2d[] = []\n\n\t\tfor (let i = 0; i < p + 1; i++) {\n\t\t\tresult.push(this.getPoint(i / p))\n\t\t}\n\n\t\tthis._computed.lut = result\n\n\t\treturn result\n\t}\n\n\t/**\n\t * A point half-way along the length of the segment.\n\t *\n\t * @public\n\t */\n\tget midPoint() {\n\t\tif (this._computed.midPoint) {\n\t\t\treturn this._computed.midPoint\n\t\t}\n\n\t\tconst result = this.getPoint(0.5)\n\n\t\tthis._computed.midPoint = result\n\n\t\treturn result\n\t}\n\n\t/**\n\t * An SVG path for the segment.\n\t *\n\t * @public\n\t */\n\tget path() {\n\t\tif (this._computed.path) {\n\t\t\treturn this._computed.path\n\t\t}\n\n\t\tconst result = this.getPath()\n\n\t\tthis._computed.path = result\n\n\t\treturn result\n\t}\n\n\t/**\n\t * Evaluate a point at a length along the curve segment.\n\t *\n\t * @param length - The length to find the point value.\n\t * @public\n\t */\n\tgetPointAtLength(length: number) {\n\t\tconst t = Math.max(0, Math.min(1, length / this.length))\n\n\t\treturn this.getPoint(t)\n\t}\n\n\t/**\n\t * Get the normal at distance t along the curve segment.\n\t *\n\t * @param t - The distance (0-1) to find the normal.\n\t * @public\n\t */\n\tgetNormal(t: number) {\n\t\treturn this.getPoint(t - 0.0025)\n\t\t\t.tan(this.getPoint(t + 0.0025))\n\t\t\t.per()\n\t\t\t.uni()\n\t\t\t.toFixed()\n\t}\n\n\t/**\n\t * Get the normal at a length along the curve segment.\n\t *\n\t * @param length - The length to find the normal.\n\t * @public\n\t */\n\tgetNormalAtLength(length: number) {\n\t\treturn this.getNormal(length / this.length)\n\t}\n\n\t/**\n\t * Get the closest point on the segment to an arbitrary point.\n\t *\n\t * @param point - The arbitrary point.\n\t * @public\n\t */\n\tgetClosestPointTo(point: VecLike) {\n\t\tconst { lut } = this\n\n\t\tlet closestT = 0\n\t\tlet closestPoint = lut[0]\n\t\tlet closestDistance = lut[0].dist(point)\n\n\t\t// Find the closest\n\t\tfor (let i = 1; i < lut.length; i++) {\n\t\t\tconst distance = Vec2d.Dist(lut[i], point)\n\t\t\tif (distance < closestDistance) {\n\t\t\t\tclosestDistance = distance\n\t\t\t\tclosestPoint = lut[i]\n\t\t\t\tclosestT = i / lut.length\n\t\t\t}\n\t\t}\n\n\t\t// Solve again for the closest point on the segment\n\t\tconst step = 1 / this.values.p\n\n\t\tfor (\n\t\t\tlet t = Math.max(0, closestT - step / 2);\n\t\t\tt < Math.min(1, closestT + step / 2);\n\t\t\tt += step / 10\n\t\t) {\n\t\t\tconst pt = this.getPoint(t)\n\t\t\tconst distance = Vec2d.Dist(pt, point)\n\t\t\tif (distance < closestDistance) {\n\t\t\t\tclosestDistance = distance\n\t\t\t\tclosestPoint = pt\n\t\t\t}\n\t\t}\n\n\t\treturn { point: closestPoint, distance: closestDistance }\n\t}\n\n\t/**\n\t * Set one or more values. Updating the segment will clear cached values.\n\t *\n\t * @param values - A partial of the segment's values object.\n\t * @public\n\t */\n\tupdate(values: Partial<T>) {\n\t\tthis._computed = {}\n\t\tthis.values = { ...this.values, ...values }\n\t}\n\n\t/**\n\t * Get the SVG path data for the segment.\n\t *\n\t * @public\n\t */\n\tabstract getPath(head?: boolean): string\n\n\t/**\n\t * Evaluate a point at distance t along the curve segment.\n\t *\n\t * @param t - The distance (0-1) to find the point.\n\t * @public\n\t */\n\tabstract getPoint(t: number): Vec2d\n\n\t/**\n\t * Evaluate a x value at distance t along the curve segment.\n\t *\n\t * @param t - The distance (0-1) to find the x value.\n\t * @public\n\t */\n\tabstract getX(t: number): number\n\n\t/**\n\t * Evaluate a y value at distance t along the curve segment.\n\t *\n\t * @param t - The distance (0-1) to find the y value.\n\t * @public\n\t */\n\tabstract getY(t: number): number\n}\n","import { BaseSegment2d } from '../BaseSegment2d'\nimport { Vec2d, VecLike } from '../Vec2d'\n\n/** @public */\nexport interface CubicSegment2dModel {\n\ta: VecLike\n\tb: VecLike\n\tc: VecLike\n\td: VecLike\n\tp: number\n}\n\n/** @public */\nexport class CubicSegment2d extends BaseSegment2d<CubicSegment2dModel> {\n\tconstructor(a: VecLike, b: VecLike, c: VecLike, d: VecLike, p = 25) {\n\t\tsuper({ a, b, c, d, p })\n\t}\n\n\t[Symbol.iterator] = function* (this: InstanceType<typeof CubicSegment2d>) {\n\t\tconst { a, b, c, d } = this.values\n\t\tyield* [a, b, c, d]\n\t}\n\n\tgetPath(head = true) {\n\t\tconst { a, b, c, d } = this.values\n\n\t\tif (Vec2d.Equals(a, d)) return ''\n\n\t\treturn `${head ? `M${a.x.toFixed(2)},${a.y.toFixed(2)}C` : ``}${b.x.toFixed(2)},${b.y.toFixed(\n\t\t\t2\n\t\t)} ${c.x.toFixed(2)},${c.y.toFixed(2)} ${d.x.toFixed(2)},${d.y.toFixed(2)}`\n\t}\n\n\tgetPoint(t: number) {\n\t\tconst { a, b, c, d } = this.values\n\n\t\treturn new Vec2d(\n\t\t\t(1 - t) * (1 - t) * (1 - t) * a.x +\n\t\t\t\t3 * ((1 - t) * (1 - t)) * t * b.x +\n\t\t\t\t3 * (1 - t) * (t * t) * c.x +\n\t\t\t\tt * t * t * d.x,\n\t\t\t(1 - t) * (1 - t) * (1 - t) * a.y +\n\t\t\t\t3 * ((1 - t) * (1 - t)) * t * b.y +\n\t\t\t\t3 * (1 - t) * (t * t) * c.y +\n\t\t\t\tt * t * t * d.y\n\t\t)\n\t}\n\n\tgetX(t: number) {\n\t\tconst { a, b, c, d } = this.values\n\n\t\treturn (\n\t\t\t(1 - t) * (1 - t) * (1 - t) * a.x +\n\t\t\t3 * ((1 - t) * (1 - t)) * t * b.x +\n\t\t\t3 * (1 - t) * (t * t) * c.x +\n\t\t\tt * t * t * d.x\n\t\t)\n\t}\n\n\tgetY(t: number) {\n\t\tconst { a, b, c, d } = this.values\n\n\t\treturn (\n\t\t\t(1 - t) * (1 - t) * (1 - t) * a.y +\n\t\t\t3 * ((1 - t) * (1 - t)) * t * b.y +\n\t\t\t3 * (1 - t) * (t * t) * c.y +\n\t\t\tt * t * t * d.y\n\t\t)\n\t}\n}\n","import { BaseSegment2d } from '../BaseSegment2d'\nimport { Box2d } from '../Box2d'\nimport { Vec2d, VecLike } from '../Vec2d'\n\nexport abstract class BaseSpline2d<T extends { p: number }> {\n\tconstructor(public points: VecLike[], public p = 50, public k = 1) {}\n\n\tabstract segments: BaseSegment2d<T>[]\n\n\tabstract getSegmentsFromPoints(points: VecLike[], p: number, k: number): BaseSegment2d<T>[]\n\n\tprotected computed: {\n\t\tlength?: number\n\t\tbounds?: Box2d\n\t\tpath?: string\n\t\tlut?: Vec2d[]\n\t} = {}\n\n\tget length() {\n\t\tif (this.computed.length !== undefined) {\n\t\t\treturn this.computed.length\n\t\t}\n\n\t\tconst { segments } = this\n\n\t\tconst result = segments.reduce((acc, curr) => acc + curr.length, 0)\n\n\t\tthis.computed.length = result\n\n\t\treturn result\n\t}\n\n\tget bounds() {\n\t\tif (this.computed.bounds !== undefined) {\n\t\t\treturn this.computed.bounds\n\t\t}\n\n\t\tconst { segments } = this\n\n\t\tconst result = Box2d.Common(segments.map((segment) => segment.bounds))\n\n\t\tthis.computed.bounds = result\n\n\t\treturn result\n\t}\n\n\tget head() {\n\t\tconst { points } = this\n\t\treturn points[0]\n\t}\n\n\tget tail() {\n\t\tconst { points } = this\n\t\treturn points[points.length - 1]\n\t}\n\n\tget path() {\n\t\tif (this.computed.path !== undefined) {\n\t\t\treturn this.computed.path\n\t\t}\n\n\t\tconst result = this.segments\n\t\t\t.map((segment) => segment.path)\n\t\t\t.filter((i) => i !== undefined && i !== null && i !== '')\n\t\t\t.join(' ')\n\n\t\tthis.computed.path = result\n\n\t\treturn result\n\t}\n\n\taddPoint(point: Vec2d) {\n\t\tconst { points, k, p } = this\n\t\tpoints.push(point)\n\t\tthis.computed = {}\n\t\tthis.getSegmentsFromPoints(this.points, p, k)\n\t\treturn this\n\t}\n\n\tremovePoint(point: Vec2d | number) {\n\t\tconst { points, k, p } = this\n\t\tconst index = typeof point === 'number' ? Math.floor(point) : points.indexOf(point)\n\t\tif (index === -1) return this\n\t\tpoints.splice(index, 1)\n\t\tthis.computed = {}\n\t\tthis.getSegmentsFromPoints(this.points, p, k)\n\t\treturn this\n\t}\n\n\tgetPointAtLength(length: number) {\n\t\tconst { segments } = this\n\n\t\tlet remaining = length\n\n\t\tif (length <= 0) return segments[0].getPoint(0)\n\t\tif (length >= this.length) return segments[segments.length - 1].getPoint(1)\n\n\t\tfor (let i = 0; i < segments.length; i++) {\n\t\t\tconst segment = segments[i]\n\t\t\tconst { length: segmentLength } = segment\n\n\t\t\tif (remaining < segmentLength) {\n\t\t\t\treturn segment.getPoint(remaining / segmentLength)\n\t\t\t}\n\n\t\t\tremaining -= segment.length\n\t\t}\n\n\t\treturn segments[segments.length - 1].getPoint(1)\n\t}\n\n\tgetPoint(t: number) {\n\t\tif (t <= 0) return this.segments[0].getPoint(0)\n\t\tif (t >= 1) return this.segments[this.segments.length - 1].getPoint(1)\n\t\treturn this.getPointAtLength(t * this.length)\n\t}\n\n\tgetNormal(t: number): Vec2d {\n\t\tconst { length } = this\n\t\treturn this.getNormalAtLength(t * length)\n\t}\n\n\tgetNormalAtLength(t: number): Vec2d {\n\t\tconst { segments } = this\n\n\t\tif (t < 0) return new Vec2d(0, 0)\n\n\t\tlet remaining = t\n\n\t\tfor (const segment of segments) {\n\t\t\tconst segmentLength = segment.length\n\t\t\tif (remaining <= segmentLength) {\n\t\t\t\treturn segment.getNormal(remaining / segmentLength)\n\t\t\t}\n\t\t\tremaining -= segmentLength\n\t\t}\n\n\t\treturn new Vec2d(0, 0)\n\t}\n\n\tgetClosestPointTo(point: Vec2d) {\n\t\tconst { head, segments } = this\n\t\tlet closestPoint = head\n\t\tlet closestDistance = Vec2d.Dist(point, head)\n\n\t\tfor (const segment of segments) {\n\t\t\tconst p = segment.getClosestPointTo(point)\n\t\t\tif (p.distance < closestDistance) {\n\t\t\t\tclosestDistance = p.distance\n\t\t\t\tclosestPoint = p.point\n\t\t\t}\n\t\t}\n\n\t\treturn { point: closestPoint, distance: closestDistance }\n\t}\n}\n","import { BaseSpline2d } from '../BaseSpline2d'\nimport { CubicSegment2d, CubicSegment2dModel } from '../CubicSegment2d'\nimport { Vec2d, VecLike } from '../Vec2d'\n\n/** @public */\nexport class CubicSpline2d extends BaseSpline2d<CubicSegment2dModel> {\n\tconstructor(points: VecLike[], k = 1.2, p = 20) {\n\t\tsuper(points, k, p)\n\t\tthis.segments = this.getSegmentsFromPoints(points, k, p)\n\t}\n\n\tsegments: CubicSegment2d[]\n\n\tgetSegmentsFromPoints(points: VecLike[], k = 1.25, p = 20) {\n\t\tconst len = points.length\n\t\tconst last = len - 2\n\t\tconst results: CubicSegment2d[] = []\n\n\t\tfor (let i = 0; i < len - 1; i++) {\n\t\t\tconst p0 = i === 0 ? points[0] : points[i - 1]\n\t\t\tconst p1 = points[i]\n\t\t\tconst p2 = points[i + 1]\n\t\t\tconst p3 = i === last ? p2 : points[i + 2]\n\n\t\t\tresults.push(\n\t\t\t\tnew CubicSegment2d(\n\t\t\t\t\tp1,\n\t\t\t\t\ti === 0 ? p0 : new Vec2d(p1.x + ((p2.x - p0.x) / 6) * k, p1.y + ((p2.y - p0.y) / 6) * k),\n\t\t\t\t\ti === last\n\t\t\t\t\t\t? p2\n\t\t\t\t\t\t: new Vec2d(p2.x - ((p3.x - p1.x) / 6) * k, p2.y - ((p3.y - p1.y) / 6) * k),\n\t\t\t\t\tp2,\n\t\t\t\t\tp\n\t\t\t\t)\n\t\t\t)\n\t\t}\n\n\t\treturn results\n\t}\n\n\tstatic FromPoints(points: Vec2d[]) {\n\t\treturn new CubicSpline2d(points)\n\t}\n}\n","import { BaseSegment2d } from '../BaseSegment2d'\nimport { Box2d } from '../Box2d'\nimport { Vec2d, VecLike } from '../Vec2d'\n\n/** @public */\nexport interface LineSegment2dModel {\n\ta: VecLike\n\tb: VecLike\n\tp: number\n}\n\n/** @public */\nexport class LineSegment2d extends BaseSegment2d<LineSegment2dModel> {\n\tconstructor(public a: VecLike, public b: VecLike, p = 2) {\n\t\tsuper({ a, b, p })\n\t\tthis.values.p = Math.max(10, Math.ceil(this.length / 20))\n\t}\n\n\toverride get length() {\n\t\treturn Vec2d.Dist(this.a, this.b)\n\t}\n\n\tget tangent() {\n\t\treturn Vec2d.Tan(this.a, this.b)\n\t}\n\n\tget angle() {\n\t\treturn Vec2d.Angle(this.a, this.b)\n\t}\n\n\toverride get bounds() {\n\t\treturn Box2d.FromPoints([this.a, this.b])\n\t}\n\n\tgetX(t: number) {\n\t\tconst { a, b } = this.values\n\n\t\treturn a.x + (b.x - a.x) * t\n\t}\n\n\tgetY(t: number) {\n\t\tconst { a, b } = this.values\n\n\t\treturn a.y + (b.y - a.y) * t\n\t}\n\n\tgetPoint(t: number) {\n\t\tconst { a, b } = this.values\n\n\t\treturn Vec2d.Lrp(a, b, t)\n\t}\n\n\tgetPath(head = true) {\n\t\tconst { a, b } = this.values\n\n\t\tif (Vec2d.Equals(a, b)) return ''\n\n\t\treturn head ? `M${a.x},${a.y}L${b.x},${b.y}` : `${b.x},${b.y}`\n\t}\n\n\toverride getNormal() {\n\t\tconst { a, b } = this.values\n\n\t\treturn Vec2d.Sub(a, b).per().uni().toFixed()\n\t}\n\n\t/**\n\t * Get the closest point on the segment to an arbitrary point.\n\t *\n\t * @param point - The arbitrary point.\n\t * @public\n\t */\n\toverride getClosestPointTo(point: VecLike) {\n\t\tconst { a, b } = this.values\n\n\t\tconst closestPoint = Vec2d.NearestPointOnLineSegment(a, b, point)\n\n\t\tconst closestDistance = closestPoint.dist(point)\n\n\t\treturn { point: closestPoint, distance: closestDistance }\n\t}\n\n\tstatic Length(A: LineSegment2d) {\n\t\treturn Vec2d.Dist(A.a, A.b)\n\t}\n\n\tstatic Tangent(A: LineSegment2d) {\n\t\treturn Vec2d.Tan(A.a, A.b)\n\t}\n\n\tstatic Angle(A: LineSegment2d) {\n\t\treturn Vec2d.Angle(A.a, A.b)\n\t}\n}\n","import { Box2d } from '../Box2d'\nimport { clampRadians, TAU, toDomPrecision } from '../utils'\nimport { Vec2d, VecLike } from '../Vec2d'\n\n/** @public */\nexport type MatLike = Matrix2dModel | Matrix2d\n\n/** @public */\nexport interface MatrixInfo {\n\tx: number\n\ty: number\n\tscaleX: number\n\tscaleY: number\n\trotation: number\n}\n\n/** @public */\nexport interface Matrix2dModel {\n\ta: number\n\tb: number\n\tc: number\n\td: number\n\te: number\n\tf: number\n}\n\n// function getIdentity() {\n//   return new Matrix2d(1.0, 0.0, 0.0, 1.0, 0.0, 0.0)\n// }\n\n/** @public */\nexport class Matrix2d {\n\tconstructor(a: number, b: number, c: number, d: number, e: number, f: number) {\n\t\tthis.a = a\n\t\tthis.b = b\n\t\tthis.c = c\n\t\tthis.d = d\n\t\tthis.e = e\n\t\tthis.f = f\n\t}\n\n\ta = 1.0\n\tb = 0.0\n\tc = 0.0\n\td = 1.0\n\te = 0.0\n\tf = 0.0\n\n\tequals(m: Matrix2d | Matrix2dModel) {\n\t\treturn (\n\t\t\tthis.a === m.a &&\n\t\t\tthis.b === m.b &&\n\t\t\tthis.c === m.c &&\n\t\t\tthis.d === m.d &&\n\t\t\tthis.e === m.e &&\n\t\t\tthis.f === m.f\n\t\t)\n\t}\n\n\tidentity() {\n\t\tthis.a = 1.0\n\t\tthis.b = 0.0\n\t\tthis.c = 0.0\n\t\tthis.d = 1.0\n\t\tthis.e = 0.0\n\t\tthis.f = 0.0\n\t\treturn this\n\t}\n\n\tmultiply(m: Matrix2d | Matrix2dModel) {\n\t\tconst m2: Matrix2dModel = m\n\t\tconst { a, b, c, d, e, f } = this\n\t\tthis.a = a * m2.a + c * m2.b\n\t\tthis.c = a * m2.c + c * m2.d\n\t\tthis.e = a * m2.e + c * m2.f + e\n\t\tthis.b = b * m2.a + d * m2.b\n\t\tthis.d = b * m2.c + d * m2.d\n\t\tthis.f = b * m2.e + d * m2.f + f\n\t\treturn this\n\t}\n\n\trotate(r: number, cx?: number, cy?: number) {\n\t\tif (r === 0) return this\n\t\tif (cx === undefined) return this.multiply(Matrix2d.Rotate(r))\n\t\treturn this.translate(cx, cy!).multiply(Matrix2d.Rotate(r)).translate(-cx, -cy!)\n\t}\n\n\ttranslate(x: number, y: number): Matrix2d {\n\t\treturn this.multiply(Matrix2d.Translate(x, y!))\n\t}\n\n\tscale(x: number, y: number) {\n\t\treturn this.multiply(Matrix2d.Scale(x, y))\n\t}\n\n\tinvert() {\n\t\tconst { a, b, c, d, e, f } = this\n\t\tconst denom = a * d - b * c\n\t\tthis.a = d / denom\n\t\tthis.b = b / -denom\n\t\tthis.c = c / -denom\n\t\tthis.d = a / denom\n\t\tthis.e = (d * e - c * f) / -denom\n\t\tthis.f = (b * e - a * f) / denom\n\t\treturn this\n\t}\n\n\tapplyToPoint(point: VecLike) {\n\t\treturn Matrix2d.applyToPoint(this, point)\n\t}\n\n\tapplyToPoints(points: VecLike[]) {\n\t\treturn Matrix2d.applyToPoints(this, points)\n\t}\n\n\tdecomposed() {\n\t\treturn Matrix2d.Decompose(this)\n\t}\n\n\ttoCssString() {\n\t\treturn Matrix2d.toCssString(this)\n\t}\n\n\tsetTo(model: Matrix2dModel) {\n\t\tObject.assign(this, model)\n\t\treturn this\n\t}\n\n\tdecompose() {\n\t\treturn Matrix2d.Decompose(this)\n\t}\n\n\tclone() {\n\t\treturn new Matrix2d(this.a, this.b, this.c, this.d, this.e, this.f)\n\t}\n\n\t/* --------------------- Static --------------------- */\n\n\tstatic Identity() {\n\t\treturn new Matrix2d(1.0, 0.0, 0.0, 1.0, 0.0, 0.0)\n\t}\n\n\tstatic Translate(x: number, y: number) {\n\t\treturn new Matrix2d(1.0, 0.0, 0.0, 1.0, x, y)\n\t}\n\n\tstatic Rotate(r: number, cx?: number, cy?: number) {\n\t\tif (r === 0) return Matrix2d.Identity()\n\n\t\tconst cosAngle = Math.cos(r)\n\t\tconst sinAngle = Math.sin(r)\n\n\t\tconst rotationMatrix2d = new Matrix2d(cosAngle, sinAngle, -sinAngle, cosAngle, 0.0, 0.0)\n\n\t\tif (cx === undefined) return rotationMatrix2d\n\n\t\treturn Matrix2d.Compose(\n\t\t\tMatrix2d.Translate(cx, cy!),\n\t\t\trotationMatrix2d,\n\t\t\tMatrix2d.Translate(-cx, -cy!)\n\t\t)\n\t}\n\n\tstatic Scale: {\n\t\t(x: number, y: number): Matrix2dModel\n\t\t(x: number, y: number, cx: number, cy: number): Matrix2dModel\n\t} = (x: number, y: number, cx?: number, cy?: number) => {\n\t\tconst scaleMatrix2d = new Matrix2d(x, 0, 0, 0, y, 0)\n\n\t\tif (cx === undefined) return scaleMatrix2d\n\n\t\treturn Matrix2d.Compose(\n\t\t\tMatrix2d.Translate(cx, cy!),\n\t\t\tscaleMatrix2d,\n\t\t\tMatrix2d.Translate(-cx, -cy!)\n\t\t)\n\t}\n\n\tstatic Multiply(m1: Matrix2dModel, m2: Matrix2dModel): Matrix2dModel {\n\t\treturn {\n\t\t\ta: m1.a * m2.a + m1.c * m2.b,\n\t\t\tc: m1.a * m2.c + m1.c * m2.d,\n\t\t\te: m1.a * m2.e + m1.c * m2.f + m1.e,\n\t\t\tb: m1.b * m2.a + m1.d * m2.b,\n\t\t\td: m1.b * m2.c + m1.d * m2.d,\n\t\t\tf: m1.b * m2.e + m1.d * m2.f + m1.f,\n\t\t}\n\t}\n\n\tstatic Inverse(m: Matrix2dModel): Matrix2dModel {\n\t\tconst denom = m.a * m.d - m.b * m.c\n\t\treturn {\n\t\t\ta: m.d / denom,\n\t\t\tb: m.b / -denom,\n\t\t\tc: m.c / -denom,\n\t\t\td: m.a / denom,\n\t\t\te: (m.d * m.e - m.c * m.f) / -denom,\n\t\t\tf: (m.b * m.e - m.a * m.f) / denom,\n\t\t}\n\t}\n\n\tstatic Absolute(m: MatLike): Matrix2dModel {\n\t\tconst denom = m.a * m.d - m.b * m.c\n\t\treturn {\n\t\t\ta: m.d / denom,\n\t\t\tb: m.b / -denom,\n\t\t\tc: m.c / -denom,\n\t\t\td: m.a / denom,\n\t\t\te: (m.d * m.e - m.c * m.f) / denom,\n\t\t\tf: (m.b * m.e - m.a * m.f) / -denom,\n\t\t}\n\t}\n\n\tstatic Compose(...matrices: MatLike[]) {\n\t\tconst matrix = Matrix2d.Identity()\n\t\tfor (let i = 0, n = matrices.length; i < n; i++) {\n\t\t\tmatrix.multiply(matrices[i])\n\t\t}\n\t\treturn matrix\n\t}\n\n\tstatic Decompose(m: MatLike): MatrixInfo {\n\t\tlet scaleX, scaleY, rotation\n\n\t\tif (m.a !== 0 || m.c !== 0) {\n\t\t\tconst hypotAc = Math.hypot(m.a, m.c)\n\t\t\tscaleX = hypotAc\n\t\t\tscaleY = (m.a * m.d - m.b * m.c) / hypotAc\n\t\t\trotation = Math.acos(m.a / hypotAc) * (m.c > 0 ? -1 : 1)\n\t\t} else if (m.b !== 0 || m.d !== 0) {\n\t\t\tconst hypotBd = Math.hypot(m.b, m.d)\n\t\t\tscaleX = (m.a * m.d - m.b * m.c) / hypotBd\n\t\t\tscaleY = hypotBd\n\t\t\trotation = TAU + Math.acos(m.b / hypotBd) * (m.d > 0 ? -1 : 1)\n\t\t} else {\n\t\t\tscaleX = 0\n\t\t\tscaleY = 0\n\t\t\trotation = 0\n\t\t}\n\n\t\treturn {\n\t\t\tx: m.e,\n\t\t\ty: m.f,\n\t\t\tscaleX,\n\t\t\tscaleY,\n\t\t\trotation: clampRadians(rotation),\n\t\t}\n\t}\n\n\tstatic Smooth(m: MatLike, precision = 10000000000) {\n\t\tm.a = Math.round(m.a * precision) / precision\n\t\tm.b = Math.round(m.b * precision) / precision\n\t\tm.c = Math.round(m.c * precision) / precision\n\t\tm.d = Math.round(m.d * precision) / precision\n\t\tm.e = Math.round(m.e * precision) / precision\n\t\tm.f = Math.round(m.f * precision) / precision\n\t\treturn m\n\t}\n\n\tstatic toCssString(m: MatLike) {\n\t\treturn `matrix(${toDomPrecision(m.a)}, ${toDomPrecision(m.b)}, ${toDomPrecision(\n\t\t\tm.c\n\t\t)}, ${toDomPrecision(m.d)}, ${toDomPrecision(m.e)}, ${toDomPrecision(m.f)})`\n\t}\n\n\tstatic applyToPoint(m: MatLike, point: VecLike) {\n\t\treturn new Vec2d(\n\t\t\tm.a * point.x + m.c * point.y + m.e,\n\t\t\tm.b * point.x + m.d * point.y + m.f,\n\t\t\tpoint.z\n\t\t)\n\t}\n\n\tstatic applyToXY(m: MatLike, x: number, y: number) {\n\t\treturn [m.a * x + m.c * y + m.e, m.b * x + m.d * y + m.f]\n\t}\n\n\tstatic applyToPoints(m: MatLike, points: VecLike[]): Vec2d[] {\n\t\treturn points.map(\n\t\t\t(point) =>\n\t\t\t\tnew Vec2d(m.a * point.x + m.c * point.y + m.e, m.b * point.x + m.d * point.y + m.f, point.z)\n\t\t)\n\t}\n\n\tstatic applyToBounds(m: MatLike, box: Box2d) {\n\t\treturn new Box2d(m.e + box.minX, m.f + box.minY, box.width, box.height)\n\t}\n\n\tstatic From(m: MatLike) {\n\t\treturn new Matrix2d(m.a, m.b, m.c, m.d, m.e, m.f)\n\t}\n}\n\n/** @public */\nexport function decomposeMatrix2d(m: MatLike) {\n\treturn {\n\t\tx: m.e,\n\t\ty: m.f,\n\t\tscaleX: Math.sqrt(m.a * m.a + m.b * m.b),\n\t\tscaleY: Math.sqrt(m.c * m.c + m.d * m.d),\n\t\trotation: Math.atan2(m.b, m.a),\n\t}\n}\n","import { BaseSpline2d } from '../BaseSpline2d'\nimport { LineSegment2d, LineSegment2dModel } from '../LineSegment2d'\nimport { VecLike } from '../Vec2d'\n\n/** @public */\nexport class Polyline2d extends BaseSpline2d<LineSegment2dModel> {\n\tconstructor(points: VecLike[], k = 1.2, p = 20) {\n\t\tsuper(points, k, p)\n\t\tthis.segments = this.getSegmentsFromPoints(points, p)\n\t}\n\n\tsegments: LineSegment2d[]\n\n\tgetSegmentsFromPoints(points: VecLike[], p = 50): LineSegment2d[] {\n\t\tconst segments: LineSegment2d[] = []\n\n\t\tfor (let i = 0; i < points.length - 1; i++) {\n\t\t\tsegments.push(new LineSegment2d(points[i], points[i + 1], p))\n\t\t}\n\n\t\treturn segments\n\t}\n\n\tstatic FromPoints(points: VecLike[]) {\n\t\treturn new Polyline2d(points)\n\t}\n}\n","import { Vec2d } from '../Vec2d'\nimport type { StrokeOptions, StrokePoint } from './types'\n\nconst { PI } = Math\n\n// Browser strokes seem to be off if PI is regular, a tiny offset seems to fix it\nconst FIXED_PI = PI + 0.0001\n\n/**\n * ## getStrokeOutlinePoints\n *\n * Get an array of points (as `[x, y]`) representing the outline of a stroke.\n *\n * @param points - An array of StrokePoints as returned from `getStrokePoints`.\n * @param options - An object with options.\n *\n * @public\n */\nexport function getStrokeOutlinePoints(\n\tstrokePoints: StrokePoint[],\n\toptions: StrokeOptions = {}\n): Vec2d[] {\n\tconst { size = 16, smoothing = 0.5, start = {}, end = {}, last: isComplete = false } = options\n\n\tconst { cap: capStart = true } = start\n\tconst { cap: capEnd = true } = end\n\n\t// We can't do anything with an empty array or a stroke with negative size.\n\tif (strokePoints.length === 0 || size <= 0) {\n\t\treturn []\n\t}\n\n\tconst firstStrokePoint = strokePoints[0]\n\tconst lastStrokePoint = strokePoints[strokePoints.length - 1]\n\n\t// The total length of the line\n\tconst totalLength = lastStrokePoint.runningLength\n\n\tconst taperStart =\n\t\tstart.taper === false\n\t\t\t? 0\n\t\t\t: start.taper === true\n\t\t\t? Math.max(size, totalLength)\n\t\t\t: (start.taper as number)\n\n\tconst taperEnd =\n\t\tend.taper === false\n\t\t\t? 0\n\t\t\t: end.taper === true\n\t\t\t? Math.max(size, totalLength)\n\t\t\t: (end.taper as number)\n\n\t// The minimum allowed distance between points (squared)\n\tconst minDistance = Math.pow(size * smoothing, 2)\n\n\t// Our collected left and right points\n\tconst leftPts: Vec2d[] = []\n\tconst rightPts: Vec2d[] = []\n\n\t// Previous vector\n\tlet prevVector = strokePoints[0].vector\n\n\t// Previous left and right points\n\tlet pl = strokePoints[0].point\n\tlet pr = pl\n\n\t// Temporary left and right points\n\tlet tl = pl\n\tlet tr = pr\n\n\t// Keep track of whether the previous point is a sharp corner\n\t// ... so that we don't detect the same corner twice\n\tlet isPrevPointSharpCorner = false\n\n\t/*\n    Find the outline's left and right points\n\n    Iterating through the points and populate the rightPts and leftPts arrays,\n    skipping the first and last pointsm, which will get caps later on.\n  */\n\n\tlet strokePoint: StrokePoint\n\n\tfor (let i = 0; i < strokePoints.length; i++) {\n\t\tstrokePoint = strokePoints[i]\n\t\tconst { point, vector } = strokePoints[i]\n\n\t\t/*\n      Handle sharp corners\n\n      Find the difference (dot product) between the current and next vector.\n      If the next vector is at more than a right angle to the current vector,\n      draw a cap at the current point.\n    */\n\n\t\tconst prevDpr = strokePoint.vector.dpr(prevVector)\n\t\tconst nextVector = (i < strokePoints.length - 1 ? strokePoints[i + 1] : strokePoints[i]).vector\n\t\tconst nextDpr = i < strokePoints.length - 1 ? nextVector.dpr(strokePoint.vector) : 1\n\n\t\tconst isPointSharpCorner = prevDpr < 0 && !isPrevPointSharpCorner\n\t\tconst isNextPointSharpCorner = nextDpr !== null && nextDpr < 0.2\n\n\t\tif (isPointSharpCorner || isNextPointSharpCorner) {\n\t\t\t// It's a sharp corner. Draw a rounded cap and move on to the next point\n\t\t\t// Considering saving these and drawing them later? So that we can avoid\n\t\t\t// crossing future points.\n\n\t\t\t// console.log(nextDpr)\n\n\t\t\tif (nextDpr > -0.62 && totalLength - strokePoint.runningLength > strokePoint.radius) {\n\t\t\t\t// Draw a \"soft\" corner\n\t\t\t\tconst offset = prevVector.clone().mul(strokePoint.radius)\n\t\t\t\tconst cpr = prevVector.clone().cpr(nextVector)\n\n\t\t\t\tif (cpr < 0) {\n\t\t\t\t\ttl = Vec2d.Add(point, offset)\n\t\t\t\t\ttr = Vec2d.Sub(point, offset)\n\t\t\t\t} else {\n\t\t\t\t\ttl = Vec2d.Sub(point, offset)\n\t\t\t\t\ttr = Vec2d.Add(point, offset)\n\t\t\t\t}\n\n\t\t\t\tleftPts.push(tl)\n\t\t\t\trightPts.push(tr)\n\t\t\t} else {\n\t\t\t\t// Draw a \"sharp\" corner\n\t\t\t\tconst offset = prevVector.clone().mul(strokePoint.radius).per()\n\t\t\t\tconst start = Vec2d.Sub(strokePoint.input, offset)\n\n\t\t\t\tfor (let step = 1 / 13, t = 0; t < 1; t += step) {\n\t\t\t\t\ttl = Vec2d.RotWith(start, strokePoint.input, FIXED_PI * t)\n\t\t\t\t\tleftPts.push(tl)\n\n\t\t\t\t\ttr = Vec2d.RotWith(start, strokePoint.input, FIXED_PI + FIXED_PI * -t)\n\t\t\t\t\trightPts.push(tr)\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tpl = tl\n\t\t\tpr = tr\n\n\t\t\tif (isNextPointSharpCorner) {\n\t\t\t\tisPrevPointSharpCorner = true\n\t\t\t}\n\n\t\t\tcontinue\n\t\t}\n\n\t\tisPrevPointSharpCorner = false\n\n\t\tif (strokePoint === firstStrokePoint || strokePoint === lastStrokePoint) {\n\t\t\tconst offset = Vec2d.Per(vector).mul(strokePoint.radius)\n\t\t\tleftPts.push(Vec2d.Sub(point, offset))\n\t\t\trightPts.push(Vec2d.Add(point, offset))\n\n\t\t\tcontinue\n\t\t}\n\n\t\t/* \n      Add regular points\n\n      Project points to either side of the current point, using the\n      calculated size as a distance. If a point's distance to the \n      previous point on that side greater than the minimum distance\n      (or if the corner is kinda sharp), add the points to the side's\n      points array.\n    */\n\n\t\tconst offset = Vec2d.Lrp(nextVector, vector, nextDpr).per().mul(strokePoint.radius)\n\n\t\ttl = Vec2d.Sub(point, offset)\n\n\t\tif (i <= 1 || Vec2d.Dist2(pl, tl) > minDistance) {\n\t\t\tleftPts.push(tl)\n\t\t\tpl = tl\n\t\t}\n\n\t\ttr = Vec2d.Add(point, offset)\n\n\t\tif (i <= 1 || Vec2d.Dist2(pr, tr) > minDistance) {\n\t\t\trightPts.push(tr)\n\t\t\tpr = tr\n\t\t}\n\n\t\t// Set variables for next iteration\n\t\tprevVector = vector\n\n\t\tcontinue\n\t}\n\n\t/*\n    Drawing caps\n    \n    Now that we have our points on either side of the line, we need to\n    draw caps at the start and end. Tapered lines don't have caps, but\n    may have dots for very short lines.\n  */\n\n\tconst firstPoint = firstStrokePoint.point\n\n\tconst lastPoint =\n\t\tstrokePoints.length > 1\n\t\t\t? strokePoints[strokePoints.length - 1].point\n\t\t\t: Vec2d.AddXY(firstStrokePoint.point, 1, 1)\n\n\t/* \n    Draw a dot for very short or completed strokes\n    \n    If the line is too short to gather left or right points and if the line is\n    not tapered on either side, draw a dot. If the line is tapered, then only\n    draw a dot if the line is both very short and complete. If we draw a dot,\n    we can just return those points.\n  */\n\n\tif (strokePoints.length === 1) {\n\t\tif (!(taperStart || taperEnd) || isComplete) {\n\t\t\tconst start = Vec2d.Add(\n\t\t\t\tfirstPoint,\n\t\t\t\tVec2d.Sub(firstPoint, lastPoint).uni().per().mul(-firstStrokePoint.radius)\n\t\t\t)\n\t\t\tconst dotPts: Vec2d[] = []\n\t\t\tfor (let step = 1 / 13, t = step; t <= 1; t += step) {\n\t\t\t\tdotPts.push(Vec2d.RotWith(start, firstPoint, FIXED_PI * 2 * t))\n\t\t\t}\n\t\t\treturn dotPts\n\t\t}\n\t}\n\n\t/*\n    Draw a start cap\n\n    Unless the line has a tapered start, or unless the line has a tapered end\n    and the line is very short, draw a start cap around the first point. Use\n    the distance between the second left and right point for the cap's radius.\n    Finally remove the first left and right points. :psyduck:\n  */\n\n\tconst startCap: Vec2d[] = []\n\tif (taperStart || (taperEnd && strokePoints.length === 1)) {\n\t\t// The start point is tapered, noop\n\t} else if (capStart) {\n\t\t// Draw the round cap - add thirteen points rotating the right point around the start point to the left point\n\t\tfor (let step = 1 / 8, t = step; t <= 1; t += step) {\n\t\t\tconst pt = Vec2d.RotWith(rightPts[0], firstPoint, FIXED_PI * t)\n\t\t\tstartCap.push(pt)\n\t\t}\n\t} else {\n\t\t// Draw the flat cap - add a point to the left and right of the start point\n\t\tconst cornersVector = Vec2d.Sub(leftPts[0], rightPts[0])\n\t\tconst offsetA = Vec2d.Mul(cornersVector, 0.5)\n\t\tconst offsetB = Vec2d.Mul(cornersVector, 0.51)\n\n\t\tstartCap.push(\n\t\t\tVec2d.Sub(firstPoint, offsetA),\n\t\t\tVec2d.Sub(firstPoint, offsetB),\n\t\t\tVec2d.Add(firstPoint, offsetB),\n\t\t\tVec2d.Add(firstPoint, offsetA)\n\t\t)\n\t}\n\n\t/*\n    Draw an end cap\n\n    If the line does not have a tapered end, and unless the line has a tapered\n    start and the line is very short, draw a cap around the last point. Finally,\n    remove the last left and right points. Otherwise, add the last point. Note\n    that This cap is a full-turn-and-a-half: this prevents incorrect caps on\n    sharp end turns.\n  */\n\n\tconst endCap: Vec2d[] = []\n\tconst direction = lastStrokePoint.vector.clone().per().neg()\n\n\tif (taperEnd || (taperStart && strokePoints.length === 1)) {\n\t\t// Tapered end - push the last point to the line\n\t\tendCap.push(lastPoint)\n\t} else if (capEnd) {\n\t\t// Draw the round end cap\n\t\tconst start = Vec2d.Add(lastPoint, Vec2d.Mul(direction, lastStrokePoint.radius))\n\t\tfor (let step = 1 / 29, t = step; t < 1; t += step) {\n\t\t\tendCap.push(Vec2d.RotWith(start, lastPoint, FIXED_PI * 3 * t))\n\t\t}\n\t} else {\n\t\t// Draw the flat end cap\n\t\tendCap.push(\n\t\t\tVec2d.Add(lastPoint, Vec2d.Mul(direction, lastStrokePoint.radius)),\n\t\t\tVec2d.Add(lastPoint, Vec2d.Mul(direction, lastStrokePoint.radius * 0.99)),\n\t\t\tVec2d.Sub(lastPoint, Vec2d.Mul(direction, lastStrokePoint.radius * 0.99)),\n\t\t\tVec2d.Sub(lastPoint, Vec2d.Mul(direction, lastStrokePoint.radius))\n\t\t)\n\t}\n\n\t/*\n    Return the points in the correct winding order: begin on the left side, then \n    continue around the end cap, then come back along the right side, and finally \n    complete the start cap.\n  */\n\n\treturn leftPts.concat(endCap, rightPts.reverse(), startCap)\n}\n","import { Vec2d, VecLike } from '../Vec2d'\nimport type { StrokeOptions, StrokePoint } from './types'\n\nconst MIN_START_PRESSURE = 0.025\nconst MIN_END_PRESSURE = 0.01\n\n/**\n * ## getStrokePoints\n *\n * Get an array of points as objects with an adjusted point, pressure, vector, distance, and\n * runningLength.\n *\n * @param points - An array of points (as `[x, y, pressure]` or `{x, y, pressure}`). Pressure is\n *   optional in both cases.\n * @param options - An object with options.\n *\n * @public\n */\nexport function getStrokePoints(\n\trawInputPoints: VecLike[],\n\toptions: StrokeOptions = {}\n): StrokePoint[] {\n\tconst { streamline = 0.5, size = 16, simulatePressure = false } = options\n\n\t// If we don't have any points, return an empty array.\n\tif (rawInputPoints.length === 0) return []\n\n\t// Find the interpolation level between points.\n\tconst t = 0.15 + (1 - streamline) * 0.85\n\n\t// Whatever the input is, make sure that the points are in number[][].\n\tlet pts = rawInputPoints.map(Vec2d.From)\n\n\tlet pointsRemovedFromNearEnd = 0\n\n\tif (!simulatePressure) {\n\t\t// Strip low pressure points from the start of the array.\n\t\tlet pt = pts[0]\n\t\twhile (pt) {\n\t\t\tif (pt.z >= MIN_START_PRESSURE) break\n\t\t\tpts.shift()\n\t\t\tpt = pts[0]\n\t\t}\n\t}\n\n\tif (!simulatePressure) {\n\t\t// Strip low pressure points from the end of the array.\n\t\tlet pt = pts[pts.length - 1]\n\t\twhile (pt) {\n\t\t\tif (pt.z >= MIN_END_PRESSURE) break\n\t\t\tpts.pop()\n\t\t\tpt = pts[pts.length - 1]\n\t\t}\n\t}\n\n\tif (pts.length === 0)\n\t\treturn [\n\t\t\t{\n\t\t\t\tpoint: Vec2d.From(rawInputPoints[0]),\n\t\t\t\tinput: Vec2d.From(rawInputPoints[0]),\n\t\t\t\tpressure: simulatePressure ? 0.5 : 0.15,\n\t\t\t\tvector: new Vec2d(1, 1),\n\t\t\t\tdistance: 0,\n\t\t\t\trunningLength: 0,\n\t\t\t\tradius: 1,\n\t\t\t},\n\t\t]\n\n\t// Strip points that are too close to the first point.\n\tlet pt = pts[1]\n\twhile (pt) {\n\t\tif (Vec2d.Dist(pt, pts[0]) > size / 3) break\n\t\tpts[0].z = Math.max(pts[0].z, pt.z) // Use maximum pressure\n\t\tpts.splice(1, 1)\n\t\tpt = pts[1]\n\t}\n\n\t// Strip points that are too close to the last point.\n\tconst last = pts.pop()!\n\tpt = pts[pts.length - 1]\n\twhile (pt) {\n\t\tif (Vec2d.Dist(pt, last) > size / 3) break\n\t\tpts.pop()\n\t\tpt = pts[pts.length - 1]\n\t\tpointsRemovedFromNearEnd++\n\t}\n\tpts.push(last)\n\n\tconst isComplete =\n\t\toptions.last ||\n\t\t!options.simulatePressure ||\n\t\t(pts.length > 1 && Vec2d.Dist(pts[pts.length - 1], pts[pts.length - 2]) < size) ||\n\t\tpointsRemovedFromNearEnd > 0\n\n\t// Add extra points between the two, to help avoid \"dash\" lines\n\t// for strokes with tapered start and ends. Don't mutate the\n\t// input array!\n\tif (pts.length === 2 && options.simulatePressure) {\n\t\tconst last = pts[1]\n\t\tpts = pts.slice(0, -1)\n\t\tfor (let i = 1; i < 5; i++) {\n\t\t\tconst next = Vec2d.Lrp(pts[0], last, i / 4)\n\t\t\tnext.z = ((pts[0].z + (last.z - pts[0].z)) * i) / 4\n\t\t\tpts.push(next)\n\t\t}\n\t}\n\n\t// The strokePoints array will hold the points for the stroke.\n\t// Start it out with the first point, which needs no adjustment.\n\tconst strokePoints: StrokePoint[] = [\n\t\t{\n\t\t\tpoint: pts[0],\n\t\t\tinput: pts[0],\n\t\t\tpressure: simulatePressure ? 0.5 : pts[0].z,\n\t\t\tvector: new Vec2d(1, 1),\n\t\t\tdistance: 0,\n\t\t\trunningLength: 0,\n\t\t\tradius: 1,\n\t\t},\n\t]\n\n\t// We use the totalLength to keep track of the total distance\n\tlet totalLength = 0\n\n\t// We're set this to the latest point, so we can use it to calculate\n\t// the distance and vector of the next point.\n\tlet prev = strokePoints[0]\n\n\t// Iterate through all of the points, creating StrokePoints.\n\tlet point: Vec2d, distance: number\n\n\tif (isComplete && streamline > 0) {\n\t\tpts.push(pts[pts.length - 1].clone())\n\t}\n\n\tfor (let i = 1, n = pts.length; i < n; i++) {\n\t\tpoint =\n\t\t\t!t || (options.last && i === n - 1) ? pts[i].clone() : pts[i].clone().lrp(prev.point, 1 - t)\n\n\t\t// If the new point is the same as the previous point, skip ahead.\n\t\tif (prev.point.equals(point)) continue\n\n\t\t// How far is the new point from the previous point?\n\t\tdistance = Vec2d.Dist(point, prev.point)\n\n\t\t// Add this distance to the total \"running length\" of the line.\n\t\ttotalLength += distance\n\n\t\t// At the start of the line, we wait until the new point is a\n\t\t// certain distance away from the original point, to avoid noise\n\n\t\tif (i < 4 && totalLength < size) {\n\t\t\tcontinue\n\t\t}\n\n\t\t// Create a new strokepoint (it will be the new \"previous\" one).\n\t\tprev = {\n\t\t\tinput: pts[i],\n\t\t\t// The adjusted point\n\t\t\tpoint,\n\t\t\t// The input pressure (or .5 if not specified)\n\t\t\tpressure: simulatePressure ? 0.5 : pts[i].z,\n\t\t\t// The vector from the current point to the previous point\n\t\t\tvector: Vec2d.Sub(prev.point, point).uni(),\n\t\t\t// The distance between the current point and the previous point\n\t\t\tdistance,\n\t\t\t// The total distance so far\n\t\t\trunningLength: totalLength,\n\t\t\t// The stroke point's radius\n\t\t\tradius: 1,\n\t\t}\n\n\t\t// Push it to the strokePoints array.\n\t\tstrokePoints.push(prev)\n\t}\n\n\t// Set the vector of the first point to be the same as the second point.\n\tif (strokePoints[1]?.vector) {\n\t\tstrokePoints[0].vector = strokePoints[1].vector.clone()\n\t}\n\n\tif (totalLength < 1) {\n\t\tconst maxPressureAmongPoints = Math.max(0.5, ...strokePoints.map((s) => s.pressure))\n\t\tstrokePoints.forEach((s) => (s.pressure = maxPressureAmongPoints))\n\t}\n\n\treturn strokePoints\n}\n","import { EASINGS } from '../easings'\nimport { StrokeOptions, StrokePoint } from './types'\n\nconst { min } = Math\n\n// This is the rate of change for simulated pressure. It could be an option.\nconst RATE_OF_PRESSURE_CHANGE = 0.275\n\n/** @public */\nexport function setStrokePointRadii(strokePoints: StrokePoint[], options: StrokeOptions) {\n\tconst {\n\t\tsize = 16,\n\t\tthinning = 0.5,\n\t\tsimulatePressure = true,\n\t\teasing = (t) => t,\n\t\tstart = {},\n\t\tend = {},\n\t} = options\n\n\tconst { easing: taperStartEase = EASINGS.easeOutQuad } = start\n\tconst { easing: taperEndEase = EASINGS.easeOutCubic } = end\n\n\tconst totalLength = strokePoints[strokePoints.length - 1].runningLength\n\n\tlet firstRadius: number | undefined\n\tlet prevPressure = strokePoints[0].pressure\n\tlet strokePoint: StrokePoint\n\n\tif (!simulatePressure && totalLength < size) {\n\t\tconst max = strokePoints.reduce((max, curr) => Math.max(max, curr.pressure), 0.5)\n\t\tstrokePoints.forEach((sp) => {\n\t\t\tsp.pressure = max\n\t\t\tsp.radius = size * easing(0.5 - thinning * (0.5 - sp.pressure))\n\t\t})\n\t\treturn strokePoints\n\t} else {\n\t\t// Calculate initial pressure based on the average of the first\n\t\t// n number of points. This prevents \"dots\" at the start of the\n\t\t// line. Drawn lines almost always start slow!\n\t\tlet p: number\n\t\tfor (let i = 0, n = strokePoints.length; i < n; i++) {\n\t\t\tstrokePoint = strokePoints[i]\n\t\t\tif (strokePoint.runningLength > size * 5) break\n\t\t\tconst sp = min(1, strokePoint.distance / size)\n\t\t\tif (simulatePressure) {\n\t\t\t\tconst rp = min(1, 1 - sp)\n\t\t\t\tp = min(1, prevPressure + (rp - prevPressure) * (sp * RATE_OF_PRESSURE_CHANGE))\n\t\t\t} else {\n\t\t\t\tp = min(1, prevPressure + (strokePoint.pressure - prevPressure) * 0.5)\n\t\t\t}\n\t\t\tprevPressure = prevPressure + (p - prevPressure) * 0.5\n\t\t}\n\n\t\t// Now calculate pressure and radius for each point\n\t\tfor (let i = 0; i < strokePoints.length; i++) {\n\t\t\tstrokePoint = strokePoints[i]\n\t\t\tif (thinning) {\n\t\t\t\tlet { pressure } = strokePoint\n\t\t\t\tconst sp = min(1, strokePoint.distance / size)\n\t\t\t\tif (simulatePressure) {\n\t\t\t\t\t// If we're simulating pressure, then do so based on the distance\n\t\t\t\t\t// between the current point and the previous point, and the size\n\t\t\t\t\t// of the stroke.\n\t\t\t\t\tconst rp = min(1, 1 - sp)\n\t\t\t\t\tpressure = min(1, prevPressure + (rp - prevPressure) * (sp * RATE_OF_PRESSURE_CHANGE))\n\t\t\t\t} else {\n\t\t\t\t\t// Otherwise, use the input pressure slightly smoothed based on the\n\t\t\t\t\t// distance between the current point and the previous point.\n\t\t\t\t\tpressure = min(\n\t\t\t\t\t\t1,\n\t\t\t\t\t\tprevPressure + (pressure - prevPressure) * (sp * RATE_OF_PRESSURE_CHANGE)\n\t\t\t\t\t)\n\t\t\t\t}\n\n\t\t\t\tstrokePoint.radius = size * easing(0.5 - thinning * (0.5 - pressure))\n\n\t\t\t\tprevPressure = pressure\n\t\t\t} else {\n\t\t\t\tstrokePoint.radius = size / 2\n\t\t\t}\n\n\t\t\tif (firstRadius === undefined) {\n\t\t\t\tfirstRadius = strokePoint.radius\n\t\t\t}\n\t\t}\n\t}\n\n\tconst taperStart =\n\t\tstart.taper === false\n\t\t\t? 0\n\t\t\t: start.taper === true\n\t\t\t? Math.max(size, totalLength)\n\t\t\t: (start.taper as number)\n\n\tconst taperEnd =\n\t\tend.taper === false\n\t\t\t? 0\n\t\t\t: end.taper === true\n\t\t\t? Math.max(size, totalLength)\n\t\t\t: (end.taper as number)\n\n\tif (taperStart || taperEnd) {\n\t\tfor (let i = 0; i < strokePoints.length; i++) {\n\t\t\tstrokePoint = strokePoints[i]\n\t\t\t/*\n\t\t\t\tApply tapering\n\n\t\t\t\tIf the current length is within the taper distance at either the\n\t\t\t\tstart or the end, calculate the taper strengths. Apply the smaller \n\t\t\t\tof the two taper strengths to the radius.\n\t\t\t*/\n\n\t\t\tconst { runningLength } = strokePoint\n\n\t\t\tconst ts = runningLength < taperStart ? taperStartEase(runningLength / taperStart) : 1\n\n\t\t\tconst te =\n\t\t\t\ttotalLength - runningLength < taperEnd\n\t\t\t\t\t? taperEndEase((totalLength - runningLength) / taperEnd)\n\t\t\t\t\t: 1\n\n\t\t\tstrokePoint.radius = Math.max(0.01, strokePoint.radius * Math.min(ts, te))\n\t\t}\n\t}\n\n\treturn strokePoints\n}\n","import { Vec2d, VecLike } from '../Vec2d'\nimport { getStrokeOutlinePoints } from './getStrokeOutlinePoints'\nimport { getStrokePoints } from './getStrokePoints'\nimport { setStrokePointRadii } from './setStrokePointRadii'\nimport type { StrokeOptions } from './types'\n\n/**\n * ## getStroke\n *\n * Get an array of points describing a polygon that surrounds the input points.\n *\n * @param points - An array of points (as `[x, y, pressure]` or `{x, y, pressure}`). Pressure is\n *   optional in both cases.\n * @param options - An object with options.\n *\n * @public\n */\n\nexport function getStroke(points: VecLike[], options: StrokeOptions = {}): Vec2d[] {\n\treturn getStrokeOutlinePoints(\n\t\tsetStrokePointRadii(getStrokePoints(points, options), options),\n\t\toptions\n\t)\n}\n","import { Box2d } from './Box2d'\nimport { pointInPolygon } from './utils'\nimport { Vec2d, VecLike } from './Vec2d'\n\n// need even more intersections? See https://gist.github.com/steveruizok/35c02d526c707003a5c79761bfb89a52\n\n/**\n * Find the intersection between a line segment and a line segment.\n *\n * @param a1 - The first segment's first point.\n * @param a2 - The first segment's second point.\n * @param b1 - The second segment's first point.\n * @param b2 - The second segment's second point.\n *\n * @public\n */\nexport function intersectLineSegmentLineSegment(\n\ta1: VecLike,\n\ta2: VecLike,\n\tb1: VecLike,\n\tb2: VecLike\n) {\n\tconst ABx = a1.x - b1.x\n\tconst ABy = a1.y - b1.y\n\tconst BVx = b2.x - b1.x\n\tconst BVy = b2.y - b1.y\n\tconst AVx = a2.x - a1.x\n\tconst AVy = a2.y - a1.y\n\tconst ua_t = BVx * ABy - BVy * ABx\n\tconst ub_t = AVx * ABy - AVy * ABx\n\tconst u_b = BVy * AVx - BVx * AVy\n\n\tif (ua_t === 0 || ub_t === 0) return null // coincident\n\n\tif (u_b === 0) return null // parallel\n\n\tif (u_b !== 0) {\n\t\tconst ua = ua_t / u_b\n\t\tconst ub = ub_t / u_b\n\t\tif (0 <= ua && ua <= 1 && 0 <= ub && ub <= 1) {\n\t\t\treturn Vec2d.AddXY(a1, ua * AVx, ua * AVy)\n\t\t}\n\t}\n\n\treturn null // no intersection\n}\n\n/**\n * Find the intersections between a line segment and a circle.\n *\n * @param a1 - The segment's first point.\n * @param a2 - The segment's second point.\n * @param c - The circle's center.\n * @param r - The circle's radius.\n * @public\n */\nexport function intersectLineSegmentCircle(a1: VecLike, a2: VecLike, c: VecLike, r: number) {\n\tconst a = (a2.x - a1.x) * (a2.x - a1.x) + (a2.y - a1.y) * (a2.y - a1.y)\n\tconst b = 2 * ((a2.x - a1.x) * (a1.x - c.x) + (a2.y - a1.y) * (a1.y - c.y))\n\tconst cc =\n\t\tc.x * c.x + c.y * c.y + a1.x * a1.x + a1.y * a1.y - 2 * (c.x * a1.x + c.y * a1.y) - r * r\n\tconst deter = b * b - 4 * a * cc\n\n\tif (deter < 0) return null // outside\n\tif (deter === 0) return null // tangent\n\n\tconst e = Math.sqrt(deter)\n\tconst u1 = (-b + e) / (2 * a)\n\tconst u2 = (-b - e) / (2 * a)\n\n\tif ((u1 < 0 || u1 > 1) && (u2 < 0 || u2 > 1)) {\n\t\treturn null // outside or inside\n\t\t// if ((u1 < 0 && u2 < 0) || (u1 > 1 && u2 > 1)) {\n\t\t// \treturn null // outside\n\t\t// } else return null // inside'\n\t}\n\n\tconst result: VecLike[] = []\n\n\tif (0 <= u1 && u1 <= 1) result.push(Vec2d.Lrp(a1, a2, u1))\n\tif (0 <= u2 && u2 <= 1) result.push(Vec2d.Lrp(a1, a2, u2))\n\n\tif (result.length === 0) return null // no intersection\n\n\treturn result\n}\n\n/**\n * Find the intersections between a line segment and a polyline.\n *\n * @param a1 - The segment's first point.\n * @param a2 - The segment's second point.\n * @param points - The points in the polyline.\n * @public\n */\nexport function intersectLineSegmentPolyline(a1: VecLike, a2: VecLike, points: VecLike[]) {\n\tconst result: VecLike[] = []\n\tlet segmentIntersection: VecLike | null\n\n\tfor (let i = 0, n = points.length - 1; i < n; i++) {\n\t\tsegmentIntersection = intersectLineSegmentLineSegment(a1, a2, points[i], points[i + 1])\n\t\tif (segmentIntersection) result.push(segmentIntersection)\n\t}\n\n\tif (result.length === 0) return null // no intersection\n\n\treturn result\n}\n\n/**\n * Find the intersections between a line segment and a closed polygon.\n *\n * @param a1 - The segment's first point.\n * @param a2 - The segment's second point.\n * @param points - The points in the polygon.\n * @public\n */\nexport function intersectLineSegmentPolygon(a1: VecLike, a2: VecLike, points: VecLike[]) {\n\tconst result: VecLike[] = []\n\tlet segmentIntersection: VecLike | null\n\n\tfor (let i = 1, n = points.length; i < n + 1; i++) {\n\t\tsegmentIntersection = intersectLineSegmentLineSegment(\n\t\t\ta1,\n\t\t\ta2,\n\t\t\tpoints[i - 1],\n\t\t\tpoints[i % points.length]\n\t\t)\n\t\tif (segmentIntersection) result.push(segmentIntersection)\n\t}\n\n\tif (result.length === 0) return null // no intersection\n\n\treturn result\n}\n\n/**\n * Find the intersections between a circle and a circle.\n *\n * @param c1 - The first circle's center.\n * @param r1 - The first circle's radius.\n * @param c2 - The second circle's center.\n * @param r2 - The second circle's radius.\n * @public\n */\nexport function intersectCircleCircle(c1: VecLike, r1: number, c2: VecLike, r2: number) {\n\tlet dx = c2.x - c1.x\n\tlet dy = c2.y - c1.y\n\tconst d = Math.sqrt(dx * dx + dy * dy),\n\t\tx = (d * d - r2 * r2 + r1 * r1) / (2 * d),\n\t\ty = Math.sqrt(r1 * r1 - x * x)\n\tdx /= d\n\tdy /= d\n\treturn [\n\t\tnew Vec2d(c1.x + dx * x - dy * y, c1.y + dy * x + dx * y),\n\t\tnew Vec2d(c1.x + dx * x + dy * y, c1.y + dy * x - dx * y),\n\t]\n}\n\n/**\n * Find the intersections between a circle and a bounding box.\n *\n * @param c - The circle's center.\n * @param r - The circle's radius.\n * @param points - The points in the polygon.\n * @public\n */\nexport function intersectCirclePolygon(c: VecLike, r: number, points: VecLike[]) {\n\tconst result: VecLike[] = []\n\tlet a: VecLike, b: VecLike, int: VecLike[] | null\n\n\tfor (let i = 0, n = points.length; i < n; i++) {\n\t\ta = points[i]\n\t\tb = points[(i + 1) % points.length]\n\t\tint = intersectLineSegmentCircle(a, b, c, r)\n\t\tif (int) result.push(...int)\n\t}\n\n\tif (result.length === 0) return null // no intersection\n\n\treturn result\n}\n\n/**\n * Find the intersections between a circle and a bounding box.\n *\n * @param c - The circle's center.\n * @param r - The circle's radius.\n * @param points - The points in the polyline.\n * @public\n */\nexport function intersectCirclePolyline(c: VecLike, r: number, points: VecLike[]) {\n\tconst result: VecLike[] = []\n\tlet a: VecLike, b: VecLike, int: VecLike[] | null\n\n\tfor (let i = 1, n = points.length; i < n; i++) {\n\t\ta = points[i - 1]\n\t\tb = points[i]\n\t\tint = intersectLineSegmentCircle(a, b, c, r)\n\t\tif (int) result.push(...int)\n\t}\n\n\tif (result.length === 0) return null // no intersection\n\n\treturn result\n}\n\n/**\n * Find the intersections between a polygon and a bounding box.\n *\n * @public\n */\nexport function intersectPolygonBounds(points: VecLike[], bounds: Box2d) {\n\tconst result: VecLike[] = []\n\tlet segmentIntersection: VecLike[] | null\n\n\tfor (const side of bounds.sides) {\n\t\tsegmentIntersection = intersectLineSegmentPolygon(side[0], side[1], points)\n\t\tif (segmentIntersection) result.push(...segmentIntersection)\n\t}\n\n\tif (result.length === 0) return null // no intersection\n\n\treturn result\n}\n\nfunction ccw(A: VecLike, B: VecLike, C: VecLike) {\n\treturn (C.y - A.y) * (B.x - A.x) > (B.y - A.y) * (C.x - A.x)\n}\n\n/** @public */\nexport function linesIntersect(A: VecLike, B: VecLike, C: VecLike, D: VecLike) {\n\treturn ccw(A, C, D) !== ccw(B, C, D) && ccw(A, B, C) !== ccw(A, B, D)\n}\n\n/**\n * Create a new convex polygon as the intersection of two convex polygons.\n *\n * @param polygonA - An array of points representing the first polygon.\n * @param polygonB - An array of points representing the second polygon.\n * @public\n */\nexport function intersectPolygonPolygon(polygonA: VecLike[], polygonB: VecLike[]) {\n\t// Create an empty polygon as P\n\tconst result: VecLike[] = []\n\tlet a: VecLike, b: VecLike, c: VecLike, d: VecLike\n\n\t// Add all corners of PolygonA that is inside PolygonB to P\n\tfor (let i = 0, n = polygonA.length; i < n; i++) {\n\t\ta = polygonA[i]\n\t\tif (pointInPolygon(a, polygonB)) {\n\t\t\tresult.push(a)\n\t\t}\n\t}\n\t// Add all corners of PolygonB that is inside PolygonA to P\n\tfor (let i = 0, n = polygonB.length; i < n; i++) {\n\t\ta = polygonB[i]\n\t\tif (pointInPolygon(a, polygonA)) {\n\t\t\tresult.push(a)\n\t\t}\n\t}\n\n\t// Add all intersection points to P\n\tfor (let i = 0, n = polygonA.length; i < n; i++) {\n\t\ta = polygonA[i]\n\t\tb = polygonA[(i + 1) % polygonA.length]\n\n\t\tfor (let j = 0, m = polygonB.length; j < m; j++) {\n\t\t\tc = polygonB[j]\n\t\t\td = polygonB[(j + 1) % polygonB.length]\n\t\t\tconst intersection = intersectLineSegmentLineSegment(a, b, c, d)\n\n\t\t\tif (intersection !== null) {\n\t\t\t\tresult.push(intersection)\n\t\t\t}\n\t\t}\n\t}\n\n\tif (result.length === 0) return null // no intersection\n\n\t// Order all points in the P counter-clockwise.\n\treturn orderClockwise(result)\n}\n\nfunction orderClockwise(points: VecLike[]): VecLike[] {\n\tconst C = Vec2d.Average(points)\n\treturn points.sort((A, B) => Vec2d.Angle(C, A) - Vec2d.Angle(C, B))\n}\n\n/** @public */\nexport function polygonsIntersect(a: VecLike[], b: VecLike[]) {\n\tlet a0: VecLike, a1: VecLike, b0: VecLike, b1: VecLike\n\tfor (let i = 0, n = a.length; i < n; i++) {\n\t\ta0 = a[i]\n\t\ta1 = a[(i + 1) % n]\n\t\tfor (let j = 0, m = b.length; j < m; j++) {\n\t\t\tb0 = b[j]\n\t\t\tb1 = b[(j + 1) % m]\n\t\t\tif (linesIntersect(a0, a1, b0, b1)) return true\n\t\t}\n\t}\n\treturn false\n}\n","import * as React from 'react'\n\n/** @public */\nexport type SVGContainerProps = React.HTMLAttributes<SVGElement>\n\n/** @public */\nexport function SVGContainer({ children, className = '', ...rest }: SVGContainerProps) {\n\treturn (\n\t\t<svg {...rest} className={`rs-svg-container ${className}`}>\n\t\t\t{children}\n\t\t</svg>\n\t)\n}\n","import { TLUnknownShape } from '@tldraw/tlschema'\nimport { Migrations, StoreValidator } from '@tldraw/tlstore'\nimport { App } from '../app/App'\nimport { TLShapeUtil, TLShapeUtilConstructor } from '../app/shapeutils'\n\n/** @public */\nexport interface TLShapeDef<\n\tShapeType extends TLUnknownShape,\n\tShapeUtil extends TLShapeUtil<ShapeType> = TLShapeUtil<ShapeType>\n> {\n\treadonly type: ShapeType['type']\n\treadonly createShapeUtils: (app: App) => ShapeUtil\n\treadonly is: (shape: TLUnknownShape) => shape is ShapeType\n\treadonly validator?: StoreValidator<ShapeType>\n\treadonly migrations: Migrations\n}\n\n/** @public */\nexport type TLUnknownShapeDef = TLShapeDef<TLUnknownShape, TLShapeUtil<TLUnknownShape>>\n\n/** @public */\nexport function defineShape<\n\tShapeType extends TLUnknownShape,\n\tShapeUtil extends TLShapeUtil<ShapeType> = TLShapeUtil<ShapeType>\n>({\n\ttype,\n\tgetShapeUtil,\n\tvalidator,\n\tmigrations = { currentVersion: 0, firstVersion: 0, migrators: {} },\n}: {\n\ttype: ShapeType['type']\n\tgetShapeUtil: () => TLShapeUtilConstructor<ShapeType, ShapeUtil>\n\tvalidator?: StoreValidator<ShapeType>\n\tmigrations?: Migrations\n}): TLShapeDef<ShapeType, ShapeUtil> {\n\tif (!validator && process.env.NODE_ENV === 'development') {\n\t\tconsole.warn(\n\t\t\t`No validator provided for shape type ${type}! Validators are highly recommended for use in production.`\n\t\t)\n\t}\n\n\treturn {\n\t\ttype,\n\t\tcreateShapeUtils: (app: App) => {\n\t\t\tconst ShapeUtil = getShapeUtil()\n\t\t\treturn new ShapeUtil(app, type)\n\t\t},\n\t\tis: (shape: TLUnknownShape): shape is ShapeType => shape.type === type,\n\t\tvalidator,\n\t\tmigrations,\n\t}\n}\n","import { EASINGS } from '@tldraw/primitives'\nimport {\n\tTLAlignType,\n\tTLFontType,\n\tTLSizeType,\n\tTLStyleCollections,\n\tVec2dModel,\n} from '@tldraw/tlschema'\nimport { TLDeltaDirection } from './app/types/misc-types'\n\n/** @internal */\nexport const MAX_SHAPES_PER_PAGE = 2000\n/** @internal */\nexport const MAX_PAGES = 40\n\n/** @internal */\nexport const REMOVE_SYMBOL = Symbol('remove')\n\n/** @internal */\nexport const RICH_TYPES: Record<string, boolean> = {\n\tDate: true,\n\tRegExp: true,\n\tString: true,\n\tNumber: true,\n}\n\n/** @internal */\nexport const ANIMATION_SHORT_MS = 80\n/** @internal */\nexport const ANIMATION_MEDIUM_MS = 320\n\n/** @internal */\nexport const ZOOMS = [0.1, 0.25, 0.5, 1, 2, 4, 8]\n/** @internal */\nexport const MIN_ZOOM = 0.1\n/** @internal */\nexport const MAX_ZOOM = 8\n/** @internal */\nexport const MAJOR_NUDGE_FACTOR = 10\n/** @internal */\nexport const MINOR_NUDGE_FACTOR = 1\n\n/** @internal */\nexport const MAX_ASSET_WIDTH = 1000\n/** @internal */\nexport const MAX_ASSET_HEIGHT = 1000\n\n/** @internal */\nexport const GRID_INCREMENT = 5\n\n/** @internal */\nexport const DIRECTION_DELTAS: Record<TLDeltaDirection, Vec2dModel> = {\n\tleft: { x: -1, y: 0 },\n\tright: { x: 1, y: 0 },\n\tup: { x: 0, y: -1 },\n\tdown: { x: 0, y: 1 },\n\tupLeft: { x: -1, y: -1 },\n\tupRight: { x: 1, y: -1 },\n\tdownLeft: { x: -1, y: 1 },\n\tdownRight: { x: 1, y: 1 },\n}\n\n/** @internal */\nexport const DOUBLE_CLICK_DURATION = 450\n/** @internal */\nexport const MULTI_CLICK_DURATION = 200\n\n/** @internal */\nexport const DRAG_DISTANCE = 4\n\n/** @internal */\nexport const SVG_PADDING = 32\n\n/** @internal */\nexport const HASH_PATERN_ZOOM_NAMES: Record<string, string> = {}\n\nfor (let zoom = 1; zoom <= Math.ceil(MAX_ZOOM); zoom++) {\n\tHASH_PATERN_ZOOM_NAMES[zoom + '_dark'] = `hash_pattern_zoom_${zoom}_dark`\n\tHASH_PATERN_ZOOM_NAMES[zoom + '_light'] = `hash_pattern_zoom_${zoom}_light`\n}\n\n/** @internal */\nexport const DEFAULT_ANIMATION_OPTIONS = {\n\tduration: 0,\n\teasing: EASINGS.easeInOutCubic,\n}\n\n/** @internal */\nexport const HAND_TOOL_FRICTION = 0.09\n\n/** @internal */\nexport const MIN_ARROW_LENGTH = 48\n/** @internal */\nexport const BOUND_ARROW_OFFSET = 10\n/** @internal */\nexport const WAY_TOO_BIG_ARROW_BEND_FACTOR = 10\n\n/** @internal */\nexport const DEFAULT_BOOKMARK_WIDTH = 300\n\n/** @internal */\nexport const DEFAULT_BOOKMARK_HEIGHT = 320\n\n/** @public */\nexport const ROTATING_SHADOWS = [\n\t{\n\t\toffsetX: 0,\n\t\toffsetY: 2,\n\t\tblur: 4,\n\t\tspread: 0,\n\t\tcolor: '#00000029',\n\t},\n\t{\n\t\toffsetX: 0,\n\t\toffsetY: 3,\n\t\tblur: 6,\n\t\tspread: 0,\n\t\tcolor: '#0000001f',\n\t},\n]\n\n/** @public */\nexport const GRID_STEPS = [\n\t{ min: -1, mid: 0.15, step: 100 },\n\t{ min: 0.05, mid: 0.375, step: 25 },\n\t{ min: 0.15, mid: 1, step: 5 },\n\t{ min: 0.7, mid: 2.5, step: 1 },\n]\n\n/** @public */\nexport const TEXT_PROPS = {\n\tlineHeight: 1.35,\n\tfontWeight: 'normal',\n\tfontVariant: 'normal',\n\tfontStyle: 'normal',\n\tpadding: '0px',\n\tmaxWidth: 'auto',\n}\n\n/** @public */\nexport const FONT_SIZES: Record<TLSizeType, number> = {\n\ts: 18,\n\tm: 24,\n\tl: 36,\n\txl: 44,\n}\n\n/** @public */\nexport const LABEL_FONT_SIZES: Record<TLSizeType, number> = {\n\ts: 18,\n\tm: 22,\n\tl: 26,\n\txl: 32,\n}\n\n/** @public */\nexport const ARROW_LABEL_FONT_SIZES: Record<TLSizeType, number> = {\n\ts: 18,\n\tm: 20,\n\tl: 24,\n\txl: 28,\n}\n\n/** @public */\nexport const ICON_SIZES: Record<TLSizeType, number> = {\n\ts: 16,\n\tm: 32,\n\tl: 48,\n\txl: 64,\n}\n\n/** @public */\nexport const FONT_FAMILIES: Record<TLFontType, string> = {\n\tdraw: 'var(--rs-font-draw)',\n\tsans: 'var(--rs-font-sans)',\n\tserif: 'var(--rs-font-serif)',\n\tmono: 'var(--rs-font-mono)',\n}\n\n/** @public */\nexport const FONT_ALIGNMENT: Record<TLAlignType, string> = {\n\tmiddle: 'center',\n\tstart: 'left',\n\tend: 'right',\n\tjustify: 'justify',\n}\n\n/** @public */\nexport const STYLES: TLStyleCollections = {\n\tcolor: [\n\t\t{ id: 'black', type: 'color', icon: 'color' },\n\t\t{ id: 'grey', type: 'color', icon: 'color' },\n\t\t{ id: 'light-violet', type: 'color', icon: 'color' },\n\t\t{ id: 'violet', type: 'color', icon: 'color' },\n\t\t{ id: 'blue', type: 'color', icon: 'color' },\n\t\t{ id: 'light-blue', type: 'color', icon: 'color' },\n\t\t{ id: 'yellow', type: 'color', icon: 'color' },\n\t\t{ id: 'orange', type: 'color', icon: 'color' },\n\t\t{ id: 'green', type: 'color', icon: 'color' },\n\t\t{ id: 'light-green', type: 'color', icon: 'color' },\n\t\t{ id: 'light-red', type: 'color', icon: 'color' },\n\t\t{ id: 'red', type: 'color', icon: 'color' },\n\t],\n\tfill: [\n\t\t{ id: 'none', type: 'fill', icon: 'fill-none' },\n\t\t{ id: 'semi', type: 'fill', icon: 'fill-semi' },\n\t\t{ id: 'solid', type: 'fill', icon: 'fill-solid' },\n\t\t{ id: 'pattern', type: 'fill', icon: 'fill-pattern' },\n\t],\n\tdash: [\n\t\t{ id: 'draw', type: 'dash', icon: 'dash-draw' },\n\t\t{ id: 'dashed', type: 'dash', icon: 'dash-dashed' },\n\t\t{ id: 'dotted', type: 'dash', icon: 'dash-dotted' },\n\t\t{ id: 'solid', type: 'dash', icon: 'dash-solid' },\n\t],\n\tsize: [\n\t\t{ id: 's', type: 'size', icon: 'size-small' },\n\t\t{ id: 'm', type: 'size', icon: 'size-medium' },\n\t\t{ id: 'l', type: 'size', icon: 'size-large' },\n\t\t{ id: 'xl', type: 'size', icon: 'size-extra-large' },\n\t],\n\topacity: [\n\t\t{ id: '0.1', type: 'opacity', icon: 'color' },\n\t\t{ id: '0.25', type: 'opacity', icon: 'color' },\n\t\t{ id: '0.5', type: 'opacity', icon: 'color' },\n\t\t{ id: '0.75', type: 'opacity', icon: 'color' },\n\t\t{ id: '1', type: 'opacity', icon: 'color' },\n\t],\n\tfont: [\n\t\t{ id: 'draw', type: 'font', icon: 'font-draw' },\n\t\t{ id: 'sans', type: 'font', icon: 'font-sans' },\n\t\t{ id: 'serif', type: 'font', icon: 'font-serif' },\n\t\t{ id: 'mono', type: 'font', icon: 'font-mono' },\n\t],\n\talign: [\n\t\t{ id: 'start', type: 'align', icon: 'text-align-left' },\n\t\t{ id: 'middle', type: 'align', icon: 'text-align-center' },\n\t\t{ id: 'end', type: 'align', icon: 'text-align-right' },\n\t\t{ id: 'justify', type: 'align', icon: 'text-align-justify' },\n\t],\n\tgeo: [\n\t\t{ id: 'rectangle', type: 'geo', icon: 'geo-rectangle' },\n\t\t{ id: 'ellipse', type: 'geo', icon: 'geo-ellipse' },\n\t\t{ id: 'triangle', type: 'geo', icon: 'geo-triangle' },\n\t\t{ id: 'diamond', type: 'geo', icon: 'geo-diamond' },\n\t\t{ id: 'pentagon', type: 'geo', icon: 'geo-pentagon' },\n\t\t{ id: 'hexagon', type: 'geo', icon: 'geo-hexagon' },\n\t\t{ id: 'octagon', type: 'geo', icon: 'geo-octagon' },\n\t\t{ id: 'star', type: 'geo', icon: 'geo-star' },\n\t\t{ id: 'rhombus', type: 'geo', icon: 'geo-rhombus' },\n\t\t{ id: 'rhombus-2', type: 'geo', icon: 'geo-rhombus-2' },\n\t\t{ id: 'oval', type: 'geo', icon: 'geo-oval' },\n\t\t{ id: 'trapezoid', type: 'geo', icon: 'geo-trapezoid' },\n\t\t{ id: 'arrow-right', type: 'geo', icon: 'geo-arrow-right' },\n\t\t{ id: 'arrow-left', type: 'geo', icon: 'geo-arrow-left' },\n\t\t{ id: 'arrow-up', type: 'geo', icon: 'geo-arrow-up' },\n\t\t{ id: 'arrow-down', type: 'geo', icon: 'geo-arrow-down' },\n\t\t{ id: 'x-box', type: 'geo', icon: 'geo-x-box' },\n\t],\n\tarrowheadStart: [\n\t\t{ id: 'none', type: 'arrowheadStart', icon: 'arrowhead-none' },\n\t\t{ id: 'arrow', type: 'arrowheadStart', icon: 'arrowhead-arrow' },\n\t\t{ id: 'triangle', type: 'arrowheadStart', icon: 'arrowhead-triangle' },\n\t\t{ id: 'square', type: 'arrowheadStart', icon: 'arrowhead-square' },\n\t\t{ id: 'dot', type: 'arrowheadStart', icon: 'arrowhead-dot' },\n\t\t{ id: 'diamond', type: 'arrowheadStart', icon: 'arrowhead-diamond' },\n\t\t{ id: 'inverted', type: 'arrowheadStart', icon: 'arrowhead-triangle-inverted' },\n\t\t{ id: 'bar', type: 'arrowheadStart', icon: 'arrowhead-bar' },\n\t],\n\tarrowheadEnd: [\n\t\t{ id: 'none', type: 'arrowheadEnd', icon: 'arrowhead-none' },\n\t\t{ id: 'arrow', type: 'arrowheadEnd', icon: 'arrowhead-arrow' },\n\t\t{ id: 'triangle', type: 'arrowheadEnd', icon: 'arrowhead-triangle' },\n\t\t{ id: 'square', type: 'arrowheadEnd', icon: 'arrowhead-square' },\n\t\t{ id: 'dot', type: 'arrowheadEnd', icon: 'arrowhead-dot' },\n\t\t{ id: 'diamond', type: 'arrowheadEnd', icon: 'arrowhead-diamond' },\n\t\t{ id: 'inverted', type: 'arrowheadEnd', icon: 'arrowhead-triangle-inverted' },\n\t\t{ id: 'bar', type: 'arrowheadEnd', icon: 'arrowhead-bar' },\n\t],\n\tspline: [\n\t\t{ id: 'line', type: 'spline', icon: 'spline-line' },\n\t\t{ id: 'cubic', type: 'spline', icon: 'spline-cubic' },\n\t],\n}\n","import React from 'react'\nimport { EffectScheduler } from 'signia'\n\n/** @internal */\nexport function useStateTracking<T>(name: string, render: () => T): T {\n\t// user render is only called at the bottom of this function, indirectly via scheduler.execute()\n\t// we need it to always be up-to-date when calling scheduler.execute() but it'd be wasteful to\n\t// instantiate a new EffectScheduler on every render, so we use an immediately-updated ref\n\t// to wrap it\n\tconst renderRef = React.useRef(render)\n\trenderRef.current = render\n\n\tconst [scheduler, subscribe, getSnapshot] = React.useMemo(() => {\n\t\tlet scheduleUpdate = null as null | (() => void)\n\t\t// useSyncExternalStore requires a subscribe function that returns an unsubscribe function\n\t\tconst subscribe = (cb: () => void) => {\n\t\t\tscheduleUpdate = cb\n\t\t\treturn () => {\n\t\t\t\tscheduleUpdate = null\n\t\t\t}\n\t\t}\n\n\t\tconst scheduler = new EffectScheduler(\n\t\t\t`useStateTracking(${name})`,\n\t\t\t// this is what `scheduler.execute()` will call\n\t\t\t() => renderRef.current?.(),\n\t\t\t// this is what will be invoked when signia detects a change in an upstream reactive value\n\t\t\t{\n\t\t\t\tscheduleEffect() {\n\t\t\t\t\tscheduleUpdate?.()\n\t\t\t\t},\n\t\t\t}\n\t\t)\n\n\t\t// we use an incrementing number based on when this\n\t\tconst getSnapshot = () => scheduler.scheduleCount\n\n\t\treturn [scheduler, subscribe, getSnapshot]\n\t}, [name])\n\n\tReact.useSyncExternalStore(subscribe, getSnapshot, getSnapshot)\n\n\t// reactive dependencies are captured when `scheduler.execute()` is called\n\t// and then to make it reactive we wait for a `useEffect` to 'attach'\n\t// this allows us to avoid rendering outside of React's render phase\n\t// and avoid 'zombie' components that try to render with bad/deleted data before\n\t// react has a chance to umount them.\n\tReact.useEffect(() => {\n\t\tscheduler.attach()\n\t\t// do not execute, we only do that in render\n\t\tscheduler.maybeScheduleEffect()\n\t\treturn () => {\n\t\t\tscheduler.detach()\n\t\t}\n\t}, [scheduler])\n\n\treturn scheduler.execute()\n}\n","import React, { forwardRef, FunctionComponent, memo } from 'react'\nimport { useStateTracking } from './useStateTracking.js'\n\nexport const ProxyHandlers = {\n\t/**\n\t * This is a function call trap for functional components. When this is called, we know it means\n\t * React did run 'Component()', that means we can use any hooks here to setup our effect and\n\t * store.\n\t *\n\t * With the native Proxy, all other calls such as access/setting to/of properties will be\n\t * forwarded to the target Component, so we don't need to copy the Component's own or inherited\n\t * properties.\n\t *\n\t * @see https://github.com/facebook/react/blob/2d80a0cd690bb5650b6c8a6c079a87b5dc42bd15/packages/react-reconciler/src/ReactFiberHooks.old.js#L460\n\t */\n\tapply(Component: FunctionComponent, thisArg: any, argumentsList: any) {\n\t\treturn useStateTracking(Component.displayName ?? Component.name ?? 'tracked(???)', () =>\n\t\t\tComponent.apply(thisArg, argumentsList)\n\t\t)\n\t},\n}\n\nexport const ReactMemoSymbol = Symbol.for('react.memo')\nexport const ReactForwardRefSymbol = Symbol.for('react.forward_ref')\n\n/**\n * Returns a tracked version of the given component.\n * Any signals whose values are read while the component renders will be tracked.\n * If any of the tracked signals change later it will cause the component to re-render.\n *\n * This also wraps the component in a React.memo() call, so it will only re-render if the props change.\n *\n * @example\n * ```ts\n * const Counter = track(function Counter(props: CounterProps) {\n *   const count = useAtom('count', 0)\n *   const increment = useCallback(() => count.set(count.value + 1), [count])\n *   return <button onClick={increment}>{count.value}</button>\n * })\n * ```\n *\n * @param baseComponent\n * @public\n */\nexport function track<T extends FunctionComponent<any>>(\n\tbaseComponent: T\n): T extends React.MemoExoticComponent<any> ? T : React.MemoExoticComponent<T> {\n\tlet compare = null\n\tconst $$typeof = baseComponent['$$typeof' as keyof typeof baseComponent]\n\tif ($$typeof === ReactMemoSymbol) {\n\t\tbaseComponent = (baseComponent as any).type\n\t\tcompare = (baseComponent as any).compare\n\t}\n\tif ($$typeof === ReactForwardRefSymbol) {\n\t\treturn memo(forwardRef(new Proxy((baseComponent as any).render, ProxyHandlers) as any)) as any\n\t}\n\n\treturn memo(new Proxy(baseComponent, ProxyHandlers) as any, compare) as any\n}\n","import { useMemo } from 'react'\nimport { atom, Atom, AtomOptions } from 'signia'\n\n/**\n * Creates a new atom and returns it. The atom will be created only once.\n *\n * See [[signia.atom]]\n *\n * @example\n * ```ts\n * const Counter = track(function Counter () {\n *   const count = useAtom('count', 0)\n *   const increment = useCallback(() => count.set(count.value + 1), [count])\n *   return <button onClick={increment}>{count.value}</button>\n * })\n * ```\n *\n * @public\n */\nexport function useAtom<Value, Diff = unknown>(\n\t/**\n\t * The name of the atom. This does not need to be globally unique. It is used for debugging and performance profiling.\n\t */\n\tname: string,\n\t/**\n\t * The initial value of the atom. If this is a function, it will be called to get the initial value.\n\t */\n\tvalueOrInitialiser: Value | (() => Value),\n\t/**\n\t * Options for the atom.\n\t */\n\toptions?: AtomOptions<Value, Diff>\n): Atom<Value, Diff> {\n\treturn useMemo(() => {\n\t\tconst initialValue =\n\t\t\ttypeof valueOrInitialiser === 'function' ? (valueOrInitialiser as any)() : valueOrInitialiser\n\n\t\treturn atom(`useAtom(${name})`, initialValue, options)\n\t}, [])\n}\n","/* eslint-disable prefer-rest-params */\nimport { useMemo, useRef, useSyncExternalStore } from 'react'\nimport { computed, react, Signal } from 'signia'\n\n/**\n * Extracts the value from a signal and subscribes to it.\n *\n * Note that you do not need to use this hook if you are doing one of the following:\n *   - Wrapping the component with [[track]],\n * \t - Installing the jsx integration with [[signia-react-jsx.install]]\n *\n * @example\n * ```ts\n * const Counter: React.FC = () => {\n *   const $count = useAtom('count', 0)\n *   const increment = useCallback(() => $count.set($count.value + 1), [count])\n *   const currentCount = useValue($count)\n *   return <button onClick={increment}>{currentCount}</button>\n * }\n * ```\n *\n * You can also pass a function to compute the value and it will be memoized as in [[useComputed]]:\n *\n * @example\n * ```ts\n * type GreeterProps = {\n *   firstName: Signal<string>\n *   lastName: Signal<string>\n * }\n *\n * const Greeter = track(function Greeter({ firstName, lastName }: GreeterProps) {\n *   const fullName = useValue('fullName', () => `${firstName.value} ${lastName.value}`, [\n *     firstName,\n *     lastName,\n *   ])\n *   return <div>Hello {fullName}!</div>\n * })\n * ```\n *\n * @public\n */\nexport function useValue<Value>(value: Signal<Value>): Value\n/** @public */\nexport function useValue<Value>(name: string, fn: () => Value, deps: unknown[]): Value\n/** @public */\nexport function useValue() {\n\tconst args = arguments\n\t// deps will be either the computed or the deps array\n\tconst deps = args.length === 3 ? args[2] : [args[0]]\n\tconst name = args.length === 3 ? args[0] : `useValue(${args[0].name})`\n\n\tconst isInRender = useRef(true)\n\tisInRender.current = true\n\n\tconst $val = useMemo(() => {\n\t\tif (args.length === 1) {\n\t\t\treturn args[0]\n\t\t}\n\t\treturn computed(name, () => {\n\t\t\tif (isInRender.current) {\n\t\t\t\treturn args[1]()\n\t\t\t} else {\n\t\t\t\ttry {\n\t\t\t\t\treturn args[1]()\n\t\t\t\t} catch {\n\t\t\t\t\t// when getSnapshot is called outside of the render phase &\n\t\t\t\t\t// subsequently throws an error, it might be because we're\n\t\t\t\t\t// in a zombie-child state. in that case, we suppress the\n\t\t\t\t\t// error and instead return a new dummy value to trigger a\n\t\t\t\t\t// react re-render. if we were in a zombie child, react will\n\t\t\t\t\t// unmount us instead of re-rendering so the error is\n\t\t\t\t\t// irrelevant. if we're not in a zombie-child, react will\n\t\t\t\t\t// call `getSnapshot` again in the render phase, and the\n\t\t\t\t\t// error will be thrown as expected.\n\t\t\t\t\treturn {}\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\t}, deps)\n\n\ttry {\n\t\tconst { subscribe, getSnapshot } = useMemo(() => {\n\t\t\treturn {\n\t\t\t\tsubscribe: (listen: () => void) => {\n\t\t\t\t\treturn react(`useValue(${name})`, () => {\n\t\t\t\t\t\t$val.value\n\t\t\t\t\t\tlisten()\n\t\t\t\t\t})\n\t\t\t\t},\n\t\t\t\tgetSnapshot: () => $val.value,\n\t\t\t}\n\t\t}, [$val])\n\n\t\treturn useSyncExternalStore(subscribe, getSnapshot, getSnapshot)\n\t} finally {\n\t\tisInRender.current = false\n\t}\n}\n","// This file was copied and adapted with thanks from the preactjs/preact repo.\n// https://github.com/preactjs/signals/blob/main/packages/react/src/index.ts\n\n// The MIT License (MIT)\n\n// Copyright (c) 2022-present Preact Team\n\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n\n// The above copyright notice and this permission notice shall be included in all\n// copies or substantial portions of the Software.\n\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n// SOFTWARE.\n\nimport { Component, type FunctionComponent } from 'react'\nimport { track } from './track.js'\n\nconst ReactMemoType = Symbol.for('react.memo') // https://github.com/facebook/react/blob/346c7d4c43a0717302d446da9e7423a8e28d8996/packages/shared/ReactSymbols.js#L30\nconst ReactForwardRefType = Symbol.for('react.forward_ref')\nconst ProxyInstance = new WeakMap<FunctionComponent<any>, FunctionComponent<any>>()\n\nfunction proxyFunctionalComponent(Component: FunctionComponent<any>) {\n\tconst existing = ProxyInstance.get(Component)\n\tif (existing) return existing\n\tconst tracked = track(Component)\n\tProxyInstance.set(Component, tracked)\n\treturn tracked\n}\n\n/** @internal */\nexport function wrapJsx<T>(jsx: T): T {\n\tif (typeof jsx !== 'function') return jsx\n\n\treturn function (type: any, props: any, ...rest: any[]) {\n\t\tif (typeof type === 'function' && !(type instanceof Component)) {\n\t\t\ttype = proxyFunctionalComponent(type)\n\t\t} else if (type && typeof type === 'object') {\n\t\t\tif (type.$$typeof === ReactMemoType) {\n\t\t\t\ttype = proxyFunctionalComponent(type.type)\n\t\t\t} else if (type.$$typeof === ReactForwardRefType) {\n\t\t\t\ttype = proxyFunctionalComponent(type)\n\t\t\t}\n\t\t}\n\n\t\treturn jsx.call(jsx, type, props, ...rest)\n\t} as any as T\n}\n","import React from 'react'\nimport { App } from '../app/App'\n\nexport const AppContext = React.createContext({} as App)\n\n/** @public */\nexport const useApp = (): App => {\n\treturn React.useContext(AppContext)\n}\n","/** @public */\nexport class WeakMapCache<T extends object, K> {\n\titems = new WeakMap<T, K>()\n\n\tget<P extends T>(item: P, cb: (item: P) => K) {\n\t\tif (!this.items.has(item)) {\n\t\t\tthis.items.set(item, cb(item))\n\t\t}\n\t\treturn this.items.get(item)!\n\t}\n\n\taccess(item: T) {\n\t\treturn this.items.get(item)\n\t}\n\n\tset(item: T, value: K) {\n\t\tthis.items.set(item, value)\n\t}\n\n\thas(item: T) {\n\t\treturn this.items.has(item)\n\t}\n\n\tinvalidate(item: T) {\n\t\tthis.items.delete(item)\n\t}\n\n\tbust() {\n\t\tthis.items = new WeakMap()\n\t}\n}\n","import { atom, Atom, react } from 'signia'\n\n// --- 1. DEFINE ---\n// Define your debug flags here. Call `createDebugValue` with the name you want\n// your value to be available as on `window` and the initial value. If you don't\n// want your value to be stored in session storage, pass `false` as the 3rd arg\n\n/** @internal */\nexport const debugFlags = {\n\tpreventDefaultLogging: createDebugValue('tldrawPreventDefaultLogging', false),\n\tpointerCaptureLogging: createDebugValue('tldrawPointerCaptureLogging', false),\n\tpointerCaptureTracking: createDebugValue('tldrawPointerCaptureTracking', false),\n\tpointerCaptureTrackingObject: createDebugValue(\n\t\t'tldrawPointerCaptureTrackingObject',\n\t\t// ideally we wouldn't store this mutable value in an atom but it's not\n\t\t// a big deal for debug values\n\t\tnew Map<Element, number>(),\n\t\tfalse\n\t),\n\telementRemovalLogging: createDebugValue('tldrawElementRemovalLogging', false),\n\tdebugSvg: createDebugValue('tldrawDebugSvg', false),\n\tthrowToBlob: createDebugValue('tldrawThrowToBlob', false),\n\tpeopleMenu: createDebugValue('tldrawPeopleMenu', false),\n}\n\n// --- 2. USE ---\n// In normal code, read from debug flags directly by calling .get() on them:\n//    if (debugFlags.preventDefaultLogging.get()) { ... }\n//\n// In react, wrap your reads in `useDerivedValue` so they react to changes:\n//    const shouldLog = useDerivedValue(() => debugFlags.preventDefaultLogging.get())\n\n// --- 3. GET FUNKY ---\n// If you need to do fun stuff like monkey-patching in response to flag changes,\n// add that here. Make sure you wrap your code in `react` so it runs\n// automatically when values change!\n\nif (typeof Element !== 'undefined') {\n\tconst nativeElementRemoveChild = Element.prototype.removeChild\n\treact('element removal logging', () => {\n\t\tif (debugFlags.elementRemovalLogging.value) {\n\t\t\tElement.prototype.removeChild = function <T extends Node>(this: any, child: Node): T {\n\t\t\t\tconsole.warn('[tldraw] removing child:', child)\n\t\t\t\treturn nativeElementRemoveChild.call(this, child) as T\n\t\t\t}\n\t\t} else {\n\t\t\tElement.prototype.removeChild = nativeElementRemoveChild\n\t\t}\n\t})\n}\n\n// --- IMPLEMENTATION ---\n// you probably don't need to read this if you're just using the debug values system\nfunction createDebugValue<T>(name: string, initialValue: T, shouldStore = true): Atom<T> {\n\tif (typeof window === 'undefined') {\n\t\treturn atom(`debug:${name}`, initialValue)\n\t}\n\n\tconst storedValue = shouldStore ? (getStoredInitialValue(name) as T | null) : null\n\tconst value = atom(`debug:${name}`, storedValue ?? initialValue)\n\n\tif (shouldStore) {\n\t\treact(`debug:${name}`, () => {\n\t\t\tconst currentValue = value.value\n\t\t\ttry {\n\t\t\t\tif (currentValue === initialValue) {\n\t\t\t\t\twindow.sessionStorage.removeItem(`debug:${name}`)\n\t\t\t\t} else {\n\t\t\t\t\twindow.sessionStorage.setItem(`debug:${name}`, JSON.stringify(currentValue))\n\t\t\t\t}\n\t\t\t} catch {\n\t\t\t\t// not a big deal\n\t\t\t}\n\t\t})\n\t}\n\n\tObject.defineProperty(window, name, {\n\t\tget() {\n\t\t\treturn value.value\n\t\t},\n\t\tset(newValue) {\n\t\t\tvalue.set(newValue)\n\t\t},\n\t\tconfigurable: true,\n\t})\n\n\treturn value\n}\n\nfunction getStoredInitialValue(name: string) {\n\ttry {\n\t\treturn JSON.parse(window.sessionStorage.getItem(`debug:${name}`) ?? 'null')\n\t} catch (err) {\n\t\treturn null\n\t}\n}\n","import { TLGeoShape, TLNoteShape, TLShape } from '@tldraw/tlschema'\nimport { debugFlags } from './debug-flags'\n\n/** @public */\nexport type TLCopyType = 'svg' | 'png' | 'jpeg' | 'json'\n\n/** @public */\nexport type TLExportType = 'svg' | 'png' | 'jpeg' | 'webp' | 'json'\n\n/** @public */\nexport function getSvgAsString(svg: SVGElement) {\n\tconst clone = svg.cloneNode(true) as SVGGraphicsElement\n\n\tsvg.setAttribute('width', +svg.getAttribute('width')! + '')\n\tsvg.setAttribute('height', +svg.getAttribute('height')! + '')\n\n\tconst out = new XMLSerializer()\n\t\t.serializeToString(clone)\n\t\t.replaceAll('&#10;      ', '')\n\t\t.replaceAll(/((\\s|\")[0-9]*\\.[0-9]{2})([0-9]*)(\\b|\"|\\))/g, '$1')\n\n\treturn out\n}\n\n/** @public */\nexport async function getSvgAsImage(\n\tsvg: SVGElement,\n\toptions: {\n\t\ttype: TLCopyType | TLExportType\n\t\tquality: number\n\t\tscale: number\n\t}\n) {\n\tconst { type, quality, scale } = options\n\n\tconst width = +svg.getAttribute('width')!\n\tconst height = +svg.getAttribute('height')!\n\n\tconst dataUrl = await getSvgAsDataUrl(svg)\n\n\tconst canvas = await new Promise<HTMLCanvasElement | null>((resolve) => {\n\t\tconst image = new Image()\n\t\timage.crossOrigin = 'anonymous'\n\n\t\timage.onload = async () => {\n\t\t\t// safari will fire `onLoad` before the fonts in the SVG are\n\t\t\t// actually loaded. just waiting around a while is brittle, but\n\t\t\t// there doesn't seem to be any better solution for now :( see\n\t\t\t// https://bugs.webkit.org/show_bug.cgi?id=219770\n\t\t\tawait new Promise((resolve) => setTimeout(resolve, 250))\n\n\t\t\tconst canvas = document.createElement('canvas') as HTMLCanvasElement\n\t\t\tconst ctx = canvas.getContext('2d')!\n\n\t\t\tcanvas.width = width * scale\n\t\t\tcanvas.height = height * scale\n\n\t\t\tctx.imageSmoothingEnabled = true\n\t\t\tctx.imageSmoothingQuality = 'high'\n\t\t\tctx.drawImage(image, 0, 0, width * scale, height * scale)\n\n\t\t\tURL.revokeObjectURL(dataUrl)\n\n\t\t\tresolve(canvas)\n\t\t}\n\n\t\timage.onerror = () => {\n\t\t\tresolve(null)\n\t\t}\n\n\t\timage.src = dataUrl\n\t})\n\n\tif (!canvas) return null\n\n\tconst blob = await new Promise<Blob | null>((resolve) =>\n\t\tcanvas.toBlob(\n\t\t\t(blob) => {\n\t\t\t\tif (!blob || debugFlags.throwToBlob.value) {\n\t\t\t\t\tresolve(null)\n\t\t\t\t}\n\t\t\t\tresolve(blob)\n\t\t\t},\n\t\t\t'image/' + type,\n\t\t\tquality\n\t\t)\n\t)\n\n\treturn blob\n}\n\n/** @public */\nexport async function getSvgAsDataUrl(svg: SVGElement) {\n\tconst clone = svg.cloneNode(true) as SVGGraphicsElement\n\tclone.setAttribute('encoding', 'UTF-8\"')\n\n\tconst fileReader = new FileReader()\n\tconst imgs = Array.from(clone.querySelectorAll('image')) as SVGImageElement[]\n\n\tfor (const img of imgs) {\n\t\tconst src = img.getAttribute('xlink:href')\n\t\tif (src) {\n\t\t\tif (!src.startsWith('data:')) {\n\t\t\t\tconst blob = await (await fetch(src)).blob()\n\t\t\t\tconst base64 = await new Promise<string>((resolve, reject) => {\n\t\t\t\t\tfileReader.onload = () => resolve(fileReader.result as string)\n\t\t\t\t\tfileReader.onerror = () => reject(fileReader.error)\n\t\t\t\t\tfileReader.readAsDataURL(blob)\n\t\t\t\t})\n\t\t\t\timg.setAttribute('xlink:href', base64)\n\t\t\t}\n\t\t}\n\t}\n\n\treturn getSvgAsDataUrlSync(clone)\n}\n\n/** @public */\nexport function getSvgAsDataUrlSync(node: SVGElement) {\n\tconst svgStr = new XMLSerializer().serializeToString(node)\n\t// NOTE: `unescape` works everywhere although deprecated\n\tconst base64SVG = window.btoa(unescape(encodeURIComponent(svgStr)))\n\treturn `data:image/svg+xml;base64,${base64SVG}`\n}\n\n/** @public */\nexport function downloadDataURLAsFile(dataUrl: string, filename: string) {\n\tconst link = document.createElement('a')\n\tlink.href = dataUrl\n\tlink.download = filename\n\tlink.click()\n}\n\n/** @public */\nexport function getTextBoundingBox(text: SVGTextElement) {\n\tconst svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg')\n\tsvg.appendChild(text)\n\n\tdocument.body.appendChild(svg)\n\tconst bbox = text.getBoundingClientRect()\n\tdocument.body.removeChild(svg)\n\n\treturn bbox\n}\n\n/** @public */\nexport function isGeoShape(shape: TLShape): shape is TLGeoShape {\n\treturn shape.type === 'geo'\n}\n\n/** @public */\nexport function isNoteShape(shape: TLShape): shape is TLNoteShape {\n\treturn shape.type === 'note'\n}\n","// =========================\n// Modified code originally from <https://github.com/qzb/is-animated>\n//\n// # [MIT License](https://spdx.org/licenses/MIT)\n//\n// Copyright (c) 2016 Jzef Sokoowski <j.k.sokolowski@gmail.com>\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"Software\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n// =========================\n\n/**\n * Returns total length of data blocks sequence\n */\nfunction getDataBlocksLength(buffer: Uint8Array, offset: number): number {\n\tlet length = 0\n\n\twhile (buffer[offset + length]) {\n\t\tlength += buffer[offset + length] + 1\n\t}\n\n\treturn length + 1\n}\n\n/**\n * Checks if buffer contains GIF image\n * @public\n */\nexport function isGIF(buffer: ArrayBuffer): boolean {\n\tconst enc = new TextDecoder('ascii')\n\tconst header = enc.decode(buffer.slice(0, 3))\n\treturn header === 'GIF'\n}\n\n/**\n * Checks if buffer contains animated GIF image\n * @public\n */\nexport function isAnimated(buffer: ArrayBuffer): boolean {\n\tconst view = new Uint8Array(buffer)\n\tlet hasColorTable, colorTableSize\n\tlet offset = 0\n\tlet imagesCount = 0\n\n\t// Check if this is this image has valid GIF header.\n\t// If not return false. Chrome, FF and IE doesn't handle GIFs with invalid version.\n\tif (!isGIF(buffer)) {\n\t\treturn false\n\t}\n\n\t// Skip header, logical screen descriptor and global color table\n\n\thasColorTable = view[10] & 0x80 // 0b10000000\n\tcolorTableSize = view[10] & 0x07 // 0b00000111\n\n\toffset += 6 // skip header\n\toffset += 7 // skip logical screen descriptor\n\toffset += hasColorTable ? 3 * Math.pow(2, colorTableSize + 1) : 0 // skip global color table\n\n\t// Find if there is more than one image descriptor\n\n\twhile (imagesCount < 2 && offset < view.length) {\n\t\tswitch (view[offset]) {\n\t\t\t// Image descriptor block. According to specification there could be any\n\t\t\t// number of these blocks (even zero). When there is more than one image\n\t\t\t// descriptor browsers will display animation (they shouldn't when there\n\t\t\t// is no delays defined, but they do it anyway).\n\t\t\tcase 0x2c:\n\t\t\t\timagesCount += 1\n\n\t\t\t\thasColorTable = view[offset + 9] & 0x80 // 0b10000000\n\t\t\t\tcolorTableSize = view[offset + 9] & 0x07 // 0b00000111\n\n\t\t\t\toffset += 10 // skip image descriptor\n\t\t\t\toffset += hasColorTable ? 3 * Math.pow(2, colorTableSize + 1) : 0 // skip local color table\n\t\t\t\toffset += getDataBlocksLength(view, offset + 1) + 1 // skip image data\n\n\t\t\t\tbreak\n\n\t\t\t// Skip all extension blocks. In theory this \"plain text extension\" blocks\n\t\t\t// could be frames of animation, but no browser renders them.\n\t\t\tcase 0x21:\n\t\t\t\toffset += 2 // skip introducer and label\n\t\t\t\toffset += getDataBlocksLength(view, offset) // skip this block and following data blocks\n\n\t\t\t\tbreak\n\n\t\t\t// Stop processing on trailer block,\n\t\t\t// all data after this point will is ignored by decoders\n\t\t\tcase 0x3b:\n\t\t\t\toffset = view.length // fast forward to end of buffer\n\t\t\t\tbreak\n\n\t\t\t// Oops! This GIF seems to be invalid\n\t\t\tdefault:\n\t\t\t\t// fast forward to end of buffer\n\t\t\t\toffset = view.length\n\t\t\t\tbreak\n\t\t}\n\t}\n\n\treturn imagesCount > 1\n}\n","import { Box2d, Vec2d, VecLike } from '@tldraw/primitives'\nimport {\n\tTLAsset,\n\tTLAssetId,\n\tTLAssetShape,\n\tTLBookmarkAsset,\n\tTLImageShape,\n\tTLShape,\n\tTLShapePartial,\n\tTLVideoShape,\n\tVec2dModel,\n\tcreateShapeId,\n} from '@tldraw/tlschema'\nimport { compact, getHashForString, isNonNullish } from '@tldraw/utils'\nimport uniq from 'lodash.uniq'\nimport { App } from '../app/App'\nimport { MAX_ASSET_HEIGHT, MAX_ASSET_WIDTH } from '../constants'\nimport { getSvgAsDataUrlSync } from './export'\nimport { isAnimated } from './is-gif-animated'\n\n/** @public */\nexport const ACCEPTED_IMG_TYPE = ['image/jpeg', 'image/png', 'image/gif', 'image/svg+xml']\n/** @public */\nexport const ACCEPTED_VID_TYPE = ['video/mp4', 'video/quicktime']\n/** @public */\nexport const ACCEPTED_ASSET_TYPE = ACCEPTED_IMG_TYPE.concat(ACCEPTED_VID_TYPE).join(', ')\n\n/** @public */\nexport const isImage = (ext: string) => ACCEPTED_IMG_TYPE.includes(ext)\n\n/**\n * Get the size of a video from its source.\n *\n * @param src - The source of the video.\n * @public\n */\nexport async function getVideoSizeFromSrc(src: string): Promise<{ w: number; h: number }> {\n\treturn await new Promise((resolve, reject) => {\n\t\tconst video = document.createElement('video')\n\t\tvideo.onloadeddata = () => resolve({ w: video.videoWidth, h: video.videoHeight })\n\t\tvideo.onerror = (e) => {\n\t\t\tconsole.error(e)\n\t\t\treject(new Error('Could not get video size'))\n\t\t}\n\t\tvideo.crossOrigin = 'anonymous'\n\t\tvideo.src = src\n\t})\n}\n\n/**\n * Get the size of an image from its source.\n *\n * @param dataURL - The file as a string.\n * @public\n */\nexport async function getImageSizeFromSrc(dataURL: string): Promise<{ w: number; h: number }> {\n\treturn await new Promise((resolve, reject) => {\n\t\tconst img = new Image()\n\t\timg.onload = () => resolve({ w: img.width, h: img.height })\n\t\timg.onerror = (err) => {\n\t\t\tconsole.error(err)\n\t\t\treject(new Error('Could not get image size'))\n\t\t}\n\t\timg.crossOrigin = 'anonymous'\n\t\timg.src = dataURL\n\t})\n}\n\n/**\n * Get the size of an image from its source.\n *\n * @param dataURLForImage - The image file as a string.\n * @param width - The desired width.\n * @param height - The desired height.\n * @public\n */\nexport async function getResizedImageDataUrl(\n\tdataURLForImage: string,\n\twidth: number,\n\theight: number\n): Promise<string> {\n\treturn await new Promise((resolve) => {\n\t\tconst img = new Image()\n\t\timg.onload = () => {\n\t\t\t// Initialize the canvas and it's size\n\t\t\tconst canvas = document.createElement('canvas')\n\t\t\tconst ctx = canvas.getContext('2d')\n\n\t\t\tif (!ctx) return\n\n\t\t\t// Set width and height\n\t\t\tcanvas.width = width * 2\n\t\t\tcanvas.height = height * 2\n\n\t\t\t// Draw image and export to a data-uri\n\t\t\tctx.drawImage(img, 0, 0, canvas.width, canvas.height)\n\t\t\tconst newDataURL = canvas.toDataURL()\n\n\t\t\t// Do something with the result, like overwrite original\n\t\t\tresolve(newDataURL)\n\t\t}\n\t\timg.crossOrigin = 'anonymous'\n\t\timg.src = dataURLForImage\n\t})\n}\n\n/**\n * Get an asset from a file.\n *\n * @param file - The file.\n * @public\n * @returns An image or video asset partial.\n */\nexport async function getMediaAssetFromFile(file: File): Promise<TLAsset> {\n\treturn await new Promise((resolve, reject) => {\n\t\tconst reader = new FileReader()\n\t\treader.onerror = () => reject(reader.error)\n\t\treader.onload = async () => {\n\t\t\tlet dataUrl = reader.result as string\n\n\t\t\tconst isImageType = isImage(file.type)\n\t\t\tconst sizeFn = isImageType ? getImageSizeFromSrc : getVideoSizeFromSrc\n\n\t\t\t// Hack to make .mov videos work via dataURL.\n\t\t\tif (file.type === 'video/quicktime' && dataUrl.includes('video/quicktime')) {\n\t\t\t\tdataUrl = dataUrl.replace('video/quicktime', 'video/mp4')\n\t\t\t}\n\n\t\t\tconst originalSize = await sizeFn(dataUrl)\n\t\t\tconst size = containBoxSize(originalSize, { w: MAX_ASSET_WIDTH, h: MAX_ASSET_HEIGHT })\n\n\t\t\tif (size !== originalSize && (file.type === 'image/jpeg' || file.type === 'image/png')) {\n\t\t\t\t// If we created a new size and the type is an image, rescale the image\n\t\t\t\tdataUrl = await getResizedImageDataUrl(dataUrl, size.w, size.h)\n\t\t\t}\n\n\t\t\tconst assetId: TLAssetId = TLAsset.createCustomId(getHashForString(dataUrl))\n\n\t\t\tconst metadata = await getFileMetaData(file)\n\n\t\t\tconst asset: TLAsset = {\n\t\t\t\tid: assetId,\n\t\t\t\ttype: isImageType ? 'image' : 'video',\n\t\t\t\ttypeName: 'asset',\n\t\t\t\tprops: {\n\t\t\t\t\tname: file.name,\n\t\t\t\t\tsrc: dataUrl,\n\t\t\t\t\tw: size.w,\n\t\t\t\t\th: size.h,\n\t\t\t\t\tmimeType: file.type,\n\t\t\t\t\tisAnimated: metadata.isAnimated,\n\t\t\t\t},\n\t\t\t}\n\n\t\t\tresolve(asset)\n\t\t}\n\n\t\treader.readAsDataURL(file)\n\t})\n}\n\n/**\n * Get some metadata about the file\n *\n * @param file - The file.\n * @public\n */\nexport async function getFileMetaData(file: File): Promise<{ isAnimated: boolean }> {\n\tif (file.type === 'image/gif') {\n\t\treturn await new Promise((resolve, reject) => {\n\t\t\tconst reader = new FileReader()\n\t\t\treader.onerror = () => reject(reader.error)\n\t\t\treader.onload = () => {\n\t\t\t\tresolve({\n\t\t\t\t\tisAnimated: reader.result ? isAnimated(reader.result as ArrayBuffer) : false,\n\t\t\t\t})\n\t\t\t}\n\t\t\treader.readAsArrayBuffer(file)\n\t\t})\n\t}\n\n\treturn {\n\t\tisAnimated: isImage(file.type) ? false : true,\n\t}\n}\n\ntype BoxWidthHeight = {\n\tw: number\n\th: number\n}\n\n/**\n * Contains the size within the given box size\n *\n * @param originalSize - the size of the asset\n * @param containBoxSize - the container size\n * @returns adjusted size\n * @public\n */\nexport function containBoxSize(\n\toriginalSize: BoxWidthHeight,\n\tcontainBoxSize: BoxWidthHeight\n): BoxWidthHeight {\n\tconst overByXScale = originalSize.w / containBoxSize.w\n\tconst overByYScale = originalSize.h / containBoxSize.h\n\n\tif (overByXScale <= 1 && overByYScale <= 1) {\n\t\treturn originalSize\n\t} else if (overByXScale > overByYScale) {\n\t\treturn {\n\t\t\tw: originalSize.w / overByXScale,\n\t\t\th: originalSize.h / overByXScale,\n\t\t}\n\t} else {\n\t\treturn {\n\t\t\tw: originalSize.w / overByYScale,\n\t\t\th: originalSize.h / overByYScale,\n\t\t}\n\t}\n}\n\n/** @public */\nexport async function createShapesFromFiles(\n\tapp: App,\n\tfiles: File[],\n\tposition: VecLike,\n\t_ignoreParent = false\n) {\n\tconst pagePoint = new Vec2d(position.x, position.y)\n\n\tconst newAssetsForFiles = new Map<File, TLAsset>()\n\n\tconst shapePartials = await Promise.all(\n\t\tfiles.map(async (file, i) => {\n\t\t\t// Use mime type instead of file ext, this is because\n\t\t\t// window.navigator.clipboard does not preserve file names\n\t\t\t// of copied files.\n\t\t\tif (!file.type) throw new Error('No mime type')\n\n\t\t\t// We can only accept certain extensions (either images or a videos)\n\t\t\tif (!ACCEPTED_IMG_TYPE.concat(ACCEPTED_VID_TYPE).includes(file.type)) {\n\t\t\t\tconsole.warn(`${file.name} not loaded - Extension not allowed.`)\n\t\t\t\treturn null\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tconst asset = await app.onCreateAssetFromFile(file)\n\n\t\t\t\tif (asset.type === 'bookmark') return\n\n\t\t\t\tif (!asset) throw Error('Could not create an asset')\n\n\t\t\t\tnewAssetsForFiles.set(file, asset)\n\n\t\t\t\tconst shapePartial: TLShapePartial<TLImageShape | TLVideoShape> = {\n\t\t\t\t\tid: createShapeId(),\n\t\t\t\t\ttype: asset.type,\n\t\t\t\t\tx: pagePoint.x + i,\n\t\t\t\t\ty: pagePoint.y,\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tw: asset.props!.w,\n\t\t\t\t\t\th: asset.props!.h,\n\t\t\t\t\t\topacity: '1',\n\t\t\t\t\t},\n\t\t\t\t}\n\n\t\t\t\treturn shapePartial\n\t\t\t} catch (error) {\n\t\t\t\tconsole.error(error)\n\t\t\t\treturn null\n\t\t\t}\n\t\t})\n\t)\n\n\t// Filter any nullish values and sort the resulting models by x, so that the\n\t// left-most model is created first (and placed lowest in the z-order).\n\tconst results = compact(shapePartials).sort((a, b) => a.x! - b.x!)\n\n\tif (results.length === 0) return\n\n\t// Adjust the placement of the models.\n\tfor (let i = 0; i < results.length; i++) {\n\t\tconst model = results[i]\n\t\tif (i === 0) {\n\t\t\t// The first shape is placed so that its center is at the dropping point\n\t\t\tmodel.x! -= model.props!.w! / 2\n\t\t\tmodel.y! -= model.props!.h! / 2\n\t\t} else {\n\t\t\t// Later models are placed to the right of the first shape\n\t\t\tconst prevModel = results[i - 1]\n\t\t\tmodel.x = prevModel.x! + prevModel.props!.w!\n\t\t\tmodel.y = prevModel.y!\n\t\t}\n\t}\n\n\tconst shapeUpdates = await Promise.all(\n\t\tfiles.map(async (file, i) => {\n\t\t\tconst shape = results[i] as TLShapePartial<TLImageShape | TLVideoShape>\n\t\t\tif (!shape) return\n\n\t\t\tconst asset = newAssetsForFiles.get(file)\n\t\t\tif (!asset) return\n\n\t\t\t// Does the asset collection already have a model with this id\n\t\t\tlet existing: TLAsset | undefined = app.getAssetById(asset.id)\n\n\t\t\tif (existing) {\n\t\t\t\tnewAssetsForFiles.delete(file)\n\n\t\t\t\tif (shape.props) {\n\t\t\t\t\tshape.props.assetId = existing.id\n\t\t\t\t}\n\n\t\t\t\treturn shape as TLShape\n\t\t\t}\n\n\t\t\texisting = app.getAssetBySrc(asset.props!.src!)\n\n\t\t\tif (existing) {\n\t\t\t\tif (shape.props) {\n\t\t\t\t\tshape.props.assetId = existing.id\n\t\t\t\t}\n\n\t\t\t\treturn shape as TLAssetShape\n\t\t\t}\n\n\t\t\t// Create a new model for the new source file\n\t\t\tif (shape.props) {\n\t\t\t\tshape.props.assetId = asset.id\n\t\t\t}\n\n\t\t\treturn shape\n\t\t})\n\t)\n\n\tconst filteredUpdates = shapeUpdates.filter(isNonNullish)\n\n\tapp.createAssets(compact([...newAssetsForFiles.values()]))\n\tapp.createShapes(filteredUpdates)\n\tapp.setSelectedIds(filteredUpdates.map((s) => s.id))\n\n\tconst { selectedIds, viewportPageBounds } = app\n\n\tconst pageBounds = Box2d.Common(compact(selectedIds.map((id) => app.getPageBoundsById(id))))\n\n\tif (pageBounds && !viewportPageBounds.contains(pageBounds)) {\n\t\tapp.zoomToSelection()\n\t}\n}\n\n/** @public */\nexport function createEmbedShapeAtPoint(\n\tapp: App,\n\turl: string,\n\tpoint: Vec2dModel,\n\tprops: {\n\t\twidth?: number\n\t\theight?: number\n\t\tdoesResize?: boolean\n\t}\n) {\n\tapp.createShapes(\n\t\t[\n\t\t\t{\n\t\t\t\tid: createShapeId(),\n\t\t\t\ttype: 'embed',\n\t\t\t\tx: point.x - (props.width || 450) / 2,\n\t\t\t\ty: point.y - (props.height || 450) / 2,\n\t\t\t\tprops: {\n\t\t\t\t\tw: props.width,\n\t\t\t\t\th: props.height,\n\t\t\t\t\tdoesResize: props.doesResize,\n\t\t\t\t\turl,\n\t\t\t\t\topacity: '1',\n\t\t\t\t},\n\t\t\t},\n\t\t],\n\t\ttrue\n\t)\n}\n\n/**\n * Create a bookmark shape at a given point.\n *\n * @param app - The app to create the bookmark shape in.\n * @param url - The bookmark's url.\n * @param point - The point to insert the bookmark shape.\n * @public\n */\nexport async function createBookmarkShapeAtPoint(app: App, url: string, point: Vec2dModel) {\n\tconst assetId: TLAssetId = TLAsset.createCustomId(getHashForString(url))\n\tconst existing = app.getAssetById(assetId) as TLBookmarkAsset\n\n\tif (existing) {\n\t\tapp.createShapes([\n\t\t\t{\n\t\t\t\tid: app.createShapeId(),\n\t\t\t\ttype: 'bookmark',\n\t\t\t\tx: point.x - 150,\n\t\t\t\ty: point.y - 160,\n\t\t\t\tprops: {\n\t\t\t\t\tassetId: existing.id,\n\t\t\t\t\turl: existing.props.src!,\n\t\t\t\t\topacity: '1',\n\t\t\t\t},\n\t\t\t},\n\t\t])\n\t\treturn\n\t}\n\n\tapp.batch(async () => {\n\t\tconst shapeId = createShapeId()\n\n\t\tapp.createShapes(\n\t\t\t[\n\t\t\t\t{\n\t\t\t\t\tid: shapeId,\n\t\t\t\t\ttype: 'bookmark',\n\t\t\t\t\tx: point.x,\n\t\t\t\t\ty: point.y,\n\t\t\t\t\tprops: {\n\t\t\t\t\t\turl: url,\n\t\t\t\t\t\topacity: '1',\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t\ttrue\n\t\t)\n\n\t\tconst meta = await app.onCreateBookmarkFromUrl(url)\n\n\t\tif (meta) {\n\t\t\tapp.createAssets([\n\t\t\t\t{\n\t\t\t\t\tid: assetId,\n\t\t\t\t\ttypeName: 'asset',\n\t\t\t\t\ttype: 'bookmark',\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tsrc: url,\n\t\t\t\t\t\tdescription: meta.description,\n\t\t\t\t\t\timage: meta.image,\n\t\t\t\t\t\ttitle: meta.title,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t])\n\n\t\t\tapp.updateShapes([\n\t\t\t\t{\n\t\t\t\t\tid: shapeId,\n\t\t\t\t\ttype: 'bookmark',\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tassetId: assetId,\n\t\t\t\t\t\topacity: '1',\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t])\n\t\t}\n\t})\n}\n\n/** @public */\nexport function createAssetShapeAtPoint(app: App, svgString: string, point: Vec2dModel) {\n\tconst svg = new DOMParser().parseFromString(svgString, 'image/svg+xml').querySelector('svg')\n\tif (!svg) {\n\t\tthrow new Error('No <svg/> element present')\n\t}\n\tconst dataUrl = getSvgAsDataUrlSync(svg)\n\n\tlet width = parseFloat(svg.getAttribute('width') || '0')\n\tlet height = parseFloat(svg.getAttribute('height') || '0')\n\n\tif (!(width && height)) {\n\t\tdocument.body.appendChild(svg)\n\t\tconst box = svg.getBoundingClientRect()\n\t\tdocument.body.removeChild(svg)\n\n\t\twidth = box.width\n\t\theight = box.height\n\t}\n\n\tconst assetID: TLAssetId = TLAsset.createCustomId(getHashForString(dataUrl))\n\n\tapp.batch(() => {\n\t\tapp.createAssets([\n\t\t\t{\n\t\t\t\tid: assetID,\n\t\t\t\ttypeName: 'asset',\n\t\t\t\ttype: 'image',\n\t\t\t\tprops: {\n\t\t\t\t\tsrc: dataUrl,\n\t\t\t\t\tw: width,\n\t\t\t\t\th: height,\n\t\t\t\t\tname: 'svg',\n\t\t\t\t\tisAnimated: true,\n\t\t\t\t\tmimeType: 'image/svg+xml',\n\t\t\t\t},\n\t\t\t},\n\t\t])\n\n\t\tapp.createShapes(\n\t\t\t[\n\t\t\t\t{\n\t\t\t\t\tid: createShapeId(),\n\t\t\t\t\ttype: 'image',\n\t\t\t\t\tx: point.x - width / 2,\n\t\t\t\t\ty: point.y - height / 2,\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tassetId: assetID,\n\t\t\t\t\t\tw: width,\n\t\t\t\t\t\th: height,\n\t\t\t\t\t\topacity: '1',\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t\ttrue\n\t\t)\n\t})\n}\n\n/** @public */\nexport const isValidHttpURL = (url: string) => {\n\ttry {\n\t\tconst u = new URL(url)\n\t\treturn u.protocol === 'http:' || u.protocol === 'https:'\n\t} catch (e) {\n\t\treturn false\n\t}\n}\n\n/** @public */\nexport const getValidHttpURLList = (url: string) => {\n\tconst urls = url.split(/[\\n\\s]/)\n\tfor (const url of urls) {\n\t\ttry {\n\t\t\tconst u = new URL(url)\n\t\t\tif (!(u.protocol === 'http:' || u.protocol === 'https:')) {\n\t\t\t\treturn\n\t\t\t}\n\t\t} catch (e) {\n\t\t\treturn\n\t\t}\n\t}\n\treturn uniq(urls)\n}\n\n/** @public */\nexport const isSvgText = (text: string) => {\n\treturn /^<svg/.test(text)\n}\n\n/** @public */\nexport function dataUrlToFile(url: string, filename: string, mimeType: string) {\n\treturn fetch(url)\n\t\t.then(function (res) {\n\t\t\treturn res.arrayBuffer()\n\t\t})\n\t\t.then(function (buf) {\n\t\t\treturn new File([buf], filename, { type: mimeType })\n\t\t})\n}\n","import { clamp, Vec2d } from '@tldraw/primitives'\nimport {\n\tTLAlignType,\n\tTLArrowheadType,\n\tTLArrowShape,\n\tTLArrowTerminal,\n\tTLAsset,\n\tTLAssetId,\n\tTLColorType,\n\tTLDashType,\n\tTLDrawShape,\n\tTLFontType,\n\tTLGeoShape,\n\tTLImageShape,\n\tTLNoteShape,\n\tTLPage,\n\tTLPageId,\n\tTLShapeId,\n\tTLShapePartial,\n\tTLSizeType,\n\tTLTextShape,\n\tTLVideoShape,\n\tVec2dModel,\n} from '@tldraw/tlschema'\nimport { transact } from 'signia'\nimport { App } from '../app/App'\nimport { MAX_SHAPES_PER_PAGE } from '../constants'\n\nconst TLDRAW_V1_VERSION = 15.5\n\n/** @internal */\nexport function buildFromV1Document(app: App, document: LegacyTldrawDocument) {\n\ttransact(() => {\n\t\tdocument = migrate(document, TLDRAW_V1_VERSION)\n\t\t// Cancel any interactions / states\n\t\tapp.cancel().cancel().cancel().cancel()\n\n\t\tconst firstPageId = app.pages[0].id\n\n\t\t// Set the current page to the first page\n\t\tapp.setCurrentPageId(firstPageId)\n\n\t\t// Delete all pages except first page\n\t\tfor (const page of app.pages.slice(1)) {\n\t\t\tapp.deletePage(page.id)\n\t\t}\n\n\t\t// Delete all of the shapes on the current page\n\t\tapp.selectAll()\n\t\tapp.deleteShapes()\n\n\t\t// Create assets\n\t\tconst v1AssetIdsToV2AssetIds = new Map<string, TLAssetId>()\n\n\t\tObject.values(document.assets ?? {}).forEach((v1Asset) => {\n\t\t\tswitch (v1Asset.type) {\n\t\t\t\tcase TDAssetType.Image: {\n\t\t\t\t\tconst assetId: TLAssetId = TLAsset.createId()\n\t\t\t\t\tv1AssetIdsToV2AssetIds.set(v1Asset.id, assetId)\n\t\t\t\t\tconst placeholderAsset: TLAsset = {\n\t\t\t\t\t\tid: assetId,\n\t\t\t\t\t\ttypeName: 'asset',\n\t\t\t\t\t\ttype: 'image',\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\tw: coerceDimension(v1Asset.size[0]),\n\t\t\t\t\t\t\th: coerceDimension(v1Asset.size[1]),\n\t\t\t\t\t\t\tname: v1Asset.fileName ?? 'Untitled',\n\t\t\t\t\t\t\tisAnimated: false,\n\t\t\t\t\t\t\tmimeType: null,\n\t\t\t\t\t\t\tsrc: v1Asset.src,\n\t\t\t\t\t\t},\n\t\t\t\t\t}\n\t\t\t\t\tapp.createAssets([placeholderAsset])\n\t\t\t\t\ttryMigrateAsset(app, placeholderAsset)\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t\tcase TDAssetType.Video:\n\t\t\t\t\t{\n\t\t\t\t\t\tconst assetId: TLAssetId = TLAsset.createId()\n\t\t\t\t\t\tv1AssetIdsToV2AssetIds.set(v1Asset.id, assetId)\n\t\t\t\t\t\tapp.createAssets([\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tid: assetId,\n\t\t\t\t\t\t\t\ttypeName: 'asset',\n\t\t\t\t\t\t\t\ttype: 'video',\n\t\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\t\tw: coerceDimension(v1Asset.size[0]),\n\t\t\t\t\t\t\t\t\th: coerceDimension(v1Asset.size[1]),\n\t\t\t\t\t\t\t\t\tname: v1Asset.fileName ?? 'Untitled',\n\t\t\t\t\t\t\t\t\tisAnimated: true,\n\t\t\t\t\t\t\t\t\tmimeType: null,\n\t\t\t\t\t\t\t\t\tsrc: v1Asset.src,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t])\n\t\t\t\t\t}\n\t\t\t\t\tbreak\n\t\t\t}\n\t\t})\n\n\t\t// Create pages\n\n\t\tconst v1PageIdsToV2PageIds = new Map<string, TLPageId>()\n\n\t\tObject.values(document.pages ?? {})\n\t\t\t.sort((a, b) => ((a.childIndex ?? 1) < (b.childIndex ?? 1) ? -1 : 1))\n\t\t\t.forEach((v1Page, i) => {\n\t\t\t\tif (i === 0) {\n\t\t\t\t\tv1PageIdsToV2PageIds.set(v1Page.id, app.currentPageId)\n\t\t\t\t} else {\n\t\t\t\t\tconst pageId = TLPage.createId()\n\t\t\t\t\tv1PageIdsToV2PageIds.set(v1Page.id, pageId)\n\t\t\t\t\tapp.createPage(v1Page.name ?? 'Page', pageId)\n\t\t\t\t}\n\t\t\t})\n\n\t\tObject.values(document.pages ?? {})\n\t\t\t.sort((a, b) => ((a.childIndex ?? 1) < (b.childIndex ?? 1) ? -1 : 1))\n\t\t\t.forEach((v1Page) => {\n\t\t\t\t// Set the current page id to the current page\n\t\t\t\tapp.setCurrentPageId(v1PageIdsToV2PageIds.get(v1Page.id)!)\n\n\t\t\t\tconst v1ShapeIdsToV2ShapeIds = new Map<string, TLShapeId>()\n\t\t\t\tconst v1GroupShapeIdsToV1ChildIds = new Map<string, string[]>()\n\n\t\t\t\tconst v1Shapes = Object.values(v1Page.shapes ?? {})\n\t\t\t\t\t.sort((a, b) => (a.childIndex < b.childIndex ? -1 : 1))\n\t\t\t\t\t.slice(0, MAX_SHAPES_PER_PAGE)\n\n\t\t\t\t// Groups only\n\t\t\t\tv1Shapes.forEach((v1Shape) => {\n\t\t\t\t\tif (v1Shape.type !== TDShapeType.Group) return\n\n\t\t\t\t\tconst shapeId = app.createShapeId()\n\t\t\t\t\tv1ShapeIdsToV2ShapeIds.set(v1Shape.id, shapeId)\n\t\t\t\t\tv1GroupShapeIdsToV1ChildIds.set(v1Shape.id, [])\n\t\t\t\t})\n\n\t\t\t\tfunction decideNotToCreateShape(v1Shape: TDShape) {\n\t\t\t\t\tv1ShapeIdsToV2ShapeIds.delete(v1Shape.id)\n\t\t\t\t\tconst v1GroupParent = v1GroupShapeIdsToV1ChildIds.has(v1Shape.parentId)\n\t\t\t\t\tif (v1GroupParent) {\n\t\t\t\t\t\tconst ids = v1GroupShapeIdsToV1ChildIds\n\t\t\t\t\t\t\t.get(v1Shape.parentId)!\n\t\t\t\t\t\t\t.filter((id) => id !== v1Shape.id)\n\t\t\t\t\t\tv1GroupShapeIdsToV1ChildIds.set(v1Shape.parentId, ids)\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Non-groups only\n\t\t\t\tv1Shapes.forEach((v1Shape) => {\n\t\t\t\t\t// Skip groups for now, we'll create groups via the app's API\n\t\t\t\t\tif (v1Shape.type === TDShapeType.Group) {\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\n\t\t\t\t\tconst shapeId = app.createShapeId()\n\t\t\t\t\tv1ShapeIdsToV2ShapeIds.set(v1Shape.id, shapeId)\n\n\t\t\t\t\tif (v1Shape.parentId !== v1Page.id) {\n\t\t\t\t\t\t// If the parent is a group, then add the shape to the group's children\n\t\t\t\t\t\tif (v1GroupShapeIdsToV1ChildIds.has(v1Shape.parentId)) {\n\t\t\t\t\t\t\tv1GroupShapeIdsToV1ChildIds.get(v1Shape.parentId)!.push(v1Shape.id)\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconsole.warn('parent does not exist', v1Shape)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// First, try to find the shape's parent among the existing groups\n\t\t\t\t\tconst parentId = v1PageIdsToV2PageIds.get(v1Page.id)!\n\n\t\t\t\t\tconst inCommon = {\n\t\t\t\t\t\tid: shapeId,\n\t\t\t\t\t\tparentId,\n\t\t\t\t\t\tx: coerceNumber(v1Shape.point[0]),\n\t\t\t\t\t\ty: coerceNumber(v1Shape.point[1]),\n\t\t\t\t\t\trotation: 0,\n\t\t\t\t\t\tisLocked: !!v1Shape.isLocked,\n\t\t\t\t\t}\n\n\t\t\t\t\tswitch (v1Shape.type) {\n\t\t\t\t\t\tcase TDShapeType.Sticky: {\n\t\t\t\t\t\t\tconst partial: TLShapePartial<TLNoteShape> = {\n\t\t\t\t\t\t\t\t...inCommon,\n\t\t\t\t\t\t\t\ttype: 'note',\n\t\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\t\ttext: v1Shape.text ?? '',\n\t\t\t\t\t\t\t\t\tcolor: getV2Color(v1Shape.style.color),\n\t\t\t\t\t\t\t\t\tsize: getV2Size(v1Shape.style.size),\n\t\t\t\t\t\t\t\t\tfont: getV2Font(v1Shape.style.font),\n\t\t\t\t\t\t\t\t\talign: getV2Align(v1Shape.style.textAlign),\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tapp.createShapes([partial])\n\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcase TDShapeType.Rectangle: {\n\t\t\t\t\t\t\tconst partial: TLShapePartial<TLGeoShape> = {\n\t\t\t\t\t\t\t\t...inCommon,\n\t\t\t\t\t\t\t\ttype: 'geo',\n\t\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\t\tgeo: 'rectangle',\n\t\t\t\t\t\t\t\t\tw: coerceDimension(v1Shape.size[0]),\n\t\t\t\t\t\t\t\t\th: coerceDimension(v1Shape.size[1]),\n\t\t\t\t\t\t\t\t\ttext: v1Shape.label ?? '',\n\t\t\t\t\t\t\t\t\tfill: getV2Fill(v1Shape.style.isFilled, v1Shape.style.color),\n\t\t\t\t\t\t\t\t\tlabelColor: getV2Color(v1Shape.style.color),\n\t\t\t\t\t\t\t\t\tcolor: getV2Color(v1Shape.style.color),\n\t\t\t\t\t\t\t\t\tsize: getV2Size(v1Shape.style.size),\n\t\t\t\t\t\t\t\t\tfont: getV2Font(v1Shape.style.font),\n\t\t\t\t\t\t\t\t\tdash: getV2Dash(v1Shape.style.dash),\n\t\t\t\t\t\t\t\t\talign: 'middle',\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tapp.createShapes([partial])\n\n\t\t\t\t\t\t\tconst pageBoundsBeforeLabel = app.getPageBoundsById(inCommon.id)!\n\n\t\t\t\t\t\t\tapp.updateShapes([\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tid: inCommon.id,\n\t\t\t\t\t\t\t\t\ttype: 'geo',\n\t\t\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\t\t\ttext: v1Shape.label ?? '',\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t])\n\n\t\t\t\t\t\t\tif (pageBoundsBeforeLabel.width === pageBoundsBeforeLabel.height) {\n\t\t\t\t\t\t\t\tconst shape = app.getShapeById<TLGeoShape>(inCommon.id)!\n\t\t\t\t\t\t\t\tconst { growY } = shape.props\n\t\t\t\t\t\t\t\tconst w = coerceDimension(shape.props.w)\n\t\t\t\t\t\t\t\tconst h = coerceDimension(shape.props.h)\n\t\t\t\t\t\t\t\tconst newW = w + growY / 2\n\t\t\t\t\t\t\t\tconst newH = h + growY / 2\n\n\t\t\t\t\t\t\t\tapp.updateShapes([\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tid: inCommon.id,\n\t\t\t\t\t\t\t\t\t\ttype: 'geo',\n\t\t\t\t\t\t\t\t\t\tx: coerceNumber(shape.x) - (newW - w) / 2,\n\t\t\t\t\t\t\t\t\t\ty: coerceNumber(shape.y) - (newH - h) / 2,\n\t\t\t\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\t\t\t\tw: newW,\n\t\t\t\t\t\t\t\t\t\t\th: newH,\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t])\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcase TDShapeType.Triangle: {\n\t\t\t\t\t\t\tconst partial: TLShapePartial<TLGeoShape> = {\n\t\t\t\t\t\t\t\t...inCommon,\n\t\t\t\t\t\t\t\ttype: 'geo',\n\t\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\t\tgeo: 'triangle',\n\t\t\t\t\t\t\t\t\tw: coerceDimension(v1Shape.size[0]),\n\t\t\t\t\t\t\t\t\th: coerceDimension(v1Shape.size[1]),\n\t\t\t\t\t\t\t\t\tfill: getV2Fill(v1Shape.style.isFilled, v1Shape.style.color),\n\t\t\t\t\t\t\t\t\tlabelColor: getV2Color(v1Shape.style.color),\n\t\t\t\t\t\t\t\t\tcolor: getV2Color(v1Shape.style.color),\n\t\t\t\t\t\t\t\t\tsize: getV2Size(v1Shape.style.size),\n\t\t\t\t\t\t\t\t\tfont: getV2Font(v1Shape.style.font),\n\t\t\t\t\t\t\t\t\tdash: getV2Dash(v1Shape.style.dash),\n\t\t\t\t\t\t\t\t\talign: 'middle',\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tapp.createShapes([partial])\n\n\t\t\t\t\t\t\tconst pageBoundsBeforeLabel = app.getPageBoundsById(inCommon.id)!\n\n\t\t\t\t\t\t\tapp.updateShapes([\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tid: inCommon.id,\n\t\t\t\t\t\t\t\t\ttype: 'geo',\n\t\t\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\t\t\ttext: v1Shape.label ?? '',\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t])\n\n\t\t\t\t\t\t\tif (pageBoundsBeforeLabel.width === pageBoundsBeforeLabel.height) {\n\t\t\t\t\t\t\t\tconst shape = app.getShapeById<TLGeoShape>(inCommon.id)!\n\t\t\t\t\t\t\t\tconst { growY } = shape.props\n\t\t\t\t\t\t\t\tconst w = coerceDimension(shape.props.w)\n\t\t\t\t\t\t\t\tconst h = coerceDimension(shape.props.h)\n\t\t\t\t\t\t\t\tconst newW = w + growY / 2\n\t\t\t\t\t\t\t\tconst newH = h + growY / 2\n\n\t\t\t\t\t\t\t\tapp.updateShapes([\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tid: inCommon.id,\n\t\t\t\t\t\t\t\t\t\ttype: 'geo',\n\t\t\t\t\t\t\t\t\t\tx: coerceNumber(shape.x) - (newW - w) / 2,\n\t\t\t\t\t\t\t\t\t\ty: coerceNumber(shape.y) - (newH - h) / 2,\n\t\t\t\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\t\t\t\tw: newW,\n\t\t\t\t\t\t\t\t\t\t\th: newH,\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t])\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcase TDShapeType.Ellipse: {\n\t\t\t\t\t\t\tconst partial: TLShapePartial<TLGeoShape> = {\n\t\t\t\t\t\t\t\t...inCommon,\n\t\t\t\t\t\t\t\ttype: 'geo',\n\t\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\t\tgeo: 'ellipse',\n\t\t\t\t\t\t\t\t\tw: coerceDimension(v1Shape.radius[0]) * 2,\n\t\t\t\t\t\t\t\t\th: coerceDimension(v1Shape.radius[1]) * 2,\n\t\t\t\t\t\t\t\t\tfill: getV2Fill(v1Shape.style.isFilled, v1Shape.style.color),\n\t\t\t\t\t\t\t\t\tlabelColor: getV2Color(v1Shape.style.color),\n\t\t\t\t\t\t\t\t\tcolor: getV2Color(v1Shape.style.color),\n\t\t\t\t\t\t\t\t\tsize: getV2Size(v1Shape.style.size),\n\t\t\t\t\t\t\t\t\tfont: getV2Font(v1Shape.style.font),\n\t\t\t\t\t\t\t\t\tdash: getV2Dash(v1Shape.style.dash),\n\t\t\t\t\t\t\t\t\talign: 'middle',\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tapp.createShapes([partial])\n\n\t\t\t\t\t\t\tconst pageBoundsBeforeLabel = app.getPageBoundsById(inCommon.id)!\n\n\t\t\t\t\t\t\tapp.updateShapes([\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tid: inCommon.id,\n\t\t\t\t\t\t\t\t\ttype: 'geo',\n\t\t\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\t\t\ttext: v1Shape.label ?? '',\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t])\n\n\t\t\t\t\t\t\tif (pageBoundsBeforeLabel.width === pageBoundsBeforeLabel.height) {\n\t\t\t\t\t\t\t\tconst shape = app.getShapeById<TLGeoShape>(inCommon.id)!\n\t\t\t\t\t\t\t\tconst { growY } = shape.props\n\t\t\t\t\t\t\t\tconst w = coerceDimension(shape.props.w)\n\t\t\t\t\t\t\t\tconst h = coerceDimension(shape.props.h)\n\t\t\t\t\t\t\t\tconst newW = w + growY / 2\n\t\t\t\t\t\t\t\tconst newH = h + growY / 2\n\n\t\t\t\t\t\t\t\tapp.updateShapes([\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tid: inCommon.id,\n\t\t\t\t\t\t\t\t\t\ttype: 'geo',\n\t\t\t\t\t\t\t\t\t\tx: coerceNumber(shape.x) - (newW - w) / 2,\n\t\t\t\t\t\t\t\t\t\ty: coerceNumber(shape.y) - (newH - h) / 2,\n\t\t\t\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\t\t\t\tw: newW,\n\t\t\t\t\t\t\t\t\t\t\th: newH,\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t])\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcase TDShapeType.Draw: {\n\t\t\t\t\t\t\tif (v1Shape.points.length === 0) {\n\t\t\t\t\t\t\t\tdecideNotToCreateShape(v1Shape)\n\t\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tconst partial: TLShapePartial<TLDrawShape> = {\n\t\t\t\t\t\t\t\t...inCommon,\n\t\t\t\t\t\t\t\ttype: 'draw',\n\t\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\t\tfill: getV2Fill(v1Shape.style.isFilled, v1Shape.style.color),\n\t\t\t\t\t\t\t\t\tcolor: getV2Color(v1Shape.style.color),\n\t\t\t\t\t\t\t\t\tsize: getV2Size(v1Shape.style.size),\n\t\t\t\t\t\t\t\t\tdash: getV2Dash(v1Shape.style.dash),\n\t\t\t\t\t\t\t\t\tisPen: false,\n\t\t\t\t\t\t\t\t\tisComplete: v1Shape.isComplete,\n\t\t\t\t\t\t\t\t\tsegments: [{ type: 'free', points: v1Shape.points.map(getV2Point) }],\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tapp.createShapes([partial])\n\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcase TDShapeType.Arrow: {\n\t\t\t\t\t\t\tconst v1Bend = coerceNumber(v1Shape.bend)\n\t\t\t\t\t\t\tconst v1Start = getV2Point(v1Shape.handles.start.point)\n\t\t\t\t\t\t\tconst v1End = getV2Point(v1Shape.handles.end.point)\n\t\t\t\t\t\t\tconst dist = Vec2d.Dist(v1Start, v1End)\n\t\t\t\t\t\t\tconst v2Bend = (dist * -v1Bend) / 2\n\n\t\t\t\t\t\t\t// Could also be a line... but we'll use it as an arrow anyway\n\t\t\t\t\t\t\tconst partial: TLShapePartial<TLArrowShape> = {\n\t\t\t\t\t\t\t\t...inCommon,\n\t\t\t\t\t\t\t\ttype: 'arrow',\n\t\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\t\ttext: v1Shape.label ?? '',\n\t\t\t\t\t\t\t\t\tcolor: getV2Color(v1Shape.style.color),\n\t\t\t\t\t\t\t\t\tlabelColor: getV2Color(v1Shape.style.color),\n\t\t\t\t\t\t\t\t\tsize: getV2Size(v1Shape.style.size),\n\t\t\t\t\t\t\t\t\tfont: getV2Font(v1Shape.style.font),\n\t\t\t\t\t\t\t\t\tdash: getV2Dash(v1Shape.style.dash),\n\t\t\t\t\t\t\t\t\tarrowheadStart: getV2Arrowhead(v1Shape.decorations?.start),\n\t\t\t\t\t\t\t\t\tarrowheadEnd: getV2Arrowhead(v1Shape.decorations?.end),\n\t\t\t\t\t\t\t\t\tstart: {\n\t\t\t\t\t\t\t\t\t\ttype: 'point',\n\t\t\t\t\t\t\t\t\t\tx: coerceNumber(v1Shape.handles.start.point[0]),\n\t\t\t\t\t\t\t\t\t\ty: coerceNumber(v1Shape.handles.start.point[1]),\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tend: {\n\t\t\t\t\t\t\t\t\t\ttype: 'point',\n\t\t\t\t\t\t\t\t\t\tx: coerceNumber(v1Shape.handles.end.point[0]),\n\t\t\t\t\t\t\t\t\t\ty: coerceNumber(v1Shape.handles.end.point[1]),\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tbend: v2Bend,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tapp.createShapes([partial])\n\n\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcase TDShapeType.Text: {\n\t\t\t\t\t\t\tconst partial: TLShapePartial<TLTextShape> = {\n\t\t\t\t\t\t\t\t...inCommon,\n\t\t\t\t\t\t\t\ttype: 'text',\n\t\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\t\ttext: v1Shape.text ?? ' ',\n\t\t\t\t\t\t\t\t\tcolor: getV2Color(v1Shape.style.color),\n\t\t\t\t\t\t\t\t\tsize: getV2TextSize(v1Shape.style.size),\n\t\t\t\t\t\t\t\t\tfont: getV2Font(v1Shape.style.font),\n\t\t\t\t\t\t\t\t\talign: getV2Align(v1Shape.style.textAlign),\n\t\t\t\t\t\t\t\t\tscale: v1Shape.style.scale ?? 1,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tapp.createShapes([partial])\n\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcase TDShapeType.Image: {\n\t\t\t\t\t\t\tconst assetId = v1AssetIdsToV2AssetIds.get(v1Shape.assetId)\n\n\t\t\t\t\t\t\tif (!assetId) {\n\t\t\t\t\t\t\t\tconsole.warn('Could not find asset id', v1Shape.assetId)\n\t\t\t\t\t\t\t\treturn\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tconst partial: TLShapePartial<TLImageShape> = {\n\t\t\t\t\t\t\t\t...inCommon,\n\t\t\t\t\t\t\t\ttype: 'image',\n\t\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\t\tw: coerceDimension(v1Shape.size[0]),\n\t\t\t\t\t\t\t\t\th: coerceDimension(v1Shape.size[1]),\n\t\t\t\t\t\t\t\t\tassetId,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tapp.createShapes([partial])\n\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcase TDShapeType.Video: {\n\t\t\t\t\t\t\tconst assetId = v1AssetIdsToV2AssetIds.get(v1Shape.assetId)\n\n\t\t\t\t\t\t\tif (!assetId) {\n\t\t\t\t\t\t\t\tconsole.warn('Could not find asset id', v1Shape.assetId)\n\t\t\t\t\t\t\t\treturn\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tconst partial: TLShapePartial<TLVideoShape> = {\n\t\t\t\t\t\t\t\t...inCommon,\n\t\t\t\t\t\t\t\ttype: 'video',\n\t\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\t\tw: coerceDimension(v1Shape.size[0]),\n\t\t\t\t\t\t\t\t\th: coerceDimension(v1Shape.size[1]),\n\t\t\t\t\t\t\t\t\tassetId,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tapp.createShapes([partial])\n\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tconst rotation = coerceNumber(v1Shape.rotation)\n\n\t\t\t\t\tif (rotation !== 0) {\n\t\t\t\t\t\tapp.select(shapeId)\n\t\t\t\t\t\tapp.rotateShapesBy([shapeId], rotation)\n\t\t\t\t\t}\n\t\t\t\t})\n\n\t\t\t\t// Create groups\n\t\t\t\tv1GroupShapeIdsToV1ChildIds.forEach((v1ChildIds, v1GroupId) => {\n\t\t\t\t\tconst v2ChildShapeIds = v1ChildIds.map((id) => v1ShapeIdsToV2ShapeIds.get(id)!)\n\t\t\t\t\tconst v2GroupId = v1ShapeIdsToV2ShapeIds.get(v1GroupId)!\n\t\t\t\t\tapp.groupShapes(v2ChildShapeIds, v2GroupId)\n\n\t\t\t\t\tconst v1Group = v1Page.shapes[v1GroupId]\n\t\t\t\t\tconst rotation = coerceNumber(v1Group.rotation)\n\n\t\t\t\t\tif (rotation !== 0) {\n\t\t\t\t\t\tapp.select(v2GroupId)\n\t\t\t\t\t\tapp.rotateShapesBy([v2GroupId], rotation)\n\t\t\t\t\t}\n\t\t\t\t})\n\n\t\t\t\t// Bind arrows to shapes\n\n\t\t\t\tv1Shapes.forEach((v1Shape) => {\n\t\t\t\t\tif (v1Shape.type !== TDShapeType.Arrow) {\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\n\t\t\t\t\tconst v2ShapeId = v1ShapeIdsToV2ShapeIds.get(v1Shape.id)!\n\t\t\t\t\tconst v2ShapeStale = app.getShapeById<TLArrowShape>(v2ShapeId)!\n\t\t\t\t\tconst util = app.getShapeUtil(v2ShapeStale)\n\n\t\t\t\t\t// dumb but necessary\n\t\t\t\t\tapp.inputs.ctrlKey = false\n\n\t\t\t\t\tfor (const handleId of ['start', 'end'] as const) {\n\t\t\t\t\t\tconst bindingId = v1Shape.handles[handleId].bindingId\n\t\t\t\t\t\tif (bindingId) {\n\t\t\t\t\t\t\tconst binding = v1Page.bindings[bindingId]\n\t\t\t\t\t\t\tif (!binding) {\n\t\t\t\t\t\t\t\t// arrow has a reference to a binding that no longer exists\n\t\t\t\t\t\t\t\tcontinue\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tconst targetId = v1ShapeIdsToV2ShapeIds.get(binding.toId)!\n\n\t\t\t\t\t\t\tconst targetShape = app.getShapeById(targetId)!\n\n\t\t\t\t\t\t\t// (unexpected) We didn't create the target shape\n\t\t\t\t\t\t\tif (!targetShape) continue\n\n\t\t\t\t\t\t\tif (targetId) {\n\t\t\t\t\t\t\t\tconst bounds = app.getPageBoundsById(targetId)!\n\n\t\t\t\t\t\t\t\tconst v2ShapeFresh = app.getShapeById<TLArrowShape>(v2ShapeId)!\n\n\t\t\t\t\t\t\t\tconst nx = clamp((coerceNumber(binding.point[0]) + 0.5) / 2, 0.2, 0.8)\n\t\t\t\t\t\t\t\tconst ny = clamp((coerceNumber(binding.point[1]) + 0.5) / 2, 0.2, 0.8)\n\n\t\t\t\t\t\t\t\tconst point = app.getPointInShapeSpace(v2ShapeFresh, {\n\t\t\t\t\t\t\t\t\tx: bounds.minX + bounds.width * nx,\n\t\t\t\t\t\t\t\t\ty: bounds.minY + bounds.height * ny,\n\t\t\t\t\t\t\t\t})\n\n\t\t\t\t\t\t\t\tconst handles = util.handles(v2ShapeFresh)\n\n\t\t\t\t\t\t\t\tconst change = util.onHandleChange!(v2ShapeFresh, {\n\t\t\t\t\t\t\t\t\thandle: {\n\t\t\t\t\t\t\t\t\t\t...handles.find((h) => h.id === handleId)!,\n\t\t\t\t\t\t\t\t\t\tx: point.x,\n\t\t\t\t\t\t\t\t\t\ty: point.y,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tisPrecise: point.x !== 0.5 || point.y !== 0.5,\n\t\t\t\t\t\t\t\t})\n\n\t\t\t\t\t\t\t\tif (change) {\n\t\t\t\t\t\t\t\t\tif (change.props?.[handleId]) {\n\t\t\t\t\t\t\t\t\t\tconst terminal = change.props?.[handleId] as TLArrowTerminal\n\t\t\t\t\t\t\t\t\t\tif (terminal.type === 'binding') {\n\t\t\t\t\t\t\t\t\t\t\tterminal.isExact = binding.distance === 0\n\n\t\t\t\t\t\t\t\t\t\t\tif (terminal.boundShapeId !== targetId) {\n\t\t\t\t\t\t\t\t\t\t\t\tconsole.warn('Hit the wrong shape!')\n\t\t\t\t\t\t\t\t\t\t\t\tterminal.boundShapeId = targetId\n\t\t\t\t\t\t\t\t\t\t\t\tterminal.normalizedAnchor = { x: 0.5, y: 0.5 }\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tapp.updateShapes([change])\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t})\n\n\t\t// Set the current page to the first page again\n\t\tapp.setCurrentPageId(firstPageId)\n\n\t\tapp.history.clear()\n\t\tapp.selectNone()\n\t\tapp.updateViewportScreenBounds()\n\n\t\tconst bounds = app.allShapesCommonBounds\n\t\tif (bounds) {\n\t\t\tapp.zoomToBounds(bounds.minX, bounds.minY, bounds.width, bounds.height, 1)\n\t\t}\n\t})\n}\n\nfunction coerceNumber(n: unknown): number {\n\tif (typeof n !== 'number') return 0\n\tif (Number.isNaN(n)) return 0\n\tif (!Number.isFinite(n)) return 0\n\treturn n\n}\n\nfunction coerceDimension(d: unknown): number {\n\tconst n = coerceNumber(d)\n\tif (n <= 0) return 1\n\treturn n\n}\n\n/**\n * We want to move assets over to our new S3 bucket & extract any relevant\n * metadata. That process is async though, where the rest of our migration is\n * synchronous.\n *\n * We'll write placeholder assets to the app using the old asset URLs, then kick\n * off a process async to try and download the real assets, extract the\n * metadata, and upload them to our new bucket. It's not a big deal if this\n * fails though.\n */\nasync function tryMigrateAsset(app: App, placeholderAsset: TLAsset) {\n\ttry {\n\t\tif (placeholderAsset.type === 'bookmark' || !placeholderAsset.props.src) return\n\n\t\tconst response = await fetch(placeholderAsset.props.src)\n\t\tif (!response.ok) return\n\n\t\tconst file = new File([await response.blob()], placeholderAsset.props.name, {\n\t\t\ttype: response.headers.get('content-type') ?? placeholderAsset.props.mimeType ?? undefined,\n\t\t})\n\n\t\tconst newAsset = await app.onCreateAssetFromFile(file)\n\t\tif (newAsset.type === 'bookmark') return\n\n\t\tapp.updateAssets([\n\t\t\t{\n\t\t\t\tid: placeholderAsset.id,\n\t\t\t\ttype: placeholderAsset.type,\n\t\t\t\tprops: {\n\t\t\t\t\t...newAsset.props,\n\t\t\t\t\tname: placeholderAsset.props.name,\n\t\t\t\t},\n\t\t\t},\n\t\t])\n\t} catch (err) {\n\t\t// not a big deal, we'll just keep the placeholder asset\n\t}\n}\n\nfunction migrate(document: LegacyTldrawDocument, newVersion: number): LegacyTldrawDocument {\n\tconst { version = 0 } = document\n\n\tif (!document.assets) {\n\t\tdocument.assets = {}\n\t}\n\n\t// Remove unused assets when loading a document\n\tconst assetIdsInUse = new Set<string>()\n\n\tObject.values(document.pages).forEach((page) =>\n\t\tObject.values(page.shapes).forEach((shape) => {\n\t\t\tconst { parentId, children, assetId } = shape\n\n\t\t\tif (assetId) {\n\t\t\t\tassetIdsInUse.add(assetId)\n\t\t\t}\n\n\t\t\t// Fix missing parent bug\n\t\t\tif (parentId !== page.id && !page.shapes[parentId]) {\n\t\t\t\tconsole.warn('Encountered a shape with a missing parent!')\n\t\t\t\tshape.parentId = page.id\n\t\t\t}\n\n\t\t\tif (shape.type === TDShapeType.Group && children) {\n\t\t\t\tchildren.forEach((childId) => {\n\t\t\t\t\tif (!page.shapes[childId]) {\n\t\t\t\t\t\tconsole.warn('Encountered a parent with a missing child!', shape.id, childId)\n\t\t\t\t\t\tchildren?.splice(children.indexOf(childId), 1)\n\t\t\t\t\t}\n\t\t\t\t})\n\n\t\t\t\t// TODO: Remove the shape if it has no children\n\t\t\t}\n\t\t})\n\t)\n\n\tObject.keys(document.assets).forEach((assetId) => {\n\t\tif (!assetIdsInUse.has(assetId)) {\n\t\t\tdelete document.assets[assetId]\n\t\t}\n\t})\n\n\tif (version !== newVersion) {\n\t\tif (version < 14) {\n\t\t\tObject.values(document.pages).forEach((page) => {\n\t\t\t\tObject.values(page.shapes)\n\t\t\t\t\t.filter((shape) => shape.type === TDShapeType.Text)\n\t\t\t\t\t.forEach((shape) => (shape as TextShape).style.font === FontStyle.Script)\n\t\t\t})\n\t\t}\n\n\t\t// Lowercase styles, move binding meta to binding\n\t\tif (version <= 13) {\n\t\t\tObject.values(document.pages).forEach((page) => {\n\t\t\t\tObject.values(page.bindings).forEach((binding) => {\n\t\t\t\t\tObject.assign(binding, (binding as any).meta)\n\t\t\t\t})\n\n\t\t\t\tObject.values(page.shapes).forEach((shape) => {\n\t\t\t\t\tObject.entries(shape.style).forEach(([id, style]) => {\n\t\t\t\t\t\tif (typeof style === 'string') {\n\t\t\t\t\t\t\t// @ts-ignore\n\t\t\t\t\t\t\tshape.style[id] = style.toLowerCase()\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\n\t\t\t\t\tif (shape.type === TDShapeType.Arrow) {\n\t\t\t\t\t\tif (shape.decorations) {\n\t\t\t\t\t\t\tObject.entries(shape.decorations).forEach(([id, decoration]) => {\n\t\t\t\t\t\t\t\tif ((decoration as unknown) === 'Arrow') {\n\t\t\t\t\t\t\t\t\tshape.decorations = {\n\t\t\t\t\t\t\t\t\t\t...shape.decorations,\n\t\t\t\t\t\t\t\t\t\t[id]: Decoration.Arrow,\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t})\n\t\t}\n\n\t\t// Add document name and file system handle\n\t\tif (version <= 13.1) {\n\t\t\tdocument.name = 'New Document'\n\t\t}\n\n\t\tif (version < 15) {\n\t\t\tdocument.assets = {}\n\t\t}\n\n\t\tObject.values(document.pages).forEach((page) => {\n\t\t\tObject.values(page.shapes).forEach((shape) => {\n\t\t\t\tif (version < 15.2) {\n\t\t\t\t\tif (shape.type === TDShapeType.Image || shape.type === TDShapeType.Video) {\n\t\t\t\t\t\tshape.style.isFilled = true\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (version < 15.3) {\n\t\t\t\t\tif (\n\t\t\t\t\t\tshape.type === TDShapeType.Rectangle ||\n\t\t\t\t\t\tshape.type === TDShapeType.Triangle ||\n\t\t\t\t\t\tshape.type === TDShapeType.Ellipse ||\n\t\t\t\t\t\tshape.type === TDShapeType.Arrow\n\t\t\t\t\t) {\n\t\t\t\t\t\tshape.label = (shape as any).text || ''\n\t\t\t\t\t\tshape.labelPoint = [0.5, 0.5]\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t})\n\t}\n\n\t// Cleanup\n\tObject.values(document.pageStates).forEach((pageState) => {\n\t\tpageState.selectedIds = pageState.selectedIds.filter((id) => {\n\t\t\treturn document.pages[pageState.id].shapes[id] !== undefined\n\t\t})\n\t\tpageState.bindingId = undefined\n\t\tpageState.editingId = undefined\n\t\tpageState.hoveredId = undefined\n\t\tpageState.pointedId = undefined\n\t})\n\n\tdocument.version = newVersion\n\n\treturn document\n}\n\n/* -------------------- TLV1 Types -------------------- */\n\ninterface TLV1Handle {\n\tid: string\n\tindex: number\n\tpoint: number[]\n}\n\ninterface TLV1Binding {\n\tid: string\n\ttoId: string\n\tfromId: string\n}\n\ninterface TLV1Shape {\n\tid: string\n\ttype: string\n\tparentId: string\n\tchildIndex: number\n\tname: string\n\tpoint: number[]\n\tassetId?: string\n\trotation?: number\n\tchildren?: string[]\n\thandles?: Record<string, TLV1Handle>\n\tisGhost?: boolean\n\tisHidden?: boolean\n\tisLocked?: boolean\n\tisGenerated?: boolean\n\tisAspectRatioLocked?: boolean\n}\n\nenum TDShapeType {\n\tSticky = 'sticky',\n\tEllipse = 'ellipse',\n\tRectangle = 'rectangle',\n\tTriangle = 'triangle',\n\tDraw = 'draw',\n\tArrow = 'arrow',\n\tText = 'text',\n\tGroup = 'group',\n\tImage = 'image',\n\tVideo = 'video',\n}\n\nenum ColorStyle {\n\tWhite = 'white',\n\tLightGray = 'lightGray',\n\tGray = 'gray',\n\tBlack = 'black',\n\tGreen = 'green',\n\tCyan = 'cyan',\n\tBlue = 'blue',\n\tIndigo = 'indigo',\n\tViolet = 'violet',\n\tRed = 'red',\n\tOrange = 'orange',\n\tYellow = 'yellow',\n}\n\nenum SizeStyle {\n\tSmall = 'small',\n\tMedium = 'medium',\n\tLarge = 'large',\n}\n\nenum DashStyle {\n\tDraw = 'draw',\n\tSolid = 'solid',\n\tDashed = 'dashed',\n\tDotted = 'dotted',\n}\n\nenum AlignStyle {\n\tStart = 'start',\n\tMiddle = 'middle',\n\tEnd = 'end',\n\tJustify = 'justify',\n}\n\nenum FontStyle {\n\tScript = 'script',\n\tSans = 'sans',\n\tSerif = 'serif',\n\tMono = 'mono',\n}\n\ntype ShapeStyles = {\n\tcolor: ColorStyle\n\tsize: SizeStyle\n\tdash: DashStyle\n\tfont?: FontStyle\n\ttextAlign?: AlignStyle\n\tisFilled?: boolean\n\tscale?: number\n}\n\ninterface TDBaseShape extends TLV1Shape {\n\tstyle: ShapeStyles\n\ttype: TDShapeType\n\tlabel?: string\n\thandles?: Record<string, TDHandle>\n}\n\ninterface DrawShape extends TDBaseShape {\n\ttype: TDShapeType.Draw\n\tpoints: number[][]\n\tisComplete: boolean\n}\n\n// The extended handle (used for arrows)\ninterface TDHandle extends TLV1Handle {\n\tcanBind?: boolean\n\tbindingId?: string\n}\n\ninterface RectangleShape extends TDBaseShape {\n\ttype: TDShapeType.Rectangle\n\tsize: number[]\n\tlabel?: string\n\tlabelPoint?: number[]\n}\n\ninterface EllipseShape extends TDBaseShape {\n\ttype: TDShapeType.Ellipse\n\tradius: number[]\n\tlabel?: string\n\tlabelPoint?: number[]\n}\n\ninterface TriangleShape extends TDBaseShape {\n\ttype: TDShapeType.Triangle\n\tsize: number[]\n\tlabel?: string\n\tlabelPoint?: number[]\n}\n\nenum Decoration {\n\tArrow = 'arrow',\n}\n\n// The shape created with the arrow tool\ninterface ArrowShape extends TDBaseShape {\n\ttype: TDShapeType.Arrow\n\tbend: number\n\thandles: {\n\t\tstart: TDHandle\n\t\tbend: TDHandle\n\t\tend: TDHandle\n\t}\n\tdecorations?: {\n\t\tstart?: Decoration\n\t\tend?: Decoration\n\t\tmiddle?: Decoration\n\t}\n\tlabel?: string\n\tlabelPoint?: number[]\n}\n\ninterface ArrowBinding extends TLV1Binding {\n\thandleId: keyof ArrowShape['handles']\n\tdistance: number\n\tpoint: number[]\n}\n\ntype TDBinding = ArrowBinding\n\ninterface ImageShape extends TDBaseShape {\n\ttype: TDShapeType.Image\n\tsize: number[]\n\tassetId: string\n}\n\ninterface VideoShape extends TDBaseShape {\n\ttype: TDShapeType.Video\n\tsize: number[]\n\tassetId: string\n\tisPlaying: boolean\n\tcurrentTime: number\n}\n\n// The shape created by the text tool\ninterface TextShape extends TDBaseShape {\n\ttype: TDShapeType.Text\n\ttext: string\n}\n\n// The shape created by the sticky tool\ninterface StickyShape extends TDBaseShape {\n\ttype: TDShapeType.Sticky\n\tsize: number[]\n\ttext: string\n}\n\n// The shape created when multiple shapes are grouped\ninterface GroupShape extends TDBaseShape {\n\ttype: TDShapeType.Group\n\tsize: number[]\n\tchildren: string[]\n}\n\ntype TDShape =\n\t| RectangleShape\n\t| EllipseShape\n\t| TriangleShape\n\t| DrawShape\n\t| ArrowShape\n\t| TextShape\n\t| GroupShape\n\t| StickyShape\n\t| ImageShape\n\t| VideoShape\n\ntype TDPage = {\n\tid: string\n\tname?: string\n\tchildIndex?: number\n\tshapes: Record<string, TDShape>\n\tbindings: Record<string, TDBinding>\n}\n\ninterface TLV1Bounds {\n\tminX: number\n\tminY: number\n\tmaxX: number\n\tmaxY: number\n\twidth: number\n\theight: number\n\trotation?: number\n}\n\ninterface TLV1PageState {\n\tid: string\n\tselectedIds: string[]\n\tcamera: {\n\t\tpoint: number[]\n\t\tzoom: number\n\t}\n\tbrush?: TLV1Bounds | null\n\tpointedId?: string | null\n\thoveredId?: string | null\n\teditingId?: string | null\n\tbindingId?: string | null\n}\n\nenum TDAssetType {\n\tImage = 'image',\n\tVideo = 'video',\n}\n\ninterface TDImageAsset extends TLV1Asset {\n\ttype: TDAssetType.Image\n\tfileName: string\n\tsrc: string\n\tsize: number[]\n}\n\ninterface TDVideoAsset extends TLV1Asset {\n\ttype: TDAssetType.Video\n\tfileName: string\n\tsrc: string\n\tsize: number[]\n}\n\ninterface TLV1Asset {\n\tid: string\n\ttype: string\n}\n\ntype TDAsset = TDImageAsset | TDVideoAsset\n\ntype TDAssets = Record<string, TDAsset>\n\n/** @internal */\nexport interface LegacyTldrawDocument {\n\tid: string\n\tname: string\n\tversion: number\n\tpages: Record<string, TDPage>\n\tpageStates: Record<string, TLV1PageState>\n\tassets: TDAssets\n}\n\n/* ------------------ Translations ------------------ */\n\n// const v1ShapeTypesToV2ShapeTypes: Record<TDShapeType, TLShapeType> = {\n// \t[TDShapeType.Rectangle]: 'geo',\n// \t[TDShapeType.Ellipse]: 'geo',\n// \t[TDShapeType.Text]: 'text',\n// \t[TDShapeType.Image]: 'image',\n// \t[TDShapeType.Video]: 'video',\n// \t[TDShapeType.Group]: 'group',\n// \t[TDShapeType.Arrow]: 'arrow',\n// \t[TDShapeType.Sticky]: 'note',\n// \t[TDShapeType.Draw]: 'draw',\n// \t[TDShapeType.Triangle]: 'geo',\n// }\n\nconst v1ColorsToV2Colors: Record<ColorStyle, TLColorType> = {\n\t[ColorStyle.White]: 'black',\n\t[ColorStyle.Black]: 'black',\n\t[ColorStyle.LightGray]: 'grey',\n\t[ColorStyle.Gray]: 'grey',\n\t[ColorStyle.Green]: 'light-green',\n\t[ColorStyle.Cyan]: 'green',\n\t[ColorStyle.Blue]: 'light-blue',\n\t[ColorStyle.Indigo]: 'blue',\n\t[ColorStyle.Orange]: 'orange',\n\t[ColorStyle.Yellow]: 'yellow',\n\t[ColorStyle.Red]: 'red',\n\t[ColorStyle.Violet]: 'light-violet',\n}\n\nconst v1FontsToV2Fonts: Record<FontStyle, TLFontType> = {\n\t[FontStyle.Mono]: 'mono',\n\t[FontStyle.Sans]: 'sans',\n\t[FontStyle.Script]: 'draw',\n\t[FontStyle.Serif]: 'serif',\n}\n\nconst v1AlignsToV2Aligns: Record<AlignStyle, TLAlignType> = {\n\t[AlignStyle.Start]: 'start',\n\t[AlignStyle.Middle]: 'middle',\n\t[AlignStyle.End]: 'end',\n\t[AlignStyle.Justify]: 'justify',\n}\n\nconst v1TextSizesToV2TextSizes: Record<SizeStyle, TLSizeType> = {\n\t[SizeStyle.Small]: 's',\n\t[SizeStyle.Medium]: 'l',\n\t[SizeStyle.Large]: 'xl',\n}\n\nconst v1SizesToV2Sizes: Record<SizeStyle, TLSizeType> = {\n\t[SizeStyle.Small]: 'm',\n\t[SizeStyle.Medium]: 'l',\n\t[SizeStyle.Large]: 'xl',\n}\n\nconst v1DashesToV2Dashes: Record<DashStyle, TLDashType> = {\n\t[DashStyle.Solid]: 'solid',\n\t[DashStyle.Dashed]: 'dashed',\n\t[DashStyle.Dotted]: 'dotted',\n\t[DashStyle.Draw]: 'draw',\n}\n\nfunction getV2Color(color: ColorStyle | undefined): TLColorType {\n\treturn color ? v1ColorsToV2Colors[color] ?? 'black' : 'black'\n}\n\nfunction getV2Font(font: FontStyle | undefined): TLFontType {\n\treturn font ? v1FontsToV2Fonts[font] ?? 'draw' : 'draw'\n}\n\nfunction getV2Align(align: AlignStyle | undefined): TLAlignType {\n\treturn align ? v1AlignsToV2Aligns[align] ?? 'middle' : 'middle'\n}\n\nfunction getV2TextSize(size: SizeStyle | undefined): TLSizeType {\n\treturn size ? v1TextSizesToV2TextSizes[size] ?? 'm' : 'm'\n}\n\nfunction getV2Size(size: SizeStyle | undefined): TLSizeType {\n\treturn size ? v1SizesToV2Sizes[size] ?? 'l' : 'l'\n}\n\nfunction getV2Dash(dash: DashStyle | undefined): TLDashType {\n\treturn dash ? v1DashesToV2Dashes[dash] ?? 'draw' : 'draw'\n}\n\nfunction getV2Point(point: number[]): Vec2dModel {\n\treturn {\n\t\tx: coerceNumber(point[0]),\n\t\ty: coerceNumber(point[1]),\n\t\tz: point[2] == null ? 0.5 : coerceNumber(point[2]),\n\t}\n}\n\nfunction getV2Arrowhead(decoration: Decoration | undefined): TLArrowheadType {\n\treturn decoration === Decoration.Arrow ? 'arrow' : 'none'\n}\n\nfunction getV2Fill(isFilled: boolean | undefined, color: ColorStyle) {\n\treturn isFilled\n\t\t? color === ColorStyle.Black || color === ColorStyle.White\n\t\t\t? 'semi'\n\t\t\t: 'solid'\n\t\t: 'none'\n}\n","import { isPlainObject } from 'is-plain-object'\nimport { nanoid } from 'nanoid'\n\n/**\n * Generate a unique id.\n *\n * @example\n * ```ts\n * const id = uniqueId()\n * ```\n *\n * @public\n */\nexport function uniqueId() {\n\treturn nanoid()\n}\n\nconst serializableTypes = new Set(['string', 'number', 'boolean', 'undefined'])\n\n/**\n * Get whether a value is serializable.\n *\n * @example\n * ```ts\n * const A = isSerializable(1) // true\n * const B = isSerializable('a') // true\n * const C = isSerializable(true) // true\n * const D = isSerializable(undefined) // false\n * ```\n *\n * @param value - The value to check.\n * @public\n */\nexport function isSerializable(value: any): boolean {\n\tif (serializableTypes.has(typeof value) || value === null) return true\n\tif (Array.isArray(value)) return value.every(isSerializable)\n\tif (isPlainObject(value)) return Object.values(value).every(isSerializable)\n\treturn false\n}\n\n/**\n * Convert a file to base64.\n *\n * @example\n * ```ts\n * const A = fileToBase64('./test.png')\n * ```\n *\n * @param value - The file as a blob.\n * @public\n */\nexport function fileToBase64(file: Blob): Promise<string> {\n\treturn new Promise((resolve, reject) => {\n\t\tif (file) {\n\t\t\tconst reader = new FileReader()\n\t\t\treader.readAsDataURL(file)\n\t\t\treader.onload = () => resolve(reader.result as string)\n\t\t\treader.onerror = (error) => reject(error)\n\t\t\treader.onabort = (error) => reject(error)\n\t\t}\n\t})\n}\n\n/**\n * Get an incremented name (e.g. New page (2)) from a name (e.g. New page), based on an array of\n * existing names.\n *\n * @param name - The name to increment.\n * @param others - The array of existing names.\n * @public\n */\nexport function getIncrementedName(name: string, others: string[]) {\n\tlet result = name\n\tconst set = new Set(others)\n\n\twhile (set.has(result)) {\n\t\tresult = /^.*(\\d+)$/.exec(result)?.[1]\n\t\t\t? result.replace(/(\\d+)(?=\\D?)$/, (m) => {\n\t\t\t\t\treturn (+m + 1).toString()\n\t\t\t  })\n\t\t\t: `${result} 1`\n\t}\n\n\treturn result\n}\n\n/** @public */\nexport const checkFlag = (flag: boolean | (() => boolean) | undefined) =>\n\ttypeof flag === 'boolean' ? flag : flag?.()\n\n/** @public */\nexport function snapToGrid(n: number, gridSize: number) {\n\treturn Math.round(n / gridSize) * gridSize\n}\n","/*\nThis is used to facilitate double clicking and pointer capture on elements.\n\nThe events in this file are possibly set on individual SVG elements, \nsuch as handles or corner handles, rather than on HTML elements or \nSVGSVGElements. Raw SVG elemnets do not support pointerCapture in \nmost cases, meaning that in order for pointer capture to work, we \nneed to crawl up the DOM tree to find the nearest HTML element. Then,\nin order for that element to also call the `onPointerUp` event from\nthis file, we need to manually set that event on that element and\nlater remove it when the pointerup occurs. This is a potential leak\nif the user clicks on a handle but the pointerup does not fire for\nwhatever reason.\n*/\n\nimport { Vec2d } from '@tldraw/primitives'\nimport React, { useEffect, useState } from 'react'\nimport { debugFlags } from './debug-flags'\n\n/**\n * @public\n */\nexport function loopToHtmlElement(elm: Element): HTMLElement {\n\tif (elm instanceof HTMLElement) return elm\n\tif (elm.parentElement) return loopToHtmlElement(elm.parentElement)\n\telse throw Error('Could not find a parent element of an HTML type!')\n}\n\n/**\n * This function calls `event.preventDefault()` for you. Why is that useful?\n *\n * Beacuase if you enable `window.preventDefaultLogging = true` it'll log out a\n * message when it happens. Because we use console.warn rather than\n * (log) you'll get a stack trace in the inspector telling you exactly\n * where it happened. This is important because `e.preventDefault()` is the\n * source of many bugs, but unfortuantly it can't be avoided because it also\n * stops a lot of default behaviour which doesn't make sense in our UI\n *\n * @param event - to prevent default on\n * @public\n */\nexport function preventDefault(event: React.BaseSyntheticEvent | Event) {\n\tevent.preventDefault()\n\tif (debugFlags.preventDefaultLogging.value) {\n\t\tconsole.warn('preventDefault called on event:', event)\n\t}\n}\n\n/**\n * @public\n */\nexport function setPointerCapture(\n\telement: Element,\n\tevent: React.PointerEvent<Element> | PointerEvent\n) {\n\telement.setPointerCapture(event.pointerId)\n\tif (debugFlags.pointerCaptureTracking.value) {\n\t\tconst trackingObj = debugFlags.pointerCaptureTrackingObject.value\n\t\ttrackingObj.set(element, (trackingObj.get(element) ?? 0) + 1)\n\t}\n\tif (debugFlags.pointerCaptureLogging.value) {\n\t\tconsole.warn('setPointerCapture called on element:', element, event)\n\t}\n}\n\n/**\n * @public\n */\nexport function releasePointerCapture(\n\telement: Element,\n\tevent: React.PointerEvent<Element> | PointerEvent\n) {\n\tif (!element.hasPointerCapture(event.pointerId)) {\n\t\treturn\n\t}\n\n\telement.releasePointerCapture(event.pointerId)\n\tif (debugFlags.pointerCaptureTracking.value) {\n\t\tconst trackingObj = debugFlags.pointerCaptureTrackingObject.value\n\t\tif (trackingObj.get(element) === 1) {\n\t\t\ttrackingObj.delete(element)\n\t\t} else if (trackingObj.has(element)) {\n\t\t\ttrackingObj.set(element, trackingObj.get(element)! - 1)\n\t\t} else {\n\t\t\tconsole.warn('Release without capture')\n\t\t}\n\t}\n\tif (debugFlags.pointerCaptureLogging.value) {\n\t\tconsole.warn('releasePointerCapture called on element:', element, event)\n\t}\n}\n\n/**\n * @public\n */\nexport function rotateBoxShadow(\n\trotation: number,\n\tshadows: { offsetX: number; offsetY: number; blur: number; spread: number; color: string }[]\n) {\n\tconst cssStrings = shadows.map((shadow) => {\n\t\tconst { offsetX, offsetY, blur, spread, color } = shadow\n\t\tconst vec = new Vec2d(offsetX, offsetY)\n\t\tconst { x, y } = vec.rot(-rotation)\n\t\treturn `${x}px ${y}px ${blur}px ${spread}px ${color}`\n\t})\n\treturn cssStrings.join(', ')\n}\n\n/**\n * @public\n */\nexport function usePrefersReducedMotion() {\n\tconst [prefersReducedMotion, setPrefersReducedMotion] = useState(false)\n\n\tuseEffect(() => {\n\t\tconst mql = window.matchMedia('(prefers-reduced-motion: reduce)')\n\t\tconst handler = () => {\n\t\t\tsetPrefersReducedMotion(mql.matches)\n\t\t}\n\t\thandler()\n\t\tmql.addEventListener('change', handler)\n\t\treturn () => mql.removeEventListener('change', handler)\n\t}, [])\n\n\treturn prefersReducedMotion\n}\n\n/**\n * @public\n */\nexport const truncateStringWithEllipsis = (str: string, maxLength: number) => {\n\treturn str.length <= maxLength ? str : str.substring(0, maxLength - 3) + '...'\n}\n","import { EMBED_DEFINITIONS, EmbedDefinition } from '@tldraw/tlschema'\nimport escapeStringRegexp from 'escape-string-regexp'\n\n/** @public */\nexport function matchEmbedUrl(url: string) {\n\tconst host = new URL(url).host.replace('www.', '')\n\tfor (const localEmbedDef of EMBED_DEFINITIONS) {\n\t\tif (checkHostnames(localEmbedDef.hostnames, host)) {\n\t\t\tconst originalUrl = localEmbedDef.fromEmbedUrl(url)\n\t\t\tif (originalUrl) {\n\t\t\t\treturn {\n\t\t\t\t\tdefinition: localEmbedDef,\n\t\t\t\t\turl: originalUrl,\n\t\t\t\t\tembedUrl: url,\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nconst globlikeRegExp = (input: string) => {\n\treturn input\n\t\t.split('*')\n\t\t.map((str) => escapeStringRegexp(str))\n\t\t.join('.+')\n}\n\nconst checkHostnames = (hostnames: readonly string[], targetHostname: string) => {\n\treturn !!hostnames.find((hostname) => {\n\t\tconst re = new RegExp(globlikeRegExp(hostname))\n\t\treturn targetHostname.match(re)\n\t})\n}\n\n/** @public */\nexport function matchUrl(url: string) {\n\tconst host = new URL(url).host.replace('www.', '')\n\tfor (const localEmbedDef of EMBED_DEFINITIONS) {\n\t\tif (checkHostnames(localEmbedDef.hostnames, host)) {\n\t\t\tconst embedUrl = localEmbedDef.toEmbedUrl(url)\n\n\t\t\tif (embedUrl) {\n\t\t\t\treturn {\n\t\t\t\t\tdefinition: localEmbedDef,\n\t\t\t\t\tembedUrl,\n\t\t\t\t\turl,\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\n/** @public */\nexport type EmbedResult =\n\t| {\n\t\t\tdefinition: EmbedDefinition\n\t\t\turl: string\n\t\t\tembedUrl: string\n\t  }\n\t| undefined\n\n/**\n * Tests whether an URL supports embedding and returns the result.\n *\n * @param inputUrl - the URL to match\n * @public\n */\nexport function getEmbedInfoUnsafely(inputUrl: string): EmbedResult {\n\tconst result = matchUrl(inputUrl) ?? matchEmbedUrl(inputUrl)\n\treturn result\n}\n\n/**\n * Tests whether an URL supports embedding and returns the result. If we encounter an error, we return undefined.\n *\n * @param inputUrl - the URL to match\n * @public\n */\nexport function getEmbedInfo(inputUrl: string): EmbedResult {\n\ttry {\n\t\treturn getEmbedInfoUnsafely(inputUrl)\n\t} catch (e) {\n\t\t// Don't throw here! We'll throw it from the embed shape's shape util\n\t\tconsole.error(e)\n\t}\n\n\treturn undefined\n}\n","export default function escapeStringRegexp(string) {\n\tif (typeof string !== 'string') {\n\t\tthrow new TypeError('Expected a string');\n\t}\n\n\t// Escape characters with special meaning either inside or outside character sets.\n\t// Use a simple backslash escape when its always valid, and a `\\xnn` escape when the simpler form would be disallowed by Unicode patterns stricter grammar.\n\treturn string\n\t\t.replace(/[|\\\\{}()[\\]^$+*?.]/g, '\\\\$&')\n\t\t.replace(/-/g, '\\\\x2d');\n}\n","import {\n\tTLInstancePropsForNextShape,\n\tTLShapeProps,\n\tTLStyleType,\n\tTL_STYLE_TYPES,\n} from '@tldraw/tlschema'\n\n/** @public */\nexport function setPropsForNextShape(\n\tpreviousProps: TLInstancePropsForNextShape,\n\tnewProps: Partial<TLShapeProps>\n): TLInstancePropsForNextShape {\n\tlet nextProps: null | TLInstancePropsForNextShape = null\n\tfor (const [prop, value] of Object.entries(newProps)) {\n\t\tif (!TL_STYLE_TYPES.has(prop as TLStyleType)) continue\n\t\tif (!nextProps) nextProps = { ...previousProps }\n\t\t// @ts-expect-error typescript can't track `value` correctly\n\t\tnextProps[prop] = value\n\t}\n\treturn nextProps ?? previousProps\n}\n","// Adapted from https://observablehq.com/@dgreensp/implementing-fractional-indexing\n// by @dgreensp (twitter @DavidLG)\n\nconst DIGITS = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'\nconst INTEGER_ZERO = 'a0'\nconst SMALLEST_INTEGER = 'A00000000000000000000000000'\n\n/**\n * Get the length of an integer.\n *\n * @param head - The integer to use.\n */\nexport function getIntegerLength(head: string): number {\n\tif (head >= 'a' && head <= 'z') {\n\t\treturn head.charCodeAt(0) - 'a'.charCodeAt(0) + 2\n\t} else if (head >= 'A' && head <= 'Z') {\n\t\treturn 'Z'.charCodeAt(0) - head.charCodeAt(0) + 2\n\t} else {\n\t\tthrow new Error('Invalid index key head: ' + head)\n\t}\n}\n\n/**\n * Validate an integer.\n *\n * @param int - The integer to use.\n */\nexport function validateInteger(int: string): asserts int is string {\n\tif (int.length !== getIntegerLength(int.charAt(0))) {\n\t\tthrow new Error('invalid integer part of index key: ' + int)\n\t}\n}\n\nexport function isNotUndefined(n: string | undefined): asserts n is string {\n\tif (n === undefined) throw Error('n is undefined')\n}\n\n/**\n * Increment an integer.\n *\n * @param x - The integer to increment\n */\nexport function incrementInteger(x: string): string | undefined {\n\tvalidateInteger(x)\n\tconst [head, ...digs] = x.split('')\n\tlet carry = true\n\tfor (let i = digs.length - 1; carry && i >= 0; i--) {\n\t\tconst d = DIGITS.indexOf(digs[i]) + 1\n\t\tif (d === DIGITS.length) {\n\t\t\tdigs[i] = '0'\n\t\t} else {\n\t\t\tdigs[i] = DIGITS.charAt(d)\n\t\t\tcarry = false\n\t\t}\n\t}\n\tif (carry) {\n\t\tif (head === 'Z') return 'a0'\n\t\tif (head === 'z') return undefined\n\t\tconst h = String.fromCharCode(head.charCodeAt(0) + 1)\n\t\tif (h > 'a') {\n\t\t\tdigs.push('0')\n\t\t} else {\n\t\t\tdigs.pop()\n\t\t}\n\t\treturn h + digs.join('')\n\t} else {\n\t\treturn head + digs.join('')\n\t}\n}\n\n/**\n * Decrement an integer.\n *\n * @param x - The integer to decrement\n */\nexport function decrementInteger(x: string): string | undefined {\n\tvalidateInteger(x)\n\tconst [head, ...digs] = x.split('')\n\tlet borrow = true\n\tfor (let i = digs.length - 1; borrow && i >= 0; i--) {\n\t\tconst d = DIGITS.indexOf(digs[i]) - 1\n\t\tif (d === -1) {\n\t\t\tdigs[i] = DIGITS.slice(-1)\n\t\t} else {\n\t\t\tdigs[i] = DIGITS.charAt(d)\n\t\t\tborrow = false\n\t\t}\n\t}\n\tif (borrow) {\n\t\tif (head === 'a') return 'Z' + DIGITS.slice(-1)\n\t\tif (head === 'A') return undefined\n\t\tconst h = String.fromCharCode(head.charCodeAt(0) - 1)\n\t\tif (h < 'Z') {\n\t\t\tdigs.push(DIGITS.slice(-1))\n\t\t} else {\n\t\t\tdigs.pop()\n\t\t}\n\t\treturn h + digs.join('')\n\t} else {\n\t\treturn head + digs.join('')\n\t}\n}\n\n/**\n * Get the midpoint between two indexs.\n *\n * @param a - The start index.\n * @param b - The end index.\n */\nexport function midpoint(a: string, b: string | undefined): string {\n\tif (b !== undefined && a >= b) {\n\t\tthrow new Error(a + ' >= ' + b)\n\t}\n\tif (a.slice(-1) === '0' || (b && b.slice(-1) === '0')) {\n\t\tthrow new Error('trailing zero')\n\t}\n\tif (b) {\n\t\tlet n = 0\n\t\twhile ((a.charAt(n) || '0') === b.charAt(n)) {\n\t\t\tn++\n\t\t}\n\t\tif (n > 0) {\n\t\t\treturn b.slice(0, n) + midpoint(a.slice(n), b.slice(n))\n\t\t}\n\t}\n\tconst digitA = a ? DIGITS.indexOf(a.charAt(0)) : 0\n\tconst digitB = b !== undefined ? DIGITS.indexOf(b.charAt(0)) : DIGITS.length\n\tif (digitB - digitA > 1) {\n\t\tconst midDigit = Math.round(0.5 * (digitA + digitB))\n\t\treturn DIGITS.charAt(midDigit)\n\t} else {\n\t\tif (b && b.length > 1) {\n\t\t\treturn b.slice(0, 1)\n\t\t} else {\n\t\t\treturn DIGITS.charAt(digitA) + midpoint(a.slice(1), undefined)\n\t\t}\n\t}\n}\n\n/**\n * Get the integer part of an index.\n *\n * @param index - The index to use.\n */\nexport function getIntegerPart(index: string): string {\n\tconst integerPartLength = getIntegerLength(index.charAt(0))\n\tif (integerPartLength > index.length) {\n\t\tthrow new Error('invalid index: ' + index)\n\t}\n\treturn index.slice(0, integerPartLength)\n}\n\n/**\n * Validate an index.\n *\n * @param x - The index to validate.\n */\nexport function validateOrder(index: string): asserts index is string {\n\tif (index === SMALLEST_INTEGER) {\n\t\tthrow new Error('invalid index: ' + index)\n\t}\n\t// getIntegerPart will throw if the first character is bad,\n\t// or the key is too short.  we'd call it to check these things\n\t// even if we didn't need the result\n\tconst i = getIntegerPart(index)\n\tconst f = index.slice(i.length)\n\tif (f.slice(-1) === '0') {\n\t\tthrow new Error('invalid index: ' + index)\n\t}\n}\n\n/**\n * A string made up of an integer part followed by a fraction part. The fraction point consists of\n * zero or more digits with no trailing zeros.\n */\nexport type OrderKey = string\n\n/**\n * Generate an index key at the midpoint between a start and end.\n *\n * @param a - The start index key string.\n * @param b - The end index key string, greater than A.\n */\nexport function generateKeyBetween(a: OrderKey | undefined, b: OrderKey | undefined): OrderKey {\n\tif (a !== undefined) validateOrder(a)\n\tif (b !== undefined) validateOrder(b)\n\tif (a !== undefined && b !== undefined && a >= b) {\n\t\tthrow new Error(a + ' >= ' + b)\n\t}\n\tif (a === undefined && b === undefined) {\n\t\treturn INTEGER_ZERO\n\t}\n\tif (a === undefined) {\n\t\tif (b === undefined) throw Error('b is undefined')\n\t\tconst ib = getIntegerPart(b)\n\t\tconst fb = b.slice(ib.length)\n\t\tif (ib === SMALLEST_INTEGER) {\n\t\t\treturn ib + midpoint('', fb)\n\t\t}\n\t\tif (ib < b) {\n\t\t\treturn ib\n\t\t}\n\t\tconst ibl = decrementInteger(ib)\n\t\tisNotUndefined(ibl)\n\t\treturn ibl\n\t}\n\tif (b === undefined) {\n\t\tconst ia = getIntegerPart(a)\n\t\tconst fa = a.slice(ia.length)\n\t\tconst i = incrementInteger(ia)\n\t\treturn i === undefined ? ia + midpoint(fa, undefined) : i\n\t}\n\tconst ia = getIntegerPart(a)\n\tconst fa = a.slice(ia.length)\n\tconst ib = getIntegerPart(b)\n\tconst fb = b.slice(ib.length)\n\tif (ia === ib) {\n\t\treturn ia + midpoint(fa, fb)\n\t}\n\tconst i = incrementInteger(ia)\n\tisNotUndefined(i)\n\treturn i < b ? i : ia + midpoint(fa, undefined)\n}\n\n/**\n * Generate N number of index keys between the start and end index.\n *\n * @param a - The start index key string.\n * @param b - The end index key, greater than A string.\n * @param n - The number of index keys to generate.\n */\nexport function generateNKeysBetween(\n\ta: string | undefined,\n\tb: string | undefined,\n\tn: number\n): string[] {\n\tif (n === 0) return []\n\tif (n === 1) return [generateKeyBetween(a, b)]\n\tif (b === undefined) {\n\t\tlet c = generateKeyBetween(a, b)\n\t\tconst result = [c]\n\t\tfor (let i = 0; i < n - 1; i++) {\n\t\t\tc = generateKeyBetween(c, b)\n\t\t\tresult.push(c)\n\t\t}\n\t\treturn result\n\t}\n\tif (a === undefined) {\n\t\tlet c = generateKeyBetween(a, b)\n\t\tconst result = [c]\n\t\tfor (let i = 0; i < n - 1; i++) {\n\t\t\tc = generateKeyBetween(a, c)\n\t\t\tresult.push(c)\n\t\t}\n\t\tresult.reverse()\n\t\treturn result\n\t}\n\tconst mid = Math.floor(n / 2)\n\tconst c = generateKeyBetween(a, b)\n\treturn [...generateNKeysBetween(a, c, mid), c, ...generateNKeysBetween(c, b, n - mid - 1)]\n}\n\nexport function getCounter() {\n\tlet index = 'a0'\n\treturn () => {\n\t\tindex = generateKeyBetween(index, undefined)\n\t\treturn index\n\t}\n}\n\nexport function* iterableRange(n = 1) {\n\tlet index = 'a0'\n\tlet i = 0\n\twhile (i < n) {\n\t\ti++\n\t\tindex = generateKeyBetween(index, undefined)\n\t\tyield index\n\t}\n}\n","import { generateKeyBetween, generateNKeysBetween } from './dgreensp'\n\n/** @public */\nexport function getIndicesBetween(below: string | undefined, above: string | undefined, n: number) {\n\treturn generateNKeysBetween(below, above, n)\n}\n\n/** @public */\nexport function getIndicesAbove(below: string, n: number) {\n\treturn generateNKeysBetween(below, undefined, n)\n}\n\n/** @public */\nexport function getIndicesBelow(above: string, n: number) {\n\treturn generateNKeysBetween(undefined, above, n)\n}\n\n/** @public */\nexport function getIndexBetween(below: string, above?: string) {\n\treturn generateNKeysBetween(below, above, 1)[0]\n}\n\n/** @public */\nexport function getIndexAbove(below: string) {\n\treturn generateNKeysBetween(below, undefined, 1)[0]\n}\n\n/** @public */\nexport function getIndexBelow(above: string) {\n\treturn generateNKeysBetween(undefined, above, 1)[0]\n}\n\n/** @public */\nexport function getIndices(n: number) {\n\treturn ['a1', ...generateNKeysBetween('a1', undefined, n)]\n}\n\n/** @public */\nexport function getIndexGenerator() {\n\tlet order = 'a1'\n\treturn () => {\n\t\torder = generateKeyBetween(order, undefined)\n\t\treturn order\n\t}\n}\n\n/** @public */\nexport function* indexGenerator(n = 1) {\n\tlet order = 'a1'\n\tlet i = 0\n\twhile (i < n) {\n\t\ti++\n\t\torder = generateKeyBetween(order, undefined)\n\t\tyield order\n\t}\n}\n\n/** @public */\nexport function sortByIndex<T extends { index: string }>(a: T, b: T) {\n\tif (a.index < b.index) {\n\t\treturn -1\n\t} else if (a.index > b.index) {\n\t\treturn 1\n\t}\n\treturn 0\n}\n\n/** @public */\nexport function sortById<T extends { id: string }>(a: T, b: T) {\n\tif (a.id < b.id) {\n\t\treturn -1\n\t} else if (a.id > b.id) {\n\t\treturn 1\n\t}\n\treturn 0\n}\n\n/** @public */\nexport function getMaxIndex(...indices: (string | undefined)[]): string {\n\treturn indices.reduce((acc, curr) => (!curr ? acc : acc! < curr ? curr : acc), 'a1')!\n}\n","import { canolicalizeRotation, Matrix2d, Vec2d } from '@tldraw/primitives'\nimport { isShapeId, TLShapePartial } from '@tldraw/tlschema'\nimport { structuredClone } from '@tldraw/utils'\nimport { App } from '../app/App'\n\n/**\n * @internal\n */\nexport function getRotationSnapshot({ app }: { app: App }) {\n\tconst {\n\t\tselectionRotation,\n\t\tselectionPageCenter,\n\t\tinputs: { originPagePoint },\n\t\tselectedShapes,\n\t} = app\n\n\treturn {\n\t\tselectionPageCenter: selectionPageCenter!,\n\t\tinitialCursorAngle: selectionPageCenter!.angle(originPagePoint),\n\t\tinitialSelectionRotation: selectionRotation,\n\t\tshapeSnapshots: selectedShapes.map((shape) => ({\n\t\t\tshape: structuredClone(shape),\n\t\t\tinitialPagePoint: app.getPagePointById(shape.id)!,\n\t\t})),\n\t}\n}\n\n/**\n * @internal\n */\nexport type RotationSnapshot = ReturnType<typeof getRotationSnapshot>\n\n/**\n * @internal\n */\nexport function applyRotationToSnapshotShapes({\n\tdelta,\n\tapp,\n\tsnapshot,\n\tstage,\n}: {\n\tdelta: number\n\tsnapshot: RotationSnapshot\n\tapp: App\n\tstage: 'start' | 'update' | 'end' | 'one-off'\n}) {\n\tconst { selectionPageCenter, shapeSnapshots } = snapshot\n\n\tapp.updateShapes(\n\t\tshapeSnapshots.map(({ shape, initialPagePoint }) => {\n\t\t\t// We need to both rotate each shape individually and rotate the shapes\n\t\t\t// around the pivot point (the average center of all rotating shapes.)\n\n\t\t\tconst parentTransform = isShapeId(shape.parentId)\n\t\t\t\t? app.getPageTransformById(shape.parentId)!\n\t\t\t\t: Matrix2d.Identity()\n\n\t\t\tconst newPagePoint = Vec2d.RotWith(initialPagePoint, selectionPageCenter, delta)\n\n\t\t\tconst newLocalPoint = Matrix2d.applyToPoint(\n\t\t\t\t// use the current parent transform in case it has moved/resized since the start\n\t\t\t\t// (e.g. if rotating a shape at the edge of a group)\n\t\t\t\tMatrix2d.Inverse(parentTransform),\n\t\t\t\tnewPagePoint\n\t\t\t)\n\t\t\tconst newRotation = canolicalizeRotation(shape.rotation + delta)\n\n\t\t\treturn {\n\t\t\t\tid: shape.id,\n\t\t\t\ttype: shape.type,\n\t\t\t\tx: newLocalPoint.x,\n\t\t\t\ty: newLocalPoint.y,\n\t\t\t\trotation: newRotation,\n\t\t\t}\n\t\t})\n\t)\n\n\t// Handle change\n\n\tconst changes: TLShapePartial[] = []\n\n\tshapeSnapshots.forEach(({ shape }) => {\n\t\tconst current = app.getShapeById(shape.id)\n\t\tif (!current) return\n\t\tconst util = app.getShapeUtil(shape)\n\n\t\tif (stage === 'start' || stage === 'one-off') {\n\t\t\tconst changeStart = util.onRotateStart?.(shape)\n\t\t\tif (changeStart) changes.push(changeStart)\n\t\t}\n\n\t\tconst changeUpdate = util.onRotate?.(shape, current)\n\t\tif (changeUpdate) changes.push(changeUpdate)\n\n\t\tif (stage === 'end' || stage === 'one-off') {\n\t\t\tconst changeEnd = util.onRotateEnd?.(shape, current)\n\t\t\tif (changeEnd) changes.push(changeEnd)\n\t\t}\n\t})\n\n\tif (changes.length > 0) {\n\t\tapp.updateShapes(changes)\n\t}\n}\n","/** @public */\nexport const runtime: {\n\topenWindow: (url: string, target: string) => void\n} = {\n\topenWindow: (url, target) => window.open(url, target, 'noopener noreferrer'),\n}\n\n/** @public */\nexport function setRuntimeOverrides(input: Partial<typeof runtime>) {\n\tfor (const key of Object.keys(input)) {\n\t\tconst overridesKey = key as keyof typeof runtime\n\t\tconst value = input[overridesKey]!\n\t\truntime[overridesKey] = value\n\t}\n}\n","/**\n * @public\n */\nexport function defaultEmptyAs(str: string, dflt: string) {\n\tif (str.match(/^\\s*$/)) {\n\t\treturn dflt\n\t}\n\treturn str\n}\n\n/**\n * @public\n */\nexport async function blobAsString(blob: Blob) {\n\treturn new Promise<string>((resolve, reject) => {\n\t\tconst reader = new FileReader()\n\t\treader.addEventListener('loadend', () => {\n\t\t\tconst text = reader.result\n\t\t\tresolve(text as string)\n\t\t})\n\t\treader.addEventListener('error', () => {\n\t\t\treject(reader.error)\n\t\t})\n\t\treader.readAsText(blob)\n\t})\n}\n\n/**\n * @public\n */\nexport async function dataTransferItemAsString(item: DataTransferItem) {\n\treturn new Promise<string>((resolve) => {\n\t\titem.getAsString((text) => {\n\t\t\tresolve(text)\n\t\t})\n\t})\n}\n\n/**\n * @public\n */\nexport function correctSpacesToNbsp(input: string) {\n\treturn input.replace(/\\s(\\s+)/g, (_str, match) => {\n\t\tlet out = ' '\n\t\tfor (let i = 0; i < match.length; i++) {\n\t\t\tout += '\\xa0'\n\t\t}\n\t\treturn out\n\t})\n}\n","import { StrokePoint, toDomPrecision, Vec2d, VecLike } from '@tldraw/primitives'\n\n/**\n * @internal\n */\nexport function getPointerInfo(e: React.PointerEvent | PointerEvent, container: HTMLElement) {\n\t;(e as any).isKilled = true\n\n\tconst { top, left } = container.getBoundingClientRect()\n\n\treturn {\n\t\tpoint: {\n\t\t\tx: e.clientX - left,\n\t\t\ty: e.clientY - top,\n\t\t\tz: e.pressure,\n\t\t},\n\t\tshiftKey: e.shiftKey,\n\t\taltKey: e.altKey,\n\t\tctrlKey: e.metaKey || e.ctrlKey,\n\t\tpointerId: e.pointerId,\n\t\tbutton: e.button,\n\t\tisPen: e.pointerType === 'pen',\n\t}\n}\n\nfunction precise(A: VecLike) {\n\treturn `${toDomPrecision(A.x)},${toDomPrecision(A.y)} `\n}\n\nfunction average(A: VecLike, B: VecLike) {\n\treturn `${toDomPrecision((A.x + B.x) / 2)},${toDomPrecision((A.y + B.y) / 2)} `\n}\n\n/**\n * Turn an array of points into a path of quadradic curves.\n *\n * @param points - The points returned from perfect-freehand\n * @param closed - Whether the stroke is closed\n * @public\n */\nexport function getSvgPathFromStroke(points: Vec2d[], closed = true): string {\n\tconst len = points.length\n\n\tif (len < 2) {\n\t\treturn ''\n\t}\n\n\tlet a = points[0]\n\tlet b = points[1]\n\n\tif (len === 2) {\n\t\t// If only two points, just draw a line\n\t\treturn `M${precise(a)}L${precise(b)}`\n\t}\n\n\tlet result = ''\n\n\tfor (let i = 2, max = len - 1; i < max; i++) {\n\t\ta = points[i]\n\t\tb = points[i + 1]\n\t\tresult += average(a, b)\n\t}\n\n\tif (closed) {\n\t\t// If closed, draw a curve from the last point to the first\n\t\treturn `M${average(points[0], points[1])}Q${precise(points[1])}${average(\n\t\t\tpoints[1],\n\t\t\tpoints[2]\n\t\t)}T${result}${average(points[len - 1], points[0])}${average(points[0], points[1])}Z`\n\t} else {\n\t\t// If not closed, draw a curve starting at the first point and\n\t\t// ending at the midpoint of the last and second-last point, then\n\t\t// complete the curve with a line segment to the last point.\n\t\treturn `M${precise(points[0])}Q${precise(points[1])}${average(points[1], points[2])}${\n\t\t\tpoints.length > 3 ? 'T' : ''\n\t\t}${result}L${precise(points[len - 1])}`\n\t}\n}\n\n/**\n * Turn an array of stroke points into a path of quadradic curves.\n *\n * @param points - The stroke points returned from perfect-freehand\n * @param closed - Whether the shape is closed\n *\n * @public\n */\nexport function getSvgPathFromStrokePoints(points: StrokePoint[], closed = false): string {\n\tconst len = points.length\n\n\tif (len < 2) {\n\t\treturn ''\n\t}\n\n\tlet a = points[0].point\n\tlet b = points[1].point\n\n\tif (len === 2) {\n\t\treturn `M${precise(a)}L${precise(b)}`\n\t}\n\n\tlet result = ''\n\n\tfor (let i = 2, max = len - 1; i < max; i++) {\n\t\ta = points[i].point\n\t\tb = points[i + 1].point\n\t\tresult += average(a, b)\n\t}\n\n\tif (closed) {\n\t\t// If closed, draw a curve from the last point to the first\n\t\treturn `M${average(points[0].point, points[1].point)}Q${precise(points[1].point)}${average(\n\t\t\tpoints[1].point,\n\t\t\tpoints[2].point\n\t\t)}T${result}${average(points[len - 1].point, points[0].point)}${average(\n\t\t\tpoints[0].point,\n\t\t\tpoints[1].point\n\t\t)}Z`\n\t} else {\n\t\t// If not closed, draw a curve starting at the first point and\n\t\t// ending at the midpoint of the last and second-last point, then\n\t\t// complete the curve with a line segment to the last point.\n\t\treturn `M${precise(points[0].point)}Q${precise(points[1].point)}${average(\n\t\t\tpoints[1].point,\n\t\t\tpoints[2].point\n\t\t)}${points.length > 3 ? 'T' : ''}${result}L${precise(points[len - 1].point)}`\n\t}\n}\n","import { assertExists } from '@tldraw/utils'\nimport { createContext, useContext } from 'react'\n\nconst ContainerContext = createContext<HTMLDivElement | null>(null)\n\n/** @internal */\nexport function ContainerProvider({\n\tcontainer,\n\tchildren,\n}: {\n\tcontainer: HTMLDivElement\n\tchildren: React.ReactNode\n}) {\n\treturn <ContainerContext.Provider value={container}>{children}</ContainerContext.Provider>\n}\n\n/** @public */\nexport function useContainer(): HTMLDivElement {\n\treturn assertExists(useContext(ContainerContext), 'useContainer used outside of <Tldraw />')\n}\n","import { useEffect } from 'react'\nimport { EffectScheduler, EMPTY_ARRAY } from 'signia'\n\n/** @public */\nexport function useQuickReactor(name: string, reactFn: () => void, deps: any[] = EMPTY_ARRAY) {\n\tuseEffect(() => {\n\t\tconst scheduler = new EffectScheduler(name, reactFn)\n\t\tscheduler.attach()\n\t\tscheduler.execute()\n\t\treturn () => {\n\t\t\tscheduler.detach()\n\t\t}\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t}, deps)\n}\n","import { PI, radiansToDegrees } from '@tldraw/primitives'\nimport { TLCursorType } from '@tldraw/tlschema'\nimport { useApp } from './useApp'\nimport { useContainer } from './useContainer'\nimport { useQuickReactor } from './useQuickReactor'\n\nconst CORNER_SVG = `<path d='m19.7432 17.0869-4.072 4.068 2.829 2.828-8.473-.013-.013-8.47 2.841 2.842 4.075-4.068 1.414-1.415-2.844-2.842h8.486v8.484l-2.83-2.827z' fill='%23fff'/><path d='m18.6826 16.7334-4.427 4.424 1.828 1.828-5.056-.016-.014-5.054 1.842 1.841 4.428-4.422 2.474-2.475-1.844-1.843h5.073v5.071l-1.83-1.828z' fill='%23000'/>`\nconst EDGE_SVG = `<path d='m9 17.9907v.005l5.997 5.996.001-3.999h1.999 2.02v4l5.98-6.001-5.98-5.999.001 4.019-2.021.002h-2l.001-4.022zm1.411.003 3.587-3.588-.001 2.587h3.5 2.521v-2.585l3.565 3.586-3.564 3.585-.001-2.585h-2.521l-3.499-.001-.001 2.586z' fill='%23fff'/><path d='m17.4971 18.9932h2.521v2.586l3.565-3.586-3.565-3.585v2.605h-2.521-3.5v-2.607l-3.586 3.587 3.586 3.586v-2.587z' fill='%23000'/>`\nconst ROTATE_CORNER_SVG = `<g><path d=\"M22.4789 9.45728L25.9935 12.9942L22.4789 16.5283V14.1032C18.126 14.1502 14.6071 17.6737 14.5675 22.0283H17.05L13.513 25.543L9.97889 22.0283H12.5674C12.6071 16.5691 17.0214 12.1503 22.4789 12.1031L22.4789 9.45728Z\" fill=\"black\"/><path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M21.4789 7.03223L27.4035 12.9945L21.4789 18.9521V15.1868C18.4798 15.6549 16.1113 18.0273 15.649 21.0284H19.475L13.5128 26.953L7.55519 21.0284H11.6189C12.1243 15.8155 16.2679 11.6677 21.4789 11.1559L21.4789 7.03223ZM22.4789 12.1031C17.0214 12.1503 12.6071 16.5691 12.5674 22.0284H9.97889L13.513 25.543L17.05 22.0284H14.5675C14.5705 21.6896 14.5947 21.3558 14.6386 21.0284C15.1157 17.4741 17.9266 14.6592 21.4789 14.1761C21.8063 14.1316 22.1401 14.1069 22.4789 14.1032V16.5284L25.9935 12.9942L22.4789 9.45729L22.4789 12.1031Z\" fill=\"white\"/></g>`\nconst TEXT_SVG = `<path fill=\"currentcolor\" d='m6.94 2v-1c-1.35866267-.08246172-2.66601117.53165299-3.47 1.63-.80398883-1.09834701-2.11133733-1.71246172-3.47-1.63v1c1.30781678-.16635468 2.55544738.59885876 3 1.84v5.1h-1v1h1v4.16c-.4476345 1.2386337-1.69302129 2.002471-3 1.84v1c1.35687108.0731933 2.6600216-.5389494 3.47-1.63.8099784 1.0910506 2.11312892 1.7031933 3.47 1.63v-1c-1.28590589.133063-2.49760499-.6252793-2.94-1.84v-4.18h1v-1h-1v-5.08c.43943906-1.21710975 1.65323743-1.97676587 2.94-1.84z' transform='translate(14 9)'/>`\nconst GRABBING_SVG = `<path d='m13.5732 12.0361c.48-.178 1.427-.069 1.677.473.213.462.396 1.241.406 1.075.024-.369-.024-1.167.137-1.584.117-.304.347-.59.686-.691.285-.086.62-.116.916-.055.313.064.642.287.765.499.362.623.368 1.899.385 1.831.064-.272.07-1.229.283-1.584.141-.235.497-.445.687-.479.294-.052.656-.068.964-.008.249.049.586.344.677.487.219.344.342 1.316.379 1.658.016.141.074-.393.293-.736.406-.639 1.844-.763 1.898.639.026.654.02.624.02 1.064 0 .516-.012.828-.04 1.202-.03.399-.116 1.304-.241 1.742-.086.301-.371.978-.653 1.384 0 0-1.074 1.25-1.191 1.812-.117.563-.078.567-.102.965-.023.399.121.923.121.923s-.801.104-1.234.034c-.391-.062-.875-.84-1-1.078-.172-.328-.539-.265-.682-.023-.224.383-.709 1.07-1.05 1.113-.669.084-2.055.03-3.14.02 0 0 .185-1.011-.227-1.358-.305-.26-.83-.784-1.144-1.06l-.832-.921c-.283-.36-1.002-.929-1.243-1.985-.213-.936-.192-1.395.037-1.77.232-.381.67-.589.854-.625.208-.042.692-.039.875.062.223.123.313.159.488.391.23.307.312.456.213.121-.076-.262-.322-.595-.434-.97-.109-.361-.401-.943-.38-1.526.008-.221.103-.771.832-1.042' fill='%23fff'/><g stroke='%23000' stroke-width='.75'><path d='m13.5732 12.0361c.48-.178 1.427-.069 1.677.473.213.462.396 1.241.406 1.075.024-.369-.024-1.167.137-1.584.117-.304.347-.59.686-.691.285-.086.62-.116.916-.055.313.064.642.287.765.499.362.623.368 1.899.385 1.831.064-.272.07-1.229.283-1.584.141-.235.497-.445.687-.479.294-.052.656-.068.964-.008.249.049.586.344.677.487.219.344.342 1.316.379 1.658.016.141.074-.393.293-.736.406-.639 1.844-.763 1.898.639.026.654.02.624.02 1.064 0 .516-.012.828-.04 1.202-.03.399-.116 1.304-.241 1.742-.086.301-.371.978-.653 1.384 0 0-1.074 1.25-1.191 1.812-.117.563-.078.567-.102.965-.023.399.121.923.121.923s-.801.104-1.234.034c-.391-.062-.875-.84-1-1.078-.172-.328-.539-.265-.682-.023-.224.383-.709 1.07-1.05 1.113-.669.084-2.055.03-3.14.02 0 0 .185-1.011-.227-1.358-.305-.26-.83-.784-1.144-1.06l-.832-.921c-.283-.36-1.002-.929-1.243-1.985-.213-.936-.192-1.395.037-1.77.232-.381.67-.589.854-.625.208-.042.692-.039.875.062.223.123.313.159.488.391.23.307.312.456.213.121-.076-.262-.322-.595-.434-.97-.109-.361-.401-.943-.38-1.526.008-.221.103-.771.832-1.042z' stroke-linejoin='round'/><path d='m20.5664 19.7344v-3.459' stroke-linecap='round'/><path d='m18.5508 19.7461-.016-3.473' stroke-linecap='round'/><path d='m16.5547 16.3047.021 3.426' stroke-linecap='round'/></g>`\nconst GRAB_SVG = `<path d=\"m13.5557 17.5742c-.098-.375-.196-.847-.406-1.552-.167-.557-.342-.859-.47-1.233-.155-.455-.303-.721-.496-1.181-.139-.329-.364-1.048-.457-1.44-.119-.509.033-.924.244-1.206.253-.339.962-.49 1.357-.351.371.13.744.512.916.788.288.46.357.632.717 1.542.393.992.564 1.918.611 2.231l.085.452c-.001-.04-.043-1.122-.044-1.162-.035-1.029-.06-1.823-.038-2.939.002-.126.064-.587.084-.715.078-.5.305-.8.673-.979.412-.201.926-.215 1.401-.017.423.173.626.55.687 1.022.014.109.094.987.093 1.107-.013 1.025.006 1.641.015 2.174.004.231.003 1.625.017 1.469.061-.656.094-3.189.344-3.942.144-.433.405-.746.794-.929.431-.203 1.113-.07 1.404.243.285.305.446.692.482 1.153.032.405-.019.897-.02 1.245 0 .867-.021 1.324-.037 2.121-.001.038-.015.298.023.182.094-.28.188-.542.266-.745.049-.125.241-.614.359-.859.114-.234.211-.369.415-.688.2-.313.415-.448.668-.561.54-.235 1.109.112 1.301.591.086.215.009.713-.028 1.105-.061.647-.254 1.306-.352 1.648-.128.447-.274 1.235-.34 1.601-.072.394-.234 1.382-.359 1.82-.086.301-.371.978-.652 1.384 0 0-1.074 1.25-1.192 1.812-.117.563-.078.567-.101.965-.024.399.121.923.121.923s-.802.104-1.234.034c-.391-.062-.875-.841-1-1.078-.172-.328-.539-.265-.682-.023-.225.383-.709 1.07-1.051 1.113-.668.084-2.054.03-3.139.02 0 0 .185-1.011-.227-1.358-.305-.26-.83-.784-1.144-1.06l-.832-.921c-.284-.36-.629-1.093-1.243-1.985-.348-.504-1.027-1.085-1.284-1.579-.223-.425-.331-.954-.19-1.325.225-.594.675-.897 1.362-.832.519.05.848.206 1.238.537.225.19.573.534.75.748.163.195.203.276.377.509.23.307.302.459.214.121\" fill=\"%23fff\"/><g stroke=\"%23000\" stroke-linecap=\"round\" stroke-width=\".75\"><path d=\"m13.5557 17.5742c-.098-.375-.196-.847-.406-1.552-.167-.557-.342-.859-.47-1.233-.155-.455-.303-.721-.496-1.181-.139-.329-.364-1.048-.457-1.44-.119-.509.033-.924.244-1.206.253-.339.962-.49 1.357-.351.371.13.744.512.916.788.288.46.357.632.717 1.542.393.992.564 1.918.611 2.231l.085.452c-.001-.04-.043-1.122-.044-1.162-.035-1.029-.06-1.823-.038-2.939.002-.126.064-.587.084-.715.078-.5.305-.8.673-.979.412-.201.926-.215 1.401-.017.423.173.626.55.687 1.022.014.109.094.987.093 1.107-.013 1.025.006 1.641.015 2.174.004.231.003 1.625.017 1.469.061-.656.094-3.189.344-3.942.144-.433.405-.746.794-.929.431-.203 1.113-.07 1.404.243.285.305.446.692.482 1.153.032.405-.019.897-.02 1.245 0 .867-.021 1.324-.037 2.121-.001.038-.015.298.023.182.094-.28.188-.542.266-.745.049-.125.241-.614.359-.859.114-.234.211-.369.415-.688.2-.313.415-.448.668-.561.54-.235 1.109.112 1.301.591.086.215.009.713-.028 1.105-.061.647-.254 1.306-.352 1.648-.128.447-.274 1.235-.34 1.601-.072.394-.234 1.382-.359 1.82-.086.301-.371.978-.652 1.384 0 0-1.074 1.25-1.192 1.812-.117.563-.078.567-.101.965-.024.399.121.923.121.923s-.802.104-1.234.034c-.391-.062-.875-.841-1-1.078-.172-.328-.539-.265-.682-.023-.225.383-.709 1.07-1.051 1.113-.668.084-2.054.03-3.139.02 0 0 .185-1.011-.227-1.358-.305-.26-.83-.784-1.144-1.06l-.832-.921c-.284-.36-.629-1.093-1.243-1.985-.348-.504-1.027-1.085-1.284-1.579-.223-.425-.331-.954-.19-1.325.225-.594.675-.897 1.362-.832.519.05.848.206 1.238.537.225.19.573.534.75.748.163.195.203.276.377.509.23.307.302.459.214.121\" stroke-linejoin=\"round\"/><path d=\"m20.5664 21.7344v-3.459\"/><path d=\"m18.5508 21.7461-.016-3.473\"/><path d=\"m16.5547 18.3047.021 3.426\"/></g>`\n\nfunction getCursorCss(svg: string, r: number, tr: number, f: boolean, color: string) {\n\tconst a = (-tr - r) * (PI / 180)\n\tconst s = Math.sin(a)\n\tconst c = Math.cos(a)\n\tconst dx = 1 * c - 1 * s\n\tconst dy = 1 * s + 1 * c\n\n\treturn (\n\t\t`url(\"data:image/svg+xml,<svg height='32' width='32' viewBox='0 0 32 32' xmlns='http://www.w3.org/2000/svg' style='color: ${color};'><defs><filter id='shadow' color-interpolation-filters='sRGB'><feDropShadow dx='${dx}' dy='${dy}' stdDeviation='1.2' flood-opacity='.5'/></filter></defs><g fill='none' transform='rotate(${\n\t\t\tr + tr\n\t\t} 16 16)${f ? ` scale(-1,-1) translate(0, -32)` : ''}' filter='url(%23shadow)'>` +\n\t\tsvg.replaceAll(`\"`, `'`) +\n\t\t'</g></svg>\") 16 16, pointer'\n\t)\n}\n\nconst CURSORS: Record<TLCursorType, (r: number, f: boolean, color: string) => string> = {\n\tnone: () => 'none',\n\tdefault: () => 'default',\n\tpointer: () => 'pointer',\n\tcross: () => 'crosshair',\n\tmove: () => 'move',\n\tgrab: (r, f, c) => getCursorCss(GRAB_SVG, r, 0, f, c),\n\tgrabbing: (r, f, c) => getCursorCss(GRABBING_SVG, r, 0, f, c),\n\ttext: (r, f, c) => getCursorCss(TEXT_SVG, r, 0, f, c),\n\t'resize-edge': (r, f, c) => getCursorCss(EDGE_SVG, r, 0, f, c),\n\t'resize-corner': (r, f, c) => getCursorCss(CORNER_SVG, r, 0, f, c),\n\t'ew-resize': (r, f, c) => getCursorCss(EDGE_SVG, r, 0, f, c),\n\t'ns-resize': (r, f, c) => getCursorCss(EDGE_SVG, r, 90, f, c),\n\t'nesw-resize': (r, f, c) => getCursorCss(CORNER_SVG, r, 0, f, c),\n\t'nwse-resize': (r, f, c) => getCursorCss(CORNER_SVG, r, 90, f, c),\n\trotate: (r, f, c) => getCursorCss(ROTATE_CORNER_SVG, r, 45, f, c),\n\t'nwse-rotate': (r, f, c) => getCursorCss(ROTATE_CORNER_SVG, r, 0, f, c),\n\t'nesw-rotate': (r, f, c) => getCursorCss(ROTATE_CORNER_SVG, r, 90, f, c),\n\t'senw-rotate': (r, f, c) => getCursorCss(ROTATE_CORNER_SVG, r, 180, f, c),\n\t'swne-rotate': (r, f, c) => getCursorCss(ROTATE_CORNER_SVG, r, 270, f, c),\n}\n\nexport function getCursor(cursor: TLCursorType, rotation = 0, color = 'black') {\n\treturn CURSORS[cursor](radiansToDegrees(rotation), false, color)\n}\n\nexport function useCursor() {\n\tconst app = useApp()\n\tconst container = useContainer()\n\n\tuseQuickReactor(\n\t\t'useCursor',\n\t\t() => {\n\t\t\tconst { type, rotation, color } = app.cursor\n\t\t\tcontainer.style.setProperty('--rs-cursor', getCursor(type, rotation, color))\n\t\t},\n\t\t[app, container]\n\t)\n}\n","import { useEffect } from 'react'\nimport { TLKeyboardEventInfo, TLPointerEventInfo } from '../app/types/event-types'\nimport { preventDefault } from '../utils'\nimport { useApp } from './useApp'\nimport { useContainer } from './useContainer'\n\nexport function useDocumentEvents() {\n\tconst app = useApp()\n\tconst container = useContainer()\n\n\tuseEffect(() => {\n\t\tconst handleKeyDown = (e: KeyboardEvent) => {\n\t\t\tif (e.altKey && !app.root.path.value.endsWith('.idle') && !isFocusingInput()) {\n\t\t\t\t// On windows the alt key opens the menu bar.\n\t\t\t\t// We want to prevent that if the user is doing something else,\n\t\t\t\t// e.g. resizing a shape\n\t\t\t\te.preventDefault()\n\t\t\t}\n\n\t\t\tif ((e as any).isKilled) return\n\t\t\t;(e as any).isKilled = true\n\n\t\t\tswitch (e.key) {\n\t\t\t\tcase '=': {\n\t\t\t\t\tif (e.metaKey || e.ctrlKey) {\n\t\t\t\t\t\tpreventDefault(e)\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t\tcase '-': {\n\t\t\t\t\tif (e.metaKey || e.ctrlKey) {\n\t\t\t\t\t\tpreventDefault(e)\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t\tcase '0': {\n\t\t\t\t\tif (e.metaKey || e.ctrlKey) {\n\t\t\t\t\t\tpreventDefault(e)\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t\tcase 'Tab': {\n\t\t\t\t\tif (isFocusingInput() || app.isMenuOpen) {\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t\tcase ',': {\n\t\t\t\t\tif (!isFocusingInput()) {\n\t\t\t\t\t\tpreventDefault(e)\n\t\t\t\t\t\tif (!app.inputs.keys.has(',')) {\n\t\t\t\t\t\t\tconst { x, y, z } = app.inputs.currentScreenPoint\n\t\t\t\t\t\t\tconst {\n\t\t\t\t\t\t\t\tpageState: { hoveredId },\n\t\t\t\t\t\t\t} = app\n\t\t\t\t\t\t\tapp.inputs.keys.add(',')\n\n\t\t\t\t\t\t\tconst info: TLPointerEventInfo = {\n\t\t\t\t\t\t\t\ttype: 'pointer',\n\t\t\t\t\t\t\t\tname: 'pointer_down',\n\t\t\t\t\t\t\t\tpoint: { x, y, z },\n\t\t\t\t\t\t\t\tshiftKey: e.shiftKey,\n\t\t\t\t\t\t\t\taltKey: e.altKey,\n\t\t\t\t\t\t\t\tctrlKey: e.metaKey || e.ctrlKey,\n\t\t\t\t\t\t\t\tpointerId: 0,\n\t\t\t\t\t\t\t\tbutton: 0,\n\t\t\t\t\t\t\t\tisPen: app.isPenMode,\n\t\t\t\t\t\t\t\t...(hoveredId\n\t\t\t\t\t\t\t\t\t? {\n\t\t\t\t\t\t\t\t\t\t\ttarget: 'shape',\n\t\t\t\t\t\t\t\t\t\t\tshape: app.getShapeById(hoveredId)!,\n\t\t\t\t\t\t\t\t\t  }\n\t\t\t\t\t\t\t\t\t: {\n\t\t\t\t\t\t\t\t\t\t\ttarget: 'canvas',\n\t\t\t\t\t\t\t\t\t  }),\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tapp.dispatch(info)\n\t\t\t\t\t\t\treturn\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t\tcase 'Escape': {\n\t\t\t\t\tif (!app.inputs.keys.has('Escape')) {\n\t\t\t\t\t\tapp.inputs.keys.add('Escape')\n\n\t\t\t\t\t\tapp.cancel()\n\t\t\t\t\t}\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\tdefault: {\n\t\t\t\t\tif (isFocusingInput() || app.isMenuOpen) {\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst info: TLKeyboardEventInfo = {\n\t\t\t\ttype: 'keyboard',\n\t\t\t\tname: 'key_down',\n\t\t\t\tkey: e.key,\n\t\t\t\tshiftKey: e.shiftKey,\n\t\t\t\taltKey: e.altKey,\n\t\t\t\tctrlKey: e.metaKey || e.ctrlKey,\n\t\t\t}\n\n\t\t\tapp.dispatch(info)\n\t\t}\n\n\t\tconst handleKeyUp = (e: KeyboardEvent) => {\n\t\t\tif ((e as any).isKilled) return\n\t\t\t;(e as any).isKilled = true\n\n\t\t\tif (isFocusingInput() || app.isMenuOpen) {\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\t// Use the , key to send pointer events\n\t\t\tif (e.key === ',') {\n\t\t\t\tif (document.activeElement?.ELEMENT_NODE) preventDefault(e)\n\t\t\t\tif (app.inputs.keys.has(',')) {\n\t\t\t\t\tconst { x, y, z } = app.inputs.currentScreenPoint\n\t\t\t\t\tconst {\n\t\t\t\t\t\tpageState: { hoveredId },\n\t\t\t\t\t} = app\n\n\t\t\t\t\tapp.inputs.keys.delete(',')\n\n\t\t\t\t\tconst info: TLPointerEventInfo = {\n\t\t\t\t\t\ttype: 'pointer',\n\t\t\t\t\t\tname: 'pointer_up',\n\t\t\t\t\t\tpoint: { x, y, z },\n\t\t\t\t\t\tshiftKey: e.shiftKey,\n\t\t\t\t\t\taltKey: e.altKey,\n\t\t\t\t\t\tctrlKey: e.metaKey || e.ctrlKey,\n\t\t\t\t\t\tpointerId: 0,\n\t\t\t\t\t\tbutton: 0,\n\t\t\t\t\t\tisPen: app.isPenMode,\n\t\t\t\t\t\t...(hoveredId\n\t\t\t\t\t\t\t? {\n\t\t\t\t\t\t\t\t\ttarget: 'shape',\n\t\t\t\t\t\t\t\t\tshape: app.getShapeById(hoveredId)!,\n\t\t\t\t\t\t\t  }\n\t\t\t\t\t\t\t: {\n\t\t\t\t\t\t\t\t\ttarget: 'canvas',\n\t\t\t\t\t\t\t  }),\n\t\t\t\t\t}\n\t\t\t\t\tapp.dispatch(info)\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst info: TLKeyboardEventInfo = {\n\t\t\t\ttype: 'keyboard',\n\t\t\t\tname: 'key_up',\n\t\t\t\tkey: e.key,\n\t\t\t\tshiftKey: e.shiftKey,\n\t\t\t\taltKey: e.altKey,\n\t\t\t\tctrlKey: e.metaKey || e.ctrlKey,\n\t\t\t}\n\n\t\t\tapp.dispatch(info)\n\t\t}\n\n\t\tfunction handleTouchStart(e: TouchEvent) {\n\t\t\tif (container.contains(e.target as Node)) {\n\t\t\t\t// Center point of the touch area\n\t\t\t\tconst touchXPosition = e.touches[0].pageX\n\t\t\t\t// Size of the touch area\n\t\t\t\tconst touchXRadius = e.touches[0].radiusX || 0\n\n\t\t\t\t// We set a threshold (10px) on both sizes of the screen,\n\t\t\t\t// if the touch area overlaps with the screen edges\n\t\t\t\t// it's likely to trigger the navigation. We prevent the\n\t\t\t\t// touchstart event in that case.\n\t\t\t\tif (\n\t\t\t\t\ttouchXPosition - touchXRadius < 10 ||\n\t\t\t\t\ttouchXPosition + touchXRadius > app.viewportScreenBounds.width - 10\n\t\t\t\t) {\n\t\t\t\t\tif ((e.target as HTMLElement)?.tagName === 'BUTTON') {\n\t\t\t\t\t\t// Force a click before bailing\n\t\t\t\t\t\t;(e.target as HTMLButtonElement)?.click()\n\t\t\t\t\t}\n\n\t\t\t\t\tpreventDefault(e)\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Prevent wheel events that occur inside of the container\n\t\tconst handleWheel = (e: WheelEvent) => {\n\t\t\tif (container.contains(e.target as Node) && (e.ctrlKey || e.metaKey)) {\n\t\t\t\tpreventDefault(e)\n\t\t\t}\n\t\t}\n\n\t\tfunction handleBlur() {\n\t\t\tapp.blur()\n\t\t}\n\n\t\tfunction handleFocus() {\n\t\t\tapp.updateViewportScreenBounds()\n\t\t}\n\n\t\tcontainer.addEventListener('touchstart', handleTouchStart, { passive: false })\n\n\t\tdocument.addEventListener('wheel', handleWheel, { passive: false })\n\t\tdocument.addEventListener('gesturestart', preventDefault)\n\t\tdocument.addEventListener('gesturechange', preventDefault)\n\t\tdocument.addEventListener('gestureend', preventDefault)\n\n\t\tdocument.addEventListener('keydown', handleKeyDown)\n\t\tdocument.addEventListener('keyup', handleKeyUp)\n\n\t\twindow.addEventListener('blur', handleBlur)\n\t\twindow.addEventListener('focus', handleFocus)\n\n\t\treturn () => {\n\t\t\tcontainer.removeEventListener('touchstart', handleTouchStart)\n\n\t\t\tdocument.removeEventListener('wheel', handleWheel)\n\t\t\tdocument.removeEventListener('gesturestart', preventDefault)\n\t\t\tdocument.removeEventListener('gesturechange', preventDefault)\n\t\t\tdocument.removeEventListener('gestureend', preventDefault)\n\n\t\t\tdocument.removeEventListener('keydown', handleKeyDown)\n\t\t\tdocument.removeEventListener('keyup', handleKeyUp)\n\n\t\t\twindow.removeEventListener('blur', handleBlur)\n\t\t\twindow.removeEventListener('focus', handleBlur)\n\t\t}\n\t}, [app, container])\n}\n\nconst INPUTS = ['input', 'select', 'button', 'textarea']\n\nfunction isFocusingInput() {\n\tconst { activeElement } = document\n\n\tif (\n\t\tactiveElement &&\n\t\t(activeElement.getAttribute('contenteditble') ||\n\t\t\tINPUTS.indexOf(activeElement.tagName.toLowerCase()) > -1)\n\t) {\n\t\treturn true\n\t}\n\n\treturn false\n}\n","import { useEffect } from 'react'\nimport { preventDefault } from '../utils'\nimport { useApp } from './useApp'\n\nconst IGNORED_TAGS = ['textarea', 'input']\n\n/**\n * When double tapping with the pencil in iOS, it enables a little zoom window in the UI. We don't\n * want this for drawing operations and can disable it by setting 'disableDoubleTapZoom' in the main\n * app.\n */\nexport function useFixSafariDoubleTapZoomPencilEvents(ref: React.RefObject<HTMLElement>) {\n\tconst app = useApp()\n\n\tuseEffect(() => {\n\t\tconst elm = ref.current\n\n\t\tif (!elm) return\n\n\t\tconst handleEvent = (e: PointerEvent | TouchEvent) => {\n\t\t\tif (e instanceof PointerEvent && e.pointerType === 'pen') {\n\t\t\t\t;(e as any).isKilled = true\n\t\t\t\tconst { target } = e\n\n\t\t\t\t// Allow events to propagate if the app is editing a shape, or if the event is occuring in a text area or input\n\t\t\t\tif (\n\t\t\t\t\tIGNORED_TAGS.includes((target as Element).tagName?.toLocaleLowerCase()) ||\n\t\t\t\t\tapp.isIn('select.editing_shape')\n\t\t\t\t) {\n\t\t\t\t\treturn\n\t\t\t\t}\n\n\t\t\t\tpreventDefault(e)\n\t\t\t}\n\t\t}\n\n\t\telm.addEventListener('touchstart', handleEvent)\n\t\telm.addEventListener('touchend', handleEvent)\n\t\treturn () => {\n\t\t\telm.removeEventListener('touchstart', handleEvent)\n\t\t\telm.addEventListener('touchend', handleEvent)\n\t\t}\n\t}, [app, ref])\n}\n","import superPropBase from \"./superPropBase.js\";\nexport default function _get() {\n  if (typeof Reflect !== \"undefined\" && Reflect.get) {\n    _get = Reflect.get.bind();\n  } else {\n    _get = function _get(target, property, receiver) {\n      var base = superPropBase(target, property);\n      if (!base) return;\n      var desc = Object.getOwnPropertyDescriptor(base, property);\n      if (desc.get) {\n        return desc.get.call(arguments.length < 3 ? target : receiver);\n      }\n      return desc.value;\n    };\n  }\n  return _get.apply(this, arguments);\n}","import getPrototypeOf from \"./getPrototypeOf.js\";\nexport default function _superPropBase(object, property) {\n  while (!Object.prototype.hasOwnProperty.call(object, property)) {\n    object = getPrototypeOf(object);\n    if (object === null) break;\n  }\n  return object;\n}","function clamp(v, min, max) {\n  return Math.max(min, Math.min(v, max));\n}\nconst V = {\n  toVector(v, fallback) {\n    if (v === undefined) v = fallback;\n    return Array.isArray(v) ? v : [v, v];\n  },\n  add(v1, v2) {\n    return [v1[0] + v2[0], v1[1] + v2[1]];\n  },\n  sub(v1, v2) {\n    return [v1[0] - v2[0], v1[1] - v2[1]];\n  },\n  addTo(v1, v2) {\n    v1[0] += v2[0];\n    v1[1] += v2[1];\n  },\n  subTo(v1, v2) {\n    v1[0] -= v2[0];\n    v1[1] -= v2[1];\n  }\n};\nfunction rubberband(distance, dimension, constant) {\n  if (dimension === 0 || Math.abs(dimension) === Infinity) return Math.pow(distance, constant * 5);\n  return distance * dimension * constant / (dimension + constant * distance);\n}\nfunction rubberbandIfOutOfBounds(position, min, max, constant = 0.15) {\n  if (constant === 0) return clamp(position, min, max);\n  if (position < min) return -rubberband(min - position, max - min, constant) + min;\n  if (position > max) return +rubberband(position - max, max - min, constant) + max;\n  return position;\n}\nfunction computeRubberband(bounds, [Vx, Vy], [Rx, Ry]) {\n  const [[X0, X1], [Y0, Y1]] = bounds;\n  return [rubberbandIfOutOfBounds(Vx, X0, X1, Rx), rubberbandIfOutOfBounds(Vy, Y0, Y1, Ry)];\n}\n\nexport { V, computeRubberband as c, rubberbandIfOutOfBounds as r };\n","import { V, c as computeRubberband } from './maths-0ab39ae9.esm.js';\n\nfunction _toPrimitive(input, hint) {\n  if (typeof input !== \"object\" || input === null) return input;\n  var prim = input[Symbol.toPrimitive];\n  if (prim !== undefined) {\n    var res = prim.call(input, hint || \"default\");\n    if (typeof res !== \"object\") return res;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (hint === \"string\" ? String : Number)(input);\n}\n\nfunction _toPropertyKey(arg) {\n  var key = _toPrimitive(arg, \"string\");\n  return typeof key === \"symbol\" ? key : String(key);\n}\n\nfunction _defineProperty(obj, key, value) {\n  key = _toPropertyKey(key);\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    enumerableOnly && (symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    })), keys.push.apply(keys, symbols);\n  }\n  return keys;\n}\nfunction _objectSpread2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = null != arguments[i] ? arguments[i] : {};\n    i % 2 ? ownKeys(Object(source), !0).forEach(function (key) {\n      _defineProperty(target, key, source[key]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) {\n      Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n    });\n  }\n  return target;\n}\n\nconst EVENT_TYPE_MAP = {\n  pointer: {\n    start: 'down',\n    change: 'move',\n    end: 'up'\n  },\n  mouse: {\n    start: 'down',\n    change: 'move',\n    end: 'up'\n  },\n  touch: {\n    start: 'start',\n    change: 'move',\n    end: 'end'\n  },\n  gesture: {\n    start: 'start',\n    change: 'change',\n    end: 'end'\n  }\n};\nfunction capitalize(string) {\n  if (!string) return '';\n  return string[0].toUpperCase() + string.slice(1);\n}\nconst actionsWithoutCaptureSupported = ['enter', 'leave'];\nfunction hasCapture(capture = false, actionKey) {\n  return capture && !actionsWithoutCaptureSupported.includes(actionKey);\n}\nfunction toHandlerProp(device, action = '', capture = false) {\n  const deviceProps = EVENT_TYPE_MAP[device];\n  const actionKey = deviceProps ? deviceProps[action] || action : action;\n  return 'on' + capitalize(device) + capitalize(actionKey) + (hasCapture(capture, actionKey) ? 'Capture' : '');\n}\nconst pointerCaptureEvents = ['gotpointercapture', 'lostpointercapture'];\nfunction parseProp(prop) {\n  let eventKey = prop.substring(2).toLowerCase();\n  const passive = !!~eventKey.indexOf('passive');\n  if (passive) eventKey = eventKey.replace('passive', '');\n  const captureKey = pointerCaptureEvents.includes(eventKey) ? 'capturecapture' : 'capture';\n  const capture = !!~eventKey.indexOf(captureKey);\n  if (capture) eventKey = eventKey.replace('capture', '');\n  return {\n    device: eventKey,\n    capture,\n    passive\n  };\n}\nfunction toDomEventType(device, action = '') {\n  const deviceProps = EVENT_TYPE_MAP[device];\n  const actionKey = deviceProps ? deviceProps[action] || action : action;\n  return device + actionKey;\n}\nfunction isTouch(event) {\n  return 'touches' in event;\n}\nfunction getPointerType(event) {\n  if (isTouch(event)) return 'touch';\n  if ('pointerType' in event) return event.pointerType;\n  return 'mouse';\n}\nfunction getCurrentTargetTouchList(event) {\n  return Array.from(event.touches).filter(e => {\n    var _event$currentTarget, _event$currentTarget$;\n    return e.target === event.currentTarget || ((_event$currentTarget = event.currentTarget) === null || _event$currentTarget === void 0 ? void 0 : (_event$currentTarget$ = _event$currentTarget.contains) === null || _event$currentTarget$ === void 0 ? void 0 : _event$currentTarget$.call(_event$currentTarget, e.target));\n  });\n}\nfunction getTouchList(event) {\n  return event.type === 'touchend' || event.type === 'touchcancel' ? event.changedTouches : event.targetTouches;\n}\nfunction getValueEvent(event) {\n  return isTouch(event) ? getTouchList(event)[0] : event;\n}\nfunction distanceAngle(P1, P2) {\n  try {\n    const dx = P2.clientX - P1.clientX;\n    const dy = P2.clientY - P1.clientY;\n    const cx = (P2.clientX + P1.clientX) / 2;\n    const cy = (P2.clientY + P1.clientY) / 2;\n    const distance = Math.hypot(dx, dy);\n    const angle = -(Math.atan2(dx, dy) * 180) / Math.PI;\n    const origin = [cx, cy];\n    return {\n      angle,\n      distance,\n      origin\n    };\n  } catch (_unused) {}\n  return null;\n}\nfunction touchIds(event) {\n  return getCurrentTargetTouchList(event).map(touch => touch.identifier);\n}\nfunction touchDistanceAngle(event, ids) {\n  const [P1, P2] = Array.from(event.touches).filter(touch => ids.includes(touch.identifier));\n  return distanceAngle(P1, P2);\n}\nfunction pointerId(event) {\n  const valueEvent = getValueEvent(event);\n  return isTouch(event) ? valueEvent.identifier : valueEvent.pointerId;\n}\nfunction pointerValues(event) {\n  const valueEvent = getValueEvent(event);\n  return [valueEvent.clientX, valueEvent.clientY];\n}\nconst LINE_HEIGHT = 40;\nconst PAGE_HEIGHT = 800;\nfunction wheelValues(event) {\n  let {\n    deltaX,\n    deltaY,\n    deltaMode\n  } = event;\n  if (deltaMode === 1) {\n    deltaX *= LINE_HEIGHT;\n    deltaY *= LINE_HEIGHT;\n  } else if (deltaMode === 2) {\n    deltaX *= PAGE_HEIGHT;\n    deltaY *= PAGE_HEIGHT;\n  }\n  return [deltaX, deltaY];\n}\nfunction scrollValues(event) {\n  var _ref, _ref2;\n  const {\n    scrollX,\n    scrollY,\n    scrollLeft,\n    scrollTop\n  } = event.currentTarget;\n  return [(_ref = scrollX !== null && scrollX !== void 0 ? scrollX : scrollLeft) !== null && _ref !== void 0 ? _ref : 0, (_ref2 = scrollY !== null && scrollY !== void 0 ? scrollY : scrollTop) !== null && _ref2 !== void 0 ? _ref2 : 0];\n}\nfunction getEventDetails(event) {\n  const payload = {};\n  if ('buttons' in event) payload.buttons = event.buttons;\n  if ('shiftKey' in event) {\n    const {\n      shiftKey,\n      altKey,\n      metaKey,\n      ctrlKey\n    } = event;\n    Object.assign(payload, {\n      shiftKey,\n      altKey,\n      metaKey,\n      ctrlKey\n    });\n  }\n  return payload;\n}\n\nfunction call(v, ...args) {\n  if (typeof v === 'function') {\n    return v(...args);\n  } else {\n    return v;\n  }\n}\nfunction noop() {}\nfunction chain(...fns) {\n  if (fns.length === 0) return noop;\n  if (fns.length === 1) return fns[0];\n  return function () {\n    let result;\n    for (const fn of fns) {\n      result = fn.apply(this, arguments) || result;\n    }\n    return result;\n  };\n}\nfunction assignDefault(value, fallback) {\n  return Object.assign({}, fallback, value || {});\n}\n\nconst BEFORE_LAST_KINEMATICS_DELAY = 32;\nclass Engine {\n  constructor(ctrl, args, key) {\n    this.ctrl = ctrl;\n    this.args = args;\n    this.key = key;\n    if (!this.state) {\n      this.state = {};\n      this.computeValues([0, 0]);\n      this.computeInitial();\n      if (this.init) this.init();\n      this.reset();\n    }\n  }\n  get state() {\n    return this.ctrl.state[this.key];\n  }\n  set state(state) {\n    this.ctrl.state[this.key] = state;\n  }\n  get shared() {\n    return this.ctrl.state.shared;\n  }\n  get eventStore() {\n    return this.ctrl.gestureEventStores[this.key];\n  }\n  get timeoutStore() {\n    return this.ctrl.gestureTimeoutStores[this.key];\n  }\n  get config() {\n    return this.ctrl.config[this.key];\n  }\n  get sharedConfig() {\n    return this.ctrl.config.shared;\n  }\n  get handler() {\n    return this.ctrl.handlers[this.key];\n  }\n  reset() {\n    const {\n      state,\n      shared,\n      ingKey,\n      args\n    } = this;\n    shared[ingKey] = state._active = state.active = state._blocked = state._force = false;\n    state._step = [false, false];\n    state.intentional = false;\n    state._movement = [0, 0];\n    state._distance = [0, 0];\n    state._direction = [0, 0];\n    state._delta = [0, 0];\n    state._bounds = [[-Infinity, Infinity], [-Infinity, Infinity]];\n    state.args = args;\n    state.axis = undefined;\n    state.memo = undefined;\n    state.elapsedTime = state.timeDelta = 0;\n    state.direction = [0, 0];\n    state.distance = [0, 0];\n    state.overflow = [0, 0];\n    state._movementBound = [false, false];\n    state.velocity = [0, 0];\n    state.movement = [0, 0];\n    state.delta = [0, 0];\n    state.timeStamp = 0;\n  }\n  start(event) {\n    const state = this.state;\n    const config = this.config;\n    if (!state._active) {\n      this.reset();\n      this.computeInitial();\n      state._active = true;\n      state.target = event.target;\n      state.currentTarget = event.currentTarget;\n      state.lastOffset = config.from ? call(config.from, state) : state.offset;\n      state.offset = state.lastOffset;\n      state.startTime = state.timeStamp = event.timeStamp;\n    }\n  }\n  computeValues(values) {\n    const state = this.state;\n    state._values = values;\n    state.values = this.config.transform(values);\n  }\n  computeInitial() {\n    const state = this.state;\n    state._initial = state._values;\n    state.initial = state.values;\n  }\n  compute(event) {\n    const {\n      state,\n      config,\n      shared\n    } = this;\n    state.args = this.args;\n    let dt = 0;\n    if (event) {\n      state.event = event;\n      if (config.preventDefault && event.cancelable) state.event.preventDefault();\n      state.type = event.type;\n      shared.touches = this.ctrl.pointerIds.size || this.ctrl.touchIds.size;\n      shared.locked = !!document.pointerLockElement;\n      Object.assign(shared, getEventDetails(event));\n      shared.down = shared.pressed = shared.buttons % 2 === 1 || shared.touches > 0;\n      dt = event.timeStamp - state.timeStamp;\n      state.timeStamp = event.timeStamp;\n      state.elapsedTime = state.timeStamp - state.startTime;\n    }\n    if (state._active) {\n      const _absoluteDelta = state._delta.map(Math.abs);\n      V.addTo(state._distance, _absoluteDelta);\n    }\n    if (this.axisIntent) this.axisIntent(event);\n    const [_m0, _m1] = state._movement;\n    const [t0, t1] = config.threshold;\n    const {\n      _step,\n      values\n    } = state;\n    if (config.hasCustomTransform) {\n      if (_step[0] === false) _step[0] = Math.abs(_m0) >= t0 && values[0];\n      if (_step[1] === false) _step[1] = Math.abs(_m1) >= t1 && values[1];\n    } else {\n      if (_step[0] === false) _step[0] = Math.abs(_m0) >= t0 && Math.sign(_m0) * t0;\n      if (_step[1] === false) _step[1] = Math.abs(_m1) >= t1 && Math.sign(_m1) * t1;\n    }\n    state.intentional = _step[0] !== false || _step[1] !== false;\n    if (!state.intentional) return;\n    const movement = [0, 0];\n    if (config.hasCustomTransform) {\n      const [v0, v1] = values;\n      movement[0] = _step[0] !== false ? v0 - _step[0] : 0;\n      movement[1] = _step[1] !== false ? v1 - _step[1] : 0;\n    } else {\n      movement[0] = _step[0] !== false ? _m0 - _step[0] : 0;\n      movement[1] = _step[1] !== false ? _m1 - _step[1] : 0;\n    }\n    if (this.restrictToAxis && !state._blocked) this.restrictToAxis(movement);\n    const previousOffset = state.offset;\n    const gestureIsActive = state._active && !state._blocked || state.active;\n    if (gestureIsActive) {\n      state.first = state._active && !state.active;\n      state.last = !state._active && state.active;\n      state.active = shared[this.ingKey] = state._active;\n      if (event) {\n        if (state.first) {\n          if ('bounds' in config) state._bounds = call(config.bounds, state);\n          if (this.setup) this.setup();\n        }\n        state.movement = movement;\n        this.computeOffset();\n      }\n    }\n    const [ox, oy] = state.offset;\n    const [[x0, x1], [y0, y1]] = state._bounds;\n    state.overflow = [ox < x0 ? -1 : ox > x1 ? 1 : 0, oy < y0 ? -1 : oy > y1 ? 1 : 0];\n    state._movementBound[0] = state.overflow[0] ? state._movementBound[0] === false ? state._movement[0] : state._movementBound[0] : false;\n    state._movementBound[1] = state.overflow[1] ? state._movementBound[1] === false ? state._movement[1] : state._movementBound[1] : false;\n    const rubberband = state._active ? config.rubberband || [0, 0] : [0, 0];\n    state.offset = computeRubberband(state._bounds, state.offset, rubberband);\n    state.delta = V.sub(state.offset, previousOffset);\n    this.computeMovement();\n    if (gestureIsActive && (!state.last || dt > BEFORE_LAST_KINEMATICS_DELAY)) {\n      state.delta = V.sub(state.offset, previousOffset);\n      const absoluteDelta = state.delta.map(Math.abs);\n      V.addTo(state.distance, absoluteDelta);\n      state.direction = state.delta.map(Math.sign);\n      state._direction = state._delta.map(Math.sign);\n      if (!state.first && dt > 0) {\n        state.velocity = [absoluteDelta[0] / dt, absoluteDelta[1] / dt];\n        state.timeDelta = dt;\n      }\n    }\n  }\n  emit() {\n    const state = this.state;\n    const shared = this.shared;\n    const config = this.config;\n    if (!state._active) this.clean();\n    if ((state._blocked || !state.intentional) && !state._force && !config.triggerAllEvents) return;\n    const memo = this.handler(_objectSpread2(_objectSpread2(_objectSpread2({}, shared), state), {}, {\n      [this.aliasKey]: state.values\n    }));\n    if (memo !== undefined) state.memo = memo;\n  }\n  clean() {\n    this.eventStore.clean();\n    this.timeoutStore.clean();\n  }\n}\n\nfunction selectAxis([dx, dy], threshold) {\n  const absDx = Math.abs(dx);\n  const absDy = Math.abs(dy);\n  if (absDx > absDy && absDx > threshold) {\n    return 'x';\n  }\n  if (absDy > absDx && absDy > threshold) {\n    return 'y';\n  }\n  return undefined;\n}\nclass CoordinatesEngine extends Engine {\n  constructor(...args) {\n    super(...args);\n    _defineProperty(this, \"aliasKey\", 'xy');\n  }\n  reset() {\n    super.reset();\n    this.state.axis = undefined;\n  }\n  init() {\n    this.state.offset = [0, 0];\n    this.state.lastOffset = [0, 0];\n  }\n  computeOffset() {\n    this.state.offset = V.add(this.state.lastOffset, this.state.movement);\n  }\n  computeMovement() {\n    this.state.movement = V.sub(this.state.offset, this.state.lastOffset);\n  }\n  axisIntent(event) {\n    const state = this.state;\n    const config = this.config;\n    if (!state.axis && event) {\n      const threshold = typeof config.axisThreshold === 'object' ? config.axisThreshold[getPointerType(event)] : config.axisThreshold;\n      state.axis = selectAxis(state._movement, threshold);\n    }\n    state._blocked = (config.lockDirection || !!config.axis) && !state.axis || !!config.axis && config.axis !== state.axis;\n  }\n  restrictToAxis(v) {\n    if (this.config.axis || this.config.lockDirection) {\n      switch (this.state.axis) {\n        case 'x':\n          v[1] = 0;\n          break;\n        case 'y':\n          v[0] = 0;\n          break;\n      }\n    }\n  }\n}\n\nconst identity = v => v;\nconst DEFAULT_RUBBERBAND = 0.15;\nconst commonConfigResolver = {\n  enabled(value = true) {\n    return value;\n  },\n  eventOptions(value, _k, config) {\n    return _objectSpread2(_objectSpread2({}, config.shared.eventOptions), value);\n  },\n  preventDefault(value = false) {\n    return value;\n  },\n  triggerAllEvents(value = false) {\n    return value;\n  },\n  rubberband(value = 0) {\n    switch (value) {\n      case true:\n        return [DEFAULT_RUBBERBAND, DEFAULT_RUBBERBAND];\n      case false:\n        return [0, 0];\n      default:\n        return V.toVector(value);\n    }\n  },\n  from(value) {\n    if (typeof value === 'function') return value;\n    if (value != null) return V.toVector(value);\n  },\n  transform(value, _k, config) {\n    const transform = value || config.shared.transform;\n    this.hasCustomTransform = !!transform;\n    if (process.env.NODE_ENV === 'development') {\n      const originalTransform = transform || identity;\n      return v => {\n        const r = originalTransform(v);\n        if (!isFinite(r[0]) || !isFinite(r[1])) {\n          console.warn(`[@use-gesture]: config.transform() must produce a valid result, but it was: [${r[0]},${[1]}]`);\n        }\n        return r;\n      };\n    }\n    return transform || identity;\n  },\n  threshold(value) {\n    return V.toVector(value, 0);\n  }\n};\nif (process.env.NODE_ENV === 'development') {\n  Object.assign(commonConfigResolver, {\n    domTarget(value) {\n      if (value !== undefined) {\n        throw Error(`[@use-gesture]: \\`domTarget\\` option has been renamed to \\`target\\`.`);\n      }\n      return NaN;\n    },\n    lockDirection(value) {\n      if (value !== undefined) {\n        throw Error(`[@use-gesture]: \\`lockDirection\\` option has been merged with \\`axis\\`. Use it as in \\`{ axis: 'lock' }\\``);\n      }\n      return NaN;\n    },\n    initial(value) {\n      if (value !== undefined) {\n        throw Error(`[@use-gesture]: \\`initial\\` option has been renamed to \\`from\\`.`);\n      }\n      return NaN;\n    }\n  });\n}\n\nconst DEFAULT_AXIS_THRESHOLD = 0;\nconst coordinatesConfigResolver = _objectSpread2(_objectSpread2({}, commonConfigResolver), {}, {\n  axis(_v, _k, {\n    axis\n  }) {\n    this.lockDirection = axis === 'lock';\n    if (!this.lockDirection) return axis;\n  },\n  axisThreshold(value = DEFAULT_AXIS_THRESHOLD) {\n    return value;\n  },\n  bounds(value = {}) {\n    if (typeof value === 'function') {\n      return state => coordinatesConfigResolver.bounds(value(state));\n    }\n    if ('current' in value) {\n      return () => value.current;\n    }\n    if (typeof HTMLElement === 'function' && value instanceof HTMLElement) {\n      return value;\n    }\n    const {\n      left = -Infinity,\n      right = Infinity,\n      top = -Infinity,\n      bottom = Infinity\n    } = value;\n    return [[left, right], [top, bottom]];\n  }\n});\n\nconst KEYS_DELTA_MAP = {\n  ArrowRight: (displacement, factor = 1) => [displacement * factor, 0],\n  ArrowLeft: (displacement, factor = 1) => [-1 * displacement * factor, 0],\n  ArrowUp: (displacement, factor = 1) => [0, -1 * displacement * factor],\n  ArrowDown: (displacement, factor = 1) => [0, displacement * factor]\n};\nclass DragEngine extends CoordinatesEngine {\n  constructor(...args) {\n    super(...args);\n    _defineProperty(this, \"ingKey\", 'dragging');\n  }\n  reset() {\n    super.reset();\n    const state = this.state;\n    state._pointerId = undefined;\n    state._pointerActive = false;\n    state._keyboardActive = false;\n    state._preventScroll = false;\n    state._delayed = false;\n    state.swipe = [0, 0];\n    state.tap = false;\n    state.canceled = false;\n    state.cancel = this.cancel.bind(this);\n  }\n  setup() {\n    const state = this.state;\n    if (state._bounds instanceof HTMLElement) {\n      const boundRect = state._bounds.getBoundingClientRect();\n      const targetRect = state.currentTarget.getBoundingClientRect();\n      const _bounds = {\n        left: boundRect.left - targetRect.left + state.offset[0],\n        right: boundRect.right - targetRect.right + state.offset[0],\n        top: boundRect.top - targetRect.top + state.offset[1],\n        bottom: boundRect.bottom - targetRect.bottom + state.offset[1]\n      };\n      state._bounds = coordinatesConfigResolver.bounds(_bounds);\n    }\n  }\n  cancel() {\n    const state = this.state;\n    if (state.canceled) return;\n    state.canceled = true;\n    state._active = false;\n    setTimeout(() => {\n      this.compute();\n      this.emit();\n    }, 0);\n  }\n  setActive() {\n    this.state._active = this.state._pointerActive || this.state._keyboardActive;\n  }\n  clean() {\n    this.pointerClean();\n    this.state._pointerActive = false;\n    this.state._keyboardActive = false;\n    super.clean();\n  }\n  pointerDown(event) {\n    const config = this.config;\n    const state = this.state;\n    if (event.buttons != null && (Array.isArray(config.pointerButtons) ? !config.pointerButtons.includes(event.buttons) : config.pointerButtons !== -1 && config.pointerButtons !== event.buttons)) return;\n    const ctrlIds = this.ctrl.setEventIds(event);\n    if (config.pointerCapture) {\n      event.target.setPointerCapture(event.pointerId);\n    }\n    if (ctrlIds && ctrlIds.size > 1 && state._pointerActive) return;\n    this.start(event);\n    this.setupPointer(event);\n    state._pointerId = pointerId(event);\n    state._pointerActive = true;\n    this.computeValues(pointerValues(event));\n    this.computeInitial();\n    if (config.preventScrollAxis && getPointerType(event) !== 'mouse') {\n      state._active = false;\n      this.setupScrollPrevention(event);\n    } else if (config.delay > 0) {\n      this.setupDelayTrigger(event);\n      if (config.triggerAllEvents) {\n        this.compute(event);\n        this.emit();\n      }\n    } else {\n      this.startPointerDrag(event);\n    }\n  }\n  startPointerDrag(event) {\n    const state = this.state;\n    state._active = true;\n    state._preventScroll = true;\n    state._delayed = false;\n    this.compute(event);\n    this.emit();\n  }\n  pointerMove(event) {\n    const state = this.state;\n    const config = this.config;\n    if (!state._pointerActive) return;\n    if (state.type === event.type && event.timeStamp === state.timeStamp) return;\n    const id = pointerId(event);\n    if (state._pointerId !== undefined && id !== state._pointerId) return;\n    const _values = pointerValues(event);\n    if (document.pointerLockElement === event.target) {\n      state._delta = [event.movementX, event.movementY];\n    } else {\n      state._delta = V.sub(_values, state._values);\n      this.computeValues(_values);\n    }\n    V.addTo(state._movement, state._delta);\n    this.compute(event);\n    if (state._delayed && state.intentional) {\n      this.timeoutStore.remove('dragDelay');\n      state.active = false;\n      this.startPointerDrag(event);\n      return;\n    }\n    if (config.preventScrollAxis && !state._preventScroll) {\n      if (state.axis) {\n        if (state.axis === config.preventScrollAxis || config.preventScrollAxis === 'xy') {\n          state._active = false;\n          this.clean();\n          return;\n        } else {\n          this.timeoutStore.remove('startPointerDrag');\n          this.startPointerDrag(event);\n          return;\n        }\n      } else {\n        return;\n      }\n    }\n    this.emit();\n  }\n  pointerUp(event) {\n    this.ctrl.setEventIds(event);\n    try {\n      if (this.config.pointerCapture && event.target.hasPointerCapture(event.pointerId)) {\n        ;\n        event.target.releasePointerCapture(event.pointerId);\n      }\n    } catch (_unused) {\n      if (process.env.NODE_ENV === 'development') {\n        console.warn(`[@use-gesture]: If you see this message, it's likely that you're using an outdated version of \\`@react-three/fiber\\`. \\n\\nPlease upgrade to the latest version.`);\n      }\n    }\n    const state = this.state;\n    const config = this.config;\n    if (!state._active || !state._pointerActive) return;\n    const id = pointerId(event);\n    if (state._pointerId !== undefined && id !== state._pointerId) return;\n    this.state._pointerActive = false;\n    this.setActive();\n    this.compute(event);\n    const [dx, dy] = state._distance;\n    state.tap = dx <= config.tapsThreshold && dy <= config.tapsThreshold;\n    if (state.tap && config.filterTaps) {\n      state._force = true;\n    } else {\n      const [_dx, _dy] = state._delta;\n      const [_mx, _my] = state._movement;\n      const [svx, svy] = config.swipe.velocity;\n      const [sx, sy] = config.swipe.distance;\n      const sdt = config.swipe.duration;\n      if (state.elapsedTime < sdt) {\n        const _vx = Math.abs(_dx / state.timeDelta);\n        const _vy = Math.abs(_dy / state.timeDelta);\n        if (_vx > svx && Math.abs(_mx) > sx) state.swipe[0] = Math.sign(_dx);\n        if (_vy > svy && Math.abs(_my) > sy) state.swipe[1] = Math.sign(_dy);\n      }\n    }\n    this.emit();\n  }\n  pointerClick(event) {\n    if (!this.state.tap && event.detail > 0) {\n      event.preventDefault();\n      event.stopPropagation();\n    }\n  }\n  setupPointer(event) {\n    const config = this.config;\n    const device = config.device;\n    if (process.env.NODE_ENV === 'development') {\n      try {\n        if (device === 'pointer' && config.preventScrollDelay === undefined) {\n          const currentTarget = 'uv' in event ? event.sourceEvent.currentTarget : event.currentTarget;\n          const style = window.getComputedStyle(currentTarget);\n          if (style.touchAction === 'auto') {\n            console.warn(`[@use-gesture]: The drag target has its \\`touch-action\\` style property set to \\`auto\\`. It is recommended to add \\`touch-action: 'none'\\` so that the drag gesture behaves correctly on touch-enabled devices. For more information read this: https://use-gesture.netlify.app/docs/extras/#touch-action.\\n\\nThis message will only show in development mode. It won't appear in production. If this is intended, you can ignore it.`, currentTarget);\n          }\n        }\n      } catch (_unused2) {}\n    }\n    if (config.pointerLock) {\n      event.currentTarget.requestPointerLock();\n    }\n    if (!config.pointerCapture) {\n      this.eventStore.add(this.sharedConfig.window, device, 'change', this.pointerMove.bind(this));\n      this.eventStore.add(this.sharedConfig.window, device, 'end', this.pointerUp.bind(this));\n      this.eventStore.add(this.sharedConfig.window, device, 'cancel', this.pointerUp.bind(this));\n    }\n  }\n  pointerClean() {\n    if (this.config.pointerLock && document.pointerLockElement === this.state.currentTarget) {\n      document.exitPointerLock();\n    }\n  }\n  preventScroll(event) {\n    if (this.state._preventScroll && event.cancelable) {\n      event.preventDefault();\n    }\n  }\n  setupScrollPrevention(event) {\n    this.state._preventScroll = false;\n    persistEvent(event);\n    const remove = this.eventStore.add(this.sharedConfig.window, 'touch', 'change', this.preventScroll.bind(this), {\n      passive: false\n    });\n    this.eventStore.add(this.sharedConfig.window, 'touch', 'end', remove);\n    this.eventStore.add(this.sharedConfig.window, 'touch', 'cancel', remove);\n    this.timeoutStore.add('startPointerDrag', this.startPointerDrag.bind(this), this.config.preventScrollDelay, event);\n  }\n  setupDelayTrigger(event) {\n    this.state._delayed = true;\n    this.timeoutStore.add('dragDelay', () => {\n      this.state._step = [0, 0];\n      this.startPointerDrag(event);\n    }, this.config.delay);\n  }\n  keyDown(event) {\n    const deltaFn = KEYS_DELTA_MAP[event.key];\n    if (deltaFn) {\n      const state = this.state;\n      const factor = event.shiftKey ? 10 : event.altKey ? 0.1 : 1;\n      this.start(event);\n      state._delta = deltaFn(this.config.keyboardDisplacement, factor);\n      state._keyboardActive = true;\n      V.addTo(state._movement, state._delta);\n      this.compute(event);\n      this.emit();\n    }\n  }\n  keyUp(event) {\n    if (!(event.key in KEYS_DELTA_MAP)) return;\n    this.state._keyboardActive = false;\n    this.setActive();\n    this.compute(event);\n    this.emit();\n  }\n  bind(bindFunction) {\n    const device = this.config.device;\n    bindFunction(device, 'start', this.pointerDown.bind(this));\n    if (this.config.pointerCapture) {\n      bindFunction(device, 'change', this.pointerMove.bind(this));\n      bindFunction(device, 'end', this.pointerUp.bind(this));\n      bindFunction(device, 'cancel', this.pointerUp.bind(this));\n      bindFunction('lostPointerCapture', '', this.pointerUp.bind(this));\n    }\n    if (this.config.keys) {\n      bindFunction('key', 'down', this.keyDown.bind(this));\n      bindFunction('key', 'up', this.keyUp.bind(this));\n    }\n    if (this.config.filterTaps) {\n      bindFunction('click', '', this.pointerClick.bind(this), {\n        capture: true,\n        passive: false\n      });\n    }\n  }\n}\nfunction persistEvent(event) {\n  'persist' in event && typeof event.persist === 'function' && event.persist();\n}\n\nconst isBrowser = typeof window !== 'undefined' && window.document && window.document.createElement;\nfunction supportsTouchEvents() {\n  return isBrowser && 'ontouchstart' in window;\n}\nfunction isTouchScreen() {\n  return supportsTouchEvents() || isBrowser && window.navigator.maxTouchPoints > 1;\n}\nfunction supportsPointerEvents() {\n  return isBrowser && 'onpointerdown' in window;\n}\nfunction supportsPointerLock() {\n  return isBrowser && 'exitPointerLock' in window.document;\n}\nfunction supportsGestureEvents() {\n  try {\n    return 'constructor' in GestureEvent;\n  } catch (e) {\n    return false;\n  }\n}\nconst SUPPORT = {\n  isBrowser,\n  gesture: supportsGestureEvents(),\n  touch: isTouchScreen(),\n  touchscreen: isTouchScreen(),\n  pointer: supportsPointerEvents(),\n  pointerLock: supportsPointerLock()\n};\n\nconst DEFAULT_PREVENT_SCROLL_DELAY = 250;\nconst DEFAULT_DRAG_DELAY = 180;\nconst DEFAULT_SWIPE_VELOCITY = 0.5;\nconst DEFAULT_SWIPE_DISTANCE = 50;\nconst DEFAULT_SWIPE_DURATION = 250;\nconst DEFAULT_KEYBOARD_DISPLACEMENT = 10;\nconst DEFAULT_DRAG_AXIS_THRESHOLD = {\n  mouse: 0,\n  touch: 0,\n  pen: 8\n};\nconst dragConfigResolver = _objectSpread2(_objectSpread2({}, coordinatesConfigResolver), {}, {\n  device(_v, _k, {\n    pointer: {\n      touch = false,\n      lock = false,\n      mouse = false\n    } = {}\n  }) {\n    this.pointerLock = lock && SUPPORT.pointerLock;\n    if (SUPPORT.touch && touch) return 'touch';\n    if (this.pointerLock) return 'mouse';\n    if (SUPPORT.pointer && !mouse) return 'pointer';\n    if (SUPPORT.touch) return 'touch';\n    return 'mouse';\n  },\n  preventScrollAxis(value, _k, {\n    preventScroll\n  }) {\n    this.preventScrollDelay = typeof preventScroll === 'number' ? preventScroll : preventScroll || preventScroll === undefined && value ? DEFAULT_PREVENT_SCROLL_DELAY : undefined;\n    if (!SUPPORT.touchscreen || preventScroll === false) return undefined;\n    return value ? value : preventScroll !== undefined ? 'y' : undefined;\n  },\n  pointerCapture(_v, _k, {\n    pointer: {\n      capture = true,\n      buttons = 1,\n      keys = true\n    } = {}\n  }) {\n    this.pointerButtons = buttons;\n    this.keys = keys;\n    return !this.pointerLock && this.device === 'pointer' && capture;\n  },\n  threshold(value, _k, {\n    filterTaps = false,\n    tapsThreshold = 3,\n    axis = undefined\n  }) {\n    const threshold = V.toVector(value, filterTaps ? tapsThreshold : axis ? 1 : 0);\n    this.filterTaps = filterTaps;\n    this.tapsThreshold = tapsThreshold;\n    return threshold;\n  },\n  swipe({\n    velocity = DEFAULT_SWIPE_VELOCITY,\n    distance = DEFAULT_SWIPE_DISTANCE,\n    duration = DEFAULT_SWIPE_DURATION\n  } = {}) {\n    return {\n      velocity: this.transform(V.toVector(velocity)),\n      distance: this.transform(V.toVector(distance)),\n      duration\n    };\n  },\n  delay(value = 0) {\n    switch (value) {\n      case true:\n        return DEFAULT_DRAG_DELAY;\n      case false:\n        return 0;\n      default:\n        return value;\n    }\n  },\n  axisThreshold(value) {\n    if (!value) return DEFAULT_DRAG_AXIS_THRESHOLD;\n    return _objectSpread2(_objectSpread2({}, DEFAULT_DRAG_AXIS_THRESHOLD), value);\n  },\n  keyboardDisplacement(value = DEFAULT_KEYBOARD_DISPLACEMENT) {\n    return value;\n  }\n});\nif (process.env.NODE_ENV === 'development') {\n  Object.assign(dragConfigResolver, {\n    useTouch(value) {\n      if (value !== undefined) {\n        throw Error(`[@use-gesture]: \\`useTouch\\` option has been renamed to \\`pointer.touch\\`. Use it as in \\`{ pointer: { touch: true } }\\`.`);\n      }\n      return NaN;\n    },\n    experimental_preventWindowScrollY(value) {\n      if (value !== undefined) {\n        throw Error(`[@use-gesture]: \\`experimental_preventWindowScrollY\\` option has been renamed to \\`preventScroll\\`.`);\n      }\n      return NaN;\n    },\n    swipeVelocity(value) {\n      if (value !== undefined) {\n        throw Error(`[@use-gesture]: \\`swipeVelocity\\` option has been renamed to \\`swipe.velocity\\`. Use it as in \\`{ swipe: { velocity: 0.5 } }\\`.`);\n      }\n      return NaN;\n    },\n    swipeDistance(value) {\n      if (value !== undefined) {\n        throw Error(`[@use-gesture]: \\`swipeDistance\\` option has been renamed to \\`swipe.distance\\`. Use it as in \\`{ swipe: { distance: 50 } }\\`.`);\n      }\n      return NaN;\n    },\n    swipeDuration(value) {\n      if (value !== undefined) {\n        throw Error(`[@use-gesture]: \\`swipeDuration\\` option has been renamed to \\`swipe.duration\\`. Use it as in \\`{ swipe: { duration: 250 } }\\`.`);\n      }\n      return NaN;\n    }\n  });\n}\n\nfunction clampStateInternalMovementToBounds(state) {\n  const [ox, oy] = state.overflow;\n  const [dx, dy] = state._delta;\n  const [dirx, diry] = state._direction;\n  if (ox < 0 && dx > 0 && dirx < 0 || ox > 0 && dx < 0 && dirx > 0) {\n    state._movement[0] = state._movementBound[0];\n  }\n  if (oy < 0 && dy > 0 && diry < 0 || oy > 0 && dy < 0 && diry > 0) {\n    state._movement[1] = state._movementBound[1];\n  }\n}\n\nconst SCALE_ANGLE_RATIO_INTENT_DEG = 30;\nconst PINCH_WHEEL_RATIO = 100;\nclass PinchEngine extends Engine {\n  constructor(...args) {\n    super(...args);\n    _defineProperty(this, \"ingKey\", 'pinching');\n    _defineProperty(this, \"aliasKey\", 'da');\n  }\n  init() {\n    this.state.offset = [1, 0];\n    this.state.lastOffset = [1, 0];\n    this.state._pointerEvents = new Map();\n  }\n  reset() {\n    super.reset();\n    const state = this.state;\n    state._touchIds = [];\n    state.canceled = false;\n    state.cancel = this.cancel.bind(this);\n    state.turns = 0;\n  }\n  computeOffset() {\n    const {\n      type,\n      movement,\n      lastOffset\n    } = this.state;\n    if (type === 'wheel') {\n      this.state.offset = V.add(movement, lastOffset);\n    } else {\n      this.state.offset = [(1 + movement[0]) * lastOffset[0], movement[1] + lastOffset[1]];\n    }\n  }\n  computeMovement() {\n    const {\n      offset,\n      lastOffset\n    } = this.state;\n    this.state.movement = [offset[0] / lastOffset[0], offset[1] - lastOffset[1]];\n  }\n  axisIntent() {\n    const state = this.state;\n    const [_m0, _m1] = state._movement;\n    if (!state.axis) {\n      const axisMovementDifference = Math.abs(_m0) * SCALE_ANGLE_RATIO_INTENT_DEG - Math.abs(_m1);\n      if (axisMovementDifference < 0) state.axis = 'angle';else if (axisMovementDifference > 0) state.axis = 'scale';\n    }\n  }\n  restrictToAxis(v) {\n    if (this.config.lockDirection) {\n      if (this.state.axis === 'scale') v[1] = 0;else if (this.state.axis === 'angle') v[0] = 0;\n    }\n  }\n  cancel() {\n    const state = this.state;\n    if (state.canceled) return;\n    setTimeout(() => {\n      state.canceled = true;\n      state._active = false;\n      this.compute();\n      this.emit();\n    }, 0);\n  }\n  touchStart(event) {\n    this.ctrl.setEventIds(event);\n    const state = this.state;\n    const ctrlTouchIds = this.ctrl.touchIds;\n    if (state._active) {\n      if (state._touchIds.every(id => ctrlTouchIds.has(id))) return;\n    }\n    if (ctrlTouchIds.size < 2) return;\n    this.start(event);\n    state._touchIds = Array.from(ctrlTouchIds).slice(0, 2);\n    const payload = touchDistanceAngle(event, state._touchIds);\n    if (!payload) return;\n    this.pinchStart(event, payload);\n  }\n  pointerStart(event) {\n    if (event.buttons != null && event.buttons % 2 !== 1) return;\n    this.ctrl.setEventIds(event);\n    event.target.setPointerCapture(event.pointerId);\n    const state = this.state;\n    const _pointerEvents = state._pointerEvents;\n    const ctrlPointerIds = this.ctrl.pointerIds;\n    if (state._active) {\n      if (Array.from(_pointerEvents.keys()).every(id => ctrlPointerIds.has(id))) return;\n    }\n    if (_pointerEvents.size < 2) {\n      _pointerEvents.set(event.pointerId, event);\n    }\n    if (state._pointerEvents.size < 2) return;\n    this.start(event);\n    const payload = distanceAngle(...Array.from(_pointerEvents.values()));\n    if (!payload) return;\n    this.pinchStart(event, payload);\n  }\n  pinchStart(event, payload) {\n    const state = this.state;\n    state.origin = payload.origin;\n    this.computeValues([payload.distance, payload.angle]);\n    this.computeInitial();\n    this.compute(event);\n    this.emit();\n  }\n  touchMove(event) {\n    if (!this.state._active) return;\n    const payload = touchDistanceAngle(event, this.state._touchIds);\n    if (!payload) return;\n    this.pinchMove(event, payload);\n  }\n  pointerMove(event) {\n    const _pointerEvents = this.state._pointerEvents;\n    if (_pointerEvents.has(event.pointerId)) {\n      _pointerEvents.set(event.pointerId, event);\n    }\n    if (!this.state._active) return;\n    const payload = distanceAngle(...Array.from(_pointerEvents.values()));\n    if (!payload) return;\n    this.pinchMove(event, payload);\n  }\n  pinchMove(event, payload) {\n    const state = this.state;\n    const prev_a = state._values[1];\n    const delta_a = payload.angle - prev_a;\n    let delta_turns = 0;\n    if (Math.abs(delta_a) > 270) delta_turns += Math.sign(delta_a);\n    this.computeValues([payload.distance, payload.angle - 360 * delta_turns]);\n    state.origin = payload.origin;\n    state.turns = delta_turns;\n    state._movement = [state._values[0] / state._initial[0] - 1, state._values[1] - state._initial[1]];\n    this.compute(event);\n    this.emit();\n  }\n  touchEnd(event) {\n    this.ctrl.setEventIds(event);\n    if (!this.state._active) return;\n    if (this.state._touchIds.some(id => !this.ctrl.touchIds.has(id))) {\n      this.state._active = false;\n      this.compute(event);\n      this.emit();\n    }\n  }\n  pointerEnd(event) {\n    const state = this.state;\n    this.ctrl.setEventIds(event);\n    try {\n      event.target.releasePointerCapture(event.pointerId);\n    } catch (_unused) {}\n    if (state._pointerEvents.has(event.pointerId)) {\n      state._pointerEvents.delete(event.pointerId);\n    }\n    if (!state._active) return;\n    if (state._pointerEvents.size < 2) {\n      state._active = false;\n      this.compute(event);\n      this.emit();\n    }\n  }\n  gestureStart(event) {\n    if (event.cancelable) event.preventDefault();\n    const state = this.state;\n    if (state._active) return;\n    this.start(event);\n    this.computeValues([event.scale, event.rotation]);\n    state.origin = [event.clientX, event.clientY];\n    this.compute(event);\n    this.emit();\n  }\n  gestureMove(event) {\n    if (event.cancelable) event.preventDefault();\n    if (!this.state._active) return;\n    const state = this.state;\n    this.computeValues([event.scale, event.rotation]);\n    state.origin = [event.clientX, event.clientY];\n    const _previousMovement = state._movement;\n    state._movement = [event.scale - 1, event.rotation];\n    state._delta = V.sub(state._movement, _previousMovement);\n    this.compute(event);\n    this.emit();\n  }\n  gestureEnd(event) {\n    if (!this.state._active) return;\n    this.state._active = false;\n    this.compute(event);\n    this.emit();\n  }\n  wheel(event) {\n    const modifierKey = this.config.modifierKey;\n    if (modifierKey && !event[modifierKey]) return;\n    if (!this.state._active) this.wheelStart(event);else this.wheelChange(event);\n    this.timeoutStore.add('wheelEnd', this.wheelEnd.bind(this));\n  }\n  wheelStart(event) {\n    this.start(event);\n    this.wheelChange(event);\n  }\n  wheelChange(event) {\n    const isR3f = ('uv' in event);\n    if (!isR3f) {\n      if (event.cancelable) {\n        event.preventDefault();\n      }\n      if (process.env.NODE_ENV === 'development' && !event.defaultPrevented) {\n        console.warn(`[@use-gesture]: To properly support zoom on trackpads, try using the \\`target\\` option.\\n\\nThis message will only appear in development mode.`);\n      }\n    }\n    const state = this.state;\n    state._delta = [-wheelValues(event)[1] / PINCH_WHEEL_RATIO * state.offset[0], 0];\n    V.addTo(state._movement, state._delta);\n    clampStateInternalMovementToBounds(state);\n    this.state.origin = [event.clientX, event.clientY];\n    this.compute(event);\n    this.emit();\n  }\n  wheelEnd() {\n    if (!this.state._active) return;\n    this.state._active = false;\n    this.compute();\n    this.emit();\n  }\n  bind(bindFunction) {\n    const device = this.config.device;\n    if (!!device) {\n      bindFunction(device, 'start', this[device + 'Start'].bind(this));\n      bindFunction(device, 'change', this[device + 'Move'].bind(this));\n      bindFunction(device, 'end', this[device + 'End'].bind(this));\n      bindFunction(device, 'cancel', this[device + 'End'].bind(this));\n    }\n    if (this.config.pinchOnWheel) {\n      bindFunction('wheel', '', this.wheel.bind(this), {\n        passive: false\n      });\n    }\n  }\n}\n\nconst pinchConfigResolver = _objectSpread2(_objectSpread2({}, commonConfigResolver), {}, {\n  device(_v, _k, {\n    shared,\n    pointer: {\n      touch = false\n    } = {}\n  }) {\n    const sharedConfig = shared;\n    if (sharedConfig.target && !SUPPORT.touch && SUPPORT.gesture) return 'gesture';\n    if (SUPPORT.touch && touch) return 'touch';\n    if (SUPPORT.touchscreen) {\n      if (SUPPORT.pointer) return 'pointer';\n      if (SUPPORT.touch) return 'touch';\n    }\n  },\n  bounds(_v, _k, {\n    scaleBounds = {},\n    angleBounds = {}\n  }) {\n    const _scaleBounds = state => {\n      const D = assignDefault(call(scaleBounds, state), {\n        min: -Infinity,\n        max: Infinity\n      });\n      return [D.min, D.max];\n    };\n    const _angleBounds = state => {\n      const A = assignDefault(call(angleBounds, state), {\n        min: -Infinity,\n        max: Infinity\n      });\n      return [A.min, A.max];\n    };\n    if (typeof scaleBounds !== 'function' && typeof angleBounds !== 'function') return [_scaleBounds(), _angleBounds()];\n    return state => [_scaleBounds(state), _angleBounds(state)];\n  },\n  threshold(value, _k, config) {\n    this.lockDirection = config.axis === 'lock';\n    const threshold = V.toVector(value, this.lockDirection ? [0.1, 3] : 0);\n    return threshold;\n  },\n  modifierKey(value) {\n    if (value === undefined) return 'ctrlKey';\n    return value;\n  },\n  pinchOnWheel(value = true) {\n    return value;\n  }\n});\n\nclass MoveEngine extends CoordinatesEngine {\n  constructor(...args) {\n    super(...args);\n    _defineProperty(this, \"ingKey\", 'moving');\n  }\n  move(event) {\n    if (this.config.mouseOnly && event.pointerType !== 'mouse') return;\n    if (!this.state._active) this.moveStart(event);else this.moveChange(event);\n    this.timeoutStore.add('moveEnd', this.moveEnd.bind(this));\n  }\n  moveStart(event) {\n    this.start(event);\n    this.computeValues(pointerValues(event));\n    this.compute(event);\n    this.computeInitial();\n    this.emit();\n  }\n  moveChange(event) {\n    if (!this.state._active) return;\n    const values = pointerValues(event);\n    const state = this.state;\n    state._delta = V.sub(values, state._values);\n    V.addTo(state._movement, state._delta);\n    this.computeValues(values);\n    this.compute(event);\n    this.emit();\n  }\n  moveEnd(event) {\n    if (!this.state._active) return;\n    this.state._active = false;\n    this.compute(event);\n    this.emit();\n  }\n  bind(bindFunction) {\n    bindFunction('pointer', 'change', this.move.bind(this));\n    bindFunction('pointer', 'leave', this.moveEnd.bind(this));\n  }\n}\n\nconst moveConfigResolver = _objectSpread2(_objectSpread2({}, coordinatesConfigResolver), {}, {\n  mouseOnly: (value = true) => value\n});\n\nclass ScrollEngine extends CoordinatesEngine {\n  constructor(...args) {\n    super(...args);\n    _defineProperty(this, \"ingKey\", 'scrolling');\n  }\n  scroll(event) {\n    if (!this.state._active) this.start(event);\n    this.scrollChange(event);\n    this.timeoutStore.add('scrollEnd', this.scrollEnd.bind(this));\n  }\n  scrollChange(event) {\n    if (event.cancelable) event.preventDefault();\n    const state = this.state;\n    const values = scrollValues(event);\n    state._delta = V.sub(values, state._values);\n    V.addTo(state._movement, state._delta);\n    this.computeValues(values);\n    this.compute(event);\n    this.emit();\n  }\n  scrollEnd() {\n    if (!this.state._active) return;\n    this.state._active = false;\n    this.compute();\n    this.emit();\n  }\n  bind(bindFunction) {\n    bindFunction('scroll', '', this.scroll.bind(this));\n  }\n}\n\nconst scrollConfigResolver = coordinatesConfigResolver;\n\nclass WheelEngine extends CoordinatesEngine {\n  constructor(...args) {\n    super(...args);\n    _defineProperty(this, \"ingKey\", 'wheeling');\n  }\n  wheel(event) {\n    if (!this.state._active) this.start(event);\n    this.wheelChange(event);\n    this.timeoutStore.add('wheelEnd', this.wheelEnd.bind(this));\n  }\n  wheelChange(event) {\n    const state = this.state;\n    state._delta = wheelValues(event);\n    V.addTo(state._movement, state._delta);\n    clampStateInternalMovementToBounds(state);\n    this.compute(event);\n    this.emit();\n  }\n  wheelEnd() {\n    if (!this.state._active) return;\n    this.state._active = false;\n    this.compute();\n    this.emit();\n  }\n  bind(bindFunction) {\n    bindFunction('wheel', '', this.wheel.bind(this));\n  }\n}\n\nconst wheelConfigResolver = coordinatesConfigResolver;\n\nclass HoverEngine extends CoordinatesEngine {\n  constructor(...args) {\n    super(...args);\n    _defineProperty(this, \"ingKey\", 'hovering');\n  }\n  enter(event) {\n    if (this.config.mouseOnly && event.pointerType !== 'mouse') return;\n    this.start(event);\n    this.computeValues(pointerValues(event));\n    this.compute(event);\n    this.emit();\n  }\n  leave(event) {\n    if (this.config.mouseOnly && event.pointerType !== 'mouse') return;\n    const state = this.state;\n    if (!state._active) return;\n    state._active = false;\n    const values = pointerValues(event);\n    state._movement = state._delta = V.sub(values, state._values);\n    this.computeValues(values);\n    this.compute(event);\n    state.delta = state.movement;\n    this.emit();\n  }\n  bind(bindFunction) {\n    bindFunction('pointer', 'enter', this.enter.bind(this));\n    bindFunction('pointer', 'leave', this.leave.bind(this));\n  }\n}\n\nconst hoverConfigResolver = _objectSpread2(_objectSpread2({}, coordinatesConfigResolver), {}, {\n  mouseOnly: (value = true) => value\n});\n\nconst EngineMap = new Map();\nconst ConfigResolverMap = new Map();\nfunction registerAction(action) {\n  EngineMap.set(action.key, action.engine);\n  ConfigResolverMap.set(action.key, action.resolver);\n}\nconst dragAction = {\n  key: 'drag',\n  engine: DragEngine,\n  resolver: dragConfigResolver\n};\nconst hoverAction = {\n  key: 'hover',\n  engine: HoverEngine,\n  resolver: hoverConfigResolver\n};\nconst moveAction = {\n  key: 'move',\n  engine: MoveEngine,\n  resolver: moveConfigResolver\n};\nconst pinchAction = {\n  key: 'pinch',\n  engine: PinchEngine,\n  resolver: pinchConfigResolver\n};\nconst scrollAction = {\n  key: 'scroll',\n  engine: ScrollEngine,\n  resolver: scrollConfigResolver\n};\nconst wheelAction = {\n  key: 'wheel',\n  engine: WheelEngine,\n  resolver: wheelConfigResolver\n};\n\nexport { ConfigResolverMap as C, EngineMap as E, SUPPORT as S, _objectSpread2 as _, _defineProperty as a, touchIds as b, chain as c, toHandlerProp as d, dragAction as e, pinchAction as f, hoverAction as h, isTouch as i, moveAction as m, parseProp as p, registerAction as r, scrollAction as s, toDomEventType as t, wheelAction as w };\n","import { S as SUPPORT, C as ConfigResolverMap, _ as _objectSpread2, a as _defineProperty, t as toDomEventType, i as isTouch, b as touchIds, E as EngineMap, c as chain, p as parseProp, d as toHandlerProp } from './actions-94b581a0.esm.js';\nimport './maths-0ab39ae9.esm.js';\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n  return target;\n}\n\nfunction _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n  var target = _objectWithoutPropertiesLoose(source, excluded);\n  var key, i;\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n  return target;\n}\n\nconst sharedConfigResolver = {\n  target(value) {\n    if (value) {\n      return () => 'current' in value ? value.current : value;\n    }\n    return undefined;\n  },\n  enabled(value = true) {\n    return value;\n  },\n  window(value = SUPPORT.isBrowser ? window : undefined) {\n    return value;\n  },\n  eventOptions({\n    passive = true,\n    capture = false\n  } = {}) {\n    return {\n      passive,\n      capture\n    };\n  },\n  transform(value) {\n    return value;\n  }\n};\n\nconst _excluded = [\"target\", \"eventOptions\", \"window\", \"enabled\", \"transform\"];\nfunction resolveWith(config = {}, resolvers) {\n  const result = {};\n  for (const [key, resolver] of Object.entries(resolvers)) {\n    switch (typeof resolver) {\n      case 'function':\n        if (process.env.NODE_ENV === 'development') {\n          const r = resolver.call(result, config[key], key, config);\n          if (!Number.isNaN(r)) result[key] = r;\n        } else {\n          result[key] = resolver.call(result, config[key], key, config);\n        }\n        break;\n      case 'object':\n        result[key] = resolveWith(config[key], resolver);\n        break;\n      case 'boolean':\n        if (resolver) result[key] = config[key];\n        break;\n    }\n  }\n  return result;\n}\nfunction parse(newConfig, gestureKey, _config = {}) {\n  const _ref = newConfig,\n    {\n      target,\n      eventOptions,\n      window,\n      enabled,\n      transform\n    } = _ref,\n    rest = _objectWithoutProperties(_ref, _excluded);\n  _config.shared = resolveWith({\n    target,\n    eventOptions,\n    window,\n    enabled,\n    transform\n  }, sharedConfigResolver);\n  if (gestureKey) {\n    const resolver = ConfigResolverMap.get(gestureKey);\n    _config[gestureKey] = resolveWith(_objectSpread2({\n      shared: _config.shared\n    }, rest), resolver);\n  } else {\n    for (const key in rest) {\n      const resolver = ConfigResolverMap.get(key);\n      if (resolver) {\n        _config[key] = resolveWith(_objectSpread2({\n          shared: _config.shared\n        }, rest[key]), resolver);\n      } else if (process.env.NODE_ENV === 'development') {\n        if (!['drag', 'pinch', 'scroll', 'wheel', 'move', 'hover'].includes(key)) {\n          if (key === 'domTarget') {\n            throw Error(`[@use-gesture]: \\`domTarget\\` option has been renamed to \\`target\\`.`);\n          }\n          console.warn(`[@use-gesture]: Unknown config key \\`${key}\\` was used. Please read the documentation for further information.`);\n        }\n      }\n    }\n  }\n  return _config;\n}\n\nclass EventStore {\n  constructor(ctrl, gestureKey) {\n    _defineProperty(this, \"_listeners\", new Set());\n    this._ctrl = ctrl;\n    this._gestureKey = gestureKey;\n  }\n  add(element, device, action, handler, options) {\n    const listeners = this._listeners;\n    const type = toDomEventType(device, action);\n    const _options = this._gestureKey ? this._ctrl.config[this._gestureKey].eventOptions : {};\n    const eventOptions = _objectSpread2(_objectSpread2({}, _options), options);\n    element.addEventListener(type, handler, eventOptions);\n    const remove = () => {\n      element.removeEventListener(type, handler, eventOptions);\n      listeners.delete(remove);\n    };\n    listeners.add(remove);\n    return remove;\n  }\n  clean() {\n    this._listeners.forEach(remove => remove());\n    this._listeners.clear();\n  }\n}\n\nclass TimeoutStore {\n  constructor() {\n    _defineProperty(this, \"_timeouts\", new Map());\n  }\n  add(key, callback, ms = 140, ...args) {\n    this.remove(key);\n    this._timeouts.set(key, window.setTimeout(callback, ms, ...args));\n  }\n  remove(key) {\n    const timeout = this._timeouts.get(key);\n    if (timeout) window.clearTimeout(timeout);\n  }\n  clean() {\n    this._timeouts.forEach(timeout => void window.clearTimeout(timeout));\n    this._timeouts.clear();\n  }\n}\n\nclass Controller {\n  constructor(handlers) {\n    _defineProperty(this, \"gestures\", new Set());\n    _defineProperty(this, \"_targetEventStore\", new EventStore(this));\n    _defineProperty(this, \"gestureEventStores\", {});\n    _defineProperty(this, \"gestureTimeoutStores\", {});\n    _defineProperty(this, \"handlers\", {});\n    _defineProperty(this, \"config\", {});\n    _defineProperty(this, \"pointerIds\", new Set());\n    _defineProperty(this, \"touchIds\", new Set());\n    _defineProperty(this, \"state\", {\n      shared: {\n        shiftKey: false,\n        metaKey: false,\n        ctrlKey: false,\n        altKey: false\n      }\n    });\n    resolveGestures(this, handlers);\n  }\n  setEventIds(event) {\n    if (isTouch(event)) {\n      this.touchIds = new Set(touchIds(event));\n      return this.touchIds;\n    } else if ('pointerId' in event) {\n      if (event.type === 'pointerup' || event.type === 'pointercancel') this.pointerIds.delete(event.pointerId);else if (event.type === 'pointerdown') this.pointerIds.add(event.pointerId);\n      return this.pointerIds;\n    }\n  }\n  applyHandlers(handlers, nativeHandlers) {\n    this.handlers = handlers;\n    this.nativeHandlers = nativeHandlers;\n  }\n  applyConfig(config, gestureKey) {\n    this.config = parse(config, gestureKey, this.config);\n  }\n  clean() {\n    this._targetEventStore.clean();\n    for (const key of this.gestures) {\n      this.gestureEventStores[key].clean();\n      this.gestureTimeoutStores[key].clean();\n    }\n  }\n  effect() {\n    if (this.config.shared.target) this.bind();\n    return () => this._targetEventStore.clean();\n  }\n  bind(...args) {\n    const sharedConfig = this.config.shared;\n    const props = {};\n    let target;\n    if (sharedConfig.target) {\n      target = sharedConfig.target();\n      if (!target) return;\n    }\n    if (sharedConfig.enabled) {\n      for (const gestureKey of this.gestures) {\n        const gestureConfig = this.config[gestureKey];\n        const bindFunction = bindToProps(props, gestureConfig.eventOptions, !!target);\n        if (gestureConfig.enabled) {\n          const Engine = EngineMap.get(gestureKey);\n          new Engine(this, args, gestureKey).bind(bindFunction);\n        }\n      }\n      const nativeBindFunction = bindToProps(props, sharedConfig.eventOptions, !!target);\n      for (const eventKey in this.nativeHandlers) {\n        nativeBindFunction(eventKey, '', event => this.nativeHandlers[eventKey](_objectSpread2(_objectSpread2({}, this.state.shared), {}, {\n          event,\n          args\n        })), undefined, true);\n      }\n    }\n    for (const handlerProp in props) {\n      props[handlerProp] = chain(...props[handlerProp]);\n    }\n    if (!target) return props;\n    for (const handlerProp in props) {\n      const {\n        device,\n        capture,\n        passive\n      } = parseProp(handlerProp);\n      this._targetEventStore.add(target, device, '', props[handlerProp], {\n        capture,\n        passive\n      });\n    }\n  }\n}\nfunction setupGesture(ctrl, gestureKey) {\n  ctrl.gestures.add(gestureKey);\n  ctrl.gestureEventStores[gestureKey] = new EventStore(ctrl, gestureKey);\n  ctrl.gestureTimeoutStores[gestureKey] = new TimeoutStore();\n}\nfunction resolveGestures(ctrl, internalHandlers) {\n  if (internalHandlers.drag) setupGesture(ctrl, 'drag');\n  if (internalHandlers.wheel) setupGesture(ctrl, 'wheel');\n  if (internalHandlers.scroll) setupGesture(ctrl, 'scroll');\n  if (internalHandlers.move) setupGesture(ctrl, 'move');\n  if (internalHandlers.pinch) setupGesture(ctrl, 'pinch');\n  if (internalHandlers.hover) setupGesture(ctrl, 'hover');\n}\nconst bindToProps = (props, eventOptions, withPassiveOption) => (device, action, handler, options = {}, isNative = false) => {\n  var _options$capture, _options$passive;\n  const capture = (_options$capture = options.capture) !== null && _options$capture !== void 0 ? _options$capture : eventOptions.capture;\n  const passive = (_options$passive = options.passive) !== null && _options$passive !== void 0 ? _options$passive : eventOptions.passive;\n  let handlerProp = isNative ? device : toHandlerProp(device, action, capture);\n  if (withPassiveOption && passive) handlerProp += 'Passive';\n  props[handlerProp] = props[handlerProp] || [];\n  props[handlerProp].push(handler);\n};\n\nconst RE_NOT_NATIVE = /^on(Drag|Wheel|Scroll|Move|Pinch|Hover)/;\nfunction sortHandlers(_handlers) {\n  const native = {};\n  const handlers = {};\n  const actions = new Set();\n  for (let key in _handlers) {\n    if (RE_NOT_NATIVE.test(key)) {\n      actions.add(RegExp.lastMatch);\n      handlers[key] = _handlers[key];\n    } else {\n      native[key] = _handlers[key];\n    }\n  }\n  return [handlers, native, actions];\n}\nfunction registerGesture(actions, handlers, handlerKey, key, internalHandlers, config) {\n  if (!actions.has(handlerKey)) return;\n  if (!EngineMap.has(key)) {\n    if (process.env.NODE_ENV === 'development') {\n      console.warn(`[@use-gesture]: You've created a custom handler that that uses the \\`${key}\\` gesture but isn't properly configured.\\n\\nPlease add \\`${key}Action\\` when creating your handler.`);\n    }\n    return;\n  }\n  const startKey = handlerKey + 'Start';\n  const endKey = handlerKey + 'End';\n  const fn = state => {\n    let memo = undefined;\n    if (state.first && startKey in handlers) handlers[startKey](state);\n    if (handlerKey in handlers) memo = handlers[handlerKey](state);\n    if (state.last && endKey in handlers) handlers[endKey](state);\n    return memo;\n  };\n  internalHandlers[key] = fn;\n  config[key] = config[key] || {};\n}\nfunction parseMergedHandlers(mergedHandlers, mergedConfig) {\n  const [handlers, nativeHandlers, actions] = sortHandlers(mergedHandlers);\n  const internalHandlers = {};\n  registerGesture(actions, handlers, 'onDrag', 'drag', internalHandlers, mergedConfig);\n  registerGesture(actions, handlers, 'onWheel', 'wheel', internalHandlers, mergedConfig);\n  registerGesture(actions, handlers, 'onScroll', 'scroll', internalHandlers, mergedConfig);\n  registerGesture(actions, handlers, 'onPinch', 'pinch', internalHandlers, mergedConfig);\n  registerGesture(actions, handlers, 'onMove', 'move', internalHandlers, mergedConfig);\n  registerGesture(actions, handlers, 'onHover', 'hover', internalHandlers, mergedConfig);\n  return {\n    handlers: internalHandlers,\n    config: mergedConfig,\n    nativeHandlers\n  };\n}\n\nexport { Controller, parseMergedHandlers };\n","import { registerAction, dragAction, pinchAction, wheelAction, scrollAction, moveAction, hoverAction } from '@use-gesture/core/actions';\nexport * from '@use-gesture/core/actions';\nimport React from 'react';\nimport { Controller, parseMergedHandlers } from '@use-gesture/core';\nexport * from '@use-gesture/core/utils';\nexport * from '@use-gesture/core/types';\n\nfunction useRecognizers(handlers, config = {}, gestureKey, nativeHandlers) {\n  const ctrl = React.useMemo(() => new Controller(handlers), []);\n  ctrl.applyHandlers(handlers, nativeHandlers);\n  ctrl.applyConfig(config, gestureKey);\n  React.useEffect(ctrl.effect.bind(ctrl));\n  React.useEffect(() => {\n    return ctrl.clean.bind(ctrl);\n  }, []);\n  if (config.target === undefined) {\n    return ctrl.bind.bind(ctrl);\n  }\n  return undefined;\n}\n\nfunction useDrag(handler, config) {\n  registerAction(dragAction);\n  return useRecognizers({\n    drag: handler\n  }, config || {}, 'drag');\n}\n\nfunction usePinch(handler, config) {\n  registerAction(pinchAction);\n  return useRecognizers({\n    pinch: handler\n  }, config || {}, 'pinch');\n}\n\nfunction useWheel(handler, config) {\n  registerAction(wheelAction);\n  return useRecognizers({\n    wheel: handler\n  }, config || {}, 'wheel');\n}\n\nfunction useScroll(handler, config) {\n  registerAction(scrollAction);\n  return useRecognizers({\n    scroll: handler\n  }, config || {}, 'scroll');\n}\n\nfunction useMove(handler, config) {\n  registerAction(moveAction);\n  return useRecognizers({\n    move: handler\n  }, config || {}, 'move');\n}\n\nfunction useHover(handler, config) {\n  registerAction(hoverAction);\n  return useRecognizers({\n    hover: handler\n  }, config || {}, 'hover');\n}\n\nfunction createUseGesture(actions) {\n  actions.forEach(registerAction);\n  return function useGesture(_handlers, _config) {\n    const {\n      handlers,\n      nativeHandlers,\n      config\n    } = parseMergedHandlers(_handlers, _config || {});\n    return useRecognizers(handlers, config, undefined, nativeHandlers);\n  };\n}\n\nfunction useGesture(handlers, config) {\n  const hook = createUseGesture([dragAction, pinchAction, scrollAction, wheelAction, moveAction, hoverAction]);\n  return hook(handlers, config || {});\n}\n\nexport { createUseGesture, useDrag, useGesture, useHover, useMove, usePinch, useScroll, useWheel };\n","// Reasonable defaults\nconst MAX_ZOOM_STEP = 10\nconst IS_DARWIN = /Mac|iPod|iPhone|iPad/.test(\n\ttypeof window === 'undefined' ? 'node' : window.navigator.platform\n)\n\n// Adapted from https://stackoverflow.com/a/13650579\n/** @public */\nexport function normalizeWheel(event: WheelEvent | React.WheelEvent<HTMLElement>) {\n\tlet { deltaY, deltaX } = event\n\tlet deltaZ = 0\n\n\tif (event.ctrlKey || event.altKey || event.metaKey) {\n\t\tconst signY = Math.sign(event.deltaY)\n\t\tconst absDeltaY = Math.abs(event.deltaY)\n\n\t\tlet dy = deltaY\n\n\t\tif (absDeltaY > MAX_ZOOM_STEP) {\n\t\t\tdy = MAX_ZOOM_STEP * signY\n\t\t}\n\n\t\tdeltaZ = dy / 100\n\t} else {\n\t\tif (event.shiftKey && !IS_DARWIN) {\n\t\t\tdeltaX = deltaY\n\t\t\tdeltaY = 0\n\t\t}\n\t}\n\n\treturn { x: -deltaX, y: -deltaY, z: -deltaZ }\n}\n","import { Vec2d } from '@tldraw/primitives'\nimport type { AnyHandlerEventTypes, EventTypes, GestureKey, Handler } from '@use-gesture/core/types'\nimport { createUseGesture, pinchAction, wheelAction } from '@use-gesture/react'\nimport * as React from 'react'\nimport { TLWheelEventInfo } from '../app/types/event-types'\nimport { preventDefault } from '../utils'\nimport { normalizeWheel } from './shared'\nimport { useApp } from './useApp'\n\ntype check<T extends AnyHandlerEventTypes, Key extends GestureKey> = undefined extends T[Key]\n\t? EventTypes[Key]\n\t: T[Key]\ntype PinchHandler = Handler<'pinch', check<EventTypes, 'pinch'>>\n\nconst useGesture = createUseGesture([wheelAction, pinchAction])\n\n/**\n * GOTCHA\n *\n * UseGesture fires a wheel event 140ms after the gesture actually ends, with a momentum-adjusted\n * delta. This creates a messed up interaction where after you stop scrolling suddenly the dang page\n * jumps a tick. why do they do this? you are asking the wrong person. it seems intentional though.\n * anyway we want to ignore that last event, but there's no way to directly detect it so we need to\n * keep track of timestamps. Yes this is awful, I am sorry.\n */\nlet lastWheelTime = undefined as undefined | number\n\nconst isWheelEndEvent = (time: number) => {\n\tif (lastWheelTime === undefined) {\n\t\tlastWheelTime = time\n\t\treturn false\n\t}\n\n\tif (time - lastWheelTime > 120 && time - lastWheelTime < 160) {\n\t\tlastWheelTime = time\n\t\treturn true\n\t}\n\n\tlastWheelTime = time\n\treturn false\n}\n\nexport function useGestureEvents(ref: React.RefObject<HTMLDivElement>) {\n\tconst app = useApp()\n\n\tconst events = React.useMemo(() => {\n\t\tconst onWheel: Handler<'wheel', WheelEvent> = ({ event }) => {\n\t\t\tif (isWheelEndEvent(Date.now())) {\n\t\t\t\t// ignore wheelEnd events\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\t// Awful tht we need to put this logic here, but basically\n\t\t\t// we don't want to handle the the wheel event (or call prevent\n\t\t\t// default on the evnet) if the user is wheeling over an a shape\n\t\t\t// that is scrollable which they're currently editing.\n\n\t\t\tif (app.editingId) {\n\t\t\t\tconst shape = app.getShapeById(app.editingId)\n\t\t\t\tif (shape) {\n\t\t\t\t\tconst util = app.getShapeUtil(shape)\n\t\t\t\t\tif (util.canScroll(shape)) {\n\t\t\t\t\t\tconst bounds = app.getPageBoundsById(app.editingId)\n\t\t\t\t\t\tif (bounds?.containsPoint(app.inputs.currentPagePoint)) {\n\t\t\t\t\t\t\treturn\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tpreventDefault(event)\n\t\t\tconst delta = normalizeWheel(event)\n\n\t\t\tif (delta.x === 0 && delta.y === 0) return\n\n\t\t\tconst info: TLWheelEventInfo = {\n\t\t\t\ttype: 'wheel',\n\t\t\t\tname: 'wheel',\n\t\t\t\tdelta,\n\t\t\t\tshiftKey: event.shiftKey,\n\t\t\t\taltKey: event.altKey,\n\t\t\t\tctrlKey: event.metaKey || event.ctrlKey,\n\t\t\t}\n\n\t\t\tapp.dispatch(info)\n\t\t}\n\n\t\tconst prevOrigin = new Vec2d()\n\n\t\tconst onPinchStart: PinchHandler = (gesture) => {\n\t\t\tconst elm = ref.current\n\n\t\t\tconst { event, origin } = gesture\n\n\t\t\tif (event instanceof WheelEvent) return\n\t\t\tif (!(event.target === elm || elm?.contains(event.target as Node))) return\n\n\t\t\tprevOrigin.x = origin[0]\n\t\t\tprevOrigin.y = origin[1]\n\n\t\t\tapp.dispatch({\n\t\t\t\ttype: 'pinch',\n\t\t\t\tname: 'pinch_start',\n\t\t\t\tpoint: { x: origin[0], y: origin[1], z: app.camera.z },\n\t\t\t\tdelta: { x: 0, y: 0 },\n\t\t\t\tshiftKey: event.shiftKey,\n\t\t\t\taltKey: event.altKey,\n\t\t\t\tctrlKey: event.metaKey || event.ctrlKey,\n\t\t\t})\n\t\t}\n\n\t\tconst onPinch: PinchHandler = (gesture) => {\n\t\t\tconst elm = ref.current\n\t\t\tconst { event, origin, offset } = gesture\n\n\t\t\tconst currentZoom = offset[0]\n\n\t\t\tif (event instanceof WheelEvent) return\n\n\t\t\tif (!(event.target === elm || elm?.contains(event.target as Node))) return\n\n\t\t\tconst dx = origin[0] - prevOrigin.x\n\t\t\tconst dy = origin[1] - prevOrigin.y\n\n\t\t\tprevOrigin.x = origin[0]\n\t\t\tprevOrigin.y = origin[1]\n\n\t\t\tapp.dispatch({\n\t\t\t\ttype: 'pinch',\n\t\t\t\tname: 'pinch',\n\t\t\t\tpoint: { x: origin[0], y: origin[1], z: currentZoom },\n\t\t\t\tdelta: { x: dx, y: dy },\n\t\t\t\tshiftKey: event.shiftKey,\n\t\t\t\taltKey: event.altKey,\n\t\t\t\tctrlKey: event.metaKey || event.ctrlKey,\n\t\t\t})\n\t\t}\n\n\t\tconst onPinchEnd: PinchHandler = (gesture) => {\n\t\t\tconst elm = ref.current\n\t\t\tconst { event, origin, offset } = gesture\n\n\t\t\tif (event instanceof WheelEvent) return\n\t\t\tif (!(event.target === elm || elm?.contains(event.target as Node))) return\n\n\t\t\tconst scale = offset[0]\n\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tapp.dispatch({\n\t\t\t\t\ttype: 'pinch',\n\t\t\t\t\tname: 'pinch_end',\n\t\t\t\t\tpoint: { x: origin[0], y: origin[1], z: scale },\n\t\t\t\t\tdelta: { x: origin[0], y: origin[1] },\n\t\t\t\t\tshiftKey: event.shiftKey,\n\t\t\t\t\taltKey: event.altKey,\n\t\t\t\t\tctrlKey: event.metaKey || event.ctrlKey,\n\t\t\t\t})\n\t\t\t})\n\t\t}\n\n\t\treturn {\n\t\t\tonWheel,\n\t\t\tonPinchStart,\n\t\t\tonPinchEnd,\n\t\t\tonPinch,\n\t\t}\n\t}, [app, ref])\n\n\tuseGesture(events, {\n\t\ttarget: ref,\n\t\teventOptions: { passive: false },\n\t\tpinch: {\n\t\t\tfrom: () => [app.camera.z, 0], // Return the camera z to use when pinch starts\n\t\t\tscaleBounds: () => {\n\t\t\t\treturn { from: app.camera.z, max: 8, min: 0.05 }\n\t\t\t},\n\t\t},\n\t})\n}\n","import { TLArrowShape, TLLineShape, TLShapeId } from '@tldraw/tlschema'\nimport * as React from 'react'\nimport { App } from '../app/App'\nimport {\n\tgetPointerInfo,\n\tloopToHtmlElement,\n\treleasePointerCapture,\n\tsetPointerCapture,\n} from '../utils'\nimport { useApp } from './useApp'\n\nfunction getHandle(app: App, id: TLShapeId, handleId: string) {\n\tconst shape = app.getShapeById<TLArrowShape | TLLineShape>(id)!\n\tconst util = app.getShapeUtil(shape)\n\tconst handles = util.handles(shape)\n\treturn { shape, handle: handles.find((h) => h.id === handleId) }\n}\n\nexport function useHandleEvents(id: TLShapeId, handleId: string) {\n\tconst app = useApp()\n\n\treturn React.useMemo(() => {\n\t\tconst onPointerDown = (e: React.PointerEvent) => {\n\t\t\tif ((e as any).isKilled) return\n\n\t\t\t// Must set pointer capture on an HTML element!\n\t\t\tconst target = loopToHtmlElement(e.currentTarget)\n\t\t\tsetPointerCapture(target, e)\n\n\t\t\tconst { shape, handle } = getHandle(app, id, handleId)\n\n\t\t\tif (!handle) return\n\n\t\t\tapp.dispatch({\n\t\t\t\ttype: 'pointer',\n\t\t\t\ttarget: 'handle',\n\t\t\t\thandle,\n\t\t\t\tshape,\n\t\t\t\tname: 'pointer_down',\n\t\t\t\t...getPointerInfo(e, app.getContainer()),\n\t\t\t})\n\t\t}\n\n\t\t// Track the last screen point\n\t\tlet lastX: number, lastY: number\n\n\t\tconst onPointerMove = (e: React.PointerEvent) => {\n\t\t\tif ((e as any).isKilled) return\n\t\t\tif (e.clientX === lastX && e.clientY === lastY) return\n\t\t\tlastX = e.clientX\n\t\t\tlastY = e.clientY\n\n\t\t\tconst { shape, handle } = getHandle(app, id, handleId)\n\n\t\t\tif (!handle) return\n\n\t\t\tapp.dispatch({\n\t\t\t\ttype: 'pointer',\n\t\t\t\ttarget: 'handle',\n\t\t\t\thandle,\n\t\t\t\tshape,\n\t\t\t\tname: 'pointer_move',\n\t\t\t\t...getPointerInfo(e, app.getContainer()),\n\t\t\t})\n\t\t}\n\n\t\tconst onPointerUp = (e: React.PointerEvent) => {\n\t\t\tif ((e as any).isKilled) return\n\n\t\t\tconst target = loopToHtmlElement(e.currentTarget)\n\t\t\treleasePointerCapture(target, e)\n\n\t\t\tconst { shape, handle } = getHandle(app, id, handleId)\n\n\t\t\tif (!handle) return\n\n\t\t\tapp.dispatch({\n\t\t\t\ttype: 'pointer',\n\t\t\t\ttarget: 'handle',\n\t\t\t\thandle,\n\t\t\t\tshape,\n\t\t\t\tname: 'pointer_up',\n\t\t\t\t...getPointerInfo(e, app.getContainer()),\n\t\t\t})\n\t\t}\n\n\t\tconst onPointerEnter = (e: React.PointerEvent) => {\n\t\t\tif ((e as any).isKilled) return\n\n\t\t\tconst { shape, handle } = getHandle(app, id, handleId)\n\n\t\t\tif (!handle) return\n\n\t\t\tapp.dispatch({\n\t\t\t\ttype: 'pointer',\n\t\t\t\ttarget: 'handle',\n\t\t\t\thandle,\n\t\t\t\tshape,\n\t\t\t\tname: 'pointer_enter',\n\t\t\t\t...getPointerInfo(e, app.getContainer()),\n\t\t\t})\n\t\t}\n\n\t\tconst onPointerLeave = (e: React.PointerEvent) => {\n\t\t\tif ((e as any).isKilled) return\n\n\t\t\tconst { shape, handle } = getHandle(app, id, handleId)\n\n\t\t\tif (!handle) return\n\n\t\t\tapp.dispatch({\n\t\t\t\ttype: 'pointer',\n\t\t\t\ttarget: 'handle',\n\t\t\t\thandle,\n\t\t\t\tshape,\n\t\t\t\tname: 'pointer_leave',\n\t\t\t\t...getPointerInfo(e, app.getContainer()),\n\t\t\t})\n\t\t}\n\n\t\treturn {\n\t\t\tonPointerDown,\n\t\t\tonPointerMove,\n\t\t\tonPointerUp,\n\t\t\tonPointerEnter,\n\t\t\tonPointerLeave,\n\t\t}\n\t}, [app, id, handleId])\n}\n","import { TLShapeId } from '@tldraw/tlschema'\nimport { useValue } from 'signia-react'\nimport { useApp } from './useApp'\n\nexport function useIsEditing(shapeId: TLShapeId) {\n\tconst app = useApp()\n\treturn useValue('isEditing', () => app.editingId === shapeId, [app, shapeId])\n}\n","import { useEffect, useMemo, useState } from 'react'\nimport { useApp } from '.'\nimport { HASH_PATERN_ZOOM_NAMES, MAX_ZOOM } from '../constants'\nimport { debugFlags } from '../utils/debug-flags'\n\nconst TILE_PATTERN_SIZE = 8\n\nconst generateImage = (dpr: number, currentZoom: number, darkMode: boolean) => {\n\treturn new Promise<Blob>((resolve, reject) => {\n\t\tconst size = TILE_PATTERN_SIZE * currentZoom * dpr\n\n\t\tconst canvasEl = document.createElement('canvas')\n\t\tcanvasEl.width = size\n\t\tcanvasEl.height = size\n\n\t\tconst ctx = canvasEl.getContext('2d')\n\t\tif (!ctx) throw new Error('No canvas')\n\n\t\tctx.fillStyle = darkMode ? '#212529' : '#f8f9fa'\n\t\tctx.fillRect(0, 0, size, size)\n\n\t\t// This essentially generates an inverse of the pattern we're drawing.\n\t\tctx.globalCompositeOperation = 'destination-out'\n\n\t\tctx.lineCap = 'round'\n\t\tctx.lineWidth = 1.25 * currentZoom * dpr\n\n\t\tconst t = 8 / 12\n\t\tconst s = (v: number) => v * currentZoom * dpr\n\n\t\tctx.beginPath()\n\t\tctx.moveTo(s(t * 1), s(t * 3))\n\t\tctx.lineTo(s(t * 3), s(t * 1))\n\n\t\tctx.moveTo(s(t * 5), s(t * 7))\n\t\tctx.lineTo(s(t * 7), s(t * 5))\n\n\t\tctx.moveTo(s(t * 9), s(t * 11))\n\t\tctx.lineTo(s(t * 11), s(t * 9))\n\t\tctx.stroke()\n\n\t\tcanvasEl.toBlob((blob) => {\n\t\t\tif (!blob || debugFlags.throwToBlob.value) {\n\t\t\t\treject()\n\t\t\t} else {\n\t\t\t\tresolve(blob)\n\t\t\t}\n\t\t})\n\t})\n}\n\nconst canvasBlob = (size: [number, number], fn: (ctx: CanvasRenderingContext2D) => void) => {\n\tconst canvas = document.createElement('canvas')\n\tcanvas.width = size[0]\n\tcanvas.height = size[1]\n\tfn(canvas.getContext('2d')!)\n\treturn canvas.toDataURL()\n}\ntype PatternDef = { zoom: number; url: string; darkMode: boolean }\n\nconst getDefaultPatterns = () => {\n\tconst defaultPatterns: PatternDef[] = []\n\tfor (let i = 1; i <= Math.ceil(MAX_ZOOM); i++) {\n\t\tconst whitePixelBlob = canvasBlob([1, 1], (ctx) => {\n\t\t\t// Hard coded '--palette-black-semi'\n\t\t\tctx.fillStyle = '#e8e8e8'\n\t\t\tctx.fillRect(0, 0, 1, 1)\n\t\t})\n\t\tconst blackPixelBlob = canvasBlob([1, 1], (ctx) => {\n\t\t\t// Hard coded '--palette-black-semi'\n\t\t\tctx.fillStyle = '#2c3036'\n\t\t\tctx.fillRect(0, 0, 1, 1)\n\t\t})\n\t\tdefaultPatterns.push({\n\t\t\tzoom: i,\n\t\t\turl: whitePixelBlob,\n\t\t\tdarkMode: false,\n\t\t})\n\t\tdefaultPatterns.push({\n\t\t\tzoom: i,\n\t\t\turl: blackPixelBlob,\n\t\t\tdarkMode: true,\n\t\t})\n\t}\n\treturn defaultPatterns\n}\n\nexport const usePattern = function Pattern() {\n\tconst app = useApp()\n\tconst dpr = app.devicePixelRatio\n\tconst [isReady, setIsReady] = useState(false)\n\tconst defaultPatterns = useMemo(() => getDefaultPatterns(), [])\n\tconst [backgroundUrls, setBackgroundUrls] = useState<PatternDef[]>(defaultPatterns)\n\n\tuseEffect(() => {\n\t\tconst promises: Promise<{ zoom: number; url: string; darkMode: boolean }>[] = []\n\n\t\tfor (let i = 1; i <= Math.ceil(MAX_ZOOM); i++) {\n\t\t\tpromises.push(\n\t\t\t\tgenerateImage(dpr, i, false).then((blob) => ({\n\t\t\t\t\tzoom: i,\n\t\t\t\t\turl: URL.createObjectURL(blob),\n\t\t\t\t\tdarkMode: false,\n\t\t\t\t}))\n\t\t\t)\n\t\t\tpromises.push(\n\t\t\t\tgenerateImage(dpr, i, true).then((blob) => ({\n\t\t\t\t\tzoom: i,\n\t\t\t\t\turl: URL.createObjectURL(blob),\n\t\t\t\t\tdarkMode: true,\n\t\t\t\t}))\n\t\t\t)\n\t\t}\n\n\t\tlet isCancelled = false\n\t\tPromise.all(promises).then((urls) => {\n\t\t\tif (isCancelled) return\n\t\t\tsetBackgroundUrls(urls)\n\t\t\tsetIsReady(true)\n\t\t})\n\n\t\treturn () => {\n\t\t\tisCancelled = true\n\t\t\tsetIsReady(false)\n\t\t}\n\t}, [dpr])\n\n\tconst context = (\n\t\t<defs>\n\t\t\t{backgroundUrls.map((item) => {\n\t\t\t\tconst key = item.zoom + (item.darkMode ? '_dark' : '_light')\n\t\t\t\treturn (\n\t\t\t\t\t<pattern\n\t\t\t\t\t\tkey={key}\n\t\t\t\t\t\tid={HASH_PATERN_ZOOM_NAMES[key]}\n\t\t\t\t\t\twidth={TILE_PATTERN_SIZE}\n\t\t\t\t\t\theight={TILE_PATTERN_SIZE}\n\t\t\t\t\t\tpatternUnits=\"userSpaceOnUse\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<image href={item.url} width={TILE_PATTERN_SIZE} height={TILE_PATTERN_SIZE} />\n\t\t\t\t\t</pattern>\n\t\t\t\t)\n\t\t\t})}\n\t\t</defs>\n\t)\n\n\treturn { context, isReady }\n}\n\nconst t = 8 / 12\nexport function exportPatternSvgDefs() {\n\tconst divEl = document.createElement('div')\n\tdivEl.innerHTML = `\n\t\t<svg>\n\t\t\t<defs>\n\t\t\t\t<g>\n\t\t\t\t\t<pattern\n\t\t\t\t\t\tid=\"hash_pattern\"\n\t\t\t\t\t\twidth=\"8\"\n\t\t\t\t\t\theight=\"8\"\n\t\t\t\t\t\tpatternUnits=\"userSpaceOnUse\"\n\t\t\t\t\t\tstrokeLinecap=\"round\"\n\t\t\t\t\t\tstroke=\"white\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<line x1=\"${t * 1}\" y1=\"${t * 3}\" x2=\"${t * 3}\" y2=\"${t * 1}\" />\n\t\t\t\t\t\t<line x1=\"${t * 5}\" y1=\"${t * 7}\" x2=\"${t * 7}\" y2=\"${t * 5}\" />\n\t\t\t\t\t\t<line x1=\"${t * 9}\" y1=\"${t * 11}\" x2=\"${t * 11}\" y2=\"${t * 9}\" />\n\t\t\t\t\t</pattern>\n\t\t\t\t\t<mask id=\"hash_mask\">\n\t\t\t\t\t\t${\n\t\t\t\t\t\t\t// +/-100% so it extends into negative coords of shape\n\t\t\t\t\t\t\t// See <https://linear.app/tldraw/issue/TLD-966/draw-shapes-with-pattern-fill-sometimes-dont-export-the-whole-fill>\n\t\t\t\t\t\t\t`<rect x=\"-100%\" y=\"-100%\" width=\"200%\" height=\"200%\" fill=\"url(#hash_pattern)\" />`\n\t\t\t\t\t\t}\n\t\t\t\t\t</mask>\n\t\t\t\t</g>\n\t\t\t</defs>\n\t\t</svg>\n\t`\n\treturn divEl.querySelectorAll('defs > *')!\n}\n","import { TLShapeId } from '@tldraw/tlschema'\nimport React from 'react'\nimport { App } from '../app/App'\nimport { TLPointerEventName } from '../app/types/event-types'\nimport { getPointerInfo, preventDefault, releasePointerCapture, setPointerCapture } from '../utils'\nimport { useApp } from './useApp'\n\nconst pointerEventHandler = (app: App, shapeId: TLShapeId, name: TLPointerEventName) => {\n\treturn (e: React.PointerEvent) => {\n\t\tif (app.pageState.editingId === shapeId) (e as any).isKilled = true\n\t\tif ((e as any).isKilled) return\n\n\t\tswitch (name) {\n\t\t\tcase 'pointer_down': {\n\t\t\t\tif (e.button !== 0 && e.button !== 2) return\n\t\t\t\tsetPointerCapture(e.currentTarget, e)\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tcase 'pointer_up': {\n\t\t\t\treleasePointerCapture(e.currentTarget, e)\n\t\t\t\tbreak\n\t\t\t}\n\t\t}\n\n\t\tconst shape = app.getShapeById(shapeId)\n\n\t\tif (!shape) {\n\t\t\tconsole.error('Shape not found', shapeId)\n\t\t\treturn\n\t\t}\n\n\t\tapp.dispatch({\n\t\t\ttype: 'pointer',\n\t\t\ttarget: 'shape',\n\t\t\tshape,\n\t\t\tname,\n\t\t\t...getPointerInfo(e, app.getContainer()),\n\t\t})\n\t}\n}\n\nexport function useShapeEvents(id: TLShapeId) {\n\tconst app = useApp()\n\n\treturn React.useMemo(() => {\n\t\tfunction onTouchStart(e: React.TouchEvent) {\n\t\t\t;(e as any).isKilled = true\n\t\t\tpreventDefault(e)\n\t\t}\n\n\t\tfunction onTouchEnd(e: React.TouchEvent) {\n\t\t\t;(e as any).isKilled = true\n\t\t\tpreventDefault(e)\n\t\t}\n\n\t\tconst handlePointerMove = pointerEventHandler(app, id, 'pointer_move')\n\n\t\t// Track the last screen point\n\t\tlet lastX: number, lastY: number\n\n\t\tfunction onPointerMove(e: React.PointerEvent) {\n\t\t\tif ((e as any).isKilled) return\n\t\t\tif (e.clientX === lastX && e.clientY === lastY) return\n\t\t\tlastX = e.clientX\n\t\t\tlastY = e.clientY\n\n\t\t\treturn handlePointerMove(e)\n\t\t}\n\n\t\treturn {\n\t\t\tonPointerDown: pointerEventHandler(app, id, 'pointer_down'),\n\t\t\tonPointerUp: pointerEventHandler(app, id, 'pointer_up'),\n\t\t\tonPointerEnter: pointerEventHandler(app, id, 'pointer_enter'),\n\t\t\tonPointerLeave: pointerEventHandler(app, id, 'pointer_leave'),\n\t\t\tonPointerMove,\n\t\t\tonTouchStart,\n\t\t\tonTouchEnd,\n\t\t}\n\t}, [app, id])\n}\n","import { TLColorType, TLFillType } from '@tldraw/tlschema'\nimport * as React from 'react'\nimport { track } from 'signia-react'\nimport { TLExportColors } from '.'\nimport { HASH_PATERN_ZOOM_NAMES } from '../../../constants'\nimport { useApp } from '../../../hooks'\n\nexport interface ShapeFillProps {\n\td: string\n\tfill: TLFillType\n\tcolor: TLColorType\n}\n\nexport const ShapeFill = React.memo(function ShapeFill({ d, color, fill }: ShapeFillProps) {\n\tswitch (fill) {\n\t\tcase 'none': {\n\t\t\treturn <path className={'rs-hitarea-stroke'} fill=\"none\" d={d} />\n\t\t}\n\t\tcase 'solid': {\n\t\t\treturn (\n\t\t\t\t<path className={'rs-hitarea-fill-solid'} fill={`var(--palette-${color}-semi)`} d={d} />\n\t\t\t)\n\t\t}\n\t\tcase 'semi': {\n\t\t\treturn <path className={'rs-hitarea-fill-solid'} fill={`var(--palette-solid)`} d={d} />\n\t\t}\n\t\tcase 'pattern': {\n\t\t\treturn <PatternFill color={color} fill={fill} d={d} />\n\t\t}\n\t}\n})\n\nconst PatternFill = track(function PatternFill({ d, color }: ShapeFillProps) {\n\tconst app = useApp()\n\tconst intZoom = Math.ceil(app.zoomLevel)\n\tconst teenyTiny = app.zoomLevel <= 0.18\n\tconst isDarkMode = app.userDocumentSettings.isDarkMode\n\n\treturn (\n\t\t<>\n\t\t\t<path className={'rs-hitarea-fill-solid'} fill={`var(--palette-${color}-pattern)`} d={d} />\n\t\t\t<path\n\t\t\t\tfill={\n\t\t\t\t\tteenyTiny\n\t\t\t\t\t\t? `var(--palette-${color}-semi)`\n\t\t\t\t\t\t: `url(#${HASH_PATERN_ZOOM_NAMES[intZoom + (isDarkMode ? '_dark' : '_light')]})`\n\t\t\t\t}\n\t\t\t\td={d}\n\t\t\t/>\n\t\t</>\n\t)\n})\n\nexport function getShapeFillSvg({\n\td,\n\tcolor,\n\tfill,\n\tcolors,\n}: ShapeFillProps & { colors: TLExportColors }) {\n\tif (fill === 'none') {\n\t\treturn\n\t}\n\n\tif (fill === 'pattern') {\n\t\tconst gEl = document.createElementNS('http://www.w3.org/2000/svg', 'g')\n\t\tconst path1El = document.createElementNS('http://www.w3.org/2000/svg', 'path')\n\t\tpath1El.setAttribute('d', d)\n\t\tpath1El.setAttribute('fill', colors.background)\n\n\t\tconst path2El = document.createElementNS('http://www.w3.org/2000/svg', 'path')\n\t\tpath2El.setAttribute('d', d)\n\t\tpath2El.setAttribute('mask', `url(#hash_mask)`)\n\t\tpath2El.setAttribute('fill', colors.pattern[color])\n\n\t\tgEl.appendChild(path1El)\n\t\tgEl.appendChild(path2El)\n\t\treturn gEl\n\t}\n\n\tconst path = document.createElementNS('http://www.w3.org/2000/svg', 'path')\n\tpath.setAttribute('d', d)\n\n\tswitch (fill) {\n\t\tcase 'semi': {\n\t\t\tpath.setAttribute('fill', colors.solid)\n\t\t\tbreak\n\t\t}\n\t\tcase 'solid': {\n\t\t\t{\n\t\t\t\tpath.setAttribute('fill', colors.semi[color])\n\t\t\t}\n\t\t\tbreak\n\t\t}\n\t}\n\n\treturn path\n}\n\nexport function getSvgWithShapeFill(foregroundPath: SVGElement, backgroundPath?: SVGElement) {\n\tif (backgroundPath) {\n\t\t// If there is a fill element, return a group containing the fill and the path\n\t\tconst g = document.createElementNS('http://www.w3.org/2000/svg', 'g')\n\t\tg.appendChild(backgroundPath)\n\t\tg.appendChild(foregroundPath)\n\t\treturn g\n\t} else {\n\t\t// Otherwise, just return the path\n\t\treturn foregroundPath\n\t}\n}\n","import { TLDashType } from '@tldraw/tlschema'\n\nexport function getPerfectDashProps(\n\ttotalLength: number,\n\tstrokeWidth: number,\n\topts = {} as Partial<{\n\t\tstyle: TLDashType\n\t\tsnap: number\n\t\tend: 'skip' | 'outset' | 'none'\n\t\tstart: 'skip' | 'outset' | 'none'\n\t\tlengthRatio: number\n\t\tclosed: boolean\n\t}>\n): {\n\tstrokeDasharray: string\n\tstrokeDashoffset: string\n} {\n\tconst {\n\t\tclosed = false,\n\t\tsnap = 1,\n\t\tstart = 'outset',\n\t\tend = 'outset',\n\t\tlengthRatio = 2,\n\t\tstyle = 'dashed',\n\t} = opts\n\n\tlet dashLength = 0\n\tlet dashCount = 0\n\tlet ratio = 1\n\tlet gapLength = 0\n\tlet strokeDashoffset = 0\n\n\tswitch (style) {\n\t\tcase 'dashed': {\n\t\t\tratio = 1\n\t\t\tdashLength = Math.min(strokeWidth * lengthRatio, totalLength / 4)\n\t\t\tbreak\n\t\t}\n\t\tcase 'dotted': {\n\t\t\tratio = 100\n\t\t\tdashLength = strokeWidth / ratio\n\t\t\tbreak\n\t\t}\n\t\tdefault: {\n\t\t\treturn {\n\t\t\t\tstrokeDasharray: 'none',\n\t\t\t\tstrokeDashoffset: 'none',\n\t\t\t}\n\t\t}\n\t}\n\n\tif (!closed) {\n\t\tif (start === 'outset') {\n\t\t\ttotalLength += dashLength / 2\n\t\t\tstrokeDashoffset += dashLength / 2\n\t\t} else if (start === 'skip') {\n\t\t\ttotalLength -= dashLength\n\t\t\tstrokeDashoffset -= dashLength\n\t\t}\n\n\t\tif (end === 'outset') {\n\t\t\ttotalLength += dashLength / 2\n\t\t} else if (end === 'skip') {\n\t\t\ttotalLength -= dashLength\n\t\t}\n\t}\n\n\tdashCount = Math.floor(totalLength / dashLength / (2 * ratio))\n\tdashCount -= dashCount % snap\n\n\tif (dashCount < 3 && style === 'dashed') {\n\t\tif (totalLength / strokeWidth < 5) {\n\t\t\tdashLength = totalLength\n\t\t\tdashCount = 1\n\t\t\tgapLength = 0\n\t\t} else {\n\t\t\tdashLength = totalLength * 0.333\n\t\t\tgapLength = totalLength * 0.333\n\t\t}\n\t} else {\n\t\tdashCount = Math.max(dashCount, 3)\n\t\tdashLength = totalLength / dashCount / (2 * ratio)\n\n\t\tif (closed) {\n\t\t\tstrokeDashoffset = dashLength / 2\n\t\t\tgapLength = (totalLength - dashCount * dashLength) / dashCount\n\t\t} else {\n\t\t\tgapLength = (totalLength - dashCount * dashLength) / Math.max(1, dashCount - 1)\n\t\t}\n\t}\n\n\treturn {\n\t\tstrokeDasharray: [dashLength, gapLength].join(' '),\n\t\tstrokeDashoffset: strokeDashoffset.toString(),\n\t}\n}\n","import { TLColorType } from '@tldraw/tlschema'\n\nexport * from './ShapeFill'\nexport * from './getPerfectDashProps'\n\nexport const stopEventPropagation = (e: any) => e.stopPropagation()\n\nexport type TLExportColors = {\n\tfill: Record<TLColorType, string>\n\tpattern: Record<TLColorType, string>\n\tsemi: Record<TLColorType, string>\n\tsolid: string\n\ttext: string\n\tbackground: string\n}\n","import { TLAlignType } from '@tldraw/tlschema'\nimport { TEXT_PROPS } from '../../../constants'\nimport { correctSpacesToNbsp } from '../../../utils'\nimport { App } from '../../App'\n\n/**\n * Get an SVG element for a text shape.\n */\nexport function getTextSvgElement(\n\tapp: App,\n\topts: {\n\t\tlines: string[]\n\t\tfontSize: number\n\t\tfontFamily: string\n\t\ttextAlign: TLAlignType\n\t\tfontWeight: string\n\t\tfontStyle: string\n\t\tlineHeight: number\n\t\twidth: number\n\t\theight: number\n\t\tstroke?: string\n\t\tstrokeWidth?: number\n\t\tfill?: string\n\t\tpadding?: number\n\t}\n) {\n\tconst { padding = 0 } = opts\n\n\t// Create the text element\n\tconst textElm = document.createElementNS('http://www.w3.org/2000/svg', 'text')\n\ttextElm.setAttribute('font-size', opts.fontSize + 'px')\n\ttextElm.setAttribute('font-family', opts.fontFamily)\n\ttextElm.setAttribute('font-style', opts.fontStyle)\n\ttextElm.setAttribute('font-weight', opts.fontWeight)\n\ttextElm.setAttribute('line-height', opts.lineHeight * opts.fontSize + 'px')\n\ttextElm.setAttribute('dominant-baseline', 'mathematical')\n\ttextElm.setAttribute('alignment-baseline', 'mathematical')\n\n\tconst lines = opts.lines.map((line) => line.trim())\n\n\tconst tspans: SVGElement[] = []\n\n\tconst innerHeight = lines.length * (opts.lineHeight * opts.fontSize)\n\n\tconst offsetY = (Math.ceil(opts.height) - innerHeight) / 2\n\tconst offsetX = padding\n\n\t// Create text span elements for each line\n\tfor (let i = 0; i < lines.length; i++) {\n\t\tconst tspan = document.createElementNS('http://www.w3.org/2000/svg', 'tspan')\n\t\ttspan.setAttribute('alignment-baseline', 'mathematical')\n\n\t\ttspan.textContent = correctSpacesToNbsp(lines[i])\n\n\t\tif (lines.length > 1 && i < lines.length - 1) {\n\t\t\ttspan.textContent += '\\n'\n\t\t}\n\n\t\ttspan.setAttribute(\n\t\t\t'y',\n\t\t\toffsetY + opts.fontSize / 2 + opts.lineHeight * opts.fontSize * i + 'px'\n\t\t)\n\t\ttextElm.appendChild(tspan)\n\t\ttspans.push(tspan)\n\t}\n\n\tif (opts.stroke && opts.strokeWidth) {\n\t\ttextElm.setAttribute('stroke', opts.stroke)\n\t\ttextElm.setAttribute('stroke-width', opts.strokeWidth + 'px')\n\t}\n\n\tif (opts.fill) {\n\t\ttextElm.setAttribute('fill', opts.fill)\n\t}\n\n\tswitch (opts.textAlign) {\n\t\tcase 'middle': {\n\t\t\ttextElm.setAttribute('text-align', 'center')\n\t\t\ttextElm.setAttribute('text-anchor', 'start')\n\t\t\ttspans.forEach((tspan, i) => {\n\t\t\t\tconst w = app.textMeasure.measureText({\n\t\t\t\t\t...TEXT_PROPS,\n\t\t\t\t\ttext: lines[i].trim(),\n\t\t\t\t\tfontFamily: opts.fontFamily,\n\t\t\t\t\tfontSize: opts.fontSize,\n\t\t\t\t\twidth: 'fit-content',\n\t\t\t\t\tpadding: `${padding}px`,\n\t\t\t\t}).w\n\n\t\t\t\ttspan.setAttribute('x', offsetX + (opts.width - w) / 2 + '')\n\t\t\t})\n\t\t\tbreak\n\t\t}\n\t\tcase 'end': {\n\t\t\ttextElm.setAttribute('text-align', 'right')\n\t\t\ttextElm.setAttribute('text-anchor', 'start')\n\t\t\ttspans.forEach((tspan, i) => {\n\t\t\t\tconst w = app.textMeasure.measureText({\n\t\t\t\t\t...TEXT_PROPS,\n\t\t\t\t\ttext: lines[i].trim(),\n\t\t\t\t\tfontFamily: opts.fontFamily,\n\t\t\t\t\tfontSize: opts.fontSize,\n\t\t\t\t\twidth: 'fit-content',\n\t\t\t\t\tpadding: `${padding}px`,\n\t\t\t\t}).w\n\n\t\t\t\ttspan.setAttribute('x', offsetX + opts.width - w + '')\n\t\t\t})\n\t\t\tbreak\n\t\t}\n\t\tdefault: {\n\t\t\ttextElm.setAttribute('text-align', 'left')\n\t\t\ttextElm.setAttribute('text-anchor', 'start')\n\t\t\ttspans.forEach((tspan) => tspan.setAttribute('x', offsetX + ''))\n\t\t}\n\t}\n\n\treturn textElm\n}\n","/* eslint-disable @typescript-eslint/no-unused-vars */\nimport { Box2d, linesIntersect, Matrix2d, VecLike } from '@tldraw/primitives'\nimport {\n\tTLBaseShape,\n\tTLHandle,\n\tTLShape,\n\tTLShapePartial,\n\tTLShapeType,\n\tTLUnknownShape,\n\tVec2dModel,\n} from '@tldraw/tlschema'\nimport { ComputedCache } from '@tldraw/tlstore'\nimport { computed, EMPTY_ARRAY } from 'signia'\nimport { WeakMapCache } from '../../utils'\nimport type { App } from '../App'\nimport { TLResizeHandle } from '../types/selection-types'\nimport { TLExportColors } from './shared'\n\nconst points = new WeakMapCache<TLShape, Vec2dModel>()\nconst transforms = new WeakMapCache<TLShape, Matrix2d>()\n\n/** @public */\nexport interface TLShapeUtilConstructor<\n\tT extends TLUnknownShape,\n\tShapeUtil extends TLShapeUtil<T> = TLShapeUtil<T>\n> {\n\tnew (app: App, type: T['type']): ShapeUtil\n}\n\n/** @public */\nexport type TLShapeUtilFlag<T> = (shape: T) => boolean\n\n/** @public */\nexport abstract class TLShapeUtil<T extends TLUnknownShape> {\n\tconstructor(public app: App, public readonly type: T['type']) {}\n\n\tis(shape: TLBaseShape<string, object>): shape is T {\n\t\treturn shape.type === this.type\n\t}\n\n\t/**\n\t * Whether the shape can be scrolled while editing.\n\t *\n\t * @public\n\t */\n\tcanScroll: TLShapeUtilFlag<T> = () => false\n\n\t/**\n\t * Whether the shape can be bound to by an arrow.\n\t *\n\t * @public\n\t */\n\tcanUnmount: TLShapeUtilFlag<T> = () => true\n\n\t/**\n\t * Whether the shape can be bound to by an arrow.\n\t *\n\t * @param _otherShape - The other shape attempting to bind to this shape.\n\t * @public\n\t */\n\tcanBind = <K>(_shape: T, _otherShape?: K) => true\n\n\t/**\n\t * Whether the shape can be double clicked to edit.\n\t *\n\t * @public\n\t */\n\tcanEdit: TLShapeUtilFlag<T> = () => false\n\n\t/**\n\t * Whether the shape can be resized.\n\t *\n\t * @public\n\t */\n\tcanResize: TLShapeUtilFlag<T> = () => true\n\n\t/**\n\t * Bounds of the shape to edit.\n\t *\n\t * Note: this could be a text area within a shape for example arrow labels.\n\t *\n\t * @public\n\t */\n\tgetEditingBounds = (shape: T) => {\n\t\treturn this.bounds(shape)\n\t}\n\n\t/**\n\t * Whether the shape's outline is closed.\n\t *\n\t * @public\n\t */\n\tisClosed: TLShapeUtilFlag<T> = () => true\n\n\t/**\n\t * Whether the shape should hide its resize handles when selected.\n\t *\n\t * @public\n\t */\n\thideResizeHandles: TLShapeUtilFlag<T> = () => false\n\n\t/**\n\t * Whether the shape should hide its resize handles when selected.\n\t *\n\t * @public\n\t */\n\thideRotateHandle: TLShapeUtilFlag<T> = () => false\n\n\t/**\n\t * Whether the shape should hide its selection bounds background when selected.\n\t *\n\t * @public\n\t */\n\thideSelectionBoundsBg: TLShapeUtilFlag<T> = () => false\n\n\t/**\n\t * Whether the shape should hide its selection bounds foreground when selected.\n\t *\n\t * @public\n\t */\n\thideSelectionBoundsFg: TLShapeUtilFlag<T> = () => false\n\n\t/**\n\t * Whether the shape's aspect ratio is locked.\n\t *\n\t * @public\n\t */\n\tisAspectRatioLocked: TLShapeUtilFlag<T> = () => false\n\n\t/**\n\t * Get the default props for a shape.\n\t * @public\n\t */\n\tabstract defaultProps(): T['props']\n\n\t/**\n\t * Get a JSX element for the shape (as an HTML element).\n\t * @param shape - The shape.\n\t * @public\n\t */\n\tabstract render(shape: T): any\n\n\t/**\n\t * Get JSX describing the shape's indicator (as an SVG element).\n\t * @param shape - The shape.\n\t * @public\n\t */\n\tabstract indicator(shape: T): any\n\n\t/**\n\t * Get an array of handle models for the shape. This is an optional method.\n\t *\n\t * @example\n\t * ```ts\n\t * util.getHandles?.(myShape)\n\t * ```\n\t *\n\t * @param shape - The shape.\n\t * @public\n\t */\n\tprotected getHandles?(shape: T): TLHandle[]\n\n\t@computed\n\tprivate get handlesCache(): ComputedCache<TLHandle[], TLShape> {\n\t\treturn this.app.store.createComputedCache('handles:' + this.type, (shape) => {\n\t\t\treturn this.getHandles!(shape as any)\n\t\t})\n\t}\n\n\t/**\n\t * Get the cached handles (this should not be overridden!)\n\t *\n\t * @param shape - The shape.\n\t * @public\n\t */\n\thandles(shape: T): TLHandle[] {\n\t\tif (!this.getHandles) return EMPTY_ARRAY\n\t\treturn this.handlesCache.get(shape.id) ?? EMPTY_ARRAY\n\t}\n\n\t/**\n\t * Get the (not cached) bounds for the shape.\n\t *\n\t * @param shape - The shape.\n\t * @public\n\t */\n\tprotected abstract getBounds(shape: T): Box2d\n\n\t@computed\n\tprivate get boundsCache(): ComputedCache<Box2d, TLShape> {\n\t\treturn this.app.store.createComputedCache('bounds:' + this.type, (shape) => {\n\t\t\treturn this.getBounds(shape as any)\n\t\t})\n\t}\n\n\t/**\n\t * Get the cached bounds for the shape.\n\t *\n\t * @param shape - The shape.\n\t * @public\n\t */\n\tbounds(shape: T): Box2d {\n\t\tconst result = this.boundsCache.get(shape.id) ?? new Box2d()\n\t\tif (result.width === 0 || result.height === 0) {\n\t\t\treturn new Box2d(result.x, result.y, Math.max(result.width, 1), Math.max(result.height, 1))\n\t\t}\n\t\treturn result\n\t}\n\n\t/**\n\t * Get the cached transform. Do not override this method!\n\t *\n\t * @param shape - The shape.\n\t * @public\n\t */\n\ttransform(shape: T): Matrix2d {\n\t\treturn transforms.get<T>(shape, (shape) =>\n\t\t\tMatrix2d.Compose(Matrix2d.Translate(shape.x, shape.y), Matrix2d.Rotate(shape.rotation))\n\t\t)\n\t}\n\n\t/**\n\t * Get the cached point. Do not override this method!\n\t *\n\t * @param shape - The shape.\n\t * @public\n\t */\n\tpoint(shape: T): Vec2dModel {\n\t\treturn points.get<T>(shape, (shape) => ({ x: shape.x, y: shape.y }))\n\t}\n\n\t/**\n\t * Get the shape's (not cached) outline. Do not override this method!\n\t *\n\t * @param shape - The shape.\n\t * @public\n\t */\n\tprotected abstract getOutline(shape: T): Vec2dModel[]\n\n\t@computed\n\tprivate get outlineCache(): ComputedCache<Vec2dModel[], TLShape> {\n\t\treturn this.app.store.createComputedCache('outline:' + this.type, (shape) => {\n\t\t\treturn this.getOutline(shape as any)\n\t\t})\n\t}\n\n\t/**\n\t * Get the shape's outline. Do not override this method!\n\t *\n\t * @param shape - The shape.\n\t * @public\n\t */\n\toutline(shape: T): Vec2dModel[] {\n\t\treturn this.outlineCache.get(shape.id) ?? EMPTY_ARRAY\n\t}\n\n\t/**\n\t * Get the shape's snap points.\n\t *\n\t * @param shape - The shape.\n\t * @public\n\t */\n\tsnapPoints(shape: T) {\n\t\treturn this.bounds(shape).snapPoints\n\t}\n\n\t/**\n\t * Get the shape's cached center.\n\t *\n\t * @param shape - The shape.\n\t * @public\n\t */\n\tcenter(shape: T): Vec2dModel {\n\t\treturn this.getCenter(shape)\n\t}\n\n\t/**\n\t * Get the shape's (not cached) center.\n\t *\n\t * @param shape - The shape.\n\t * @public\n\t */\n\tabstract getCenter(shape: T): Vec2dModel\n\n\t/**\n\t * Get whether the shape can receive children of a given type.\n\t *\n\t * @param type - The shape type.\n\t * @public\n\t */\n\tcanReceiveNewChildrenOfType(type: TLShapeType) {\n\t\treturn false\n\t}\n\n\t/**\n\t * Get whether the shape can receive children of a given type.\n\t *\n\t * @param shape - The shape type.\n\t * @param shapes - The shapes that are being dropped.\n\t * @public\n\t */\n\tcanDropShapes(shape: T, shapes: TLShape[]) {\n\t\treturn false\n\t}\n\n\t/**\n\t * Get the shape as an SVG object.\n\t *\n\t * @param shape - The shape.\n\t * @param color - The shape's CSS color (actual).\n\t * @param font - The shape's CSS font (actual).\n\t *\n\t * @public\n\t * @returns An SVG element.\n\t */\n\ttoSvg?(\n\t\tshape: T,\n\t\tfont: string | undefined,\n\t\tcolors: TLExportColors\n\t): SVGElement | Promise<SVGElement>\n\n\t/**\n\t * Get whether a point intersects the shape.\n\t *\n\t * @param shape - The shape.\n\t * @param point - The point to test.\n\t *\n\t * @public\n\t * @returns Whether the point intersects the shape.\n\t */\n\thitTestPoint(shape: T, point: VecLike): boolean {\n\t\treturn this.bounds(shape).containsPoint(point)\n\t}\n\n\t/**\n\t * Get whether a point intersects the shape.\n\t *\n\t * @param shape - The shape.\n\t * @param A - The line segment's first point.\n\t * @param B - The line segment's second point.\n\t *\n\t * @public\n\t * @returns Whether the line segment intersects the shape.\n\t */\n\thitTestLineSegment(shape: T, A: VecLike, B: VecLike): boolean {\n\t\tconst outline = this.outline(shape)\n\n\t\tfor (let i = 0; i < outline.length; i++) {\n\t\t\tconst C = outline[i]\n\t\t\tconst D = outline[(i + 1) % outline.length]\n\t\t\tif (linesIntersect(A, B, C, D)) return true\n\t\t}\n\n\t\treturn false\n\t}\n\n\t//  Events\n\n\t/**\n\t * A callback called just before a shape is created. This method\n\t * provides a last chance to modify the created shape.\n\t *\n\t * @example\n\t * ```ts\n\t * onBeforeUpdate = (prev, next) => {\n\t *   if (prev.x === next.x) {\n\t *   return { ...next, x: next.x + 1 }\n\t * }\n\t * ```\n\t *\n\t * @param prev - The previous shape.\n\t * @param next - The next shape.\n\t *\n\t * @returns The next shape or void.\n\t * @public\n\t */\n\tonBeforeCreate?: OnBeforeCreateHandler<T>\n\n\t/**\n\t * A callback called just before a shape is updated. This method\n\t * provides a last chance to modify the updated shape.\n\t *\n\t * @example\n\t * ```ts\n\t * onBeforeUpdate = (prev, next) => {\n\t *   if (prev.x === next.x) {\n\t *   return { ...next, x: next.x + 1 }\n\t * }\n\t * ```\n\t *\n\t * @param prev - The previous shape.\n\t * @param next - The next shape.\n\t *\n\t * @returns The next shape or void.\n\t * @public\n\t */\n\tonBeforeUpdate?: OnBeforeUpdateHandler<T>\n\n\tonDragShapesOver?: OnDragHandler<T, { shouldHint: boolean }>\n\tonDragShapesOut?: OnDragHandler<T>\n\tonDropShapesOver?: OnDragHandler<T>\n\n\tonResizeStart?: OnResizeStartHandler<T>\n\tonResize?: OnResizeHandler<T>\n\tonResizeEnd?: OnResizeEndHandler<T>\n\n\tonTranslateStart?: OnTranslateStartHandler<T>\n\tonTranslate?: OnTranslateHandler<T>\n\tonTranslateEnd?: OnTranslateEndHandler<T>\n\n\tonRotateStart?: OnRotateStartHandler<T>\n\tonRotateEnd?: OnRotateEndHandler<T>\n\tonRotate?: OnRotateHandler<T>\n\n\tonHandleChange?: OnHandleChangeHandler<T>\n\tonBindingChange?: OnBindingChangeHandler<T>\n\tonChildrenChange?: OnChildrenChangeHandler<T>\n\tonDoubleClickHandle?: OnDoubleClickHandleHandler<T>\n\tonDoubleClickEdge?: OnDoubleClickHandler<T>\n\tonDoubleClick?: OnDoubleClickHandler<T>\n\tonClick?: OnClickHandler<T>\n\tonEditEnd?: OnEditEndHandler<T>\n}\n\n/** @public */\nexport type OnBeforeCreateHandler<T extends TLShape> = (next: T) => T | void\n/** @public */\nexport type OnBeforeUpdateHandler<T extends TLShape> = (prev: T, next: T) => T | void\n\n/** @public */\nexport type OnTranslateStartHandler<T extends TLShape> = EventStartHandler<T>\n/** @public */\nexport type OnTranslateHandler<T extends TLShape> = EventChangeHandler<T>\n/** @public */\nexport type OnTranslateEndHandler<T extends TLShape> = EventChangeHandler<T>\n\n/** @public */\nexport type OnRotateStartHandler<T extends TLShape> = EventStartHandler<T>\n/** @public */\nexport type OnRotateHandler<T extends TLShape> = EventChangeHandler<T>\n/** @public */\nexport type OnRotateEndHandler<T extends TLShape> = EventChangeHandler<T>\n\n/**\n * TLResizeMode\n * 'scale_shape' - The shape is being scaled, usually as part of a larger selection.\n * 'resize_bounds' - The user is directly manipulating an individual shape's bounds using a resize handle.\n * It is up to shape util implementers to decide how they want to handle the two situations.\n *\n * @public\n */\nexport type TLResizeMode = 'scale_shape' | 'resize_bounds'\n/** @public */\nexport type OnResizeHandler<T extends TLShape> = (\n\tshape: T,\n\tinfo: {\n\t\tnewPoint: Vec2dModel\n\t\thandle: TLResizeHandle\n\t\tmode: TLResizeMode\n\t\tscaleX: number\n\t\tscaleY: number\n\t\tinitialBounds: Box2d\n\t\tinitialShape: T\n\t}\n) => Partial<TLShapePartial<T>> | undefined | void\n/** @public */\nexport type OnResizeStartHandler<T extends TLShape> = EventStartHandler<T>\n/** @public */\nexport type OnResizeEndHandler<T extends TLShape> = EventChangeHandler<T>\n\n/* -------------------- Dragging -------------------- */\n\n/** @public */\nexport type OnDragHandler<T extends TLShape, R = void> = (shape: T, shapes: TLShape[]) => R\n\n/** @public */\nexport type OnBindingChangeHandler<T extends TLShape> = (shape: T) => TLShapePartial<T> | void\n\n/** @public */\nexport type OnChildrenChangeHandler<T extends TLShape> = (shape: T) => TLShapePartial[] | void\n\n/** @public */\nexport type OnHandleChangeHandler<T extends TLShape> = (\n\tshape: T,\n\tinfo: {\n\t\thandle: TLHandle\n\t\tisPrecise: boolean\n\t}\n) => TLShapePartial<T> | void\n\n/** @public */\nexport type OnClickHandler<T extends TLShape> = (shape: T) => TLShapePartial<T> | void\n/** @public */\nexport type OnEditEndHandler<T extends TLShape> = (shape: T) => void\n/** @public */\nexport type OnDoubleClickHandler<T extends TLShape> = (shape: T) => TLShapePartial<T> | void\n/** @public */\nexport type OnDoubleClickHandleHandler<T extends TLShape> = (\n\tshape: T,\n\thandle: TLHandle\n) => TLShapePartial<T> | void\n\ntype EventStartHandler<T extends TLShape> = (shape: T) => TLShapePartial<T> | void\ntype EventChangeHandler<T extends TLShape> = (initial: T, current: T) => TLShapePartial<T> | void\n","import { intersectCircleCircle, PI, TAU, Vec2d, VecLike } from '@tldraw/primitives'\nimport { ArrowInfo } from './arrow-types'\n\ntype TLArrowPointsInfo = {\n\tpoint: VecLike\n\tint: VecLike\n}\n\nfunction getArrowPoints(\n\tinfo: ArrowInfo,\n\tside: 'start' | 'end',\n\tstrokeWidth: number\n): TLArrowPointsInfo {\n\tconst PT = side === 'end' ? info.end.point : info.start.point\n\tconst PB = side === 'end' ? info.start.point : info.end.point\n\n\tconst compareLength = info.isStraight ? Vec2d.Dist(PB, PT) : Math.abs(info.bodyArc.length) // todo: arc length for curved arrows\n\n\tconst length = Math.max(Math.min(compareLength / 5, strokeWidth * 3), strokeWidth)\n\n\tlet P0: VecLike\n\n\tif (info.isStraight) {\n\t\tP0 = Vec2d.Nudge(PT, PB, length)\n\t} else {\n\t\tconst ints = intersectCircleCircle(PT, length, info.handleArc.center, info.handleArc.radius)\n\t\tP0 =\n\t\t\tside === 'end'\n\t\t\t\t? info.handleArc.sweepFlag\n\t\t\t\t\t? ints[0]\n\t\t\t\t\t: ints[1]\n\t\t\t\t: info.handleArc.sweepFlag\n\t\t\t\t? ints[1]\n\t\t\t\t: ints[0]\n\t}\n\n\treturn {\n\t\tpoint: PT,\n\t\tint: P0,\n\t}\n}\n\nexport function getArrowhead({ point, int }: TLArrowPointsInfo) {\n\tconst PL = Vec2d.RotWith(int, point, PI / 6)\n\tconst PR = Vec2d.RotWith(int, point, -PI / 6)\n\n\treturn `M ${PL.x} ${PL.y} L ${point.x} ${point.y} L ${PR.x} ${PR.y}`\n}\n\nexport function getTriangleHead({ point, int }: TLArrowPointsInfo) {\n\tconst PL = Vec2d.RotWith(int, point, PI / 6)\n\tconst PR = Vec2d.RotWith(int, point, -PI / 6)\n\n\treturn `M ${PL.x} ${PL.y} L ${point.x} ${point.y} L ${PR.x} ${PR.y} Z`\n}\n\nexport function getInvertedTriangleHead({ point, int }: TLArrowPointsInfo) {\n\tconst d = Vec2d.Sub(int, point).div(2)\n\tconst PL = Vec2d.Add(point, Vec2d.Rot(d, TAU))\n\tconst PR = Vec2d.Sub(point, Vec2d.Rot(d, TAU))\n\n\treturn `M ${PL.x} ${PL.y} L ${int.x} ${int.y} L ${PR.x} ${PR.y} Z`\n}\n\nexport function getDotHead({ point, int }: TLArrowPointsInfo) {\n\tconst A = Vec2d.Lrp(point, int, 0.45)\n\tconst r = Vec2d.Dist(A, point)\n\n\treturn `M ${A.x - r},${A.y}\n  a ${r},${r} 0 1,0 ${r * 2},0\n  a ${r},${r} 0 1,0 -${r * 2},0 `\n}\n\nexport function getDiamondHead({ point, int }: TLArrowPointsInfo) {\n\tconst PB = Vec2d.Lrp(point, int, 0.75)\n\tconst PL = Vec2d.RotWith(PB, point, PI / 4)\n\tconst PR = Vec2d.RotWith(PB, point, -PI / 4)\n\n\tconst PQ = Vec2d.Lrp(PL, PR, 0.5)\n\tPQ.add(Vec2d.Sub(PQ, point))\n\n\treturn `M ${PQ.x} ${PQ.y} L ${PL.x} ${PL.y} ${point.x} ${point.y} L ${PR.x} ${PR.y} Z`\n}\n\nexport function getSquareHead({ int, point }: TLArrowPointsInfo) {\n\tconst PB = Vec2d.Lrp(point, int, 0.85)\n\tconst d = Vec2d.Sub(PB, point).div(2)\n\tconst PL1 = Vec2d.Add(point, Vec2d.Rot(d, TAU))\n\tconst PR1 = Vec2d.Sub(point, Vec2d.Rot(d, TAU))\n\tconst PL2 = Vec2d.Add(PB, Vec2d.Rot(d, TAU))\n\tconst PR2 = Vec2d.Sub(PB, Vec2d.Rot(d, TAU))\n\n\treturn `M ${PL1.x} ${PL1.y} L ${PL2.x} ${PL2.y} L ${PR2.x} ${PR2.y} L ${PR1.x} ${PR1.y} Z`\n}\n\nexport function getBarHead({ int, point }: TLArrowPointsInfo) {\n\tconst d = Vec2d.Sub(int, point).div(2)\n\n\tconst PL = Vec2d.Add(point, Vec2d.Rot(d, TAU))\n\tconst PR = Vec2d.Sub(point, Vec2d.Rot(d, TAU))\n\n\treturn `M ${PL.x} ${PL.y} L ${PR.x} ${PR.y}`\n}\n\nexport function getPipeHead() {\n\treturn ''\n}\n\nexport function getArrowheadPathForType(\n\tinfo: ArrowInfo,\n\tside: 'start' | 'end',\n\tstrokeWidth: number\n): string | undefined {\n\tconst type = side === 'end' ? info.end.arrowhead : info.start.arrowhead\n\tif (type === 'none') return\n\n\tconst points = getArrowPoints(info, side, strokeWidth)\n\tif (!points) return\n\n\tswitch (type) {\n\t\tcase 'bar':\n\t\t\treturn getBarHead(points)\n\t\tcase 'square':\n\t\t\treturn getSquareHead(points)\n\t\tcase 'diamond':\n\t\t\treturn getDiamondHead(points)\n\t\tcase 'dot':\n\t\t\treturn getDotHead(points)\n\t\tcase 'inverted':\n\t\t\treturn getInvertedTriangleHead(points)\n\t\tcase 'arrow':\n\t\t\treturn getArrowhead(points)\n\t\tcase 'triangle':\n\t\t\treturn getTriangleHead(points)\n\t}\n\n\treturn ''\n}\n","import { Matrix2d, Vec2d } from '@tldraw/primitives'\nimport { TLArrowShape, TLArrowTerminal, TLShape } from '@tldraw/tlschema'\nimport { App } from '../../../App'\nimport { TLShapeUtil } from '../../TLShapeUtil'\n\nexport function getIsArrowStraight(shape: TLArrowShape) {\n\treturn Math.abs(shape.props.bend) < 8 // snap to +-8px\n}\n\nexport type BoundShapeInfo<T extends TLShape = TLShape> = {\n\tshape: T\n\tutil: TLShapeUtil<T>\n\tdidIntersect: boolean\n\tisExact: boolean\n\ttransform: Matrix2d\n\t// toLocalPoint: (v: VecLike) => Vec2d\n\t// toPagePoint: (v: VecLike) => Vec2d\n}\n\nexport function getBoundShapeInfoForTerminal(\n\tapp: App,\n\tterminal: TLArrowTerminal\n): BoundShapeInfo | undefined {\n\tif (terminal.type === 'point') {\n\t\treturn\n\t}\n\n\tconst shape = app.getShapeById(terminal.boundShapeId)!\n\tconst util = app.getShapeUtil(shape)\n\tconst transform = app.getPageTransform(shape)!\n\n\treturn {\n\t\tshape,\n\t\tutil,\n\t\ttransform,\n\t\tisExact: terminal.isExact,\n\t\tdidIntersect: false,\n\t}\n}\n\nexport function getArrowTerminalInArrowSpace(\n\tapp: App,\n\tarrowPageTransform: Matrix2d,\n\tterminal: TLArrowTerminal\n) {\n\tif (terminal.type === 'point') {\n\t\treturn Vec2d.From(terminal)\n\t}\n\n\tconst boundShape = app.getShapeById(terminal.boundShapeId)\n\n\tif (!boundShape) {\n\t\tconsole.error('Expected a bound shape!')\n\t\treturn new Vec2d(0, 0)\n\t} else {\n\t\t// Find the actual local point of the normalized terminal on\n\t\t// the bound shape and transform it to page space, then transform\n\t\t// it to arrow space\n\t\tconst { point, size } = app.getBounds(boundShape)\n\t\tconst shapePoint = Vec2d.Add(point, Vec2d.MulV(terminal.normalizedAnchor, size))\n\t\tconst pagePoint = Matrix2d.applyToPoint(app.getPageTransform(boundShape)!, shapePoint)\n\t\tconst arrowPoint = Matrix2d.applyToPoint(Matrix2d.Inverse(arrowPageTransform), pagePoint)\n\t\treturn arrowPoint\n\t}\n}\n\nexport function getArrowTerminalsInArrowSpace(app: App, shape: TLArrowShape) {\n\tconst arrowPageTransform = app.getPageTransform(shape)!\n\n\tconst start = getArrowTerminalInArrowSpace(app, arrowPageTransform, shape.props.start)\n\tconst end = getArrowTerminalInArrowSpace(app, arrowPageTransform, shape.props.end)\n\n\treturn { start, end }\n}\n","import {\n\tBox2d,\n\tintersectLineSegmentPolygon,\n\tintersectLineSegmentPolyline,\n\tMatrix2d,\n\tMatrix2dModel,\n\tVec2d,\n\tVecLike,\n} from '@tldraw/primitives'\nimport { TLArrowShape } from '@tldraw/tlschema'\nimport { BOUND_ARROW_OFFSET, MIN_ARROW_LENGTH } from '../../../../constants'\nimport { App } from '../../../App'\nimport { ArrowInfo } from './arrow-types'\nimport {\n\tBoundShapeInfo,\n\tgetArrowTerminalsInArrowSpace,\n\tgetBoundShapeInfoForTerminal,\n} from './shared'\n\nexport function getStraightArrowInfo(app: App, shape: TLArrowShape): ArrowInfo {\n\tconst { start, end, arrowheadStart, arrowheadEnd } = shape.props\n\n\tconst terminalsInArrowSpace = getArrowTerminalsInArrowSpace(app, shape)\n\n\tconst a = terminalsInArrowSpace.start.clone()\n\tconst b = terminalsInArrowSpace.end.clone()\n\tconst c = Vec2d.Med(a, b)\n\tconst uAB = Vec2d.Sub(b, a).uni()\n\n\t// Update the arrowhead points using intersections with the bound shapes, if any.\n\n\tconst startShapeInfo = getBoundShapeInfoForTerminal(app, start)\n\tconst endShapeInfo = getBoundShapeInfoForTerminal(app, end)\n\n\tconst arrowPageTransform = app.getPageTransform(shape)!\n\n\t// Update the position of the arrowhead's end point\n\tupdateArrowheadPointWithBoundShape(\n\t\tb, // <-- will be mutated\n\t\tterminalsInArrowSpace.start,\n\t\tarrowPageTransform,\n\t\tendShapeInfo\n\t)\n\n\t// Then update the position of the arrowhead's end point\n\tupdateArrowheadPointWithBoundShape(\n\t\ta, // <-- will be mutated\n\t\tterminalsInArrowSpace.end,\n\t\tarrowPageTransform,\n\t\tstartShapeInfo\n\t)\n\n\tlet minDist = MIN_ARROW_LENGTH\n\n\tconst isSelfIntersection =\n\t\tstartShapeInfo && endShapeInfo && startShapeInfo.shape === endShapeInfo.shape\n\n\tif (\n\t\tstartShapeInfo &&\n\t\tendShapeInfo &&\n\t\t!isSelfIntersection &&\n\t\t!startShapeInfo.isExact &&\n\t\t!endShapeInfo.isExact\n\t) {\n\t\tif (endShapeInfo.didIntersect && !startShapeInfo.didIntersect) {\n\t\t\t// ...and if only the end shape intersected, then make it\n\t\t\t// a short arrow ending at the end shape intersection.\n\t\t\tif (startShapeInfo.util.isClosed(startShapeInfo.shape)) {\n\t\t\t\ta.setTo(Vec2d.Nudge(b, a, minDist))\n\t\t\t}\n\t\t} else if (!endShapeInfo.didIntersect) {\n\t\t\t// ...and if only the end shape intersected, or if neither\n\t\t\t// shape intersected, then make it a short arrow starting\n\t\t\t// at the start shape intersection.\n\t\t\tif (endShapeInfo.util.isClosed(endShapeInfo.shape)) {\n\t\t\t\tb.setTo(Vec2d.Nudge(a, b, minDist))\n\t\t\t}\n\t\t}\n\t}\n\n\tconst u = Vec2d.Sub(b, a).uni()\n\tconst didFlip = !Vec2d.Equals(u, uAB)\n\n\t// If the arrow is bound non-exact to a start shape and the\n\t// start point has an arrowhead offset the start point\n\tif (!isSelfIntersection) {\n\t\tif (startShapeInfo && arrowheadStart !== 'none' && !startShapeInfo.isExact) {\n\t\t\tconst offset =\n\t\t\t\tBOUND_ARROW_OFFSET +\n\t\t\t\tapp.getStrokeWidth(shape.props.size) / 2 +\n\t\t\t\t('size' in startShapeInfo.shape.props\n\t\t\t\t\t? app.getStrokeWidth(startShapeInfo.shape.props.size) / 2\n\t\t\t\t\t: 0)\n\n\t\t\tminDist -= offset\n\t\t\ta.nudge(b, offset * (didFlip ? -1 : 1))\n\t\t}\n\n\t\t// If the arrow is bound non-exact to an end shape and the\n\t\t// end point has an arrowhead offset the end point\n\t\tif (endShapeInfo && arrowheadEnd !== 'none' && !endShapeInfo.isExact) {\n\t\t\tconst offset =\n\t\t\t\tBOUND_ARROW_OFFSET +\n\t\t\t\tapp.getStrokeWidth(shape.props.size) / 2 +\n\t\t\t\t('size' in endShapeInfo.shape.props\n\t\t\t\t\t? app.getStrokeWidth(endShapeInfo.shape.props.size) / 2\n\t\t\t\t\t: 0)\n\n\t\t\tminDist -= offset\n\t\t\tb.nudge(a, offset * (didFlip ? -1 : 1))\n\t\t}\n\t}\n\n\tif (startShapeInfo && endShapeInfo) {\n\t\t// If we have two bound shapes...\n\t\tif (didFlip) {\n\t\t\t// If we flipped, then make the arrow a short arrow from\n\t\t\t// the start point towards where the end point should be.\n\t\t\tb.setTo(Vec2d.Add(a, u.mul(-minDist)))\n\t\t} else if (Vec2d.Dist(a, b) < MIN_ARROW_LENGTH / 2) {\n\t\t\t// Otherwise, if the arrow is too short, make it a short\n\t\t\t// arrow from the start point towards where the end point\n\t\t\t// should be.\n\t\t\tb.setTo(Vec2d.Add(a, u.mul(MIN_ARROW_LENGTH / 2)))\n\t\t}\n\t}\n\n\t// If the handles flipped their order, then set the center handle\n\t// to the midpoint of the terminals (rather than the midpoint of the\n\t// arrow body); otherwise, it may not be \"between\" the other terminals.\n\tif (didFlip) {\n\t\tc.setTo(Vec2d.Med(terminalsInArrowSpace.start, terminalsInArrowSpace.end))\n\t} else {\n\t\tc.setTo(Vec2d.Med(a, b))\n\t}\n\n\tconst length = Vec2d.Dist(a, b)\n\n\treturn {\n\t\tisStraight: true,\n\t\tstart: {\n\t\t\thandle: terminalsInArrowSpace.start,\n\t\t\tpoint: a,\n\t\t\tarrowhead: shape.props.arrowheadStart,\n\t\t},\n\t\tend: {\n\t\t\thandle: terminalsInArrowSpace.end,\n\t\t\tpoint: b,\n\t\t\tarrowhead: shape.props.arrowheadEnd,\n\t\t},\n\t\tmiddle: c,\n\t\tisValid: length > 0,\n\t\tlength,\n\t}\n}\n\n/**\n * Get an intersection point from A -> B with bound shape (target) from shape (arrow).\n */\nfunction updateArrowheadPointWithBoundShape(\n\tpoint: Vec2d,\n\topposite: Vec2d,\n\tarrowPageTransform: Matrix2dModel,\n\ttargetShapeInfo?: BoundShapeInfo\n) {\n\tif (targetShapeInfo === undefined) {\n\t\t// No bound shape? The arrowhead point will be at the arrow terminal.\n\t\treturn\n\t}\n\n\tif (targetShapeInfo.isExact) {\n\t\t// Exact type binding? The arrowhead point will be at the arrow terminal.\n\t\treturn\n\t}\n\n\t// From and To in page space\n\tconst pageFrom = Matrix2d.applyToPoint(arrowPageTransform, opposite)\n\tconst pageTo = Matrix2d.applyToPoint(arrowPageTransform, point)\n\n\t// From and To in local space of the target shape\n\tconst targetFrom = Matrix2d.applyToPoint(Matrix2d.Inverse(targetShapeInfo.transform), pageFrom)\n\tconst targetTo = Matrix2d.applyToPoint(Matrix2d.Inverse(targetShapeInfo.transform), pageTo)\n\n\tconst isClosed = targetShapeInfo.util.isClosed(targetShapeInfo.shape)\n\tconst fn = isClosed ? intersectLineSegmentPolygon : intersectLineSegmentPolyline\n\n\tconst intersection = fn(targetFrom, targetTo, targetShapeInfo.util.outline(targetShapeInfo.shape))\n\n\tlet targetInt: VecLike | undefined\n\n\tif (intersection !== null) {\n\t\ttargetInt =\n\t\t\tintersection.sort((p1, p2) => Vec2d.Dist(p1, targetFrom) - Vec2d.Dist(p2, targetFrom))[0] ??\n\t\t\t(isClosed ? undefined : targetTo)\n\t}\n\n\tif (targetInt === undefined) {\n\t\t// No intersection? The arrowhead point will be at the arrow terminal.\n\t\treturn\n\t}\n\n\tconst pageInt = Matrix2d.applyToPoint(targetShapeInfo.transform, targetInt)\n\tconst arrowInt = Matrix2d.applyToPoint(Matrix2d.Inverse(arrowPageTransform), pageInt)\n\n\tpoint.setTo(arrowInt)\n\n\ttargetShapeInfo.didIntersect = true\n}\n\nexport function getStraightArrowHandlePath(info: ArrowInfo & { isStraight: true }) {\n\treturn getArrowPath(info.start.handle, info.end.handle)\n}\n\nexport function getSolidStraightArrowPath(info: ArrowInfo & { isStraight: true }) {\n\treturn getArrowPath(info.start.point, info.end.point)\n}\n\nfunction getArrowPath(start: VecLike, end: VecLike) {\n\treturn `M${start.x},${start.y}L${end.x},${end.y}`\n}\n\nexport function getStraightArrowBoundingBox(start: VecLike, end: VecLike) {\n\treturn new Box2d(\n\t\tMath.min(start.x, end.x),\n\t\tMath.min(start.y, end.y),\n\t\tMath.abs(start.x - end.x),\n\t\tMath.abs(start.y - end.y)\n\t)\n}\n","import {\n\tBox2d,\n\tgetArcLength,\n\tgetPointOnCircle,\n\tintersectCirclePolygon,\n\tintersectCirclePolyline,\n\tlerpAngles,\n\tMatrix2d,\n\tPI,\n\tPI2,\n\tshortAngleDist,\n\tVec2d,\n\tVecLike,\n} from '@tldraw/primitives'\nimport { TLArrowShape } from '@tldraw/tlschema'\nimport {\n\tBOUND_ARROW_OFFSET,\n\tMIN_ARROW_LENGTH,\n\tWAY_TOO_BIG_ARROW_BEND_FACTOR,\n} from '../../../../constants'\nimport type { App } from '../../../App'\nimport { ArcInfo, ArrowInfo } from './arrow-types'\nimport { getArrowTerminalsInArrowSpace, getBoundShapeInfoForTerminal } from './shared'\nimport { getStraightArrowInfo } from './straight-arrow'\n\nexport function getCurvedArrowInfo(app: App, shape: TLArrowShape, extraBend = 0): ArrowInfo {\n\tconst { arrowheadEnd, arrowheadStart } = shape.props\n\tconst bend = shape.props.bend + extraBend\n\n\tif (Math.abs(bend) > Math.abs(shape.props.bend * WAY_TOO_BIG_ARROW_BEND_FACTOR)) {\n\t\treturn getStraightArrowInfo(app, shape)\n\t}\n\n\tconst terminalsInArrowSpace = getArrowTerminalsInArrowSpace(app, shape)\n\n\tconst med = Vec2d.Med(terminalsInArrowSpace.start, terminalsInArrowSpace.end) // point between start and end\n\tconst u = Vec2d.Sub(terminalsInArrowSpace.end, terminalsInArrowSpace.start).uni() // unit vector between start and end\n\tconst middle = Vec2d.Add(med, u.per().mul(-bend)) // middle handle\n\n\tconst startShapeInfo = getBoundShapeInfoForTerminal(app, shape.props.start)\n\tconst endShapeInfo = getBoundShapeInfoForTerminal(app, shape.props.end)\n\n\t// The positions of the body of the arrow, which may be different\n\t// than the arrow's start / end points if the arrow is bound to shapes\n\tconst a = terminalsInArrowSpace.start.clone()\n\tconst b = terminalsInArrowSpace.end.clone()\n\tconst c = middle.clone()\n\n\tconst handleArc = getArcInfo(a, b, c)\n\n\tconst arrowPageTransform = app.getPageTransform(shape)!\n\n\tif (startShapeInfo && !startShapeInfo.isExact) {\n\t\t// Points in page space\n\t\tconst startInPageSpace = Matrix2d.applyToPoint(arrowPageTransform, a)\n\t\tconst endInPageSpace = Matrix2d.applyToPoint(arrowPageTransform, b)\n\t\tconst centerInPageSpace = Matrix2d.applyToPoint(arrowPageTransform, handleArc.center)\n\n\t\t// Points in local space of the start shape\n\t\tconst inverseTransform = Matrix2d.Inverse(startShapeInfo.transform)\n\t\tconst startInStartShapeLocalSpace = Matrix2d.applyToPoint(inverseTransform, startInPageSpace)\n\t\tconst endInStartShapeLocalSpace = Matrix2d.applyToPoint(inverseTransform, endInPageSpace)\n\t\tconst centerInStartShapeLocalSpace = Matrix2d.applyToPoint(inverseTransform, centerInPageSpace)\n\n\t\tconst isClosed = startShapeInfo.util.isClosed(startShapeInfo.shape)\n\t\tconst fn = isClosed ? intersectCirclePolygon : intersectCirclePolyline\n\n\t\tlet point: VecLike | undefined\n\n\t\tlet intersections = fn(\n\t\t\tcenterInStartShapeLocalSpace,\n\t\t\thandleArc.radius,\n\t\t\tstartShapeInfo.util.outline(startShapeInfo.shape)\n\t\t)\n\n\t\tif (intersections) {\n\t\t\tintersections = intersections.filter(\n\t\t\t\t(pt) =>\n\t\t\t\t\t+Vec2d.Clockwise(startInStartShapeLocalSpace, pt, endInStartShapeLocalSpace) ===\n\t\t\t\t\thandleArc.sweepFlag\n\t\t\t)\n\n\t\t\tconst angleToMiddle = Vec2d.Angle(handleArc.center, middle)\n\t\t\tconst angleToStart = Vec2d.Angle(handleArc.center, terminalsInArrowSpace.start)\n\t\t\tconst comparisonAngle = lerpAngles(angleToMiddle, angleToStart, 0.5)\n\n\t\t\tintersections.sort(\n\t\t\t\t(p0, p1) =>\n\t\t\t\t\tMath.abs(shortAngleDist(comparisonAngle, centerInStartShapeLocalSpace.angle(p0))) -\n\t\t\t\t\tMath.abs(shortAngleDist(comparisonAngle, centerInStartShapeLocalSpace.angle(p1)))\n\t\t\t)\n\n\t\t\tpoint = intersections[0] ?? (isClosed ? undefined : startInStartShapeLocalSpace)\n\t\t} else {\n\t\t\tpoint = isClosed ? undefined : startInStartShapeLocalSpace\n\t\t}\n\n\t\tif (point) {\n\t\t\ta.setTo(\n\t\t\t\tapp.getPointInShapeSpace(shape, Matrix2d.applyToPoint(startShapeInfo.transform, point))\n\t\t\t)\n\n\t\t\tstartShapeInfo.didIntersect = true\n\n\t\t\tif (arrowheadStart !== 'none') {\n\t\t\t\tconst offset =\n\t\t\t\t\tBOUND_ARROW_OFFSET +\n\t\t\t\t\tapp.getStrokeWidth(shape.props.size) / 2 +\n\t\t\t\t\t('size' in startShapeInfo.shape.props\n\t\t\t\t\t\t? app.getStrokeWidth(startShapeInfo.shape.props.size) / 2\n\t\t\t\t\t\t: 0)\n\n\t\t\t\ta.setTo(\n\t\t\t\t\tgetPointOnCircle(\n\t\t\t\t\t\thandleArc.center.x,\n\t\t\t\t\t\thandleArc.center.y,\n\t\t\t\t\t\thandleArc.radius,\n\t\t\t\t\t\tlerpAngles(\n\t\t\t\t\t\t\tVec2d.Angle(handleArc.center, a),\n\t\t\t\t\t\t\tVec2d.Angle(handleArc.center, middle),\n\t\t\t\t\t\t\toffset / Math.abs(getArcLength(handleArc.center, handleArc.radius, a, middle))\n\t\t\t\t\t\t)\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t}\n\t\t}\n\t}\n\n\tif (endShapeInfo && !endShapeInfo.isExact) {\n\t\t// get points in shape's coordinates?\n\t\tconst startInPageSpace = Matrix2d.applyToPoint(arrowPageTransform, a)\n\t\tconst endInPageSpace = Matrix2d.applyToPoint(arrowPageTransform, b)\n\t\tconst centerInPageSpace = Matrix2d.applyToPoint(arrowPageTransform, handleArc.center)\n\n\t\tconst inverseTransform = Matrix2d.Inverse(endShapeInfo.transform)\n\n\t\tconst startInEndShapeLocalSpace = Matrix2d.applyToPoint(inverseTransform, startInPageSpace)\n\t\tconst endInEndShapeLocalSpace = Matrix2d.applyToPoint(inverseTransform, endInPageSpace)\n\t\tconst centerInEndShapeLocalSpace = Matrix2d.applyToPoint(inverseTransform, centerInPageSpace)\n\n\t\tconst isClosed = endShapeInfo.util.isClosed(endShapeInfo.shape)\n\t\tconst fn = isClosed ? intersectCirclePolygon : intersectCirclePolyline\n\n\t\tconst angleToMiddle = Vec2d.Angle(handleArc.center, middle)\n\t\tconst angleToEnd = Vec2d.Angle(handleArc.center, terminalsInArrowSpace.end)\n\t\tconst comparisonAngle = lerpAngles(angleToMiddle, angleToEnd, 0.5)\n\n\t\tlet point: VecLike | undefined\n\n\t\tlet intersections = fn(\n\t\t\tcenterInEndShapeLocalSpace,\n\t\t\thandleArc.radius,\n\t\t\tendShapeInfo.util.outline(endShapeInfo.shape)\n\t\t)\n\n\t\tif (intersections) {\n\t\t\tintersections = intersections.filter(\n\t\t\t\t(pt) =>\n\t\t\t\t\t+Vec2d.Clockwise(startInEndShapeLocalSpace, pt, endInEndShapeLocalSpace) ===\n\t\t\t\t\thandleArc.sweepFlag\n\t\t\t)\n\n\t\t\tintersections.sort(\n\t\t\t\t(p0, p1) =>\n\t\t\t\t\tMath.abs(shortAngleDist(comparisonAngle, centerInEndShapeLocalSpace.angle(p0))) -\n\t\t\t\t\tMath.abs(shortAngleDist(comparisonAngle, centerInEndShapeLocalSpace.angle(p1)))\n\t\t\t)\n\n\t\t\tpoint = intersections[0] ?? (isClosed ? undefined : endInEndShapeLocalSpace)\n\t\t} else {\n\t\t\tpoint = isClosed ? undefined : endInEndShapeLocalSpace\n\t\t}\n\n\t\tif (point) {\n\t\t\t// Set b to target local point -> page point -> shape local point\n\t\t\tb.setTo(app.getPointInShapeSpace(shape, Matrix2d.applyToPoint(endShapeInfo.transform, point)))\n\n\t\t\tendShapeInfo.didIntersect = true\n\n\t\t\tif (arrowheadEnd !== 'none') {\n\t\t\t\tlet offset =\n\t\t\t\t\tBOUND_ARROW_OFFSET +\n\t\t\t\t\tapp.getStrokeWidth(shape.props.size) / 2 +\n\t\t\t\t\t('size' in endShapeInfo.shape.props\n\t\t\t\t\t\t? app.getStrokeWidth(endShapeInfo.shape.props.size) / 2\n\t\t\t\t\t\t: 0)\n\n\t\t\t\tif (Vec2d.Dist(a, b) < MIN_ARROW_LENGTH) {\n\t\t\t\t\toffset *= -2\n\t\t\t\t}\n\n\t\t\t\tb.setTo(\n\t\t\t\t\tgetPointOnCircle(\n\t\t\t\t\t\thandleArc.center.x,\n\t\t\t\t\t\thandleArc.center.y,\n\t\t\t\t\t\thandleArc.radius,\n\t\t\t\t\t\tlerpAngles(\n\t\t\t\t\t\t\tVec2d.Angle(handleArc.center, b),\n\t\t\t\t\t\t\tVec2d.Angle(handleArc.center, middle),\n\t\t\t\t\t\t\toffset / Math.abs(getArcLength(handleArc.center, handleArc.radius, b, middle))\n\t\t\t\t\t\t)\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t}\n\t\t}\n\t}\n\n\tconst length = Math.abs(getArcLength(handleArc.center, handleArc.radius, a, b))\n\n\tif (length < MIN_ARROW_LENGTH / 2) {\n\t\ta.setTo(terminalsInArrowSpace.start)\n\t\tb.setTo(terminalsInArrowSpace.end)\n\t}\n\n\tif (\n\t\tstartShapeInfo &&\n\t\tendShapeInfo &&\n\t\tstartShapeInfo.shape !== endShapeInfo.shape &&\n\t\t!startShapeInfo.isExact &&\n\t\t!endShapeInfo.isExact\n\t) {\n\t\t// If we missed an intersection, then try\n\t\tconst startAngle = Vec2d.Angle(handleArc.center, a)\n\t\tconst endAngle = Vec2d.Angle(handleArc.center, b)\n\n\t\tconst offset = handleArc.sweepFlag ? MIN_ARROW_LENGTH : -MIN_ARROW_LENGTH\n\t\tconst arcLength = getArcLength(handleArc.center, handleArc.radius, b, a)\n\t\tconst {\n\t\t\tcenter: { x, y },\n\t\t\tradius,\n\t\t} = handleArc\n\n\t\tif (startShapeInfo && !startShapeInfo.didIntersect) {\n\t\t\ta.setTo(getPointOnCircle(x, y, radius, lerpAngles(startAngle, endAngle, offset / arcLength)))\n\t\t}\n\n\t\tif (endShapeInfo && !endShapeInfo.didIntersect) {\n\t\t\tb.setTo(getPointOnCircle(x, y, radius, lerpAngles(startAngle, endAngle, -offset / arcLength)))\n\t\t}\n\t}\n\n\tlet midAngle = lerpAngles(Vec2d.Angle(handleArc.center, a), Vec2d.Angle(handleArc.center, b), 0.5)\n\tlet midPoint = getPointOnCircle(\n\t\thandleArc.center.x,\n\t\thandleArc.center.y,\n\t\thandleArc.radius,\n\t\tmidAngle\n\t)\n\n\tif (+Vec2d.Clockwise(a, midPoint, b) !== handleArc.sweepFlag) {\n\t\tmidAngle += PI\n\t\tmidPoint = getPointOnCircle(handleArc.center.x, handleArc.center.y, handleArc.radius, midAngle)\n\t}\n\n\tc.setTo(midPoint)\n\n\tconst bodyArc = getArcInfo(a, b, c)\n\n\treturn {\n\t\tisStraight: false,\n\t\tstart: {\n\t\t\tpoint: a,\n\t\t\thandle: terminalsInArrowSpace.start,\n\t\t\tarrowhead: shape.props.arrowheadStart,\n\t\t},\n\t\tend: {\n\t\t\tpoint: b,\n\t\t\thandle: terminalsInArrowSpace.end,\n\t\t\tarrowhead: shape.props.arrowheadEnd,\n\t\t},\n\t\tmiddle: c,\n\t\thandleArc,\n\t\tbodyArc,\n\t\tisValid: bodyArc.length !== 0 && isFinite(bodyArc.center.x) && isFinite(bodyArc.center.y),\n\t}\n}\n\n/**\n * Get a solid path for a curved arrow's handles.\n *\n * @param info - The arrow info.\n */\nexport function getCurvedArrowHandlePath(info: ArrowInfo & { isStraight: false }) {\n\tconst {\n\t\tstart,\n\t\tend,\n\t\thandleArc: { radius, largeArcFlag, sweepFlag },\n\t} = info\n\treturn `M${start.handle.x},${start.handle.y} A${radius} ${radius} 0 ${largeArcFlag} ${sweepFlag} ${end.handle.x},${end.handle.y}`\n}\n\n/**\n * Get a solid path for a curved arrow's body.\n *\n * @param info - The arrow info.\n */\nexport function getSolidCurvedArrowPath(info: ArrowInfo & { isStraight: false }) {\n\tconst {\n\t\tstart,\n\t\tend,\n\t\tbodyArc: { radius, largeArcFlag, sweepFlag },\n\t} = info\n\treturn `M${start.point.x},${start.point.y} A${radius} ${radius} 0 ${largeArcFlag} ${sweepFlag} ${end.point.x},${end.point.y}`\n}\n\n/**\n * Get a point along an arc.\n *\n * @param center - The arc's center.\n * @param radius - The arc's radius.\n * @param startAngle - The start point of the arc.\n * @param size - The size of the arc.\n * @param t - The point along the arc to get.\n */\nexport function getPointOnArc(\n\tcenter: VecLike,\n\tradius: number,\n\tstartAngle: number,\n\tsize: number,\n\tt: number\n) {\n\tconst angle = startAngle + size * t\n\treturn new Vec2d(center.x + radius * Math.cos(angle), center.y + radius * Math.sin(angle))\n}\n\n/**\n * Get a bounding box for an arc.\n *\n * @param center - The arc's center.\n * @param radius - The arc's radius.\n * @param start - The start point of the arc.\n * @param size - The size of the arc.\n */\nexport function getArcBoundingBox(center: VecLike, radius: number, start: VecLike, size: number) {\n\tlet minX = Infinity\n\tlet minY = Infinity\n\tlet maxX = -Infinity\n\tlet maxY = -Infinity\n\n\tconst startAngle = Vec2d.Angle(center, start)\n\n\t// Test 20 points along the arc\n\tfor (let i = 0; i < 20; i++) {\n\t\tconst angle = startAngle + size * (i / 19)\n\t\tconst x = center.x + radius * Math.cos(angle)\n\t\tconst y = center.y + radius * Math.sin(angle)\n\n\t\tminX = Math.min(x, minX)\n\t\tminY = Math.min(y, minY)\n\t\tmaxX = Math.max(x, maxX)\n\t\tmaxY = Math.max(y, maxY)\n\t}\n\n\treturn new Box2d(minX, minY, maxX - minX, maxY - minY)\n}\n\n/**\n * Get info about an arc formed by three points.\n *\n * @param a - The start of the arc\n * @param b - The end of the arc\n * @param c - A point on the arc\n */\nexport function getArcInfo(a: VecLike, b: VecLike, c: VecLike): ArcInfo {\n\t// find a circle from the three points\n\tconst u = -2 * (a.x * (b.y - c.y) - a.y * (b.x - c.x) + b.x * c.y - c.x * b.y)\n\n\tconst center = {\n\t\tx:\n\t\t\t((a.x * a.x + a.y * a.y) * (c.y - b.y) +\n\t\t\t\t(b.x * b.x + b.y * b.y) * (a.y - c.y) +\n\t\t\t\t(c.x * c.x + c.y * c.y) * (b.y - a.y)) /\n\t\t\tu,\n\t\ty:\n\t\t\t((a.x * a.x + a.y * a.y) * (b.x - c.x) +\n\t\t\t\t(b.x * b.x + b.y * b.y) * (c.x - a.x) +\n\t\t\t\t(c.x * c.x + c.y * c.y) * (a.x - b.x)) /\n\t\t\tu,\n\t}\n\n\tconst radius = Vec2d.Dist(center, a)\n\n\t// Whether to draw the arc clockwise or counter-clockwise (are the points clockwise?)\n\tconst sweepFlag = +Vec2d.Clockwise(a, c, b)\n\n\t// The base angle of the arc in radians\n\tconst ab = Math.hypot(a.y - b.y, a.x - b.x)\n\tconst bc = Math.hypot(b.y - c.y, b.x - c.x)\n\tconst ca = Math.hypot(c.y - a.y, c.x - a.x)\n\n\tconst theta = Math.acos((bc * bc + ca * ca - ab * ab) / (2 * bc * ca)) * 2\n\n\t// Whether to draw the long arc or short arc\n\tconst largeArcFlag = +(PI > theta)\n\n\t// The size of the arc to draw in radians\n\tconst size = (PI2 - theta) * (sweepFlag ? 1 : -1)\n\n\t// The length of the arc to draw in distance units\n\tconst length = size * radius\n\n\treturn {\n\t\tcenter,\n\t\tradius,\n\t\tsize,\n\t\tlength,\n\t\tlargeArcFlag,\n\t\tsweepFlag,\n\t}\n}\n","// Adapted (mostly copied) the work of https://github.com/fregante\n// Copyright (c) Federico Brigante <opensource@bfred.it> (bfred.it)\n\n// TODO: Most of this file can be moved into a DOM utils library.\n\n/** @public */\nexport type ReplacerCallback = (substring: string, ...args: unknown[]) => string\n\n/** @public */\nexport class TextHelpers {\n\tstatic insertTextFirefox(field: HTMLTextAreaElement | HTMLInputElement, text: string): void {\n\t\t// Found on https://www.everythingfrontend.com/blog/insert-text-into-textarea-at-cursor-position.html \n\t\tfield.setRangeText(\n\t\t\ttext,\n\t\t\tfield.selectionStart || 0,\n\t\t\tfield.selectionEnd || 0,\n\t\t\t'end' // Without this, the cursor is either at the beginning or text remains selected\n\t\t)\n\n\t\tfield.dispatchEvent(\n\t\t\tnew InputEvent('input', {\n\t\t\t\tdata: text,\n\t\t\t\tinputType: 'insertText',\n\t\t\t\tisComposing: false, // TODO: fix @types/jsdom, this shouldn't be required\n\t\t\t})\n\t\t)\n\t}\n\n\t/**\n\t * Inserts text at the cursors position, replacing any selection, with **undo** support and by\n\t * firing the input event.\n\t */\n\tstatic insert(field: HTMLTextAreaElement | HTMLInputElement, text: string): void {\n\t\tconst document = field.ownerDocument\n\t\tconst initialFocus = document.activeElement\n\t\tif (initialFocus !== field) {\n\t\t\tfield.focus()\n\t\t}\n\n\t\tif (!document.execCommand('insertText', false, text)) {\n\t\t\tTextHelpers.insertTextFirefox(field, text)\n\t\t}\n\n\t\tif (initialFocus === document.body) {\n\t\t\tfield.blur()\n\t\t} else if (initialFocus instanceof HTMLElement && initialFocus !== field) {\n\t\t\tinitialFocus.focus()\n\t\t}\n\t}\n\n\t/**\n\t * Replaces the entire content, equivalent to field.value = text but with **undo** support and by\n\t * firing the input event.\n\t */\n\tstatic set(field: HTMLTextAreaElement | HTMLInputElement, text: string): void {\n\t\tfield.select()\n\t\tTextHelpers.insert(field, text)\n\t}\n\n\t/** Get the selected text in a field or an empty string if nothing is selected. */\n\tstatic getSelection(field: HTMLTextAreaElement | HTMLInputElement): string {\n\t\tconst { selectionStart, selectionEnd } = field\n\t\treturn field.value.slice(\n\t\t\tselectionStart ? selectionStart : undefined,\n\t\t\tselectionEnd ? selectionEnd : undefined\n\t\t)\n\t}\n\n\t/**\n\t * Adds the wrappingText before and after fields selection (or cursor). If endWrappingText is\n\t * provided, it will be used instead of wrappingText at on the right.\n\t */\n\tstatic wrapSelection(\n\t\tfield: HTMLTextAreaElement | HTMLInputElement,\n\t\twrap: string,\n\t\twrapEnd?: string\n\t): void {\n\t\tconst { selectionStart, selectionEnd } = field\n\t\tconst selection = TextHelpers.getSelection(field)\n\t\tTextHelpers.insert(field, wrap + selection + (wrapEnd ?? wrap))\n\n\t\t// Restore the selection around the previously-selected text\n\t\tfield.selectionStart = (selectionStart || 0) + wrap.length\n\t\tfield.selectionEnd = (selectionEnd || 0) + wrap.length\n\t}\n\n\t/** Finds and replaces strings and regex in the fields value. */\n\tstatic replace(\n\t\tfield: HTMLTextAreaElement | HTMLInputElement,\n\t\tsearchValue: string | RegExp,\n\t\treplacer: string | ReplacerCallback\n\t): void {\n\t\t/** Remembers how much each match offset should be adjusted */\n\t\tlet drift = 0\n\t\tfield.value.replace(searchValue, (...args): string => {\n\t\t\t// Select current match to replace it later\n\t\t\tconst matchStart = drift + (args[args.length - 2] as number)\n\t\t\tconst matchLength = args[0].length\n\t\t\tfield.selectionStart = matchStart\n\t\t\tfield.selectionEnd = matchStart + matchLength\n\t\t\tconst replacement = typeof replacer === 'string' ? replacer : replacer(...args)\n\t\t\tTextHelpers.insert(field, replacement)\n\t\t\t// Select replacement. Without this, the cursor would be after the replacement\n\t\t\tfield.selectionStart = matchStart\n\t\t\tdrift += replacement.length - matchLength\n\t\t\treturn replacement\n\t\t})\n\t}\n\n\tstatic findLineEnd(value: string, currentEnd: number): number {\n\t\t// Go to the beginning of the last line\n\t\tconst lastLineStart = value.lastIndexOf('\\n', currentEnd - 1) + 1\n\t\t// There's nothing to unindent after the last cursor, so leave it as is\n\t\tif (value.charAt(lastLineStart) !== '\\t') {\n\t\t\treturn currentEnd\n\t\t}\n\t\treturn lastLineStart + 1 // Include the first character, which will be a tab\n\t}\n\n\tstatic indent(element: HTMLTextAreaElement): void {\n\t\tconst { selectionStart, selectionEnd, value } = element\n\t\tconst selectedContrast = value.slice(selectionStart, selectionEnd)\n\t\t// The first line should be indented, even if it starts with \\n\n\t\t// The last line should only be indented if includes any character after \\n\n\t\tconst lineBreakCount = /\\n/g.exec(selectedContrast)?.length\n\n\t\tif (lineBreakCount && lineBreakCount > 0) {\n\t\t\t// Select full first line to replace everything at once\n\t\t\tconst firstLineStart = value.lastIndexOf('\\n', selectionStart - 1) + 1\n\n\t\t\tconst newSelection = element.value.slice(firstLineStart, selectionEnd - 1)\n\t\t\tconst indentedText = newSelection.replace(\n\t\t\t\t/^|\\n/g, // Match all line starts\n\t\t\t\t`$&${TextHelpers.INDENT}`\n\t\t\t)\n\t\t\tconst replacementsCount = indentedText.length - newSelection.length\n\n\t\t\t// Replace newSelection with indentedText\n\t\t\telement.setSelectionRange(firstLineStart, selectionEnd - 1)\n\t\t\tTextHelpers.insert(element, indentedText)\n\n\t\t\t// Restore selection position, including the indentation\n\t\t\telement.setSelectionRange(selectionStart + 1, selectionEnd + replacementsCount)\n\t\t} else {\n\t\t\tTextHelpers.insert(element, TextHelpers.INDENT)\n\t\t}\n\t}\n\n\t// The first line should always be unindented\n\t// The last line should only be unindented if the selection includes any characters after \\n\n\tstatic unindent(element: HTMLTextAreaElement): void {\n\t\tconst { selectionStart, selectionEnd, value } = element\n\n\t\t// Select the whole first line because it might contain \\t\n\t\tconst firstLineStart = value.lastIndexOf('\\n', selectionStart - 1) + 1\n\t\tconst minimumSelectionEnd = TextHelpers.findLineEnd(value, selectionEnd)\n\n\t\tconst newSelection = element.value.slice(firstLineStart, minimumSelectionEnd)\n\t\tconst indentedText = newSelection.replace(/(^|\\n)(\\t| {1,2})/g, '$1')\n\t\tconst replacementsCount = newSelection.length - indentedText.length\n\n\t\t// Replace newSelection with indentedText\n\t\telement.setSelectionRange(firstLineStart, minimumSelectionEnd)\n\t\tTextHelpers.insert(element, indentedText)\n\n\t\t// Restore selection position, including the indentation\n\t\tconst firstLineIndentation = /\\t| {1,2}/.exec(value.slice(firstLineStart, selectionStart))\n\n\t\tconst difference = firstLineIndentation ? firstLineIndentation[0].length : 0\n\n\t\tconst newSelectionStart = selectionStart - difference\n\t\telement.setSelectionRange(\n\t\t\tselectionStart - difference,\n\t\t\tMath.max(newSelectionStart, selectionEnd - replacementsCount)\n\t\t)\n\t}\n\n\tstatic indentCE(element: HTMLElement): void {\n\t\tconst selection = window.getSelection()\n\t\tconst value = element.innerText\n\t\tconst selectionStart = getCaretIndex(element) ?? 0\n\t\tconst selectionEnd = getCaretIndex(element) ?? 0\n\t\tconst selectedContrast = value.slice(selectionStart, selectionEnd)\n\t\t// The first line should be indented, even if it starts with \\n\n\t\t// The last line should only be indented if includes any character after \\n\n\t\tconst lineBreakCount = /\\n/g.exec(selectedContrast)?.length\n\n\t\tif (lineBreakCount && lineBreakCount > 0) {\n\t\t\t// Select full first line to replace everything at once\n\t\t\tconst firstLineStart = value.lastIndexOf('\\n', selectionStart - 1) + 1\n\n\t\t\tconst newSelection = value.slice(firstLineStart, selectionEnd - 1)\n\t\t\tconst indentedText = newSelection.replace(\n\t\t\t\t/^|\\n/g, // Match all line starts\n\t\t\t\t`$&${TextHelpers.INDENT}`\n\t\t\t)\n\t\t\tconst replacementsCount = indentedText.length - newSelection.length\n\n\t\t\t// Replace newSelection with indentedText\n\n\t\t\tif (selection) {\n\t\t\t\tselection.setBaseAndExtent(\n\t\t\t\t\telement,\n\t\t\t\t\tselectionStart + 1,\n\t\t\t\t\telement,\n\t\t\t\t\tselectionEnd + replacementsCount\n\t\t\t\t)\n\t\t\t\t// element.setSelectionRange(firstLineStart, selectionEnd - 1)\n\t\t\t\t// TextHelpers.insert(element, indentedText)\n\n\t\t\t\t// Restore selection position, including the indentation\n\t\t\t\t// element.setSelectionRange(selectionStart + 1, selectionEnd + replacementsCount)\n\t\t\t}\n\t\t} else {\n\t\t\tconst selection = window.getSelection()\n\t\t\telement.innerText =\n\t\t\t\tvalue.slice(0, selectionStart) + TextHelpers.INDENT + value.slice(selectionStart)\n\t\t\tselection?.setBaseAndExtent(element, selectionStart + 1, element, selectionStart + 2)\n\t\t\t// TextHelpers.insert(element, TextHelpers.INDENT)\n\t\t}\n\t}\n\n\tstatic unindentCE(element: HTMLElement): void {\n\t\tconst selection = window.getSelection()\n\t\tconst value = element.innerText\n\t\t// const { selectionStart, selectionEnd } = element\n\t\tconst selectionStart = getCaretIndex(element) ?? 0\n\t\tconst selectionEnd = getCaretIndex(element) ?? 0\n\n\t\t// Select the whole first line because it might contain \\t\n\t\tconst firstLineStart = value.lastIndexOf('\\n', selectionStart - 1) + 1\n\t\tconst minimumSelectionEnd = TextHelpers.findLineEnd(value, selectionEnd)\n\n\t\tconst newSelection = value.slice(firstLineStart, minimumSelectionEnd)\n\t\tconst indentedText = newSelection.replace(/(^|\\n)(\\t| {1,2})/g, '$1')\n\t\tconst replacementsCount = newSelection.length - indentedText.length\n\n\t\tif (selection) {\n\t\t\t// Replace newSelection with indentedText\n\t\t\tselection.setBaseAndExtent(element, firstLineStart, element, minimumSelectionEnd)\n\t\t\t// TextHelpers.insert(element, indentedText)\n\n\t\t\t// Restore selection position, including the indentation\n\t\t\tconst firstLineIndentation = /\\t| {1,2}/.exec(value.slice(firstLineStart, selectionStart))\n\n\t\t\tconst difference = firstLineIndentation ? firstLineIndentation[0].length : 0\n\n\t\t\tconst newSelectionStart = selectionStart - difference\n\t\t\tselection.setBaseAndExtent(\n\t\t\t\telement,\n\t\t\t\tselectionStart - difference,\n\t\t\t\telement,\n\t\t\t\tMath.max(newSelectionStart, selectionEnd - replacementsCount)\n\t\t\t)\n\t\t}\n\t}\n\n\tstatic fixNewLines = /\\r?\\n|\\r/g\n\n\tstatic INDENT = '  '\n\n\tstatic normalizeText(text: string) {\n\t\treturn text.replace(TextHelpers.fixNewLines, '\\n')\n\t}\n\n\tstatic normalizeTextForDom(text: string) {\n\t\treturn text\n\t\t\t.replace(TextHelpers.fixNewLines, '\\n')\n\t\t\t.split('\\n')\n\t\t\t.map((x) => x || ' ')\n\t\t\t.join('\\n')\n\t}\n}\n\nfunction getCaretIndex(element: HTMLElement) {\n\tif (typeof window.getSelection === 'undefined') return\n\tconst selection = window.getSelection()\n\tif (!selection) return\n\tlet position = 0\n\tif (selection.rangeCount !== 0) {\n\t\tconst range = selection.getRangeAt(0)\n\t\tconst preCaretRange = range.cloneRange()\n\t\tpreCaretRange.selectNodeContents(element)\n\t\tpreCaretRange.setEnd(range.endContainer, range.endOffset)\n\t\tposition = preCaretRange.toString().length\n\t}\n\treturn position\n}\n","/* eslint-disable no-inner-declarations */\nimport { TLShape } from '@tldraw/tlschema'\nimport React, { useCallback, useEffect, useRef } from 'react'\nimport { useValue } from 'signia-react'\nimport { stopEventPropagation } from '.'\nimport { useApp } from '../../../hooks'\nimport { preventDefault } from '../../../utils'\nimport { TextHelpers } from '../TLTextUtil/TextHelpers'\n\nexport function useEditableText<T extends Extract<TLShape, { props: { text: string } }>>(\n\tid: T['id'],\n\ttype: T['type'],\n\ttext: string\n) {\n\tconst app = useApp()\n\n\tconst rInput = useRef<HTMLTextAreaElement>(null)\n\n\tconst isEditing = useValue('isEditing', () => app.pageState.editingId === id, [app, id])\n\n\tconst rSkipSelectOnFocus = useRef(false)\n\tconst rSelectionRanges = useRef<Range[] | null>()\n\n\tconst isEditableFromHover = useValue(\n\t\t'is editable hovering',\n\t\t() => {\n\t\t\tif (type === 'text' && app.isIn('text') && app.hoveredId === id) {\n\t\t\t\treturn true\n\t\t\t}\n\n\t\t\tif (app.isIn('select.editing_shape')) {\n\t\t\t\tconst { editingShape } = app\n\t\t\t\tif (!editingShape) return false\n\t\t\t\treturn (\n\t\t\t\t\t// The shape must be hovered\n\t\t\t\t\tapp.hoveredId === id &&\n\t\t\t\t\t// the editing shape must be the same type as this shape\n\t\t\t\t\teditingShape.type === type &&\n\t\t\t\t\t// and this shape must be capable of being editing in its current form\n\t\t\t\t\tapp.getShapeUtil(editingShape).canEdit(editingShape)\n\t\t\t\t)\n\t\t\t}\n\n\t\t\treturn false\n\t\t},\n\t\t[type, id]\n\t)\n\n\t// When the label receives focus, set the value to the most\n\t// recent text value and select all of the text\n\tconst handleFocus = useCallback(() => {\n\t\tif (isEditableFromHover) return\n\n\t\trequestAnimationFrame(() => {\n\t\t\tconst elm = rInput.current\n\n\t\t\tif (!elm) return\n\n\t\t\tconst shape = app.getShapeById<TLShape & { props: { text: string } }>(id)\n\t\t\tif (shape) {\n\t\t\t\telm.value = shape.props.text\n\t\t\t\tif (elm.value.length && !rSkipSelectOnFocus.current) {\n\t\t\t\t\telm.select()\n\t\t\t\t}\n\n\t\t\t\trSkipSelectOnFocus.current = false\n\t\t\t}\n\t\t})\n\t}, [app, id, isEditableFromHover])\n\n\t// When the label blurs, deselect all of the text and complete.\n\t// This makes it so that the canvas does not have to be focused\n\t// in order to exit the editing state and complete the editing state\n\tconst handleBlur = useCallback(() => {\n\t\tconst ranges = rSelectionRanges.current\n\n\t\trequestAnimationFrame(() => {\n\t\t\tconst elm = rInput.current\n\t\t\tif (app.isIn('select.editing_shape') && elm) {\n\t\t\t\tif (ranges) {\n\t\t\t\t\tif (!ranges.length) {\n\t\t\t\t\t\t// If we don't have any ranges, restore selection\n\t\t\t\t\t\t// and select all of the text\n\t\t\t\t\t\telm.focus()\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Otherwise, skip the select-all-on-focus behavior\n\t\t\t\t\t\t// and restore the selection\n\t\t\t\t\t\trSkipSelectOnFocus.current = true\n\t\t\t\t\t\telm.focus()\n\t\t\t\t\t\tconst selection = window.getSelection()\n\t\t\t\t\t\tif (selection) {\n\t\t\t\t\t\t\tranges.forEach((range) => selection.addRange(range))\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\telm.focus()\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\twindow.getSelection()?.removeAllRanges()\n\t\t\t\tapp.complete()\n\t\t\t}\n\t\t})\n\t}, [app])\n\n\t// When the user presses ctrl / meta enter, complete the editing state.\n\t// When the user presses tab, indent or unindent the text.\n\tconst handleKeyDown = useCallback(\n\t\t(e: React.KeyboardEvent<HTMLTextAreaElement>) => {\n\t\t\tif (e.ctrlKey || e.metaKey) stopEventPropagation(e)\n\n\t\t\tswitch (e.key) {\n\t\t\t\tcase 'Enter': {\n\t\t\t\t\tif (e.ctrlKey || e.metaKey) {\n\t\t\t\t\t\tapp.complete()\n\t\t\t\t\t}\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t\tcase 'Tab': {\n\t\t\t\t\tpreventDefault(e)\n\t\t\t\t\tif (e.shiftKey) {\n\t\t\t\t\t\tTextHelpers.unindent(e.currentTarget)\n\t\t\t\t\t} else {\n\t\t\t\t\t\tTextHelpers.indent(e.currentTarget)\n\t\t\t\t\t}\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t[app]\n\t)\n\n\t// When the text changes, update the text value.\n\tconst handleChange = useCallback(\n\t\t(e: React.ChangeEvent<HTMLTextAreaElement>) => {\n\t\t\tconst text = TextHelpers.normalizeText(e.currentTarget.value)\n\t\t\tapp.updateShapes([{ id, type, props: { text } }])\n\t\t},\n\t\t[app, id, type]\n\t)\n\n\tconst isEmpty = text.trim().length === 0\n\n\tuseEffect(() => {\n\t\tconst elm = rInput.current\n\t\tif (elm) {\n\t\t\tfunction updateSelection() {\n\t\t\t\tconst selection = window.getSelection?.()\n\t\t\t\tif (selection && selection.type !== 'None') {\n\t\t\t\t\tconst ranges: Range[] = []\n\n\t\t\t\t\tif (selection) {\n\t\t\t\t\t\tfor (let i = 0; i < selection.rangeCount; i++) {\n\t\t\t\t\t\t\tranges.push(selection.getRangeAt?.(i))\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\trSelectionRanges.current = ranges\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tdocument.addEventListener('selectionchange', updateSelection)\n\n\t\t\treturn () => {\n\t\t\t\tdocument.removeEventListener('selectionchange', updateSelection)\n\t\t\t}\n\t\t}\n\t})\n\n\treturn {\n\t\trInput,\n\t\tisEditing,\n\t\tisEditableFromHover,\n\t\thandleFocus,\n\t\thandleBlur,\n\t\thandleKeyDown,\n\t\thandleChange,\n\t\tisEmpty,\n\t}\n}\n","import { VecLike } from '@tldraw/primitives'\nimport { TLArrowShape, TLShapeId } from '@tldraw/tlschema'\nimport * as React from 'react'\nimport { ARROW_LABEL_FONT_SIZES, TEXT_PROPS } from '../../../../constants'\nimport { TextHelpers } from '../../TLTextUtil/TextHelpers'\nimport { stopEventPropagation } from '../../shared'\nimport { useEditableText } from '../../shared/useEditableText'\n\nexport const ArrowTextLabel = React.memo(function ArrowTextLabel({\n\tid,\n\ttext,\n\tsize,\n\tfont,\n\tposition,\n\twidth,\n\tlabelColor,\n}: { id: TLShapeId; position: VecLike; width?: number; labelColor: string } & Pick<\n\tTLArrowShape['props'],\n\t'text' | 'size' | 'font'\n>) {\n\tconst { rInput, isEditing, handleFocus, handleBlur, handleKeyDown, handleChange, isEmpty } =\n\t\tuseEditableText(id, 'arrow', text)\n\n\tif (!isEditing && isEmpty) {\n\t\treturn null\n\t}\n\n\treturn (\n\t\t<div\n\t\t\tclassName=\"rs-arrow-label\"\n\t\t\tdata-font={font}\n\t\t\tdata-align={'center'}\n\t\t\tdata-hastext={!isEmpty}\n\t\t\tdata-isediting={isEditing}\n\t\t\tstyle={{\n\t\t\t\ttextAlign: 'center',\n\t\t\t\tfontSize: ARROW_LABEL_FONT_SIZES[size],\n\t\t\t\tlineHeight: ARROW_LABEL_FONT_SIZES[size] * TEXT_PROPS.lineHeight + 'px',\n\t\t\t\ttransform: `translate(${position.x}px, ${position.y}px)`,\n\t\t\t\tcolor: labelColor,\n\t\t\t}}\n\t\t>\n\t\t\t<div className=\"rs-arrow-label__inner\">\n\t\t\t\t<p style={{ width: width ? width : '9px' }}>\n\t\t\t\t\t{text ? TextHelpers.normalizeTextForDom(text) : ' '}\n\t\t\t\t</p>\n\t\t\t\t{isEditing && (\n\t\t\t\t\t// Consider replacing with content-editable\n\t\t\t\t\t<textarea\n\t\t\t\t\t\tref={rInput}\n\t\t\t\t\t\tclassName=\"rs-text rs-text-input\"\n\t\t\t\t\t\tname=\"text\"\n\t\t\t\t\t\ttabIndex={-1}\n\t\t\t\t\t\tautoComplete=\"false\"\n\t\t\t\t\t\tautoCapitalize=\"false\"\n\t\t\t\t\t\tautoCorrect=\"false\"\n\t\t\t\t\t\tautoSave=\"false\"\n\t\t\t\t\t\tautoFocus\n\t\t\t\t\t\tplaceholder=\"\"\n\t\t\t\t\t\tspellCheck=\"true\"\n\t\t\t\t\t\twrap=\"off\"\n\t\t\t\t\t\tdir=\"auto\"\n\t\t\t\t\t\tdatatype=\"wysiwyg\"\n\t\t\t\t\t\tdefaultValue={text}\n\t\t\t\t\t\tonFocus={handleFocus}\n\t\t\t\t\t\tonChange={handleChange}\n\t\t\t\t\t\tonKeyDown={handleKeyDown}\n\t\t\t\t\t\tonBlur={handleBlur}\n\t\t\t\t\t\tonContextMenu={stopEventPropagation}\n\t\t\t\t\t/>\n\t\t\t\t)}\n\t\t\t</div>\n\t\t</div>\n\t)\n})\n","import {\n\tBox2d,\n\tgetPointOnCircle,\n\tlinesIntersect,\n\tlongAngleDist,\n\tMatrix2d,\n\tshortAngleDist,\n\ttoDomPrecision,\n\tVec2d,\n\tVecLike,\n} from '@tldraw/primitives'\nimport {\n\tarrowShapeMigrations,\n\tarrowShapeTypeValidator,\n\tTLArrowheadType,\n\tTLArrowShape,\n\tTLColorType,\n\tTLFillType,\n\tTLHandle,\n\tTLShapeId,\n\tTLShapePartial,\n\tVec2dModel,\n} from '@tldraw/tlschema'\nimport { ComputedCache } from '@tldraw/tlstore'\nimport { deepCopy, last, minBy } from '@tldraw/utils'\nimport * as React from 'react'\nimport { computed, EMPTY_ARRAY } from 'signia'\nimport { SVGContainer } from '../../../components/SVGContainer'\nimport { defineShape } from '../../../config/TLShapeDefinition'\nimport { ARROW_LABEL_FONT_SIZES, FONT_FAMILIES, TEXT_PROPS } from '../../../constants'\nimport { getPerfectDashProps, getShapeFillSvg, ShapeFill, TLExportColors } from '../shared'\nimport { getTextSvgElement } from '../shared/getTextSvgElement'\nimport {\n\tOnEditEndHandler,\n\tOnHandleChangeHandler,\n\tOnResizeHandler,\n\tOnTranslateStartHandler,\n\tTLShapeUtil,\n\tTLShapeUtilFlag,\n} from '../TLShapeUtil'\nimport { ArrowInfo } from './arrow/arrow-types'\nimport { getArrowheadPathForType } from './arrow/arrowheads'\nimport {\n\tgetCurvedArrowHandlePath,\n\tgetCurvedArrowInfo,\n\tgetSolidCurvedArrowPath,\n} from './arrow/curved-arrow'\nimport { getArrowTerminalsInArrowSpace, getIsArrowStraight } from './arrow/shared'\nimport {\n\tgetSolidStraightArrowPath,\n\tgetStraightArrowHandlePath,\n\tgetStraightArrowInfo,\n} from './arrow/straight-arrow'\nimport { ArrowTextLabel } from './components/ArrowTextLabel'\n\nlet globalRenderIndex = 0\n\n/** @public */\nexport class TLArrowUtil extends TLShapeUtil<TLArrowShape> {\n\tstatic type = 'arrow'\n\n\toverride canEdit = () => true\n\toverride canBind = () => false\n\toverride isClosed = () => false\n\toverride hideResizeHandles: TLShapeUtilFlag<TLArrowShape> = () => true\n\toverride hideRotateHandle: TLShapeUtilFlag<TLArrowShape> = () => true\n\toverride hideSelectionBoundsFg: TLShapeUtilFlag<TLArrowShape> = () => true\n\toverride hideSelectionBoundsBg: TLShapeUtilFlag<TLArrowShape> = () => true\n\n\toverride defaultProps(): TLArrowShape['props'] {\n\t\treturn {\n\t\t\topacity: '1',\n\t\t\tdash: 'draw',\n\t\t\tsize: 'm',\n\t\t\tfill: 'none',\n\t\t\tcolor: 'black',\n\t\t\tlabelColor: 'black',\n\t\t\tbend: 0,\n\t\t\tstart: { type: 'point', x: 0, y: 0 },\n\t\t\tend: { type: 'point', x: 0, y: 0 },\n\t\t\tarrowheadStart: 'none',\n\t\t\tarrowheadEnd: 'arrow',\n\t\t\ttext: '',\n\t\t\tfont: 'draw',\n\t\t}\n\t}\n\n\tgetCenter(shape: TLArrowShape): Vec2d {\n\t\treturn this.bounds(shape).center\n\t}\n\n\tgetBounds(shape: TLArrowShape) {\n\t\treturn Box2d.FromPoints(this.getOutlineWithoutLabel(shape))\n\t}\n\n\tgetOutlineWithoutLabel(shape: TLArrowShape) {\n\t\tconst info = this.getArrowInfo(shape)\n\n\t\tif (!info) {\n\t\t\treturn []\n\t\t}\n\n\t\tif (info.isStraight) {\n\t\t\tif (info.isValid) {\n\t\t\t\treturn [info.start.point, info.end.point]\n\t\t\t} else {\n\t\t\t\treturn [new Vec2d(0, 0), new Vec2d(1, 1)]\n\t\t\t}\n\t\t}\n\n\t\tif (!info.isValid) {\n\t\t\treturn [new Vec2d(0, 0), new Vec2d(1, 1)]\n\t\t}\n\n\t\tconst pointsToPush = Math.max(5, Math.ceil(Math.abs(info.bodyArc.length) / 16))\n\n\t\tif (pointsToPush <= 0 && !isFinite(pointsToPush)) {\n\t\t\treturn [new Vec2d(0, 0), new Vec2d(1, 1)]\n\t\t}\n\n\t\tconst results: Vec2d[] = Array(pointsToPush)\n\n\t\tconst startAngle = Vec2d.Angle(info.bodyArc.center, info.start.point)\n\t\tconst endAngle = Vec2d.Angle(info.bodyArc.center, info.end.point)\n\n\t\tconst a = info.bodyArc.sweepFlag ? endAngle : startAngle\n\t\tconst b = info.bodyArc.sweepFlag ? startAngle : endAngle\n\t\tconst l = info.bodyArc.largeArcFlag ? -longAngleDist(a, b) : shortAngleDist(a, b)\n\n\t\tconst r = Math.max(1, info.bodyArc.radius)\n\n\t\tfor (let i = 0; i < pointsToPush; i++) {\n\t\t\tconst t = i / (pointsToPush - 1)\n\t\t\tconst angle = a + l * t\n\t\t\tconst point = getPointOnCircle(info.bodyArc.center.x, info.bodyArc.center.y, r, angle)\n\t\t\tresults[i] = point\n\t\t}\n\n\t\treturn results\n\t}\n\n\tgetOutline(shape: TLArrowShape): Vec2dModel[] {\n\t\tconst outlineWithoutLabel = this.getOutlineWithoutLabel(shape)\n\n\t\tconst labelBounds = this.getLabelBounds(shape)\n\t\tif (!labelBounds) {\n\t\t\treturn outlineWithoutLabel\n\t\t}\n\n\t\tconst sides = labelBounds.sides\n\t\tconst sideIndexes = [0, 1, 2, 3]\n\n\t\t// start with the first point...\n\t\tlet prevPoint = outlineWithoutLabel[0]\n\t\tlet didAddLabel = false\n\t\tconst result = [prevPoint]\n\t\tfor (let i = 1; i < outlineWithoutLabel.length; i++) {\n\t\t\t// ...and use the next point to form a line segment for the outline.\n\t\t\tconst nextPoint = outlineWithoutLabel[i]\n\n\t\t\tif (!didAddLabel) {\n\t\t\t\t// find the index of the side of the label bounds that intersects the line segment\n\t\t\t\tconst nearestIntersectingSideIndex = minBy(\n\t\t\t\t\tsideIndexes.filter((sideIndex) =>\n\t\t\t\t\t\tlinesIntersect(sides[sideIndex][0], sides[sideIndex][1], prevPoint, nextPoint)\n\t\t\t\t\t),\n\t\t\t\t\t(sideIndex) =>\n\t\t\t\t\t\tVec2d.DistanceToLineSegment(sides[sideIndex][0], sides[sideIndex][1], prevPoint)\n\t\t\t\t)\n\n\t\t\t\t// if we've found one, start at that index and trace around all four corners of the label bounds\n\t\t\t\tif (nearestIntersectingSideIndex !== undefined) {\n\t\t\t\t\tconst intersectingPoint = Vec2d.NearestPointOnLineSegment(\n\t\t\t\t\t\tsides[nearestIntersectingSideIndex][0],\n\t\t\t\t\t\tsides[nearestIntersectingSideIndex][1],\n\t\t\t\t\t\tprevPoint\n\t\t\t\t\t)\n\n\t\t\t\t\tresult.push(intersectingPoint)\n\t\t\t\t\tfor (let j = 0; j < 4; j++) {\n\t\t\t\t\t\tconst sideIndex = (nearestIntersectingSideIndex + j) % 4\n\t\t\t\t\t\tresult.push(sides[sideIndex][1])\n\t\t\t\t\t}\n\t\t\t\t\tresult.push(intersectingPoint)\n\n\t\t\t\t\t// we've added the label, so we can just continue with the rest of the outline as normal\n\t\t\t\t\tdidAddLabel = true\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tresult.push(nextPoint)\n\t\t\tprevPoint = nextPoint\n\t\t}\n\n\t\treturn result\n\t}\n\n\tsnapPoints(_shape: TLArrowShape): Vec2d[] {\n\t\treturn EMPTY_ARRAY\n\t}\n\n\t@computed\n\tprivate get infoCache() {\n\t\treturn this.app.store.createComputedCache<ArrowInfo, TLArrowShape>(\n\t\t\t'arrow infoCache',\n\t\t\t(shape) => {\n\t\t\t\treturn getIsArrowStraight(shape)\n\t\t\t\t\t? getStraightArrowInfo(this.app, shape)\n\t\t\t\t\t: getCurvedArrowInfo(this.app, shape)\n\t\t\t}\n\t\t)\n\t}\n\n\tgetArrowInfo(shape: TLArrowShape) {\n\t\treturn this.infoCache.get(shape.id)\n\t}\n\n\tgetHandles(shape: TLArrowShape): TLHandle[] {\n\t\tconst info = this.infoCache.get(shape.id)!\n\t\treturn [\n\t\t\t{\n\t\t\t\tid: 'start',\n\t\t\t\ttype: 'vertex',\n\t\t\t\tindex: 'a0',\n\t\t\t\tx: info.start.handle.x,\n\t\t\t\ty: info.start.handle.y,\n\t\t\t\tcanBind: true,\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'middle',\n\t\t\t\ttype: 'vertex',\n\t\t\t\tindex: 'a2',\n\t\t\t\tx: info.middle.x,\n\t\t\t\ty: info.middle.y,\n\t\t\t\tcanBind: false,\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'end',\n\t\t\t\ttype: 'vertex',\n\t\t\t\tindex: 'a3',\n\t\t\t\tx: info.end.handle.x,\n\t\t\t\ty: info.end.handle.y,\n\t\t\t\tcanBind: true,\n\t\t\t},\n\t\t]\n\t}\n\n\tonHandleChange: OnHandleChangeHandler<TLArrowShape> = (shape, { handle, isPrecise }) => {\n\t\tconst next = deepCopy(shape)\n\n\t\tswitch (handle.id) {\n\t\t\tcase 'start':\n\t\t\tcase 'end': {\n\t\t\t\tconst pageTransform = this.app.getPageTransformById(next.id)!\n\t\t\t\tconst pointInPageSpace = Matrix2d.applyToPoint(pageTransform, handle)\n\n\t\t\t\tconst target = this.app.inputs.ctrlKey\n\t\t\t\t\t? undefined\n\t\t\t\t\t: last(\n\t\t\t\t\t\t\tthis.app.getShapesAtPoint(pointInPageSpace).filter((hitShape) => {\n\t\t\t\t\t\t\t\tif (hitShape.id === shape.id) return\n\t\t\t\t\t\t\t\tconst util = this.app.getShapeUtil(hitShape)\n\n\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\tutil.canBind(next) &&\n\t\t\t\t\t\t\t\t\tutil.hitTestPoint(\n\t\t\t\t\t\t\t\t\t\thitShape,\n\t\t\t\t\t\t\t\t\t\tthis.app.getPointInShapeSpace(hitShape, pointInPageSpace)\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t})\n\t\t\t\t\t  )\n\n\t\t\t\tif (target) {\n\t\t\t\t\tconst targetBounds = this.app.getBounds(target)\n\t\t\t\t\tconst pointInTargetSpace = this.app.getPointInShapeSpace(target, pointInPageSpace)\n\n\t\t\t\t\tconst prevHandle = next.props[handle.id]\n\n\t\t\t\t\tconst startBindingId =\n\t\t\t\t\t\tnext.props.start.type === 'binding' && next.props.start.boundShapeId\n\t\t\t\t\tconst endBindingId = next.props.end.type === 'binding' && next.props.end.boundShapeId\n\n\t\t\t\t\tlet precise =\n\t\t\t\t\t\t// If externally precise, then always precise\n\t\t\t\t\t\tisPrecise ||\n\t\t\t\t\t\t// If the other handle is bound to the same shape, then precise\n\t\t\t\t\t\t((startBindingId || endBindingId) && startBindingId === endBindingId) ||\n\t\t\t\t\t\t// If the other shape is not closed, then precise\n\t\t\t\t\t\t!this.app.getShapeUtil(target).isClosed(next)\n\n\t\t\t\t\tif (\n\t\t\t\t\t\t// If we're switching to a new bound shape, then precise only if moving slowly\n\t\t\t\t\t\tprevHandle.type === 'point' ||\n\t\t\t\t\t\t(prevHandle.type === 'binding' && target.id !== prevHandle.boundShapeId)\n\t\t\t\t\t) {\n\t\t\t\t\t\tprecise = this.app.inputs.pointerVelocity.len() < 0.5\n\t\t\t\t\t}\n\n\t\t\t\t\tif (precise) {\n\t\t\t\t\t\t// Funky math but we want the snap distance to be 4 at the minimum and either\n\t\t\t\t\t\t// 16 or 15% of the smaller dimension of the target shape, whichever is smaller\n\t\t\t\t\t\tprecise =\n\t\t\t\t\t\t\tVec2d.Dist(pointInTargetSpace, targetBounds.center) >\n\t\t\t\t\t\t\tMath.max(4, Math.min(Math.min(targetBounds.width, targetBounds.height) * 0.15, 16)) /\n\t\t\t\t\t\t\t\tthis.app.zoomLevel\n\t\t\t\t\t}\n\n\t\t\t\t\tnext.props[handle.id] = {\n\t\t\t\t\t\ttype: 'binding',\n\t\t\t\t\t\tboundShapeId: target.id,\n\t\t\t\t\t\tnormalizedAnchor: precise\n\t\t\t\t\t\t\t? {\n\t\t\t\t\t\t\t\t\tx: (pointInTargetSpace.x - targetBounds.minX) / targetBounds.width,\n\t\t\t\t\t\t\t\t\ty: (pointInTargetSpace.y - targetBounds.minY) / targetBounds.height,\n\t\t\t\t\t\t\t  }\n\t\t\t\t\t\t\t: { x: 0.5, y: 0.5 },\n\t\t\t\t\t\tisExact: this.app.inputs.altKey,\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tnext.props[handle.id] = {\n\t\t\t\t\t\ttype: 'point',\n\t\t\t\t\t\tx: handle.x,\n\t\t\t\t\t\ty: handle.y,\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tbreak\n\t\t\t}\n\n\t\t\tcase 'middle': {\n\t\t\t\tconst { start, end } = getArrowTerminalsInArrowSpace(this.app, next)\n\n\t\t\t\tconst delta = Vec2d.Sub(end, start)\n\t\t\t\tconst v = Vec2d.Per(delta)\n\n\t\t\t\tconst med = Vec2d.Med(end, start)\n\t\t\t\tconst A = Vec2d.Sub(med, v)\n\t\t\t\tconst B = Vec2d.Add(med, v)\n\n\t\t\t\tconst point = Vec2d.NearestPointOnLineSegment(A, B, handle, false)\n\t\t\t\tlet bend = Vec2d.Dist(point, med)\n\t\t\t\tif (Vec2d.Clockwise(point, end, med)) bend *= -1\n\t\t\t\tnext.props.bend = bend\n\t\t\t\tbreak\n\t\t\t}\n\t\t}\n\n\t\treturn next\n\t}\n\n\tonTranslateStart: OnTranslateStartHandler<TLArrowShape> = (shape) => {\n\t\tlet startBinding: TLShapeId | null =\n\t\t\tshape.props.start.type === 'binding' ? shape.props.start.boundShapeId : null\n\t\tlet endBinding: TLShapeId | null =\n\t\t\tshape.props.end.type === 'binding' ? shape.props.end.boundShapeId : null\n\n\t\t// If at least one bound shape is in the selection, do nothing;\n\t\t// If no bound shapes are in the selection, unbind any bound shapes\n\n\t\tif (\n\t\t\t(startBinding && this.app.isWithinSelection(startBinding)) ||\n\t\t\t(endBinding && this.app.isWithinSelection(endBinding))\n\t\t) {\n\t\t\treturn\n\t\t}\n\n\t\tstartBinding = null\n\t\tendBinding = null\n\n\t\tconst { start, end } = getArrowTerminalsInArrowSpace(this.app, shape)\n\n\t\treturn {\n\t\t\tid: shape.id,\n\t\t\ttype: shape.type,\n\t\t\tprops: {\n\t\t\t\t...shape.props,\n\t\t\t\tstart: {\n\t\t\t\t\ttype: 'point',\n\t\t\t\t\tx: start.x,\n\t\t\t\t\ty: start.y,\n\t\t\t\t},\n\t\t\t\tend: {\n\t\t\t\t\ttype: 'point',\n\t\t\t\t\tx: end.x,\n\t\t\t\t\ty: end.y,\n\t\t\t\t},\n\t\t\t},\n\t\t}\n\t}\n\n\tonResize: OnResizeHandler<TLArrowShape> = (shape, info) => {\n\t\tconst { scaleX, scaleY } = info\n\n\t\tconst terminals = getArrowTerminalsInArrowSpace(this.app, shape)\n\n\t\tlet { start, end } = shape.props\n\n\t\t// Rescale start handle if it's not bound to a shape\n\t\tif (start.type === 'point') {\n\t\t\tconst sx = terminals.start.x * scaleX\n\t\t\tconst sy = terminals.start.y * scaleY\n\n\t\t\tstart = { ...start, x: sx, y: sy }\n\t\t}\n\n\t\t// Rescale end handle if it's not bound to a shape\n\t\tif (end.type === 'point') {\n\t\t\tconst ex = terminals.end.x * scaleX\n\t\t\tconst ey = terminals.end.y * scaleY\n\n\t\t\tend = { ...end, x: ex, y: ey }\n\t\t}\n\n\t\t// Rescale bend\n\n\t\t// this could still be improved, possibly by rescaling\n\t\t// the location of the middle handle; or else the point on\n\t\t// the line nearest to the moving edge of the bounding box,\n\t\t// so that the arrow is contained within its transformed\n\t\t// bounding box.\n\n\t\tlet bend = shape.props.bend\n\n\t\tif (bend !== 0) {\n\t\t\tconst mx = Math.abs(scaleX)\n\t\t\tconst my = Math.abs(scaleY)\n\n\t\t\tif (scaleX < 0 && scaleY >= 0) {\n\t\t\t\tbend *= -1\n\t\t\t\tbend *= Math.max(mx, my)\n\t\t\t} else if (scaleX >= 0 && scaleY < 0) {\n\t\t\t\tbend *= -1\n\t\t\t\tbend *= Math.max(mx, my)\n\t\t\t} else if (scaleX >= 0 && scaleY >= 0) {\n\t\t\t\tbend *= Math.max(mx, my)\n\t\t\t} else if (scaleX < 0 && scaleY < 0) {\n\t\t\t\tbend *= Math.max(mx, my)\n\t\t\t}\n\t\t}\n\n\t\tconst next = {\n\t\t\tprops: {\n\t\t\t\tstart,\n\t\t\t\tend,\n\t\t\t\tbend,\n\t\t\t},\n\t\t}\n\n\t\treturn next\n\t}\n\n\tonDoubleClickHandle = (\n\t\tshape: TLArrowShape,\n\t\thandle: TLHandle\n\t): TLShapePartial<TLArrowShape> | void => {\n\t\tswitch (handle.id) {\n\t\t\tcase 'start': {\n\t\t\t\treturn {\n\t\t\t\t\tid: shape.id,\n\t\t\t\t\ttype: shape.type,\n\t\t\t\t\tprops: {\n\t\t\t\t\t\t...shape.props,\n\t\t\t\t\t\tarrowheadStart: shape.props.arrowheadStart === 'none' ? 'arrow' : 'none',\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t}\n\t\t\tcase 'end': {\n\t\t\t\treturn {\n\t\t\t\t\tid: shape.id,\n\t\t\t\t\ttype: shape.type,\n\t\t\t\t\tprops: {\n\t\t\t\t\t\t...shape.props,\n\t\t\t\t\t\tarrowheadEnd: shape.props.arrowheadEnd === 'none' ? 'arrow' : 'none',\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\thitTestPoint(shape: TLArrowShape, point: VecLike): boolean {\n\t\tconst outline = this.outline(shape)\n\n\t\tfor (let i = 0; i < outline.length - 1; i++) {\n\t\t\tconst C = outline[i]\n\t\t\tconst D = outline[i + 1]\n\n\t\t\tif (Vec2d.DistanceToLineSegment(C, D, point) < 4) return true\n\t\t}\n\n\t\treturn false\n\t}\n\n\thitTestLineSegment(shape: TLArrowShape, A: VecLike, B: VecLike): boolean {\n\t\tconst outline = this.outline(shape)\n\n\t\tfor (let i = 0; i < outline.length - 1; i++) {\n\t\t\tconst C = outline[i]\n\t\t\tconst D = outline[i + 1]\n\t\t\tif (linesIntersect(A, B, C, D)) return true\n\t\t}\n\n\t\treturn false\n\t}\n\n\trender(shape: TLArrowShape) {\n\t\t// Not a class component, but eslint can't tell that :(\n\t\tconst onlySelectedShape = this.app.onlySelectedShape\n\t\tconst shouldDisplayHandles =\n\t\t\tthis.app.isInAny(\n\t\t\t\t'select.idle',\n\t\t\t\t'select.pointing_handle',\n\t\t\t\t'select.dragging_handle',\n\t\t\t\t'arrow.dragging'\n\t\t\t) && !this.app.isReadOnly\n\n\t\tconst info = this.getArrowInfo(shape)\n\t\tconst bounds = this.bounds(shape)\n\t\tconst labelSize = this.getLabelBounds(shape)\n\n\t\t// eslint-disable-next-line react-hooks/rules-of-hooks\n\t\tconst changeIndex = React.useMemo<number>(() => {\n\t\t\treturn this.app.isSafari ? (globalRenderIndex += 1) : 0\n\t\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t\t}, [shape])\n\n\t\tif (!info?.isValid) return null\n\n\t\tconst strokeWidth = this.app.getStrokeWidth(shape.props.size)\n\n\t\tconst as = info.start.arrowhead && getArrowheadPathForType(info, 'start', strokeWidth)\n\t\tconst ae = info.end.arrowhead && getArrowheadPathForType(info, 'end', strokeWidth)\n\n\t\tconst path = info.isStraight ? getSolidStraightArrowPath(info) : getSolidCurvedArrowPath(info)\n\n\t\tlet handlePath: null | JSX.Element = null\n\n\t\tif (onlySelectedShape === shape && shouldDisplayHandles) {\n\t\t\tconst sw = 2\n\t\t\tconst { strokeDasharray, strokeDashoffset } = getPerfectDashProps(\n\t\t\t\tinfo.isStraight\n\t\t\t\t\t? Vec2d.Dist(info.start.handle, info.end.handle)\n\t\t\t\t\t: Math.abs(info.handleArc.length),\n\t\t\t\tsw,\n\t\t\t\t{\n\t\t\t\t\tend: 'skip',\n\t\t\t\t\tstart: 'skip',\n\t\t\t\t\tlengthRatio: 2.5,\n\t\t\t\t}\n\t\t\t)\n\n\t\t\thandlePath =\n\t\t\t\tshape.props.start.type === 'binding' || shape.props.end.type === 'binding' ? (\n\t\t\t\t\t<path\n\t\t\t\t\t\tclassName=\"rs-arrow-hint\"\n\t\t\t\t\t\td={info.isStraight ? getStraightArrowHandlePath(info) : getCurvedArrowHandlePath(info)}\n\t\t\t\t\t\tstrokeDasharray={strokeDasharray}\n\t\t\t\t\t\tstrokeDashoffset={strokeDashoffset}\n\t\t\t\t\t\tstrokeWidth={sw}\n\t\t\t\t\t\tmarkerStart={\n\t\t\t\t\t\t\tshape.props.start.type === 'binding'\n\t\t\t\t\t\t\t\t? shape.props.start.isExact\n\t\t\t\t\t\t\t\t\t? ''\n\t\t\t\t\t\t\t\t\t: isPrecise(shape.props.start.normalizedAnchor)\n\t\t\t\t\t\t\t\t\t? 'url(#arrowhead-cross)'\n\t\t\t\t\t\t\t\t\t: 'url(#arrowhead-dot)'\n\t\t\t\t\t\t\t\t: ''\n\t\t\t\t\t\t}\n\t\t\t\t\t\tmarkerEnd={\n\t\t\t\t\t\t\tshape.props.end.type === 'binding'\n\t\t\t\t\t\t\t\t? shape.props.end.isExact\n\t\t\t\t\t\t\t\t\t? ''\n\t\t\t\t\t\t\t\t\t: isPrecise(shape.props.end.normalizedAnchor)\n\t\t\t\t\t\t\t\t\t? 'url(#arrowhead-cross)'\n\t\t\t\t\t\t\t\t\t: 'url(#arrowhead-dot)'\n\t\t\t\t\t\t\t\t: ''\n\t\t\t\t\t\t}\n\t\t\t\t\t\topacity={0.16}\n\t\t\t\t\t/>\n\t\t\t\t) : null\n\t\t}\n\n\t\tconst { strokeDasharray, strokeDashoffset } = getPerfectDashProps(\n\t\t\tinfo.isStraight ? info.length : Math.abs(info.bodyArc.length),\n\t\t\tstrokeWidth,\n\t\t\t{\n\t\t\t\tstyle: shape.props.dash,\n\t\t\t}\n\t\t)\n\n\t\tconst maskStartArrowhead = !(\n\t\t\tinfo.start.arrowhead === 'none' || info.start.arrowhead === 'arrow'\n\t\t)\n\t\tconst maskEndArrowhead = !(info.end.arrowhead === 'none' || info.end.arrowhead === 'arrow')\n\t\tconst includeMask = maskStartArrowhead || maskEndArrowhead || labelSize\n\n\t\t// NOTE: I know right setting `changeIndex` hacky-as right! But we need this because otherwise safari loses\n\t\t// the mask, see <https://linear.app/tldraw/issue/TLD-1500/changing-arrow-color-makes-line-pass-through-text>\n\t\tconst maskId = (shape.id + '_clip_' + changeIndex).replace(':', '_')\n\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<SVGContainer id={shape.id} style={{ minWidth: 50, minHeight: 50 }}>\n\t\t\t\t\t{includeMask && (\n\t\t\t\t\t\t<defs>\n\t\t\t\t\t\t\t<mask id={maskId}>\n\t\t\t\t\t\t\t\t<rect\n\t\t\t\t\t\t\t\t\tx={toDomPrecision(-100 + bounds.minX)}\n\t\t\t\t\t\t\t\t\ty={toDomPrecision(-100 + bounds.minY)}\n\t\t\t\t\t\t\t\t\twidth={toDomPrecision(bounds.width + 200)}\n\t\t\t\t\t\t\t\t\theight={toDomPrecision(bounds.height + 200)}\n\t\t\t\t\t\t\t\t\tfill=\"white\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t{labelSize && (\n\t\t\t\t\t\t\t\t\t<rect\n\t\t\t\t\t\t\t\t\t\tx={toDomPrecision(labelSize.x)}\n\t\t\t\t\t\t\t\t\t\ty={toDomPrecision(labelSize.y)}\n\t\t\t\t\t\t\t\t\t\twidth={toDomPrecision(labelSize.w)}\n\t\t\t\t\t\t\t\t\t\theight={toDomPrecision(labelSize.h)}\n\t\t\t\t\t\t\t\t\t\tfill=\"black\"\n\t\t\t\t\t\t\t\t\t\trx={4}\n\t\t\t\t\t\t\t\t\t\try={4}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t{as && maskStartArrowhead && (\n\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\td={as}\n\t\t\t\t\t\t\t\t\t\tfill={info.start.arrowhead === 'arrow' ? 'none' : 'black'}\n\t\t\t\t\t\t\t\t\t\tstroke=\"none\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t{ae && maskEndArrowhead && (\n\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\td={ae}\n\t\t\t\t\t\t\t\t\t\tfill={info.end.arrowhead === 'arrow' ? 'none' : 'black'}\n\t\t\t\t\t\t\t\t\t\tstroke=\"none\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</mask>\n\t\t\t\t\t\t</defs>\n\t\t\t\t\t)}\n\t\t\t\t\t<g\n\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\tstrokeWidth={strokeWidth}\n\t\t\t\t\t\tstrokeLinejoin=\"round\"\n\t\t\t\t\t\tstrokeLinecap=\"round\"\n\t\t\t\t\t\tpointerEvents=\"none\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{handlePath}\n\t\t\t\t\t\t{/* firefox will clip if you provide a maskURL even if there is no mask matching that URL in the DOM */}\n\t\t\t\t\t\t<g {...(includeMask ? { mask: `url(#${maskId})` } : undefined)}>\n\t\t\t\t\t\t\t{/* This rect needs to be here if we're creating a mask due to an svg quirk on Chrome */}\n\t\t\t\t\t\t\t{includeMask && (\n\t\t\t\t\t\t\t\t<rect\n\t\t\t\t\t\t\t\t\tx={toDomPrecision(bounds.minX - 100)}\n\t\t\t\t\t\t\t\t\ty={toDomPrecision(bounds.minY - 100)}\n\t\t\t\t\t\t\t\t\twidth={toDomPrecision(bounds.width + 200)}\n\t\t\t\t\t\t\t\t\theight={toDomPrecision(bounds.height + 200)}\n\t\t\t\t\t\t\t\t\topacity={0}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\td={path}\n\t\t\t\t\t\t\t\tstrokeDasharray={strokeDasharray}\n\t\t\t\t\t\t\t\tstrokeDashoffset={strokeDashoffset}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</g>\n\t\t\t\t\t\t{as && maskStartArrowhead && shape.props.fill !== 'none' && (\n\t\t\t\t\t\t\t<ShapeFill d={as} color={shape.props.color} fill={shape.props.fill} />\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{ae && maskEndArrowhead && shape.props.fill !== 'none' && (\n\t\t\t\t\t\t\t<ShapeFill d={ae} color={shape.props.color} fill={shape.props.fill} />\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{as && <path d={as} />}\n\t\t\t\t\t\t{ae && <path d={ae} />}\n\t\t\t\t\t</g>\n\t\t\t\t\t<path d={path} className=\"rs-hitarea-stroke\" />\n\t\t\t\t</SVGContainer>\n\t\t\t\t<ArrowTextLabel\n\t\t\t\t\tid={shape.id}\n\t\t\t\t\ttext={shape.props.text}\n\t\t\t\t\tfont={shape.props.font}\n\t\t\t\t\tsize={shape.props.size}\n\t\t\t\t\tposition={info.middle}\n\t\t\t\t\twidth={labelSize?.w ?? 0}\n\t\t\t\t\tlabelColor={this.app.getCssColor(shape.props.labelColor)}\n\t\t\t\t/>\n\t\t\t</>\n\t\t)\n\t}\n\n\tindicator(shape: TLArrowShape) {\n\t\tconst { start, end } = getArrowTerminalsInArrowSpace(this.app, shape)\n\n\t\tconst info = this.getArrowInfo(shape)\n\t\tconst bounds = this.bounds(shape)\n\t\tconst labelSize = this.getLabelBounds(shape)\n\n\t\tif (!info) return null\n\t\tif (Vec2d.Equals(start, end)) return null\n\n\t\tconst strokeWidth = this.app.getStrokeWidth(shape.props.size)\n\n\t\tconst as = info.start.arrowhead && getArrowheadPathForType(info, 'start', strokeWidth)\n\t\tconst ae = info.end.arrowhead && getArrowheadPathForType(info, 'end', strokeWidth)\n\n\t\tconst path = info.isStraight ? getSolidStraightArrowPath(info) : getSolidCurvedArrowPath(info)\n\n\t\tconst includeMask =\n\t\t\t(as && info.start.arrowhead !== 'arrow') ||\n\t\t\t(ae && info.end.arrowhead !== 'arrow') ||\n\t\t\tlabelSize !== null\n\n\t\tconst maskId = (shape.id + '_clip').replace(':', '_')\n\n\t\treturn (\n\t\t\t<g>\n\t\t\t\t{includeMask && (\n\t\t\t\t\t<defs>\n\t\t\t\t\t\t<mask id={maskId}>\n\t\t\t\t\t\t\t<rect\n\t\t\t\t\t\t\t\tx={bounds.minX - 100}\n\t\t\t\t\t\t\t\ty={bounds.minY - 100}\n\t\t\t\t\t\t\t\twidth={bounds.w + 200}\n\t\t\t\t\t\t\t\theight={bounds.h + 200}\n\t\t\t\t\t\t\t\tfill=\"white\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t{labelSize && (\n\t\t\t\t\t\t\t\t<rect\n\t\t\t\t\t\t\t\t\tx={labelSize.x}\n\t\t\t\t\t\t\t\t\ty={labelSize.y}\n\t\t\t\t\t\t\t\t\twidth={labelSize.w}\n\t\t\t\t\t\t\t\t\theight={labelSize.h}\n\t\t\t\t\t\t\t\t\tfill=\"black\"\n\t\t\t\t\t\t\t\t\trx={4}\n\t\t\t\t\t\t\t\t\try={4}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t{as && (\n\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\td={as}\n\t\t\t\t\t\t\t\t\tfill={info.start.arrowhead === 'arrow' ? 'none' : 'black'}\n\t\t\t\t\t\t\t\t\tstroke=\"none\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t{ae && (\n\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\td={ae}\n\t\t\t\t\t\t\t\t\tfill={info.end.arrowhead === 'arrow' ? 'none' : 'black'}\n\t\t\t\t\t\t\t\t\tstroke=\"none\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</mask>\n\t\t\t\t\t</defs>\n\t\t\t\t)}\n\t\t\t\t{/* firefox will clip if you provide a maskURL even if there is no mask matching that URL in the DOM */}\n\t\t\t\t<g {...(includeMask ? { mask: `url(#${maskId})` } : undefined)}>\n\t\t\t\t\t{/* This rect needs to be here if we're creating a mask due to an svg quirk on Chrome */}\n\t\t\t\t\t{includeMask && (\n\t\t\t\t\t\t<rect\n\t\t\t\t\t\t\tx={bounds.minX - 100}\n\t\t\t\t\t\t\ty={bounds.minY - 100}\n\t\t\t\t\t\t\twidth={bounds.width + 200}\n\t\t\t\t\t\t\theight={bounds.height + 200}\n\t\t\t\t\t\t\topacity={0}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\n\t\t\t\t\t<path d={path} />\n\t\t\t\t</g>\n\t\t\t\t{as && <path d={as} />}\n\t\t\t\t{ae && <path d={ae} />}\n\t\t\t\t{labelSize && (\n\t\t\t\t\t<rect\n\t\t\t\t\t\tx={labelSize.x}\n\t\t\t\t\t\ty={labelSize.y}\n\t\t\t\t\t\twidth={labelSize.w}\n\t\t\t\t\t\theight={labelSize.h}\n\t\t\t\t\t\trx={4}\n\t\t\t\t\t\try={4}\n\t\t\t\t\t/>\n\t\t\t\t)}\n\t\t\t</g>\n\t\t)\n\t}\n\n\t@computed get labelBoundsCache(): ComputedCache<Box2d | null, TLArrowShape> {\n\t\treturn this.app.store.createComputedCache('labelBoundsCache', (shape) => {\n\t\t\tconst info = this.getArrowInfo(shape)\n\t\t\tconst bounds = this.bounds(shape)\n\t\t\tconst { text, font, size } = shape.props\n\n\t\t\tif (!info) return null\n\t\t\tif (!text.trim()) return null\n\n\t\t\tconst { w, h } = this.app.textMeasure.measureText({\n\t\t\t\t...TEXT_PROPS,\n\t\t\t\ttext,\n\t\t\t\tfontFamily: FONT_FAMILIES[font],\n\t\t\t\tfontSize: ARROW_LABEL_FONT_SIZES[size],\n\t\t\t\twidth: 'fit-content',\n\t\t\t})\n\n\t\t\tlet width = w\n\t\t\tlet height = h\n\n\t\t\tif (bounds.width > bounds.height) {\n\t\t\t\twidth = Math.max(Math.min(w, 64), Math.min(bounds.width - 64, w))\n\n\t\t\t\tconst { w: squishedWidth, h: squishedHeight } = this.app.textMeasure.measureText({\n\t\t\t\t\t...TEXT_PROPS,\n\t\t\t\t\ttext,\n\t\t\t\t\tfontFamily: FONT_FAMILIES[font],\n\t\t\t\t\tfontSize: ARROW_LABEL_FONT_SIZES[size],\n\t\t\t\t\twidth: width + 'px',\n\t\t\t\t})\n\n\t\t\t\twidth = squishedWidth\n\t\t\t\theight = squishedHeight\n\t\t\t}\n\n\t\t\tif (width > 16 * ARROW_LABEL_FONT_SIZES[size]) {\n\t\t\t\twidth = 16 * ARROW_LABEL_FONT_SIZES[size]\n\n\t\t\t\tconst { w: squishedWidth, h: squishedHeight } = this.app.textMeasure.measureText({\n\t\t\t\t\t...TEXT_PROPS,\n\t\t\t\t\ttext,\n\t\t\t\t\tfontFamily: FONT_FAMILIES[font],\n\t\t\t\t\tfontSize: ARROW_LABEL_FONT_SIZES[size],\n\t\t\t\t\twidth: width + 'px',\n\t\t\t\t})\n\n\t\t\t\twidth = squishedWidth\n\t\t\t\theight = squishedHeight\n\t\t\t}\n\n\t\t\treturn new Box2d(\n\t\t\t\tinfo.middle.x - (width + 8) / 2,\n\t\t\t\tinfo.middle.y - (height + 8) / 2,\n\t\t\t\twidth + 8,\n\t\t\t\theight + 8\n\t\t\t)\n\t\t})\n\t}\n\n\tgetLabelBounds(shape: TLArrowShape): Box2d | null {\n\t\treturn this.labelBoundsCache.get(shape.id) || null\n\t}\n\n\tgetEditingBounds = (shape: TLArrowShape): Box2d => {\n\t\treturn this.getLabelBounds(shape) ?? new Box2d()\n\t}\n\n\tonEditEnd: OnEditEndHandler<TLArrowShape> = (shape) => {\n\t\tconst {\n\t\t\tid,\n\t\t\ttype,\n\t\t\tprops: { text },\n\t\t} = shape\n\n\t\tif (text.trim() !== shape.props.text) {\n\t\t\tthis.app.updateShapes([\n\t\t\t\t{\n\t\t\t\t\tid,\n\t\t\t\t\ttype,\n\t\t\t\t\tprops: {\n\t\t\t\t\t\ttext: text.trim(),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t])\n\t\t}\n\t}\n\n\ttoSvg(shape: TLArrowShape, font: string, colors: TLExportColors) {\n\t\tconst color = colors.fill[shape.props.color]\n\n\t\tconst info = this.getArrowInfo(shape)\n\n\t\tconst strokeWidth = this.app.getStrokeWidth(shape.props.size)\n\n\t\t// Group for arrow\n\t\tconst g = document.createElementNS('http://www.w3.org/2000/svg', 'g')\n\t\tif (!info) return g\n\n\t\t// Arrowhead start path\n\t\tconst as = info.start.arrowhead && getArrowheadPathForType(info, 'start', strokeWidth)\n\t\t// Arrowhead end path\n\t\tconst ae = info.end.arrowhead && getArrowheadPathForType(info, 'end', strokeWidth)\n\n\t\tconst bounds = this.bounds(shape)\n\t\tconst labelSize = this.getLabelBounds(shape)\n\n\t\tconst maskId = (shape.id + '_clip').replace(':', '_')\n\n\t\t// If we have any arrowheads, then mask the arrowheads\n\t\tif (as || ae) {\n\t\t\t// Create mask for arrowheads\n\n\t\t\t// Create defs\n\t\t\tconst defs = document.createElementNS('http://www.w3.org/2000/svg', 'defs')\n\n\t\t\t// Create mask\n\t\t\tconst mask = document.createElementNS('http://www.w3.org/2000/svg', 'mask')\n\t\t\tmask.id = maskId\n\n\t\t\t// Create large white shape for mask\n\t\t\tconst rect = document.createElementNS('http://www.w3.org/2000/svg', 'rect')\n\t\t\trect.setAttribute('x', bounds.minX - 100 + '')\n\t\t\trect.setAttribute('y', bounds.minY - 100 + '')\n\t\t\trect.setAttribute('width', bounds.width + 200 + '')\n\t\t\trect.setAttribute('height', bounds.height + 200 + '')\n\t\t\trect.setAttribute('fill', 'white')\n\t\t\tmask.appendChild(rect)\n\n\t\t\t// add arrowhead start mask\n\t\t\tif (as) mask.appendChild(getArrowheadSvgMask(as, info.start.arrowhead))\n\n\t\t\t// add arrowhead end mask\n\t\t\tif (ae) mask.appendChild(getArrowheadSvgMask(ae, info.end.arrowhead))\n\n\t\t\t// Mask out text label if text is present\n\t\t\tif (labelSize) {\n\t\t\t\tconst labelMask = document.createElementNS('http://www.w3.org/2000/svg', 'rect')\n\t\t\t\tlabelMask.setAttribute('x', labelSize.x + '')\n\t\t\t\tlabelMask.setAttribute('y', labelSize.y + '')\n\t\t\t\tlabelMask.setAttribute('width', labelSize.w + '')\n\t\t\t\tlabelMask.setAttribute('height', labelSize.h + '')\n\t\t\t\tlabelMask.setAttribute('fill', 'black')\n\n\t\t\t\tmask.appendChild(labelMask)\n\t\t\t}\n\n\t\t\tdefs.appendChild(mask)\n\t\t\tg.appendChild(defs)\n\t\t}\n\n\t\tconst g2 = document.createElementNS('http://www.w3.org/2000/svg', 'g')\n\t\tg2.setAttribute('mask', `url(#${maskId})`)\n\t\tg.appendChild(g2)\n\n\t\t// Dumb mask fix thing\n\t\tconst rect2 = document.createElementNS('http://www.w3.org/2000/svg', 'rect')\n\t\trect2.setAttribute('x', '-100')\n\t\trect2.setAttribute('y', '-100')\n\t\trect2.setAttribute('width', bounds.width + 200 + '')\n\t\trect2.setAttribute('height', bounds.height + 200 + '')\n\t\trect2.setAttribute('fill', 'transparent')\n\t\trect2.setAttribute('stroke', 'none')\n\t\tg2.appendChild(rect2)\n\n\t\t// Arrowhead body path\n\t\tconst path = getArrowSvgPath(\n\t\t\tinfo.isStraight ? getSolidStraightArrowPath(info) : getSolidCurvedArrowPath(info),\n\t\t\tcolor,\n\t\t\tstrokeWidth\n\t\t)\n\n\t\tconst { strokeDasharray, strokeDashoffset } = getPerfectDashProps(\n\t\t\tinfo.isStraight ? info.length : Math.abs(info.bodyArc.length),\n\t\t\tstrokeWidth,\n\t\t\t{\n\t\t\t\tstyle: shape.props.dash,\n\t\t\t}\n\t\t)\n\n\t\tpath.setAttribute('stroke-dasharray', strokeDasharray)\n\t\tpath.setAttribute('stroke-dashoffset', strokeDashoffset)\n\n\t\tg2.appendChild(path)\n\n\t\t// Arrowhead start path\n\t\tif (as) {\n\t\t\tg.appendChild(\n\t\t\t\tgetArrowheadSvgPath(\n\t\t\t\t\tas,\n\t\t\t\t\tshape.props.color,\n\t\t\t\t\tstrokeWidth,\n\t\t\t\t\tshape.props.arrowheadStart === 'arrow' ? 'none' : shape.props.fill,\n\t\t\t\t\tcolors\n\t\t\t\t)\n\t\t\t)\n\t\t}\n\t\t// Arrowhead end path\n\t\tif (ae) {\n\t\t\tg.appendChild(\n\t\t\t\tgetArrowheadSvgPath(\n\t\t\t\t\tae,\n\t\t\t\t\tshape.props.color,\n\t\t\t\t\tstrokeWidth,\n\t\t\t\t\tshape.props.arrowheadEnd === 'arrow' ? 'none' : shape.props.fill,\n\t\t\t\t\tcolors\n\t\t\t\t)\n\t\t\t)\n\t\t}\n\n\t\t// Text Label\n\t\tif (labelSize) {\n\t\t\tconst opts = {\n\t\t\t\tfontSize: ARROW_LABEL_FONT_SIZES[shape.props.size],\n\t\t\t\tlineHeight: TEXT_PROPS.lineHeight,\n\t\t\t\tfontFamily: font,\n\t\t\t\tpadding: 0,\n\t\t\t\ttextAlign: 'middle' as const,\n\t\t\t\twidth: labelSize.w,\n\t\t\t\theight: labelSize.h,\n\t\t\t\tfontStyle: 'normal',\n\t\t\t\tfontWeight: 'normal',\n\t\t\t}\n\n\t\t\tconst lines = this.app.textMeasure.getTextLines({\n\t\t\t\ttext: shape.props.text,\n\t\t\t\twrap: true,\n\t\t\t\t...opts,\n\t\t\t\twidth: labelSize.w - 8,\n\t\t\t})\n\n\t\t\tconst textElm = getTextSvgElement(this.app, {\n\t\t\t\tlines,\n\t\t\t\t...opts,\n\t\t\t\twidth: labelSize.w - 8,\n\t\t\t})\n\n\t\t\ttextElm.setAttribute('fill', colors.fill[shape.props.labelColor])\n\n\t\t\tconst children = Array.from(textElm.children) as unknown as SVGTSpanElement[]\n\n\t\t\tchildren.forEach((child) => {\n\t\t\t\tconst x = parseFloat(child.getAttribute('x') || '0')\n\t\t\t\tconst y = parseFloat(child.getAttribute('y') || '0')\n\n\t\t\t\tchild.setAttribute('x', x + 4 + labelSize!.x + 'px')\n\t\t\t\tchild.setAttribute('y', y + labelSize!.y + 'px')\n\t\t\t})\n\n\t\t\tg.appendChild(textElm)\n\t\t}\n\n\t\treturn g\n\t}\n}\n\nfunction getArrowheadSvgMask(d: string, arrowhead: TLArrowheadType) {\n\tconst path = document.createElementNS('http://www.w3.org/2000/svg', 'path')\n\tpath.setAttribute('d', d)\n\tpath.setAttribute('fill', arrowhead === 'arrow' ? 'none' : 'black')\n\tpath.setAttribute('stroke', 'none')\n\treturn path\n}\n\nfunction getArrowSvgPath(d: string, color: string, strokeWidth: number) {\n\tconst path = document.createElementNS('http://www.w3.org/2000/svg', 'path')\n\tpath.setAttribute('d', d)\n\tpath.setAttribute('fill', 'none')\n\tpath.setAttribute('stroke', color)\n\tpath.setAttribute('stroke-width', strokeWidth + '')\n\treturn path\n}\n\nfunction getArrowheadSvgPath(\n\td: string,\n\tcolor: TLColorType,\n\tstrokeWidth: number,\n\tfill: TLFillType,\n\tcolors: TLExportColors\n) {\n\tconst path = document.createElementNS('http://www.w3.org/2000/svg', 'path')\n\tpath.setAttribute('d', d)\n\tpath.setAttribute('fill', 'none')\n\tpath.setAttribute('stroke', colors.fill[color])\n\tpath.setAttribute('stroke-width', strokeWidth + '')\n\n\t// Get the fill element, if any\n\tconst shapeFill = getShapeFillSvg({\n\t\td,\n\t\tfill,\n\t\tcolor,\n\t\tcolors,\n\t})\n\n\tif (shapeFill) {\n\t\t// If there is a fill element, return a group containing the fill and the path\n\t\tconst g = document.createElementNS('http://www.w3.org/2000/svg', 'g')\n\t\tg.appendChild(shapeFill)\n\t\tg.appendChild(path)\n\t\treturn g\n\t} else {\n\t\t// Otherwise, just return the path\n\t\treturn path\n\t}\n}\n\nfunction isPrecise(normalizedAnchor: Vec2dModel) {\n\treturn normalizedAnchor.x !== 0.5 || normalizedAnchor.y !== 0.5\n}\n\n/** @public */\nexport const TLArrowShapeDef = defineShape<TLArrowShape, TLArrowUtil>({\n\ttype: 'arrow',\n\tgetShapeUtil: () => TLArrowUtil,\n\tvalidator: arrowShapeTypeValidator,\n\tmigrations: arrowShapeMigrations,\n})\n","import * as React from 'react'\n\n/** @public */\nexport type HTMLContainerProps = React.HTMLAttributes<HTMLDivElement>\n\n/** @public */\nexport function HTMLContainer({ children, className = '', ...rest }: HTMLContainerProps) {\n\treturn (\n\t\t<div {...rest} className={`rs-html-container ${className}`}>\n\t\t\t{children}\n\t\t</div>\n\t)\n}\n","import { stopEventPropagation } from '.'\nimport { useApp } from '../../../hooks'\n\nconst LINK_ICON =\n\t\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='30' height='30' fill='none'%3E%3Cpath stroke='%23000' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M13 5H7a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6M19 5h6m0 0v6m0-6L13 17'/%3E%3C/svg%3E\"\n\nexport function HyperlinkButton({ url }: { url: string }) {\n\tconst {\n\t\tcamera: { z },\n\t} = useApp()\n\n\treturn (\n\t\t<a\n\t\t\tclassName={`rs-hyperlink-button ${z < 0.5 ? 'hidden' : ''}`}\n\t\t\thref={url}\n\t\t\ttarget=\"_blank\"\n\t\t\trel=\"noopener noreferrer\"\n\t\t\tonPointerDown={stopEventPropagation}\n\t\t\tonPointerUp={stopEventPropagation}\n\t\t\ttitle={url}\n\t\t\tdraggable={false}\n\t\t>\n\t\t\t<div\n\t\t\t\tclassName=\"rs-hyperlink-button__icon\"\n\t\t\t\tstyle={{\n\t\t\t\t\tmask: `url(\"${LINK_ICON}\") center 100% / 100% no-repeat`,\n\t\t\t\t\tWebkitMask: `url(\"${LINK_ICON}\") center 100% / 100% no-repeat`,\n\t\t\t\t}}\n\t\t\t/>\n\t\t</a>\n\t\t// </div>\n\t)\n}\n","import { Box2d, Vec2d } from '@tldraw/primitives'\nimport { Vec2dModel } from '@tldraw/tlschema'\nimport { TLBoxLike } from '../../statechart/TLBoxTool'\nimport { TLResizeHandle } from '../../types/selection-types'\nimport { TLResizeMode } from '../TLShapeUtil'\n\nexport type ResizeBoxOptions = Partial<{\n\tminWidth: number\n\tmaxWidth: number\n\tminHeight: number\n\tmaxHeight: number\n}>\n\nexport const resizeBox = (\n\tshape: TLBoxLike,\n\tinfo: {\n\t\tnewPoint: Vec2dModel\n\t\thandle: TLResizeHandle\n\t\tmode: TLResizeMode\n\t\tscaleX: number\n\t\tscaleY: number\n\t\tinitialBounds: Box2d\n\t\tinitialShape: TLBoxLike\n\t},\n\topts = {} as ResizeBoxOptions\n) => {\n\tconst { newPoint, handle, scaleX, scaleY } = info\n\tconst { minWidth = 1, maxWidth = Infinity, minHeight = 1, maxHeight = Infinity } = opts\n\n\tlet w = shape.props.w * scaleX\n\tlet h = shape.props.h * scaleY\n\n\tconst offset = new Vec2d(0, 0)\n\n\tif (w > 0) {\n\t\tif (w < minWidth) {\n\t\t\tswitch (handle) {\n\t\t\t\tcase 'top_left':\n\t\t\t\tcase 'left':\n\t\t\t\tcase 'bottom_left': {\n\t\t\t\t\toffset.x = w - minWidth\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t\tcase 'top':\n\t\t\t\tcase 'bottom': {\n\t\t\t\t\toffset.x = (w - minWidth) / 2\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t\tdefault: {\n\t\t\t\t\toffset.x = 0\n\t\t\t\t}\n\t\t\t}\n\t\t\tw = minWidth\n\t\t}\n\t} else {\n\t\toffset.x = w\n\t\tw = -w\n\t\tif (w < minWidth) {\n\t\t\tswitch (handle) {\n\t\t\t\tcase 'top_left':\n\t\t\t\tcase 'left':\n\t\t\t\tcase 'bottom_left': {\n\t\t\t\t\toffset.x = -w\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t\tdefault: {\n\t\t\t\t\toffset.x = -minWidth\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tw = minWidth\n\t\t}\n\t}\n\n\tif (h > 0) {\n\t\tif (h < minHeight) {\n\t\t\tswitch (handle) {\n\t\t\t\tcase 'top_left':\n\t\t\t\tcase 'top':\n\t\t\t\tcase 'top_right': {\n\t\t\t\t\toffset.y = h - minHeight\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t\tcase 'right':\n\t\t\t\tcase 'left': {\n\t\t\t\t\toffset.y = (h - minHeight) / 2\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t\tdefault: {\n\t\t\t\t\toffset.y = 0\n\t\t\t\t}\n\t\t\t}\n\n\t\t\th = minHeight\n\t\t}\n\t} else {\n\t\toffset.y = h\n\t\th = -h\n\t\tif (h < minHeight) {\n\t\t\tswitch (handle) {\n\t\t\t\tcase 'top_left':\n\t\t\t\tcase 'top':\n\t\t\t\tcase 'top_right': {\n\t\t\t\t\toffset.y = -h\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t\tdefault: {\n\t\t\t\t\toffset.y = -minHeight\n\t\t\t\t}\n\t\t\t}\n\t\t\th = minHeight\n\t\t}\n\t}\n\n\tconst { x, y } = offset.rot(shape.rotation).add(newPoint)\n\n\treturn {\n\t\tx,\n\t\ty,\n\t\tprops: {\n\t\t\tw: Math.min(maxWidth, w),\n\t\t\th: Math.min(maxHeight, h),\n\t\t},\n\t}\n}\n","import { Box2d, linesIntersect, pointInPolygon, Vec2d, VecLike } from '@tldraw/primitives'\nimport { TLBoxLike } from '../statechart/TLBoxTool'\nimport { resizeBox } from './shared/resizeBox'\nimport { OnResizeHandler, TLShapeUtil } from './TLShapeUtil'\n\n/** @public */\nexport abstract class TLBoxUtil<Shape extends TLBoxLike> extends TLShapeUtil<Shape> {\n\toverride getBounds(shape: Shape) {\n\t\treturn new Box2d(0, 0, shape.props.w, shape.props.h)\n\t}\n\n\toverride getCenter(shape: Shape) {\n\t\treturn new Vec2d(shape.props.w / 2, shape.props.h / 2)\n\t}\n\n\toverride getOutline(shape: Shape) {\n\t\treturn this.bounds(shape).corners\n\t}\n\n\thitTestPoint(shape: Shape, point: VecLike): boolean {\n\t\treturn pointInPolygon(point, this.outline(shape))\n\t}\n\n\thitTestLineSegment(shape: Shape, A: VecLike, B: VecLike): boolean {\n\t\tconst outline = this.outline(shape)\n\n\t\tfor (let i = 0; i < outline.length; i++) {\n\t\t\tconst C = outline[i]\n\t\t\tconst D = outline[(i + 1) % outline.length]\n\t\t\tif (linesIntersect(A, B, C, D)) return true\n\t\t}\n\n\t\treturn false\n\t}\n\n\tonResize: OnResizeHandler<any> = (shape, info) => {\n\t\treturn resizeBox(shape, info)\n\t}\n}\n","import { toDomPrecision } from '@tldraw/primitives'\nimport {\n\tbookmarkShapeMigrations,\n\tbookmarkShapeTypeValidator,\n\tTLAsset,\n\tTLAssetId,\n\tTLBookmarkAsset,\n\tTLBookmarkShape,\n} from '@tldraw/tlschema'\nimport { debounce, getHashForString } from '@tldraw/utils'\nimport { HTMLContainer } from '../../../components/HTMLContainer'\nimport { defineShape } from '../../../config/TLShapeDefinition'\nimport {\n\tDEFAULT_BOOKMARK_HEIGHT,\n\tDEFAULT_BOOKMARK_WIDTH,\n\tROTATING_SHADOWS,\n} from '../../../constants'\nimport { rotateBoxShadow, truncateStringWithEllipsis } from '../../../utils'\nimport { stopEventPropagation } from '../shared'\nimport { HyperlinkButton } from '../shared/HyperlinkButton'\nimport { TLBoxUtil } from '../TLBoxUtil'\nimport { OnBeforeCreateHandler, OnBeforeUpdateHandler } from '../TLShapeUtil'\n\n/** @public */\nexport class TLBookmarkUtil extends TLBoxUtil<TLBookmarkShape> {\n\tstatic type = 'bookmark'\n\n\toverride canResize = () => false\n\n\toverride hideSelectionBoundsBg = () => true\n\toverride hideSelectionBoundsFg = () => true\n\n\toverride defaultProps(): TLBookmarkShape['props'] {\n\t\treturn {\n\t\t\topacity: '1',\n\t\t\turl: '',\n\t\t\tw: DEFAULT_BOOKMARK_WIDTH,\n\t\t\th: DEFAULT_BOOKMARK_HEIGHT,\n\t\t\tassetId: null,\n\t\t}\n\t}\n\n\toverride render(shape: TLBookmarkShape) {\n\t\tconst asset = (\n\t\t\tshape.props.assetId ? this.app.getAssetById(shape.props.assetId) : null\n\t\t) as TLBookmarkAsset\n\n\t\tconst pageRotation = this.app.getPageRotation(shape)\n\n\t\tconst address = this.getHumanReadableAddress(shape)\n\n\t\treturn (\n\t\t\t<HTMLContainer>\n\t\t\t\t<div\n\t\t\t\t\tclassName=\"rs-bookmark__container rs-hitarea-stroke\"\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\tboxShadow: rotateBoxShadow(pageRotation, ROTATING_SHADOWS),\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<div className=\"rs-bookmark__image_container\">\n\t\t\t\t\t\t{asset?.props.image ? (\n\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\tclassName=\"rs-bookmark__image\"\n\t\t\t\t\t\t\t\tdraggable={false}\n\t\t\t\t\t\t\t\tsrc={asset?.props.image}\n\t\t\t\t\t\t\t\talt={asset?.props.title || ''}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t<div className=\"rs-bookmark__placeholder\" />\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t<HyperlinkButton url={shape.props.url} />\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"rs-bookmark__copy_container\">\n\t\t\t\t\t\t{asset?.props.title && (\n\t\t\t\t\t\t\t<h2 className=\"rs-bookmark__heading\">\n\t\t\t\t\t\t\t\t{truncateStringWithEllipsis(asset?.props.title || '', 54)}\n\t\t\t\t\t\t\t</h2>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{asset?.props.description && (\n\t\t\t\t\t\t\t<p className=\"rs-bookmark__description\">\n\t\t\t\t\t\t\t\t{truncateStringWithEllipsis(asset?.props.description || '', 128)}\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t<a\n\t\t\t\t\t\t\tclassName=\"rs-bookmark__link\"\n\t\t\t\t\t\t\thref={shape.props.url || ''}\n\t\t\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t\t\t\trel=\"noopener noreferrer\"\n\t\t\t\t\t\t\tonPointerDown={stopEventPropagation}\n\t\t\t\t\t\t\tonPointerUp={stopEventPropagation}\n\t\t\t\t\t\t\tonClick={stopEventPropagation}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{truncateStringWithEllipsis(address, 45)}\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</HTMLContainer>\n\t\t)\n\t}\n\n\toverride indicator(shape: TLBookmarkShape) {\n\t\treturn (\n\t\t\t<rect\n\t\t\t\twidth={toDomPrecision(shape.props.w)}\n\t\t\t\theight={toDomPrecision(shape.props.h)}\n\t\t\t\trx=\"8\"\n\t\t\t\try=\"8\"\n\t\t\t/>\n\t\t)\n\t}\n\n\toverride onBeforeCreate?: OnBeforeCreateHandler<TLBookmarkShape> = (shape) => {\n\t\tthis.updateBookmarkAsset(shape)\n\t}\n\n\toverride onBeforeUpdate?: OnBeforeUpdateHandler<TLBookmarkShape> = (prev, shape) => {\n\t\tif (prev.props.url !== shape.props.url) {\n\t\t\tthis.updateBookmarkAsset(shape)\n\t\t}\n\t}\n\n\tgetHumanReadableAddress(shape: TLBookmarkShape) {\n\t\ttry {\n\t\t\tconst url = new URL(shape.props.url)\n\t\t\tconst path = url.pathname.replace(/\\/*$/, '')\n\t\t\treturn `${url.hostname}${path}`\n\t\t} catch (e) {\n\t\t\treturn shape.props.url\n\t\t}\n\t}\n\n\tprotected updateBookmarkAsset = debounce((shape: TLBookmarkShape) => {\n\t\tconst { url } = shape.props\n\t\tconst assetId: TLAssetId = TLAsset.createCustomId(getHashForString(url))\n\t\tconst existing = this.app.getAssetById(assetId)\n\n\t\tif (existing) {\n\t\t\t// If there's an existing asset with the same URL, use\n\t\t\t// its asset id instead.\n\t\t\tif (shape.props.assetId !== existing.id) {\n\t\t\t\tthis.app.updateShapes([\n\t\t\t\t\t{\n\t\t\t\t\t\tid: shape.id,\n\t\t\t\t\t\ttype: shape.type,\n\t\t\t\t\t\tprops: { assetId },\n\t\t\t\t\t},\n\t\t\t\t])\n\t\t\t}\n\t\t} else if (this.app.onCreateBookmarkFromUrl) {\n\t\t\t// Create a bookmark asset for the URL. First get its meta\n\t\t\t// data, then create the asset and update the shape.\n\t\t\tthis.app.onCreateBookmarkFromUrl(url).then((meta) => {\n\t\t\t\tif (!meta) {\n\t\t\t\t\tthis.app.updateShapes([\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: shape.id,\n\t\t\t\t\t\t\ttype: shape.type,\n\t\t\t\t\t\t\tprops: { assetId: undefined },\n\t\t\t\t\t\t},\n\t\t\t\t\t])\n\t\t\t\t\treturn\n\t\t\t\t}\n\n\t\t\t\tthis.app.batch(() => {\n\t\t\t\t\tthis.app\n\t\t\t\t\t\t.createAssets([\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tid: assetId,\n\t\t\t\t\t\t\t\ttypeName: 'asset',\n\t\t\t\t\t\t\t\ttype: 'bookmark',\n\t\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\t\tsrc: url,\n\t\t\t\t\t\t\t\t\tdescription: meta.description,\n\t\t\t\t\t\t\t\t\timage: meta.image,\n\t\t\t\t\t\t\t\t\ttitle: meta.title,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t])\n\t\t\t\t\t\t.updateShapes([\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tid: shape.id,\n\t\t\t\t\t\t\t\ttype: shape.type,\n\t\t\t\t\t\t\t\tprops: { assetId },\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t])\n\t\t\t\t})\n\t\t\t})\n\t\t}\n\t}, 500)\n}\n\n/** @public */\nexport const TLBookmarkShapeDef = defineShape<TLBookmarkShape, TLBookmarkUtil>({\n\ttype: 'bookmark',\n\tgetShapeUtil: () => TLBookmarkUtil,\n\tvalidator: bookmarkShapeTypeValidator,\n\tmigrations: bookmarkShapeMigrations,\n})\n","import { EASINGS, PI, SIN, StrokeOptions, Vec2d } from '@tldraw/primitives'\nimport { TLDrawShape, TLDrawShapeSegment } from '@tldraw/tlschema'\n\nconst PEN_EASING = (t: number) => t * 0.65 + SIN((t * PI) / 2) * 0.35\n\nconst simulatePressureSettings = (strokeWidth: number): StrokeOptions => {\n\treturn {\n\t\tsize: 1 + strokeWidth,\n\t\tthinning: 0.5,\n\t\tstreamline: 0.62 + ((1 + strokeWidth) / 8) * 0.06,\n\t\tsmoothing: 0.62,\n\t\teasing: EASINGS.easeOutSine,\n\t\tsimulatePressure: true,\n\t}\n}\n\nconst realPressureSettings = (strokeWidth: number): StrokeOptions => {\n\treturn {\n\t\tsize: 1 + strokeWidth * 1.2,\n\t\tthinning: 0.62,\n\t\tstreamline: 0.62,\n\t\tsmoothing: 0.62,\n\t\tsimulatePressure: false,\n\t\teasing: PEN_EASING,\n\t}\n}\n\nconst solidSettings = (strokeWidth: number): StrokeOptions => {\n\treturn {\n\t\tsize: 1 + strokeWidth,\n\t\tthinning: 0,\n\t\tstreamline: 0.62 + ((1 + strokeWidth) / 8) * 0.06,\n\t\tsmoothing: 0.62,\n\t\tsimulatePressure: false,\n\t\teasing: EASINGS.linear,\n\t}\n}\n\nexport function getFreehandOptions(\n\tshape: TLDrawShape,\n\tstrokeWidth: number,\n\tforceComplete: boolean,\n\tforceSolid: boolean\n): StrokeOptions {\n\treturn {\n\t\t...(forceSolid\n\t\t\t? solidSettings(strokeWidth)\n\t\t\t: shape.props.dash === 'draw'\n\t\t\t? shape.props.isPen\n\t\t\t\t? realPressureSettings(strokeWidth)\n\t\t\t\t: simulatePressureSettings(strokeWidth)\n\t\t\t: solidSettings(strokeWidth)),\n\t\tlast: shape.props.isComplete || forceComplete,\n\t}\n}\n\nexport function getPointsFromSegments(segments: TLDrawShapeSegment[]) {\n\tconst points: Vec2d[] = []\n\n\tfor (const segment of segments) {\n\t\tif (segment.type === 'free' || segment.points.length < 2) {\n\t\t\tpoints.push(...segment.points.map(Vec2d.Cast))\n\t\t} else {\n\t\t\tconst pointsToInterpolate = Math.max(\n\t\t\t\t4,\n\t\t\t\tMath.floor(Vec2d.Dist(segment.points[0], segment.points[1]) / 16)\n\t\t\t)\n\t\t\tpoints.push(...Vec2d.PointsBetween(segment.points[0], segment.points[1], pointsToInterpolate))\n\t\t}\n\t}\n\n\treturn points\n}\n\nexport function getDrawShapeStrokeDashArray(shape: TLDrawShape, strokeWidth: number) {\n\treturn {\n\t\tdraw: 'none',\n\t\tsolid: `none`,\n\t\tdotted: `0.1 ${strokeWidth * 2}`,\n\t\tdashed: `${strokeWidth * 2} ${strokeWidth * 2}`,\n\t}[shape.props.dash]\n}\n","/* eslint-disable react-hooks/rules-of-hooks */\nimport {\n\tBox2d,\n\tgetStrokeOutlinePoints,\n\tgetStrokePoints,\n\tlinesIntersect,\n\tpointInPolygon,\n\tsetStrokePointRadii,\n\tVec2d,\n\tVecLike,\n} from '@tldraw/primitives'\nimport {\n\tdrawShapeMigrations,\n\tdrawShapeTypeValidator,\n\tTLDrawShape,\n\tTLDrawShapeSegment,\n} from '@tldraw/tlschema'\nimport { last, rng } from '@tldraw/utils'\nimport { useValue } from 'signia-react'\nimport { SVGContainer } from '../../../components/SVGContainer'\nimport { defineShape } from '../../../config/TLShapeDefinition'\nimport { getSvgPathFromStroke, getSvgPathFromStrokePoints } from '../../../utils'\nimport { getShapeFillSvg, ShapeFill, TLExportColors } from '../shared'\nimport { OnResizeHandler, TLShapeUtil } from '../TLShapeUtil'\nimport { getDrawShapeStrokeDashArray, getFreehandOptions, getPointsFromSegments } from './getPath'\n\n/** @public */\nexport class TLDrawUtil extends TLShapeUtil<TLDrawShape> {\n\tstatic type = 'draw'\n\n\thideResizeHandles = (shape: TLDrawShape) => this.getIsDot(shape)\n\thideRotateHandle = (shape: TLDrawShape) => this.getIsDot(shape)\n\thideSelectionBoundsBg = (shape: TLDrawShape) => this.getIsDot(shape)\n\thideSelectionBoundsFg = (shape: TLDrawShape) => this.getIsDot(shape)\n\n\toverride defaultProps(): TLDrawShape['props'] {\n\t\treturn {\n\t\t\tsegments: [],\n\t\t\tcolor: 'black',\n\t\t\tfill: 'none',\n\t\t\tdash: 'draw',\n\t\t\tsize: 'm',\n\t\t\topacity: '1',\n\t\t\tisComplete: false,\n\t\t\tisClosed: false,\n\t\t\tisPen: false,\n\t\t}\n\t}\n\n\tisClosed = (shape: TLDrawShape) => shape.props.isClosed\n\n\tprivate getIsDot(shape: TLDrawShape) {\n\t\treturn shape.props.segments.length === 1 && shape.props.segments[0].points.length < 2\n\t}\n\n\tgetBounds(shape: TLDrawShape) {\n\t\treturn Box2d.FromPoints(this.outline(shape))\n\t}\n\n\tgetOutline(shape: TLDrawShape) {\n\t\treturn getPointsFromSegments(shape.props.segments)\n\t}\n\n\tgetCenter(shape: TLDrawShape): Vec2d {\n\t\treturn this.bounds(shape).center\n\t}\n\n\thitTestPoint(shape: TLDrawShape, point: VecLike): boolean {\n\t\tconst outline = this.outline(shape)\n\t\tconst zoomLevel = this.app.zoomLevel\n\t\tconst offsetDist = this.app.getStrokeWidth(shape.props.size) / zoomLevel\n\n\t\tif (shape.props.segments.length === 1 && shape.props.segments[0].points.length < 4) {\n\t\t\tif (shape.props.segments[0].points.some((pt) => Vec2d.Dist(point, pt) < offsetDist * 1.5)) {\n\t\t\t\treturn true\n\t\t\t}\n\t\t}\n\n\t\tif (this.isClosed(shape)) {\n\t\t\treturn pointInPolygon(point, outline)\n\t\t}\n\n\t\tfor (let i = 0; i < outline.length; i++) {\n\t\t\tconst C = outline[i]\n\t\t\tconst D = outline[(i + 1) % outline.length]\n\n\t\t\tif (Vec2d.DistanceToLineSegment(C, D, point) < offsetDist) return true\n\t\t}\n\n\t\treturn false\n\t}\n\n\thitTestLineSegment(shape: TLDrawShape, A: VecLike, B: VecLike): boolean {\n\t\tconst outline = this.outline(shape)\n\n\t\tif (shape.props.segments.length === 1 && shape.props.segments[0].points.length < 4) {\n\t\t\tconst zoomLevel = this.app.zoomLevel\n\t\t\tconst offsetDist = this.app.getStrokeWidth(shape.props.size) / zoomLevel\n\n\t\t\tif (\n\t\t\t\tshape.props.segments[0].points.some(\n\t\t\t\t\t(pt) => Vec2d.DistanceToLineSegment(A, B, pt) < offsetDist * 1.5\n\t\t\t\t)\n\t\t\t) {\n\t\t\t\treturn true\n\t\t\t}\n\t\t}\n\n\t\tif (this.isClosed(shape)) {\n\t\t\tfor (let i = 0; i < outline.length; i++) {\n\t\t\t\tconst C = outline[i]\n\t\t\t\tconst D = outline[(i + 1) % outline.length]\n\t\t\t\tif (linesIntersect(A, B, C, D)) return true\n\t\t\t}\n\t\t} else {\n\t\t\tfor (let i = 0; i < outline.length - 1; i++) {\n\t\t\t\tconst C = outline[i]\n\t\t\t\tconst D = outline[i + 1]\n\t\t\t\tif (linesIntersect(A, B, C, D)) return true\n\t\t\t}\n\t\t}\n\n\t\treturn false\n\t}\n\n\trender(shape: TLDrawShape) {\n\t\tconst forceSolid = useValue('zoom', () => this.app.zoomLevel < 0.35, [])\n\t\tconst strokeWidth = this.app.getStrokeWidth(shape.props.size)\n\t\tconst allPointsFromSegments = getPointsFromSegments(shape.props.segments)\n\n\t\tconst showAsComplete = shape.props.isComplete || last(shape.props.segments)?.type === 'straight'\n\n\t\tlet sw = strokeWidth\n\t\tif (!shape.props.isPen && shape.props.dash === 'draw' && allPointsFromSegments.length === 1) {\n\t\t\tsw += rng(shape.id)() * (strokeWidth / 6)\n\t\t}\n\n\t\tconst options = getFreehandOptions(shape, sw, showAsComplete, forceSolid)\n\t\tconst strokePoints = getStrokePoints(allPointsFromSegments, options)\n\n\t\tconst solidStrokePath =\n\t\t\tstrokePoints.length > 1\n\t\t\t\t? getSvgPathFromStrokePoints(strokePoints, shape.props.isClosed)\n\t\t\t\t: getDot(allPointsFromSegments[0], sw)\n\n\t\tif ((!forceSolid && shape.props.dash === 'draw') || strokePoints.length < 2) {\n\t\t\tsetStrokePointRadii(strokePoints, options)\n\t\t\tconst strokeOutlinePoints = getStrokeOutlinePoints(strokePoints, options)\n\n\t\t\treturn (\n\t\t\t\t<SVGContainer id={shape.id}>\n\t\t\t\t\t<ShapeFill\n\t\t\t\t\t\tfill={shape.props.isClosed ? shape.props.fill : 'none'}\n\t\t\t\t\t\tcolor={shape.props.color}\n\t\t\t\t\t\td={solidStrokePath}\n\t\t\t\t\t/>\n\t\t\t\t\t<path\n\t\t\t\t\t\td={getSvgPathFromStroke(strokeOutlinePoints, true)}\n\t\t\t\t\t\tstrokeLinecap=\"round\"\n\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t/>\n\t\t\t\t</SVGContainer>\n\t\t\t)\n\t\t}\n\n\t\treturn (\n\t\t\t<SVGContainer id={shape.id}>\n\t\t\t\t<ShapeFill\n\t\t\t\t\tcolor={shape.props.color}\n\t\t\t\t\tfill={shape.props.isClosed ? shape.props.fill : 'none'}\n\t\t\t\t\td={solidStrokePath}\n\t\t\t\t/>\n\t\t\t\t<path\n\t\t\t\t\td={solidStrokePath}\n\t\t\t\t\tstrokeLinecap=\"round\"\n\t\t\t\t\tfill=\"none\"\n\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\tstrokeWidth={strokeWidth}\n\t\t\t\t\tstrokeDasharray={getDrawShapeStrokeDashArray(shape, strokeWidth)}\n\t\t\t\t\tstrokeDashoffset=\"0\"\n\t\t\t\t/>\n\t\t\t</SVGContainer>\n\t\t)\n\t}\n\n\tindicator(shape: TLDrawShape) {\n\t\tconst strokeWidth = this.app.getStrokeWidth(shape.props.size)\n\t\tconst allPointsFromSegments = getPointsFromSegments(shape.props.segments)\n\n\t\tlet sw = strokeWidth\n\t\tif (!shape.props.isPen && shape.props.dash === 'draw' && allPointsFromSegments.length === 1) {\n\t\t\tsw += rng(shape.id)() * (strokeWidth / 6)\n\t\t}\n\n\t\tconst showAsComplete = shape.props.isComplete || last(shape.props.segments)?.type === 'straight'\n\t\tconst options = getFreehandOptions(shape, sw, showAsComplete, true)\n\t\tconst strokePoints = getStrokePoints(allPointsFromSegments, options)\n\t\tconst solidStrokePath =\n\t\t\tstrokePoints.length > 1\n\t\t\t\t? getSvgPathFromStrokePoints(strokePoints, shape.props.isClosed)\n\t\t\t\t: getDot(allPointsFromSegments[0], sw)\n\n\t\treturn <path d={solidStrokePath} />\n\t}\n\n\ttoSvg(shape: TLDrawShape, _font: string | undefined, colors: TLExportColors) {\n\t\tconst { color } = shape.props\n\n\t\tconst strokeWidth = this.app.getStrokeWidth(shape.props.size)\n\t\tconst allPointsFromSegments = getPointsFromSegments(shape.props.segments)\n\n\t\tconst showAsComplete = shape.props.isComplete || last(shape.props.segments)?.type === 'straight'\n\n\t\tlet sw = strokeWidth\n\t\tif (!shape.props.isPen && shape.props.dash === 'draw' && allPointsFromSegments.length === 1) {\n\t\t\tsw += rng(shape.id)() * (strokeWidth / 6)\n\t\t}\n\n\t\tconst options = getFreehandOptions(shape, sw, showAsComplete, false)\n\t\tconst strokePoints = getStrokePoints(allPointsFromSegments, options)\n\t\tconst solidStrokePath =\n\t\t\tstrokePoints.length > 1\n\t\t\t\t? getSvgPathFromStrokePoints(strokePoints, shape.props.isClosed)\n\t\t\t\t: getDot(allPointsFromSegments[0], sw)\n\n\t\tlet foregroundPath: SVGPathElement | undefined\n\n\t\tif (shape.props.dash === 'draw' || strokePoints.length < 2) {\n\t\t\tsetStrokePointRadii(strokePoints, options)\n\t\t\tconst strokeOutlinePoints = getStrokeOutlinePoints(strokePoints, options)\n\n\t\t\tconst p = document.createElementNS('http://www.w3.org/2000/svg', 'path')\n\t\t\tp.setAttribute('d', getSvgPathFromStroke(strokeOutlinePoints, true))\n\t\t\tp.setAttribute('fill', colors.fill[color])\n\t\t\tp.setAttribute('stroke-linecap', 'round')\n\n\t\t\tforegroundPath = p\n\t\t} else {\n\t\t\tconst p = document.createElementNS('http://www.w3.org/2000/svg', 'path')\n\t\t\tp.setAttribute('d', solidStrokePath)\n\t\t\tp.setAttribute('stroke', colors.fill[color])\n\t\t\tp.setAttribute('fill', 'none')\n\t\t\tp.setAttribute('stroke-linecap', 'round')\n\t\t\tp.setAttribute('stroke-width', strokeWidth.toString())\n\t\t\tp.setAttribute('stroke-dasharray', getDrawShapeStrokeDashArray(shape, strokeWidth))\n\t\t\tp.setAttribute('stroke-dashoffset', '0')\n\n\t\t\tforegroundPath = p\n\t\t}\n\n\t\tconst fillPath = getShapeFillSvg({\n\t\t\tfill: shape.props.isClosed ? shape.props.fill : 'none',\n\t\t\td: solidStrokePath,\n\t\t\tcolor: shape.props.color,\n\t\t\tcolors,\n\t\t})\n\n\t\tif (fillPath) {\n\t\t\tconst g = document.createElementNS('http://www.w3.org/2000/svg', 'g')\n\t\t\tg.appendChild(fillPath)\n\t\t\tg.appendChild(foregroundPath)\n\t\t\treturn g\n\t\t}\n\n\t\treturn foregroundPath\n\t}\n\n\toverride onResize: OnResizeHandler<TLDrawShape> = (shape, info) => {\n\t\tconst { scaleX, scaleY } = info\n\n\t\tconst newSegments: TLDrawShapeSegment[] = []\n\n\t\tfor (const segment of shape.props.segments) {\n\t\t\tnewSegments.push({\n\t\t\t\t...segment,\n\t\t\t\tpoints: segment.points.map(({ x, y, z }) => {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tx: scaleX * x,\n\t\t\t\t\t\ty: scaleY * y,\n\t\t\t\t\t\tz,\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t})\n\t\t}\n\n\t\treturn {\n\t\t\tprops: {\n\t\t\t\tsegments: newSegments,\n\t\t\t},\n\t\t}\n\t}\n}\n\n/** @public */\nexport const TLDrawShapeDef = defineShape<TLDrawShape, TLDrawUtil>({\n\ttype: 'draw',\n\tgetShapeUtil: () => TLDrawUtil,\n\tmigrations: drawShapeMigrations,\n\tvalidator: drawShapeTypeValidator,\n})\n\nfunction getDot(point: VecLike, sw: number) {\n\tconst r = (sw + 1) * 0.5\n\treturn `M ${point.x} ${point.y} m -${r}, 0 a ${r},${r} 0 1,0 ${r * 2},0 a ${r},${r} 0 1,0 -${\n\t\tr * 2\n\t},0`\n}\n","import * as React from 'react'\n\nexport function Spinner(props: React.SVGProps<SVGSVGElement>) {\n\treturn (\n\t\t<svg width={16} height={16} viewBox=\"0 0 16 16\" {...props}>\n\t\t\t<g strokeWidth={2} fill=\"none\" fillRule=\"evenodd\">\n\t\t\t\t<circle strokeOpacity={0.25} cx={8} cy={8} r={7} stroke=\"black\" />\n\t\t\t\t<path strokeLinecap=\"round\" d=\"M15 8c0-4.5-4.5-7-7-7\" stroke=\"black\">\n\t\t\t\t\t<animateTransform\n\t\t\t\t\t\tattributeName=\"transform\"\n\t\t\t\t\t\ttype=\"rotate\"\n\t\t\t\t\t\tfrom=\"0 8 8\"\n\t\t\t\t\t\tto=\"360 8 8\"\n\t\t\t\t\t\tdur=\"1s\"\n\t\t\t\t\t\trepeatCount=\"indefinite\"\n\t\t\t\t\t/>\n\t\t\t\t</path>\n\t\t\t</g>\n\t\t</svg>\n\t)\n}\n","/* eslint-disable react-hooks/rules-of-hooks */\nimport { toDomPrecision } from '@tldraw/primitives'\nimport {\n\tembedShapeMigrations,\n\tembedShapeTypeValidator,\n\tTLEmbedShape,\n\ttlEmbedShapePermissionDefaults,\n\tTLEmbedShapePermissions,\n} from '@tldraw/tlschema'\nimport * as React from 'react'\nimport { useMemo } from 'react'\nimport { useValue } from 'signia-react'\nimport { HTMLContainer } from '../../../components/HTMLContainer'\nimport { Spinner } from '../../../components/Spinner'\nimport { defineShape } from '../../../config/TLShapeDefinition'\nimport { ROTATING_SHADOWS } from '../../../constants'\nimport { useIsEditing } from '../../../hooks'\nimport { getEmbedInfo, getEmbedInfoUnsafely, rotateBoxShadow } from '../../../utils'\nimport { resizeBox } from '../shared/resizeBox'\nimport { TLBoxUtil } from '../TLBoxUtil'\nimport { OnResizeHandler, TLShapeUtilFlag } from '../TLShapeUtil'\n\nconst getSandboxPermissions = (permissions: TLEmbedShapePermissions) => {\n\treturn Object.entries(permissions)\n\t\t.filter(([_perm, isEnabled]) => isEnabled)\n\t\t.map(([perm]) => perm)\n\t\t.join(' ')\n}\n\n/** @public */\nexport class TLEmbedUtil extends TLBoxUtil<TLEmbedShape> {\n\tstatic type = 'embed'\n\n\toverride canUnmount: TLShapeUtilFlag<TLEmbedShape> = () => false\n\toverride canResize = (shape: TLEmbedShape) => {\n\t\tconst result = getEmbedInfo(shape.props.url)\n\t\treturn !!result?.definition?.doesResize\n\t}\n\n\toverride hideSelectionBoundsBg: TLShapeUtilFlag<TLEmbedShape> = (shape) => !this.canResize(shape)\n\toverride hideSelectionBoundsFg: TLShapeUtilFlag<TLEmbedShape> = (shape) => !this.canResize(shape)\n\n\toverride canEdit: TLShapeUtilFlag<TLEmbedShape> = () => true\n\n\toverride defaultProps(): TLEmbedShape['props'] {\n\t\treturn {\n\t\t\topacity: '1',\n\t\t\tw: 300,\n\t\t\th: 300,\n\t\t\turl: '',\n\t\t\tdoesResize: true,\n\t\t}\n\t}\n\n\tisAspectRatioLocked: TLShapeUtilFlag<TLEmbedShape> = (shape) => {\n\t\tconst embedInfo = getEmbedInfo(shape.props.url)\n\t\treturn embedInfo?.definition.isAspectRatioLocked ?? false\n\t}\n\n\tonResize: OnResizeHandler<TLEmbedShape> = (shape, info) => {\n\t\tconst isAspectRatioLocked = this.isAspectRatioLocked(shape)\n\t\tconst embedInfo = getEmbedInfo(shape.props.url)\n\t\tlet minWidth = embedInfo?.definition.minWidth ?? 200\n\t\tlet minHeight = embedInfo?.definition.minHeight ?? 200\n\t\tif (isAspectRatioLocked) {\n\t\t\t// Enforce aspect ratio\n\t\t\t// Neither the width or height can be less than 200\n\t\t\tconst aspectRatio = shape.props.w / shape.props.h\n\t\t\tif (aspectRatio > 1) {\n\t\t\t\t// Landscape\n\t\t\t\tminWidth *= aspectRatio\n\t\t\t} else {\n\t\t\t\t// Portrait\n\t\t\t\tminHeight /= aspectRatio\n\t\t\t}\n\t\t}\n\n\t\treturn resizeBox(shape, info, { minWidth, minHeight })\n\t}\n\n\trender(shape: TLEmbedShape) {\n\t\tconst { w, h, url } = shape.props\n\t\tconst isEditing = useIsEditing(shape.id)\n\t\tconst embedInfo = useMemo(() => getEmbedInfoUnsafely(url), [url])\n\n\t\tconst isHoveringWhileEditingSameShape = useValue(\n\t\t\t'is hovering',\n\t\t\t() => {\n\t\t\t\tconst { editingId, hoveredId } = this.app.pageState\n\n\t\t\t\tif (editingId && hoveredId !== editingId) {\n\t\t\t\t\tconst editingShape = this.app.getShapeById(editingId)\n\t\t\t\t\tif (editingShape && editingShape.type === 'embed') {\n\t\t\t\t\t\treturn true\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false\n\t\t\t},\n\t\t\t[]\n\t\t)\n\n\t\tconst pageRotation = this.app.getPageRotation(shape)\n\n\t\tconst isInteractive = isEditing || isHoveringWhileEditingSameShape\n\n\t\tif (embedInfo?.definition.type === 'github_gist') {\n\t\t\tconst idFromGistUrl = embedInfo.url.split('/').pop()\n\t\t\tif (idFromGistUrl) {\n\t\t\t\treturn (\n\t\t\t\t\t<HTMLContainer className=\"rs-embed-container\" id={shape.id}>\n\t\t\t\t\t\t<Gist\n\t\t\t\t\t\t\tid={idFromGistUrl}\n\t\t\t\t\t\t\twidth={toDomPrecision(w)!}\n\t\t\t\t\t\t\theight={toDomPrecision(h)!}\n\t\t\t\t\t\t\tisInteractive={isInteractive}\n\t\t\t\t\t\t\tpageRotation={pageRotation}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</HTMLContainer>\n\t\t\t\t)\n\t\t\t}\n\t\t}\n\n\t\tconst sandbox = getSandboxPermissions({\n\t\t\t...tlEmbedShapePermissionDefaults,\n\t\t\t...(embedInfo?.definition.overridePermissions ?? {}),\n\t\t})\n\n\t\treturn (\n\t\t\t<HTMLContainer className=\"rs-embed-container\" id={shape.id}>\n\t\t\t\t{embedInfo?.definition ? (\n\t\t\t\t\t<iframe\n\t\t\t\t\t\tclassName={`rs-embed rs-embed-${shape.id}`}\n\t\t\t\t\t\tsandbox={sandbox}\n\t\t\t\t\t\tsrc={embedInfo.embedUrl}\n\t\t\t\t\t\twidth={toDomPrecision(w)}\n\t\t\t\t\t\theight={toDomPrecision(h)}\n\t\t\t\t\t\tdraggable={false}\n\t\t\t\t\t\tframeBorder=\"0\"\n\t\t\t\t\t\treferrerPolicy=\"no-referrer-when-downgrade\"\n\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\tborder: 0,\n\t\t\t\t\t\t\tpointerEvents: isInteractive ? 'auto' : 'none',\n\t\t\t\t\t\t\t// Fix for safari <https://stackoverflow.com/a/49150908>\n\t\t\t\t\t\t\tzIndex: isInteractive ? '' : '-1',\n\t\t\t\t\t\t\tboxShadow: rotateBoxShadow(pageRotation, ROTATING_SHADOWS),\n\t\t\t\t\t\t\tborderRadius: embedInfo?.definition.overrideOutlineRadius ?? 8,\n\t\t\t\t\t\t\tbackground: embedInfo?.definition.backgroundColor,\n\t\t\t\t\t\t}}\n\t\t\t\t\t/>\n\t\t\t\t) : (\n\t\t\t\t\t<Spinner x={(w - 38) / 2} y={(h - 38) / 2} />\n\t\t\t\t)}\n\t\t\t</HTMLContainer>\n\t\t)\n\t}\n\n\tindicator(shape: TLEmbedShape) {\n\t\tconst embedInfo = useMemo(() => getEmbedInfo(shape.props.url), [shape.props.url])\n\t\treturn (\n\t\t\t<rect\n\t\t\t\twidth={toDomPrecision(shape.props.w)}\n\t\t\t\theight={toDomPrecision(shape.props.h)}\n\t\t\t\trx={embedInfo?.definition.overrideOutlineRadius ?? 8}\n\t\t\t\try={embedInfo?.definition.overrideOutlineRadius ?? 8}\n\t\t\t/>\n\t\t)\n\t}\n}\n\nfunction Gist({\n\tid,\n\tfile,\n\tisInteractive,\n\twidth,\n\theight,\n\tstyle,\n\tpageRotation,\n}: {\n\tid: string\n\tfile?: string\n\tisInteractive: boolean\n\twidth: number\n\theight: number\n\tpageRotation: number\n\tstyle?: React.CSSProperties\n}) {\n\tconst rIframe = React.useRef<HTMLIFrameElement>(null)\n\n\tconst fileArg = file ? `?file=${file}` : ''\n\tconst gistLink = `https://gist.github.com/${id}.js${fileArg}`\n\n\treturn (\n\t\t<iframe\n\t\t\tref={rIframe}\n\t\t\tclassName=\"rs-embed\"\n\t\t\tdraggable={false}\n\t\t\twidth={toDomPrecision(width)}\n\t\t\theight={toDomPrecision(height)}\n\t\t\tframeBorder=\"0\"\n\t\t\tscrolling=\"no\"\n\t\t\tseamless\n\t\t\treferrerPolicy=\"no-referrer-when-downgrade\"\n\t\t\tstyle={{\n\t\t\t\t...style,\n\t\t\t\tpointerEvents: isInteractive ? 'all' : 'none',\n\t\t\t\t// Fix for safari <https://stackoverflow.com/a/49150908>\n\t\t\t\tzIndex: isInteractive ? '' : '-1',\n\t\t\t\tboxShadow: rotateBoxShadow(pageRotation, ROTATING_SHADOWS),\n\t\t\t}}\n\t\t\tsrcDoc={`\n\t\t\t<html>\n\t\t\t\t<head>\n\t\t\t\t\t<base target=\"_blank\">\n\t\t\t\t</head>\n\t\t\t\t<body>\n\t\t\t\t\t<script src=${gistLink}></script>\n\t\t\t\t\t<style type=\"text/css\">\n\t\t\t\t\t\t* { margin: 0px; }\n\t\t\t\t\t\ttable { height: 100%; background-color: red; }\n\t\t\t\t\t\t.gist { background-color: none; height: 100%;  }\n\t\t\t\t\t\t.gist .gist-file { height: calc(100vh - 2px); padding: 0px; display: grid; grid-template-rows: 1fr auto; }\n\t\t\t\t\t</style>\n\t\t\t\t</body>\n\t\t\t</html>`}\n\t\t/>\n\t)\n}\n\n/** @public */\nexport const TLEmbedShapeDef = defineShape<TLEmbedShape, TLEmbedUtil>({\n\ttype: 'embed',\n\tgetShapeUtil: () => TLEmbedUtil,\n\tvalidator: embedShapeTypeValidator,\n\tmigrations: embedShapeMigrations,\n})\n","import { TLFrameShape, TLShapeId } from '@tldraw/tlschema'\nimport { forwardRef, useCallback } from 'react'\nimport { useApp } from '../../../../hooks'\nimport { defaultEmptyAs } from '../../../../utils'\n\nexport const FrameLabelInput = forwardRef<\n\tHTMLInputElement,\n\t{ id: TLShapeId; name: string; isEditing: boolean }\n>(({ id, name, isEditing }, ref) => {\n\tconst app = useApp()\n\n\tconst handleKeyDown = useCallback(\n\t\t(e: React.KeyboardEvent<HTMLInputElement>) => {\n\t\t\tif (e.key === 'Enter') {\n\t\t\t\t// need to prevent the enter keydown making it's way up to the Idle state\n\t\t\t\t// and sending us back into edit mode\n\t\t\t\te.stopPropagation()\n\t\t\t\te.currentTarget.blur()\n\t\t\t\tapp.setEditingId(null)\n\t\t\t}\n\t\t},\n\t\t[app]\n\t)\n\n\tconst handleBlur = useCallback(\n\t\t(e: React.FocusEvent<HTMLInputElement>) => {\n\t\t\tconst shape = app.getShapeById<TLFrameShape>(id)\n\t\t\tif (!shape) return\n\n\t\t\tconst name = shape.props.name\n\t\t\tconst value = e.currentTarget.value.trim()\n\t\t\tif (name === value) return\n\n\t\t\tapp.updateShapes(\n\t\t\t\t[\n\t\t\t\t\t{\n\t\t\t\t\t\tid,\n\t\t\t\t\t\ttype: 'frame',\n\t\t\t\t\t\tprops: { name: value },\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\ttrue\n\t\t\t)\n\t\t},\n\t\t[id, app]\n\t)\n\n\tconst handleChange = useCallback(\n\t\t(e: React.ChangeEvent<HTMLInputElement>) => {\n\t\t\tconst shape = app.getShapeById<TLFrameShape>(id)\n\t\t\tif (!shape) return\n\n\t\t\tconst name = shape.props.name\n\t\t\tconst value = e.currentTarget.value\n\t\t\tif (name === value) return\n\n\t\t\tapp.updateShapes(\n\t\t\t\t[\n\t\t\t\t\t{\n\t\t\t\t\t\tid,\n\t\t\t\t\t\ttype: 'frame',\n\t\t\t\t\t\tprops: { name: value },\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\ttrue\n\t\t\t)\n\t\t},\n\t\t[id, app]\n\t)\n\n\treturn (\n\t\t<div className={`rs-frame-label ${isEditing ? 'rs-frame-label__editing' : ''}`}>\n\t\t\t<input\n\t\t\t\tclassName=\"rs-frame-name-input\"\n\t\t\t\tref={ref}\n\t\t\t\tstyle={{ display: isEditing ? undefined : 'none' }}\n\t\t\t\tvalue={name}\n\t\t\t\tautoFocus\n\t\t\t\tonKeyDown={handleKeyDown}\n\t\t\t\tonBlur={handleBlur}\n\t\t\t\tonChange={handleChange}\n\t\t\t/>\n\t\t\t{defaultEmptyAs(name, 'Frame') + String.fromCharCode(8203)}\n\t\t</div>\n\t)\n})\n","import { canolicalizeRotation, SelectionEdge, toDomPrecision } from '@tldraw/primitives'\nimport { TLShapeId } from '@tldraw/tlschema'\nimport { useEffect, useRef } from 'react'\nimport { track } from 'signia-react'\nimport { useApp, useIsEditing } from '../../../../hooks'\nimport { FrameLabelInput } from './FrameLabelInput'\n\nexport const FrameHeading = track(function FrameHeading({\n\tid,\n\tname,\n\twidth,\n\theight,\n}: {\n\tid: TLShapeId\n\tname: string\n\twidth: number\n\theight: number\n}) {\n\tconst app = useApp()\n\n\tconst pageRotation = canolicalizeRotation(app.getPageRotationById(id))\n\tconst isEditing = useIsEditing(id)\n\n\tconst rInput = useRef<HTMLInputElement>(null)\n\n\tuseEffect(() => {\n\t\tconst el = rInput.current\n\t\tif (el && isEditing) {\n\t\t\t// On iOS, we must focus here\n\t\t\tel.focus()\n\t\t\tel.select()\n\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\t// On desktop, the input may have lost focus, so try try try again!\n\t\t\t\tif (document.activeElement !== el) {\n\t\t\t\t\tel.focus()\n\t\t\t\t\tel.select()\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\t}, [rInput, isEditing])\n\n\t// rotate right 45 deg\n\tconst offsetRotation = pageRotation + Math.PI / 4\n\tconst scaledRotation = (offsetRotation * (2 / Math.PI) + 4) % 4\n\tconst labelSide: SelectionEdge = (['top', 'left', 'bottom', 'right'] as const)[\n\t\tMath.floor(scaledRotation)\n\t]\n\n\tlet labelTranslate: string\n\tswitch (labelSide) {\n\t\tcase 'top':\n\t\t\tlabelTranslate = ``\n\t\t\tbreak\n\t\tcase 'right':\n\t\t\tlabelTranslate = `translate(${toDomPrecision(width)}px, 0px) rotate(90deg)`\n\t\t\tbreak\n\t\tcase 'bottom':\n\t\t\tlabelTranslate = `translate(${toDomPrecision(width)}px, ${toDomPrecision(\n\t\t\t\theight\n\t\t\t)}px) rotate(180deg)`\n\t\t\tbreak\n\t\tcase 'left':\n\t\t\tlabelTranslate = `translate(0px, ${toDomPrecision(height)}px) rotate(270deg)`\n\t\t\tbreak\n\t}\n\n\treturn (\n\t\t<div\n\t\t\tclassName=\"rs-frame-heading\"\n\t\t\tstyle={{\n\t\t\t\toverflow: isEditing ? 'visible' : 'hidden',\n\t\t\t\tmaxWidth: `calc(var(--rs-zoom) * ${\n\t\t\t\t\tlabelSide === 'top' || labelSide === 'bottom' ? Math.ceil(width) : Math.ceil(height)\n\t\t\t\t}px + var(--space-5))`,\n\t\t\t\tbottom: Math.ceil(height),\n\t\t\t\ttransform: `${labelTranslate} scale(var(--rs-scale)) translateX(calc(-1 * var(--space-3))`,\n\t\t\t}}\n\t\t>\n\t\t\t<div className=\"rs-frame-heading-hit-area\">\n\t\t\t\t<FrameLabelInput ref={rInput} id={id} name={name} isEditing={isEditing} />\n\t\t\t</div>\n\t\t</div>\n\t)\n})\n","import { canolicalizeRotation, SelectionEdge, toDomPrecision } from '@tldraw/primitives'\nimport {\n\tframeShapeMigrations,\n\tframeShapeTypeValidator,\n\tTLFrameShape,\n\tTLShape,\n\tTLShapeId,\n\tTLShapeType,\n} from '@tldraw/tlschema'\nimport { SVGContainer } from '../../../components/SVGContainer'\nimport { defineShape } from '../../../config/TLShapeDefinition'\nimport { defaultEmptyAs } from '../../../utils'\nimport { TLExportColors } from '../shared'\nimport { TLBoxUtil } from '../TLBoxUtil'\nimport { OnResizeEndHandler } from '../TLShapeUtil'\nimport { FrameHeading } from './components/FrameHeading'\n\n/** @public */\nexport class TLFrameUtil extends TLBoxUtil<TLFrameShape> {\n\tstatic type = 'frame'\n\n\toverride canBind = () => true\n\n\toverride canEdit = () => true\n\n\toverride defaultProps(): TLFrameShape['props'] {\n\t\treturn { opacity: '1', w: 160 * 2, h: 90 * 2, name: '' }\n\t}\n\n\toverride render(shape: TLFrameShape) {\n\t\tconst bounds = this.bounds(shape)\n\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<SVGContainer>\n\t\t\t\t\t<rect className=\"rs-hitarea-stroke\" width={bounds.width} height={bounds.height} />\n\t\t\t\t\t<rect\n\t\t\t\t\t\tclassName=\"rs-frame__body\"\n\t\t\t\t\t\twidth={bounds.width}\n\t\t\t\t\t\theight={bounds.height}\n\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t/>\n\t\t\t\t</SVGContainer>\n\t\t\t\t<FrameHeading\n\t\t\t\t\tid={shape.id}\n\t\t\t\t\tname={shape.props.name}\n\t\t\t\t\twidth={bounds.width}\n\t\t\t\t\theight={bounds.height}\n\t\t\t\t/>\n\t\t\t</>\n\t\t)\n\t}\n\n\toverride toSvg(\n\t\tshape: TLFrameShape,\n\t\tfont: string,\n\t\tcolors: TLExportColors\n\t): SVGElement | Promise<SVGElement> {\n\t\tconst g = document.createElementNS('http://www.w3.org/2000/svg', 'g')\n\n\t\tconst rect = document.createElementNS('http://www.w3.org/2000/svg', 'rect')\n\t\trect.setAttribute('width', shape.props.w.toString())\n\t\trect.setAttribute('height', shape.props.h.toString())\n\t\trect.setAttribute('fill', colors.solid)\n\t\trect.setAttribute('opacity', shape.props.opacity)\n\t\trect.setAttribute('stroke', colors.fill.black)\n\t\trect.setAttribute('stroke-width', '1')\n\t\trect.setAttribute('rx', '4')\n\t\trect.setAttribute('ry', '4')\n\t\tg.appendChild(rect)\n\n\t\t// Text label\n\t\tconst pageRotation = canolicalizeRotation(this.app.getPageRotationById(shape.id))\n\t\t// rotate right 45 deg\n\t\tconst offsetRotation = pageRotation + Math.PI / 4\n\t\tconst scaledRotation = (offsetRotation * (2 / Math.PI) + 4) % 4\n\t\tconst labelSide: SelectionEdge = (['top', 'left', 'bottom', 'right'] as const)[\n\t\t\tMath.floor(scaledRotation)\n\t\t]\n\n\t\tlet labelTranslate: string\n\t\tswitch (labelSide) {\n\t\t\tcase 'top':\n\t\t\t\tlabelTranslate = ``\n\t\t\t\tbreak\n\t\t\tcase 'right':\n\t\t\t\tlabelTranslate = `translate(${toDomPrecision(shape.props.w)}px, 0px) rotate(90deg)`\n\t\t\t\tbreak\n\t\t\tcase 'bottom':\n\t\t\t\tlabelTranslate = `translate(${toDomPrecision(shape.props.w)}px, ${toDomPrecision(\n\t\t\t\t\tshape.props.h\n\t\t\t\t)}px) rotate(180deg)`\n\t\t\t\tbreak\n\t\t\tcase 'left':\n\t\t\t\tlabelTranslate = `translate(0px, ${toDomPrecision(shape.props.h)}px) rotate(270deg)`\n\t\t\t\tbreak\n\t\t\tdefault:\n\t\t\t\tlabelTranslate = ``\n\t\t}\n\n\t\t// Truncate with ellipsis\n\t\tconst opts = {\n\t\t\tfontSize: 12,\n\t\t\tfontFamily: 'Inter, sans-serif',\n\t\t\ttextAlign: 'start' as const,\n\t\t\twidth: shape.props.w + 16,\n\t\t\theight: 30,\n\t\t\tpadding: 8,\n\t\t\tlineHeight: 1,\n\t\t\tfontStyle: 'normal',\n\t\t\tfontWeight: 'normal',\n\t\t}\n\n\t\tlet textContent = defaultEmptyAs(shape.props.name, 'Frame') + String.fromCharCode(8203)\n\n\t\tconst lines = this.app.textMeasure.getTextLines({\n\t\t\ttext: textContent,\n\t\t\twrap: true,\n\t\t\t...opts,\n\t\t})\n\n\t\ttextContent = lines.length > 1 ? lines[0] + '' : lines[0]\n\n\t\tconst size = this.app.textMeasure.measureText({\n\t\t\tfontSize: 12,\n\t\t\tfontFamily: 'Inter, sans-serif',\n\t\t\tlineHeight: 1,\n\t\t\tfontStyle: 'normal',\n\t\t\tfontWeight: 'normal',\n\t\t\ttext: textContent,\n\t\t\twidth: 'fit-content',\n\t\t\tmaxWidth: 'unset',\n\t\t\tpadding: '0px',\n\t\t})\n\n\t\tconst text = document.createElementNS('http://www.w3.org/2000/svg', 'text')\n\t\ttext.setAttribute('x', '0')\n\t\ttext.setAttribute('y', -(8 + size.h / 2) + 'px')\n\t\ttext.setAttribute('font-family', '\"Inter\", sans-serif')\n\t\ttext.setAttribute('font-size', '12px')\n\t\ttext.setAttribute('font-weight', '400')\n\t\ttext.style.setProperty('transform', labelTranslate)\n\t\ttext.textContent = textContent\n\n\t\tconst textBg = document.createElementNS('http://www.w3.org/2000/svg', 'rect')\n\t\ttextBg.setAttribute('x', ' -4px')\n\t\ttextBg.setAttribute('y', -(16 + size.h) + 'px')\n\t\ttextBg.setAttribute('width', size.w + 8 + 'px')\n\t\ttextBg.setAttribute('height', size.h + 8 + 'px')\n\t\ttextBg.setAttribute('rx', 4 + 'px')\n\t\ttextBg.setAttribute('ry', 4 + 'px')\n\t\ttextBg.setAttribute('fill', colors.background)\n\n\t\tg.appendChild(textBg)\n\t\tg.appendChild(text)\n\n\t\treturn g\n\t}\n\n\tindicator(shape: TLFrameShape) {\n\t\tconst bounds = this.bounds(shape)\n\n\t\treturn (\n\t\t\t<rect\n\t\t\t\twidth={toDomPrecision(bounds.width)}\n\t\t\t\theight={toDomPrecision(bounds.height)}\n\t\t\t\tclassName={`rs-frame-indicator`}\n\t\t\t/>\n\t\t)\n\t}\n\n\toverride canReceiveNewChildrenOfType = (_type: TLShapeType) => {\n\t\treturn true\n\t}\n\n\toverride canDropShapes = (_shape: TLFrameShape, _shapes: TLShape[]): boolean => {\n\t\treturn true\n\t}\n\n\toverride onDragShapesOver = (frame: TLFrameShape, shapes: TLShape[]): { shouldHint: boolean } => {\n\t\tif (!shapes.every((child) => child.parentId === frame.id)) {\n\t\t\tthis.app.reparentShapesById(\n\t\t\t\tshapes.map((shape) => shape.id),\n\t\t\t\tframe.id\n\t\t\t)\n\t\t\treturn { shouldHint: true }\n\t\t}\n\t\treturn { shouldHint: false }\n\t}\n\n\tonDragShapesOut = (_shape: TLFrameShape, shapes: TLShape[]): void => {\n\t\tconst parentId = this.app.getShapeById(_shape.parentId)\n\t\tconst isInGroup = parentId?.type === 'group'\n\n\t\t// If frame is in a group, keep the shape\n\t\t// moved out in that group\n\t\tif (isInGroup) {\n\t\t\tthis.app.reparentShapesById(\n\t\t\t\tshapes.map((shape) => shape.id),\n\t\t\t\tparentId.id\n\t\t\t)\n\t\t} else {\n\t\t\tthis.app.reparentShapesById(\n\t\t\t\tshapes.map((shape) => shape.id),\n\t\t\t\tthis.app.currentPageId\n\t\t\t)\n\t\t}\n\t}\n\n\toverride onResizeEnd: OnResizeEndHandler<TLFrameShape> = (shape) => {\n\t\tconst bounds = this.app.getPageBounds(shape)!\n\t\tconst children = this.app.getSortedChildIds(shape.id)\n\n\t\tconst shapesToReparent: TLShapeId[] = []\n\n\t\tfor (const childId of children) {\n\t\t\tconst childBounds = this.app.getPageBoundsById(childId)!\n\t\t\tif (!bounds.includes(childBounds)) {\n\t\t\t\tshapesToReparent.push(childId)\n\t\t\t}\n\t\t}\n\n\t\tif (shapesToReparent.length > 0) {\n\t\t\tthis.app.reparentShapesById(shapesToReparent, this.app.currentPageId)\n\t\t}\n\t}\n}\n\n/** @public */\nexport const TLFrameShapeDef = defineShape<TLFrameShape, TLFrameUtil>({\n\ttype: 'frame',\n\tgetShapeUtil: () => TLFrameUtil,\n\tvalidator: frameShapeTypeValidator,\n\tmigrations: frameShapeMigrations,\n})\n","import { TLAlignType, TLFillType, TLFontType, TLShape, TLSizeType } from '@tldraw/tlschema'\nimport React from 'react'\nimport { stopEventPropagation } from '.'\nimport { LABEL_FONT_SIZES, TEXT_PROPS } from '../../../constants'\nimport { TextHelpers } from '../TLTextUtil/TextHelpers'\nimport { useEditableText } from './useEditableText'\n\nexport const TextLabel = React.memo(function TextLabel<\n\tT extends Extract<TLShape, { props: { text: string } }>\n>({\n\tid,\n\ttype,\n\ttext,\n\tsize,\n\tlabelColor,\n\tfont,\n\talign,\n\twrap,\n}: {\n\tid: T['id']\n\ttype: T['type']\n\tsize: TLSizeType\n\tfont: TLFontType\n\tfill?: TLFillType\n\talign: TLAlignType\n\twrap?: boolean\n\ttext: string\n\tlabelColor: string\n}) {\n\tconst {\n\t\trInput,\n\t\tisEmpty,\n\t\tisEditing,\n\t\tisEditableFromHover,\n\t\thandleFocus,\n\t\thandleChange,\n\t\thandleKeyDown,\n\t\thandleBlur,\n\t} = useEditableText(id, type, text)\n\n\tconst isInteractive = isEditing || isEditableFromHover\n\n\treturn (\n\t\t<div\n\t\t\tclassName=\"rs-text-label\"\n\t\t\tdata-font={font}\n\t\t\tdata-align={align}\n\t\t\tdata-hastext={!isEmpty}\n\t\t\tdata-isediting={isEditing}\n\t\t\tdata-textwrap={!!wrap}\n\t\t>\n\t\t\t<div\n\t\t\t\tclassName=\"rs-text-label__inner\"\n\t\t\t\tstyle={{\n\t\t\t\t\tfontSize: LABEL_FONT_SIZES[size],\n\t\t\t\t\tlineHeight: LABEL_FONT_SIZES[size] * TEXT_PROPS.lineHeight + 'px',\n\t\t\t\t\tminHeight: isEmpty ? LABEL_FONT_SIZES[size] * TEXT_PROPS.lineHeight + 32 : 0,\n\t\t\t\t\tminWidth: isEmpty ? 33 : 0,\n\t\t\t\t\tcolor: labelColor,\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<div className=\"rs-text rs-text-content\" dir=\"ltr\">\n\t\t\t\t\t{TextHelpers.normalizeTextForDom(text)}\n\t\t\t\t</div>\n\t\t\t\t{isInteractive ? (\n\t\t\t\t\t// Consider replacing with content-editable\n\t\t\t\t\t<textarea\n\t\t\t\t\t\tref={rInput}\n\t\t\t\t\t\tclassName=\"rs-text rs-text-input\"\n\t\t\t\t\t\tname=\"text\"\n\t\t\t\t\t\ttabIndex={-1}\n\t\t\t\t\t\tautoComplete=\"false\"\n\t\t\t\t\t\tautoCapitalize=\"false\"\n\t\t\t\t\t\tautoCorrect=\"false\"\n\t\t\t\t\t\tautoSave=\"false\"\n\t\t\t\t\t\tautoFocus={isEditing}\n\t\t\t\t\t\tplaceholder=\"\"\n\t\t\t\t\t\tspellCheck=\"true\"\n\t\t\t\t\t\twrap=\"off\"\n\t\t\t\t\t\tdir=\"auto\"\n\t\t\t\t\t\tdatatype=\"wysiwyg\"\n\t\t\t\t\t\tdefaultValue={text}\n\t\t\t\t\t\tonFocus={handleFocus}\n\t\t\t\t\t\tonChange={handleChange}\n\t\t\t\t\t\tonKeyDown={handleKeyDown}\n\t\t\t\t\t\tonBlur={handleBlur}\n\t\t\t\t\t\tonContextMenu={stopEventPropagation}\n\t\t\t\t\t/>\n\t\t\t\t) : null}\n\t\t\t</div>\n\t\t</div>\n\t)\n})\n","import { perimeterOfEllipse, toDomPrecision } from '@tldraw/primitives'\nimport { TLGeoShape, TLShapeId } from '@tldraw/tlschema'\nimport * as React from 'react'\nimport {\n\tShapeFill,\n\tTLExportColors,\n\tgetPerfectDashProps,\n\tgetShapeFillSvg,\n\tgetSvgWithShapeFill,\n} from '../../shared'\n\nexport const DashStyleEllipse = React.memo(function DashStyleEllipse({\n\tw,\n\th,\n\tstrokeWidth: sw,\n\tdash,\n\tcolor,\n\tfill,\n}: Pick<TLGeoShape['props'], 'w' | 'h' | 'dash' | 'color' | 'fill'> & {\n\tstrokeWidth: number\n\tid: TLShapeId\n}) {\n\tconst cx = w / 2\n\tconst cy = h / 2\n\tconst rx = Math.max(0, cx - sw / 2)\n\tconst ry = Math.max(0, cy - sw / 2)\n\n\tconst perimeter = perimeterOfEllipse(rx, ry)\n\n\tconst { strokeDasharray, strokeDashoffset } = getPerfectDashProps(\n\t\tperimeter < 64 ? perimeter * 2 : perimeter,\n\t\tsw,\n\t\t{\n\t\t\tstyle: dash,\n\t\t\tsnap: 4,\n\t\t\tclosed: true,\n\t\t}\n\t)\n\n\tconst d = `M${cx - rx},${cy}a${rx},${ry},0,1,1,${rx * 2},0a${rx},${ry},0,1,1,-${rx * 2},0`\n\n\treturn (\n\t\t<>\n\t\t\t<ShapeFill d={d} color={color} fill={fill} />\n\t\t\t<path\n\t\t\t\td={d}\n\t\t\t\tstrokeWidth={sw}\n\t\t\t\twidth={toDomPrecision(w)}\n\t\t\t\theight={toDomPrecision(h)}\n\t\t\t\tfill=\"none\"\n\t\t\t\tstroke=\"currentColor\"\n\t\t\t\tstrokeDasharray={strokeDasharray}\n\t\t\t\tstrokeDashoffset={strokeDashoffset}\n\t\t\t\tpointerEvents=\"all\"\n\t\t\t/>\n\t\t</>\n\t)\n})\n\nexport function DashStyleEllipseSvg({\n\tw,\n\th,\n\tstrokeWidth: sw,\n\tdash,\n\tcolor,\n\tcolors,\n\tfill,\n}: Pick<TLGeoShape['props'], 'w' | 'h' | 'dash' | 'color' | 'fill'> & {\n\tstrokeWidth: number\n\tid: TLShapeId\n\tcolors: TLExportColors\n}) {\n\tconst cx = w / 2\n\tconst cy = h / 2\n\tconst rx = Math.max(0, cx - sw / 2)\n\tconst ry = Math.max(0, cy - sw / 2)\n\n\tconst perimeter = perimeterOfEllipse(rx, ry)\n\n\tconst { strokeDasharray, strokeDashoffset } = getPerfectDashProps(\n\t\tperimeter < 64 ? perimeter * 2 : perimeter,\n\t\tsw,\n\t\t{\n\t\t\tstyle: dash,\n\t\t\tsnap: 4,\n\t\t\tclosed: true,\n\t\t}\n\t)\n\n\tconst d = `M${cx - rx},${cy}a${rx},${ry},0,1,1,${rx * 2},0a${rx},${ry},0,1,1,-${rx * 2},0`\n\n\tconst strokeElement = document.createElementNS('http://www.w3.org/2000/svg', 'path')\n\tstrokeElement.setAttribute('d', d)\n\tstrokeElement.setAttribute('stroke-width', sw.toString())\n\tstrokeElement.setAttribute('width', w.toString())\n\tstrokeElement.setAttribute('height', h.toString())\n\tstrokeElement.setAttribute('fill', 'none')\n\tstrokeElement.setAttribute('stroke', colors.fill[color])\n\tstrokeElement.setAttribute('stroke-dasharray', strokeDasharray)\n\tstrokeElement.setAttribute('stroke-dashoffset', strokeDashoffset)\n\n\t// Get the fill element, if any\n\tconst fillElement = getShapeFillSvg({\n\t\td,\n\t\tfill,\n\t\tcolor,\n\t\tcolors,\n\t})\n\n\treturn getSvgWithShapeFill(strokeElement, fillElement)\n}\n","import { perimeterOfEllipse } from '@tldraw/primitives'\n\nexport function getOvalSolidPath(w: number, h: number) {\n\tif (h > w) {\n\t\tconst offset = w / 2\n\n\t\treturn `\n    M0,${offset}\n    a${offset},${offset},0,1,1,${offset * 2},0\n    L${w},${h - offset}\n    a${offset},${offset},0,1,1,-${offset * 2},0\n    Z`\n\t}\n\n\tconst offset = h / 2\n\n\treturn `\n    M${offset},0\n    L${w - offset},0\n    a${offset},${offset},0,1,1,0,${offset * 2}\n    L${offset},${h}\n    a${offset},${offset},0,1,1,0,${-offset * 2}\n    Z`\n}\n\nexport function getOvalPerimeter(h: number, w: number) {\n\tif (h > w) {\n\t\tconst offset = w / 2\n\t\treturn perimeterOfEllipse(offset, offset) + (h - offset * 2) * 2\n\t}\n\n\tconst offset = h / 2\n\treturn perimeterOfEllipse(offset, offset) + (w - offset * 2) * 2\n}\n","import { toDomPrecision } from '@tldraw/primitives'\nimport { TLGeoShape, TLShapeId } from '@tldraw/tlschema'\nimport * as React from 'react'\nimport {\n\tShapeFill,\n\tTLExportColors,\n\tgetPerfectDashProps,\n\tgetShapeFillSvg,\n\tgetSvgWithShapeFill,\n} from '../../shared'\nimport { getOvalPerimeter, getOvalSolidPath } from '../helpers'\n\nexport const DashStyleOval = React.memo(function DashStyleOval({\n\tw,\n\th,\n\tstrokeWidth: sw,\n\tdash,\n\tcolor,\n\tfill,\n}: Pick<TLGeoShape['props'], 'w' | 'h' | 'dash' | 'color' | 'fill'> & {\n\tstrokeWidth: number\n\tid: TLShapeId\n}) {\n\tconst d = getOvalSolidPath(w, h)\n\tconst perimeter = getOvalPerimeter(w, h)\n\n\tconst { strokeDasharray, strokeDashoffset } = getPerfectDashProps(\n\t\tperimeter < 64 ? perimeter * 2 : perimeter,\n\t\tsw,\n\t\t{\n\t\t\tstyle: dash,\n\t\t\tsnap: 4,\n\t\t\tstart: 'outset',\n\t\t\tend: 'outset',\n\t\t\tclosed: true,\n\t\t}\n\t)\n\n\treturn (\n\t\t<>\n\t\t\t<ShapeFill d={d} color={color} fill={fill} />\n\t\t\t<path\n\t\t\t\td={d}\n\t\t\t\tstrokeWidth={sw}\n\t\t\t\twidth={toDomPrecision(w)}\n\t\t\t\theight={toDomPrecision(h)}\n\t\t\t\tfill=\"none\"\n\t\t\t\tstroke=\"currentColor\"\n\t\t\t\tstrokeDasharray={strokeDasharray}\n\t\t\t\tstrokeDashoffset={strokeDashoffset}\n\t\t\t\tpointerEvents=\"all\"\n\t\t\t/>\n\t\t</>\n\t)\n})\n\nexport function DashStyleOvalSvg({\n\tw,\n\th,\n\tstrokeWidth: sw,\n\tdash,\n\tcolor,\n\tcolors,\n\tfill,\n}: Pick<TLGeoShape['props'], 'w' | 'h' | 'dash' | 'color' | 'fill'> & {\n\tstrokeWidth: number\n\tid: TLShapeId\n\tcolors: TLExportColors\n}) {\n\tconst d = getOvalSolidPath(w, h)\n\tconst perimeter = getOvalPerimeter(w, h)\n\n\tconst { strokeDasharray, strokeDashoffset } = getPerfectDashProps(\n\t\tperimeter < 64 ? perimeter * 2 : perimeter,\n\t\tsw,\n\t\t{\n\t\t\tstyle: dash,\n\t\t\tsnap: 4,\n\t\t\tclosed: true,\n\t\t}\n\t)\n\n\tconst strokeElement = document.createElementNS('http://www.w3.org/2000/svg', 'path')\n\tstrokeElement.setAttribute('d', d)\n\tstrokeElement.setAttribute('stroke-width', sw.toString())\n\tstrokeElement.setAttribute('width', w.toString())\n\tstrokeElement.setAttribute('height', h.toString())\n\tstrokeElement.setAttribute('fill', 'none')\n\tstrokeElement.setAttribute('stroke', colors.fill[color])\n\tstrokeElement.setAttribute('stroke-dasharray', strokeDasharray)\n\tstrokeElement.setAttribute('stroke-dashoffset', strokeDashoffset)\n\n\t// Get the fill element, if any\n\tconst fillElement = getShapeFillSvg({\n\t\td,\n\t\tfill,\n\t\tcolor,\n\t\tcolors,\n\t})\n\n\treturn getSvgWithShapeFill(strokeElement, fillElement)\n}\n","import { Vec2d, VecLike } from '@tldraw/primitives'\nimport { TLGeoShape } from '@tldraw/tlschema'\nimport * as React from 'react'\nimport {\n\tShapeFill,\n\tTLExportColors,\n\tgetPerfectDashProps,\n\tgetShapeFillSvg,\n\tgetSvgWithShapeFill,\n} from '../../shared'\n\nexport const DashStylePolygon = React.memo(function DashStylePolygon({\n\tdash,\n\tfill,\n\tcolor,\n\tstrokeWidth,\n\toutline,\n\tbgOutline,\n}: Pick<TLGeoShape['props'], 'dash' | 'fill' | 'color'> & {\n\toutline: VecLike[]\n\tstrokeWidth: number\n\tbgOutline?: VecLike[]\n}) {\n\tconst innerPath = bgOutline\n\t\t? 'M' + bgOutline[0] + 'L' + bgOutline.slice(1) + 'Z'\n\t\t: 'M' + outline[0] + 'L' + outline.slice(1) + 'Z'\n\n\treturn (\n\t\t<>\n\t\t\t<ShapeFill d={innerPath} fill={fill} color={color} />\n\t\t\t<g strokeWidth={strokeWidth} stroke=\"currentColor\" fill=\"none\" pointerEvents=\"all\">\n\t\t\t\t{Array.from(Array(outline.length)).map((_, i) => {\n\t\t\t\t\tconst A = outline[i]\n\t\t\t\t\tconst B = outline[(i + 1) % outline.length]\n\n\t\t\t\t\tconst dist = Vec2d.Dist(A, B)\n\n\t\t\t\t\tconst { strokeDasharray, strokeDashoffset } = getPerfectDashProps(dist, strokeWidth, {\n\t\t\t\t\t\tstyle: dash,\n\t\t\t\t\t\tstart: 'outset',\n\t\t\t\t\t\tend: 'outset',\n\t\t\t\t\t})\n\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<line\n\t\t\t\t\t\t\tkey={i}\n\t\t\t\t\t\t\tx1={A.x}\n\t\t\t\t\t\t\ty1={A.y}\n\t\t\t\t\t\t\tx2={B.x}\n\t\t\t\t\t\t\ty2={B.y}\n\t\t\t\t\t\t\tstrokeDasharray={strokeDasharray}\n\t\t\t\t\t\t\tstrokeDashoffset={strokeDashoffset}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)\n\t\t\t\t})}\n\t\t\t</g>\n\t\t</>\n\t)\n})\n\nexport function DashStylePolygonSvg({\n\tdash,\n\tfill,\n\tcolor,\n\tcolors,\n\tstrokeWidth,\n\toutline,\n\tbgOutline,\n}: Pick<TLGeoShape['props'], 'dash' | 'fill' | 'color'> & {\n\toutline: VecLike[]\n\tstrokeWidth: number\n\tcolors: TLExportColors\n\tbgOutline?: VecLike[]\n}) {\n\tconst strokeElement = document.createElementNS('http://www.w3.org/2000/svg', 'g')\n\tstrokeElement.setAttribute('stroke-width', strokeWidth.toString())\n\tstrokeElement.setAttribute('stroke', colors.fill[color])\n\tstrokeElement.setAttribute('fill', 'none')\n\n\tArray.from(Array(outline.length)).forEach((_, i) => {\n\t\tconst A = outline[i]\n\t\tconst B = outline[(i + 1) % outline.length]\n\n\t\tconst dist = Vec2d.Dist(A, B)\n\t\tconst { strokeDasharray, strokeDashoffset } = getPerfectDashProps(dist, strokeWidth, {\n\t\t\tstyle: dash,\n\t\t})\n\n\t\tconst line = document.createElementNS('http://www.w3.org/2000/svg', 'line')\n\t\tline.setAttribute('x1', A.x.toString())\n\t\tline.setAttribute('y1', A.y.toString())\n\t\tline.setAttribute('x2', B.x.toString())\n\t\tline.setAttribute('y2', B.y.toString())\n\t\tline.setAttribute('stroke-dasharray', strokeDasharray.toString())\n\t\tline.setAttribute('stroke-dashoffset', strokeDashoffset.toString())\n\n\t\tstrokeElement.appendChild(line)\n\t})\n\n\t// Get the fill element, if any\n\tconst fillElement = getShapeFillSvg({\n\t\td: bgOutline\n\t\t\t? 'M' + bgOutline[0] + 'L' + bgOutline.slice(1) + 'Z'\n\t\t\t: 'M' + outline[0] + 'L' + outline.slice(1) + 'Z',\n\t\tfill,\n\t\tcolor,\n\t\tcolors,\n\t})\n\n\treturn getSvgWithShapeFill(strokeElement, fillElement)\n}\n","import {\n\tEASINGS,\n\tgetStrokeOutlinePoints,\n\tgetStrokePoints,\n\tperimeterOfEllipse,\n\tPI2,\n\tsetStrokePointRadii,\n\tTAU,\n\tVec2d,\n} from '@tldraw/primitives'\nimport { TLGeoShape, TLShapeId } from '@tldraw/tlschema'\nimport { rng } from '@tldraw/utils'\nimport * as React from 'react'\nimport { getSvgPathFromStroke, getSvgPathFromStrokePoints } from '../../../../utils'\nimport { getShapeFillSvg, getSvgWithShapeFill, ShapeFill, TLExportColors } from '../../shared'\n\nexport const DrawStyleEllipse = React.memo(function DrawStyleEllipse({\n\tid,\n\tw,\n\th,\n\tstrokeWidth: sw,\n\tfill,\n\tcolor,\n}: Pick<TLGeoShape['props'], 'w' | 'h' | 'fill' | 'color'> & {\n\tstrokeWidth: number\n\tid: TLShapeId\n}) {\n\tconst innerPath = getEllipseIndicatorPath(id, w, h, sw)\n\tconst outerPath = getEllipsePath(id, w, h, sw)\n\n\treturn (\n\t\t<>\n\t\t\t<ShapeFill d={innerPath} color={color} fill={fill} />\n\t\t\t<path d={outerPath} fill=\"currentColor\" strokeWidth={0} pointerEvents=\"all\" />\n\t\t</>\n\t)\n})\n\nexport function DrawStyleEllipseSvg({\n\tid,\n\tw,\n\th,\n\tstrokeWidth: sw,\n\tfill,\n\tcolor,\n\tcolors,\n}: Pick<TLGeoShape['props'], 'w' | 'h' | 'fill' | 'color'> & {\n\tstrokeWidth: number\n\tid: TLShapeId\n\tcolors: TLExportColors\n}) {\n\tconst strokeElement = document.createElementNS('http://www.w3.org/2000/svg', 'path')\n\tstrokeElement.setAttribute('d', getEllipsePath(id, w, h, sw))\n\tstrokeElement.setAttribute('fill', colors.fill[color])\n\n\t// Get the fill element, if any\n\tconst fillElement = getShapeFillSvg({\n\t\td: getEllipseIndicatorPath(id, w, h, sw),\n\t\tfill,\n\t\tcolor,\n\t\tcolors,\n\t})\n\n\treturn getSvgWithShapeFill(strokeElement, fillElement)\n}\n\nexport function getEllipseStrokeOptions(strokeWidth: number) {\n\treturn {\n\t\tsize: 1 + strokeWidth,\n\t\tthinning: 0.25,\n\t\tend: { taper: strokeWidth },\n\t\tstart: { taper: strokeWidth },\n\t\tstreamline: 0,\n\t\tsmoothing: 1,\n\t\tsimulatePressure: false,\n\t}\n}\n\nexport function getEllipseStrokePoints(\n\tid: string,\n\twidth: number,\n\theight: number,\n\tstrokeWidth: number\n) {\n\tconst getRandom = rng(id)\n\n\tconst rx = width / 2\n\tconst ry = height / 2\n\tconst perimeter = perimeterOfEllipse(rx, ry)\n\n\tconst points: Vec2d[] = []\n\n\tconst start = PI2 * getRandom()\n\tconst length = PI2 + TAU / 2 + Math.abs(getRandom()) * TAU\n\tconst count = Math.max(16, perimeter / 10)\n\n\tfor (let i = 0; i < count; i++) {\n\t\tconst t = i / (count - 1)\n\t\tconst r = start + t * length\n\t\tconst c = Math.cos(r)\n\t\tconst s = Math.sin(r)\n\t\tpoints.push(\n\t\t\tnew Vec2d(\n\t\t\t\trx * c + width * 0.5 + 0.05 * getRandom(),\n\t\t\t\try * s + height / 2 + 0.05 * getRandom(),\n\t\t\t\tMath.min(\n\t\t\t\t\t1,\n\t\t\t\t\t0.5 +\n\t\t\t\t\t\tMath.abs(0.5 - (getRandom() > 0 ? EASINGS.easeInOutSine(t) : EASINGS.easeInExpo(t))) / 2\n\t\t\t\t)\n\t\t\t)\n\t\t)\n\t}\n\n\treturn getStrokePoints(points, getEllipseStrokeOptions(strokeWidth))\n}\n\nexport function getEllipsePath(id: string, width: number, height: number, strokeWidth: number) {\n\tconst options = getEllipseStrokeOptions(strokeWidth)\n\treturn getSvgPathFromStroke(\n\t\tgetStrokeOutlinePoints(\n\t\t\tsetStrokePointRadii(getEllipseStrokePoints(id, width, height, strokeWidth), options),\n\t\t\toptions\n\t\t)\n\t)\n}\n\nexport function getEllipseIndicatorPath(\n\tid: string,\n\twidth: number,\n\theight: number,\n\tstrokeWidth: number\n) {\n\treturn getSvgPathFromStrokePoints(getEllipseStrokePoints(id, width, height, strokeWidth))\n}\n","import { getStroke, getStrokePoints, Vec2d, VecLike } from '@tldraw/primitives'\nimport { TLGeoShape } from '@tldraw/tlschema'\nimport { rng } from '@tldraw/utils'\nimport * as React from 'react'\nimport { getSvgPathFromStroke, getSvgPathFromStrokePoints } from '../../../../utils'\nimport { getShapeFillSvg, getSvgWithShapeFill, ShapeFill, TLExportColors } from '../../shared'\n\nexport const DrawStylePolygon = React.memo(function DrawStylePolygon({\n\tid,\n\tbgOutline,\n\toutline,\n\tfill,\n\tcolor,\n\tstrokeWidth,\n}: Pick<TLGeoShape['props'], 'fill' | 'color'> & {\n\tid: TLGeoShape['id']\n\toutline: VecLike[]\n\tstrokeWidth: number\n\tbgOutline?: VecLike[]\n}) {\n\tconst points = getPolygonDrawPoints(id, outline, strokeWidth)\n\tconst options = getPolygonStrokeOptions(strokeWidth)\n\tconst strokePoints = getStrokePoints(points, options)\n\n\tconst innerPath = getSvgPathFromStrokePoints(\n\t\tbgOutline\n\t\t\t? getStrokePoints(getPolygonDrawPoints(id, bgOutline, strokeWidth), options)\n\t\t\t: strokePoints,\n\t\tfalse\n\t)\n\tconst outerPath = getSvgPathFromStroke(getStroke(points, options))\n\n\treturn (\n\t\t<>\n\t\t\t<ShapeFill d={innerPath} fill={fill} color={color} />\n\t\t\t<path d={outerPath} fill=\"currentColor\" pointerEvents=\"all\" />\n\t\t</>\n\t)\n})\n\nexport function DrawStylePolygonSvg({\n\tid,\n\toutline,\n\tbgOutline,\n\tfill,\n\tcolor,\n\tcolors,\n\tstrokeWidth,\n}: Pick<TLGeoShape['props'], 'fill' | 'color'> & {\n\tid: TLGeoShape['id']\n\toutline: VecLike[]\n\tbgOutline?: VecLike[]\n\tstrokeWidth: number\n\tcolors: TLExportColors\n}) {\n\tconst points = getPolygonDrawPoints(id, outline, strokeWidth)\n\tconst options = getPolygonStrokeOptions(strokeWidth)\n\n\tconst strokeElement = document.createElementNS('http://www.w3.org/2000/svg', 'path')\n\tstrokeElement.setAttribute('d', getSvgPathFromStroke(getStroke(points, options), true))\n\tstrokeElement.setAttribute('fill', colors.fill[color])\n\n\t// Get the fill element, if any\n\tconst fillElement = getShapeFillSvg({\n\t\td: getSvgPathFromStrokePoints(\n\t\t\tgetStrokePoints(\n\t\t\t\tbgOutline ? getPolygonDrawPoints(id, bgOutline, strokeWidth) : points,\n\t\t\t\toptions\n\t\t\t),\n\t\t\tfalse\n\t\t),\n\t\tfill,\n\t\tcolor,\n\t\tcolors,\n\t})\n\n\treturn getSvgWithShapeFill(strokeElement, fillElement)\n}\n\nexport function getPolygonDrawPoints(id: string, outline: VecLike[], strokeWidth: number) {\n\tconst points: Vec2d[] = []\n\n\tconst getRandom = rng(id)\n\n\tconst start = Math.round(Math.abs(getRandom()) * outline.length)\n\n\tconst corners = outline.map((p) =>\n\t\tVec2d.AddXY(p, (getRandom() * strokeWidth) / 4, (getRandom() * strokeWidth) / 4)\n\t)\n\n\tconst len = corners.length\n\n\tfor (let i = 0, n = len + 1; i < n; i++) {\n\t\tconst At = corners[(start + i) % len]\n\t\tconst Bt = corners[(start + i + 1) % len]\n\n\t\tconst dist = Math.min(Vec2d.Dist(At, Bt) / 2, strokeWidth / 2)\n\t\tconst A = Vec2d.Nudge(At, Bt, dist)\n\n\t\tconst D = Vec2d.Med(At, Bt)\n\n\t\tif (i === 0) {\n\t\t\tBt.z = 0.7\n\t\t\tpoints.push(new Vec2d(D.x, D.y, 0.7), Bt)\n\t\t} else if (i === outline.length) {\n\t\t\tconst lastSegPoints = Vec2d.PointsBetween(A, D, 4)\n\t\t\tlastSegPoints.forEach((p) => (p.z = 0.7))\n\t\t\tpoints.push(...lastSegPoints)\n\t\t} else {\n\t\t\tpoints.push(...Vec2d.PointsBetween(A, Bt, 6))\n\t\t}\n\t}\n\n\treturn points\n}\n\nexport function getBoringPolygonDrawPoints(id: string, outline: VecLike[]) {\n\tconst points: VecLike[] = []\n\n\tconst getRandom = rng(id)\n\tfor (let i = 0, n = outline.length; i < n; i++) {\n\t\tconst A = outline[i]\n\t\tpoints.push(Vec2d.AddXY(A, getRandom() / 2, getRandom() / 2))\n\t}\n\n\treturn points\n}\n\nexport function getPolygonIndicatorPath(id: string, outline: VecLike[], strokeWidth: number) {\n\tconst points = getPolygonDrawPoints(id, outline, strokeWidth)\n\tconst options = getPolygonStrokeOptions(strokeWidth)\n\tconst strokePoints = getStrokePoints(points, options)\n\n\treturn getSvgPathFromStrokePoints(strokePoints, true)\n}\n\nfunction getPolygonStrokeOptions(strokeWidth: number) {\n\treturn {\n\t\tsize: 1 + strokeWidth * 0.618,\n\t\tlast: true,\n\t\tsimulatePressure: false,\n\t\tstreamline: 0.25,\n\t\tthinning: 0.9,\n\t}\n}\n","import { TLGeoShape } from '@tldraw/tlschema'\nimport * as React from 'react'\nimport { getShapeFillSvg, getSvgWithShapeFill, ShapeFill, TLExportColors } from '../../shared'\n\nexport const SolidStyleEllipse = React.memo(function SolidStyleEllipse({\n\tw,\n\th,\n\tstrokeWidth: sw,\n\tfill,\n\tcolor,\n}: Pick<TLGeoShape['props'], 'w' | 'h' | 'fill' | 'color'> & { strokeWidth: number }) {\n\tconst cx = w / 2\n\tconst cy = h / 2\n\tconst rx = Math.max(0, cx)\n\tconst ry = Math.max(0, cy)\n\n\tconst d = `M${cx - rx},${cy}a${rx},${ry},0,1,1,${rx * 2},0a${rx},${ry},0,1,1,-${rx * 2},0`\n\n\treturn (\n\t\t<>\n\t\t\t<ShapeFill d={d} color={color} fill={fill} />\n\t\t\t<path d={d} stroke={`var(--palette-${color})`} strokeWidth={sw} fill=\"none\" />\n\t\t</>\n\t)\n})\n\nexport function SolidStyleEllipseSvg({\n\tw,\n\th,\n\tstrokeWidth: sw,\n\tfill,\n\tcolor,\n\tcolors,\n}: Pick<TLGeoShape['props'], 'w' | 'h' | 'fill' | 'color'> & {\n\tstrokeWidth: number\n\tcolors: TLExportColors\n}) {\n\tconst cx = w / 2\n\tconst cy = h / 2\n\tconst rx = Math.max(0, cx)\n\tconst ry = Math.max(0, cy)\n\n\tconst d = `M${cx - rx},${cy}a${rx},${ry},0,1,1,${rx * 2},0a${rx},${ry},0,1,1,-${rx * 2},0`\n\n\tconst strokeElement = document.createElementNS('http://www.w3.org/2000/svg', 'path')\n\tstrokeElement.setAttribute('d', d)\n\tstrokeElement.setAttribute('stroke-width', sw.toString())\n\tstrokeElement.setAttribute('width', w.toString())\n\tstrokeElement.setAttribute('height', h.toString())\n\tstrokeElement.setAttribute('fill', 'none')\n\tstrokeElement.setAttribute('stroke', colors.fill[color])\n\n\t// Get the fill element, if any\n\tconst fillElement = getShapeFillSvg({\n\t\td,\n\t\tfill,\n\t\tcolor,\n\t\tcolors,\n\t})\n\n\treturn getSvgWithShapeFill(strokeElement, fillElement)\n}\n","import { TLGeoShape } from '@tldraw/tlschema'\nimport * as React from 'react'\nimport { getShapeFillSvg, getSvgWithShapeFill, ShapeFill, TLExportColors } from '../../shared'\n\nexport const SolidStyleOval = React.memo(function SolidStyleOval({\n\tw,\n\th,\n\tstrokeWidth: sw,\n\tfill,\n\tcolor,\n}: Pick<TLGeoShape['props'], 'w' | 'h' | 'fill' | 'color'> & {\n\tstrokeWidth: number\n}) {\n\tconst d = getOvalIndicatorPath(w, h)\n\treturn (\n\t\t<>\n\t\t\t<ShapeFill d={d} color={color} fill={fill} />\n\t\t\t<path d={d} stroke={`var(--palette-${color})`} strokeWidth={sw} fill=\"none\" />\n\t\t</>\n\t)\n})\n\nexport function SolidStyleOvalSvg({\n\tw,\n\th,\n\tstrokeWidth: sw,\n\tfill,\n\tcolor,\n\tcolors,\n}: Pick<TLGeoShape['props'], 'w' | 'h' | 'fill' | 'color'> & {\n\tstrokeWidth: number\n\tcolors: TLExportColors\n}) {\n\tconst d = getOvalIndicatorPath(w, h)\n\tconst strokeElement = document.createElementNS('http://www.w3.org/2000/svg', 'path')\n\tstrokeElement.setAttribute('d', d)\n\tstrokeElement.setAttribute('stroke-width', sw.toString())\n\tstrokeElement.setAttribute('width', w.toString())\n\tstrokeElement.setAttribute('height', h.toString())\n\tstrokeElement.setAttribute('fill', 'none')\n\tstrokeElement.setAttribute('stroke', colors.fill[color])\n\n\t// Get the fill element, if any\n\tconst fillElement = getShapeFillSvg({\n\t\td,\n\t\tfill,\n\t\tcolor,\n\t\tcolors,\n\t})\n\n\treturn getSvgWithShapeFill(strokeElement, fillElement)\n}\n\nexport function getOvalIndicatorPath(w: number, h: number) {\n\tlet d: string\n\n\tif (h > w) {\n\t\tconst offset = w / 2\n\t\td = `\n    M0,${offset}\n    a${offset},${offset},0,1,1,${offset * 2},0\n    L${w},${h - offset}\n    a${offset},${offset},0,1,1,-${offset * 2},0\n    Z`\n\t} else {\n\t\tconst offset = h / 2\n\t\td = `\n    M${offset},0\n    L${w - offset},0\n    a${offset},${offset},0,1,1,0,${offset * 2}\n    L${offset},${h}\n    a${offset},${offset},0,1,1,0,${-offset * 2}\n    Z`\n\t}\n\n\treturn d\n}\n","import { VecLike } from '@tldraw/primitives'\nimport { TLGeoShape } from '@tldraw/tlschema'\nimport * as React from 'react'\nimport { getShapeFillSvg, getSvgWithShapeFill, ShapeFill, TLExportColors } from '../../shared'\n\nexport const SolidStylePolygon = React.memo(function SolidStylePolygon({\n\toutline,\n\tbgOutline,\n\tfill,\n\tcolor,\n\tstrokeWidth,\n}: Pick<TLGeoShape['props'], 'fill' | 'color'> & {\n\toutline: VecLike[]\n\tbgOutline?: VecLike[]\n\tstrokeWidth: number\n}) {\n\tconst path = 'M' + outline[0] + 'L' + outline.slice(1) + 'Z'\n\treturn (\n\t\t<>\n\t\t\t<ShapeFill\n\t\t\t\td={bgOutline ? 'M' + bgOutline[0] + 'L' + bgOutline.slice(1) + 'Z' : path}\n\t\t\t\tfill={fill}\n\t\t\t\tcolor={color}\n\t\t\t/>\n\t\t\t<path d={path} stroke={`var(--palette-${color}`} strokeWidth={strokeWidth} fill=\"none\" />\n\t\t</>\n\t)\n})\n\nexport function SolidStylePolygonSvg({\n\toutline,\n\tbgOutline,\n\tfill,\n\tcolor,\n\tstrokeWidth,\n\tcolors,\n}: Pick<TLGeoShape['props'], 'fill' | 'color'> & {\n\toutline: VecLike[]\n\tstrokeWidth: number\n\tcolors: TLExportColors\n\tbgOutline?: VecLike[]\n}) {\n\tconst strokeElementPathData = 'M' + outline[0] + 'L' + outline.slice(1) + 'Z'\n\n\tconst strokeElement = document.createElementNS('http://www.w3.org/2000/svg', 'path')\n\tstrokeElement.setAttribute('d', strokeElementPathData)\n\tstrokeElement.setAttribute('stroke-width', strokeWidth.toString())\n\tstrokeElement.setAttribute('stroke', colors.fill[color])\n\tstrokeElement.setAttribute('fill', 'none')\n\n\tconst fillPathData = bgOutline\n\t\t? 'M' + bgOutline[0] + 'L' + bgOutline.slice(1) + 'Z'\n\t\t: strokeElementPathData\n\n\t// Get the fill element, if any\n\tconst fillElement = getShapeFillSvg({\n\t\td: fillPathData,\n\t\tfill,\n\t\tcolor,\n\t\tcolors,\n\t})\n\n\treturn getSvgWithShapeFill(strokeElement, fillElement)\n}\n","/* eslint-disable react-hooks/rules-of-hooks */\nimport {\n\tBox2d,\n\tgetPolygonVertices,\n\tlinesIntersect,\n\tPI,\n\tPI2,\n\tTAU,\n\tVec2d,\n\tVecLike,\n} from '@tldraw/primitives'\nimport { geoShapeMigrations, geoShapeTypeValidator, TLGeoShape } from '@tldraw/tlschema'\nimport { useValue } from 'signia-react'\nimport { SVGContainer } from '../../../components/SVGContainer'\nimport { defineShape } from '../../../config/TLShapeDefinition'\nimport { FONT_FAMILIES, LABEL_FONT_SIZES, TEXT_PROPS } from '../../../constants'\nimport { App } from '../../App'\nimport { TLExportColors } from '../shared'\nimport { getTextSvgElement } from '../shared/getTextSvgElement'\nimport { HyperlinkButton } from '../shared/HyperlinkButton'\nimport { TextLabel } from '../shared/TextLabel'\nimport { TLBoxUtil } from '../TLBoxUtil'\nimport { OnEditEndHandler, OnResizeHandler } from '../TLShapeUtil'\nimport { DashStyleEllipse, DashStyleEllipseSvg } from './components/DashStyleEllipse'\nimport { DashStyleOval, DashStyleOvalSvg } from './components/DashStyleOval'\nimport { DashStylePolygon, DashStylePolygonSvg } from './components/DashStylePolygon'\nimport {\n\tDrawStyleEllipse,\n\tDrawStyleEllipseSvg,\n\tgetEllipseIndicatorPath,\n} from './components/DrawStyleEllipse'\nimport {\n\tDrawStylePolygon,\n\tDrawStylePolygonSvg,\n\tgetPolygonIndicatorPath,\n} from './components/DrawStylePolygon'\nimport { SolidStyleEllipse, SolidStyleEllipseSvg } from './components/SolidStyleEllipse'\nimport {\n\tgetOvalIndicatorPath,\n\tSolidStyleOval,\n\tSolidStyleOvalSvg,\n} from './components/SolidStyleOval'\nimport { SolidStylePolygon, SolidStylePolygonSvg } from './components/SolidStylePolygon'\n\nconst LABEL_PADDING = 16\nconst MIN_SIZE_WITH_LABEL = 17 * 3\n\n/** @public */\nexport class TLGeoUtil extends TLBoxUtil<TLGeoShape> {\n\tstatic type = 'geo'\n\n\tcanEdit = () => true\n\n\toverride defaultProps(): TLGeoShape['props'] {\n\t\treturn {\n\t\t\tw: 100,\n\t\t\th: 100,\n\t\t\tgeo: 'rectangle',\n\t\t\tcolor: 'black',\n\t\t\tlabelColor: 'black',\n\t\t\tfill: 'none',\n\t\t\tdash: 'draw',\n\t\t\tsize: 'm',\n\t\t\topacity: '1',\n\t\t\tfont: 'draw',\n\t\t\ttext: '',\n\t\t\talign: 'middle',\n\t\t\tgrowY: 0,\n\t\t\turl: '',\n\t\t}\n\t}\n\n\thitTestLineSegment(shape: TLGeoShape, A: VecLike, B: VecLike): boolean {\n\t\tlet outline = this.outline(shape)\n\t\tif (shape.props.geo === 'x-box') {\n\t\t\toutline = getXBoxOutline(\n\t\t\t\tMath.max(1, shape.props.w),\n\t\t\t\tMath.max(1, shape.props.h + shape.props.growY)\n\t\t\t)\n\t\t}\n\n\t\tfor (let i = 0; i < outline.length; i++) {\n\t\t\tconst C = outline[i]\n\t\t\tconst D = outline[(i + 1) % outline.length]\n\t\t\tif (linesIntersect(A, B, C, D)) return true\n\t\t}\n\n\t\treturn false\n\t}\n\n\tgetBounds(shape: TLGeoShape) {\n\t\treturn new Box2d(0, 0, shape.props.w, shape.props.h + shape.props.growY)\n\t}\n\n\tgetCenter(shape: TLGeoShape) {\n\t\treturn new Vec2d(shape.props.w / 2, (shape.props.h + shape.props.growY) / 2)\n\t}\n\n\tgetOutline(shape: TLGeoShape) {\n\t\tconst w = Math.max(1, shape.props.w)\n\t\tconst h = Math.max(1, shape.props.h + shape.props.growY)\n\t\tconst cx = w / 2\n\t\tconst cy = h / 2\n\n\t\tswitch (shape.props.geo) {\n\t\t\tcase 'triangle': {\n\t\t\t\treturn [new Vec2d(cx, 0), new Vec2d(w, h), new Vec2d(0, h)]\n\t\t\t}\n\t\t\tcase 'diamond': {\n\t\t\t\treturn [new Vec2d(cx, 0), new Vec2d(w, cy), new Vec2d(cx, h), new Vec2d(0, cy)]\n\t\t\t}\n\t\t\tcase 'pentagon': {\n\t\t\t\treturn getPolygonVertices(w, h, 5)\n\t\t\t}\n\t\t\tcase 'hexagon': {\n\t\t\t\treturn getPolygonVertices(w, h, 6)\n\t\t\t}\n\t\t\tcase 'octagon': {\n\t\t\t\treturn getPolygonVertices(w, h, 8)\n\t\t\t}\n\t\t\tcase 'ellipse': {\n\t\t\t\t// Perimeter of the ellipse\n\n\t\t\t\tconst q = Math.pow(cx - cy, 2) / Math.pow(cx + cy, 2)\n\t\t\t\tconst p = PI * (cx + cy) * (1 + (3 * q) / (10 + Math.sqrt(4 - 3 * q)))\n\n\t\t\t\t// Number of points\n\t\t\t\tlet len = Math.max(4, Math.ceil(p / 10))\n\n\t\t\t\t// Round length to nearest multiple of 4\n\t\t\t\t// In some cases, this stops the outline overlapping with the indicator\n\t\t\t\t// (it doesn't prevent all cases though, eg: when the shape is on the edge of a group)\n\t\t\t\tlen = Math.ceil(len / 4) * 4\n\n\t\t\t\t// Size of step\n\t\t\t\tconst step = PI2 / len\n\n\t\t\t\tconst a = Math.cos(step)\n\t\t\t\tconst b = Math.sin(step)\n\n\t\t\t\tlet sin = 0\n\t\t\t\tlet cos = 1\n\t\t\t\tlet ts = 0\n\t\t\t\tlet tc = 1\n\n\t\t\t\tconst points: Vec2d[] = Array(len)\n\n\t\t\t\tfor (let i = 0; i < len; i++) {\n\t\t\t\t\tpoints[i] = new Vec2d(cx + cx * cos, cy + cy * sin)\n\t\t\t\t\tts = b * cos + a * sin\n\t\t\t\t\ttc = a * cos - b * sin\n\t\t\t\t\tsin = ts\n\t\t\t\t\tcos = tc\n\t\t\t\t}\n\n\t\t\t\treturn points\n\t\t\t}\n\t\t\tcase 'oval': {\n\t\t\t\tconst len = 10\n\t\t\t\tconst points: Vec2d[] = Array(len * 2)\n\n\t\t\t\tif (h > w) {\n\t\t\t\t\tfor (let i = 0; i < len; i++) {\n\t\t\t\t\t\tconst t1 = -PI + (PI * i) / (len - 2)\n\t\t\t\t\t\tconst t2 = (PI * i) / (len - 2)\n\t\t\t\t\t\tpoints[i] = new Vec2d(cx + cx * Math.cos(t1), cx + cx * Math.sin(t1))\n\t\t\t\t\t\tpoints[i + len] = new Vec2d(cx + cx * Math.cos(t2), h - cx + cx * Math.sin(t2))\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tfor (let i = 0; i < len; i++) {\n\t\t\t\t\t\tconst t1 = -TAU + (PI * i) / (len - 2)\n\t\t\t\t\t\tconst t2 = TAU + (PI * -i) / (len - 2)\n\t\t\t\t\t\tpoints[i] = new Vec2d(w - cy + cy * Math.cos(t1), h - cy + cy * Math.sin(t1))\n\t\t\t\t\t\tpoints[i + len] = new Vec2d(cy - cy * Math.cos(t2), h - cy + cy * Math.sin(t2))\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn points\n\t\t\t}\n\t\t\tcase 'star': {\n\t\t\t\t// Most of this code is to offset the center, a 5 point star\n\t\t\t\t// will need to be moved downward because from its center [0,0]\n\t\t\t\t// it will have a bigger minY than maxY. This is because it'll\n\t\t\t\t// have 2 points at the bottom.\n\t\t\t\tconst sides = 5\n\t\t\t\tconst step = PI2 / sides / 2\n\t\t\t\tconst rightMostIndex = Math.floor(sides / 4) * 2\n\t\t\t\tconst leftMostIndex = sides * 2 - rightMostIndex\n\t\t\t\tconst topMostIndex = 0\n\t\t\t\tconst bottomMostIndex = Math.floor(sides / 2) * 2\n\t\t\t\tconst maxX = (Math.cos(-TAU + rightMostIndex * step) * w) / 2\n\t\t\t\tconst minX = (Math.cos(-TAU + leftMostIndex * step) * w) / 2\n\n\t\t\t\tconst minY = (Math.sin(-TAU + topMostIndex * step) * h) / 2\n\t\t\t\tconst maxY = (Math.sin(-TAU + bottomMostIndex * step) * h) / 2\n\t\t\t\tconst diffX = w - Math.abs(maxX - minX)\n\t\t\t\tconst diffY = h - Math.abs(maxY - minY)\n\t\t\t\tconst offsetX = w / 2 + minX - (w / 2 - maxX)\n\t\t\t\tconst offsetY = h / 2 + minY - (h / 2 - maxY)\n\n\t\t\t\tconst ratio = 1\n\t\t\t\tconst cx = (w - offsetX) / 2\n\t\t\t\tconst cy = (h - offsetY) / 2\n\t\t\t\tconst ox = (w + diffX) / 2\n\t\t\t\tconst oy = (h + diffY) / 2\n\t\t\t\tconst ix = (ox * ratio) / 2\n\t\t\t\tconst iy = (oy * ratio) / 2\n\n\t\t\t\treturn Array.from(Array(sides * 2)).map((_, i) => {\n\t\t\t\t\tconst theta = -TAU + i * step\n\t\t\t\t\treturn new Vec2d(\n\t\t\t\t\t\tcx + (i % 2 ? ix : ox) * Math.cos(theta),\n\t\t\t\t\t\tcy + (i % 2 ? iy : oy) * Math.sin(theta)\n\t\t\t\t\t)\n\t\t\t\t})\n\t\t\t}\n\t\t\tcase 'rhombus': {\n\t\t\t\tconst offset = Math.min(w * 0.38, h * 0.38)\n\t\t\t\treturn [new Vec2d(offset, 0), new Vec2d(w, 0), new Vec2d(w - offset, h), new Vec2d(0, h)]\n\t\t\t}\n\t\t\tcase 'rhombus-2': {\n\t\t\t\tconst offset = Math.min(w * 0.38, h * 0.38)\n\t\t\t\treturn [new Vec2d(0, 0), new Vec2d(w - offset, 0), new Vec2d(w, h), new Vec2d(offset, h)]\n\t\t\t}\n\t\t\tcase 'trapezoid': {\n\t\t\t\tconst offset = Math.min(w * 0.38, h * 0.38)\n\t\t\t\treturn [new Vec2d(offset, 0), new Vec2d(w - offset, 0), new Vec2d(w, h), new Vec2d(0, h)]\n\t\t\t}\n\t\t\tcase 'arrow-right': {\n\t\t\t\tconst ox = Math.min(w, h) * 0.38\n\t\t\t\tconst oy = h * 0.16\n\t\t\t\treturn [\n\t\t\t\t\tnew Vec2d(0, oy),\n\t\t\t\t\tnew Vec2d(w - ox, oy),\n\t\t\t\t\tnew Vec2d(w - ox, 0),\n\t\t\t\t\tnew Vec2d(w, h / 2),\n\t\t\t\t\tnew Vec2d(w - ox, h),\n\t\t\t\t\tnew Vec2d(w - ox, h - oy),\n\t\t\t\t\tnew Vec2d(0, h - oy),\n\t\t\t\t]\n\t\t\t}\n\t\t\tcase 'arrow-left': {\n\t\t\t\tconst ox = Math.min(w, h) * 0.38\n\t\t\t\tconst oy = h * 0.16\n\t\t\t\treturn [\n\t\t\t\t\tnew Vec2d(ox, 0),\n\t\t\t\t\tnew Vec2d(ox, oy),\n\t\t\t\t\tnew Vec2d(w, oy),\n\t\t\t\t\tnew Vec2d(w, h - oy),\n\t\t\t\t\tnew Vec2d(ox, h - oy),\n\t\t\t\t\tnew Vec2d(ox, h),\n\t\t\t\t\tnew Vec2d(0, h / 2),\n\t\t\t\t]\n\t\t\t}\n\t\t\tcase 'arrow-up': {\n\t\t\t\tconst ox = w * 0.16\n\t\t\t\tconst oy = Math.min(w, h) * 0.38\n\t\t\t\treturn [\n\t\t\t\t\tnew Vec2d(w / 2, 0),\n\t\t\t\t\tnew Vec2d(w, oy),\n\t\t\t\t\tnew Vec2d(w - ox, oy),\n\t\t\t\t\tnew Vec2d(w - ox, h),\n\t\t\t\t\tnew Vec2d(ox, h),\n\t\t\t\t\tnew Vec2d(ox, oy),\n\t\t\t\t\tnew Vec2d(0, oy),\n\t\t\t\t]\n\t\t\t}\n\t\t\tcase 'arrow-down': {\n\t\t\t\tconst ox = w * 0.16\n\t\t\t\tconst oy = Math.min(w, h) * 0.38\n\t\t\t\treturn [\n\t\t\t\t\tnew Vec2d(ox, 0),\n\t\t\t\t\tnew Vec2d(w - ox, 0),\n\t\t\t\t\tnew Vec2d(w - ox, h - oy),\n\t\t\t\t\tnew Vec2d(w, h - oy),\n\t\t\t\t\tnew Vec2d(w / 2, h),\n\t\t\t\t\tnew Vec2d(0, h - oy),\n\t\t\t\t\tnew Vec2d(ox, h - oy),\n\t\t\t\t]\n\t\t\t}\n\t\t\tcase 'x-box':\n\t\t\tcase 'rectangle': {\n\t\t\t\treturn [new Vec2d(0, 0), new Vec2d(w, 0), new Vec2d(w, h), new Vec2d(0, h)]\n\t\t\t}\n\t\t}\n\t}\n\n\tonEditEnd: OnEditEndHandler<TLGeoShape> = (shape) => {\n\t\tconst {\n\t\t\tid,\n\t\t\ttype,\n\t\t\tprops: { text },\n\t\t} = shape\n\n\t\tif (text.trim() !== shape.props.text) {\n\t\t\tthis.app.updateShapes([\n\t\t\t\t{\n\t\t\t\t\tid,\n\t\t\t\t\ttype,\n\t\t\t\t\tprops: {\n\t\t\t\t\t\ttext: text.trim(),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t])\n\t\t}\n\t}\n\n\trender(shape: TLGeoShape) {\n\t\tconst { id, type, props } = shape\n\n\t\tconst forceSolid = useValue('zoom', () => this.app.zoomLevel < 0.35, [])\n\t\tconst strokeWidth = this.app.getStrokeWidth(props.size)\n\n\t\tconst { w, color, labelColor, fill, dash, growY, font, align, size, text } = props\n\n\t\tconst getShape = () => {\n\t\t\tconst h = props.h + growY\n\n\t\t\tswitch (props.geo) {\n\t\t\t\tcase 'ellipse': {\n\t\t\t\t\treturn dash === 'draw' ? (\n\t\t\t\t\t\tforceSolid ? (\n\t\t\t\t\t\t\t<SolidStyleEllipse strokeWidth={strokeWidth} w={w} h={h} color={color} fill={fill} />\n\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t<DrawStyleEllipse\n\t\t\t\t\t\t\t\tid={id}\n\t\t\t\t\t\t\t\tw={w}\n\t\t\t\t\t\t\t\th={h}\n\t\t\t\t\t\t\t\tcolor={color}\n\t\t\t\t\t\t\t\tfill={fill}\n\t\t\t\t\t\t\t\tstrokeWidth={strokeWidth}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t)\n\t\t\t\t\t) : dash === 'solid' ? (\n\t\t\t\t\t\t<SolidStyleEllipse strokeWidth={strokeWidth} w={w} h={h} color={color} fill={fill} />\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<DashStyleEllipse\n\t\t\t\t\t\t\tid={id}\n\t\t\t\t\t\t\tstrokeWidth={strokeWidth}\n\t\t\t\t\t\t\tw={w}\n\t\t\t\t\t\t\th={h}\n\t\t\t\t\t\t\tdash={dash}\n\t\t\t\t\t\t\tcolor={color}\n\t\t\t\t\t\t\tfill={fill}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)\n\t\t\t\t}\n\t\t\t\tcase 'oval': {\n\t\t\t\t\treturn dash === 'draw' || dash === 'solid' ? (\n\t\t\t\t\t\t<SolidStyleOval strokeWidth={strokeWidth} w={w} h={h} color={color} fill={fill} />\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<DashStyleOval\n\t\t\t\t\t\t\tid={id}\n\t\t\t\t\t\t\tstrokeWidth={strokeWidth}\n\t\t\t\t\t\t\tw={w}\n\t\t\t\t\t\t\th={h}\n\t\t\t\t\t\t\tdash={dash}\n\t\t\t\t\t\t\tcolor={color}\n\t\t\t\t\t\t\tfill={fill}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)\n\t\t\t\t}\n\t\t\t\tdefault: {\n\t\t\t\t\tlet outline = this.outline(shape)\n\t\t\t\t\tlet bgOutline: VecLike[] | undefined\n\n\t\t\t\t\tif (shape.props.geo === 'x-box') {\n\t\t\t\t\t\tbgOutline = outline\n\n\t\t\t\t\t\toutline = getXBoxOutline(\n\t\t\t\t\t\t\tMath.max(1, shape.props.w),\n\t\t\t\t\t\t\tMath.max(1, shape.props.h + shape.props.growY)\n\t\t\t\t\t\t)\n\t\t\t\t\t}\n\n\t\t\t\t\treturn dash === 'draw' ? (\n\t\t\t\t\t\tforceSolid ? (\n\t\t\t\t\t\t\t<SolidStylePolygon\n\t\t\t\t\t\t\t\tfill={fill}\n\t\t\t\t\t\t\t\tcolor={color}\n\t\t\t\t\t\t\t\tstrokeWidth={strokeWidth}\n\t\t\t\t\t\t\t\toutline={outline}\n\t\t\t\t\t\t\t\tbgOutline={bgOutline}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t<DrawStylePolygon\n\t\t\t\t\t\t\t\tid={id}\n\t\t\t\t\t\t\t\tfill={fill}\n\t\t\t\t\t\t\t\tcolor={color}\n\t\t\t\t\t\t\t\tstrokeWidth={strokeWidth}\n\t\t\t\t\t\t\t\toutline={outline}\n\t\t\t\t\t\t\t\tbgOutline={bgOutline}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t)\n\t\t\t\t\t) : dash === 'solid' ? (\n\t\t\t\t\t\t<SolidStylePolygon\n\t\t\t\t\t\t\tfill={fill}\n\t\t\t\t\t\t\tcolor={color}\n\t\t\t\t\t\t\tstrokeWidth={strokeWidth}\n\t\t\t\t\t\t\toutline={outline}\n\t\t\t\t\t\t\tbgOutline={bgOutline}\n\t\t\t\t\t\t/>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<DashStylePolygon\n\t\t\t\t\t\t\tdash={dash}\n\t\t\t\t\t\t\tfill={fill}\n\t\t\t\t\t\t\tcolor={color}\n\t\t\t\t\t\t\tstrokeWidth={strokeWidth}\n\t\t\t\t\t\t\toutline={outline}\n\t\t\t\t\t\t\tbgOutline={bgOutline}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<SVGContainer id={id}>{getShape()}</SVGContainer>\n\t\t\t\t<TextLabel\n\t\t\t\t\tid={id}\n\t\t\t\t\ttype={type}\n\t\t\t\t\tfont={font}\n\t\t\t\t\tfill={fill}\n\t\t\t\t\tsize={size}\n\t\t\t\t\talign={align}\n\t\t\t\t\ttext={text}\n\t\t\t\t\tlabelColor={this.app.getCssColor(labelColor)}\n\t\t\t\t\twrap\n\t\t\t\t/>\n\t\t\t\t{'url' in shape.props && shape.props.url && <HyperlinkButton url={shape.props.url} />}\n\t\t\t</>\n\t\t)\n\t}\n\n\tindicator(shape: TLGeoShape) {\n\t\tconst { id, props } = shape\n\t\tconst { w, h, growY, size } = props\n\n\t\tconst strokeWidth = this.app.getStrokeWidth(size)\n\n\t\tswitch (props.geo) {\n\t\t\tcase 'ellipse': {\n\t\t\t\tif (props.dash === 'draw') {\n\t\t\t\t\treturn <path d={getEllipseIndicatorPath(id, w, h + growY, strokeWidth)} />\n\t\t\t\t}\n\n\t\t\t\treturn <ellipse cx={w / 2} cy={(h + growY) / 2} rx={w / 2} ry={(h + growY) / 2} />\n\t\t\t}\n\t\t\tcase 'oval': {\n\t\t\t\treturn <path d={getOvalIndicatorPath(w, h + growY)} />\n\t\t\t}\n\n\t\t\tdefault: {\n\t\t\t\tlet polygonPoints = this.outline(shape)\n\n\t\t\t\tif (shape.props.geo === 'x-box') {\n\t\t\t\t\tpolygonPoints = getXBoxOutline(\n\t\t\t\t\t\tMath.max(1, shape.props.w),\n\t\t\t\t\t\tMath.max(1, shape.props.h + shape.props.growY)\n\t\t\t\t\t)\n\t\t\t\t}\n\n\t\t\t\tif (props.dash === 'draw') {\n\t\t\t\t\treturn <path d={getPolygonIndicatorPath(id, polygonPoints, strokeWidth)} />\n\t\t\t\t}\n\n\t\t\t\treturn <path d={`M${polygonPoints[0]}L${polygonPoints.slice(1)}Z`} />\n\t\t\t}\n\t\t}\n\t}\n\n\ttoSvg(shape: TLGeoShape, font: string, colors: TLExportColors) {\n\t\tconst { id, props } = shape\n\t\tconst strokeWidth = this.app.getStrokeWidth(props.size)\n\n\t\tlet svgElm: SVGElement\n\n\t\tswitch (props.geo) {\n\t\t\tcase 'ellipse': {\n\t\t\t\tswitch (props.dash) {\n\t\t\t\t\tcase 'draw':\n\t\t\t\t\t\tsvgElm = DrawStyleEllipseSvg({\n\t\t\t\t\t\t\tid,\n\t\t\t\t\t\t\tw: props.w,\n\t\t\t\t\t\t\th: props.h,\n\t\t\t\t\t\t\tcolor: props.color,\n\t\t\t\t\t\t\tfill: props.fill,\n\t\t\t\t\t\t\tstrokeWidth,\n\t\t\t\t\t\t\tcolors,\n\t\t\t\t\t\t})\n\t\t\t\t\t\tbreak\n\n\t\t\t\t\tcase 'solid':\n\t\t\t\t\t\tsvgElm = SolidStyleEllipseSvg({\n\t\t\t\t\t\t\tstrokeWidth,\n\t\t\t\t\t\t\tw: props.w,\n\t\t\t\t\t\t\th: props.h,\n\t\t\t\t\t\t\tcolor: props.color,\n\t\t\t\t\t\t\tfill: props.fill,\n\t\t\t\t\t\t\tcolors,\n\t\t\t\t\t\t})\n\t\t\t\t\t\tbreak\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tsvgElm = DashStyleEllipseSvg({\n\t\t\t\t\t\t\tid,\n\t\t\t\t\t\t\tstrokeWidth,\n\t\t\t\t\t\t\tw: props.w,\n\t\t\t\t\t\t\th: props.h,\n\t\t\t\t\t\t\tdash: props.dash,\n\t\t\t\t\t\t\tcolor: props.color,\n\t\t\t\t\t\t\tfill: props.fill,\n\t\t\t\t\t\t\tcolors,\n\t\t\t\t\t\t})\n\t\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t\tbreak\n\t\t\t}\n\n\t\t\tcase 'oval': {\n\t\t\t\tswitch (props.dash) {\n\t\t\t\t\tcase 'draw':\n\t\t\t\t\t\tsvgElm = DashStyleOvalSvg({\n\t\t\t\t\t\t\tid,\n\t\t\t\t\t\t\tstrokeWidth,\n\t\t\t\t\t\t\tw: props.w,\n\t\t\t\t\t\t\th: props.h,\n\t\t\t\t\t\t\tdash: props.dash,\n\t\t\t\t\t\t\tcolor: props.color,\n\t\t\t\t\t\t\tfill: props.fill,\n\t\t\t\t\t\t\tcolors,\n\t\t\t\t\t\t})\n\t\t\t\t\t\tbreak\n\n\t\t\t\t\tcase 'solid':\n\t\t\t\t\t\tsvgElm = SolidStyleOvalSvg({\n\t\t\t\t\t\t\tstrokeWidth,\n\t\t\t\t\t\t\tw: props.w,\n\t\t\t\t\t\t\th: props.h,\n\t\t\t\t\t\t\tcolor: props.color,\n\t\t\t\t\t\t\tfill: props.fill,\n\t\t\t\t\t\t\tcolors,\n\t\t\t\t\t\t})\n\t\t\t\t\t\tbreak\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tsvgElm = DashStyleOvalSvg({\n\t\t\t\t\t\t\tid,\n\t\t\t\t\t\t\tstrokeWidth,\n\t\t\t\t\t\t\tw: props.w,\n\t\t\t\t\t\t\th: props.h,\n\t\t\t\t\t\t\tdash: props.dash,\n\t\t\t\t\t\t\tcolor: props.color,\n\t\t\t\t\t\t\tfill: props.fill,\n\t\t\t\t\t\t\tcolors,\n\t\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tdefault: {\n\t\t\t\tlet polygonPoints = this.outline(shape)\n\t\t\t\tlet bgOutline: VecLike[] | undefined = undefined\n\n\t\t\t\tif (props.geo === 'x-box') {\n\t\t\t\t\tbgOutline = polygonPoints\n\t\t\t\t\tpolygonPoints = getXBoxOutline(\n\t\t\t\t\t\tMath.max(1, shape.props.w),\n\t\t\t\t\t\tMath.max(1, shape.props.h + shape.props.growY)\n\t\t\t\t\t)\n\t\t\t\t}\n\n\t\t\t\tswitch (props.dash) {\n\t\t\t\t\tcase 'draw':\n\t\t\t\t\t\tsvgElm = DrawStylePolygonSvg({\n\t\t\t\t\t\t\tid,\n\t\t\t\t\t\t\tfill: props.fill,\n\t\t\t\t\t\t\tcolor: props.color,\n\t\t\t\t\t\t\tstrokeWidth,\n\t\t\t\t\t\t\toutline: polygonPoints,\n\t\t\t\t\t\t\tbgOutline,\n\t\t\t\t\t\t\tcolors,\n\t\t\t\t\t\t})\n\t\t\t\t\t\tbreak\n\n\t\t\t\t\tcase 'solid':\n\t\t\t\t\t\tsvgElm = SolidStylePolygonSvg({\n\t\t\t\t\t\t\tfill: props.fill,\n\t\t\t\t\t\t\tcolor: props.color,\n\t\t\t\t\t\t\tstrokeWidth,\n\t\t\t\t\t\t\toutline: polygonPoints,\n\t\t\t\t\t\t\tbgOutline,\n\t\t\t\t\t\t\tcolors,\n\t\t\t\t\t\t})\n\t\t\t\t\t\tbreak\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tsvgElm = DashStylePolygonSvg({\n\t\t\t\t\t\t\tdash: props.dash,\n\t\t\t\t\t\t\tfill: props.fill,\n\t\t\t\t\t\t\tcolor: props.color,\n\t\t\t\t\t\t\tstrokeWidth,\n\t\t\t\t\t\t\toutline: polygonPoints,\n\t\t\t\t\t\t\tbgOutline,\n\t\t\t\t\t\t\tcolors,\n\t\t\t\t\t\t})\n\t\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t\tbreak\n\t\t\t}\n\t\t}\n\n\t\tif (props.text) {\n\t\t\tconst bounds = this.bounds(shape)\n\n\t\t\tconst opts = {\n\t\t\t\tfontSize: LABEL_FONT_SIZES[shape.props.size],\n\t\t\t\tfontFamily: font,\n\t\t\t\ttextAlign: shape.props.align,\n\t\t\t\tpadding: 16,\n\t\t\t\tlineHeight: TEXT_PROPS.lineHeight,\n\t\t\t\tfontStyle: 'normal',\n\t\t\t\tfontWeight: 'normal',\n\t\t\t\twidth: Math.ceil(bounds.width),\n\t\t\t\theight: Math.ceil(bounds.height),\n\t\t\t}\n\n\t\t\tconst lines = this.app.textMeasure.getTextLines({\n\t\t\t\ttext: props.text,\n\t\t\t\twrap: true,\n\t\t\t\t...opts,\n\t\t\t})\n\n\t\t\tconst groupEl = document.createElementNS('http://www.w3.org/2000/svg', 'g')\n\n\t\t\tconst labelSize = getLabelSize(this.app, shape)\n\n\t\t\tconst textBgEl = getTextSvgElement(this.app, {\n\t\t\t\t...opts,\n\t\t\t\tlines,\n\t\t\t\tstrokeWidth: 2,\n\t\t\t\tstroke: colors.background,\n\t\t\t\tfill: colors.background,\n\t\t\t\twidth: labelSize.w,\n\t\t\t})\n\n\t\t\t// yuck, include padding as magic number\n\t\t\ttextBgEl.setAttribute('transform', `translate(${(bounds.width - labelSize.w) / 2}, 0)`)\n\n\t\t\tconst textElm = textBgEl.cloneNode(true) as SVGTextElement\n\t\t\ttextElm.setAttribute('fill', colors.fill[shape.props.labelColor])\n\t\t\ttextElm.setAttribute('stroke', 'none')\n\n\t\t\tgroupEl.append(textBgEl)\n\t\t\tgroupEl.append(textElm)\n\n\t\t\tif (svgElm.nodeName === 'g') {\n\t\t\t\tsvgElm.appendChild(groupEl)\n\t\t\t\treturn svgElm\n\t\t\t} else {\n\t\t\t\tconst g = document.createElementNS('http://www.w3.org/2000/svg', 'g')\n\t\t\t\tg.appendChild(svgElm)\n\t\t\t\tg.appendChild(groupEl)\n\t\t\t\treturn g\n\t\t\t}\n\t\t}\n\n\t\treturn svgElm\n\t}\n\n\tonResize: OnResizeHandler<TLGeoShape> = (\n\t\tshape,\n\t\t{ initialBounds, handle, newPoint, scaleX, scaleY }\n\t) => {\n\t\tlet w = initialBounds.width * scaleX\n\t\tlet h = initialBounds.height * scaleY\n\t\tlet overShrinkX = 0\n\t\tlet overShrinkY = 0\n\n\t\tif (shape.props.text.trim()) {\n\t\t\tlet newW = Math.max(Math.abs(w), MIN_SIZE_WITH_LABEL)\n\t\t\tlet newH = Math.max(Math.abs(h), MIN_SIZE_WITH_LABEL)\n\n\t\t\tif (newW < MIN_SIZE_WITH_LABEL && newH === MIN_SIZE_WITH_LABEL) {\n\t\t\t\tnewW = MIN_SIZE_WITH_LABEL\n\t\t\t}\n\n\t\t\tif (newW === MIN_SIZE_WITH_LABEL && newH < MIN_SIZE_WITH_LABEL) {\n\t\t\t\tnewH = MIN_SIZE_WITH_LABEL\n\t\t\t}\n\n\t\t\tconst labelSize = getLabelSize(this.app, {\n\t\t\t\t...shape,\n\t\t\t\tprops: {\n\t\t\t\t\t...shape.props,\n\t\t\t\t\tw: newW,\n\t\t\t\t\th: newH,\n\t\t\t\t},\n\t\t\t})\n\n\t\t\tconst nextW = Math.max(Math.abs(w), labelSize.w) * Math.sign(w)\n\t\t\tconst nextH = Math.max(Math.abs(h), labelSize.h) * Math.sign(h)\n\t\t\toverShrinkX = Math.abs(nextW) - Math.abs(w)\n\t\t\toverShrinkY = Math.abs(nextH) - Math.abs(h)\n\n\t\t\tw = nextW\n\t\t\th = nextH\n\t\t}\n\n\t\tconst offset = new Vec2d(0, 0)\n\n\t\t// x offsets\n\n\t\tif (scaleX < 0) {\n\t\t\toffset.x += w\n\t\t}\n\n\t\tif (handle === 'left' || handle === 'top_left' || handle === 'bottom_left') {\n\t\t\toffset.x += scaleX < 0 ? overShrinkX : -overShrinkX\n\t\t}\n\n\t\t// y offsets\n\n\t\tif (scaleY < 0) {\n\t\t\toffset.y += h\n\t\t}\n\n\t\tif (handle === 'top' || handle === 'top_left' || handle === 'top_right') {\n\t\t\toffset.y += scaleY < 0 ? overShrinkY : -overShrinkY\n\t\t}\n\n\t\tconst { x, y } = offset.rot(shape.rotation).add(newPoint)\n\n\t\treturn {\n\t\t\tx,\n\t\t\ty,\n\t\t\tprops: {\n\t\t\t\tw: Math.max(Math.abs(w), 1),\n\t\t\t\th: Math.max(Math.abs(h), 1),\n\t\t\t\tgrowY: 0,\n\t\t\t},\n\t\t}\n\t}\n\n\tonBeforeCreate = (shape: TLGeoShape) => {\n\t\tif (!shape.props.text) {\n\t\t\tif (shape.props.growY) {\n\t\t\t\t// No text / some growY, set growY to 0\n\t\t\t\treturn {\n\t\t\t\t\t...shape,\n\t\t\t\t\tprops: {\n\t\t\t\t\t\t...shape.props,\n\t\t\t\t\t\tgrowY: 0,\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// No text / no growY, nothing to change\n\t\t\t\treturn\n\t\t\t}\n\t\t}\n\n\t\tconst prevHeight = shape.props.h\n\t\tconst nextHeight = getLabelSize(this.app, shape).h\n\n\t\tlet growY: number | null = null\n\n\t\tif (nextHeight > prevHeight) {\n\t\t\tgrowY = nextHeight - prevHeight\n\t\t} else {\n\t\t\tif (shape.props.growY) {\n\t\t\t\tgrowY = 0\n\t\t\t}\n\t\t}\n\n\t\tif (growY !== null) {\n\t\t\treturn {\n\t\t\t\t...shape,\n\t\t\t\tprops: {\n\t\t\t\t\t...shape.props,\n\t\t\t\t\tgrowY,\n\t\t\t\t},\n\t\t\t}\n\t\t}\n\t}\n\n\tonBeforeUpdate = (prev: TLGeoShape, next: TLGeoShape) => {\n\t\tconst prevText = prev.props.text.trim()\n\t\tconst nextText = next.props.text.trim()\n\n\t\tif (\n\t\t\tprevText === nextText &&\n\t\t\tprev.props.font === next.props.font &&\n\t\t\tprev.props.size === next.props.size\n\t\t) {\n\t\t\treturn\n\t\t}\n\n\t\tif (prevText && !nextText) {\n\t\t\treturn {\n\t\t\t\t...next,\n\t\t\t\tprops: {\n\t\t\t\t\t...next.props,\n\t\t\t\t\tgrowY: 0,\n\t\t\t\t},\n\t\t\t}\n\t\t}\n\n\t\tconst prevWidth = prev.props.w\n\t\tconst prevHeight = prev.props.h\n\t\tconst nextSize = getLabelSize(this.app, next)\n\t\tconst nextWidth = nextSize.w\n\t\tconst nextHeight = nextSize.h\n\n\t\t// When entering the first character in a label (not pasting in multiple characters...)\n\t\tif (!prevText && nextText && nextText.length === 1) {\n\t\t\tlet w = Math.max(prevWidth, nextWidth)\n\t\t\tlet h = Math.max(prevHeight, nextHeight)\n\n\t\t\t// If both the width and height were less than the minimum size, make the shape square\n\t\t\tif (prev.props.w < MIN_SIZE_WITH_LABEL && prev.props.h < MIN_SIZE_WITH_LABEL) {\n\t\t\t\tw = Math.max(w, MIN_SIZE_WITH_LABEL)\n\t\t\t\th = Math.max(h, MIN_SIZE_WITH_LABEL)\n\t\t\t\tw = Math.max(w, h)\n\t\t\t\th = Math.max(w, h)\n\t\t\t}\n\n\t\t\t// Don't set a growYat least, not until we've implemented a growX property\n\t\t\treturn {\n\t\t\t\t...next,\n\t\t\t\tprops: {\n\t\t\t\t\t...next.props,\n\t\t\t\t\tw,\n\t\t\t\t\th,\n\t\t\t\t\tgrowY: 0,\n\t\t\t\t},\n\t\t\t}\n\t\t}\n\n\t\tlet growY: number | null = null\n\n\t\tif (nextHeight > prevHeight) {\n\t\t\tgrowY = nextHeight - prevHeight\n\t\t} else {\n\t\t\tif (prev.props.growY) {\n\t\t\t\tgrowY = 0\n\t\t\t}\n\t\t}\n\n\t\tif (growY !== null) {\n\t\t\treturn {\n\t\t\t\t...next,\n\t\t\t\tprops: {\n\t\t\t\t\t...next.props,\n\t\t\t\t\tgrowY,\n\t\t\t\t\tw: nextWidth,\n\t\t\t\t},\n\t\t\t}\n\t\t}\n\n\t\tif (nextWidth > prev.props.w) {\n\t\t\treturn {\n\t\t\t\t...next,\n\t\t\t\tprops: {\n\t\t\t\t\t...next.props,\n\t\t\t\t\tw: nextWidth,\n\t\t\t\t},\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction getLabelSize(app: App, shape: TLGeoShape) {\n\tconst text = shape.props.text.trim()\n\n\tif (!text) {\n\t\treturn { w: 0, h: 0 }\n\t}\n\n\tconst minSize = app.textMeasure.measureText({\n\t\t...TEXT_PROPS,\n\t\ttext: 'w',\n\t\tfontFamily: FONT_FAMILIES[shape.props.font],\n\t\tfontSize: LABEL_FONT_SIZES[shape.props.size],\n\t\twidth: 'fit-content',\n\t\tmaxWidth: '100px',\n\t})\n\n\t// TODO: Can I get these from somewhere?\n\tconst sizes = {\n\t\ts: 2,\n\t\tm: 3.5,\n\t\tl: 5,\n\t\txl: 10,\n\t}\n\n\tconst size = app.textMeasure.measureText({\n\t\t...TEXT_PROPS,\n\t\ttext: text,\n\t\tfontFamily: FONT_FAMILIES[shape.props.font],\n\t\tfontSize: LABEL_FONT_SIZES[shape.props.size],\n\t\twidth: 'fit-content',\n\t\tminWidth: minSize.w + 'px',\n\t\tmaxWidth:\n\t\t\tMath.max(\n\t\t\t\t// Guard because a DOM nodes can't be less 0\n\t\t\t\t0,\n\t\t\t\t// A 'w' width that we're setting as the min-width\n\t\t\t\tMath.ceil(minSize.w + sizes[shape.props.size]),\n\t\t\t\t// The actual text size\n\t\t\t\tMath.ceil(shape.props.w - LABEL_PADDING * 2)\n\t\t\t) + 'px',\n\t})\n\n\treturn {\n\t\tw: size.w + LABEL_PADDING * 2,\n\t\th: size.h + LABEL_PADDING * 2,\n\t}\n}\n\nfunction getXBoxOutline(w: number, h: number) {\n\treturn [\n\t\tnew Vec2d(0, 0),\n\t\tnew Vec2d(w, 0),\n\t\tnew Vec2d(w, h),\n\t\tnew Vec2d(0, h),\n\t\tnew Vec2d(0, 0),\n\t\tnew Vec2d(w * 0.5, h * 0.5),\n\t\tnew Vec2d(w, h),\n\t\tnew Vec2d(w, 0),\n\t\tnew Vec2d(w * 0.5, h * 0.5),\n\t\tnew Vec2d(0, h),\n\t]\n}\n\n/** @public */\nexport const TLGeoShapeDef = defineShape<TLGeoShape, TLGeoUtil>({\n\ttype: 'geo',\n\tgetShapeUtil: () => TLGeoUtil,\n\tvalidator: geoShapeTypeValidator,\n\tmigrations: geoShapeMigrations,\n})\n","import { Box2d, Matrix2d } from '@tldraw/primitives'\nimport {\n\tTLGroupShape,\n\tVec2dModel,\n\tgroupShapeMigrations,\n\tgroupShapeTypeValidator,\n} from '@tldraw/tlschema'\nimport { SVGContainer } from '../../../components/SVGContainer'\nimport { defineShape } from '../../../config/TLShapeDefinition'\nimport { OnChildrenChangeHandler, TLShapeUtil } from '../TLShapeUtil'\nimport { getPerfectDashProps } from '../shared'\n\n/** @public */\nexport class TLGroupUtil extends TLShapeUtil<TLGroupShape> {\n\tstatic type = 'group'\n\n\thideSelectionBoundsBg = () => false\n\thideSelectionBoundsFg = () => true\n\n\tcanBind = () => false\n\n\tdefaultProps(): TLGroupShape['props'] {\n\t\treturn { opacity: '1' }\n\t}\n\n\tgetBounds(shape: TLGroupShape): Box2d {\n\t\tconst children = this.app.getSortedChildIds(shape.id)\n\t\tif (children.length === 0) {\n\t\t\treturn new Box2d()\n\t\t}\n\n\t\tconst allChildPoints = children.flatMap((childId) => {\n\t\t\tconst shape = this.app.getShapeById(childId)!\n\t\t\treturn this.app\n\t\t\t\t.getOutlineById(childId)\n\t\t\t\t.map((point) => Matrix2d.applyToPoint(this.app.getTransform(shape), point))\n\t\t})\n\n\t\treturn Box2d.FromPoints(allChildPoints)\n\t}\n\n\tgetCenter(shape: TLGroupShape): Vec2dModel {\n\t\treturn this.bounds(shape).center\n\t}\n\n\tgetOutline(shape: TLGroupShape): Vec2dModel[] {\n\t\treturn this.bounds(shape).corners\n\t}\n\n\trender(shape: TLGroupShape) {\n\t\t// Not a class component, but eslint can't tell that :(\n\t\tconst {\n\t\t\terasingIdsSet,\n\t\t\tpageState: { hintingIds, focusLayerId },\n\t\t\tzoomLevel,\n\t\t} = this.app\n\n\t\tconst isErasing = erasingIdsSet.has(shape.id)\n\n\t\tconst isHintingOtherGroup =\n\t\t\thintingIds.length > 0 &&\n\t\t\thintingIds.some((id) => id !== shape.id && this.app.getShapeById(id)?.type === 'group')\n\n\t\tif (\n\t\t\t// always show the outline while we're erasing the group\n\t\t\t!isErasing &&\n\t\t\t// show the outline while the group is focused unless something outside of the group is being hinted\n\t\t\t// this happens dropping shapes from a group onto some outside group\n\t\t\t(shape.id !== focusLayerId || isHintingOtherGroup)\n\t\t) {\n\t\t\treturn null\n\t\t}\n\n\t\tconst bounds = this.bounds(shape)\n\n\t\treturn (\n\t\t\t<SVGContainer id={shape.id}>\n\t\t\t\t<GroupOutlineBox className=\"rs-group\" bounds={bounds} zoomLevel={zoomLevel} />\n\t\t\t</SVGContainer>\n\t\t)\n\t}\n\n\tindicator(shape: TLGroupShape) {\n\t\t// Not a class component, but eslint can't tell that :(\n\t\tconst {\n\t\t\tcamera: { z: zoomLevel },\n\t\t} = this.app\n\n\t\tconst bounds = this.bounds(shape)\n\n\t\treturn <GroupOutlineBox className=\"\" bounds={bounds} zoomLevel={zoomLevel} />\n\t}\n\n\tonChildrenChange: OnChildrenChangeHandler<TLGroupShape> = (group) => {\n\t\tconst children = this.app.getSortedChildIds(group.id)\n\t\tif (children.length === 0) {\n\t\t\tif (this.app.pageState.focusLayerId === group.id) {\n\t\t\t\tthis.app.popFocusLayer()\n\t\t\t}\n\t\t\tthis.app.deleteShapes([group.id])\n\t\t\treturn\n\t\t} else if (children.length === 1) {\n\t\t\tif (this.app.pageState.focusLayerId === group.id) {\n\t\t\t\tthis.app.popFocusLayer()\n\t\t\t}\n\t\t\tthis.app.reparentShapesById(children, group.parentId)\n\t\t\tthis.app.deleteShapes([group.id])\n\t\t\treturn\n\t\t}\n\t}\n}\n\n/** @public */\nexport const TLGroupShapeDef = defineShape<TLGroupShape, TLGroupUtil>({\n\ttype: 'group',\n\tgetShapeUtil: () => TLGroupUtil,\n\tvalidator: groupShapeTypeValidator,\n\tmigrations: groupShapeMigrations,\n})\n\nfunction GroupOutlineBox({\n\tbounds,\n\tzoomLevel,\n\tclassName,\n}: {\n\tbounds: Box2d\n\tzoomLevel: number\n\tclassName: string\n}) {\n\treturn (\n\t\t<g className={className} pointerEvents=\"none\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n\t\t\t{bounds.sides.map((side, i) => {\n\t\t\t\tconst { strokeDasharray, strokeDashoffset } = getPerfectDashProps(\n\t\t\t\t\tside[0].dist(side[1]),\n\t\t\t\t\t1 / zoomLevel,\n\t\t\t\t\t{\n\t\t\t\t\t\tstyle: 'dashed',\n\t\t\t\t\t\tlengthRatio: 4,\n\t\t\t\t\t}\n\t\t\t\t)\n\n\t\t\t\treturn (\n\t\t\t\t\t<line\n\t\t\t\t\t\tkey={i}\n\t\t\t\t\t\tx1={side[0].x}\n\t\t\t\t\t\ty1={side[0].y}\n\t\t\t\t\t\tx2={side[1].x}\n\t\t\t\t\t\ty2={side[1].y}\n\t\t\t\t\t\tstrokeDasharray={strokeDasharray}\n\t\t\t\t\t\tstrokeDashoffset={strokeDashoffset}\n\t\t\t\t\t/>\n\t\t\t\t)\n\t\t\t})}\n\t\t</g>\n\t)\n}\n","/* eslint-disable react-hooks/rules-of-hooks */\nimport { toDomPrecision } from '@tldraw/primitives'\nimport { imageShapeMigrations, imageShapeTypeValidator, TLImageShape } from '@tldraw/tlschema'\nimport { useEffect, useState } from 'react'\nimport { HTMLContainer } from '../../../components/HTMLContainer'\nimport { Spinner } from '../../../components/Spinner'\nimport { defineShape } from '../../../config/TLShapeDefinition'\nimport { usePrefersReducedMotion } from '../../../utils'\nimport { HyperlinkButton } from '../shared/HyperlinkButton'\nimport { TLBoxUtil } from '../TLBoxUtil'\n\nconst loadImage = async (url: string): Promise<HTMLImageElement> => {\n\treturn new Promise((resolve, reject) => {\n\t\tconst image = new Image()\n\t\timage.onload = () => resolve(image)\n\t\timage.onerror = () => reject(new Error('Failed to load image'))\n\t\timage.crossOrigin = 'anonymous'\n\t\timage.src = url\n\t})\n}\n\nconst getStateFrame = async (url: string) => {\n\tconst image = await loadImage(url)\n\n\tconst canvas = document.createElement('canvas')\n\tcanvas.width = image.width\n\tcanvas.height = image.height\n\n\tconst ctx = canvas.getContext('2d')\n\tif (!ctx) return\n\n\tctx.drawImage(image, 0, 0)\n\treturn canvas.toDataURL()\n}\n\nasync function getDataURIFromURL(url: string): Promise<string> {\n\tconst response = await fetch(url)\n\tconst blob = await response.blob()\n\treturn new Promise((resolve, reject) => {\n\t\tconst reader = new FileReader()\n\t\treader.onloadend = () => resolve(reader.result as string)\n\t\treader.onerror = reject\n\t\treader.readAsDataURL(blob)\n\t})\n}\n\n/** @public */\nexport class TLImageUtil extends TLBoxUtil<TLImageShape> {\n\tstatic type = 'image'\n\n\toverride isAspectRatioLocked = () => true\n\n\toverride defaultProps(): TLImageShape['props'] {\n\t\treturn {\n\t\t\topacity: '1',\n\t\t\tw: 100,\n\t\t\th: 100,\n\t\t\tassetId: null,\n\t\t\tplaying: true,\n\t\t\turl: '',\n\t\t}\n\t}\n\n\trender(shape: TLImageShape) {\n\t\tconst [staticFrameSrc, setStaticFrameSrc] = useState('')\n\n\t\tconst prefersReducedMotion = usePrefersReducedMotion()\n\t\tconst asset = shape.props.assetId ? this.app.getAssetById(shape.props.assetId) : undefined\n\t\tconst { w, h } = shape.props\n\n\t\tuseEffect(() => {\n\t\t\tif (asset?.props.src && 'mimeType' in asset.props && asset?.props.mimeType === 'image/gif') {\n\t\t\t\tlet cancelled = false\n\t\t\t\tconst run = async () => {\n\t\t\t\t\tconst newStaticFrame = await getStateFrame(asset.props.src!)\n\t\t\t\t\tif (cancelled) return\n\t\t\t\t\tif (newStaticFrame) {\n\t\t\t\t\t\tsetStaticFrameSrc(newStaticFrame)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\trun()\n\n\t\t\t\treturn () => {\n\t\t\t\t\tcancelled = true\n\t\t\t\t}\n\t\t\t}\n\t\t}, [prefersReducedMotion, asset?.props])\n\n\t\tif (asset?.type === 'bookmark') {\n\t\t\tthrow Error(\"Bookmark assets can't be rendered as images\")\n\t\t}\n\n\t\t// We only want to reduce motion for mimeTypes that have motion\n\t\tconst reduceMotion =\n\t\t\tprefersReducedMotion &&\n\t\t\t(asset?.props.mimeType?.includes('video') || asset?.props.mimeType?.includes('gif'))\n\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<HTMLContainer id={shape.id}>\n\t\t\t\t\t<div className=\"rs-image-container\">\n\t\t\t\t\t\t{asset?.props.src ? (\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclassName={`rs-image rs-image-${shape.id}`}\n\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\tbackgroundImage: `url(${\n\t\t\t\t\t\t\t\t\t\t!shape.props.playing || reduceMotion ? staticFrameSrc : asset.props.src\n\t\t\t\t\t\t\t\t\t}`,\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\tdraggable={false}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t<Spinner x={(w - 38) / 2} y={(h - 38) / 2} />\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{asset?.props.isAnimated && !shape.props.playing && (\n\t\t\t\t\t\t\t<div className=\"rs-image__meda-tag\">GIF</div>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t</HTMLContainer>\n\t\t\t\t{'url' in shape.props && shape.props.url && <HyperlinkButton url={shape.props.url} />}\n\t\t\t</>\n\t\t)\n\t}\n\n\tindicator(shape: TLImageShape) {\n\t\treturn <rect width={toDomPrecision(shape.props.w)} height={toDomPrecision(shape.props.h)} />\n\t}\n\n\tasync toSvg(shape: TLImageShape) {\n\t\tconst g = document.createElementNS('http://www.w3.org/2000/svg', 'g')\n\t\tconst asset = shape.props.assetId ? this.app.getAssetById(shape.props.assetId) : null\n\n\t\tlet src = asset?.props.src || ''\n\t\tif (src && src.startsWith('http')) {\n\t\t\t// If it's a remote image, we need to fetch it and convert it to a data URI\n\t\t\tsrc = (await getDataURIFromURL(src)) || ''\n\t\t}\n\n\t\tconst image = document.createElementNS('http://www.w3.org/2000/svg', 'image')\n\t\timage.setAttributeNS('http://www.w3.org/1999/xlink', 'href', src)\n\t\timage.setAttribute('width', shape.props.w.toString())\n\t\timage.setAttribute('height', shape.props.h.toString())\n\t\tg.appendChild(image)\n\n\t\treturn g\n\t}\n\n\tonDoubleClick = (shape: TLImageShape) => {\n\t\tconst asset = shape.props.assetId ? this.app.getAssetById(shape.props.assetId) : undefined\n\n\t\tif (!asset) return\n\n\t\tconst canPlay =\n\t\t\tasset.props.src && 'mimeType' in asset.props && asset.props.mimeType === 'image/gif'\n\n\t\tif (!canPlay) return\n\n\t\tthis.app.updateShapes([\n\t\t\t{\n\t\t\t\ttype: 'image',\n\t\t\t\tid: shape.id,\n\t\t\t\tprops: {\n\t\t\t\t\tplaying: !shape.props.playing,\n\t\t\t\t},\n\t\t\t},\n\t\t])\n\t}\n}\n\n/** @public */\nexport const TLImageShapeDef = defineShape<TLImageShape, TLImageUtil>({\n\ttype: 'image',\n\tgetShapeUtil: () => TLImageUtil,\n\tvalidator: imageShapeTypeValidator,\n\tmigrations: imageShapeMigrations,\n})\n","import {\n\tCubicSpline2d,\n\tgetStrokeOutlinePoints,\n\tgetStrokePoints,\n\tPolyline2d,\n\tsetStrokePointRadii,\n\tVec2d,\n} from '@tldraw/primitives'\nimport { TLLineShape } from '@tldraw/tlschema'\nimport { getSvgPathFromStroke, getSvgPathFromStrokePoints } from '../../../../utils'\n\nexport function getLinePoints(spline: CubicSpline2d | Polyline2d) {\n\tconst { segments } = spline\n\n\tconst allPoints: Vec2d[] = []\n\n\tfor (let j = 0, k = segments.length; j < k; j++) {\n\t\tconst segment = segments[j]\n\t\tconst lut = segment.lut\n\n\t\tconst n = lut.length - 1\n\n\t\tif (j > 0) {\n\t\t\tallPoints.push(Vec2d.Lrp(lut[0], lut[1], 0.25))\n\t\t} else {\n\t\t\tallPoints.push(lut[0])\n\t\t}\n\n\t\tfor (let i = 1; i < n; i++) {\n\t\t\tallPoints.push(lut[i])\n\t\t}\n\n\t\tif (j < k - 1) {\n\t\t\tallPoints.push(Vec2d.Lrp(lut[n - 1], lut[n], 0.75))\n\t\t} else {\n\t\t\tallPoints.push(lut[n])\n\t\t}\n\t}\n\n\treturn allPoints\n}\n\nexport function getLineDrawFreehandOptions(strokeWidth: number) {\n\treturn {\n\t\tsize: strokeWidth * 1.25,\n\t\tthinning: 0.4,\n\t\tstreamline: 0,\n\t\tsmoothing: 0.5,\n\t\tsimulatePressure: true,\n\t\tlast: true,\n\t}\n}\n\nexport function getLineSolidFreehandOptions(strokeWidth: number) {\n\treturn {\n\t\tsize: strokeWidth,\n\t\tthinning: 0,\n\t\tstreamline: 0,\n\t\tsmoothing: 0.5,\n\t\tsimulatePressure: false,\n\t\tlast: true,\n\t}\n}\n\nexport function getLineStrokePoints(\n\tshape: TLLineShape,\n\tspline: CubicSpline2d | Polyline2d,\n\tstrokeWidth: number\n) {\n\tconst points = getLinePoints(spline)\n\n\tconst options = getLineDrawFreehandOptions(strokeWidth)\n\n\treturn getStrokePoints(points, options)\n}\n\nexport function getLineDrawStrokeOutlinePoints(\n\tshape: TLLineShape,\n\tspline: CubicSpline2d | Polyline2d,\n\tstrokeWidth: number\n) {\n\tconst options = getLineDrawFreehandOptions(strokeWidth)\n\treturn getStrokeOutlinePoints(\n\t\tsetStrokePointRadii(getLineStrokePoints(shape, spline, strokeWidth), options),\n\t\toptions\n\t)\n}\n\nexport function getLineSolidStrokeOutlinePoints(\n\tshape: TLLineShape,\n\tspline: CubicSpline2d | Polyline2d,\n\tstrokeWidth: number\n) {\n\tconst options = getLineSolidFreehandOptions(strokeWidth)\n\treturn getStrokeOutlinePoints(getLineStrokePoints(shape, spline, strokeWidth), options)\n}\n\nexport function getLineDrawPath(\n\tshape: TLLineShape,\n\tspline: CubicSpline2d | Polyline2d,\n\tstrokeWidth: number\n) {\n\tconst stroke = getLineDrawStrokeOutlinePoints(shape, spline, strokeWidth)\n\treturn getSvgPathFromStroke(stroke)\n}\n\nexport function getLineSolidPath(\n\tshape: TLLineShape,\n\tspline: CubicSpline2d | Polyline2d,\n\tstrokeWidth: number\n) {\n\tconst outlinePoints = getLineSolidStrokeOutlinePoints(shape, spline, strokeWidth)\n\treturn getSvgPathFromStroke(outlinePoints)\n}\n\nexport function getLineIndicatorPath(\n\tshape: TLLineShape,\n\tspline: CubicSpline2d | Polyline2d,\n\tstrokeWidth: number\n) {\n\tif (shape.props.dash === 'draw') {\n\t\tconst strokePoints = getLineStrokePoints(shape, spline, strokeWidth)\n\t\treturn getSvgPathFromStrokePoints(strokePoints)\n\t}\n\n\treturn spline.path\n}\n","import { CubicSpline2d, Polyline2d } from '@tldraw/primitives'\nimport { TLDashType, TLLineShape } from '@tldraw/tlschema'\nimport { getPerfectDashProps } from '../../shared'\nimport { getLineDrawPath } from './getLinePath'\n\nexport function getDrawLineShapeSvg({\n\tshape,\n\tstrokeWidth,\n\tspline,\n\tcolor,\n}: {\n\tshape: TLLineShape\n\tstrokeWidth: number\n\tspline: CubicSpline2d | Polyline2d\n\tcolor: string\n}) {\n\tconst pfPath = getLineDrawPath(shape, spline, strokeWidth)\n\n\tconst p = document.createElementNS('http://www.w3.org/2000/svg', 'path')\n\tp.setAttribute('stroke-width', '0')\n\tp.setAttribute('stroke', 'none')\n\tp.setAttribute('fill', color)\n\tp.setAttribute('d', pfPath)\n\n\treturn p\n}\n\nexport function getDashedLineShapeSvg({\n\tdash,\n\tstrokeWidth,\n\tspline,\n\tcolor,\n}: {\n\tdash: TLDashType\n\tstrokeWidth: number\n\tspline: CubicSpline2d | Polyline2d\n\tcolor: string\n}) {\n\tconst { segments } = spline\n\n\tconst g = document.createElementNS('http://www.w3.org/2000/svg', 'g')\n\tg.setAttribute('stroke', color)\n\tg.setAttribute('stroke-width', strokeWidth.toString())\n\n\tsegments.forEach((segment, i) => {\n\t\tconst path = document.createElementNS('http://www.w3.org/2000/svg', 'path')\n\t\tconst { strokeDasharray, strokeDashoffset } = getPerfectDashProps(segment.length, strokeWidth, {\n\t\t\tstyle: dash,\n\t\t\tstart: i > 0 ? 'outset' : 'none',\n\t\t\tend: i < segments.length - 1 ? 'outset' : 'none',\n\t\t})\n\n\t\tpath.setAttribute('stroke-dasharray', strokeDasharray.toString())\n\t\tpath.setAttribute('stroke-dashoffset', strokeDashoffset.toString())\n\t\tpath.setAttribute('d', segment.path)\n\t\tpath.setAttribute('fill', 'none')\n\t\tg.appendChild(path)\n\t})\n\n\treturn g\n}\n\nexport function getSolidLineShapeSvg({\n\tstrokeWidth,\n\tspline,\n\tcolor,\n}: {\n\tstrokeWidth: number\n\tspline: CubicSpline2d | Polyline2d\n\tcolor: string\n}) {\n\tconst { path } = spline\n\n\tconst p = document.createElementNS('http://www.w3.org/2000/svg', 'path')\n\tp.setAttribute('stroke-width', strokeWidth.toString())\n\tp.setAttribute('stroke', color)\n\tp.setAttribute('fill', 'none')\n\tp.setAttribute('d', path)\n\n\treturn p\n}\n\nexport function getLineSvg(\n\tshape: TLLineShape,\n\tspline: CubicSpline2d | Polyline2d,\n\tcolor: string,\n\tstrokeWidth: number\n) {\n\tswitch (shape.props.dash) {\n\t\tcase 'draw':\n\t\t\treturn getDrawLineShapeSvg({\n\t\t\t\tshape,\n\t\t\t\tstrokeWidth,\n\t\t\t\tspline,\n\t\t\t\tcolor,\n\t\t\t})\n\n\t\tcase 'solid':\n\t\t\treturn getSolidLineShapeSvg({\n\t\t\t\tstrokeWidth,\n\t\t\t\tspline,\n\t\t\t\tcolor,\n\t\t\t})\n\t\tdefault:\n\t\t\treturn getDashedLineShapeSvg({\n\t\t\t\tstrokeWidth,\n\t\t\t\tspline,\n\t\t\t\tdash: shape.props.dash,\n\t\t\t\tcolor,\n\t\t\t})\n\t}\n}\n","/* eslint-disable react-hooks/rules-of-hooks */\nimport {\n\tCubicSpline2d,\n\tintersectLineSegmentPolyline,\n\tpointNearToPolyline,\n\tPolyline2d,\n\tVec2d,\n\tVecLike,\n} from '@tldraw/primitives'\nimport {\n\tlineShapeMigrations,\n\tlineShapeTypeValidator,\n\tTLHandle,\n\tTLLineShape,\n} from '@tldraw/tlschema'\nimport { deepCopy } from '@tldraw/utils'\nimport { useValue } from 'signia-react'\nimport { SVGContainer } from '../../../components/SVGContainer'\nimport { defineShape } from '../../../config/TLShapeDefinition'\nimport { getIndexBetween, sortByIndex, WeakMapCache } from '../../../utils'\nimport { getPerfectDashProps, ShapeFill, TLExportColors } from '../shared'\nimport { OnHandleChangeHandler, OnResizeHandler, TLShapeUtil } from '../TLShapeUtil'\nimport { getLineDrawPath, getLineIndicatorPath, getLinePoints } from './components/getLinePath'\nimport { getLineSvg } from './components/getLineSvg'\n\nconst splinesCache = new WeakMapCache<TLLineShape['props'], CubicSpline2d | Polyline2d>()\nconst handlesCache = new WeakMapCache<TLLineShape['props'], TLHandle[]>()\n\n/** @public */\nexport class TLLineUtil extends TLShapeUtil<TLLineShape> {\n\tstatic type = 'line'\n\n\toverride hideResizeHandles = () => true\n\toverride hideRotateHandle = () => true\n\toverride hideSelectionBoundsBg = () => true\n\toverride hideSelectionBoundsFg = () => true\n\toverride isClosed = () => false\n\n\toverride defaultProps(): TLLineShape['props'] {\n\t\treturn {\n\t\t\topacity: '1',\n\t\t\tdash: 'draw',\n\t\t\tsize: 'm',\n\t\t\tcolor: 'black',\n\t\t\tspline: 'line',\n\t\t\thandles: {\n\t\t\t\tstart: {\n\t\t\t\t\tid: 'start',\n\t\t\t\t\ttype: 'vertex',\n\t\t\t\t\tcanBind: false,\n\t\t\t\t\tindex: 'a1',\n\t\t\t\t\tx: 0,\n\t\t\t\t\ty: 0,\n\t\t\t\t},\n\t\t\t\tend: {\n\t\t\t\t\tid: 'end',\n\t\t\t\t\ttype: 'vertex',\n\t\t\t\t\tcanBind: false,\n\t\t\t\t\tindex: 'a2',\n\t\t\t\t\tx: 0,\n\t\t\t\t\ty: 0,\n\t\t\t\t},\n\t\t\t},\n\t\t}\n\t}\n\n\tgetBounds(shape: TLLineShape) {\n\t\t// todo: should we have min size?\n\t\tconst spline = getSplineForLineShape(shape)\n\t\treturn spline.bounds\n\t}\n\n\tgetCenter(shape: TLLineShape) {\n\t\treturn this.bounds(shape).center\n\t}\n\n\tgetHandles(shape: TLLineShape) {\n\t\treturn handlesCache.get(shape.props, () => {\n\t\t\tconst handles = shape.props.handles\n\n\t\t\tconst spline = getSplineForLineShape(shape)\n\n\t\t\tconst sortedHandles = Object.values(handles).sort(sortByIndex)\n\t\t\tconst results = sortedHandles.slice()\n\n\t\t\t// Add \"hint\" handles between each vertex handle\n\t\t\tfor (let i = 0; i < spline.segments.length; i++) {\n\t\t\t\tconst segment = spline.segments[i]\n\n\t\t\t\tconst point = segment.getPoint(0.5)\n\n\t\t\t\tconst index = getIndexBetween(sortedHandles[i].index, sortedHandles[i + 1].index)\n\n\t\t\t\tresults.push({\n\t\t\t\t\tid: `mid-${i}`,\n\t\t\t\t\ttype: 'create',\n\t\t\t\t\tindex,\n\t\t\t\t\tx: point.x,\n\t\t\t\t\ty: point.y,\n\t\t\t\t})\n\t\t\t}\n\t\t\treturn results.sort(sortByIndex)\n\t\t})\n\t}\n\n\tgetOutline(shape: TLLineShape) {\n\t\treturn getLinePoints(getSplineForLineShape(shape))\n\t}\n\n\t//   Events\n\n\tonResize: OnResizeHandler<TLLineShape> = (shape, info) => {\n\t\tconst { scaleX, scaleY } = info\n\n\t\tconst handles = deepCopy(shape.props.handles)\n\n\t\tObject.values(shape.props.handles).forEach(({ id, x, y }) => {\n\t\t\thandles[id].x = x * scaleX\n\t\t\thandles[id].y = y * scaleY\n\t\t})\n\n\t\treturn {\n\t\t\tprops: {\n\t\t\t\thandles,\n\t\t\t},\n\t\t}\n\t}\n\n\tonHandleChange: OnHandleChangeHandler<TLLineShape> = (shape, { handle }) => {\n\t\tconst next = deepCopy(shape)\n\n\t\tswitch (handle.id) {\n\t\t\tcase 'start':\n\t\t\tcase 'end': {\n\t\t\t\tnext.props.handles[handle.id] = {\n\t\t\t\t\t...next.props.handles[handle.id],\n\t\t\t\t\tx: handle.x,\n\t\t\t\t\ty: handle.y,\n\t\t\t\t}\n\t\t\t\tbreak\n\t\t\t}\n\n\t\t\tdefault: {\n\t\t\t\tconst id = 'handle:' + handle.index\n\t\t\t\tconst existing = shape.props.handles[id]\n\n\t\t\t\tif (existing) {\n\t\t\t\t\tnext.props.handles[id] = {\n\t\t\t\t\t\t...existing,\n\t\t\t\t\t\tx: handle.x,\n\t\t\t\t\t\ty: handle.y,\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tnext.props.handles[id] = {\n\t\t\t\t\t\tid,\n\t\t\t\t\t\ttype: 'vertex',\n\t\t\t\t\t\tcanBind: false,\n\t\t\t\t\t\tindex: handle.index,\n\t\t\t\t\t\tx: handle.x,\n\t\t\t\t\t\ty: handle.y,\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tbreak\n\t\t\t}\n\t\t}\n\n\t\treturn next\n\t}\n\n\thitTestPoint(shape: TLLineShape, point: Vec2d): boolean {\n\t\treturn pointNearToPolyline(point, this.outline(shape))\n\t}\n\n\thitTestLineSegment(shape: TLLineShape, A: VecLike, B: VecLike): boolean {\n\t\treturn intersectLineSegmentPolyline(A, B, this.outline(shape)) !== null\n\t}\n\n\trender(shape: TLLineShape) {\n\t\tconst spline = getSplineForLineShape(shape)\n\t\tconst forceSolid = useValue('zoom', () => this.app.zoomLevel < 0.35, [])\n\t\tconst strokeWidth = this.app.getStrokeWidth(shape.props.size)\n\t\tconst splinePath = spline.path\n\n\t\tconst { dash, color } = shape.props\n\n\t\treturn (\n\t\t\t<SVGContainer id={shape.id}>\n\t\t\t\t<ShapeFill d={splinePath} fill={'none'} color={color} />\n\t\t\t\t{dash === 'draw' && !forceSolid ? (\n\t\t\t\t\t<path\n\t\t\t\t\t\td={getLineDrawPath(shape, spline, strokeWidth)}\n\t\t\t\t\t\tstrokeWidth={1}\n\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t/>\n\t\t\t\t) : dash === 'solid' ? (\n\t\t\t\t\t<path strokeWidth={strokeWidth} stroke=\"currentColor\" fill=\"none\" d={splinePath} />\n\t\t\t\t) : (\n\t\t\t\t\t<g stroke=\"currentColor\" strokeWidth={strokeWidth}>\n\t\t\t\t\t\t{spline.segments.map((segment, i) => {\n\t\t\t\t\t\t\tconst { strokeDasharray, strokeDashoffset } = getPerfectDashProps(\n\t\t\t\t\t\t\t\tsegment.length,\n\t\t\t\t\t\t\t\tstrokeWidth,\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tstyle: dash,\n\t\t\t\t\t\t\t\t\tstart: i > 0 ? 'outset' : 'none',\n\t\t\t\t\t\t\t\t\tend: i < spline.segments.length - 1 ? 'outset' : 'none',\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t)\n\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\tkey={i}\n\t\t\t\t\t\t\t\t\tstrokeDasharray={strokeDasharray}\n\t\t\t\t\t\t\t\t\tstrokeDashoffset={strokeDashoffset}\n\t\t\t\t\t\t\t\t\td={segment.path}\n\t\t\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t})}\n\t\t\t\t\t</g>\n\t\t\t\t)}\n\t\t\t</SVGContainer>\n\t\t)\n\t}\n\n\tindicator(shape: TLLineShape) {\n\t\tconst strokeWidth = this.app.getStrokeWidth(shape.props.size)\n\t\tconst path = getLineIndicatorPath(shape, getSplineForLineShape(shape), strokeWidth)\n\t\treturn <path d={path} />\n\t}\n\n\ttoSvg(shape: TLLineShape, _font: string, colors: TLExportColors) {\n\t\tconst { color: _color, size } = shape.props\n\t\tconst color = colors.fill[_color]\n\t\tconst spline = getSplineForLineShape(shape)\n\t\treturn getLineSvg(shape, spline, color, this.app.getStrokeWidth(size))\n\t}\n}\n\n/** @public */\nexport const TLLineShapeDef = defineShape<TLLineShape, TLLineUtil>({\n\ttype: 'line',\n\tgetShapeUtil: () => TLLineUtil,\n\tvalidator: lineShapeTypeValidator,\n\tmigrations: lineShapeMigrations,\n})\n\n/** @public */\nexport function getSplineForLineShape(shape: TLLineShape) {\n\treturn splinesCache.get(shape.props, () => {\n\t\tconst { spline, handles } = shape.props\n\n\t\tconst handlePoints = Object.values(handles).sort(sortByIndex).map(Vec2d.From)\n\n\t\tswitch (spline) {\n\t\t\tcase 'cubic': {\n\t\t\t\treturn new CubicSpline2d(handlePoints, handlePoints.length === 2 ? 2 : 1.2, 20)\n\t\t\t}\n\t\t\tcase 'line': {\n\t\t\t\treturn new Polyline2d(handlePoints)\n\t\t\t}\n\t\t}\n\t})\n}\n","import { Box2d, toDomPrecision, Vec2d } from '@tldraw/primitives'\nimport { noteShapeMigrations, noteShapeTypeValidator, TLNoteShape } from '@tldraw/tlschema'\nimport { defineShape } from '../../../config/TLShapeDefinition'\nimport { FONT_FAMILIES, LABEL_FONT_SIZES, TEXT_PROPS } from '../../../constants'\nimport { App } from '../../App'\nimport { TLExportColors } from '../shared'\nimport { getTextSvgElement } from '../shared/getTextSvgElement'\nimport { HyperlinkButton } from '../shared/HyperlinkButton'\nimport { TextLabel } from '../shared/TextLabel'\nimport { OnEditEndHandler, TLShapeUtil } from '../TLShapeUtil'\n\nconst NOTE_SIZE = 200\n\n/** @public */\nexport class TLNoteUtil extends TLShapeUtil<TLNoteShape> {\n\tstatic type = 'note'\n\n\tcanEdit = () => true\n\thideResizeHandles = () => true\n\thideSelectionBoundsBg = () => true\n\thideSelectionBoundsFg = () => true\n\n\tdefaultProps(): TLNoteShape['props'] {\n\t\treturn {\n\t\t\topacity: '1',\n\t\t\tcolor: 'black',\n\t\t\tsize: 'm',\n\t\t\ttext: '',\n\t\t\tfont: 'draw',\n\t\t\talign: 'middle',\n\t\t\tgrowY: 0,\n\t\t\turl: '',\n\t\t}\n\t}\n\n\tgetHeight(shape: TLNoteShape) {\n\t\treturn NOTE_SIZE + shape.props.growY\n\t}\n\n\tgetBounds(shape: TLNoteShape) {\n\t\tconst height = this.getHeight(shape)\n\t\treturn new Box2d(0, 0, NOTE_SIZE, height)\n\t}\n\n\tgetOutline(shape: TLNoteShape) {\n\t\treturn this.bounds(shape).corners\n\t}\n\n\tgetCenter(_shape: TLNoteShape) {\n\t\treturn new Vec2d(NOTE_SIZE / 2, this.getHeight(_shape) / 2)\n\t}\n\n\trender(shape: TLNoteShape) {\n\t\tconst {\n\t\t\tid,\n\t\t\ttype,\n\t\t\tprops: { color, font, size, align, text },\n\t\t} = shape\n\n\t\tconst adjustedColor = color === 'black' ? 'yellow' : color\n\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<div\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\twidth: NOTE_SIZE,\n\t\t\t\t\t\theight: this.getHeight(shape),\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclassName=\"rs-note__container rs-hitarea-fill\"\n\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\tcolor: `var(--palette-${adjustedColor})`,\n\t\t\t\t\t\t\tbackgroundColor: `var(--palette-${adjustedColor})`,\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<div className=\"rs-note__scrim\" />\n\t\t\t\t\t\t<TextLabel\n\t\t\t\t\t\t\tid={id}\n\t\t\t\t\t\t\ttype={type}\n\t\t\t\t\t\t\tfont={font}\n\t\t\t\t\t\t\tsize={size}\n\t\t\t\t\t\t\talign={align}\n\t\t\t\t\t\t\ttext={text}\n\t\t\t\t\t\t\tlabelColor=\"inherit\"\n\t\t\t\t\t\t\twrap\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t{'url' in shape.props && shape.props.url && <HyperlinkButton url={shape.props.url} />}\n\t\t\t</>\n\t\t)\n\t}\n\n\tindicator(shape: TLNoteShape) {\n\t\treturn (\n\t\t\t<rect\n\t\t\t\trx=\"7\"\n\t\t\t\twidth={toDomPrecision(NOTE_SIZE)}\n\t\t\t\theight={toDomPrecision(this.getHeight(shape))}\n\t\t\t/>\n\t\t)\n\t}\n\n\ttoSvg(shape: TLNoteShape, font: string, colors: TLExportColors) {\n\t\tconst bounds = this.bounds(shape)\n\n\t\tconst g = document.createElementNS('http://www.w3.org/2000/svg', 'g')\n\n\t\tconst adjustedColor = shape.props.color === 'black' ? 'yellow' : shape.props.color\n\n\t\tconst rect1 = document.createElementNS('http://www.w3.org/2000/svg', 'rect')\n\t\trect1.setAttribute('rx', '10')\n\t\trect1.setAttribute('width', NOTE_SIZE.toString())\n\t\trect1.setAttribute('height', bounds.height.toString())\n\t\trect1.setAttribute('fill', colors.fill[adjustedColor])\n\t\trect1.setAttribute('stroke', colors.fill[adjustedColor])\n\t\trect1.setAttribute('stroke-width', '1')\n\t\tg.appendChild(rect1)\n\n\t\tconst rect2 = document.createElementNS('http://www.w3.org/2000/svg', 'rect')\n\t\trect2.setAttribute('rx', '10')\n\t\trect2.setAttribute('width', NOTE_SIZE.toString())\n\t\trect2.setAttribute('height', bounds.height.toString())\n\t\trect2.setAttribute('fill', colors.background)\n\t\trect2.setAttribute('opacity', '.28')\n\t\tg.appendChild(rect2)\n\n\t\tconst PADDING = 17\n\n\t\tconst opts = {\n\t\t\tfontSize: LABEL_FONT_SIZES[shape.props.size],\n\t\t\tfontFamily: font,\n\t\t\ttextAlign: shape.props.align,\n\t\t\twidth: bounds.width - PADDING * 2,\n\t\t\theight: bounds.height - PADDING * 2,\n\t\t\tpadding: 0,\n\t\t\tlineHeight: TEXT_PROPS.lineHeight,\n\t\t\tfontStyle: 'normal',\n\t\t\tfontWeight: 'normal',\n\t\t}\n\n\t\tconst lines = this.app.textMeasure.getTextLines({\n\t\t\ttext: shape.props.text,\n\t\t\twrap: true,\n\t\t\t...opts,\n\t\t})\n\n\t\tconst textElm = getTextSvgElement(this.app, {\n\t\t\tlines,\n\t\t\t...opts,\n\t\t})\n\n\t\ttextElm.setAttribute('fill', colors.text)\n\t\ttextElm.setAttribute('transform', `translate(${PADDING} ${PADDING})`)\n\t\tg.appendChild(textElm)\n\n\t\treturn g\n\t}\n\n\tonBeforeCreate = (next: TLNoteShape) => {\n\t\treturn getGrowY(this.app, next, next.props.growY)\n\t}\n\n\tonBeforeUpdate = (prev: TLNoteShape, next: TLNoteShape) => {\n\t\tif (\n\t\t\tprev.props.text === next.props.text &&\n\t\t\tprev.props.font === next.props.font &&\n\t\t\tprev.props.size === next.props.size\n\t\t) {\n\t\t\treturn\n\t\t}\n\n\t\treturn getGrowY(this.app, next, prev.props.growY)\n\t}\n\n\tonEditEnd: OnEditEndHandler<TLNoteShape> = (shape) => {\n\t\tconst {\n\t\t\tid,\n\t\t\ttype,\n\t\t\tprops: { text },\n\t\t} = shape\n\n\t\tif (text.trim() !== shape.props.text) {\n\t\t\tthis.app.updateShapes([\n\t\t\t\t{\n\t\t\t\t\tid,\n\t\t\t\t\ttype,\n\t\t\t\t\tprops: {\n\t\t\t\t\t\ttext: text.trim(),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t])\n\t\t}\n\t}\n}\n\n/** @public */\nexport const TLNoteShapeDef = defineShape<TLNoteShape, TLNoteUtil>({\n\tgetShapeUtil: () => TLNoteUtil,\n\ttype: 'note',\n\tvalidator: noteShapeTypeValidator,\n\tmigrations: noteShapeMigrations,\n})\n\nfunction getGrowY(app: App, shape: TLNoteShape, prevGrowY = 0) {\n\tconst PADDING = 17\n\n\tconst nextTextSize = app.textMeasure.measureText({\n\t\t...TEXT_PROPS,\n\t\ttext: shape.props.text,\n\t\tfontFamily: FONT_FAMILIES[shape.props.font],\n\t\tfontSize: LABEL_FONT_SIZES[shape.props.size],\n\t\twidth: NOTE_SIZE - PADDING * 2 + 'px',\n\t})\n\n\tconst nextHeight = nextTextSize.h + PADDING * 2\n\n\tlet growY: number | null = null\n\n\tif (nextHeight > NOTE_SIZE) {\n\t\tgrowY = nextHeight - NOTE_SIZE\n\t} else {\n\t\tif (prevGrowY) {\n\t\t\tgrowY = 0\n\t\t}\n\t}\n\n\tif (growY !== null) {\n\t\treturn {\n\t\t\t...shape,\n\t\t\tprops: {\n\t\t\t\t...shape.props,\n\t\t\t\tgrowY,\n\t\t\t},\n\t\t}\n\t}\n}\n","/* eslint-disable react-hooks/rules-of-hooks */\nimport { Box2d, toDomPrecision, Vec2d } from '@tldraw/primitives'\nimport { textShapeMigrations, textShapeTypeValidator, TLTextShape } from '@tldraw/tlschema'\nimport { HTMLContainer } from '../../../components/HTMLContainer/HTMLContainer'\nimport { defineShape } from '../../../config/TLShapeDefinition'\nimport { FONT_FAMILIES, FONT_SIZES, TEXT_PROPS } from '../../../constants'\nimport { WeakMapCache } from '../../../utils'\nimport { App } from '../../App'\nimport { stopEventPropagation, TLExportColors } from '../shared'\nimport { getTextSvgElement } from '../shared/getTextSvgElement'\nimport { resizeScaled } from '../shared/resizeScaled'\nimport { useEditableText } from '../shared/useEditableText'\nimport { OnEditEndHandler, OnResizeHandler, TLShapeUtil, TLShapeUtilFlag } from '../TLShapeUtil'\n\nconst sizeCache = new WeakMapCache<TLTextShape['props'], { height: number; width: number }>()\n\n/** @public */\nexport class TLTextUtil extends TLShapeUtil<TLTextShape> {\n\tstatic type = 'text'\n\n\tcanEdit = () => true\n\n\tisAspectRatioLocked: TLShapeUtilFlag<TLTextShape> = () => true\n\n\tdefaultProps(): TLTextShape['props'] {\n\t\treturn {\n\t\t\topacity: '1',\n\t\t\tcolor: 'black',\n\t\t\tsize: 'm',\n\t\t\tw: 8,\n\t\t\ttext: '',\n\t\t\tfont: 'draw',\n\t\t\talign: 'middle',\n\t\t\tautoSize: true,\n\t\t\tscale: 1,\n\t\t}\n\t}\n\n\t// @computed\n\t// private get minDimensionsCache() {\n\t// \treturn this.app.store.createSelectedComputedCache<\n\t// \t\tTLTextShape['props'],\n\t// \t\t{ width: number; height: number },\n\t// \t\tTLTextShape\n\t// \t>(\n\t// \t\t'text measure cache',\n\t// \t\t(shape) => {\n\t// \t\t\treturn shape.props\n\t// \t\t},\n\t// \t\t(props) => getTextSize(this.app, props)\n\t// \t)\n\t// }\n\n\tgetMinDimensions(shape: TLTextShape) {\n\t\treturn sizeCache.get(shape.props, (props) => getTextSize(this.app, props))\n\t}\n\n\tgetBounds(shape: TLTextShape) {\n\t\tconst { scale } = shape.props\n\t\tconst { width, height } = this.getMinDimensions(shape)!\n\t\treturn new Box2d(0, 0, width * scale, height * scale)\n\t}\n\n\tgetOutline(shape: TLTextShape) {\n\t\tconst bounds = this.bounds(shape)\n\n\t\treturn [\n\t\t\tnew Vec2d(0, 0),\n\t\t\tnew Vec2d(bounds.width, 0),\n\t\t\tnew Vec2d(bounds.width, bounds.height),\n\t\t\tnew Vec2d(0, bounds.height),\n\t\t]\n\t}\n\n\tgetCenter(shape: TLTextShape): Vec2d {\n\t\tconst bounds = this.bounds(shape)\n\t\treturn new Vec2d(bounds.width / 2, bounds.height / 2)\n\t}\n\n\trender(shape: TLTextShape) {\n\t\tconst {\n\t\t\tid,\n\t\t\ttype,\n\t\t\tprops: { text },\n\t\t} = shape\n\n\t\tconst { width, height } = this.getMinDimensions(shape)\n\n\t\tconst {\n\t\t\trInput,\n\t\t\tisEmpty,\n\t\t\tisEditing,\n\t\t\tisEditableFromHover,\n\t\t\thandleFocus,\n\t\t\thandleChange,\n\t\t\thandleKeyDown,\n\t\t\thandleBlur,\n\t\t} = useEditableText(id, type, text)\n\n\t\treturn (\n\t\t\t<HTMLContainer id={shape.id}>\n\t\t\t\t<div\n\t\t\t\t\tclassName=\"rs-text-shape__wrapper rs-text-shadow\"\n\t\t\t\t\tdata-font={shape.props.font}\n\t\t\t\t\tdata-align={shape.props.align}\n\t\t\t\t\tdata-hastext={!isEmpty}\n\t\t\t\t\tdata-isediting={isEditing || isEditableFromHover}\n\t\t\t\t\tdata-textwrap={true}\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\tfontSize: FONT_SIZES[shape.props.size],\n\t\t\t\t\t\tlineHeight: FONT_SIZES[shape.props.size] * TEXT_PROPS.lineHeight + 'px',\n\t\t\t\t\t\ttransform: `scale(${shape.props.scale})`,\n\t\t\t\t\t\ttransformOrigin: 'top left',\n\t\t\t\t\t\twidth: Math.max(1, width),\n\t\t\t\t\t\theight: Math.max(FONT_SIZES[shape.props.size] * TEXT_PROPS.lineHeight, height),\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<div className=\"rs-text rs-text-content\" dir=\"ltr\">\n\t\t\t\t\t\t{text}\n\t\t\t\t\t</div>\n\t\t\t\t\t{isEditing || isEditableFromHover ? (\n\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\tref={rInput}\n\t\t\t\t\t\t\tclassName=\"rs-text rs-text-input\"\n\t\t\t\t\t\t\tname=\"text\"\n\t\t\t\t\t\t\ttabIndex={-1}\n\t\t\t\t\t\t\tautoComplete=\"false\"\n\t\t\t\t\t\t\tautoCapitalize=\"false\"\n\t\t\t\t\t\t\tautoCorrect=\"false\"\n\t\t\t\t\t\t\tautoSave=\"false\"\n\t\t\t\t\t\t\tautoFocus={isEditing}\n\t\t\t\t\t\t\tplaceholder=\"\"\n\t\t\t\t\t\t\tspellCheck=\"true\"\n\t\t\t\t\t\t\twrap=\"off\"\n\t\t\t\t\t\t\tdir=\"ltr\"\n\t\t\t\t\t\t\tdatatype=\"wysiwyg\"\n\t\t\t\t\t\t\tdefaultValue={text}\n\t\t\t\t\t\t\tonFocus={handleFocus}\n\t\t\t\t\t\t\tonChange={handleChange}\n\t\t\t\t\t\t\tonKeyDown={handleKeyDown}\n\t\t\t\t\t\t\tonBlur={handleBlur}\n\t\t\t\t\t\t\tonTouchEnd={stopEventPropagation}\n\t\t\t\t\t\t\tonContextMenu={stopEventPropagation}\n\t\t\t\t\t\t/>\n\t\t\t\t\t) : null}\n\t\t\t\t</div>\n\t\t\t</HTMLContainer>\n\t\t)\n\t}\n\n\tindicator(shape: TLTextShape) {\n\t\tconst bounds = this.bounds(shape)\n\t\treturn <rect width={toDomPrecision(bounds.width)} height={toDomPrecision(bounds.height)} />\n\t}\n\n\ttoSvg(shape: TLTextShape, font: string | undefined, colors: TLExportColors) {\n\t\tconst bounds = this.bounds(shape)\n\t\tconst text = shape.props.text\n\n\t\tconst width = bounds.width / (shape.props.scale ?? 1)\n\t\tconst height = bounds.height / (shape.props.scale ?? 1)\n\n\t\tconst opts = {\n\t\t\tfontSize: FONT_SIZES[shape.props.size],\n\t\t\tfontFamily: font!,\n\t\t\ttextAlign: shape.props.align,\n\t\t\twidth,\n\t\t\theight,\n\t\t\tpadding: 0, // no padding?\n\t\t\tlineHeight: TEXT_PROPS.lineHeight,\n\t\t\tfontStyle: 'normal',\n\t\t\tfontWeight: 'normal',\n\t\t}\n\n\t\tconst lines = this.app.textMeasure.getTextLines({\n\t\t\ttext: text,\n\t\t\twrap: true,\n\t\t\t...opts,\n\t\t})\n\n\t\tconst color = colors.fill[shape.props.color]\n\t\tconst groupEl = document.createElementNS('http://www.w3.org/2000/svg', 'g')\n\n\t\tconst textBgEl = getTextSvgElement(this.app, {\n\t\t\tlines,\n\t\t\t...opts,\n\t\t\tstroke: colors.background,\n\t\t\tstrokeWidth: 2,\n\t\t\tfill: colors.background,\n\t\t\tpadding: 0,\n\t\t})\n\n\t\tconst textElm = textBgEl.cloneNode(true) as SVGTextElement\n\t\ttextElm.setAttribute('fill', color)\n\t\ttextElm.setAttribute('stroke', 'none')\n\n\t\tgroupEl.append(textBgEl)\n\t\tgroupEl.append(textElm)\n\n\t\treturn groupEl\n\t}\n\n\tonResize: OnResizeHandler<TLTextShape> = (shape, info) => {\n\t\tconst { initialBounds, initialShape, scaleX, handle } = info\n\n\t\tif (info.mode === 'scale_shape' || (handle !== 'right' && handle !== 'left')) {\n\t\t\treturn resizeScaled(shape, info)\n\t\t} else {\n\t\t\tconst prevWidth = initialBounds.width\n\t\t\tlet nextWidth = prevWidth * scaleX\n\n\t\t\tconst offset = new Vec2d(0, 0)\n\n\t\t\tnextWidth = Math.max(1, Math.abs(nextWidth))\n\n\t\t\tif (handle === 'left') {\n\t\t\t\toffset.x = prevWidth - nextWidth\n\t\t\t\tif (scaleX < 0) {\n\t\t\t\t\toffset.x += nextWidth\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (scaleX < 0) {\n\t\t\t\t\toffset.x -= nextWidth\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst { x, y } = offset.rot(shape.rotation).add(initialShape)\n\n\t\t\treturn {\n\t\t\t\tx,\n\t\t\t\ty,\n\t\t\t\tprops: {\n\t\t\t\t\tw: nextWidth / initialShape.props.scale,\n\t\t\t\t\tautoSize: false,\n\t\t\t\t},\n\t\t\t}\n\t\t}\n\t}\n\n\tonBeforeCreate = (shape: TLTextShape) => {\n\t\t// When a shape is created, center the text at the created point.\n\n\t\t// Only center if the shape is set to autosize.\n\t\tif (!shape.props.autoSize) return\n\n\t\t// Only center if the shape is empty when created.\n\t\tif (shape.props.text.trim()) return\n\n\t\tconst bounds = this.getMinDimensions(shape)\n\n\t\treturn {\n\t\t\t...shape,\n\t\t\tx: shape.x - bounds.width / 2,\n\t\t\ty: shape.y - bounds.height / 2,\n\t\t}\n\t}\n\n\tonEditEnd: OnEditEndHandler<TLTextShape> = (shape) => {\n\t\tconst {\n\t\t\tid,\n\t\t\ttype,\n\t\t\tprops: { text },\n\t\t} = shape\n\n\t\tconst trimmedText = shape.props.text.trim()\n\n\t\tif (trimmedText.length === 0) {\n\t\t\tthis.app.deleteShapes([shape.id])\n\t\t} else {\n\t\t\tif (trimmedText !== shape.props.text) {\n\t\t\t\tthis.app.updateShapes([\n\t\t\t\t\t{\n\t\t\t\t\t\tid,\n\t\t\t\t\t\ttype,\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\ttext: text.trim(),\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t])\n\t\t\t}\n\t\t}\n\t}\n\n\tonBeforeUpdate = (prev: TLTextShape, next: TLTextShape) => {\n\t\tif (!next.props.autoSize) return\n\n\t\tconst styleDidChange =\n\t\t\tprev.props.size !== next.props.size ||\n\t\t\tprev.props.align !== next.props.align ||\n\t\t\tprev.props.font !== next.props.font ||\n\t\t\t(prev.props.scale !== 1 && next.props.scale === 1)\n\n\t\tconst textDidChange = prev.props.text !== next.props.text\n\n\t\t// Only update position if either changed\n\t\tif (!styleDidChange && !textDidChange) return\n\n\t\t// Might return a cached value for the bounds\n\t\tconst boundsA = this.getMinDimensions(prev)\n\n\t\t// Will always be a fresh call to getTextSize\n\t\tconst boundsB = getTextSize(this.app, next.props)\n\n\t\tconst wA = boundsA.width * prev.props.scale\n\t\tconst hA = boundsA.height * prev.props.scale\n\t\tconst wB = boundsB.width * next.props.scale\n\t\tconst hB = boundsB.height * next.props.scale\n\n\t\tlet delta: Vec2d | undefined\n\n\t\tswitch (next.props.align) {\n\t\t\tcase 'middle': {\n\t\t\t\tdelta = new Vec2d((wB - wA) / 2, textDidChange ? 0 : (hB - hA) / 2)\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tcase 'end': {\n\t\t\t\tdelta = new Vec2d(wB - wA, textDidChange ? 0 : (hB - hA) / 2)\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tdefault: {\n\t\t\t\tif (textDidChange) break\n\t\t\t\tdelta = new Vec2d(0, (hB - hA) / 2)\n\t\t\t\tbreak\n\t\t\t}\n\t\t}\n\n\t\tif (delta) {\n\t\t\t// account for shape rotation when writing text:\n\t\t\tdelta.rot(next.rotation)\n\t\t\tconst { x, y } = next\n\t\t\treturn {\n\t\t\t\t...next,\n\t\t\t\tx: x - delta.x,\n\t\t\t\ty: y - delta.y,\n\t\t\t\tprops: { ...next.props, w: wB },\n\t\t\t}\n\t\t} else {\n\t\t\treturn {\n\t\t\t\t...next,\n\t\t\t\tprops: { ...next.props, w: wB },\n\t\t\t}\n\t\t}\n\t}\n\n\tonDoubleClickEdge = (shape: TLTextShape) => {\n\t\t// If the shape has a fixed width, set it to autoSize.\n\t\tif (!shape.props.autoSize) {\n\t\t\treturn {\n\t\t\t\tid: shape.id,\n\t\t\t\ttype: shape.type,\n\t\t\t\tprops: {\n\t\t\t\t\tautoSize: true,\n\t\t\t\t},\n\t\t\t}\n\t\t}\n\n\t\t// If the shape is scaled, reset the scale to 1.\n\t\tif (shape.props.scale !== 1) {\n\t\t\treturn {\n\t\t\t\tid: shape.id,\n\t\t\t\ttype: shape.type,\n\t\t\t\tprops: {\n\t\t\t\t\tscale: 1,\n\t\t\t\t},\n\t\t\t}\n\t\t}\n\t}\n}\n\n/** @public */\nexport const TLTextShapeDef = defineShape<TLTextShape, TLTextUtil>({\n\ttype: 'text',\n\tgetShapeUtil: () => TLTextUtil,\n\tvalidator: textShapeTypeValidator,\n\tmigrations: textShapeMigrations,\n})\n\nfunction getTextSize(app: App, props: TLTextShape['props']) {\n\tconst { font, text, autoSize, size, w } = props\n\n\tconst minWidth = 16\n\tconst fontSize = FONT_SIZES[size]\n\n\tconst cw = autoSize\n\t\t? 'fit-content'\n\t\t: // `measureText` floors the number so we need to do the same here to avoid issues.\n\t\t  Math.floor(Math.max(minWidth, w)) + 'px'\n\n\tconst result = app.textMeasure.measureText({\n\t\t...TEXT_PROPS,\n\t\ttext,\n\t\tfontFamily: FONT_FAMILIES[font],\n\t\tfontSize: fontSize,\n\t\twidth: cw,\n\t})\n\n\t// // If we're autosizing the measureText will essentially `Math.floor`\n\t// // the numbers so `19` rather than `19.3`, this means we must +1 to\n\t// // whatever we get to avoid wrapping.\n\tif (autoSize) {\n\t\tresult.w += 1\n\t}\n\n\treturn {\n\t\twidth: Math.max(minWidth, result.w),\n\t\theight: Math.max(fontSize, result.h),\n\t}\n}\n","import { Box2d, Vec2d } from '@tldraw/primitives'\nimport { TLShape, Vec2dModel } from '@tldraw/tlschema'\n\nexport function resizeScaled(\n\tshape: Extract<TLShape, { props: { scale: number } }>,\n\t{\n\t\tinitialBounds,\n\t\tscaleX,\n\t\tscaleY,\n\t\tnewPoint,\n\t}: {\n\t\tnewPoint: Vec2dModel\n\t\tinitialBounds: Box2d\n\t\tscaleX: number\n\t\tscaleY: number\n\t}\n) {\n\t// Compute the new scale (to apply to the scale prop)\n\tconst scaleDelta = Math.max(0.01, Math.min(Math.abs(scaleX), Math.abs(scaleY)))\n\n\t// Compute the offset (if flipped X or flipped Y)\n\tconst offset = new Vec2d(0, 0)\n\n\tif (scaleX < 0) {\n\t\toffset.x = -(initialBounds.width * scaleDelta)\n\t}\n\tif (scaleY < 0) {\n\t\toffset.y = -(initialBounds.height * scaleDelta)\n\t}\n\n\t// Apply the offset to the new point\n\tconst { x, y } = Vec2d.Add(newPoint, offset.rot(shape.rotation))\n\n\treturn {\n\t\tx,\n\t\ty,\n\t\tprops: {\n\t\t\tscale: scaleDelta * shape.props.scale,\n\t\t},\n\t}\n}\n","import { toDomPrecision } from '@tldraw/primitives'\nimport { TLVideoShape, videoShapeMigrations, videoShapeTypeValidator } from '@tldraw/tlschema'\nimport * as React from 'react'\nimport { track } from 'signia-react'\nimport { HTMLContainer } from '../../../components/HTMLContainer'\nimport { Spinner } from '../../../components/Spinner'\nimport { defineShape } from '../../../config/TLShapeDefinition'\nimport { useIsEditing } from '../../../hooks'\nimport { usePrefersReducedMotion } from '../../../utils'\nimport { TLBoxUtil } from '../TLBoxUtil'\nimport { HyperlinkButton } from '../shared/HyperlinkButton'\n\n/** @public */\nexport class TLVideoUtil extends TLBoxUtil<TLVideoShape> {\n\tstatic type = 'video'\n\n\toverride canEdit = () => true\n\toverride isAspectRatioLocked = () => true\n\n\toverride defaultProps(): TLVideoShape['props'] {\n\t\treturn {\n\t\t\topacity: '1',\n\t\t\tw: 100,\n\t\t\th: 100,\n\t\t\tassetId: null,\n\t\t\ttime: 0,\n\t\t\tplaying: true,\n\t\t\turl: '',\n\t\t}\n\t}\n\n\trender(shape: TLVideoShape) {\n\t\treturn <TLVideoUtilComponent shape={shape} videoUtil={this} />\n\t}\n\n\tindicator(shape: TLVideoShape) {\n\t\treturn <rect width={toDomPrecision(shape.props.w)} height={toDomPrecision(shape.props.h)} />\n\t}\n\n\ttoSvg(shape: TLVideoShape) {\n\t\tconst g = document.createElementNS('http://www.w3.org/2000/svg', 'g')\n\t\tconst image = document.createElementNS('http://www.w3.org/2000/svg', 'image')\n\t\timage.setAttributeNS('http://www.w3.org/1999/xlink', 'href', serializeVideo(shape.id))\n\t\timage.setAttribute('width', shape.props.w.toString())\n\t\timage.setAttribute('height', shape.props.h.toString())\n\t\tg.appendChild(image)\n\n\t\treturn g\n\t}\n}\n\n/** @public */\nexport const TLVideoShapeDef = defineShape<TLVideoShape, TLVideoUtil>({\n\ttype: 'video',\n\tgetShapeUtil: () => TLVideoUtil,\n\tvalidator: videoShapeTypeValidator,\n\tmigrations: videoShapeMigrations,\n})\n\n// Function from v1, could be improved bu explicitly using this.model.time (?)\nfunction serializeVideo(id: string): string {\n\tconst splitId = id.split(':')[1]\n\tconst video = document.querySelector(`.rs-video-shape-${splitId}`) as HTMLVideoElement\n\tif (video) {\n\t\tconst canvas = document.createElement('canvas')\n\t\tcanvas.width = video.videoWidth\n\t\tcanvas.height = video.videoHeight\n\t\tcanvas.getContext('2d')!.drawImage(video, 0, 0)\n\t\treturn canvas.toDataURL('image/png')\n\t} else throw new Error('Video with id ' + splitId + ' not found')\n}\n\nconst TLVideoUtilComponent = track(function TLVideoUtilComponent(props: {\n\tshape: TLVideoShape\n\tvideoUtil: TLVideoUtil\n}) {\n\tconst { shape, videoUtil } = props\n\tconst showControls = videoUtil.app.getBounds(shape).w * videoUtil.app.zoomLevel >= 110\n\tconst asset = shape.props.assetId ? videoUtil.app.getAssetById(shape.props.assetId) : null\n\tconst { w, h, time, playing } = shape.props\n\tconst isEditing = useIsEditing(shape.id)\n\tconst prefersReducedMotion = usePrefersReducedMotion()\n\n\tconst rVideo = React.useRef<HTMLVideoElement>(null!)\n\n\tconst handlePlay = React.useCallback<React.ReactEventHandler<HTMLVideoElement>>(\n\t\t(e) => {\n\t\t\tconst video = e.currentTarget\n\n\t\t\tvideoUtil.app.updateShapes([\n\t\t\t\t{\n\t\t\t\t\ttype: 'video',\n\t\t\t\t\tid: shape.id,\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tplaying: true,\n\t\t\t\t\t\ttime: video.currentTime,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t])\n\t\t},\n\t\t[shape.id, videoUtil.app]\n\t)\n\n\tconst handlePause = React.useCallback<React.ReactEventHandler<HTMLVideoElement>>(\n\t\t(e) => {\n\t\t\tconst video = e.currentTarget\n\n\t\t\tvideoUtil.app.updateShapes([\n\t\t\t\t{\n\t\t\t\t\ttype: 'video',\n\t\t\t\t\tid: shape.id,\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tplaying: false,\n\t\t\t\t\t\ttime: video.currentTime,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t])\n\t\t},\n\t\t[shape.id, videoUtil.app]\n\t)\n\n\tconst handleSetCurrentTime = React.useCallback<React.ReactEventHandler<HTMLVideoElement>>(\n\t\t(e) => {\n\t\t\tconst video = e.currentTarget\n\n\t\t\tif (isEditing) {\n\t\t\t\tvideoUtil.app.updateShapes([\n\t\t\t\t\t{\n\t\t\t\t\t\ttype: 'video',\n\t\t\t\t\t\tid: shape.id,\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\ttime: video.currentTime,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t])\n\t\t\t}\n\t\t},\n\t\t[isEditing, shape.id, videoUtil.app]\n\t)\n\n\tconst [isLoaded, setIsLoaded] = React.useState(false)\n\n\tconst handleLoadedData = React.useCallback<React.ReactEventHandler<HTMLVideoElement>>(\n\t\t(e) => {\n\t\t\tconst video = e.currentTarget\n\t\t\tif (time !== video.currentTime) {\n\t\t\t\tvideo.currentTime = time\n\t\t\t}\n\n\t\t\tif (!playing) {\n\t\t\t\tvideo.pause()\n\t\t\t}\n\n\t\t\tsetIsLoaded(true)\n\t\t},\n\t\t[playing, time]\n\t)\n\n\t// If the current time changes and we're not editing the video, update the video time\n\tReact.useEffect(() => {\n\t\tconst video = rVideo.current\n\n\t\tif (!video) return\n\n\t\tif (isLoaded && !isEditing && time !== video.currentTime) {\n\t\t\tvideo.currentTime = time\n\t\t}\n\t}, [isEditing, isLoaded, time])\n\n\tReact.useEffect(() => {\n\t\tif (prefersReducedMotion) {\n\t\t\tconst video = rVideo.current\n\t\t\tvideo.pause()\n\t\t\tvideo.currentTime = 0\n\t\t}\n\t}, [rVideo, prefersReducedMotion])\n\n\treturn (\n\t\t<>\n\t\t\t<HTMLContainer id={shape.id}>\n\t\t\t\t<div className=\"rs-counter-scaled\">\n\t\t\t\t\t{asset?.props.src ? (\n\t\t\t\t\t\t<video\n\t\t\t\t\t\t\tref={rVideo}\n\t\t\t\t\t\t\tclassName={`rs-video rs-video-shape-${shape.id.split(':')[1]} rs-hitarea-stroke`}\n\t\t\t\t\t\t\twidth=\"100%\"\n\t\t\t\t\t\t\theight=\"100%\"\n\t\t\t\t\t\t\tdraggable={false}\n\t\t\t\t\t\t\tplaysInline\n\t\t\t\t\t\t\tautoPlay\n\t\t\t\t\t\t\tmuted\n\t\t\t\t\t\t\tloop\n\t\t\t\t\t\t\tdisableRemotePlayback\n\t\t\t\t\t\t\tdisablePictureInPicture\n\t\t\t\t\t\t\tcontrols={isEditing && showControls}\n\t\t\t\t\t\t\tonPlay={handlePlay}\n\t\t\t\t\t\t\tonPause={handlePause}\n\t\t\t\t\t\t\tonTimeUpdate={handleSetCurrentTime}\n\t\t\t\t\t\t\tonLoadedData={handleLoadedData}\n\t\t\t\t\t\t\thidden={!isLoaded}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<source src={asset.props.src} />\n\t\t\t\t\t\t</video>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<Spinner\n\t\t\t\t\t\t\tx={(w - 38) / 2} //\n\t\t\t\t\t\t\ty={(h - 38) / 2}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t</HTMLContainer>\n\t\t\t{'url' in shape.props && shape.props.url && <HyperlinkButton url={shape.props.url} />}\n\t\t</>\n\t)\n})\n","import {\n\tCLIENT_FIXUP_SCRIPT,\n\tensureStoreIsUsable,\n\tonValidationFailure,\n\trootShapeTypeMigrations,\n\tstoreMigrations,\n\tTLAsset,\n\tTLCamera,\n\tTLDocument,\n\tTLDOCUMENT_ID,\n\tTLInstance,\n\tTLInstanceId,\n\tTLInstancePageState,\n\tTLPage,\n\tTLRecord,\n\tTLShape,\n\tTLStore,\n\tTLStoreProps,\n\tTLUser,\n\tTLUserDocument,\n\tTLUserId,\n\tTLUserPresence,\n} from '@tldraw/tlschema'\nimport {\n\tcreateRecordType,\n\tdefineMigrations,\n\tRecordType,\n\tStore,\n\tStoreSchema,\n\tStoreSnapshot,\n} from '@tldraw/tlstore'\nimport { T } from '@tldraw/tlvalidate'\nimport {\n\tTLArrowShapeDef,\n\tTLBookmarkShapeDef,\n\tTLDrawShapeDef,\n\tTLEmbedShapeDef,\n\tTLGeoShapeDef,\n\tTLGroupShapeDef,\n\tTLImageShapeDef,\n\tTLLineShapeDef,\n\tTLNoteShapeDef,\n\tTLTextShapeDef,\n\tTLVideoShapeDef,\n} from '../app/shapeutils'\nimport { TLFrameShapeDef } from '../app/shapeutils/TLFrameUtil/TLFrameUtil'\nimport { StateNodeConstructor } from '../app/statechart/StateNode'\nimport { TLShapeDef, TLUnknownShapeDef } from './TLShapeDefinition'\n\nconst CORE_SHAPE_DEFS = () =>\n\t[\n\t\tTLDrawShapeDef,\n\t\tTLTextShapeDef,\n\t\tTLLineShapeDef,\n\t\tTLArrowShapeDef,\n\t\tTLImageShapeDef,\n\t\tTLVideoShapeDef,\n\t\tTLGeoShapeDef,\n\t\tTLNoteShapeDef,\n\t\tTLGroupShapeDef,\n\t\tTLBookmarkShapeDef,\n\t\tTLEmbedShapeDef,\n\t\tTLFrameShapeDef,\n\t] as const\n\n/** @public */\nexport class TldrawEditorConfig {\n\tstatic readonly default = new TldrawEditorConfig({})\n\n\treadonly storeSchema: StoreSchema<TLRecord, TLStoreProps>\n\treadonly shapes: readonly TLUnknownShapeDef[]\n\treadonly TLShape: RecordType<TLShape, 'type' | 'props' | 'index' | 'parentId'>\n\treadonly tools: readonly StateNodeConstructor[]\n\n\tconstructor({\n\t\tshapes = [],\n\t\ttools = [],\n\t\tallowUnknownShapes = false,\n\t}: {\n\t\tshapes?: readonly TLShapeDef<any, any>[]\n\t\ttools?: readonly StateNodeConstructor[]\n\t\tallowUnknownShapes?: boolean\n\t}) {\n\t\tthis.tools = tools\n\n\t\tconst allShapeDefs = [...CORE_SHAPE_DEFS(), ...shapes]\n\t\tthis.shapes = allShapeDefs\n\n\t\tconst typeSet = new Set<string>()\n\t\tfor (const shapeDef of allShapeDefs) {\n\t\t\tif (typeSet.has(shapeDef.type)) {\n\t\t\t\tthrow new Error(`Shape type ${shapeDef.type} is already defined`)\n\t\t\t}\n\t\t\ttypeSet.add(shapeDef.type)\n\t\t}\n\n\t\tconst shapeTypeMigrations = defineMigrations({\n\t\t\tcurrentVersion: rootShapeTypeMigrations.currentVersion,\n\t\t\tfirstVersion: rootShapeTypeMigrations.firstVersion,\n\t\t\tmigrators: rootShapeTypeMigrations.migrators,\n\t\t\tsubTypeKey: 'type',\n\t\t\tsubTypeMigrations: Object.fromEntries(allShapeDefs.map((def) => [def.type, def.migrations])),\n\t\t})\n\n\t\tlet shapeValidator = T.union('type', {\n\t\t\t...Object.fromEntries(allShapeDefs.map((def) => [def.type, def.validator])),\n\t\t}) as T.UnionValidator<'type', any, any>\n\t\tif (allowUnknownShapes) {\n\t\t\tshapeValidator = shapeValidator.validateUnknownVariants((shape) => shape as any)\n\t\t}\n\n\t\tconst shapeRecord = createRecordType<TLShape>('shape', {\n\t\t\tmigrations: shapeTypeMigrations,\n\t\t\tvalidator: T.model('shape', shapeValidator),\n\t\t}).withDefaultProperties(() => ({ x: 0, y: 0, rotation: 0, isLocked: false }))\n\t\tthis.TLShape = shapeRecord\n\n\t\tthis.storeSchema = StoreSchema.create<TLRecord, TLStoreProps>(\n\t\t\t{\n\t\t\t\tasset: TLAsset,\n\t\t\t\tcamera: TLCamera,\n\t\t\t\tdocument: TLDocument,\n\t\t\t\tinstance: TLInstance,\n\t\t\t\tinstance_page_state: TLInstancePageState,\n\t\t\t\tpage: TLPage,\n\t\t\t\tshape: shapeRecord,\n\t\t\t\tuser: TLUser,\n\t\t\t\tuser_document: TLUserDocument,\n\t\t\t\tuser_presence: TLUserPresence,\n\t\t\t},\n\t\t\t{\n\t\t\t\tsnapshotMigrations: storeMigrations,\n\t\t\t\tonValidationFailure,\n\t\t\t\tensureStoreIsUsable,\n\t\t\t}\n\t\t)\n\t}\n\n\tcreateStore(config: {\n\t\t/**\n\t\t * The store's initial data.\n\t\t */\n\t\tinitialData?: StoreSnapshot<TLRecord>\n\t\tuserId: TLUserId\n\t\tinstanceId: TLInstanceId\n\t}): TLStore {\n\t\tlet initialData = config.initialData\n\t\tif (initialData) {\n\t\t\tinitialData = CLIENT_FIXUP_SCRIPT(initialData)\n\t\t}\n\t\treturn new Store({\n\t\t\tschema: this.storeSchema,\n\t\t\tinitialData,\n\t\t\tprops: {\n\t\t\t\tuserId: config?.userId ?? TLUser.createId(),\n\t\t\t\tinstanceId: config?.instanceId ?? TLInstance.createId(),\n\t\t\t\tdocumentId: TLDOCUMENT_ID,\n\t\t\t},\n\t\t})\n\t}\n}\n","import { TLArrowShape, TLShape, TLShapeId, TLStore } from '@tldraw/tlschema'\nimport { Computed, RESET_VALUE, computed, isUninitialized } from 'signia'\nimport { TLArrowShapeDef } from '../shapeutils'\n\nexport type TLArrowBindingsIndex = Record<\n\tTLShapeId,\n\tundefined | { arrowId: TLShapeId; handleId: 'start' | 'end' }[]\n>\nexport const arrowBindingsIndex = (store: TLStore): Computed<TLArrowBindingsIndex> => {\n\tconst shapeHistory = store.query.filterHistory('shape')\n\tconst arrowQuery = store.query.records('shape', () => ({ type: { eq: 'arrow' as const } }))\n\tfunction fromScratch() {\n\t\tconst allArrows = arrowQuery.value as TLArrowShape[]\n\n\t\tconst bindings2Arrows: TLArrowBindingsIndex = {}\n\n\t\tfor (const arrow of allArrows) {\n\t\t\tconst { start, end } = arrow.props\n\t\t\tif (start.type === 'binding') {\n\t\t\t\tconst arrows = bindings2Arrows[start.boundShapeId]\n\t\t\t\tif (arrows) arrows.push({ arrowId: arrow.id, handleId: 'start' })\n\t\t\t\telse bindings2Arrows[start.boundShapeId] = [{ arrowId: arrow.id, handleId: 'start' }]\n\t\t\t}\n\n\t\t\tif (end.type === 'binding') {\n\t\t\t\tconst arrows = bindings2Arrows[end.boundShapeId]\n\t\t\t\tif (arrows) arrows.push({ arrowId: arrow.id, handleId: 'end' })\n\t\t\t\telse bindings2Arrows[end.boundShapeId] = [{ arrowId: arrow.id, handleId: 'end' }]\n\t\t\t}\n\t\t}\n\n\t\treturn bindings2Arrows\n\t}\n\treturn computed<TLArrowBindingsIndex>('arrowBindingsIndex', (_lastValue, lastComputedEpoch) => {\n\t\tif (isUninitialized(_lastValue)) {\n\t\t\treturn fromScratch()\n\t\t}\n\n\t\tconst lastValue = _lastValue\n\n\t\tconst diff = shapeHistory.getDiffSince(lastComputedEpoch)\n\n\t\tif (diff === RESET_VALUE) {\n\t\t\treturn fromScratch()\n\t\t}\n\n\t\tlet nextValue: TLArrowBindingsIndex | undefined = undefined\n\n\t\tfunction ensureNewArray(boundShapeId: TLShapeId) {\n\t\t\t// this will never happen\n\t\t\tif (!nextValue) {\n\t\t\t\tnextValue = { ...lastValue }\n\t\t\t}\n\t\t\tif (!nextValue[boundShapeId]) {\n\t\t\t\tnextValue[boundShapeId] = []\n\t\t\t} else if (nextValue[boundShapeId] === lastValue[boundShapeId]) {\n\t\t\t\tnextValue[boundShapeId] = [...nextValue[boundShapeId]!]\n\t\t\t}\n\t\t}\n\n\t\tfunction removingBinding(\n\t\t\tboundShapeId: TLShapeId,\n\t\t\tarrowId: TLShapeId,\n\t\t\thandleId: 'start' | 'end'\n\t\t) {\n\t\t\tensureNewArray(boundShapeId)\n\t\t\tnextValue![boundShapeId] = nextValue![boundShapeId]!.filter(\n\t\t\t\t(binding) => binding.arrowId !== arrowId || binding.handleId !== handleId\n\t\t\t)\n\t\t\tif (nextValue![boundShapeId]!.length === 0) {\n\t\t\t\tdelete nextValue![boundShapeId]\n\t\t\t}\n\t\t}\n\n\t\tfunction addBinding(boundShapeId: TLShapeId, arrowId: TLShapeId, handleId: 'start' | 'end') {\n\t\t\tensureNewArray(boundShapeId)\n\t\t\tnextValue![boundShapeId]!.push({ arrowId, handleId })\n\t\t}\n\n\t\tfor (const changes of diff) {\n\t\t\tfor (const newShape of Object.values(changes.added)) {\n\t\t\t\tif (TLArrowShapeDef.is(newShape)) {\n\t\t\t\t\tconst { start, end } = newShape.props\n\t\t\t\t\tif (start.type === 'binding') {\n\t\t\t\t\t\taddBinding(start.boundShapeId, newShape.id, 'start')\n\t\t\t\t\t}\n\t\t\t\t\tif (end.type === 'binding') {\n\t\t\t\t\t\taddBinding(end.boundShapeId, newShape.id, 'end')\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor (const [prev, next] of Object.values(changes.updated) as [TLShape, TLShape][]) {\n\t\t\t\tif (!TLArrowShapeDef.is(prev) || !TLArrowShapeDef.is(next)) continue\n\n\t\t\t\tfor (const handle of ['start', 'end'] as const) {\n\t\t\t\t\tconst prevTerminal = prev.props[handle]\n\t\t\t\t\tconst nextTerminal = next.props[handle]\n\n\t\t\t\t\tif (prevTerminal.type === 'binding' && nextTerminal.type === 'point') {\n\t\t\t\t\t\t// if the binding was removed\n\t\t\t\t\t\tremovingBinding(prevTerminal.boundShapeId, prev.id, handle)\n\t\t\t\t\t} else if (prevTerminal.type === 'point' && nextTerminal.type === 'binding') {\n\t\t\t\t\t\t// if the binding was added\n\t\t\t\t\t\taddBinding(nextTerminal.boundShapeId, next.id, handle)\n\t\t\t\t\t} else if (\n\t\t\t\t\t\tprevTerminal.type === 'binding' &&\n\t\t\t\t\t\tnextTerminal.type === 'binding' &&\n\t\t\t\t\t\tprevTerminal.boundShapeId !== nextTerminal.boundShapeId\n\t\t\t\t\t) {\n\t\t\t\t\t\t// if the binding was changed\n\t\t\t\t\t\tremovingBinding(prevTerminal.boundShapeId, prev.id, handle)\n\t\t\t\t\t\taddBinding(nextTerminal.boundShapeId, next.id, handle)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor (const prev of Object.values(changes.removed)) {\n\t\t\t\tif (TLArrowShapeDef.is(prev)) {\n\t\t\t\t\tconst { start, end } = prev.props\n\t\t\t\t\tif (start.type === 'binding') {\n\t\t\t\t\t\tremovingBinding(start.boundShapeId, prev.id, 'start')\n\t\t\t\t\t}\n\t\t\t\t\tif (end.type === 'binding') {\n\t\t\t\t\t\tremovingBinding(end.boundShapeId, prev.id, 'end')\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// TODO: add diff entries if we need them\n\t\treturn nextValue ?? lastValue\n\t})\n}\n","import { isShape, isShapeId, TLPage, TLPageId, TLShape, TLShapeId, TLStore } from '@tldraw/tlschema'\nimport { IncrementalSetConstructor } from '@tldraw/tlstore'\nimport { computed, isUninitialized, RESET_VALUE, withDiff } from 'signia'\n\n/**\n * Get whether a shape is in the current page.\n *\n * @param store - The tldraw store.\n * @param pageId - The id of the page to check.\n * @param shape - The the shape to check.\n */\nconst isShapeInPage = (store: TLStore, pageId: TLPageId, shape: TLShape): boolean => {\n\twhile (!TLPage.isId(shape.parentId)) {\n\t\tconst parent = store.get(shape.parentId)\n\t\tif (!parent) return false\n\t\tshape = parent\n\t}\n\n\treturn shape.parentId === pageId\n}\n\n/**\n * A derivation that returns a list of shape ids in the current page.\n *\n * @param store - The tldraw store.\n * @param getCurrentPageId - A function that returns the current page id.\n */\nexport const shapeIdsInCurrentPage = (store: TLStore, getCurrentPageId: () => TLPageId) => {\n\tconst shapesIndex = store.query.ids('shape')\n\tlet lastPageId: null | TLPageId = null\n\tfunction fromScratch() {\n\t\tconst currentPageId = getCurrentPageId()\n\t\tlastPageId = currentPageId\n\t\treturn new Set(\n\t\t\t[...shapesIndex.value].filter((id) => isShapeInPage(store, currentPageId, store.get(id)!))\n\t\t)\n\t}\n\treturn computed<Set<TLShapeId>>('_shapeIdsInCurrentPage', (prevValue, lastComputedEpoch) => {\n\t\tif (isUninitialized(prevValue)) {\n\t\t\treturn fromScratch()\n\t\t}\n\n\t\tconst currentPageId = getCurrentPageId()\n\n\t\tif (currentPageId !== lastPageId) {\n\t\t\treturn fromScratch()\n\t\t}\n\n\t\tconst diff = store.history.getDiffSince(lastComputedEpoch)\n\n\t\tif (diff === RESET_VALUE) {\n\t\t\treturn fromScratch()\n\t\t}\n\n\t\tconst builder = new IncrementalSetConstructor<TLShapeId>(\n\t\t\tprevValue\n\t\t) as IncrementalSetConstructor<TLShapeId>\n\n\t\tfor (const changes of diff) {\n\t\t\tfor (const record of Object.values(changes.added)) {\n\t\t\t\tif (isShape(record) && isShapeInPage(store, currentPageId, record)) {\n\t\t\t\t\tbuilder.add(record.id)\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor (const [_from, to] of Object.values(changes.updated)) {\n\t\t\t\tif (isShape(to)) {\n\t\t\t\t\tif (isShapeInPage(store, currentPageId, to)) {\n\t\t\t\t\t\tbuilder.add(to.id)\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbuilder.remove(to.id)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor (const id of Object.keys(changes.removed)) {\n\t\t\t\tif (isShapeId(id)) {\n\t\t\t\t\tbuilder.remove(id)\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst result = builder.get()\n\t\tif (!result) {\n\t\t\treturn prevValue\n\t\t}\n\n\t\treturn withDiff(result.value, result.diff)\n\t})\n}\n","import { atom } from 'signia'\nimport { App } from '../App'\n\ntype Offsets = {\n\ttop: number\n\tleft: number\n\tbottom: number\n\tright: number\n}\nconst DEFAULT_OFFSETS = {\n\ttop: 10,\n\tleft: 10,\n\tbottom: 10,\n\tright: 10,\n}\n\nexport function getActiveAreaScreenSpace(app: App) {\n\tconst containerEl = app.getContainer()\n\tconst el = containerEl.querySelector('*[data-tldraw-area=\"active-drawing\"]')\n\tconst out = {\n\t\t...DEFAULT_OFFSETS,\n\t\twidth: 0,\n\t\theight: 0,\n\t}\n\tif (el && containerEl) {\n\t\tconst cBbbox = containerEl.getBoundingClientRect()\n\t\tconst bbox = el.getBoundingClientRect()\n\t\tout.top = bbox.top\n\t\tout.left = bbox.left\n\t\tout.bottom = cBbbox.height - bbox.bottom\n\t\tout.right = cBbbox.width - bbox.right\n\t}\n\n\tout.width = app.viewportScreenBounds.width - out.left - out.right\n\tout.height = app.viewportScreenBounds.height - out.top - out.bottom\n\treturn out\n}\n\nexport function getActiveAreaPageSpace(app: App) {\n\tconst out = getActiveAreaScreenSpace(app)\n\tconst z = app.camera.z\n\tout.left /= z\n\tout.right /= z\n\tout.top /= z\n\tout.bottom /= z\n\tout.width /= z\n\tout.height /= z\n\treturn out\n}\n\nexport class ActiveAreaManager {\n\tconstructor(public app: App) {\n\t\twindow.addEventListener('resize', this.updateOffsets)\n\t\tthis.app.disposables.add(this.dispose)\n\t}\n\n\toffsets = atom<Offsets>('activeAreaOffsets', DEFAULT_OFFSETS)\n\n\tupdateOffsets = () => {\n\t\tconst offsets = getActiveAreaPageSpace(this.app)\n\t\tthis.offsets.set(offsets)\n\t}\n\n\t// Clear the listener\n\tdispose = () => {\n\t\twindow.addEventListener('resize', this.updateOffsets)\n\t}\n}\n","import { atom } from 'signia'\nimport { App } from '../App'\n\nconst CAMERA_SETTLE_TIMEOUT = 12\n\nexport class CameraManager {\n\tconstructor(public app: App) {}\n\n\tstate = atom('camera state', 'idle' as 'idle' | 'moving')\n\n\tprivate timeoutRemaining = 0\n\n\tprivate decay = (elapsed: number) => {\n\t\tthis.timeoutRemaining -= elapsed\n\t\tif (this.timeoutRemaining <= 0) {\n\t\t\tthis.state.set('idle')\n\t\t\tthis.app.off('tick', this.decay)\n\t\t\tthis.app.updateCullingBounds()\n\t\t}\n\t}\n\n\ttick = () => {\n\t\t// always reset the timeout\n\t\tthis.timeoutRemaining = CAMERA_SETTLE_TIMEOUT\n\n\t\t// If the state is idle, then start the tick\n\t\tif (this.state.__unsafe__getWithoutCapture() === 'idle') {\n\t\t\tthis.state.set('moving')\n\t\t\tthis.app.on('tick', this.decay)\n\t\t}\n\t}\n}\n","import { Vec2d } from '@tldraw/primitives'\nimport { DOUBLE_CLICK_DURATION, DRAG_DISTANCE, MULTI_CLICK_DURATION } from '../../constants'\nimport { uniqueId } from '../../utils'\nimport type { App } from '../App'\nimport { TLClickEventInfo, TLPointerEventInfo } from '../types/event-types'\n\ntype TLClickState =\n\t| 'idle'\n\t| 'pendingDouble'\n\t| 'pendingTriple'\n\t| 'pendingQuadruple'\n\t| 'pendingOverflow'\n\t| 'overflow'\n\nconst MAX_CLICK_DISTANCE = 40\n\nexport class ClickManager {\n\tconstructor(public app: App) {}\n\n\tprivate _clickId = ''\n\n\tprivate _clickTimeout?: any\n\n\tprivate _clickScreenPoint?: Vec2d\n\n\tprivate _previousScreenPoint?: Vec2d\n\n\tprivate _getClickTimeout = (state: TLClickState, id = uniqueId()) => {\n\t\tthis._clickId = id\n\t\tclearTimeout(this._clickTimeout)\n\t\tthis._clickTimeout = setTimeout(\n\t\t\t() => {\n\t\t\t\tif (this._clickState === state && this._clickId === id) {\n\t\t\t\t\tswitch (this._clickState) {\n\t\t\t\t\t\tcase 'pendingTriple': {\n\t\t\t\t\t\t\tthis.app.dispatch({\n\t\t\t\t\t\t\t\t...this.lastPointerInfo,\n\t\t\t\t\t\t\t\ttype: 'click',\n\t\t\t\t\t\t\t\tname: 'double_click',\n\t\t\t\t\t\t\t\tphase: 'settle',\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcase 'pendingQuadruple': {\n\t\t\t\t\t\t\tthis.app.dispatch({\n\t\t\t\t\t\t\t\t...this.lastPointerInfo,\n\t\t\t\t\t\t\t\ttype: 'click',\n\t\t\t\t\t\t\t\tname: 'triple_click',\n\t\t\t\t\t\t\t\tphase: 'settle',\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcase 'pendingOverflow': {\n\t\t\t\t\t\t\tthis.app.dispatch({\n\t\t\t\t\t\t\t\t...this.lastPointerInfo,\n\t\t\t\t\t\t\t\ttype: 'click',\n\t\t\t\t\t\t\t\tname: 'quadruple_click',\n\t\t\t\t\t\t\t\tphase: 'settle',\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdefault: {\n\t\t\t\t\t\t\t// noop\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tthis._clickState = 'idle'\n\t\t\t\t}\n\t\t\t},\n\t\t\tstate === 'idle' || state === 'pendingDouble' ? DOUBLE_CLICK_DURATION : MULTI_CLICK_DURATION\n\t\t)\n\t}\n\n\t/**\n\t * The current click state.\n\t *\n\t * @internal\n\t */\n\tprivate _clickState?: TLClickState = 'idle'\n\n\t/**\n\t * The current click state.\n\t *\n\t * @public\n\t */\n\tget clickState() {\n\t\treturn this._clickState\n\t}\n\n\tlastPointerInfo = {} as TLPointerEventInfo\n\n\t/**\n\t * Start the double click timeout.\n\t *\n\t * @param info - The event info.\n\t */\n\ttransformPointerDownEvent = (info: TLPointerEventInfo): TLPointerEventInfo | TLClickEventInfo => {\n\t\tif (!this._clickState) return info\n\n\t\tthis._clickScreenPoint = Vec2d.From(info.point)\n\n\t\tif (\n\t\t\tthis._previousScreenPoint &&\n\t\t\tthis._previousScreenPoint.dist(this._clickScreenPoint) > MAX_CLICK_DISTANCE\n\t\t) {\n\t\t\tthis._clickState = 'idle'\n\t\t}\n\n\t\tthis._previousScreenPoint = this._clickScreenPoint\n\n\t\tthis.lastPointerInfo = info\n\n\t\tswitch (this._clickState) {\n\t\t\tcase 'idle': {\n\t\t\t\tthis._clickState = 'pendingDouble'\n\t\t\t\tthis._clickTimeout = this._getClickTimeout(this._clickState)\n\t\t\t\treturn info // returns the pointer event\n\t\t\t}\n\t\t\tcase 'pendingDouble': {\n\t\t\t\tthis._clickState = 'pendingTriple'\n\t\t\t\tthis._clickTimeout = this._getClickTimeout(this._clickState)\n\t\t\t\treturn {\n\t\t\t\t\t...info,\n\t\t\t\t\ttype: 'click',\n\t\t\t\t\tname: 'double_click',\n\t\t\t\t\tphase: 'down',\n\t\t\t\t}\n\t\t\t}\n\t\t\tcase 'pendingTriple': {\n\t\t\t\tthis._clickState = 'pendingQuadruple'\n\t\t\t\tthis._clickTimeout = this._getClickTimeout(this._clickState)\n\t\t\t\treturn {\n\t\t\t\t\t...info,\n\t\t\t\t\ttype: 'click',\n\t\t\t\t\tname: 'triple_click',\n\t\t\t\t\tphase: 'down',\n\t\t\t\t}\n\t\t\t}\n\t\t\tcase 'pendingQuadruple': {\n\t\t\t\tthis._clickState = 'pendingOverflow'\n\t\t\t\tthis._clickTimeout = this._getClickTimeout(this._clickState)\n\t\t\t\treturn {\n\t\t\t\t\t...info,\n\t\t\t\t\ttype: 'click',\n\t\t\t\t\tname: 'quadruple_click',\n\t\t\t\t\tphase: 'down',\n\t\t\t\t}\n\t\t\t}\n\t\t\tcase 'pendingOverflow': {\n\t\t\t\tthis._clickState = 'overflow'\n\t\t\t\tthis._clickTimeout = this._getClickTimeout(this._clickState)\n\t\t\t\treturn info\n\t\t\t}\n\t\t\tdefault: {\n\t\t\t\t// overflow\n\t\t\t\tthis._clickTimeout = this._getClickTimeout(this._clickState)\n\t\t\t\treturn info\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Emit click_up events on pointer up.\n\t *\n\t * @param info - The event info.\n\t */\n\ttransformPointerUpEvent = (info: TLPointerEventInfo): TLPointerEventInfo | TLClickEventInfo => {\n\t\tif (!this._clickState) return info\n\n\t\tthis._clickScreenPoint = Vec2d.From(info.point)\n\n\t\tswitch (this._clickState) {\n\t\t\tcase 'pendingTriple': {\n\t\t\t\treturn {\n\t\t\t\t\t...this.lastPointerInfo,\n\t\t\t\t\ttype: 'click',\n\t\t\t\t\tname: 'double_click',\n\t\t\t\t\tphase: 'up',\n\t\t\t\t}\n\t\t\t}\n\t\t\tcase 'pendingQuadruple': {\n\t\t\t\treturn {\n\t\t\t\t\t...this.lastPointerInfo,\n\t\t\t\t\ttype: 'click',\n\t\t\t\t\tname: 'triple_click',\n\t\t\t\t\tphase: 'up',\n\t\t\t\t}\n\t\t\t}\n\t\t\tcase 'pendingOverflow': {\n\t\t\t\treturn {\n\t\t\t\t\t...this.lastPointerInfo,\n\t\t\t\t\ttype: 'click',\n\t\t\t\t\tname: 'quadruple_click',\n\t\t\t\t\tphase: 'up',\n\t\t\t\t}\n\t\t\t}\n\t\t\tdefault: {\n\t\t\t\t// idle, pendingDouble, overflow\n\t\t\t\treturn info\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Cancel the double click timeout.\n\t *\n\t * @internal\n\t */\n\tcancelDoubleClickTimeout = () => {\n\t\tthis._clickTimeout = clearTimeout(this._clickTimeout)\n\t\tthis._clickState = 'idle'\n\t}\n\n\t/**\n\t * Handle a move event, possibly cancelling the click timeout.\n\t *\n\t * @internal\n\t */\n\thandleMove = () => {\n\t\t// Cancel a double click event if the user has started dragging.\n\t\tif (\n\t\t\tthis._clickState !== 'idle' &&\n\t\t\tthis._clickScreenPoint &&\n\t\t\tthis._clickScreenPoint.dist(this.app.inputs.currentScreenPoint) > DRAG_DISTANCE\n\t\t) {\n\t\t\tthis.cancelDoubleClickTimeout()\n\t\t}\n\t}\n}\n","import { atom } from 'signia'\nimport { App } from '../App'\n\nexport class DprManager {\n\tprivate _currentMM: MediaQueryList | undefined\n\n\tconstructor(public app: App) {\n\t\tthis.rebind()\n\t\t// Add this class's dispose method (cancel the listener) to the app's disposables\n\t\tthis.app.disposables.add(this.dispose)\n\t}\n\n\t// Set a listener to update the dpr when the device pixel ratio changes\n\trebind() {\n\t\tthis.dispose()\n\t\tthis._currentMM = this.getMedia()\n\t\tthis._currentMM?.addEventListener('change', this.updateDevicePixelRatio)\n\t}\n\n\tdpr = atom<number>(\n\t\t'devicePixelRatio',\n\t\ttypeof window === 'undefined' ? 1 : window.devicePixelRatio\n\t)\n\n\t// Get the media query list for the device pixel ratio\n\tgetMedia() {\n\t\t// NOTE: This ignore is only for the test environment.\n\t\t/* @ts-ignore */\n\t\tif (window.matchMedia) {\n\t\t\treturn matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`)\n\t\t}\n\t}\n\n\t// Update the device pixel ratio atom\n\tupdateDevicePixelRatio = () => {\n\t\tthis.dpr.set(window.devicePixelRatio)\n\n\t\tthis.rebind()\n\t}\n\n\t// Clear the listener\n\tdispose = () => {\n\t\tthis._currentMM?.removeEventListener('change', this.updateDevicePixelRatio)\n\t}\n}\n","import { TLShape, TLShapeId } from '@tldraw/tlschema'\nimport { compact } from '@tldraw/utils'\nimport type { App } from '../App'\n\nconst LAG_DURATION = 100\n\nexport class DragAndDropManager {\n\tconstructor(public app: App) {\n\t\tapp.disposables.add(this.dispose)\n\t}\n\n\tprevDroppingShapeId: TLShapeId | null = null\n\tcurrDroppingShapeId: TLShapeId | null = null\n\n\tdroppingNodeTimer: ReturnType<typeof setTimeout> | null = null\n\n\tupdateDroppingNode(movingShapes: TLShape[], cb: () => void) {\n\t\tif (this.droppingNodeTimer === null) {\n\t\t\tconst { currentPagePoint } = this.app.inputs\n\t\t\tthis.currDroppingShapeId =\n\t\t\t\tthis.app.getDroppingShape(currentPagePoint, movingShapes)?.id ?? null\n\t\t\tthis.setDragTimer(movingShapes, LAG_DURATION * 10, cb)\n\t\t} else if (this.app.inputs.pointerVelocity.len() > 0.5) {\n\t\t\tclearInterval(this.droppingNodeTimer)\n\t\t\tthis.setDragTimer(movingShapes, LAG_DURATION, cb)\n\t\t}\n\t}\n\n\tprivate setDragTimer(movingShapes: TLShape[], duration: number, cb: () => void) {\n\t\tthis.droppingNodeTimer = setTimeout(() => {\n\t\t\tthis.app.batch(() => {\n\t\t\t\tthis.handleDrag(movingShapes, cb)\n\t\t\t})\n\t\t\tthis.droppingNodeTimer = null\n\t\t}, duration)\n\t}\n\n\tprivate handleDrag(movingShapes: TLShape[], cb?: () => void) {\n\t\tconst { currentPagePoint } = this.app.inputs\n\n\t\tmovingShapes = compact(movingShapes.map((shape) => this.app.getShapeById(shape.id)))\n\n\t\tconst currDroppingShapeId =\n\t\t\tthis.app.getDroppingShape(currentPagePoint, movingShapes)?.id ?? null\n\n\t\tif (currDroppingShapeId !== this.currDroppingShapeId) {\n\t\t\tthis.prevDroppingShapeId = this.currDroppingShapeId\n\t\t\tthis.currDroppingShapeId = currDroppingShapeId\n\t\t}\n\n\t\tconst { prevDroppingShapeId } = this\n\n\t\tif (currDroppingShapeId === prevDroppingShapeId) {\n\t\t\t// we already called onDragShapesOver on this node, no need to do it again\n\t\t\treturn\n\t\t}\n\n\t\tconst prevDroppingShape = prevDroppingShapeId && this.app.getShapeById(prevDroppingShapeId)\n\t\tconst nextDroppingShape = currDroppingShapeId && this.app.getShapeById(currDroppingShapeId)\n\n\t\t// Even if we don't have a next dropping shape id (i.e. if we're dropping\n\t\t// onto the page) set the prev to the current, to avoid repeat calls to\n\t\t// the previous parent's onDragShapesOut\n\t\tthis.prevDroppingShapeId = this.currDroppingShapeId\n\n\t\tif (prevDroppingShape) {\n\t\t\tthis.app.getShapeUtil(prevDroppingShape).onDragShapesOut?.(prevDroppingShape, movingShapes)\n\t\t}\n\n\t\tif (nextDroppingShape) {\n\t\t\tconst res = this.app\n\t\t\t\t.getShapeUtil(nextDroppingShape)\n\t\t\t\t.onDragShapesOver?.(nextDroppingShape, movingShapes)\n\n\t\t\tif (res && res.shouldHint) {\n\t\t\t\tthis.app.setHintingIds([nextDroppingShape.id])\n\t\t\t}\n\t\t} else {\n\t\t\t// If we're dropping onto the page, then clear hinting ids\n\t\t\tthis.app.setHintingIds([])\n\t\t}\n\n\t\tcb?.()\n\t}\n\n\tdropShapes(shapes: TLShape[]) {\n\t\tconst { currDroppingShapeId } = this\n\n\t\tthis.handleDrag(shapes)\n\n\t\tif (currDroppingShapeId) {\n\t\t\tconst shape = this.app.getShapeById(currDroppingShapeId)\n\t\t\tif (!shape) return\n\t\t\tthis.app.getShapeUtil(shape).onDropShapesOver?.(shape, shapes)\n\t\t}\n\t}\n\n\tclear() {\n\t\tthis.prevDroppingShapeId = null\n\t\tthis.currDroppingShapeId = null\n\n\t\tif (this.droppingNodeTimer !== null) {\n\t\t\tclearInterval(this.droppingNodeTimer)\n\t\t}\n\n\t\tthis.droppingNodeTimer = null\n\t\tthis.app.setHintingIds([])\n\t}\n\n\tdispose = () => {\n\t\tthis.clear()\n\t}\n}\n","import { EMPTY_ARRAY } from 'signia'\n\nexport type Stack<T> = StackItem<T> | EmptyStackItem<T>\n\nexport function stack<T>(items?: Array<T>): Stack<T> {\n\tif (items) {\n\t\tlet result = EMPTY_STACK_ITEM as Stack<T>\n\t\twhile (items.length) {\n\t\t\tresult = result.push(items.pop()!)\n\t\t}\n\t\treturn result\n\t}\n\treturn EMPTY_STACK_ITEM as any\n}\n\nclass EmptyStackItem<T> implements Iterable<T> {\n\treadonly length = 0\n\treadonly head = null\n\treadonly tail: Stack<T> = this\n\n\tpush(head: T): Stack<T> {\n\t\treturn new StackItem<T>(head, this)\n\t}\n\n\ttoArray() {\n\t\treturn EMPTY_ARRAY\n\t}\n\n\t[Symbol.iterator]() {\n\t\treturn {\n\t\t\tnext() {\n\t\t\t\treturn { value: undefined, done: true as const }\n\t\t\t},\n\t\t}\n\t}\n}\n\nconst EMPTY_STACK_ITEM = new EmptyStackItem()\n\nclass StackItem<T> implements Iterable<T> {\n\tlength: number\n\tconstructor(public readonly head: T, public readonly tail: Stack<T>) {\n\t\tthis.length = tail.length + 1\n\t}\n\n\tpush(head: T): Stack<T> {\n\t\treturn new StackItem(head, this)\n\t}\n\n\ttoArray() {\n\t\treturn Array.from(this)\n\t}\n\n\t[Symbol.iterator]() {\n\t\tlet stack = this as Stack<T>\n\t\treturn {\n\t\t\tnext() {\n\t\t\t\tif (stack.length) {\n\t\t\t\t\tconst value = stack.head!\n\t\t\t\t\tstack = stack.tail\n\t\t\t\t\treturn { value, done: false as const }\n\t\t\t\t} else {\n\t\t\t\t\treturn { value: undefined, done: true as const }\n\t\t\t\t}\n\t\t\t},\n\t\t}\n\t}\n}\n","import { devFreeze } from '@tldraw/tlstore'\nimport { atom, transact } from 'signia'\nimport { uniqueId } from '../../utils'\nimport { TLCommandHandler, TLHistoryEntry } from '../types/history-types'\nimport { Stack, stack } from './Stack'\n\ntype CommandFn<Data> = (...args: any[]) =>\n\t| {\n\t\t\tdata: Data\n\t\t\tsquashing?: boolean\n\t\t\tephemeral?: boolean\n\t\t\tpreservesRedoStack?: boolean\n\t  }\n\t| null\n\t| undefined\n\t| void\n\ntype ExtractData<Fn> = Fn extends CommandFn<infer Data> ? Data : never\ntype ExtractArgs<Fn> = Parameters<Extract<Fn, (...args: any[]) => any>>\n\nexport class HistoryManager<CTX extends { emit: (name: string) => void }> {\n\t_undos = atom<Stack<TLHistoryEntry>>('HistoryManager.undos', stack()) // Updated by each action that includes and undo\n\t_redos = atom<Stack<TLHistoryEntry>>('HistoryManager.redos', stack()) // Updated when a user undoes\n\t_batchDepth = 0 // A flag for whether the user is in a batch operation\n\n\tconstructor(\n\t\tprivate readonly ctx: CTX,\n\t\tprivate readonly onBatchComplete: () => void,\n\t\tprivate readonly annotateError: (error: unknown) => void\n\t) {}\n\n\tprivate _commands: Record<string, TLCommandHandler<any>> = {}\n\n\tget numUndos() {\n\t\treturn this._undos.value.length\n\t}\n\n\tget numRedos() {\n\t\treturn this._redos.value.length\n\t}\n\n\tcreateCommand = <Name extends string, Constructor extends CommandFn<any>>(\n\t\tname: Name,\n\t\tconstructor: Constructor,\n\t\thandle: TLCommandHandler<ExtractData<Constructor>>\n\t) => {\n\t\tif (this._commands[name]) {\n\t\t\tthrow new Error(`Duplicate command: ${name}`)\n\t\t}\n\t\tthis._commands[name] = handle\n\n\t\tconst exec = (...args: ExtractArgs<Constructor>) => {\n\t\t\tif (!this._batchDepth) {\n\t\t\t\t// If we're not batching, run again in a batch\n\t\t\t\tthis.batch(() => exec(...args))\n\t\t\t\treturn this.ctx\n\t\t\t}\n\n\t\t\tconst result = constructor(...args)\n\n\t\t\tif (!result) {\n\t\t\t\treturn this.ctx\n\t\t\t}\n\n\t\t\tconst { data, ephemeral, squashing, preservesRedoStack } = result\n\n\t\t\tthis.ignoringUpdates((undos, redos) => {\n\t\t\t\thandle.do(data)\n\t\t\t\treturn { undos, redos }\n\t\t\t})\n\n\t\t\tif (!ephemeral) {\n\t\t\t\tconst prev = this._undos.value.head\n\t\t\t\tif (\n\t\t\t\t\tsquashing &&\n\t\t\t\t\tprev &&\n\t\t\t\t\tprev.type === 'command' &&\n\t\t\t\t\tprev.name === name &&\n\t\t\t\t\tprev.preservesRedoStack === preservesRedoStack\n\t\t\t\t) {\n\t\t\t\t\t// replace the last command with a squashed version\n\t\t\t\t\tthis._undos.update((undos) =>\n\t\t\t\t\t\tundos.tail.push({\n\t\t\t\t\t\t\t...prev,\n\t\t\t\t\t\t\tid: uniqueId(),\n\t\t\t\t\t\t\tdata: devFreeze(handle.squash!(prev.data, data)),\n\t\t\t\t\t\t})\n\t\t\t\t\t)\n\t\t\t\t} else {\n\t\t\t\t\t// add to the undo stack\n\t\t\t\t\tthis._undos.update((undos) =>\n\t\t\t\t\t\tundos.push({\n\t\t\t\t\t\t\ttype: 'command',\n\t\t\t\t\t\t\tname,\n\t\t\t\t\t\t\tdata: devFreeze(data),\n\t\t\t\t\t\t\tid: uniqueId(),\n\t\t\t\t\t\t\tpreservesRedoStack: preservesRedoStack,\n\t\t\t\t\t\t})\n\t\t\t\t\t)\n\t\t\t\t}\n\n\t\t\t\tif (!result.preservesRedoStack) {\n\t\t\t\t\tthis._redos.set(stack())\n\t\t\t\t}\n\n\t\t\t\tthis.ctx.emit('change-history')\n\t\t\t}\n\n\t\t\treturn this.ctx\n\t\t}\n\n\t\treturn exec\n\t}\n\n\tbatch = (fn: () => void) => {\n\t\ttry {\n\t\t\tthis._batchDepth++\n\t\t\tif (this._batchDepth === 1) {\n\t\t\t\ttransact(() => {\n\t\t\t\t\tconst mostRecentActionId = this._undos.value.head?.id\n\t\t\t\t\tfn()\n\t\t\t\t\tif (mostRecentActionId !== this._undos.value.head?.id) {\n\t\t\t\t\t\tthis.onBatchComplete()\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t} else {\n\t\t\t\tfn()\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tthis.annotateError(error)\n\t\t\tthrow error\n\t\t} finally {\n\t\t\tthis._batchDepth--\n\t\t}\n\n\t\treturn this\n\t}\n\n\tprivate ignoringUpdates = (\n\t\tfn: (\n\t\t\tundos: Stack<TLHistoryEntry>,\n\t\t\tredos: Stack<TLHistoryEntry>\n\t\t) => { undos: Stack<TLHistoryEntry>; redos: Stack<TLHistoryEntry> }\n\t) => {\n\t\tlet undos = this._undos.value\n\t\tlet redos = this._redos.value\n\n\t\tthis._undos.set(stack())\n\t\tthis._redos.set(stack())\n\t\ttry {\n\t\t\t;({ undos, redos } = transact(() => fn(undos, redos)))\n\t\t} finally {\n\t\t\tthis._undos.set(undos)\n\t\t\tthis._redos.set(redos)\n\t\t}\n\t}\n\n\t// History\n\tprivate _undo = ({\n\t\tpushToRedoStack,\n\t\ttoMark = undefined,\n\t}: {\n\t\tpushToRedoStack: boolean\n\t\ttoMark?: string\n\t}) => {\n\t\tthis.ignoringUpdates((undos, redos) => {\n\t\t\tif (undos.length === 0) {\n\t\t\t\tthis.ctx.emit('change-history')\n\t\t\t\treturn { undos, redos }\n\t\t\t}\n\n\t\t\twhile (undos.head?.type === 'STOP') {\n\t\t\t\tconst mark = undos.head\n\t\t\t\tundos = undos.tail\n\t\t\t\tif (pushToRedoStack) {\n\t\t\t\t\tredos = redos.push(mark)\n\t\t\t\t}\n\t\t\t\tif (mark.id === toMark) {\n\t\t\t\t\tthis.ctx.emit('change-history')\n\t\t\t\t\treturn { undos, redos }\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (undos.length === 0) {\n\t\t\t\tthis.ctx.emit('change-history')\n\t\t\t\treturn { undos, redos }\n\t\t\t}\n\n\t\t\twhile (undos.head) {\n\t\t\t\tconst command = undos.head\n\t\t\t\tundos = undos.tail\n\n\t\t\t\tif (pushToRedoStack) {\n\t\t\t\t\tredos = redos.push(command)\n\t\t\t\t}\n\n\t\t\t\tif (command.type === 'STOP') {\n\t\t\t\t\tif (command.onUndo && (!toMark || command.id === toMark)) {\n\t\t\t\t\t\tthis.ctx.emit('change-history')\n\t\t\t\t\t\treturn { undos, redos }\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tconst handler = this._commands[command.name]\n\t\t\t\t\thandler.undo(command.data)\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.ctx.emit('change-history')\n\t\t\treturn { undos, redos }\n\t\t})\n\n\t\treturn this\n\t}\n\n\tundo = () => {\n\t\tthis._undo({ pushToRedoStack: true })\n\n\t\treturn this\n\t}\n\n\tredo = () => {\n\t\tthis.ignoringUpdates((undos, redos) => {\n\t\t\tif (redos.length === 0) {\n\t\t\t\tthis.ctx.emit('change-history')\n\t\t\t\treturn { undos, redos }\n\t\t\t}\n\n\t\t\twhile (redos.head?.type === 'STOP') {\n\t\t\t\tundos = undos.push(redos.head)\n\t\t\t\tredos = redos.tail\n\t\t\t}\n\n\t\t\tif (redos.length === 0) {\n\t\t\t\tthis.ctx.emit('change-history')\n\t\t\t\treturn { undos, redos }\n\t\t\t}\n\n\t\t\twhile (redos.head) {\n\t\t\t\tconst command = redos.head\n\t\t\t\tundos = undos.push(redos.head)\n\t\t\t\tredos = redos.tail\n\n\t\t\t\tif (command.type === 'STOP') {\n\t\t\t\t\tif (command.onRedo) {\n\t\t\t\t\t\tbreak\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tconst handler = this._commands[command.name]\n\t\t\t\t\tif (handler.redo) {\n\t\t\t\t\t\thandler.redo(command.data)\n\t\t\t\t\t} else {\n\t\t\t\t\t\thandler.do(command.data)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.ctx.emit('change-history')\n\t\t\treturn { undos, redos }\n\t\t})\n\n\t\treturn this\n\t}\n\n\tbail = () => {\n\t\tthis._undo({ pushToRedoStack: false })\n\n\t\treturn this\n\t}\n\n\tbailToMark = (id: string) => {\n\t\tthis._undo({ pushToRedoStack: false, toMark: id })\n\n\t\treturn this\n\t}\n\n\tmark = (id = uniqueId(), onUndo = true, onRedo = true) => {\n\t\tconst mostRecent = this._undos.value.head\n\t\t// dedupe marks, why not\n\t\tif (mostRecent && mostRecent.type === 'STOP') {\n\t\t\tif (mostRecent.id === id && mostRecent.onUndo === onUndo && mostRecent.onRedo === onRedo) {\n\t\t\t\treturn mostRecent.id\n\t\t\t}\n\t\t}\n\n\t\tthis._undos.update((undos) => undos.push({ type: 'STOP', id, onUndo, onRedo }))\n\n\t\treturn id\n\t}\n\n\tclear() {\n\t\tthis._undos.set(stack())\n\t\tthis._redos.set(stack())\n\t}\n}\n","import { Vec2d, VecLike } from '@tldraw/primitives'\nimport { TLScribble, Vec2dModel } from '@tldraw/tlschema'\nimport { TLTickEvent } from '../types/event-types'\n\nexport class ScribbleManager implements TLScribble {\n\t// Scribble properties\n\tstate\n\tpoints\n\tsize\n\tcolor\n\topacity\n\n\t// Callbacks\n\tprivate onUpdate: (scribble: TLScribble) => void\n\tprivate onComplete: () => void\n\n\t// Internal state\n\tprivate prev: VecLike | null = null\n\tprivate next: VecLike | null = null\n\n\tconstructor(opts: {\n\t\tonUpdate: (scribble: TLScribble) => void\n\t\tonComplete: () => void\n\t\tsize?: TLScribble['size']\n\t\tcolor?: TLScribble['color']\n\t\topacity?: TLScribble['opacity']\n\t}) {\n\t\tconst { size = 20, color = 'accent', opacity = 0.8, onComplete, onUpdate } = opts\n\n\t\tthis.onUpdate = onUpdate\n\t\tthis.onComplete = onComplete\n\t\tthis.size = size\n\t\tthis.color = color\n\t\tthis.opacity = opacity\n\t\tthis.points = [] as Vec2dModel[]\n\t\tthis.state = 'starting' as TLScribble['state']\n\n\t\tthis.prev = null\n\t\tthis.next = null\n\n\t\tthis.resume()\n\t}\n\n\tresume = () => {\n\t\tthis.state = 'active'\n\t}\n\n\tpause = () => {\n\t\tthis.state = 'starting'\n\t}\n\n\t/**\n\t * Start stopping the scribble. The scribble won't be removed\n\t * until its last point is cleared.\n\t *\n\t * @public\n\t */\n\tstop = () => {\n\t\tthis.state = 'stopping'\n\t}\n\n\t/**\n\t * Set the scribble's next point.\n\t *\n\t * @param point - The point to add.\n\t * @public\n\t */\n\taddPoint = (x: number, y: number) => {\n\t\tconst { prev } = this\n\t\tconst point = { x, y, z: 0.5 }\n\t\tif (prev && Vec2d.Dist(prev, point) < 1) return\n\t\tthis.next = point\n\t}\n\n\t/**\n\t * Get the current TLScribble object from the scribble manager.\n\t *\n\t * @public\n\t */\n\tgetScribble(): TLScribble {\n\t\treturn {\n\t\t\tstate: this.state,\n\t\t\tsize: this.size,\n\t\t\tcolor: this.color,\n\t\t\topacity: this.opacity,\n\t\t\tpoints: [...this.points],\n\t\t}\n\t}\n\n\tprivate updateScribble() {\n\t\tthis.onUpdate(this.getScribble())\n\t}\n\n\ttimeoutMs = 0\n\n\ttick: TLTickEvent = (elapsed) => {\n\t\tthis.timeoutMs += elapsed\n\t\tif (this.timeoutMs >= 16) {\n\t\t\tthis.timeoutMs = 0\n\t\t}\n\n\t\tconst { timeoutMs, state, prev, next, points } = this\n\n\t\tswitch (state) {\n\t\t\tcase 'active': {\n\t\t\t\tif (next && next !== prev) {\n\t\t\t\t\tthis.prev = next\n\t\t\t\t\tpoints.push(next)\n\n\t\t\t\t\tif (points.length > 8) {\n\t\t\t\t\t\tpoints.shift()\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.updateScribble()\n\t\t\t\t} else {\n\t\t\t\t\t// While not moving, shrink the scribble from the start\n\t\t\t\t\tif (timeoutMs === 0 && points.length > 1) {\n\t\t\t\t\t\tpoints.shift()\n\t\t\t\t\t\tthis.updateScribble()\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tcase 'stopping': {\n\t\t\t\tif (timeoutMs === 0) {\n\t\t\t\t\t// If the scribble is down to one point, we're done!\n\t\t\t\t\tif (points.length === 1) {\n\t\t\t\t\t\tthis.state = 'paused'\n\t\t\t\t\t\tthis.onComplete()\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\n\t\t\t\t\t// Drop the scribble's size\n\t\t\t\t\tthis.size *= 0.9\n\n\t\t\t\t\t// Drop the scribble's first point (its tail)\n\t\t\t\t\tpoints.shift()\n\n\t\t\t\t\t// otherwise, update the scribble\n\t\t\t\t\tthis.updateScribble()\n\t\t\t\t}\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tcase 'paused': {\n\t\t\t\t// Nothing to do while paused.\n\t\t\t\tbreak\n\t\t\t}\n\t\t}\n\t}\n}\n","import {\n\tBox2d,\n\tflipSelectionHandleX,\n\tflipSelectionHandleY,\n\tisSelectionCorner,\n\tMatrix2d,\n\trangeIntersection,\n\trangesOverlap,\n\tSelectionCorner,\n\tSelectionEdge,\n\tVec2d,\n\tVecLike,\n} from '@tldraw/primitives'\nimport { TLLineShape, TLParentId, TLShape, TLShapeId, Vec2dModel } from '@tldraw/tlschema'\nimport { compact, dedupe, deepCopy } from '@tldraw/utils'\nimport { atom, computed, EMPTY_ARRAY } from 'signia'\nimport { sortByIndex, uniqueId } from '../../utils'\nimport type { App } from '../App'\nimport { getSplineForLineShape, TLLineShapeDef } from '../shapeutils'\n\nexport type PointsSnapLine = {\n\tid: string\n\ttype: 'points'\n\tpoints: VecLike[]\n}\nexport type GapsSnapLine = {\n\tid: string\n\ttype: 'gaps'\n\tdirection: 'horizontal' | 'vertical'\n\tgaps: Array<{\n\t\tstartEdge: [VecLike, VecLike]\n\t\tendEdge: [VecLike, VecLike]\n\t}>\n}\nexport type SnapLine = PointsSnapLine | GapsSnapLine\n\nexport type SnapInteractionType =\n\t| {\n\t\t\ttype: 'translate'\n\t\t\tlockedAxis: 'x' | 'y' | null\n\t\t\tinitialSelectionSnapPoints: Vec2d[]\n\t  }\n\t| {\n\t\t\ttype: 'resize'\n\t  }\n\nexport interface SnapPoint {\n\tid: string\n\tx: number\n\ty: number\n\thandle?: SelectionCorner\n}\n\ntype SnapPair = { thisPoint: SnapPoint; otherPoint: SnapPoint }\n\ntype NearestPointsSnap = {\n\t// selection snaps to a nearby snap point\n\ttype: 'points'\n\tpoints: SnapPair\n\tnudge: number\n}\n\ntype NearestSnap =\n\t| NearestPointsSnap\n\t| {\n\t\t\t// selection snaps to the center of a gap\n\t\t\ttype: 'gap_center'\n\t\t\tgap: Gap\n\t\t\tnudge: number\n\t  }\n\t| {\n\t\t\t// selection snaps to create a new gap of equal size to another gap\n\t\t\t// on the opposide side of some shape\n\t\t\ttype: 'gap_duplicate'\n\t\t\tgap: Gap\n\t\t\tprotrusionDirection: 'left' | 'right' | 'top' | 'bottom'\n\t\t\tnudge: number\n\t  }\n\ntype GapNode = {\n\tid: TLShapeId\n\tpageBounds: Box2d\n}\ntype Gap = {\n\t// e.g.\n\t//      start\n\t//      edge              breadth\n\t//                      intersection\n\t//                       [40,100]           end\n\t//                                         edge\n\t//   100,0                  \n\t//                                     \n\t//             \n\t//   start                      200,40  \n\t//   node                                          \n\t//                end      \n\t//                                        node     \n\t//   100,100                            \n\t//                                                     \n\t//                                 200,120  \n\t//\n\t//                       length 100\n\t//               \n\tstartNode: GapNode\n\tendNode: GapNode\n\tstartEdge: [Vec2d, Vec2d]\n\tendEdge: [Vec2d, Vec2d]\n\tlength: number\n\tbreadthIntersection: [number, number]\n}\n\ninterface SnapData {\n\tnudge: Vec2d\n}\n\nconst round = (x: number) => {\n\t// round numbers to avoid glitches for floating point rounding errors\n\tconst decimalPlacesTolerance = 8\n\treturn Math.round(x * 10 ** decimalPlacesTolerance) / 10 ** decimalPlacesTolerance\n}\n\nfunction findAdjacentGaps(\n\tgaps: Gap[],\n\tshapeId: TLShapeId,\n\tgapLength: number,\n\tdirection: 'forward' | 'backward',\n\tintersection: [number, number]\n): Gap[] {\n\t// TODO: take advantage of the fact that gaps is sorted by starting position?\n\tconst matches = gaps.filter(\n\t\t(gap) =>\n\t\t\t(direction === 'forward' ? gap.startNode.id === shapeId : gap.endNode.id === shapeId) &&\n\t\t\tround(gap.length) === round(gapLength) &&\n\t\t\trangeIntersection(\n\t\t\t\tgap.breadthIntersection[0],\n\t\t\t\tgap.breadthIntersection[1],\n\t\t\t\tintersection[0],\n\t\t\t\tintersection[1]\n\t\t\t)\n\t)\n\n\tif (matches.length === 0) return []\n\n\tconst nextNodes = new Set<TLShapeId>()\n\n\tfor (const match of matches) {\n\t\tconst node = direction === 'forward' ? match.endNode.id : match.startNode.id\n\t\tif (!nextNodes.has(node)) {\n\t\t\tnextNodes.add(node)\n\t\t\tmatches.push(\n\t\t\t\t...findAdjacentGaps(\n\t\t\t\t\tgaps,\n\t\t\t\t\tnode,\n\t\t\t\t\tgapLength,\n\t\t\t\t\tdirection,\n\t\t\t\t\trangeIntersection(\n\t\t\t\t\t\tmatch.breadthIntersection[0],\n\t\t\t\t\t\tmatch.breadthIntersection[1],\n\t\t\t\t\t\tintersection[0],\n\t\t\t\t\t\tintersection[1]\n\t\t\t\t\t)!\n\t\t\t\t)\n\t\t\t)\n\t\t}\n\t}\n\n\treturn matches\n}\n\nfunction dedupeGapSnaps(snaps: Array<Extract<SnapLine, { type: 'gaps' }>>) {\n\t// sort by descending order of number of gaps\n\tsnaps.sort((a, b) => b.gaps.length - a.gaps.length)\n\t// pop off any that are included already\n\tfor (let i = snaps.length - 1; i > 0; i--) {\n\t\tconst snap = snaps[i]\n\t\tfor (let j = i - 1; j >= 0; j--) {\n\t\t\tconst otherSnap = snaps[j]\n\t\t\t// if every edge in this snap is included in the other snap somewhere, then it's redundant\n\t\t\tif (\n\t\t\t\totherSnap.direction === snap.direction &&\n\t\t\t\tsnap.gaps.every(\n\t\t\t\t\t(gap) =>\n\t\t\t\t\t\totherSnap.gaps.some(\n\t\t\t\t\t\t\t(otherGap) =>\n\t\t\t\t\t\t\t\tround(gap.startEdge[0].x) === round(otherGap.startEdge[0].x) &&\n\t\t\t\t\t\t\t\tround(gap.startEdge[0].y) === round(otherGap.startEdge[0].y) &&\n\t\t\t\t\t\t\t\tround(gap.startEdge[1].x) === round(otherGap.startEdge[1].x) &&\n\t\t\t\t\t\t\t\tround(gap.startEdge[1].y) === round(otherGap.startEdge[1].y)\n\t\t\t\t\t\t) &&\n\t\t\t\t\t\totherSnap.gaps.some(\n\t\t\t\t\t\t\t(otherGap) =>\n\t\t\t\t\t\t\t\tround(gap.endEdge[0].x) === round(otherGap.endEdge[0].x) &&\n\t\t\t\t\t\t\t\tround(gap.endEdge[0].y) === round(otherGap.endEdge[0].y) &&\n\t\t\t\t\t\t\t\tround(gap.endEdge[1].x) === round(otherGap.endEdge[1].x) &&\n\t\t\t\t\t\t\t\tround(gap.endEdge[1].y) === round(otherGap.endEdge[1].y)\n\t\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t) {\n\t\t\t\tsnaps.splice(i, 1)\n\t\t\t\tbreak\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport class SnapManager {\n\tprivate _snapLines = atom<SnapLine[] | undefined>('snapLines', undefined)\n\n\tget lines() {\n\t\treturn this._snapLines.value ?? (EMPTY_ARRAY as SnapLine[])\n\t}\n\n\tclear() {\n\t\tif (this.lines.length) {\n\t\t\tthis._snapLines.set(undefined)\n\t\t}\n\t}\n\n\tsetLines(lines: SnapLine[]) {\n\t\tthis._snapLines.set(lines)\n\t}\n\n\tconstructor(public readonly app: App) {}\n\n\t@computed get snapPointsCache() {\n\t\treturn this.app.store.createComputedCache<SnapPoint[], TLShape>('snapPoints', (shape) => {\n\t\t\tconst pageTransfrorm = this.app.getPageTransformById(shape.id)\n\t\t\tif (!pageTransfrorm) return undefined\n\t\t\tconst util = this.app.getShapeUtil(shape)\n\t\t\tconst snapPoints = util.snapPoints(shape)\n\t\t\treturn snapPoints.map((point, i) => {\n\t\t\t\tconst { x, y } = Matrix2d.applyToPoint(pageTransfrorm, point)\n\t\t\t\treturn { x, y, id: `${shape.id}:${i}` }\n\t\t\t})\n\t\t})\n\t}\n\n\tget snapThreshold() {\n\t\treturn 8 / this.app.camera.z\n\t}\n\n\t// TODO: make this an incremental derivation\n\t@computed get visibleShapesNotInSelection() {\n\t\tconst selectedIds = this.app.selectedIds\n\n\t\tconst result: Set<{ id: TLShapeId; pageBounds: Box2d }> = new Set()\n\n\t\tconst processParent = (parentId: TLParentId) => {\n\t\t\tconst children = this.app.getSortedChildIds(parentId)\n\t\t\tfor (const id of children) {\n\t\t\t\tconst shape = this.app.getShapeById(id) as TLShape\n\t\t\t\tif (!shape) continue\n\t\t\t\tif (shape.type === 'arrow') continue\n\t\t\t\tif (selectedIds.includes(id)) continue\n\t\t\t\tif (!this.app.isShapeInViewport(shape.id)) continue\n\n\t\t\t\tif (shape.type === 'group') {\n\t\t\t\t\t// snap to children of group but not group itself\n\t\t\t\t\tprocessParent(id)\n\t\t\t\t\tcontinue\n\t\t\t\t}\n\n\t\t\t\tresult.add({ id: shape.id, pageBounds: this.app.getPageBoundsById(shape.id)! })\n\n\t\t\t\t// don't snap to children of frame\n\t\t\t\tif (shape.type !== 'frame') {\n\t\t\t\t\tprocessParent(id)\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst commonFrameAncestor = this.app.findCommonAncestor(\n\t\t\tcompact(selectedIds.map((id) => this.app.getShapeById(id))),\n\t\t\t(parent) => parent.type === 'frame'\n\t\t)\n\n\t\tprocessParent(commonFrameAncestor ?? this.app.currentPageId)\n\n\t\treturn result\n\t}\n\n\t@computed get visibleSnapPointsNotInSelection() {\n\t\tconst result: SnapPoint[] = []\n\t\tfor (const shape of this.visibleShapesNotInSelection) {\n\t\t\tconst snapPoints = this.snapPointsCache.get(shape.id)\n\t\t\tif (snapPoints) {\n\t\t\t\tresult.push(...snapPoints)\n\t\t\t}\n\t\t}\n\t\treturn result\n\t}\n\n\t@computed get visibleGaps(): { horizontal: Gap[]; vertical: Gap[] } {\n\t\tconst horizontal: Gap[] = []\n\t\tconst vertical: Gap[] = []\n\n\t\tconst sortedShapesHorizontal = [...this.visibleShapesNotInSelection].sort((a, b) => {\n\t\t\treturn a.pageBounds.minX - b.pageBounds.minX\n\t\t})\n\n\t\tfor (let i = 0; i < sortedShapesHorizontal.length; i++) {\n\t\t\tconst startNode = sortedShapesHorizontal[i]\n\t\t\tfor (let j = i + 1; j < sortedShapesHorizontal.length; j++) {\n\t\t\t\tconst endNode = sortedShapesHorizontal[j]\n\n\t\t\t\tif (\n\t\t\t\t\t// is there space between the boxes\n\t\t\t\t\tstartNode.pageBounds.maxX < endNode.pageBounds.minX &&\n\t\t\t\t\t// and they overlap in the y axis\n\t\t\t\t\trangesOverlap(\n\t\t\t\t\t\tstartNode.pageBounds.minY,\n\t\t\t\t\t\tstartNode.pageBounds.maxY,\n\t\t\t\t\t\tendNode.pageBounds.minY,\n\t\t\t\t\t\tendNode.pageBounds.maxY\n\t\t\t\t\t)\n\t\t\t\t) {\n\t\t\t\t\thorizontal.push({\n\t\t\t\t\t\tstartNode,\n\t\t\t\t\t\tendNode,\n\t\t\t\t\t\tstartEdge: [\n\t\t\t\t\t\t\tnew Vec2d(startNode.pageBounds.maxX, startNode.pageBounds.minY),\n\t\t\t\t\t\t\tnew Vec2d(startNode.pageBounds.maxX, startNode.pageBounds.maxY),\n\t\t\t\t\t\t],\n\t\t\t\t\t\tendEdge: [\n\t\t\t\t\t\t\tnew Vec2d(endNode.pageBounds.minX, endNode.pageBounds.minY),\n\t\t\t\t\t\t\tnew Vec2d(endNode.pageBounds.minX, endNode.pageBounds.maxY),\n\t\t\t\t\t\t],\n\t\t\t\t\t\tlength: endNode.pageBounds.minX - startNode.pageBounds.maxX,\n\t\t\t\t\t\tbreadthIntersection: rangeIntersection(\n\t\t\t\t\t\t\tstartNode.pageBounds.minY,\n\t\t\t\t\t\t\tstartNode.pageBounds.maxY,\n\t\t\t\t\t\t\tendNode.pageBounds.minY,\n\t\t\t\t\t\t\tendNode.pageBounds.maxY\n\t\t\t\t\t\t)!,\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst sortedShapesVertical = sortedShapesHorizontal.slice(0).sort((a, b) => {\n\t\t\treturn a.pageBounds.minY - b.pageBounds.minY\n\t\t})\n\n\t\tfor (let i = 0; i < sortedShapesVertical.length; i++) {\n\t\t\tconst startNode = sortedShapesVertical[i]\n\t\t\tfor (let j = i + 1; j < sortedShapesVertical.length; j++) {\n\t\t\t\tconst endNode = sortedShapesVertical[j]\n\n\t\t\t\tif (\n\t\t\t\t\t// is there space between the boxes\n\t\t\t\t\tstartNode.pageBounds.maxY < endNode.pageBounds.minY &&\n\t\t\t\t\t// do they overlap in the x axis\n\t\t\t\t\trangesOverlap(\n\t\t\t\t\t\tstartNode.pageBounds.minX,\n\t\t\t\t\t\tstartNode.pageBounds.maxX,\n\t\t\t\t\t\tendNode.pageBounds.minX,\n\t\t\t\t\t\tendNode.pageBounds.maxX\n\t\t\t\t\t)\n\t\t\t\t) {\n\t\t\t\t\tvertical.push({\n\t\t\t\t\t\tstartNode,\n\t\t\t\t\t\tendNode,\n\t\t\t\t\t\tstartEdge: [\n\t\t\t\t\t\t\tnew Vec2d(startNode.pageBounds.minX, startNode.pageBounds.maxY),\n\t\t\t\t\t\t\tnew Vec2d(startNode.pageBounds.maxX, startNode.pageBounds.maxY),\n\t\t\t\t\t\t],\n\t\t\t\t\t\tendEdge: [\n\t\t\t\t\t\t\tnew Vec2d(endNode.pageBounds.minX, endNode.pageBounds.minY),\n\t\t\t\t\t\t\tnew Vec2d(endNode.pageBounds.maxX, endNode.pageBounds.minY),\n\t\t\t\t\t\t],\n\t\t\t\t\t\tlength: endNode.pageBounds.minY - startNode.pageBounds.maxY,\n\t\t\t\t\t\tbreadthIntersection: rangeIntersection(\n\t\t\t\t\t\t\tstartNode.pageBounds.minX,\n\t\t\t\t\t\t\tstartNode.pageBounds.maxX,\n\t\t\t\t\t\t\tendNode.pageBounds.minX,\n\t\t\t\t\t\t\tendNode.pageBounds.maxX\n\t\t\t\t\t\t)!,\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn { horizontal, vertical }\n\t}\n\n\tsnapTranslate({\n\t\tlockedAxis,\n\t\tinitialSelectionPageBounds,\n\t\tinitialSelectionSnapPoints,\n\t\tdragDelta,\n\t}: {\n\t\tlockedAxis: 'x' | 'y' | null\n\t\tinitialSelectionSnapPoints: SnapPoint[]\n\t\tinitialSelectionPageBounds: Box2d\n\t\tdragDelta: Vec2d\n\t}): SnapData {\n\t\tconst isXLocked = lockedAxis === 'x'\n\t\tconst isYLocked = lockedAxis === 'y'\n\n\t\tconst selectionPageBounds = initialSelectionPageBounds.clone().translate(dragDelta)\n\t\tconst selectionSnapPoints: SnapPoint[] = initialSelectionSnapPoints.map(({ x, y }, i) => ({\n\t\t\tid: 'selection:' + i,\n\t\t\tx: x + dragDelta.x,\n\t\t\ty: y + dragDelta.y,\n\t\t}))\n\n\t\tconst otherNodeSnapPoints = this.visibleSnapPointsNotInSelection\n\n\t\tconst nearestSnapsX: NearestSnap[] = []\n\t\tconst nearestSnapsY: NearestSnap[] = []\n\t\tconst minOffset = new Vec2d(this.snapThreshold, this.snapThreshold)\n\n\t\tthis.findPointSnaps({\n\t\t\tminOffset,\n\t\t\tnearestSnapsX,\n\t\t\tnearestSnapsY,\n\t\t\totherNodeSnapPoints,\n\t\t\tselectionSnapPoints,\n\t\t})\n\n\t\tthis.findGapSnaps({ selectionPageBounds, nearestSnapsX, nearestSnapsY, minOffset })\n\n\t\t// at the same time, calculate how far we need to nudge the shape to 'snap' to the target point(s)\n\t\tconst nudge = new Vec2d(\n\t\t\tisXLocked ? 0 : nearestSnapsX[0]?.nudge ?? 0,\n\t\t\tisYLocked ? 0 : nearestSnapsY[0]?.nudge ?? 0\n\t\t)\n\n\t\t// ok we've figured out how much the box should be nudged, now let's find all the snap points\n\t\t// that are exact after making that translation, so we can render all of them.\n\t\t// first reset everything and adjust the original shapes to conform to the nudge\n\t\tminOffset.x = 0\n\t\tminOffset.y = 0\n\t\tnearestSnapsX.length = 0\n\t\tnearestSnapsY.length = 0\n\t\tselectionSnapPoints.forEach((s) => {\n\t\t\ts.x += nudge.x\n\t\t\ts.y += nudge.y\n\t\t})\n\t\tselectionPageBounds.translate(nudge)\n\n\t\tthis.findPointSnaps({\n\t\t\tminOffset,\n\t\t\tnearestSnapsX,\n\t\t\tnearestSnapsY,\n\t\t\totherNodeSnapPoints,\n\t\t\tselectionSnapPoints,\n\t\t})\n\n\t\tthis.findGapSnaps({\n\t\t\tselectionPageBounds,\n\t\t\tnearestSnapsX,\n\t\t\tnearestSnapsY,\n\t\t\tminOffset,\n\t\t})\n\n\t\tconst pointSnaps = this.getPointSnapLines({\n\t\t\tnearestSnapsX,\n\t\t\tnearestSnapsY,\n\t\t})\n\n\t\tconst gapSnaps = this.getGapSnapLines({\n\t\t\tselectionPageBounds,\n\t\t\tnearestSnapsX,\n\t\t\tnearestSnapsY,\n\t\t})\n\n\t\tthis._snapLines.set([...gapSnaps, ...pointSnaps])\n\n\t\treturn { nudge }\n\t}\n\n\t// for a handle of a line:\n\t// - find the nearest snap point\n\t// - return the nudge vector to snap to that point\n\t// note: this happens within page space\n\tsnapLineHandleTranslate({\n\t\tlineId,\n\t\thandleId,\n\t\thandlePoint,\n\t}: {\n\t\tlineId: TLShapeId\n\t\thandleId: string\n\t\thandlePoint: Vec2d\n\t}): SnapData {\n\t\tconst line = this.app.getShapeById<TLLineShape>(lineId)\n\t\tif (!line) {\n\t\t\treturn { nudge: new Vec2d(0, 0) }\n\t\t}\n\n\t\t// We want the line to be able to snap to itself!\n\t\t// but we don't want it to snap to the current segment we're drawing\n\t\t// so let's get the splines of all segments except the current one\n\t\t// and then pass them to the snap function as 'additionalOutlines'\n\n\t\t// First, let's find which handle we're dragging\n\t\tconst util = this.app.getShapeUtilByDef(TLLineShapeDef)\n\t\tconst handles = util.handles(line).sort(sortByIndex)\n\t\tif (handles.length < 3) return { nudge: new Vec2d(0, 0) }\n\n\t\tconst handleNumber = handles.findIndex((h) => h.id === handleId)\n\t\tconst handle = handles[handleNumber]\n\n\t\t// Now, let's figure out which segment this handle is on\n\t\t// So... there are two types of handles:\n\t\t// - vertex\n\t\t// - create\n\n\t\t// And this is how the handles of a line are arranged:\n\t\t// vertex --- create --- vertex -- create -- vertex\n\n\t\t// And we number them like this:\n\t\t// v --- c --- v --- c --- v\n\t\t// 0 --- 1 --- 2 --- 3 --- 4\n\n\t\t// We want to get the segments made by connecting the vertex handles:\n\t\t// v --- c --- v --- c --- v\n\t\t// 0 --- 1 --- 2 --- 3 --- 4\n\t\t// |-----------|-----------|\n\t\t// | segment 0 | segment 1 |\n\t\t// |-----------|-----------|\n\n\t\t// If we're dragging a vertex handle, we can get its segment number by dividing its handle number by 2\n\t\t// If we're dragging a create handle, we can get its segment number by adding 1 to its handle number, then dividing by 2\n\t\tconst segmentNumber = handle.type === 'vertex' ? handleNumber / 2 : (handleNumber + 1) / 2\n\n\t\t// Then, get the splines of all segments except the current one\n\t\t// (and by the way - we want to get the splines in page space, not shape space)\n\t\tconst spline = getSplineForLineShape(line)\n\t\tconst ignoreCount = 1\n\t\tconst pageTransform = this.app.getPageTransform(line)!\n\n\t\tconst pageHeadSegments = spline.segments\n\t\t\t.slice(0, Math.max(0, segmentNumber - ignoreCount))\n\t\t\t.map((s) => Matrix2d.applyToPoints(pageTransform, s.lut))\n\n\t\tconst pageTailSegments = spline.segments\n\t\t\t.slice(segmentNumber + ignoreCount)\n\t\t\t.map((s) => Matrix2d.applyToPoints(pageTransform, s.lut))\n\n\t\treturn this.snapHandleTranslate({\n\t\t\thandlePoint: handlePoint,\n\t\t\tadditionalOutlines: [...pageHeadSegments, ...pageTailSegments],\n\t\t})\n\t}\n\n\t// for a handle:\n\t// - find the nearest snap point from all non-selected shapes\n\t// - return the nudge vector to snap to that point\n\t// note: this happens within page space\n\tsnapHandleTranslate({\n\t\thandlePoint,\n\t\tadditionalOutlines = [],\n\t}: {\n\t\thandlePoint: Vec2d\n\t\tadditionalOutlines?: Vec2dModel[][]\n\t}): SnapData {\n\t\t// Get the (page-space) outlines of the shapes that are not in the selection\n\t\tconst visibleShapesNotInSelection = this.visibleShapesNotInSelection\n\t\tconst pageOutlines = []\n\t\tfor (const visibleShape of visibleShapesNotInSelection) {\n\t\t\tconst shape = this.app.getShapeById(visibleShape.id)!\n\n\t\t\tif (shape.type === 'text' || shape.type === 'icon') {\n\t\t\t\tcontinue\n\t\t\t}\n\n\t\t\tconst outline = deepCopy(this.app.getOutlineById(visibleShape.id))\n\n\t\t\tconst isClosed = this.app.getShapeUtil(shape).isClosed?.(shape)\n\n\t\t\tif (isClosed) {\n\t\t\t\toutline.push(outline[0])\n\t\t\t}\n\n\t\t\tpageOutlines.push(Matrix2d.applyToPoints(this.app.getPageTransformById(shape.id)!, outline))\n\t\t}\n\n\t\t// Find the nearest point that is within the snap threshold\n\t\tlet minDistance = this.snapThreshold\n\t\tlet nearestPoint: Vec2d | null = null\n\t\tfor (const outline of [...pageOutlines, ...additionalOutlines]) {\n\t\t\tfor (let i = 0; i < outline.length - 1; i++) {\n\t\t\t\tconst C = outline[i]\n\t\t\t\tconst D = outline[i + 1]\n\n\t\t\t\tconst distance = Vec2d.DistanceToLineSegment(C, D, handlePoint)\n\t\t\t\tif (isNaN(distance)) continue\n\t\t\t\tif (distance < minDistance) {\n\t\t\t\t\tminDistance = distance\n\t\t\t\t\tnearestPoint = Vec2d.NearestPointOnLineSegment(C, D, handlePoint)\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// If we found a point, display snap lines, and return the nudge\n\t\tif (nearestPoint) {\n\t\t\tconst snapLines: SnapLine[] = []\n\n\t\t\tsnapLines.push({\n\t\t\t\tid: uniqueId(),\n\t\t\t\ttype: 'points',\n\t\t\t\tpoints: [nearestPoint],\n\t\t\t})\n\n\t\t\tthis._snapLines.set(snapLines)\n\n\t\t\treturn {\n\t\t\t\tnudge: Vec2d.Sub(nearestPoint, handlePoint),\n\t\t\t}\n\t\t}\n\n\t\treturn { nudge: new Vec2d(0, 0) }\n\t}\n\n\tsnapResize({\n\t\tinitialSelectionPageBounds,\n\t\tdragDelta,\n\t\thandle: originalHandle,\n\t\tisAspectRatioLocked,\n\t\tisResizingFromCenter,\n\t}: {\n\t\t// the page bounds when the pointer went down, before any dragging\n\t\tinitialSelectionPageBounds: Box2d\n\t\t// how far the pointer has been dragged\n\t\tdragDelta: Vec2d\n\n\t\thandle: SelectionCorner | SelectionEdge\n\t\tisAspectRatioLocked: boolean\n\t\tisResizingFromCenter: boolean\n\t}): SnapData {\n\t\t// first figure out the new bounds of the selection\n\t\tconst {\n\t\t\tbox: unsnappedResizedPageBounds,\n\t\t\tscaleX,\n\t\t\tscaleY,\n\t\t} = Box2d.Resize(\n\t\t\tinitialSelectionPageBounds,\n\t\t\toriginalHandle,\n\t\t\tisResizingFromCenter ? dragDelta.x * 2 : dragDelta.x,\n\t\t\tisResizingFromCenter ? dragDelta.y * 2 : dragDelta.y,\n\t\t\tisAspectRatioLocked\n\t\t)\n\n\t\tlet handle = originalHandle\n\n\t\tif (scaleX < 0) {\n\t\t\thandle = flipSelectionHandleX(handle)\n\t\t}\n\t\tif (scaleY < 0) {\n\t\t\thandle = flipSelectionHandleY(handle)\n\t\t}\n\n\t\tif (isResizingFromCenter) {\n\t\t\t// reposition if resizing from center\n\t\t\tunsnappedResizedPageBounds.center = initialSelectionPageBounds.center\n\t\t}\n\n\t\tconst isXLocked = handle === 'top' || handle === 'bottom'\n\t\tconst isYLocked = handle === 'left' || handle === 'right'\n\n\t\tconst selectionSnapPoints = getResizeSnapPointsForHandle(handle, unsnappedResizedPageBounds)\n\n\t\tconst otherNodeSnapPoints = this.visibleSnapPointsNotInSelection\n\n\t\tconst nearestSnapsX: NearestPointsSnap[] = []\n\t\tconst nearestSnapsY: NearestPointsSnap[] = []\n\t\tconst minOffset = new Vec2d(this.snapThreshold, this.snapThreshold)\n\n\t\tthis.findPointSnaps({\n\t\t\tminOffset,\n\t\t\tnearestSnapsX,\n\t\t\tnearestSnapsY,\n\t\t\totherNodeSnapPoints,\n\t\t\tselectionSnapPoints,\n\t\t})\n\n\t\t// at the same time, calculate how far we need to nudge the shape to 'snap' to the target point(s)\n\t\tconst nudge = new Vec2d(\n\t\t\tisXLocked ? 0 : nearestSnapsX[0]?.nudge ?? 0,\n\t\t\tisYLocked ? 0 : nearestSnapsY[0]?.nudge ?? 0\n\t\t)\n\n\t\tif (isAspectRatioLocked && isSelectionCorner(handle) && nudge.len() !== 0) {\n\t\t\t// if the aspect ratio is locked we need to make the nudge diagonal rather than independent in each axis\n\t\t\t// so we use the aspect ratio along with one axis value to set the other axis value, but which axis we use\n\t\t\t// as a source of truth depends what we have snapped to and how far.\n\n\t\t\t// if we found a snap in both axes, pick the closest one and discard the other\n\t\t\tconst primaryNudgeAxis: 'x' | 'y' =\n\t\t\t\tnearestSnapsX.length && nearestSnapsY.length\n\t\t\t\t\t? Math.abs(nudge.x) < Math.abs(nudge.y)\n\t\t\t\t\t\t? 'x'\n\t\t\t\t\t\t: 'y'\n\t\t\t\t\t: nearestSnapsX.length\n\t\t\t\t\t? 'x'\n\t\t\t\t\t: 'y'\n\n\t\t\tconst ratio = initialSelectionPageBounds.aspectRatio\n\n\t\t\tif (primaryNudgeAxis === 'x') {\n\t\t\t\tnearestSnapsY.length = 0\n\t\t\t\tnudge.y = nudge.x / ratio\n\t\t\t\tif (handle === 'bottom_left' || handle === 'top_right') {\n\t\t\t\t\tnudge.y = -nudge.y\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tnearestSnapsX.length = 0\n\t\t\t\tnudge.x = nudge.y * ratio\n\t\t\t\tif (handle === 'bottom_left' || handle === 'top_right') {\n\t\t\t\t\tnudge.x = -nudge.x\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// now resize the box after nudging, calculate the snaps again, and return the snap lines to match\n\t\t// the fully resized box\n\t\tconst snappedDelta = Vec2d.Add(dragDelta, nudge)\n\n\t\t// first figure out the new bounds of the selection\n\t\tconst { box: snappedResizedPageBounds } = Box2d.Resize(\n\t\t\tinitialSelectionPageBounds,\n\t\t\toriginalHandle,\n\t\t\tisResizingFromCenter ? snappedDelta.x * 2 : snappedDelta.x,\n\t\t\tisResizingFromCenter ? snappedDelta.y * 2 : snappedDelta.y,\n\t\t\tisAspectRatioLocked\n\t\t)\n\n\t\tif (isResizingFromCenter) {\n\t\t\t// reposition if resizing from center\n\t\t\tsnappedResizedPageBounds.center = initialSelectionPageBounds.center\n\t\t}\n\n\t\tconst snappedSelectionPoints = getResizeSnapPointsForHandle('any', snappedResizedPageBounds)\n\t\t// calculate snaps again using all points\n\t\tnearestSnapsX.length = 0\n\t\tnearestSnapsY.length = 0\n\t\tminOffset.x = 0\n\t\tminOffset.y = 0\n\n\t\tthis.findPointSnaps({\n\t\t\tminOffset,\n\t\t\tnearestSnapsX,\n\t\t\tnearestSnapsY,\n\t\t\totherNodeSnapPoints,\n\t\t\tselectionSnapPoints: snappedSelectionPoints,\n\t\t})\n\t\tconst pointSnaps = this.getPointSnapLines({\n\t\t\tnearestSnapsX,\n\t\t\tnearestSnapsY,\n\t\t})\n\n\t\tthis._snapLines.set([...pointSnaps])\n\n\t\treturn { nudge }\n\t}\n\n\tprivate findPointSnaps({\n\t\tselectionSnapPoints,\n\t\totherNodeSnapPoints,\n\t\tminOffset,\n\t\tnearestSnapsX,\n\t\tnearestSnapsY,\n\t}: {\n\t\tselectionSnapPoints: SnapPoint[]\n\t\totherNodeSnapPoints: SnapPoint[]\n\t\tminOffset: Vec2d\n\t\tnearestSnapsX: NearestSnap[]\n\t\tnearestSnapsY: NearestSnap[]\n\t}) {\n\t\t// for each snap point on the bounding box of the selection, find the set of points\n\t\t// which are closest to it in each axis\n\t\tfor (const thisSnapPoint of selectionSnapPoints) {\n\t\t\tfor (const otherSnapPoint of otherNodeSnapPoints) {\n\t\t\t\tconst offset = Vec2d.Sub(thisSnapPoint, otherSnapPoint)\n\t\t\t\tconst offsetX = Math.abs(offset.x)\n\t\t\t\tconst offsetY = Math.abs(offset.y)\n\n\t\t\t\tif (round(offsetX) <= round(minOffset.x)) {\n\t\t\t\t\tif (round(offsetX) < round(minOffset.x)) {\n\t\t\t\t\t\t// we found a point that is significantly closer than all previous points\n\t\t\t\t\t\t// so wipe the slate clean and start over\n\t\t\t\t\t\tnearestSnapsX.length = 0\n\t\t\t\t\t}\n\n\t\t\t\t\tnearestSnapsX.push({\n\t\t\t\t\t\ttype: 'points',\n\t\t\t\t\t\tpoints: { thisPoint: thisSnapPoint, otherPoint: otherSnapPoint },\n\t\t\t\t\t\tnudge: otherSnapPoint.x - thisSnapPoint.x,\n\t\t\t\t\t})\n\t\t\t\t\tminOffset.x = offsetX\n\t\t\t\t}\n\n\t\t\t\tif (round(offsetY) <= round(minOffset.y)) {\n\t\t\t\t\tif (round(offsetY) < round(minOffset.y)) {\n\t\t\t\t\t\t// we found a point that is significantly closer than all previous points\n\t\t\t\t\t\t// so wipe the slate clean and start over\n\t\t\t\t\t\tnearestSnapsY.length = 0\n\t\t\t\t\t}\n\t\t\t\t\tnearestSnapsY.push({\n\t\t\t\t\t\ttype: 'points',\n\t\t\t\t\t\tpoints: { thisPoint: thisSnapPoint, otherPoint: otherSnapPoint },\n\t\t\t\t\t\tnudge: otherSnapPoint.y - thisSnapPoint.y,\n\t\t\t\t\t})\n\t\t\t\t\tminOffset.y = offsetY\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate findGapSnaps({\n\t\tselectionPageBounds,\n\t\tminOffset,\n\t\tnearestSnapsX,\n\t\tnearestSnapsY,\n\t}: {\n\t\tselectionPageBounds: Box2d\n\t\tminOffset: Vec2d\n\t\tnearestSnapsX: NearestSnap[]\n\t\tnearestSnapsY: NearestSnap[]\n\t}) {\n\t\tfor (const gap of this.visibleGaps.horizontal) {\n\t\t\t// ignore this gap if the selection doesn't overlap with it in the y axis\n\t\t\tif (\n\t\t\t\t!rangesOverlap(\n\t\t\t\t\tgap.breadthIntersection[0],\n\t\t\t\t\tgap.breadthIntersection[1],\n\t\t\t\t\tselectionPageBounds.minY,\n\t\t\t\t\tselectionPageBounds.maxY\n\t\t\t\t)\n\t\t\t) {\n\t\t\t\tcontinue\n\t\t\t}\n\n\t\t\t// check for center match\n\t\t\tconst gapMidX = gap.startEdge[0].x + gap.length / 2\n\t\t\tconst centerNudge = gapMidX - selectionPageBounds.center.x\n\t\t\tconst gapIsLargerThanSelection = gap.length > selectionPageBounds.width\n\n\t\t\tif (gapIsLargerThanSelection && round(Math.abs(centerNudge)) <= round(minOffset.x)) {\n\t\t\t\tif (round(Math.abs(centerNudge)) < round(minOffset.x)) {\n\t\t\t\t\t// reset if we found a closer snap\n\t\t\t\t\tnearestSnapsX.length = 0\n\t\t\t\t}\n\t\t\t\tminOffset.x = Math.abs(centerNudge)\n\n\t\t\t\tconst snap: NearestSnap = {\n\t\t\t\t\ttype: 'gap_center',\n\t\t\t\t\tgap,\n\t\t\t\t\tnudge: centerNudge,\n\t\t\t\t}\n\n\t\t\t\t// we need to avoid creating visual noise with too many center snaps in situations\n\t\t\t\t// where there are lots of adjacent items with even spacing\n\t\t\t\t// so let's only show other center snaps where the gap's breadth does not overlap with this one\n\t\t\t\t// i.e.\n\t\t\t\t//                \n\t\t\t\t//                               \n\t\t\t\t//                \n\t\t\t\t//                           \n\t\t\t\t//                    \n\t\t\t\t//                          \n\t\t\t\t//                    \n\t\t\t\t//                           \n\t\t\t\t//                   \n\t\t\t\t//                                       i'm dragging this one\n\t\t\t\t//                   \n\t\t\t\t//                     \n\t\t\t\t//                                    don't show these\n\t\t\t\t// show these                               larger gaps since\n\t\t\t\t// smaller              the smaller ones\n\t\t\t\t// gaps                                      cover the same\n\t\t\t\t//                          information\n\t\t\t\t//                                 \n\t\t\t\t//                      \n\t\t\t\t//\n\t\t\t\t// but we want to show all of these ones since the gap breadths don't overlap\n\t\t\t\t//            \n\t\t\t\t//                         \n\t\t\t\t//      \n\t\t\t\t//              \n\t\t\t\t//          \n\t\t\t\t//               \n\t\t\t\t// \n\t\t\t\t//                   i'm dragging this one\n\t\t\t\t// \n\t\t\t\t//               \n\t\t\t\t//       \n\t\t\t\t//              \n\t\t\t\t//     \n\t\t\t\t//                       \n\t\t\t\t//              \n\n\t\t\t\tconst otherCenterSnap = nearestSnapsX.find(({ type }) => type === 'gap_center') as\n\t\t\t\t\t| Extract<NearestSnap, { type: 'gap_center' }>\n\t\t\t\t\t| undefined\n\n\t\t\t\tconst gapBreadthsOverlap =\n\t\t\t\t\totherCenterSnap &&\n\t\t\t\t\trangeIntersection(\n\t\t\t\t\t\tgap.breadthIntersection[0],\n\t\t\t\t\t\tgap.breadthIntersection[1],\n\t\t\t\t\t\totherCenterSnap.gap.breadthIntersection[0],\n\t\t\t\t\t\totherCenterSnap.gap.breadthIntersection[1]\n\t\t\t\t\t)\n\n\t\t\t\t// if there is another center snap and it's bigger than this one, and it overlaps with this one, replace it\n\t\t\t\tif (otherCenterSnap && otherCenterSnap.gap.length > gap.length && gapBreadthsOverlap) {\n\t\t\t\t\tnearestSnapsX[nearestSnapsX.indexOf(otherCenterSnap)] = snap\n\t\t\t\t} else if (!otherCenterSnap || !gapBreadthsOverlap) {\n\t\t\t\t\tnearestSnapsX.push(snap)\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// check for duplication left match\n\t\t\tconst duplicationLeftX = gap.startNode.pageBounds.minX - gap.length\n\t\t\tconst selectionRightX = selectionPageBounds.maxX\n\n\t\t\tconst duplicationLeftNudge = duplicationLeftX - selectionRightX\n\t\t\tif (round(Math.abs(duplicationLeftNudge)) <= round(minOffset.x)) {\n\t\t\t\tif (round(Math.abs(duplicationLeftNudge)) < round(minOffset.x)) {\n\t\t\t\t\t// reset if we found a closer snap\n\t\t\t\t\tnearestSnapsX.length = 0\n\t\t\t\t}\n\t\t\t\tminOffset.x = Math.abs(duplicationLeftNudge)\n\n\t\t\t\tnearestSnapsX.push({\n\t\t\t\t\ttype: 'gap_duplicate',\n\t\t\t\t\tgap,\n\t\t\t\t\tprotrusionDirection: 'left',\n\t\t\t\t\tnudge: duplicationLeftNudge,\n\t\t\t\t})\n\t\t\t}\n\n\t\t\t// check for duplication right match\n\t\t\tconst duplicationRightX = gap.endNode.pageBounds.maxX + gap.length\n\t\t\tconst selectionLeftX = selectionPageBounds.minX\n\n\t\t\tconst duplicationRightNudge = duplicationRightX - selectionLeftX\n\t\t\tif (round(Math.abs(duplicationRightNudge)) <= round(minOffset.x)) {\n\t\t\t\tif (round(Math.abs(duplicationRightNudge)) < round(minOffset.x)) {\n\t\t\t\t\t// reset if we found a closer snap\n\t\t\t\t\tnearestSnapsX.length = 0\n\t\t\t\t}\n\t\t\t\tminOffset.x = Math.abs(duplicationRightNudge)\n\n\t\t\t\tnearestSnapsX.push({\n\t\t\t\t\ttype: 'gap_duplicate',\n\t\t\t\t\tgap,\n\t\t\t\t\tprotrusionDirection: 'right',\n\t\t\t\t\tnudge: duplicationRightNudge,\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\n\t\tfor (const gap of this.visibleGaps.vertical) {\n\t\t\t// ignore this gap if the selection doesn't overlap with it in the y axis\n\t\t\tif (\n\t\t\t\t!rangesOverlap(\n\t\t\t\t\tgap.breadthIntersection[0],\n\t\t\t\t\tgap.breadthIntersection[1],\n\t\t\t\t\tselectionPageBounds.minX,\n\t\t\t\t\tselectionPageBounds.maxX\n\t\t\t\t)\n\t\t\t) {\n\t\t\t\tcontinue\n\t\t\t}\n\n\t\t\t// check for center match\n\t\t\tconst gapMidY = gap.startEdge[0].y + gap.length / 2\n\t\t\tconst centerNudge = gapMidY - selectionPageBounds.center.y\n\n\t\t\tconst gapIsLargerThanSelection = gap.length > selectionPageBounds.height\n\n\t\t\tif (gapIsLargerThanSelection && round(Math.abs(centerNudge)) <= round(minOffset.y)) {\n\t\t\t\tif (round(Math.abs(centerNudge)) < round(minOffset.y)) {\n\t\t\t\t\t// reset if we found a closer snap\n\t\t\t\t\tnearestSnapsY.length = 0\n\t\t\t\t}\n\t\t\t\tminOffset.y = Math.abs(centerNudge)\n\n\t\t\t\tconst snap: NearestSnap = {\n\t\t\t\t\ttype: 'gap_center',\n\t\t\t\t\tgap,\n\t\t\t\t\tnudge: centerNudge,\n\t\t\t\t}\n\n\t\t\t\t// we need to avoid creating visual noise with too many center snaps in situations\n\t\t\t\t// where there are lots of adjacent items with even spacing\n\t\t\t\t// so let's only show other center snaps where the gap's breadth does not overlap with this one\n\t\t\t\t// i.e.\n\t\t\t\t//                \n\t\t\t\t//                               \n\t\t\t\t//                \n\t\t\t\t//                           \n\t\t\t\t//                    \n\t\t\t\t//                          \n\t\t\t\t//                    \n\t\t\t\t//                           \n\t\t\t\t//                   \n\t\t\t\t//                                       i'm dragging this one\n\t\t\t\t//                   \n\t\t\t\t//                     \n\t\t\t\t//                                    don't show these\n\t\t\t\t// show these                               larger gaps since\n\t\t\t\t// smaller              the smaller ones\n\t\t\t\t// gaps                                      cover the same\n\t\t\t\t//                          information\n\t\t\t\t//                                 \n\t\t\t\t//                      \n\t\t\t\t//\n\t\t\t\t// but we want to show all of these ones since the gap breadths don't overlap\n\t\t\t\t//            \n\t\t\t\t//                         \n\t\t\t\t//      \n\t\t\t\t//              \n\t\t\t\t//          \n\t\t\t\t//               \n\t\t\t\t// \n\t\t\t\t//                   i'm dragging this one\n\t\t\t\t// \n\t\t\t\t//               \n\t\t\t\t//       \n\t\t\t\t//              \n\t\t\t\t//     \n\t\t\t\t//                       \n\t\t\t\t//              \n\n\t\t\t\tconst otherCenterSnap = nearestSnapsY.find(({ type }) => type === 'gap_center') as\n\t\t\t\t\t| Extract<NearestSnap, { type: 'gap_center' }>\n\t\t\t\t\t| undefined\n\n\t\t\t\tconst gapBreadthsOverlap =\n\t\t\t\t\totherCenterSnap &&\n\t\t\t\t\trangesOverlap(\n\t\t\t\t\t\totherCenterSnap.gap.breadthIntersection[0],\n\t\t\t\t\t\totherCenterSnap.gap.breadthIntersection[1],\n\t\t\t\t\t\tgap.breadthIntersection[0],\n\t\t\t\t\t\tgap.breadthIntersection[1]\n\t\t\t\t\t)\n\n\t\t\t\t// if there is another center snap and it's bigger than this one, and it overlaps with this one, replace it\n\t\t\t\tif (otherCenterSnap && otherCenterSnap.gap.length > gap.length && gapBreadthsOverlap) {\n\t\t\t\t\tnearestSnapsY[nearestSnapsY.indexOf(otherCenterSnap)] = snap\n\t\t\t\t} else if (!otherCenterSnap || !gapBreadthsOverlap) {\n\t\t\t\t\tnearestSnapsY.push(snap)\n\t\t\t\t}\n\t\t\t\tcontinue\n\t\t\t}\n\n\t\t\t// check for duplication top match\n\t\t\tconst duplicationTopY = gap.startNode.pageBounds.minY - gap.length\n\t\t\tconst selectionBottomY = selectionPageBounds.maxY\n\n\t\t\tconst duplicationTopNudge = duplicationTopY - selectionBottomY\n\t\t\tif (round(Math.abs(duplicationTopNudge)) <= round(minOffset.y)) {\n\t\t\t\tif (round(Math.abs(duplicationTopNudge)) < round(minOffset.y)) {\n\t\t\t\t\t// reset if we found a closer snap\n\t\t\t\t\tnearestSnapsY.length = 0\n\t\t\t\t}\n\t\t\t\tminOffset.y = Math.abs(duplicationTopNudge)\n\n\t\t\t\tnearestSnapsY.push({\n\t\t\t\t\ttype: 'gap_duplicate',\n\t\t\t\t\tgap,\n\t\t\t\t\tprotrusionDirection: 'top',\n\t\t\t\t\tnudge: duplicationTopNudge,\n\t\t\t\t})\n\t\t\t}\n\n\t\t\t// check for duplication bottom match\n\t\t\tconst duplicationBottomY = gap.endNode.pageBounds.maxY + gap.length\n\t\t\tconst selectionTopY = selectionPageBounds.minY\n\n\t\t\tconst duplicationBottomNudge = duplicationBottomY - selectionTopY\n\t\t\tif (round(Math.abs(duplicationBottomNudge)) <= round(minOffset.y)) {\n\t\t\t\tif (round(Math.abs(duplicationBottomNudge)) < round(minOffset.y)) {\n\t\t\t\t\t// reset if we found a closer snap\n\t\t\t\t\tnearestSnapsY.length = 0\n\t\t\t\t}\n\t\t\t\tminOffset.y = Math.abs(duplicationBottomNudge)\n\n\t\t\t\tnearestSnapsY.push({\n\t\t\t\t\ttype: 'gap_duplicate',\n\t\t\t\t\tgap,\n\t\t\t\t\tprotrusionDirection: 'bottom',\n\t\t\t\t\tnudge: duplicationBottomNudge,\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\t}\n\n\tgetPointSnapLines({\n\t\tnearestSnapsX,\n\t\tnearestSnapsY,\n\t}: {\n\t\tnearestSnapsX: NearestSnap[]\n\t\tnearestSnapsY: NearestSnap[]\n\t}) {\n\t\t// point snaps may align on multiple parallel lines so we need to split the pairs\n\t\t// into groups based on where they are in their their snap axes\n\t\tconst snapGroupsX = {} as { [key: string]: SnapPair[] }\n\t\tconst snapGroupsY = {} as { [key: string]: SnapPair[] }\n\t\tconst result: PointsSnapLine[] = []\n\n\t\tif (nearestSnapsX.length > 0) {\n\t\t\tfor (const snap of nearestSnapsX) {\n\t\t\t\tif (snap.type === 'points') {\n\t\t\t\t\tconst key = round(snap.points.otherPoint.x)\n\t\t\t\t\tif (!snapGroupsX[key]) {\n\t\t\t\t\t\tsnapGroupsX[key] = []\n\t\t\t\t\t}\n\t\t\t\t\tsnapGroupsX[key].push(snap.points)\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (nearestSnapsY.length > 0) {\n\t\t\tfor (const snap of nearestSnapsY) {\n\t\t\t\tif (snap.type === 'points') {\n\t\t\t\t\tconst key = round(snap.points.otherPoint.y)\n\t\t\t\t\tif (!snapGroupsY[key]) {\n\t\t\t\t\t\tsnapGroupsY[key] = []\n\t\t\t\t\t}\n\t\t\t\t\tsnapGroupsY[key].push(snap.points)\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// and finally create all the snap lines for the UI to render\n\t\tfor (const [_, snapGroup] of Object.entries(snapGroupsX).concat(Object.entries(snapGroupsY))) {\n\t\t\tresult.push({\n\t\t\t\tid: uniqueId(),\n\t\t\t\ttype: 'points',\n\t\t\t\tpoints: dedupe(\n\t\t\t\t\tsnapGroup\n\t\t\t\t\t\t.map((snap) => Vec2d.From(snap.otherPoint))\n\t\t\t\t\t\t// be sure to nudge over the selection snap points\n\t\t\t\t\t\t.concat(snapGroup.map((snap) => Vec2d.From(snap.thisPoint))),\n\t\t\t\t\t(a: Vec2d, b: Vec2d) => a.equals(b)\n\t\t\t\t),\n\t\t\t})\n\t\t}\n\n\t\treturn result\n\t}\n\n\tgetGapSnapLines({\n\t\tselectionPageBounds,\n\t\tnearestSnapsX,\n\t\tnearestSnapsY,\n\t}: {\n\t\tselectionPageBounds: Box2d\n\t\tnearestSnapsX: NearestSnap[]\n\t\tnearestSnapsY: NearestSnap[]\n\t}): GapsSnapLine[] {\n\t\tconst selectionSides: Record<SelectionEdge, [Vec2d, Vec2d]> = {\n\t\t\ttop: selectionPageBounds.sides[0],\n\t\t\tright: selectionPageBounds.sides[1],\n\t\t\t// need bottom and left to be sorted asc, which .sides is not.\n\t\t\tbottom: [selectionPageBounds.corners[3], selectionPageBounds.corners[2]],\n\t\t\tleft: [selectionPageBounds.corners[0], selectionPageBounds.corners[3]],\n\t\t}\n\n\t\tconst result: GapsSnapLine[] = []\n\n\t\tif (nearestSnapsX.length > 0) {\n\t\t\tfor (const snap of nearestSnapsX) {\n\t\t\t\tif (snap.type === 'gap_center') {\n\t\t\t\t\t// create\n\t\t\t\t\tconst newGapsLength = (snap.gap.length - selectionPageBounds.width) / 2\n\t\t\t\t\tconst gapBreadthIntersection = rangeIntersection(\n\t\t\t\t\t\tsnap.gap.breadthIntersection[0],\n\t\t\t\t\t\tsnap.gap.breadthIntersection[1],\n\t\t\t\t\t\tselectionPageBounds.minY,\n\t\t\t\t\t\tselectionPageBounds.maxY\n\t\t\t\t\t)!\n\t\t\t\t\tresult.push({\n\t\t\t\t\t\ttype: 'gaps',\n\t\t\t\t\t\tdirection: 'horizontal',\n\t\t\t\t\t\tid: uniqueId(),\n\t\t\t\t\t\tgaps: [\n\t\t\t\t\t\t\t...findAdjacentGaps(\n\t\t\t\t\t\t\t\tthis.visibleGaps.horizontal,\n\t\t\t\t\t\t\t\tsnap.gap.startNode.id,\n\t\t\t\t\t\t\t\tnewGapsLength,\n\t\t\t\t\t\t\t\t'backward',\n\t\t\t\t\t\t\t\tgapBreadthIntersection\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tstartEdge: snap.gap.startEdge,\n\t\t\t\t\t\t\t\tendEdge: selectionSides.left,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tstartEdge: selectionSides.right,\n\t\t\t\t\t\t\t\tendEdge: snap.gap.endEdge,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t...findAdjacentGaps(\n\t\t\t\t\t\t\t\tthis.visibleGaps.horizontal,\n\t\t\t\t\t\t\t\tsnap.gap.endNode.id,\n\t\t\t\t\t\t\t\tnewGapsLength,\n\t\t\t\t\t\t\t\t'forward',\n\t\t\t\t\t\t\t\tgapBreadthIntersection\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t],\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t\tif (snap.type === 'gap_duplicate') {\n\t\t\t\t\t// create\n\t\t\t\t\tconst gapBreadthIntersection = rangeIntersection(\n\t\t\t\t\t\tsnap.gap.breadthIntersection[0],\n\t\t\t\t\t\tsnap.gap.breadthIntersection[1],\n\t\t\t\t\t\tselectionPageBounds.minY,\n\t\t\t\t\t\tselectionPageBounds.maxY\n\t\t\t\t\t)!\n\t\t\t\t\tresult.push({\n\t\t\t\t\t\ttype: 'gaps',\n\t\t\t\t\t\tdirection: 'horizontal',\n\t\t\t\t\t\tid: uniqueId(),\n\t\t\t\t\t\tgaps:\n\t\t\t\t\t\t\tsnap.protrusionDirection === 'left'\n\t\t\t\t\t\t\t\t? [\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tstartEdge: selectionSides.right,\n\t\t\t\t\t\t\t\t\t\t\tendEdge: [\n\t\t\t\t\t\t\t\t\t\t\t\tVec2d.Add(snap.gap.startEdge[0], {\n\t\t\t\t\t\t\t\t\t\t\t\t\tx: -snap.gap.startNode.pageBounds.width,\n\t\t\t\t\t\t\t\t\t\t\t\t\ty: 0,\n\t\t\t\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\t\t\t\tVec2d.Add(snap.gap.startEdge[1], {\n\t\t\t\t\t\t\t\t\t\t\t\t\tx: -snap.gap.startNode.pageBounds.width,\n\t\t\t\t\t\t\t\t\t\t\t\t\ty: 0,\n\t\t\t\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tstartEdge: snap.gap.startEdge,\n\t\t\t\t\t\t\t\t\t\t\tendEdge: snap.gap.endEdge,\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t...findAdjacentGaps(\n\t\t\t\t\t\t\t\t\t\t\tthis.visibleGaps.horizontal,\n\t\t\t\t\t\t\t\t\t\t\tsnap.gap.endNode.id,\n\t\t\t\t\t\t\t\t\t\t\tsnap.gap.length,\n\t\t\t\t\t\t\t\t\t\t\t'forward',\n\t\t\t\t\t\t\t\t\t\t\tgapBreadthIntersection\n\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t  ]\n\t\t\t\t\t\t\t\t: [\n\t\t\t\t\t\t\t\t\t\t...findAdjacentGaps(\n\t\t\t\t\t\t\t\t\t\t\tthis.visibleGaps.horizontal,\n\t\t\t\t\t\t\t\t\t\t\tsnap.gap.startNode.id,\n\t\t\t\t\t\t\t\t\t\t\tsnap.gap.length,\n\t\t\t\t\t\t\t\t\t\t\t'backward',\n\t\t\t\t\t\t\t\t\t\t\tgapBreadthIntersection\n\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tstartEdge: snap.gap.startEdge,\n\t\t\t\t\t\t\t\t\t\t\tendEdge: snap.gap.endEdge,\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tstartEdge: [\n\t\t\t\t\t\t\t\t\t\t\t\tVec2d.Add(snap.gap.endEdge[0], {\n\t\t\t\t\t\t\t\t\t\t\t\t\tx: snap.gap.endNode.pageBounds.width,\n\t\t\t\t\t\t\t\t\t\t\t\t\ty: 0,\n\t\t\t\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\t\t\t\tVec2d.Add(snap.gap.endEdge[1], {\n\t\t\t\t\t\t\t\t\t\t\t\t\tx: snap.gap.endNode.pageBounds.width,\n\t\t\t\t\t\t\t\t\t\t\t\t\ty: 0,\n\t\t\t\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\t\t\t\tendEdge: selectionSides.left,\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t  ],\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (nearestSnapsY.length > 0) {\n\t\t\tfor (const snap of nearestSnapsY) {\n\t\t\t\tif (snap.type === 'gap_center') {\n\t\t\t\t\tconst newGapsLength = (snap.gap.length - selectionPageBounds.height) / 2\n\t\t\t\t\tconst gapBreadthIntersection = rangeIntersection(\n\t\t\t\t\t\tsnap.gap.breadthIntersection[0],\n\t\t\t\t\t\tsnap.gap.breadthIntersection[1],\n\t\t\t\t\t\tselectionPageBounds.minX,\n\t\t\t\t\t\tselectionPageBounds.maxX\n\t\t\t\t\t)!\n\t\t\t\t\tresult.push({\n\t\t\t\t\t\ttype: 'gaps',\n\t\t\t\t\t\tdirection: 'vertical',\n\t\t\t\t\t\tid: uniqueId(),\n\t\t\t\t\t\tgaps: [\n\t\t\t\t\t\t\t...findAdjacentGaps(\n\t\t\t\t\t\t\t\tthis.visibleGaps.vertical,\n\t\t\t\t\t\t\t\tsnap.gap.startNode.id,\n\t\t\t\t\t\t\t\tnewGapsLength,\n\t\t\t\t\t\t\t\t'backward',\n\t\t\t\t\t\t\t\tgapBreadthIntersection\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tstartEdge: snap.gap.startEdge,\n\t\t\t\t\t\t\t\tendEdge: selectionSides.top,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tstartEdge: selectionSides.bottom,\n\t\t\t\t\t\t\t\tendEdge: snap.gap.endEdge,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t...findAdjacentGaps(\n\t\t\t\t\t\t\t\tthis.visibleGaps.vertical,\n\t\t\t\t\t\t\t\tsnap.gap.endNode.id,\n\t\t\t\t\t\t\t\tnewGapsLength,\n\t\t\t\t\t\t\t\t'forward',\n\t\t\t\t\t\t\t\tgapBreadthIntersection\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t],\n\t\t\t\t\t})\n\t\t\t\t}\n\n\t\t\t\tif (snap.type === 'gap_duplicate') {\n\t\t\t\t\tconst gapBreadthIntersection = rangeIntersection(\n\t\t\t\t\t\tsnap.gap.breadthIntersection[0],\n\t\t\t\t\t\tsnap.gap.breadthIntersection[1],\n\t\t\t\t\t\tselectionPageBounds.minX,\n\t\t\t\t\t\tselectionPageBounds.maxX\n\t\t\t\t\t)!\n\t\t\t\t\tresult.push({\n\t\t\t\t\t\ttype: 'gaps',\n\t\t\t\t\t\tdirection: 'vertical',\n\t\t\t\t\t\tid: uniqueId(),\n\t\t\t\t\t\tgaps:\n\t\t\t\t\t\t\tsnap.protrusionDirection === 'top'\n\t\t\t\t\t\t\t\t? [\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tstartEdge: selectionSides.bottom,\n\t\t\t\t\t\t\t\t\t\t\tendEdge: [\n\t\t\t\t\t\t\t\t\t\t\t\tVec2d.Add(snap.gap.startEdge[0], {\n\t\t\t\t\t\t\t\t\t\t\t\t\tx: 0,\n\t\t\t\t\t\t\t\t\t\t\t\t\ty: -snap.gap.startNode.pageBounds.height,\n\t\t\t\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\t\t\t\tVec2d.Add(snap.gap.startEdge[1], {\n\t\t\t\t\t\t\t\t\t\t\t\t\tx: 0,\n\t\t\t\t\t\t\t\t\t\t\t\t\ty: -snap.gap.startNode.pageBounds.height,\n\t\t\t\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tstartEdge: snap.gap.startEdge,\n\t\t\t\t\t\t\t\t\t\t\tendEdge: snap.gap.endEdge,\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t...findAdjacentGaps(\n\t\t\t\t\t\t\t\t\t\t\tthis.visibleGaps.vertical,\n\t\t\t\t\t\t\t\t\t\t\tsnap.gap.endNode.id,\n\t\t\t\t\t\t\t\t\t\t\tsnap.gap.length,\n\t\t\t\t\t\t\t\t\t\t\t'forward',\n\t\t\t\t\t\t\t\t\t\t\tgapBreadthIntersection\n\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t  ]\n\t\t\t\t\t\t\t\t: [\n\t\t\t\t\t\t\t\t\t\t...findAdjacentGaps(\n\t\t\t\t\t\t\t\t\t\t\tthis.visibleGaps.vertical,\n\t\t\t\t\t\t\t\t\t\t\tsnap.gap.startNode.id,\n\t\t\t\t\t\t\t\t\t\t\tsnap.gap.length,\n\t\t\t\t\t\t\t\t\t\t\t'backward',\n\t\t\t\t\t\t\t\t\t\t\tgapBreadthIntersection\n\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tstartEdge: snap.gap.startEdge,\n\t\t\t\t\t\t\t\t\t\t\tendEdge: snap.gap.endEdge,\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tstartEdge: [\n\t\t\t\t\t\t\t\t\t\t\t\tVec2d.Add(snap.gap.endEdge[0], {\n\t\t\t\t\t\t\t\t\t\t\t\t\tx: 0,\n\t\t\t\t\t\t\t\t\t\t\t\t\ty: snap.gap.endNode.pageBounds.height,\n\t\t\t\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\t\t\t\tVec2d.Add(snap.gap.endEdge[1], {\n\t\t\t\t\t\t\t\t\t\t\t\t\tx: 0,\n\t\t\t\t\t\t\t\t\t\t\t\t\ty: snap.gap.endNode.pageBounds.height,\n\t\t\t\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\t\t\t\tendEdge: selectionSides.top,\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t  ],\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tdedupeGapSnaps(result)\n\t\treturn result\n\t}\n}\n\nfunction getResizeSnapPointsForHandle(\n\thandle: SelectionCorner | SelectionEdge | 'any',\n\tselectionPageBounds: Box2d\n): SnapPoint[] {\n\tconst { minX, maxX, minY, maxY } = selectionPageBounds\n\tconst result: SnapPoint[] = []\n\n\t// top left corner\n\tswitch (handle) {\n\t\tcase 'top':\n\t\tcase 'left':\n\t\tcase 'top_left':\n\t\tcase 'any':\n\t\t\tresult.push({\n\t\t\t\tid: 'top_left',\n\t\t\t\thandle: 'top_left',\n\t\t\t\tx: minX,\n\t\t\t\ty: minY,\n\t\t\t})\n\t}\n\n\t// top right corner\n\tswitch (handle) {\n\t\tcase 'top':\n\t\tcase 'right':\n\t\tcase 'top_right':\n\t\tcase 'any':\n\t\t\tresult.push({\n\t\t\t\tid: 'top_right',\n\t\t\t\thandle: 'top_right',\n\t\t\t\tx: maxX,\n\t\t\t\ty: minY,\n\t\t\t})\n\t}\n\n\t// bottom right corner\n\tswitch (handle) {\n\t\tcase 'bottom':\n\t\tcase 'right':\n\t\tcase 'bottom_right':\n\t\tcase 'any':\n\t\t\tresult.push({\n\t\t\t\tid: 'bottom_right',\n\t\t\t\thandle: 'bottom_right',\n\t\t\t\tx: maxX,\n\t\t\t\ty: maxY,\n\t\t\t})\n\t}\n\n\t// bottom left corner\n\tswitch (handle) {\n\t\tcase 'bottom':\n\t\tcase 'left':\n\t\tcase 'bottom_left':\n\t\tcase 'any':\n\t\t\tresult.push({\n\t\t\t\tid: 'bottom_left',\n\t\t\t\thandle: 'bottom_left',\n\t\t\t\tx: minX,\n\t\t\t\ty: maxY,\n\t\t\t})\n\t}\n\n\treturn result\n}\n","import { Box2dModel, TLAlignType } from '@tldraw/tlschema'\nimport { uniqueId } from '../../utils'\nimport { App } from '../App'\nimport { TextHelpers } from '../shapeutils/TLTextUtil/TextHelpers'\n\nconst wordSeparator = new RegExp(\n\t`${[0x0020, 0x00a0, 0x1361, 0x10100, 0x10101, 0x1039, 0x1091]\n\t\t.map((c) => String.fromCodePoint(c))\n\t\t.join('|')}`\n)\n\nconst textAlignmentsForLtr: Record<TLAlignType, string> = {\n\tstart: 'left',\n\tmiddle: 'center',\n\tend: 'right',\n\tjustify: 'justify',\n}\n\nexport class TextManager {\n\tconstructor(public app: App) {}\n\n\tgetTextElement() {\n\t\tconst elm = document.createElement('div')\n\t\tthis.app.getContainer().appendChild(elm)\n\n\t\telm.id = `__textMeasure_${uniqueId()}`\n\t\telm.classList.add('rs-text')\n\t\telm.classList.add('rs-text-measure')\n\t\telm.tabIndex = -1\n\n\t\treturn elm\n\t}\n\n\tmeasureText = (opts: {\n\t\ttext: string\n\t\tfontStyle: string\n\t\tfontWeight: string\n\t\tfontFamily: string\n\t\tfontSize: number\n\t\tlineHeight: number\n\t\twidth: string\n\t\tminWidth?: string\n\t\tmaxWidth: string\n\t\tpadding: string\n\t}): Box2dModel => {\n\t\tconst elm = this.getTextElement()\n\n\t\telm.setAttribute('dir', 'ltr')\n\t\telm.style.setProperty('font-family', opts.fontFamily)\n\t\telm.style.setProperty('font-style', opts.fontStyle)\n\t\telm.style.setProperty('font-weight', opts.fontWeight)\n\t\telm.style.setProperty('font-size', opts.fontSize + 'px')\n\t\telm.style.setProperty('line-height', opts.lineHeight * opts.fontSize + 'px')\n\t\telm.style.setProperty('width', opts.width)\n\t\telm.style.setProperty('min-width', opts.minWidth ?? null)\n\t\telm.style.setProperty('max-width', opts.maxWidth)\n\t\telm.style.setProperty('padding', opts.padding)\n\n\t\telm.textContent = TextHelpers.normalizeTextForDom(opts.text)\n\n\t\tconst rect = elm.getBoundingClientRect()\n\n\t\telm.remove()\n\n\t\treturn {\n\t\t\tx: 0,\n\t\t\ty: 0,\n\t\t\tw: rect.width,\n\t\t\th: rect.height,\n\t\t}\n\t}\n\n\tgetTextLines(opts: {\n\t\ttext: string\n\t\twrap: boolean\n\t\twidth: number\n\t\theight: number\n\t\tpadding: number\n\t\tfontSize: number\n\t\tfontWeight: string\n\t\tfontFamily: string\n\t\tfontStyle: string\n\t\tlineHeight: number\n\t\ttextAlign: TLAlignType\n\t}): string[] {\n\t\tconst elm = this.getTextElement()\n\n\t\telm.style.setProperty('width', opts.width - opts.padding * 2 + 'px')\n\t\telm.style.setProperty('height', 'min-content')\n\t\telm.style.setProperty('dir', 'ltr')\n\t\telm.style.setProperty('font-size', opts.fontSize + 'px')\n\t\telm.style.setProperty('font-family', opts.fontFamily)\n\t\telm.style.setProperty('font-weight', opts.fontWeight)\n\t\telm.style.setProperty('line-height', opts.lineHeight * opts.fontSize + 'px')\n\t\telm.style.setProperty('text-align', textAlignmentsForLtr[opts.textAlign])\n\n\t\t// Split the text into words\n\t\tconst words: string[] = []\n\n\t\topts.text.split(wordSeparator).flatMap((word) =>\n\t\t\tword\n\t\t\t\t.split('\\n')\n\t\t\t\t.map((w) => w.trim())\n\t\t\t\t.join('\\n')\n\t\t)\n\n\t\tfor (const str of opts.text.split(wordSeparator)) {\n\t\t\tif (str.includes('\\n')) {\n\t\t\t\tconst splits = str.split('\\n')\n\t\t\t\tfor (let i = 0; i < splits.length; i++) {\n\t\t\t\t\tsplits[i] = splits[i].trim()\n\t\t\t\t\tif (splits[i]) words.push(splits[i])\n\t\t\t\t\tif (i < splits.length - 1) words.push('\\n')\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\twords.push(str)\n\t\t\t}\n\t\t}\n\n\t\tconst finalWords: string[] = []\n\n\t\tfor (let i = 0; i < words.length; i++) {\n\t\t\tconst word = words[i]\n\t\t\tfinalWords.push(word)\n\t\t\tif (word === '\\n') {\n\t\t\t\tif (words[i + 1] === '') {\n\t\t\t\t\ti++\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tlet i = finalWords.length - 1\n\n\t\twhile (finalWords[i] === '') {\n\t\t\tfinalWords.pop()\n\t\t\tif (i === 0) break\n\t\t\ti--\n\t\t}\n\n\t\tlet currentLine: string[] = []\n\t\tconst lines: string[][] = []\n\n\t\telm.textContent = ''\n\t\tlet prevHeight = elm.offsetHeight\n\n\t\tlet prevTextContent = elm.textContent\n\n\t\tfor (let i = 0; i < finalWords.length; i++) {\n\t\t\tconst word = finalWords[i]\n\n\t\t\t// add the word to the text element\n\t\t\tconst wordWithSpace = word === '\\n' ? word : `${word} `\n\t\t\telm.textContent += wordWithSpace\n\n\t\t\t// measure its height\n\t\t\tconst newHeight = elm.offsetHeight\n\n\t\t\tif (newHeight <= prevHeight) {\n\t\t\t\t// If the height has not increased, then add the word to the current line\n\t\t\t\tcurrentLine.push(currentLine.length ? ' ' + word.trim() : word.trim())\n\t\t\t} else {\n\t\t\t\t// Hey, we've just caused a line break!\n\t\t\t\tif (!opts.wrap || word === '\\n') {\n\t\t\t\t\t// If we're not wrapping, or if the word is a newline, then start a new line.\n\t\t\t\t\tcurrentLine = []\n\t\t\t\t\tlines.push(currentLine)\n\t\t\t\t} else {\n\t\t\t\t\t// If we're wrapping, then buckle the fuck up, because we need to\n\t\t\t\t\t// see whether we can fit the word on a single line or else break it\n\t\t\t\t\t// into multiple lines in order to replicate break-word.\n\n\t\t\t\t\t// We need to make sure that the first word on this line isn't so\n\t\t\t\t\t// long that it ALSO causes a line break. If it does, then we'll\n\t\t\t\t\t// need to manually create the effect of CSS's 'break-word', splitting\n\t\t\t\t\t// the word into multiple lines.\n\n\t\t\t\t\t// Save the state of the text content that caused the break to occur.\n\t\t\t\t\t// We'll put this back again at the end of the loop, so that we can\n\t\t\t\t\t// continue from this point.\n\t\t\t\t\tconst afterTextContent: string = elm.textContent\n\n\t\t\t\t\t// Set the text content to the previous text content, before adding\n\t\t\t\t\t// the word, so that we can begin to find line breaks.\n\t\t\t\t\telm.textContent = prevTextContent\n\n\t\t\t\t\t// Force a new line, since we know that the text will break the line\n\t\t\t\t\t// and we want to start measuring from the start of the line.\n\t\t\t\t\telm.textContent += '\\n'\n\n\t\t\t\t\t// Split the word into individual characters.\n\t\t\t\t\tconst chars = [...word]\n\n\t\t\t\t\t// Add the first character to the measurement element's text content.\n\t\t\t\t\telm.textContent += chars[0]\n\n\t\t\t\t\t// Set the \"previous height\" to the text element's scroll height.\n\t\t\t\t\tprevHeight = elm.offsetHeight\n\n\t\t\t\t\t// Similar to how we're breaking with words, we're not going to loop\n\t\t\t\t\t// through each character looking for new lines within the word (sublines).\n\t\t\t\t\t// We'll start with a collection of one subline that contains the first\n\t\t\t\t\t// character in the word.\n\t\t\t\t\tlet currentSubLine: string[] = [chars[0]]\n\t\t\t\t\tconst subLines: string[][] = [currentSubLine]\n\n\t\t\t\t\t// For each remaining character in the word...\n\t\t\t\t\tfor (let i = 1; i < chars.length; i++) {\n\t\t\t\t\t\tconst char = chars[i]\n\n\t\t\t\t\t\t// ...add the character to the text element\n\t\t\t\t\t\telm.textContent += char\n\n\t\t\t\t\t\t// ...and measure the height\n\t\t\t\t\t\tconst newHeight = elm.offsetHeight\n\n\t\t\t\t\t\tif (newHeight > prevHeight) {\n\t\t\t\t\t\t\t// If the height has increased, then we've triggered a \"break-word\".\n\t\t\t\t\t\t\t// Create a new current subline containing the character, and add\n\t\t\t\t\t\t\t// it to the sublines array.\n\t\t\t\t\t\t\tcurrentSubLine = [char]\n\t\t\t\t\t\t\tsubLines.push(currentSubLine)\n\n\t\t\t\t\t\t\t// Also update the prev height for next time\n\t\t\t\t\t\t\tprevHeight = newHeight\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// If the height hasn't increased, then we're still on the same\n\t\t\t\t\t\t\t// subline and can just push the char in.\n\t\t\t\t\t\t\tcurrentSubLine.push(char)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Finally, turn each subline of characters into a string and push\n\t\t\t\t\t// each line into the lines array.\n\t\t\t\t\tconst joinedSubLines = subLines.map((b) => [b.join('')])\n\t\t\t\t\tlines.push(...joinedSubLines)\n\n\t\t\t\t\t// Set the current line to the last subline\n\t\t\t\t\tcurrentLine = lines[lines.length - 1]\n\n\t\t\t\t\t// Restore the text content that caused the line break to occur\n\t\t\t\t\telm.textContent = afterTextContent\n\n\t\t\t\t\t// And set prevHeight to the new height\n\t\t\t\t\tprevHeight = elm.offsetHeight\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tprevTextContent = elm.textContent\n\t\t}\n\n\t\tconst result = lines.map((line) => line.join('').trim())\n\n\t\telm.remove()\n\n\t\treturn result\n\t}\n}\n","import { Vec2d } from '@tldraw/primitives'\nimport { App } from '../App'\n\nexport class TickManager {\n\tconstructor(public app: App) {\n\t\tthis.app.disposables.add(this.dispose)\n\t\tthis.start()\n\t}\n\n\traf: any\n\tisPaused = true\n\tlast = 0\n\tt = 0\n\n\tstart = () => {\n\t\tthis.isPaused = false\n\t\tcancelAnimationFrame(this.raf)\n\t\tthis.raf = requestAnimationFrame(this.tick)\n\t\tthis.last = Date.now()\n\t}\n\n\ttick = () => {\n\t\tif (this.isPaused) {\n\t\t\treturn\n\t\t}\n\n\t\tconst now = Date.now()\n\t\tconst elapsed = now - this.last\n\t\tthis.last = now\n\t\tthis.t += elapsed\n\n\t\tif (this.t < 16) {\n\t\t\tthis.raf = requestAnimationFrame(this.tick)\n\t\t\treturn\n\t\t}\n\n\t\tthis.t -= 16\n\t\tthis.updatePointerVelocity(elapsed)\n\t\tthis.app.emit('tick', elapsed)\n\t\tthis.raf = requestAnimationFrame(this.tick)\n\t}\n\n\t// Clear the listener\n\tdispose = () => {\n\t\tthis.isPaused = true\n\t\tcancelAnimationFrame(this.raf)\n\t}\n\n\tprivate prevPoint = new Vec2d()\n\n\tprivate updatePointerVelocity = (elapsed: number) => {\n\t\tconst {\n\t\t\tprevPoint,\n\t\t\tapp: {\n\t\t\t\tinputs: { currentScreenPoint, pointerVelocity },\n\t\t\t},\n\t\t} = this\n\n\t\tif (elapsed === 0) return\n\n\t\tconst delta = Vec2d.Sub(currentScreenPoint, prevPoint)\n\t\tthis.prevPoint = currentScreenPoint.clone()\n\n\t\tconst length = delta.len()\n\t\tconst direction = length ? delta.div(length) : new Vec2d(0, 0)\n\n\t\t// consider adjusting this with an easing rather than a linear interpolation\n\t\tconst next = pointerVelocity.clone().lrp(direction.mul(length / elapsed), 0.5)\n\n\t\t// if the velocity is very small, just set it to 0\n\t\tif (Math.abs(next.x) < 0.01) next.x = 0\n\t\tif (Math.abs(next.y) < 0.01) next.y = 0\n\n\t\tif (!pointerVelocity.equals(next)) {\n\t\t\tthis.app.inputs.pointerVelocity = next\n\t\t}\n\t}\n}\n","import { VecLike } from '@tldraw/primitives'\nimport { TLHandle, TLShape, Vec2dModel } from '@tldraw/tlschema'\nimport { TLSelectionHandle } from './selection-types'\n\n/** @public */\nexport type UiEventType = 'pointer' | 'click' | 'keyboard' | 'wheel' | 'pinch' | 'zoom'\n\n/** @public */\nexport type TLPointerEventTarget =\n\t| { target: 'canvas'; shape?: undefined }\n\t| { target: 'selection'; handle?: TLSelectionHandle; shape?: undefined }\n\t| { target: 'shape'; shape: TLShape }\n\t| { target: 'handle'; shape: TLShape; handle: TLHandle }\n\n/** @public */\nexport type TLPointerEventName =\n\t| 'pointer_down'\n\t| 'pointer_move'\n\t| 'pointer_up'\n\t| 'pointer_enter'\n\t| 'pointer_leave'\n\t| 'right_click'\n\t| 'middle_click'\n\n/** @public */\nexport type TLCLickEventName = 'double_click' | 'triple_click' | 'quadruple_click'\n\n/** @public */\nexport type TLPinchEventName = 'pinch_start' | 'pinch' | 'pinch_end'\n\n/** @public */\nexport type TLKeyboardEventName = 'key_down' | 'key_up'\n\n/** @public */\nexport type TLEventName =\n\t| TLPointerEventName\n\t| TLCLickEventName\n\t| TLPinchEventName\n\t| TLKeyboardEventName\n\t| 'wheel'\n\t| 'cancel'\n\t| 'complete'\n\t| 'interrupt'\n\t| 'blur'\n\n/** @public */\nexport interface TLBaseEventInfo {\n\ttype: UiEventType\n\tshiftKey: boolean\n\taltKey: boolean\n\tctrlKey: boolean\n}\n\n/** @public */\nexport type TLPointerEventInfo = TLBaseEventInfo & {\n\ttype: 'pointer'\n\tname: TLPointerEventName\n\tpoint: VecLike\n\tpointerId: number\n\tbutton: number\n\tisPen: boolean\n} & TLPointerEventTarget\n\n/** @public */\nexport type TLClickEventInfo = TLBaseEventInfo & {\n\ttype: 'click'\n\tname: TLCLickEventName\n\tpoint: VecLike\n\tpointerId: number\n\tbutton: number\n\tphase: 'down' | 'up' | 'settle'\n} & TLPointerEventTarget\n\n/** @public */\nexport type TLKeyboardEventInfo = TLBaseEventInfo & {\n\ttype: 'keyboard'\n\tname: TLKeyboardEventName\n\tkey: string\n}\n\n/** @public */\nexport type TLPinchEventInfo = TLBaseEventInfo & {\n\ttype: 'pinch'\n\tname: TLPinchEventName\n\tpoint: Vec2dModel\n\tdelta: Vec2dModel\n}\n\n/** @public */\nexport type TLWheelEventInfo = TLBaseEventInfo & {\n\ttype: 'wheel'\n\tname: 'wheel'\n\tdelta: Vec2dModel\n}\n\n/** @public */\nexport type TLBlurEventInfo = { type: 'misc'; name: 'blur' }\n/** @public */\nexport type TLCancelEventInfo = { type: 'misc'; name: 'cancel' }\n/** @public */\nexport type TLCompleteEventInfo = { type: 'misc'; name: 'complete' }\n/** @public */\nexport type TLInterruptEventInfo = { type: 'misc'; name: 'interrupt' }\n\n/** @public */\nexport type TLEventInfo =\n\t| TLPointerEventInfo\n\t| TLClickEventInfo\n\t| TLKeyboardEventInfo\n\t| TLPinchEventInfo\n\t| TLWheelEventInfo\n\t| TLCancelEventInfo\n\t| TLCompleteEventInfo\n\t| TLInterruptEventInfo\n\t| TLBlurEventInfo\n\n/** @public */\nexport type TLPointerEvent = (info: TLPointerEventInfo) => void\n/** @public */\nexport type TLClickEvent = (info: TLClickEventInfo) => void\n/** @public */\nexport type TLKeyboardEvent = (info: TLKeyboardEventInfo) => void\n/** @public */\nexport type TLPinchEvent = (info: TLPinchEventInfo) => void\n/** @public */\nexport type TLWheelEvent = (info: TLWheelEventInfo) => void\n/** @public */\nexport type TLCancelEvent = (info: TLCancelEventInfo) => void\n/** @public */\nexport type TLCompleteEvent = (info: TLCompleteEventInfo) => void\n/** @public */\nexport type TLInterruptEvent = (info: TLInterruptEventInfo) => void\n\n/** @public */\nexport type UiEvent =\n\t| TLPointerEvent\n\t| TLClickEvent\n\t| TLKeyboardEvent\n\t| TLPinchEvent\n\t| TLCancelEvent\n\t| TLCompleteEvent\n\n/** @public */\nexport type UiEnterHandler = (info: any, from: string) => void\n/** @public */\nexport type UiExitHandler = (info: any, to: string) => void\n\n/** @public */\nexport interface TLEventHandlers {\n\tonPointerEnter: TLPointerEvent\n\tonPointerLeave: TLPointerEvent\n\tonPointerDown: TLPointerEvent\n\tonPointerMove: TLPointerEvent\n\tonRightClick: TLPointerEvent\n\tonDoubleClick: TLClickEvent\n\tonTripleClick: TLClickEvent\n\tonQuadrupleClick: TLClickEvent\n\tonMiddleClick: TLPointerEvent\n\tonPointerUp: TLPointerEvent\n\tonKeyDown: TLKeyboardEvent\n\tonKeyUp: TLKeyboardEvent\n\tonWheel: TLWheelEvent\n\tonCancel: TLCancelEvent\n\tonComplete: TLCompleteEvent\n\tonInterrupt: TLInterruptEvent\n\tonBlur: TLInterruptEvent\n}\n\n/** @public */\nexport const EVENT_NAME_MAP: Record<\n\tExclude<TLEventName, TLPinchEventName>,\n\tkeyof TLEventHandlers\n> = {\n\twheel: 'onWheel',\n\tpointer_enter: 'onPointerEnter',\n\tpointer_leave: 'onPointerLeave',\n\tpointer_down: 'onPointerDown',\n\tpointer_move: 'onPointerMove',\n\tpointer_up: 'onPointerUp',\n\tright_click: 'onRightClick',\n\tmiddle_click: 'onMiddleClick',\n\tblur: 'onBlur',\n\tkey_down: 'onKeyDown',\n\tkey_up: 'onKeyUp',\n\tcancel: 'onCancel',\n\tcomplete: 'onComplete',\n\tinterrupt: 'onInterrupt',\n\tdouble_click: 'onDoubleClick',\n\ttriple_click: 'onTripleClick',\n\tquadruple_click: 'onQuadrupleClick',\n}\n\n/** @public */\nexport type TLTickEvent = (elapsed: number) => void\n","import { TLStyleType } from '@tldraw/tlschema'\nimport { atom, Atom, computed, Computed } from 'signia'\nimport type { App } from '../App'\nimport {\n\tEVENT_NAME_MAP,\n\tTLEventHandlers,\n\tTLEventInfo,\n\tTLPinchEventInfo,\n\tUiEnterHandler,\n\tUiExitHandler,\n} from '../types/event-types'\n\ntype StateNodeType = 'branch' | 'leaf' | 'root'\n\n/** @public */\nexport interface StateNodeConstructor {\n\tnew (app: App, parent?: StateNode): StateNode\n\tid: string\n\tinitial?: string\n\tchildren?: () => StateNodeConstructor[]\n\tstyles?: TLStyleType[]\n}\n\n/** @public */\nexport abstract class StateNode implements Partial<TLEventHandlers> {\n\tconstructor(public app: App, parent?: StateNode) {\n\t\tconst { id, children, initial } = this.constructor as StateNodeConstructor\n\n\t\tthis.id = id\n\t\tthis.current = atom<StateNode | undefined>('toolState' + this.id, undefined)\n\n\t\tthis.path = computed('toolPath' + this.id, () => {\n\t\t\tconst current = this.current.value\n\t\t\treturn this.id + (current ? `.${current.path.value}` : '')\n\t\t})\n\n\t\tthis.parent = parent ?? ({} as any)\n\n\t\tif (this.parent) {\n\t\t\tif (children && initial) {\n\t\t\t\tthis.type = 'branch'\n\t\t\t\tthis.initial = initial\n\t\t\t\tthis.children = Object.fromEntries(\n\t\t\t\t\tchildren().map((Ctor) => [Ctor.id, new Ctor(this.app, this)])\n\t\t\t\t)\n\t\t\t\tthis.current.set(this.children[this.initial])\n\t\t\t} else {\n\t\t\t\tthis.type = 'leaf'\n\t\t\t}\n\t\t} else {\n\t\t\tthis.type = 'root'\n\n\t\t\tif (children && initial) {\n\t\t\t\tthis.initial = initial\n\t\t\t\tthis.children = Object.fromEntries(\n\t\t\t\t\tchildren().map((Ctor) => [Ctor.id, new Ctor(this.app, this)])\n\t\t\t\t)\n\t\t\t\tthis.current.set(this.children[this.initial])\n\t\t\t}\n\t\t}\n\t}\n\n\tpath: Computed<string>\n\n\tstatic id: string\n\tstatic initial?: string\n\tstatic children?: () => StateNodeConstructor[]\n\n\tid: string\n\tcurrent: Atom<StateNode | undefined>\n\ttype: StateNodeType\n\treadonly styles: TLStyleType[] = []\n\tinitial?: string\n\tchildren?: Record<string, StateNode>\n\tparent: StateNode\n\n\tisActive = false\n\n\ttransition(id: string, info: any) {\n\t\tconst path = id.split('.')\n\n\t\tlet currState = this as StateNode\n\n\t\tfor (let i = 0; i < path.length; i++) {\n\t\t\tconst id = path[i]\n\t\t\tconst prevChildState = currState.current.value\n\t\t\tconst nextChildState = currState.children?.[id]\n\n\t\t\tif (!nextChildState) {\n\t\t\t\tthrow Error(`${currState.id} - no child state exists with the id ${id}.`)\n\t\t\t}\n\n\t\t\tif (prevChildState?.id !== nextChildState.id) {\n\t\t\t\tprevChildState?.exit(info, id)\n\t\t\t\tcurrState.current.set(nextChildState)\n\t\t\t\tnextChildState.enter(info, prevChildState?.id || 'initial')\n\t\t\t\tif (!nextChildState.isActive) break\n\t\t\t}\n\n\t\t\tcurrState = nextChildState\n\t\t}\n\n\t\treturn this\n\t}\n\n\thandleEvent(info: Exclude<TLEventInfo, TLPinchEventInfo>) {\n\t\tconst cbName = EVENT_NAME_MAP[info.name]\n\t\tconst x = this.current.value\n\t\tthis[cbName]?.(info as any)\n\t\tif (this.current.value === x && this.isActive) {\n\t\t\tx?.handleEvent(info)\n\t\t}\n\t}\n\n\tenter(info: any, from: string) {\n\t\tthis.isActive = true\n\t\tthis.onEnter?.(info, from)\n\t\tif (this.children && this.initial && this.isActive) {\n\t\t\tconst initial = this.children[this.initial]\n\t\t\tthis.current.set(initial)\n\t\t\tinitial.enter(info, from)\n\t\t}\n\t}\n\n\texit(info: any, from: string) {\n\t\tthis.isActive = false\n\t\tthis.onExit?.(info, from)\n\t\tif (!this.isActive) {\n\t\t\tthis.current.value?.exit(info, from)\n\t\t}\n\t}\n\n\tonWheel?: TLEventHandlers['onWheel']\n\tonPointerEnter?: TLEventHandlers['onPointerEnter']\n\tonPointerLeave?: TLEventHandlers['onPointerLeave']\n\tonPointerDown?: TLEventHandlers['onPointerDown']\n\tonPointerMove?: TLEventHandlers['onPointerMove']\n\tonPointerUp?: TLEventHandlers['onPointerUp']\n\tonDoubleClick?: TLEventHandlers['onDoubleClick']\n\tonTripleClick?: TLEventHandlers['onTripleClick']\n\tonQuadrupleClick?: TLEventHandlers['onQuadrupleClick']\n\tonRightClick?: TLEventHandlers['onRightClick']\n\tonMiddleClick?: TLEventHandlers['onMiddleClick']\n\tonKeyDown?: TLEventHandlers['onKeyDown']\n\tonKeyUp?: TLEventHandlers['onKeyUp']\n\tonCancel?: TLEventHandlers['onCancel']\n\tonComplete?: TLEventHandlers['onComplete']\n\tonInterrupt?: TLEventHandlers['onInterrupt']\n\tonBlur?: TLEventHandlers['onBlur']\n\n\tonEnter?: UiEnterHandler\n\tonExit?: UiExitHandler\n}\n","import { TLEventHandlers } from '../../../types/event-types'\nimport { StateNode } from '../../StateNode'\n\nexport class Idle extends StateNode {\n\tstatic override id = 'idle'\n\n\tonPointerDown: TLEventHandlers['onPointerDown'] = (info) => {\n\t\tthis.parent.transition('pointing', info)\n\t}\n\n\tonEnter = () => {\n\t\tthis.app.setCursor({ type: 'cross' })\n\t}\n\n\tonCancel = () => {\n\t\tthis.app.setSelectedTool('select')\n\t}\n}\n","import { createShapeId, TLArrowShape, TLShapeType } from '@tldraw/tlschema'\nimport { TLArrowShapeDef } from '../../../shapeutils'\nimport { TLEventHandlers } from '../../../types/event-types'\nimport { StateNode } from '../../StateNode'\nimport { TLArrowTool } from '../TLArrowTool'\n\nexport class Pointing extends StateNode {\n\tstatic override id = 'pointing'\n\n\tshapeType = '' as TLShapeType\n\n\tshape?: TLArrowShape\n\n\tpreciseTimeout = -1\n\tdidTimeout = false\n\n\tprivate startPreciseTimeout() {\n\t\tthis.preciseTimeout = window.setTimeout(() => {\n\t\t\tif (!this.isActive) return\n\t\t\tif (!this.shape) return\n\t\t\tthis.didTimeout = true\n\t\t}, 300)\n\t}\n\n\tprivate clearPreciseTimeout() {\n\t\tclearTimeout(this.preciseTimeout)\n\t}\n\n\tonEnter = () => {\n\t\tconst {\n\t\t\tinputs: { currentPagePoint },\n\t\t} = this.app\n\n\t\tthis.didTimeout = false\n\n\t\tthis.shapeType = (this.parent as TLArrowTool).shapeType\n\n\t\tthis.app.mark('creating')\n\n\t\tconst id = createShapeId()\n\n\t\tthis.app.createShapes([\n\t\t\t{\n\t\t\t\tid,\n\t\t\t\ttype: this.shapeType,\n\t\t\t\tx: currentPagePoint.x,\n\t\t\t\ty: currentPagePoint.y,\n\t\t\t},\n\t\t])\n\n\t\tconst util = this.app.getShapeUtilByDef(TLArrowShapeDef)\n\t\tconst shape = this.app.getShapeById(id) as TLArrowShape\n\t\tif (!shape) return\n\n\t\tconst handles = util.handles?.(shape)\n\n\t\tif (handles) {\n\t\t\t// start precise\n\t\t\tconst point = this.app.getPointInShapeSpace(shape, currentPagePoint)\n\n\t\t\tconst change = util.onHandleChange?.(shape, {\n\t\t\t\thandle: { ...handles[0], x: point.x, y: point.y },\n\t\t\t\tisPrecise: true,\n\t\t\t})\n\n\t\t\tif (change) {\n\t\t\t\tconst startTerminal = change.props?.start\n\t\t\t\tif (startTerminal?.type === 'binding') {\n\t\t\t\t\tthis.app.setHintingIds([startTerminal.boundShapeId])\n\t\t\t\t}\n\t\t\t\tthis.app.updateShapes([change], true)\n\t\t\t}\n\t\t}\n\n\t\tthis.app.select(id)\n\n\t\tthis.shape = this.app.getShapeById(id)\n\n\t\tthis.startPreciseTimeout()\n\t}\n\n\tonExit = () => {\n\t\tthis.clearPreciseTimeout()\n\t}\n\n\tonPointerMove: TLEventHandlers['onPointerMove'] = () => {\n\t\tif (!this.shape) return\n\n\t\tif (this.app.inputs.isDragging) {\n\t\t\tconst util = this.app.getShapeUtil(this.shape)\n\t\t\tconst handles = util.handles?.(this.shape)\n\n\t\t\tif (!handles) {\n\t\t\t\tthis.app.bailToMark('creating')\n\t\t\t\tthrow Error('No handles found')\n\t\t\t}\n\n\t\t\tif (!this.didTimeout) {\n\t\t\t\tconst util = this.app.getShapeUtilByDef(TLArrowShapeDef)\n\t\t\t\tconst shape = this.app.getShapeById<TLArrowShape>(this.shape.id)\n\n\t\t\t\tif (!shape) return\n\n\t\t\t\tconst handles = util.handles(shape)\n\n\t\t\t\tif (handles) {\n\t\t\t\t\tconst { x, y } = this.app.getPointInShapeSpace(shape, this.app.inputs.originPagePoint)\n\t\t\t\t\tconst change = util.onHandleChange?.(shape, {\n\t\t\t\t\t\thandle: {\n\t\t\t\t\t\t\t...handles[0],\n\t\t\t\t\t\t\tx,\n\t\t\t\t\t\t\ty,\n\t\t\t\t\t\t},\n\t\t\t\t\t\tisPrecise: false,\n\t\t\t\t\t})\n\n\t\t\t\t\tif (change) {\n\t\t\t\t\t\tthis.app.updateShapes([change], true)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.app.setSelectedTool('select.dragging_handle', {\n\t\t\t\tshape: this.shape,\n\t\t\t\thandle: handles.find((h) => h.id === 'end')! /* end */,\n\t\t\t\tisCreating: true,\n\t\t\t\tonInteractionEnd: 'arrow',\n\t\t\t})\n\t\t}\n\t}\n\n\toverride onPointerUp: TLEventHandlers['onPointerUp'] = () => {\n\t\tthis.cancel()\n\t}\n\n\toverride onCancel: TLEventHandlers['onCancel'] = () => {\n\t\tthis.cancel()\n\t}\n\n\toverride onComplete: TLEventHandlers['onComplete'] = () => {\n\t\tthis.cancel()\n\t}\n\n\toverride onInterrupt: TLEventHandlers['onInterrupt'] = () => {\n\t\tthis.cancel()\n\t}\n\n\tcancel() {\n\t\tthis.app.bailToMark('creating')\n\t\tthis.app.setHintingIds([])\n\t\tthis.parent.transition('idle', {})\n\t}\n}\n","import { TLShapeType, TLStyleType } from '@tldraw/tlschema'\nimport { StateNode } from '../StateNode'\nimport { Idle } from './children/Idle'\nimport { Pointing } from './children/Pointing'\n\nexport class TLArrowTool extends StateNode {\n\tstatic override id = 'arrow'\n\tstatic initial = 'idle'\n\tstatic children = () => [Idle, Pointing]\n\n\tshapeType: TLShapeType = 'arrow'\n\n\tstyles = [\n\t\t'color',\n\t\t'opacity',\n\t\t'dash',\n\t\t'size',\n\t\t'arrowheadStart',\n\t\t'arrowheadEnd',\n\t\t'font',\n\t\t'fill',\n\t] as TLStyleType[]\n}\n","import { Matrix2d, snapAngle, Vec2d } from '@tldraw/primitives'\nimport {\n\tcreateShapeId,\n\tTLDrawShape,\n\tTLDrawShapeSegment,\n\tTLSizeType,\n\tVec2dModel,\n} from '@tldraw/tlschema'\nimport { last, structuredClone } from '@tldraw/utils'\nimport { DRAG_DISTANCE } from '../../../../constants'\nimport { uniqueId } from '../../../../utils'\nimport { TLDrawShapeDef } from '../../../shapeutils'\nimport { TLEventHandlers, TLPointerEventInfo } from '../../../types/event-types'\n\nimport { StateNode } from '../../StateNode'\n\nexport class Drawing extends StateNode {\n\tstatic override id = 'drawing'\n\n\tinfo = {} as TLPointerEventInfo\n\n\tinitialShape?: TLDrawShape\n\n\tutil = this.app.getShapeUtilByDef(TLDrawShapeDef)\n\n\tisPen = false\n\n\tsegmentMode = 'free' as 'free' | 'straight' | 'starting_straight' | 'starting_free'\n\n\tdidJustShiftClickToExtendPreviousShapeLine = false\n\n\tpagePointWhereCurrentSegmentChanged = {} as Vec2d\n\n\tpagePointWhereNextSegmentChanged = null as Vec2d | null\n\n\tlastRecordedPoint = {} as Vec2d\n\tmergeNextPoint = false\n\n\tcanDraw = false\n\n\tonEnter = (info: TLPointerEventInfo) => {\n\t\tthis.info = info\n\t\tthis.canDraw = !this.app.isMenuOpen\n\t\tthis.lastRecordedPoint = this.app.inputs.currentPagePoint.clone()\n\t\tif (this.canDraw) {\n\t\t\tthis.startShape()\n\t\t}\n\t}\n\n\tonPointerMove: TLEventHandlers['onPointerMove'] = () => {\n\t\tconst {\n\t\t\tapp: { inputs },\n\t\t} = this\n\n\t\tif (this.isPen !== inputs.isPen) {\n\t\t\t// The user made a palm gesture before starting a pen gesture;\n\t\t\t// ideally we'd start the new shape here but we could also just bail\n\t\t\t// as the next interaction will work correctly\n\t\t\tthis.cancel()\n\t\t}\n\n\t\t// If we came in from a menu but have no started dragging...\n\t\tif (!this.canDraw && inputs.isDragging) {\n\t\t\tthis.startShape()\n\t\t\tthis.canDraw = true // bad name\n\t\t}\n\n\t\tif (this.canDraw) {\n\t\t\t// Don't update the shape if we haven't moved far enough from the last time we recorded a point\n\t\t\tif (inputs.isPen) {\n\t\t\t\tif (Vec2d.Dist(inputs.currentPagePoint, this.lastRecordedPoint) >= 1 / this.app.camera.z) {\n\t\t\t\t\tthis.lastRecordedPoint = inputs.currentPagePoint.clone()\n\t\t\t\t\tthis.mergeNextPoint = false\n\t\t\t\t} else {\n\t\t\t\t\tthis.mergeNextPoint = true\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.mergeNextPoint = false\n\t\t\t}\n\n\t\t\tthis.updateShapes()\n\t\t}\n\t}\n\n\tonKeyDown: TLEventHandlers['onKeyDown'] = (info) => {\n\t\tif (info.key === 'Shift') {\n\t\t\tswitch (this.segmentMode) {\n\t\t\t\tcase 'free': {\n\t\t\t\t\t// We've just entered straight mode, go to straight mode\n\t\t\t\t\tthis.segmentMode = 'starting_straight'\n\t\t\t\t\tthis.pagePointWhereNextSegmentChanged = this.app.inputs.currentPagePoint.clone()\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t\tcase 'starting_free': {\n\t\t\t\t\tthis.segmentMode = 'starting_straight'\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis.updateShapes()\n\t}\n\n\tonKeyUp: TLEventHandlers['onKeyUp'] = (info) => {\n\t\tif (info.key === 'Shift') {\n\t\t\tthis.app.snaps.clear()\n\n\t\t\tswitch (this.segmentMode) {\n\t\t\t\tcase 'straight': {\n\t\t\t\t\t// We've just exited straight mode, go back to free mode\n\t\t\t\t\tthis.segmentMode = 'starting_free'\n\t\t\t\t\tthis.pagePointWhereNextSegmentChanged = this.app.inputs.currentPagePoint.clone()\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t\tcase 'starting_straight': {\n\t\t\t\t\tthis.pagePointWhereNextSegmentChanged = null\n\t\t\t\t\tthis.segmentMode = 'free'\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.updateShapes()\n\t}\n\n\tonExit? = () => {\n\t\tthis.app.snaps.clear()\n\t\tthis.pagePointWhereCurrentSegmentChanged = this.app.inputs.currentPagePoint.clone()\n\t}\n\n\tgetIsClosed(segments: TLDrawShapeSegment[], size: TLSizeType) {\n\t\tconst firstPoint = segments[0].points[0]\n\t\tconst lastSegment = segments[segments.length - 1]\n\t\tconst lastPoint = lastSegment.points[lastSegment.points.length - 1]\n\n\t\treturn (\n\t\t\t/*points.length > 3 &&*/ Vec2d.Dist(firstPoint, lastPoint) < this.app.getStrokeWidth(size) * 2\n\t\t)\n\t}\n\n\tprivate startShape() {\n\t\tconst {\n\t\t\tinputs: { originPagePoint, isPen },\n\t\t} = this.app\n\n\t\tthis.app.mark('draw create start')\n\n\t\tthis.isPen = isPen\n\n\t\tconst pressure = this.isPen ? this.info.point.z! * 1.25 : 0.5\n\n\t\tthis.segmentMode = this.app.inputs.shiftKey ? 'straight' : 'free'\n\n\t\tthis.didJustShiftClickToExtendPreviousShapeLine = false\n\n\t\tthis.lastRecordedPoint = originPagePoint.clone()\n\n\t\tif (this.initialShape) {\n\t\t\tconst shape = this.app.getShapeById(this.initialShape.id) as TLDrawShape\n\n\t\t\tif (shape && this.segmentMode === 'straight') {\n\t\t\t\t// Connect dots\n\n\t\t\t\tthis.didJustShiftClickToExtendPreviousShapeLine = true\n\n\t\t\t\tconst prevSegment = last(shape.props.segments)\n\t\t\t\tif (!prevSegment) throw Error('Expected a previous segment!')\n\t\t\t\tconst prevPoint = last(prevSegment.points)\n\t\t\t\tif (!prevPoint) throw Error('Expected a previous point!')\n\n\t\t\t\tconst { x, y } = this.app.getPointInShapeSpace(shape, originPagePoint).toFixed()\n\n\t\t\t\tconst pressure = this.isPen ? this.info.point.z! * 1.25 : 0.5\n\n\t\t\t\tconst newSegment: TLDrawShapeSegment = {\n\t\t\t\t\ttype: this.segmentMode,\n\t\t\t\t\tpoints: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tx: prevPoint.x,\n\t\t\t\t\t\t\ty: prevPoint.y,\n\t\t\t\t\t\t\tz: +pressure.toFixed(2),\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tx,\n\t\t\t\t\t\t\ty,\n\t\t\t\t\t\t\tz: +pressure.toFixed(2),\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t}\n\n\t\t\t\t// Convert prevPoint to page space\n\t\t\t\tconst prevPointPageSpace = Matrix2d.applyToPoint(\n\t\t\t\t\tthis.app.getPageTransformById(shape.id)!,\n\t\t\t\t\tprevPoint\n\t\t\t\t)\n\t\t\t\tthis.pagePointWhereCurrentSegmentChanged = prevPointPageSpace\n\t\t\t\tthis.pagePointWhereNextSegmentChanged = null\n\t\t\t\tconst segments = [...shape.props.segments, newSegment]\n\t\t\t\tthis.app.updateShapes([\n\t\t\t\t\t{\n\t\t\t\t\t\tid: shape.id,\n\t\t\t\t\t\ttype: 'draw',\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\tsegments,\n\t\t\t\t\t\t\tisClosed: this.getIsClosed(segments, shape.props.size),\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t])\n\n\t\t\t\treturn\n\t\t\t}\n\t\t}\n\n\t\t// Create a new shape\n\n\t\tthis.pagePointWhereCurrentSegmentChanged = originPagePoint.clone()\n\t\tconst id = createShapeId()\n\t\tthis.app.createShapes([\n\t\t\t{\n\t\t\t\tid,\n\t\t\t\ttype: 'draw',\n\t\t\t\tx: originPagePoint.x,\n\t\t\t\ty: originPagePoint.y,\n\t\t\t\tprops: {\n\t\t\t\t\tisPen: this.isPen,\n\t\t\t\t\tsegments: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttype: this.segmentMode,\n\t\t\t\t\t\t\tpoints: [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tx: 0,\n\t\t\t\t\t\t\t\t\ty: 0,\n\t\t\t\t\t\t\t\t\tz: +pressure.toFixed(2),\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t},\n\t\t])\n\n\t\tthis.initialShape = this.app.getShapeById<TLDrawShape>(id)\n\t}\n\n\tprivate updateShapes() {\n\t\tconst { inputs } = this.app\n\t\tconst { initialShape } = this\n\n\t\tif (!initialShape) return\n\n\t\tconst {\n\t\t\tid,\n\t\t\tprops: { size },\n\t\t} = initialShape\n\n\t\tconst shape = this.app.getShapeById<TLDrawShape>(id)!\n\n\t\tif (!shape) return\n\n\t\tconst { segments } = shape.props\n\n\t\tconst { x, y, z } = this.app.getPointInShapeSpace(shape, inputs.currentPagePoint).toFixed()\n\n\t\tconst newPoint = { x, y, z: this.isPen ? +(z! * 1.25).toFixed(2) : 0.5 }\n\n\t\tswitch (this.segmentMode) {\n\t\t\tcase 'starting_straight': {\n\t\t\t\tconst { pagePointWhereNextSegmentChanged } = this\n\n\t\t\t\tif (pagePointWhereNextSegmentChanged === null) {\n\t\t\t\t\tthrow Error('We should have a point where the segment changed')\n\t\t\t\t}\n\n\t\t\t\tconst hasMovedFarEnough =\n\t\t\t\t\tVec2d.Dist(pagePointWhereNextSegmentChanged, inputs.currentPagePoint) > DRAG_DISTANCE\n\n\t\t\t\t// Find the distance from where the pointer was when shift was released and\n\t\t\t\t// where it is now; if it's far enough away, then update the page point where\n\t\t\t\t// the current segment changed (to match the pagepoint where next segment changed)\n\t\t\t\t// and set the pagepoint where next segment changed to null.\n\t\t\t\tif (hasMovedFarEnough) {\n\t\t\t\t\tthis.pagePointWhereCurrentSegmentChanged = this.pagePointWhereNextSegmentChanged!.clone()\n\t\t\t\t\tthis.pagePointWhereNextSegmentChanged = null\n\n\t\t\t\t\t// Set the new mode\n\t\t\t\t\tthis.segmentMode = 'straight'\n\n\t\t\t\t\tconst prevSegment = last(segments)\n\t\t\t\t\tif (!prevSegment) throw Error('Expected a previous segment!')\n\n\t\t\t\t\tconst prevLastPoint = last(prevSegment.points)\n\t\t\t\t\tif (!prevLastPoint) throw Error('Expected a previous last point!')\n\n\t\t\t\t\tlet newSegment: TLDrawShapeSegment\n\n\t\t\t\t\tif (prevSegment.type === 'straight') {\n\t\t\t\t\t\tnewSegment = {\n\t\t\t\t\t\t\ttype: 'straight',\n\t\t\t\t\t\t\tpoints: [\n\t\t\t\t\t\t\t\t{ ...prevLastPoint },\n\t\t\t\t\t\t\t\tthis.app\n\t\t\t\t\t\t\t\t\t.getPointInShapeSpace(shape, this.pagePointWhereCurrentSegmentChanged)\n\t\t\t\t\t\t\t\t\t.toFixed()\n\t\t\t\t\t\t\t\t\t.toJson(),\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst transform = this.app.getPageTransform(shape)!\n\t\t\t\t\t\tthis.pagePointWhereCurrentSegmentChanged = Matrix2d.applyToPoint(\n\t\t\t\t\t\t\ttransform,\n\t\t\t\t\t\t\tprevLastPoint\n\t\t\t\t\t\t)\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnewSegment = {\n\t\t\t\t\t\t\ttype: 'straight',\n\t\t\t\t\t\t\tpoints: [\n\t\t\t\t\t\t\t\tthis.app\n\t\t\t\t\t\t\t\t\t.getPointInShapeSpace(shape, this.pagePointWhereCurrentSegmentChanged)\n\t\t\t\t\t\t\t\t\t.toFixed()\n\t\t\t\t\t\t\t\t\t.toJson(),\n\t\t\t\t\t\t\t\tnewPoint,\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.app.updateShapes(\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tid,\n\t\t\t\t\t\t\t\ttype: 'draw',\n\t\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\t\tsegments: [...segments, newSegment],\n\t\t\t\t\t\t\t\t\tisClosed: this.getIsClosed(segments, size),\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t],\n\t\t\t\t\t\ttrue\n\t\t\t\t\t)\n\t\t\t\t}\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tcase 'starting_free': {\n\t\t\t\tconst { pagePointWhereNextSegmentChanged } = this\n\n\t\t\t\tif (pagePointWhereNextSegmentChanged === null) {\n\t\t\t\t\tthrow Error('We should have a point where the segment changed')\n\t\t\t\t}\n\n\t\t\t\tconst hasMovedFarEnough =\n\t\t\t\t\tVec2d.Dist(pagePointWhereNextSegmentChanged, inputs.currentPagePoint) > DRAG_DISTANCE\n\n\t\t\t\t// Find the distance from where the pointer was when shift was released and\n\t\t\t\t// where it is now; if it's far enough away, then update the page point where\n\t\t\t\t// the current segment changed (to match the pagepoint where next segment changed)\n\t\t\t\t// and set the pagepoint where next segment changed to null.\n\t\t\t\tif (hasMovedFarEnough) {\n\t\t\t\t\tthis.pagePointWhereCurrentSegmentChanged = this.pagePointWhereNextSegmentChanged!.clone()\n\t\t\t\t\tthis.pagePointWhereNextSegmentChanged = null\n\n\t\t\t\t\t// Set the new mode\n\t\t\t\t\tthis.segmentMode = 'free'\n\n\t\t\t\t\tconst newSegments = segments.slice()\n\t\t\t\t\tconst prevStraightSegment = newSegments[newSegments.length - 1]\n\t\t\t\t\tconst prevPoint = last(prevStraightSegment.points)\n\n\t\t\t\t\tif (!prevPoint) {\n\t\t\t\t\t\tthrow Error('No previous point!')\n\t\t\t\t\t}\n\n\t\t\t\t\t// Create the new free segment and interpolate the points between where the last line\n\t\t\t\t\t// ended and where the pointer is now\n\t\t\t\t\tconst newFreeSegment: TLDrawShapeSegment = {\n\t\t\t\t\t\ttype: 'free',\n\t\t\t\t\t\tpoints: [\n\t\t\t\t\t\t\t...Vec2d.PointsBetween(prevPoint, newPoint, 6).map((p) => p.toFixed().toJson()),\n\t\t\t\t\t\t],\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.app.updateShapes(\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tid,\n\t\t\t\t\t\t\t\ttype: 'draw',\n\t\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\t\tsegments: [...newSegments, newFreeSegment],\n\t\t\t\t\t\t\t\t\tisClosed: this.getIsClosed(segments, size),\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t],\n\t\t\t\t\t\ttrue\n\t\t\t\t\t)\n\t\t\t\t}\n\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tcase 'straight': {\n\t\t\t\tconst newSegments = segments.slice()\n\t\t\t\tconst newSegment = newSegments[newSegments.length - 1]\n\n\t\t\t\tconst { pagePointWhereCurrentSegmentChanged } = this\n\t\t\t\tconst { currentPagePoint, ctrlKey } = this.app.inputs\n\n\t\t\t\tif (!pagePointWhereCurrentSegmentChanged)\n\t\t\t\t\tthrow Error('We should have a point where the segment changed')\n\n\t\t\t\tlet pagePoint: Vec2dModel\n\t\t\t\tlet shouldSnapToAngle = false\n\n\t\t\t\tif (this.didJustShiftClickToExtendPreviousShapeLine) {\n\t\t\t\t\tif (this.app.inputs.isDragging) {\n\t\t\t\t\t\t// If we've just shift clicked to extend a line, only snap once we've started dragging\n\t\t\t\t\t\tshouldSnapToAngle = !ctrlKey\n\t\t\t\t\t\tthis.didJustShiftClickToExtendPreviousShapeLine = false\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// noop\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// If we're not shift clicking to extend a line, but we're holding shift, then we should snap\n\t\t\t\t\tshouldSnapToAngle = !ctrlKey // don't snap angle while snapping line\n\t\t\t\t}\n\n\t\t\t\tlet newPoint = this.app.getPointInShapeSpace(shape, currentPagePoint).toFixed().toJson()\n\t\t\t\tlet didSnap = false\n\t\t\t\tlet snapSegment: TLDrawShapeSegment | undefined = undefined\n\n\t\t\t\tconst shouldSnap = this.app.userDocumentSettings.isSnapMode ? !ctrlKey : ctrlKey\n\n\t\t\t\tif (shouldSnap) {\n\t\t\t\t\tif (newSegments.length > 2) {\n\t\t\t\t\t\tlet nearestPoint: Vec2dModel | undefined = undefined\n\t\t\t\t\t\tlet minDistance = 8 / this.app.camera.z\n\n\t\t\t\t\t\t// Don't try to snap to the last two segments\n\t\t\t\t\t\tfor (let i = 0, n = segments.length - 2; i < n; i++) {\n\t\t\t\t\t\t\tconst segment = segments[i]\n\t\t\t\t\t\t\tif (!segment) break\n\t\t\t\t\t\t\tif (segment.type === 'free') continue\n\n\t\t\t\t\t\t\tconst first = segment.points[0]\n\t\t\t\t\t\t\tconst lastPoint = last(segment.points)\n\t\t\t\t\t\t\tif (!(first && lastPoint)) continue\n\n\t\t\t\t\t\t\t// Snap to the nearest point on the segment, if it's closer than the previous snapped point\n\t\t\t\t\t\t\tconst nearestPointOnSegment = Vec2d.NearestPointOnLineSegment(\n\t\t\t\t\t\t\t\tfirst,\n\t\t\t\t\t\t\t\tlastPoint,\n\t\t\t\t\t\t\t\tnewPoint\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\tconst distance = Vec2d.Dist(nearestPointOnSegment, newPoint)\n\n\t\t\t\t\t\t\tif (distance < minDistance) {\n\t\t\t\t\t\t\t\tnearestPoint = nearestPointOnSegment.toFixed().toJson()\n\t\t\t\t\t\t\t\tminDistance = distance\n\t\t\t\t\t\t\t\tsnapSegment = segment\n\t\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (nearestPoint) {\n\t\t\t\t\t\t\tdidSnap = true\n\t\t\t\t\t\t\tnewPoint = nearestPoint\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (didSnap && snapSegment) {\n\t\t\t\t\tconst transform = this.app.getPageTransform(shape)!\n\t\t\t\t\tconst first = snapSegment.points[0]\n\t\t\t\t\tconst lastPoint = last(snapSegment.points)\n\t\t\t\t\tif (!lastPoint) throw Error('Expected a last point!')\n\n\t\t\t\t\tconst A = Matrix2d.applyToPoint(transform, first)\n\n\t\t\t\t\tconst B = Matrix2d.applyToPoint(transform, lastPoint)\n\n\t\t\t\t\tconst snappedPoint = Matrix2d.applyToPoint(transform, newPoint)\n\n\t\t\t\t\tthis.app.snaps.setLines([\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: uniqueId(),\n\t\t\t\t\t\t\ttype: 'points',\n\t\t\t\t\t\t\tpoints: [A, snappedPoint, B],\n\t\t\t\t\t\t},\n\t\t\t\t\t])\n\t\t\t\t} else {\n\t\t\t\t\tthis.app.snaps.clear()\n\n\t\t\t\t\tif (shouldSnapToAngle) {\n\t\t\t\t\t\t// Snap line angle to nearest 15 degrees\n\t\t\t\t\t\tconst currentAngle = Vec2d.Angle(pagePointWhereCurrentSegmentChanged, currentPagePoint)\n\t\t\t\t\t\tconst snappedAngle = snapAngle(currentAngle, 24)\n\t\t\t\t\t\tconst angleDiff = snappedAngle - currentAngle\n\n\t\t\t\t\t\tpagePoint = Vec2d.RotWith(\n\t\t\t\t\t\t\tcurrentPagePoint,\n\t\t\t\t\t\t\tpagePointWhereCurrentSegmentChanged,\n\t\t\t\t\t\t\tangleDiff\n\t\t\t\t\t\t)\n\t\t\t\t\t} else {\n\t\t\t\t\t\tpagePoint = currentPagePoint\n\t\t\t\t\t}\n\n\t\t\t\t\tnewPoint = this.app.getPointInShapeSpace(shape, pagePoint).toFixed().toJson()\n\t\t\t\t}\n\n\t\t\t\t// If the previous segment is a one point free shape and is the first segment of the line,\n\t\t\t\t// then the user just did a click-and-immediately-press-shift to create a new straight line\n\t\t\t\t// without continuing the previous line. In this case, we want to remove the previous segment.\n\n\t\t\t\tnewSegments[newSegments.length - 1] = {\n\t\t\t\t\t...newSegment,\n\t\t\t\t\ttype: 'straight',\n\t\t\t\t\tpoints: [newSegment.points[0], newPoint],\n\t\t\t\t}\n\n\t\t\t\tthis.app.updateShapes(\n\t\t\t\t\t[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid,\n\t\t\t\t\t\t\ttype: 'draw',\n\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\tsegments: newSegments,\n\t\t\t\t\t\t\t\tisClosed: this.getIsClosed(segments, size),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t\ttrue\n\t\t\t\t)\n\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tcase 'free': {\n\t\t\t\tconst newSegments = segments.slice()\n\t\t\t\tconst newSegment = newSegments[newSegments.length - 1]\n\t\t\t\tconst newPoints = [...newSegment.points]\n\n\t\t\t\tif (newPoints.length && this.mergeNextPoint) {\n\t\t\t\t\tconst { z } = newPoints[newPoints.length - 1]\n\t\t\t\t\tnewPoints[newPoints.length - 1] = {\n\t\t\t\t\t\tx: newPoint.x,\n\t\t\t\t\t\ty: newPoint.y,\n\t\t\t\t\t\tz: z ? Math.max(z, newPoint.z) : newPoint.z,\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tnewPoints.push(newPoint)\n\t\t\t\t}\n\n\t\t\t\tnewSegments[newSegments.length - 1] = {\n\t\t\t\t\t...newSegment,\n\t\t\t\t\tpoints: newPoints,\n\t\t\t\t}\n\n\t\t\t\tthis.app.updateShapes(\n\t\t\t\t\t[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid,\n\t\t\t\t\t\t\ttype: 'draw',\n\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\tsegments: newSegments,\n\t\t\t\t\t\t\t\tisClosed: this.getIsClosed(segments, size),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t\ttrue\n\t\t\t\t)\n\n\t\t\t\t// Set a maximum length for the lines array; after 200 points, complete the line.\n\t\t\t\tif (newPoints.length > 500) {\n\t\t\t\t\tthis.app.updateShapes([{ id, type: 'draw', props: { isComplete: true } }])\n\n\t\t\t\t\tconst { currentPagePoint } = this.app.inputs\n\n\t\t\t\t\tconst newShapeId = this.app.createShapeId()\n\n\t\t\t\t\tthis.app.createShapes([\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: newShapeId,\n\t\t\t\t\t\t\ttype: 'draw',\n\t\t\t\t\t\t\tx: currentPagePoint.x,\n\t\t\t\t\t\t\ty: currentPagePoint.y,\n\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\tisPen: this.isPen,\n\t\t\t\t\t\t\t\tsegments: [\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\ttype: 'free',\n\t\t\t\t\t\t\t\t\t\tpoints: [{ x: 0, y: 0, z: this.isPen ? +(z! * 1.25).toFixed() : 0.5 }],\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t])\n\n\t\t\t\t\tthis.initialShape = structuredClone(this.app.getShapeById<TLDrawShape>(newShapeId)!)\n\t\t\t\t\tthis.mergeNextPoint = false\n\t\t\t\t\tthis.lastRecordedPoint = this.app.inputs.currentPagePoint.clone()\n\t\t\t\t}\n\n\t\t\t\tbreak\n\t\t\t}\n\t\t}\n\t}\n\n\toverride onPointerUp: TLEventHandlers['onPointerUp'] = () => {\n\t\tthis.complete()\n\t}\n\n\toverride onCancel: TLEventHandlers['onCancel'] = () => {\n\t\tthis.cancel()\n\t}\n\n\toverride onComplete: TLEventHandlers['onComplete'] = () => {\n\t\tthis.complete()\n\t}\n\n\toverride onInterrupt: TLEventHandlers['onInterrupt'] = () => {\n\t\tif (this.app.inputs.isDragging) {\n\t\t\treturn\n\t\t}\n\n\t\tthis.app.bail()\n\t\tthis.cancel()\n\t}\n\n\tcomplete() {\n\t\t// If we weren't focused when the drawing shape started, and if\n\t\t// we haven't dragged far enough to start dragging, then don't do\n\t\t// anything here. Most likely we clicked back into the canvas from\n\t\t// a menu or other UI element.\n\t\tif (!this.canDraw) {\n\t\t\tthis.cancel()\n\t\t\treturn\n\t\t}\n\n\t\tconst { initialShape } = this\n\t\tif (!initialShape) return\n\t\tthis.app.updateShapes([\n\t\t\t{ id: initialShape.id, type: initialShape.type, props: { isComplete: true } },\n\t\t])\n\n\t\tthis.parent.transition('idle', {})\n\t}\n\n\tcancel() {\n\t\tthis.parent.transition('idle', this.info)\n\t}\n}\n","import { TLEventHandlers } from '../../../types/event-types'\nimport { StateNode } from '../../StateNode'\n\nexport class Idle extends StateNode {\n\tstatic override id = 'idle'\n\n\tonPointerDown: TLEventHandlers['onPointerDown'] = (info) => {\n\t\tthis.parent.transition('drawing', info)\n\t}\n\n\tonEnter = () => {\n\t\tthis.app.setCursor({ type: 'cross' })\n\t}\n\n\tonCancel = () => {\n\t\tthis.app.setSelectedTool('select')\n\t}\n}\n","import { TLStyleType } from '@tldraw/tlschema'\nimport { StateNode } from '../StateNode'\n\nimport { Drawing } from './children/Drawing'\nimport { Idle } from './children/Idle'\n\nexport class TLDrawTool extends StateNode {\n\tstatic override id = 'draw'\n\tstatic initial = 'idle'\n\tstatic children = () => [Idle, Drawing]\n\n\tstyles = ['color', 'opacity', 'dash', 'fill', 'size'] as TLStyleType[]\n\n\tonExit = () => {\n\t\tconst drawingState = this.children!['drawing'] as Drawing\n\t\tdrawingState.initialShape = undefined\n\t}\n}\n","import { pointInPolygon } from '@tldraw/primitives'\nimport { TLScribble, TLShapeId } from '@tldraw/tlschema'\nimport { ScribbleManager } from '../../../managers/ScribbleManager'\nimport { TLEventHandlers, TLPointerEventInfo } from '../../../types/event-types'\nimport { StateNode } from '../../StateNode'\n\nexport class Erasing extends StateNode {\n\tstatic override id = 'erasing'\n\n\tprivate info = {} as TLPointerEventInfo\n\tprivate scribble = {} as ScribbleManager\n\tprivate markId = ''\n\tprivate excludedShapeIds = new Set<TLShapeId>()\n\n\toverride onEnter = (info: TLPointerEventInfo) => {\n\t\tthis.markId = this.app.mark('erase scribble begin')\n\t\tthis.info = info\n\n\t\tconst { originPagePoint } = this.app.inputs\n\t\tthis.excludedShapeIds = new Set(\n\t\t\tthis.app.shapesArray\n\t\t\t\t.filter(\n\t\t\t\t\t(shape) =>\n\t\t\t\t\t\t(shape.type === 'frame' || shape.type === 'group') &&\n\t\t\t\t\t\tthis.app.isPointInShape(originPagePoint, shape)\n\t\t\t\t)\n\t\t\t\t.map((shape) => shape.id)\n\t\t)\n\n\t\tthis.startScribble()\n\t\tthis.update()\n\t}\n\n\tprivate startScribble = () => {\n\t\tthis.scribble = new ScribbleManager({\n\t\t\tonUpdate: this.onScribbleUpdate,\n\t\t\tonComplete: this.onScribbleComplete,\n\t\t\tcolor: 'muted-1',\n\t\t\tsize: 12,\n\t\t})\n\n\t\tthis.app.on('tick', this.scribble.tick)\n\t}\n\n\tprivate pushPointToScribble = () => {\n\t\tconst { x, y } = this.app.inputs.currentPagePoint\n\t\tthis.scribble.addPoint(x, y)\n\t}\n\n\tprivate onScribbleUpdate = (scribble: TLScribble) => {\n\t\tthis.app.setScribble(scribble)\n\t}\n\n\tprivate onScribbleComplete = () => {\n\t\tthis.app.off('tick', this.scribble.tick)\n\t\tthis.app.setScribble(null)\n\t}\n\n\toverride onExit = () => {\n\t\tthis.scribble.stop()\n\t}\n\n\toverride onPointerMove = () => {\n\t\tthis.update()\n\t}\n\n\toverride onPointerUp: TLEventHandlers['onPointerUp'] = () => {\n\t\tthis.complete()\n\t}\n\n\toverride onCancel: TLEventHandlers['onCancel'] = () => {\n\t\tthis.cancel()\n\t}\n\n\toverride onComplete: TLEventHandlers['onComplete'] = () => {\n\t\tthis.complete()\n\t}\n\n\tupdate() {\n\t\tconst {\n\t\t\tshapesArray,\n\t\t\terasingIdsSet,\n\t\t\tinputs: { currentPagePoint, previousPagePoint },\n\t\t} = this.app\n\n\t\tconst { excludedShapeIds } = this\n\n\t\tthis.pushPointToScribble()\n\n\t\tconst erasing = new Set<TLShapeId>(erasingIdsSet)\n\n\t\tfor (const shape of shapesArray) {\n\t\t\t// Skip groups\n\t\t\tif (shape.type === 'group') continue\n\n\t\t\t// Avoid testing masked shapes, unless the pointer is inside the mask\n\t\t\tconst pageMask = this.app.getPageMaskById(shape.id)\n\t\t\tif (pageMask && !pointInPolygon(currentPagePoint, pageMask)) {\n\t\t\t\tcontinue\n\t\t\t}\n\n\t\t\t// Hit test the shape using a line segment\n\t\t\tconst util = this.app.getShapeUtil(shape)\n\t\t\tconst A = this.app.getPointInShapeSpace(shape, previousPagePoint)\n\t\t\tconst B = this.app.getPointInShapeSpace(shape, currentPagePoint)\n\n\t\t\t// If it's a hit, erase the outermost selectable shape\n\t\t\tif (util.hitTestLineSegment(shape, A, B)) {\n\t\t\t\terasing.add(this.app.getOutermostSelectableShape(shape).id)\n\t\t\t}\n\t\t}\n\n\t\t// Remove the hit shapes, except if they're in the list of excluded shapes\n\t\t// (these excluded shapes will be any frames or groups the pointer was inside of\n\t\t// when the user started erasing)\n\t\tthis.app.setErasingIds([...erasing].filter((id) => !excludedShapeIds.has(id)))\n\t}\n\n\tcomplete() {\n\t\tthis.app.deleteShapes(this.app.pageState.erasingIds)\n\t\tthis.app.setErasingIds([])\n\t\tthis.parent.transition('idle', {})\n\t}\n\n\tcancel() {\n\t\tthis.app.setErasingIds([])\n\t\tthis.app.bailToMark(this.markId)\n\t\tthis.parent.transition('idle', this.info)\n\t}\n}\n","import { TLEventHandlers } from '../../../types/event-types'\nimport { StateNode } from '../../StateNode'\n\nexport class Idle extends StateNode {\n\tstatic override id = 'idle'\n\n\tonPointerDown: TLEventHandlers['onPointerDown'] = (info) => {\n\t\tthis.parent.transition('pointing', info)\n\t}\n}\n","import { TLShapeId } from '@tldraw/tlschema'\nimport { TLEventHandlers } from '../../../types/event-types'\nimport { StateNode } from '../../StateNode'\n\nexport class Pointing extends StateNode {\n\tstatic override id = 'pointing'\n\n\tonEnter = () => {\n\t\tconst { inputs } = this.app\n\n\t\tconst erasing = new Set<TLShapeId>()\n\n\t\tconst initialSize = erasing.size\n\n\t\tfor (const shape of [...this.app.sortedShapesArray].reverse()) {\n\t\t\tif (this.app.isPointInShape(inputs.currentPagePoint, shape)) {\n\t\t\t\t// Skip groups\n\t\t\t\tif (shape.type === 'group') continue\n\n\t\t\t\tconst hitShape = this.app.getOutermostSelectableShape(shape)\n\n\t\t\t\t// If we've hit a frame after hitting any other shape, stop here\n\t\t\t\tif (hitShape.type === 'frame' && erasing.size > initialSize) break\n\n\t\t\t\terasing.add(hitShape.id)\n\t\t\t}\n\t\t}\n\n\t\tthis.app.setErasingIds([...erasing])\n\t}\n\n\tonPointerMove: TLEventHandlers['onPointerMove'] = (info) => {\n\t\tif (this.app.inputs.isDragging) {\n\t\t\tthis.parent.transition('erasing', info)\n\t\t}\n\t}\n\n\toverride onPointerUp: TLEventHandlers['onPointerUp'] = () => {\n\t\tthis.complete()\n\t}\n\n\toverride onCancel: TLEventHandlers['onCancel'] = () => {\n\t\tthis.cancel()\n\t}\n\n\toverride onComplete: TLEventHandlers['onComplete'] = () => {\n\t\tthis.complete()\n\t}\n\n\toverride onInterrupt: TLEventHandlers['onInterrupt'] = () => {\n\t\tthis.cancel()\n\t}\n\n\tcomplete() {\n\t\tconst { erasingIds } = this.app\n\n\t\tif (erasingIds.length) {\n\t\t\tthis.app.mark('erase end')\n\t\t\tthis.app.deleteShapes(erasingIds)\n\t\t}\n\n\t\tthis.app.setErasingIds([])\n\t\tthis.parent.transition('idle', {})\n\t}\n\n\tcancel() {\n\t\tthis.app.setErasingIds([])\n\t\tthis.parent.transition('idle', {})\n\t}\n}\n","import { StateNode } from '../StateNode'\n\nimport { Erasing } from './children/Erasing'\nimport { Idle } from './children/Idle'\nimport { Pointing } from './children/Pointing'\n\nexport class TLEraserTool extends StateNode {\n\tstatic override id = 'eraser'\n\tstatic initial = 'idle'\n\tstatic children = () => [Idle, Pointing, Erasing]\n\n\tonEnter = () => {\n\t\tthis.app.setCursor({ type: 'cross' })\n\t}\n}\n","import { TLEventHandlers } from '../../../types/event-types'\nimport { StateNode } from '../../StateNode'\n\nexport class Idle extends StateNode {\n\tstatic override id = 'idle'\n\n\tonPointerDown: TLEventHandlers['onPointerDown'] = (info) => {\n\t\tthis.parent.transition('pointing', info)\n\t}\n\n\tonEnter = () => {\n\t\tthis.app.setCursor({ type: 'cross' })\n\t}\n\n\tonCancel = () => {\n\t\tthis.app.setSelectedTool('select')\n\t}\n}\n","import { Vec2d } from '@tldraw/primitives'\nimport { createShapeId } from '@tldraw/tlschema'\nimport { TLEventHandlers } from '../../../types/event-types'\nimport { StateNode } from '../../StateNode'\nimport { TLBoxLike, TLBoxTool } from '../TLBoxTool'\n\nexport class Pointing extends StateNode {\n\tstatic override id = 'pointing'\n\n\tmarkId = 'creating'\n\n\twasFocusedOnEnter = false\n\n\tonEnter = () => {\n\t\tconst { isMenuOpen } = this.app\n\t\tthis.wasFocusedOnEnter = !isMenuOpen\n\t}\n\n\tonPointerMove: TLEventHandlers['onPointerMove'] = (info) => {\n\t\tif (this.app.inputs.isDragging) {\n\t\t\tconst { originPagePoint } = this.app.inputs\n\n\t\t\tconst shapeType = (this.parent as TLBoxTool)!.shapeType as TLBoxLike['type']\n\n\t\t\tconst id = createShapeId()\n\n\t\t\tthis.app.mark(this.markId)\n\n\t\t\tthis.app.createShapes([\n\t\t\t\t{\n\t\t\t\t\tid,\n\t\t\t\t\ttype: shapeType,\n\t\t\t\t\tx: originPagePoint.x,\n\t\t\t\t\ty: originPagePoint.y,\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tw: 1,\n\t\t\t\t\t\th: 1,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t])\n\n\t\t\tthis.app.setSelectedIds([id])\n\t\t\tthis.app.setSelectedTool('select.resizing', {\n\t\t\t\t...info,\n\t\t\t\ttarget: 'selection',\n\t\t\t\thandle: 'bottom_right',\n\t\t\t\tisCreating: true,\n\t\t\t\tcreationCursorOffset: { x: 1, y: 1 },\n\t\t\t\tonInteractionEnd: this.parent.id,\n\t\t\t})\n\t\t}\n\t}\n\n\toverride onPointerUp: TLEventHandlers['onPointerUp'] = () => {\n\t\tthis.complete()\n\t}\n\n\toverride onCancel: TLEventHandlers['onCancel'] = () => {\n\t\tthis.cancel()\n\t}\n\n\toverride onComplete: TLEventHandlers['onComplete'] = () => {\n\t\tthis.complete()\n\t}\n\n\toverride onInterrupt: TLEventHandlers['onInterrupt'] = () => {\n\t\tthis.cancel()\n\t}\n\n\tcomplete() {\n\t\tconst { originPagePoint } = this.app.inputs\n\n\t\tif (!this.wasFocusedOnEnter) {\n\t\t\treturn\n\t\t}\n\n\t\tthis.app.mark(this.markId)\n\n\t\tconst shapeType = (this.parent as TLBoxTool)!.shapeType as TLBoxLike['type']\n\n\t\tconst id = createShapeId()\n\n\t\tthis.app.mark(this.markId)\n\n\t\tthis.app.createShapes([\n\t\t\t{\n\t\t\t\tid,\n\t\t\t\ttype: shapeType,\n\t\t\t\tx: originPagePoint.x,\n\t\t\t\ty: originPagePoint.y,\n\t\t\t},\n\t\t])\n\n\t\tconst shape = this.app.getShapeById<TLBoxLike>(id)!\n\t\tconst { w, h } = this.app.getShapeUtil<TLBoxLike>(shape).defaultProps()\n\t\tconst delta = this.app.getDeltaInParentSpace(shape, new Vec2d(w / 2, h / 2))\n\n\t\tthis.app.updateShapes([\n\t\t\t{\n\t\t\t\tid,\n\t\t\t\ttype: shapeType,\n\t\t\t\tx: shape.x - delta.x,\n\t\t\t\ty: shape.y - delta.y,\n\t\t\t},\n\t\t])\n\n\t\tthis.app.setSelectedIds([id])\n\n\t\tif (this.app.instanceState.isToolLocked) {\n\t\t\tthis.parent.transition('idle', {})\n\t\t} else {\n\t\t\tthis.app.setSelectedTool('select.idle')\n\t\t}\n\t}\n\n\tcancel() {\n\t\tthis.parent.transition('idle', {})\n\t}\n}\n","import { StateNode } from '../StateNode'\n\nimport { TLBaseShape, TLStyleType } from '@tldraw/tlschema'\nimport { Idle } from './children/Idle'\nimport { Pointing } from './children/Pointing'\n\n/** @public */\nexport type TLBoxLike = TLBaseShape<string, { w: number; h: number }>\n\n/** @public */\nexport abstract class TLBoxTool extends StateNode {\n\tstatic override id = 'box'\n\tstatic initial = 'idle'\n\tstatic children = () => [Idle, Pointing]\n\n\tabstract shapeType: string\n\n\tstyles = ['opacity'] as TLStyleType[]\n}\n","import { TLStyleType } from '@tldraw/tlschema'\nimport { TLBoxTool } from '../TLBoxTool'\n\nexport class TLFrameTool extends TLBoxTool {\n\tstatic override id = 'frame'\n\tstatic initial = 'idle'\n\n\tshapeType = 'frame'\n\n\tstyles = ['opacity'] as TLStyleType[]\n}\n","import { TLEventHandlers } from '../../../types/event-types'\nimport { StateNode } from '../../StateNode'\n\nexport class Idle extends StateNode {\n\tstatic override id = 'idle'\n\n\tonPointerDown: TLEventHandlers['onPointerDown'] = (info) => {\n\t\tthis.parent.transition('pointing', info)\n\t}\n\n\tonEnter = () => {\n\t\tthis.app.setCursor({ type: 'cross' })\n\t}\n\n\tonKeyUp: TLEventHandlers['onKeyUp'] = (info) => {\n\t\tif (info.key === 'Enter') {\n\t\t\tconst shape = this.app.onlySelectedShape\n\t\t\tif (shape && shape.type === 'geo') {\n\t\t\t\t// todo: ensure that this only works with the most recently created shape, not just any geo shape that happens to be selected at the time\n\t\t\t\tthis.app.mark('editing shape')\n\t\t\t\tthis.app.setEditingId(shape.id)\n\t\t\t\tthis.app.setSelectedTool('select.editing_shape', {\n\t\t\t\t\t...info,\n\t\t\t\t\ttarget: 'shape',\n\t\t\t\t\tshape,\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\t}\n\n\tonCancel = () => {\n\t\tthis.app.setSelectedTool('select')\n\t}\n}\n","import { Box2d, getStarBounds } from '@tldraw/primitives'\nimport { TLGeoShape, createShapeId } from '@tldraw/tlschema'\nimport { TLEventHandlers } from '../../../types/event-types'\nimport { StateNode } from '../../StateNode'\n\nexport class Pointing extends StateNode {\n\tstatic override id = 'pointing'\n\n\tonPointerMove: TLEventHandlers['onPointerMove'] = (info) => {\n\t\tif (this.app.inputs.isDragging) {\n\t\t\tconst { originPagePoint } = this.app.inputs\n\n\t\t\tconst id = createShapeId()\n\n\t\t\tthis.app.mark('creating')\n\n\t\t\tthis.app.createShapes([\n\t\t\t\t{\n\t\t\t\t\tid,\n\t\t\t\t\ttype: 'geo',\n\t\t\t\t\tx: originPagePoint.x,\n\t\t\t\t\ty: originPagePoint.y,\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tw: 1,\n\t\t\t\t\t\th: 1,\n\t\t\t\t\t\tgeo: this.app.instanceState.propsForNextShape.geo,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t])\n\n\t\t\tthis.app.select(id)\n\t\t\tthis.app.setSelectedTool('select.resizing', {\n\t\t\t\t...info,\n\t\t\t\ttarget: 'selection',\n\t\t\t\thandle: 'bottom_right',\n\t\t\t\tisCreating: true,\n\t\t\t\tcreationCursorOffset: { x: 1, y: 1 },\n\t\t\t\tonInteractionEnd: 'geo',\n\t\t\t})\n\t\t}\n\t}\n\n\toverride onPointerUp: TLEventHandlers['onPointerUp'] = () => {\n\t\tthis.complete()\n\t}\n\n\toverride onCancel: TLEventHandlers['onCancel'] = () => {\n\t\tthis.cancel()\n\t}\n\n\toverride onComplete: TLEventHandlers['onComplete'] = () => {\n\t\tthis.complete()\n\t}\n\n\toverride onInterrupt: TLEventHandlers['onInterrupt'] = () => {\n\t\tthis.cancel()\n\t}\n\n\tcomplete() {\n\t\tconst { originPagePoint } = this.app.inputs\n\n\t\tconst id = createShapeId()\n\n\t\tthis.app.mark('creating')\n\n\t\tthis.app.createShapes([\n\t\t\t{\n\t\t\t\tid,\n\t\t\t\ttype: 'geo',\n\t\t\t\tx: originPagePoint.x,\n\t\t\t\ty: originPagePoint.y,\n\t\t\t\tprops: {\n\t\t\t\t\tgeo: this.app.instanceState.propsForNextShape.geo,\n\t\t\t\t\tw: 1,\n\t\t\t\t\th: 1,\n\t\t\t\t},\n\t\t\t},\n\t\t])\n\n\t\tconst shape = this.app.getShapeById<TLGeoShape>(id)!\n\t\tif (!shape) return\n\n\t\tconst bounds =\n\t\t\tshape.props.geo === 'star' ? getStarBounds(5, 200, 200) : new Box2d(0, 0, 200, 200)\n\t\tconst delta = this.app.getDeltaInParentSpace(shape, bounds.center)\n\n\t\tthis.app.select(id)\n\t\tthis.app.updateShapes([\n\t\t\t{\n\t\t\t\tid: shape.id,\n\t\t\t\ttype: 'geo',\n\t\t\t\tx: shape.x - delta.x,\n\t\t\t\ty: shape.y - delta.y,\n\t\t\t\tprops: {\n\t\t\t\t\tgeo: this.app.instanceState.propsForNextShape.geo,\n\t\t\t\t\tw: bounds.width,\n\t\t\t\t\th: bounds.height,\n\t\t\t\t},\n\t\t\t},\n\t\t])\n\n\t\tif (this.app.instanceState.isToolLocked) {\n\t\t\tthis.parent.transition('idle', {})\n\t\t} else {\n\t\t\tthis.app.setSelectedTool('select', {})\n\t\t}\n\t}\n\n\tcancel() {\n\t\tthis.parent.transition('idle', {})\n\t}\n}\n","import { StateNode } from '../StateNode'\n\nimport { TLStyleType } from '@tldraw/tlschema'\nimport { Idle } from './children/Idle'\nimport { Pointing } from './children/Pointing'\n\nexport class TLGeoTool extends StateNode {\n\tstatic override id = 'geo'\n\tstatic initial = 'idle'\n\tstatic children = () => [Idle, Pointing]\n\n\tstyles = ['color', 'opacity', 'dash', 'fill', 'size', 'geo', 'font', 'align'] as TLStyleType[]\n}\n","import { Vec2d } from '@tldraw/primitives'\nimport { HAND_TOOL_FRICTION } from '../../../../constants'\nimport { TLEventHandlers } from '../../../types/event-types'\nimport { StateNode } from '../../StateNode'\n\nexport class Dragging extends StateNode {\n\tstatic override id = 'dragging'\n\n\tonEnter = () => {\n\t\tthis.update()\n\t}\n\n\tonPointerMove: TLEventHandlers['onPointerMove'] = () => {\n\t\tthis.update()\n\t}\n\n\tonPointerUp: TLEventHandlers['onPointerUp'] = () => {\n\t\tthis.complete()\n\t}\n\n\tonCancel: TLEventHandlers['onCancel'] = () => {\n\t\tthis.complete()\n\t}\n\n\tonComplete = () => {\n\t\tthis.complete()\n\t}\n\n\tprivate update() {\n\t\tconst { currentScreenPoint, previousScreenPoint } = this.app.inputs\n\n\t\tconst delta = Vec2d.Sub(currentScreenPoint, previousScreenPoint)\n\n\t\tif (Math.abs(delta.x) > 0 || Math.abs(delta.y) > 0) {\n\t\t\tthis.app.pan(delta.x, delta.y)\n\t\t}\n\t}\n\n\tprivate complete() {\n\t\tthis.app.slideCamera({\n\t\t\tspeed: Math.min(2, this.app.inputs.pointerVelocity.len()),\n\t\t\tdirection: this.app.inputs.pointerVelocity,\n\t\t\tfriction: HAND_TOOL_FRICTION,\n\t\t})\n\n\t\tthis.parent.transition('idle', {})\n\t}\n}\n","import { TLEventHandlers } from '../../../types/event-types'\nimport { StateNode } from '../../StateNode'\n\nexport class Idle extends StateNode {\n\tstatic override id = 'idle'\n\n\tonEnter = () => {\n\t\tthis.app.setCursor({ type: 'grab' })\n\t}\n\n\tonPointerDown: TLEventHandlers['onPointerDown'] = (info) => {\n\t\tthis.parent.transition('pointing', info)\n\t}\n\n\tonCancel = () => {\n\t\tthis.app.setSelectedTool('select')\n\t}\n}\n","import { TLEventHandlers } from '../../../types/event-types'\nimport { StateNode } from '../../StateNode'\n\nexport class Pointing extends StateNode {\n\tstatic override id = 'pointing'\n\n\tonEnter = () => {\n\t\tthis.app.stopCameraAnimation()\n\t\tthis.app.setCursor({ type: 'grabbing' })\n\t}\n\n\tonPointerMove: TLEventHandlers['onPointerMove'] = (info) => {\n\t\tif (this.app.inputs.isDragging) {\n\t\t\tthis.parent.transition('dragging', info)\n\t\t}\n\t}\n\n\tonPointerUp: TLEventHandlers['onPointerUp'] = () => {\n\t\tthis.complete()\n\t}\n\n\tonCancel: TLEventHandlers['onCancel'] = () => {\n\t\tthis.complete()\n\t}\n\n\tonComplete: TLEventHandlers['onComplete'] = () => {\n\t\tthis.complete()\n\t}\n\n\tonInterrupt: TLEventHandlers['onInterrupt'] = () => {\n\t\tthis.complete()\n\t}\n\n\tcomplete() {\n\t\tthis.parent.transition('idle', {})\n\t}\n}\n","import { EASINGS } from '@tldraw/primitives'\nimport { TLClickEvent } from '../../types/event-types'\nimport { StateNode } from '../StateNode'\n\nimport { Dragging } from './children/Dragging'\nimport { Idle } from './children/Idle'\nimport { Pointing } from './children/Pointing'\n\nexport class TLHandTool extends StateNode {\n\tstatic override id = 'hand'\n\tstatic initial = 'idle'\n\tstatic children = () => [Idle, Pointing, Dragging]\n\n\tstyles = []\n\n\tonDoubleClick: TLClickEvent = (info) => {\n\t\tif (info.phase === 'settle') {\n\t\t\tconst { currentScreenPoint } = this.app.inputs\n\t\t\tthis.app.zoomIn(currentScreenPoint, { duration: 220, easing: EASINGS.easeOutQuint })\n\t\t}\n\t}\n\n\tonTripleClick: TLClickEvent = (info) => {\n\t\tif (info.phase === 'settle') {\n\t\t\tconst { currentScreenPoint } = this.app.inputs\n\t\t\tthis.app.zoomOut(currentScreenPoint, { duration: 320, easing: EASINGS.easeOutQuint })\n\t\t}\n\t}\n\n\tonQuadrupleClick: TLClickEvent = (info) => {\n\t\tif (info.phase === 'settle') {\n\t\t\tconst {\n\t\t\t\tzoomLevel,\n\t\t\t\tinputs: { currentScreenPoint },\n\t\t\t} = this.app\n\n\t\t\tif (zoomLevel === 1) {\n\t\t\t\tthis.app.zoomToFit({ duration: 400, easing: EASINGS.easeOutQuint })\n\t\t\t} else {\n\t\t\t\tthis.app.resetZoom(currentScreenPoint, { duration: 320, easing: EASINGS.easeOutQuint })\n\t\t\t}\n\t\t}\n\t}\n}\n","import { TLShapeId } from '@tldraw/tlschema'\nimport { TLEventHandlers } from '../../../types/event-types'\nimport { StateNode } from '../../StateNode'\n\nexport class Idle extends StateNode {\n\tstatic override id = 'idle'\n\n\tshapeId = '' as TLShapeId\n\n\tonEnter = (info: { shapeId: TLShapeId }) => {\n\t\tthis.shapeId = info.shapeId\n\t\tthis.app.setCursor({ type: 'cross' })\n\t}\n\n\tonPointerDown: TLEventHandlers['onPointerDown'] = () => {\n\t\tthis.parent.transition('pointing', { shapeId: this.shapeId })\n\t}\n\n\tonCancel = () => {\n\t\tthis.app.setSelectedTool('select')\n\t}\n}\n","import { Matrix2d, Vec2d } from '@tldraw/primitives'\nimport { TLHandle, TLLineShape, TLShapeId, TLShapeType, createShapeId } from '@tldraw/tlschema'\nimport { last, structuredClone } from '@tldraw/utils'\nimport { getIndexAbove, sortByIndex } from '../../../../utils'\nimport { TLEventHandlers, TLInterruptEvent } from '../../../types/event-types'\nimport { StateNode } from '../../StateNode'\nimport { TLLineTool } from '../TLLineTool'\n\nexport class Pointing extends StateNode {\n\tstatic override id = 'pointing'\n\n\tshapeType = '' as TLShapeType\n\n\tshape = {} as TLLineShape\n\n\tmarkPointId = ''\n\n\tonEnter = (info: { shapeId?: TLShapeId }) => {\n\t\tconst { inputs } = this.app\n\t\tconst { currentPagePoint } = inputs\n\n\t\tthis.shapeType = (this.parent as TLLineTool).shapeType\n\t\tthis.markPointId = this.app.mark('creating')\n\n\t\tlet shapeExists = false\n\t\tif (info.shapeId) {\n\t\t\tconst shape = this.app.getShapeById<TLLineShape>(info.shapeId)\n\t\t\tif (shape) {\n\t\t\t\tshapeExists = true\n\t\t\t\tthis.shape = shape\n\t\t\t}\n\t\t}\n\n\t\t// if user is holding shift then we are adding points to an existing line\n\t\tif (inputs.shiftKey && shapeExists) {\n\t\t\tconst handles = this.app.getShapeUtil(this.shape).handles(this.shape)\n\n\t\t\tconst vertexHandles = handles.filter((h) => h.type === 'vertex').sort(sortByIndex)\n\t\t\tconst endHandle = vertexHandles[vertexHandles.length - 1]\n\n\t\t\tconst shapePagePoint = Matrix2d.applyToPoint(\n\t\t\t\tthis.app.getParentTransform(this.shape)!,\n\t\t\t\tnew Vec2d(this.shape.x, this.shape.y)\n\t\t\t)\n\n\t\t\tlet nextEndHandleIndex: string, nextEndHandleId: string, nextEndHandle: TLHandle\n\n\t\t\tif (vertexHandles.length === 2 && vertexHandles[1].x === 1 && vertexHandles[1].y === 1) {\n\t\t\t\tnextEndHandleIndex = vertexHandles[1].index\n\t\t\t\tnextEndHandleId = vertexHandles[1].id\n\t\t\t\tnextEndHandle = {\n\t\t\t\t\t...vertexHandles[1],\n\t\t\t\t\tx: currentPagePoint.x - shapePagePoint.x,\n\t\t\t\t\ty: currentPagePoint.y - shapePagePoint.y,\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tnextEndHandleIndex = getIndexAbove(endHandle.index)\n\t\t\t\tnextEndHandleId = 'handle:' + nextEndHandleIndex\n\t\t\t\tnextEndHandle = {\n\t\t\t\t\tx: currentPagePoint.x - shapePagePoint.x,\n\t\t\t\t\ty: currentPagePoint.y - shapePagePoint.y,\n\t\t\t\t\tindex: nextEndHandleIndex,\n\t\t\t\t\tcanBind: false,\n\t\t\t\t\ttype: 'vertex',\n\t\t\t\t\tid: nextEndHandleId,\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst nextHandles = structuredClone(this.shape.props.handles)\n\n\t\t\tnextHandles[nextEndHandle.id] = nextEndHandle\n\n\t\t\tthis.app.updateShapes([\n\t\t\t\t{\n\t\t\t\t\tid: this.shape.id,\n\t\t\t\t\ttype: this.shape.type,\n\t\t\t\t\tprops: {\n\t\t\t\t\t\thandles: nextHandles,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t])\n\t\t} else {\n\t\t\tconst id = createShapeId()\n\n\t\t\tthis.app.createShapes([\n\t\t\t\t{\n\t\t\t\t\tid,\n\t\t\t\t\ttype: this.shapeType,\n\t\t\t\t\tx: currentPagePoint.x,\n\t\t\t\t\ty: currentPagePoint.y,\n\t\t\t\t},\n\t\t\t])\n\n\t\t\tthis.app.select(id)\n\t\t\tthis.shape = this.app.getShapeById(id)!\n\t\t}\n\t}\n\n\tonPointerMove: TLEventHandlers['onPointerMove'] = () => {\n\t\tif (!this.shape) return\n\n\t\tif (this.app.inputs.isDragging) {\n\t\t\tconst util = this.app.getShapeUtil(this.shape)\n\t\t\tconst handles = util.handles?.(this.shape)\n\t\t\tif (!handles) {\n\t\t\t\tthis.app.bailToMark('creating')\n\t\t\t\tthrow Error('No handles found')\n\t\t\t}\n\n\t\t\tthis.app.setSelectedTool('select.dragging_handle', {\n\t\t\t\tshape: this.shape,\n\t\t\t\tisCreating: true,\n\t\t\t\thandle: last(handles)!,\n\t\t\t\tonInteractionEnd: 'line',\n\t\t\t})\n\t\t}\n\t}\n\n\toverride onPointerUp: TLEventHandlers['onPointerUp'] = () => {\n\t\tthis.complete()\n\t}\n\n\toverride onCancel: TLEventHandlers['onCancel'] = () => {\n\t\tthis.cancel()\n\t}\n\n\toverride onComplete: TLEventHandlers['onComplete'] = () => {\n\t\tthis.complete()\n\t}\n\n\toverride onInterrupt: TLInterruptEvent = () => {\n\t\tthis.parent.transition('idle', {})\n\t\tthis.app.bailToMark('creating')\n\t\tthis.app.snaps.clear()\n\t}\n\n\tcomplete() {\n\t\tthis.parent.transition('idle', { shapeId: this.shape.id })\n\t\tthis.app.snaps.clear()\n\t}\n\n\tcancel() {\n\t\tthis.app.bailToMark(this.markPointId)\n\t\tthis.parent.transition('idle', { shapeId: this.shape.id })\n\t\tthis.app.snaps.clear()\n\t}\n}\n","import { TLShapeType, TLStyleType } from '@tldraw/tlschema'\nimport { StateNode } from '../StateNode'\n\nimport { Idle } from './children/Idle'\nimport { Pointing } from './children/Pointing'\n\nexport class TLLineTool extends StateNode {\n\tstatic override id = 'line'\n\tstatic initial = 'idle'\n\tstatic children = () => [Idle, Pointing]\n\n\tshapeType: TLShapeType = 'line'\n\n\tstyles = ['color', 'opacity', 'dash', 'size', 'spline'] as TLStyleType[]\n}\n","import { TLEventHandlers } from '../../../types/event-types'\nimport { StateNode } from '../../StateNode'\n\nexport class Idle extends StateNode {\n\tstatic override id = 'idle'\n\n\tonPointerDown: TLEventHandlers['onPointerDown'] = (info) => {\n\t\tthis.parent.transition('pointing', info)\n\t}\n\n\tonEnter = () => {\n\t\tthis.app.setCursor({ type: 'cross' })\n\t}\n\n\tonCancel = () => {\n\t\tthis.app.setSelectedTool('select')\n\t}\n}\n","import { assert } from '@tldraw/utils'\nimport { TLNoteShapeDef } from '../../../shapeutils'\nimport { TLEventHandlers, TLInterruptEvent, TLPointerEventInfo } from '../../../types/event-types'\nimport { StateNode } from '../../StateNode'\n\nexport class Pointing extends StateNode {\n\tstatic override id = 'pointing'\n\n\tdragged = false\n\n\tinfo = {} as TLPointerEventInfo\n\n\twasFocusedOnEnter = false\n\n\tmarkPointId = 'creating'\n\n\tonEnter = () => {\n\t\tthis.wasFocusedOnEnter = !this.app.isMenuOpen\n\t}\n\n\tonPointerMove: TLEventHandlers['onPointerMove'] = (info) => {\n\t\tif (this.app.inputs.isDragging) {\n\t\t\tthis.app.mark(this.markPointId)\n\t\t\tconst shape = this.createShape()\n\t\t\tif (!shape) return\n\n\t\t\tthis.app.setSelectedTool('select.translating', {\n\t\t\t\t...info,\n\t\t\t\ttarget: 'shape',\n\t\t\t\tshape,\n\t\t\t\tisCreating: true,\n\t\t\t\teditAfterComplete: true,\n\t\t\t\tonInteractionEnd: 'note',\n\t\t\t})\n\t\t}\n\t}\n\n\tonPointerUp: TLEventHandlers['onPointerUp'] = () => {\n\t\tthis.complete()\n\t}\n\n\tonInterrupt: TLInterruptEvent = () => {\n\t\tthis.cancel()\n\t}\n\n\tonComplete: TLEventHandlers['onComplete'] = () => {\n\t\tthis.complete()\n\t}\n\n\tonCancel: TLEventHandlers['onCancel'] = () => {\n\t\tthis.cancel()\n\t}\n\n\tprivate complete() {\n\t\tif (!this.wasFocusedOnEnter) {\n\t\t\treturn\n\t\t}\n\n\t\tthis.app.mark(this.markPointId)\n\t\tconst shape = this.createShape()\n\n\t\tif (this.app.instanceState.isToolLocked) {\n\t\t\tthis.parent.transition('idle', {})\n\t\t} else {\n\t\t\tif (!shape) return\n\n\t\t\tthis.app.setEditingId(shape.id)\n\t\t\tthis.app.setSelectedTool('select.editing_shape', {\n\t\t\t\t...this.info,\n\t\t\t\ttarget: 'shape',\n\t\t\t\tshape,\n\t\t\t})\n\t\t}\n\t}\n\n\tprivate cancel() {\n\t\tthis.app.bailToMark(this.markPointId)\n\t\tthis.parent.transition('idle', this.info)\n\t}\n\n\tprivate createShape() {\n\t\tconst {\n\t\t\tinputs: { originPagePoint },\n\t\t} = this.app\n\n\t\tconst id = this.app.createShapeId()\n\n\t\tthis.app.createShapes(\n\t\t\t[\n\t\t\t\t{\n\t\t\t\t\tid,\n\t\t\t\t\ttype: 'note',\n\t\t\t\t\tx: originPagePoint.x,\n\t\t\t\t\ty: originPagePoint.y,\n\t\t\t\t},\n\t\t\t],\n\t\t\ttrue\n\t\t)\n\n\t\tconst util = this.app.getShapeUtilByDef(TLNoteShapeDef)\n\t\tconst shape = this.app.getShapeById(id)!\n\t\tassert(TLNoteShapeDef.is(shape))\n\t\tconst bounds = util.bounds(shape)\n\n\t\t// Center the text around the created point\n\t\tthis.app.updateShapes([\n\t\t\t{\n\t\t\t\tid,\n\t\t\t\ttype: 'note',\n\t\t\t\tx: shape.x - bounds.width / 2,\n\t\t\t\ty: shape.y - bounds.height / 2,\n\t\t\t},\n\t\t])\n\n\t\treturn this.app.getShapeById(id)\n\t}\n}\n","import { TLStyleType } from '@tldraw/tlschema'\nimport { StateNode } from '../StateNode'\nimport { Idle } from './children/Idle'\nimport { Pointing } from './children/Pointing'\n\nexport class TLNoteTool extends StateNode {\n\tstatic override id = 'note'\n\tstatic initial = 'idle'\n\tstatic children = () => [Idle, Pointing]\n\n\tstyles = ['color', 'opacity', 'size', 'align', 'font'] as TLStyleType[]\n}\n","import { Box2d, Matrix2d, Matrix2dModel, Vec2d } from '@tldraw/primitives'\nimport { TLPage, TLShape, TLShapePartial } from '@tldraw/tlschema'\nimport { compact } from '@tldraw/utils'\nimport type { App } from '../../App'\nimport { DragAndDropManager } from '../../managers/DragAndDropManager'\nimport { SnapPoint } from '../../managers/SnapManager'\nimport { TLEventHandlers, TLPointerEventInfo } from '../../types/event-types'\nimport { StateNode } from '../StateNode'\n\nexport class Translating extends StateNode {\n\tstatic override id = 'translating'\n\n\tinfo = {} as TLPointerEventInfo & {\n\t\ttarget: 'shape'\n\t\tisCreating?: boolean\n\t\teditAfterComplete?: boolean\n\t\tonInteractionEnd?: string\n\t}\n\n\tselectionSnapshot: TranslatingSnapshot = {} as any\n\n\tsnapshot: TranslatingSnapshot = {} as any\n\n\tmarkId = ''\n\n\tisCloning = false\n\tisCreating = false\n\teditAfterComplete = false\n\n\tdragAndDropManager = new DragAndDropManager(this.app)\n\n\tonEnter = (\n\t\tinfo: TLPointerEventInfo & {\n\t\t\ttarget: 'shape'\n\t\t\tisCreating?: boolean\n\t\t\teditAfterComplete?: boolean\n\t\t\tonInteractionEnd?: string\n\t\t}\n\t) => {\n\t\tconst { isCreating = false, editAfterComplete = false } = info\n\n\t\tthis.info = info\n\t\tthis.isCreating = isCreating\n\t\tthis.editAfterComplete = editAfterComplete\n\n\t\tthis.markId = isCreating ? 'creating' : this.app.mark('translating')\n\t\tthis.handleEnter(info)\n\t\tthis.app.on('tick', this.updateParent)\n\t}\n\n\tupdateParent = () => {\n\t\tconst { snapshot } = this\n\t\tthis.dragAndDropManager.updateDroppingNode(snapshot.movingShapes, this.updateParentTransforms)\n\t}\n\n\tonExit = () => {\n\t\tthis.app.off('tick', this.updateParent)\n\t\tthis.selectionSnapshot = {} as any\n\t\tthis.snapshot = {} as any\n\t\tthis.app.snaps.clear()\n\t\tthis.app.setCursor({ type: 'default' })\n\t\tthis.dragAndDropManager.clear()\n\t}\n\n\tonPointerMove = () => {\n\t\tthis.updateShapes()\n\t}\n\n\tonKeyDown = () => {\n\t\tif (this.app.inputs.altKey && !this.isCloning) {\n\t\t\tthis.startCloning()\n\t\t\treturn\n\t\t}\n\n\t\t// need to update in case user pressed a different modifier key\n\t\tthis.updateShapes()\n\t}\n\n\tonKeyUp: TLEventHandlers['onKeyUp'] = () => {\n\t\tif (!this.app.inputs.altKey && this.isCloning) {\n\t\t\tthis.stopCloning()\n\t\t\treturn\n\t\t}\n\n\t\t// need to update in case user pressed a different modifier key\n\t\tthis.updateShapes()\n\t}\n\n\tonPointerUp: TLEventHandlers['onPointerUp'] = () => {\n\t\tthis.complete()\n\t}\n\n\tonComplete: TLEventHandlers['onComplete'] = () => {\n\t\tthis.complete()\n\t}\n\n\tonCancel: TLEventHandlers['onCancel'] = () => {\n\t\tthis.cancel()\n\t}\n\n\treset() {\n\t\tthis.app.bailToMark(this.markId)\n\t}\n\n\tprotected startCloning() {\n\t\tif (this.isCreating) return\n\n\t\tthis.isCloning = true\n\t\tthis.reset()\n\t\tthis.markId = this.app.mark('translating')\n\n\t\tthis.app.duplicateShapes()\n\n\t\tthis.snapshot = getTranslatingSnapshot(this.app)\n\t\tthis.handleStart()\n\t\tthis.updateShapes()\n\t}\n\n\tprotected stopCloning() {\n\t\tthis.isCloning = false\n\t\tthis.snapshot = this.selectionSnapshot\n\t\tthis.reset()\n\t\tthis.markId = this.app.mark('translating')\n\t\tthis.updateShapes()\n\t}\n\n\tprotected complete() {\n\t\tthis.updateShapes()\n\t\tthis.dragAndDropManager.dropShapes(this.snapshot.movingShapes)\n\t\tthis.handleEnd()\n\n\t\tif (this.app.instanceState.isToolLocked && this.info.onInteractionEnd) {\n\t\t\tthis.app.setSelectedTool(this.info.onInteractionEnd)\n\t\t} else {\n\t\t\tif (this.editAfterComplete) {\n\t\t\t\tconst onlySelected = this.app.onlySelectedShape\n\t\t\t\tif (onlySelected) {\n\t\t\t\t\tthis.app.setEditingId(onlySelected.id)\n\t\t\t\t\tthis.app.setSelectedTool('select')\n\t\t\t\t\tthis.app.root.current.value!.transition('editing_shape', {})\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.parent.transition('idle', {})\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate cancel() {\n\t\tthis.reset()\n\t\tif (this.info.onInteractionEnd) {\n\t\t\tthis.app.setSelectedTool(this.info.onInteractionEnd)\n\t\t} else {\n\t\t\tthis.parent.transition('idle', this.info)\n\t\t}\n\t}\n\n\tprotected handleEnter(info: TLPointerEventInfo & { target: 'shape' }) {\n\t\tthis.isCloning = false\n\t\tthis.info = info\n\n\t\tthis.app.setCursor({ type: 'move' })\n\t\tthis.selectionSnapshot = getTranslatingSnapshot(this.app)\n\n\t\t// Don't clone on create; otherwise clone on altKey\n\t\tif (!this.isCreating) {\n\t\t\tif (this.app.inputs.altKey) {\n\t\t\t\tthis.startCloning()\n\t\t\t\treturn\n\t\t\t}\n\t\t}\n\n\t\tthis.snapshot = this.selectionSnapshot\n\t\tthis.handleStart()\n\t\tthis.updateShapes()\n\t}\n\n\tprotected handleStart() {\n\t\tconst { movingShapes } = this.snapshot\n\n\t\tconst changes: TLShapePartial[] = []\n\n\t\tmovingShapes.forEach((shape) => {\n\t\t\tconst util = this.app.getShapeUtil(shape)\n\t\t\tconst change = util.onTranslateStart?.(shape)\n\t\t\tif (change) {\n\t\t\t\tchanges.push(change)\n\t\t\t}\n\t\t})\n\n\t\tif (changes.length > 0) {\n\t\t\tthis.app.updateShapes(changes)\n\t\t}\n\t}\n\n\tprotected handleEnd() {\n\t\tconst { movingShapes } = this.snapshot\n\n\t\tconst changes: TLShapePartial[] = []\n\n\t\tmovingShapes.forEach((shape) => {\n\t\t\tconst current = this.app.getShapeById(shape.id)!\n\t\t\tconst util = this.app.getShapeUtil(shape)\n\t\t\tconst change = util.onTranslateEnd?.(shape, current)\n\t\t\tif (change) {\n\t\t\t\tchanges.push(change)\n\t\t\t}\n\t\t})\n\n\t\tif (changes.length > 0) {\n\t\t\tthis.app.updateShapes(changes)\n\t\t}\n\t}\n\n\tprotected handleChange() {\n\t\tconst { movingShapes } = this.snapshot\n\n\t\tconst changes: TLShapePartial[] = []\n\n\t\tmovingShapes.forEach((shape) => {\n\t\t\tconst current = this.app.getShapeById(shape.id)!\n\t\t\tconst util = this.app.getShapeUtil(shape)\n\t\t\tconst change = util.onTranslate?.(shape, current)\n\t\t\tif (change) {\n\t\t\t\tchanges.push(change)\n\t\t\t}\n\t\t})\n\n\t\tif (changes.length > 0) {\n\t\t\tthis.app.updateShapes(changes)\n\t\t}\n\t}\n\n\tprotected updateShapes() {\n\t\tconst { snapshot } = this\n\t\tthis.dragAndDropManager.updateDroppingNode(snapshot.movingShapes, this.updateParentTransforms)\n\n\t\tmoveShapesToPoint({\n\t\t\tapp: this.app,\n\t\t\tshapeSnapshots: snapshot.shapeSnapshots,\n\t\t\taveragePagePoint: snapshot.averagePagePoint,\n\t\t\tinitialSelectionPageBounds: snapshot.initialPageBounds,\n\t\t\tinitialSelectionSnapPoints: snapshot.initialSnapPoints,\n\t\t})\n\n\t\tthis.handleChange()\n\t}\n\n\tprotected updateParentTransforms = () => {\n\t\tconst {\n\t\t\tapp,\n\t\t\tsnapshot: { shapeSnapshots },\n\t\t} = this\n\t\tconst movingShapes: TLShape[] = []\n\n\t\tshapeSnapshots.forEach((shapeSnapshot) => {\n\t\t\tconst shape = app.getShapeById(shapeSnapshot.shape.id)\n\t\t\tif (!shape) return null\n\t\t\tmovingShapes.push(shape)\n\n\t\t\tconst parentTransform = TLPage.isId(shape.parentId)\n\t\t\t\t? null\n\t\t\t\t: Matrix2d.Inverse(app.getPageTransformById(shape.parentId)!)\n\n\t\t\tshapeSnapshot.parentTransform = parentTransform\n\t\t})\n\t}\n}\n\nfunction getTranslatingSnapshot(app: App) {\n\tconst movingShapes: TLShape[] = []\n\tconst pagePoints: Vec2d[] = []\n\n\tconst shapeSnapshots = compact(\n\t\tapp.selectedIds.map((id): null | MovingShapeSnapshot => {\n\t\t\tconst shape = app.getShapeById(id)\n\t\t\tif (!shape) return null\n\t\t\tmovingShapes.push(shape)\n\n\t\t\tconst pagePoint = app.getPagePointById(id)\n\t\t\tif (!pagePoint) return null\n\t\t\tpagePoints.push(pagePoint)\n\n\t\t\tconst parentTransform = TLPage.isId(shape.parentId)\n\t\t\t\t? null\n\t\t\t\t: Matrix2d.Inverse(app.getPageTransformById(shape.parentId)!)\n\n\t\t\treturn {\n\t\t\t\tshape,\n\t\t\t\tpagePoint,\n\t\t\t\tparentTransform,\n\t\t\t}\n\t\t})\n\t)\n\n\treturn {\n\t\taveragePagePoint: Vec2d.Average(pagePoints),\n\t\tmovingShapes,\n\t\tshapeSnapshots,\n\t\tinitialPageBounds: app.selectedPageBounds!,\n\t\tinitialSnapPoints:\n\t\t\tapp.selectedIds.length === 1\n\t\t\t\t? app.snaps.snapPointsCache.get(app.selectedIds[0])!\n\t\t\t\t: app.selectedPageBounds\n\t\t\t\t? app.selectedPageBounds.snapPoints.map((p, i) => ({\n\t\t\t\t\t\tid: 'selection:' + i,\n\t\t\t\t\t\tx: p.x,\n\t\t\t\t\t\ty: p.y,\n\t\t\t\t  }))\n\t\t\t\t: [],\n\t}\n}\n\nexport type TranslatingSnapshot = ReturnType<typeof getTranslatingSnapshot>\n\nexport interface MovingShapeSnapshot {\n\tshape: TLShape\n\tpagePoint: Vec2d\n\tparentTransform: Matrix2dModel | null\n}\n\nexport function moveShapesToPoint({\n\tapp,\n\tshapeSnapshots: snapshots,\n\taveragePagePoint,\n\tinitialSelectionPageBounds,\n\tinitialSelectionSnapPoints,\n}: {\n\tapp: App\n\tshapeSnapshots: MovingShapeSnapshot[]\n\taveragePagePoint: Vec2d\n\tinitialSelectionPageBounds: Box2d\n\tinitialSelectionSnapPoints: SnapPoint[]\n}) {\n\tconst { inputs, isGridMode, gridSize } = app\n\n\tconst delta = Vec2d.Sub(inputs.currentPagePoint, inputs.originPagePoint)\n\n\tconst flatten: 'x' | 'y' | null = app.inputs.shiftKey\n\t\t? Math.abs(delta.x) < Math.abs(delta.y)\n\t\t\t? 'x'\n\t\t\t: 'y'\n\t\t: null\n\n\tif (flatten === 'x') {\n\t\tdelta.x = 0\n\t} else if (flatten === 'y') {\n\t\tdelta.y = 0\n\t}\n\n\t// Provisional snapping\n\tapp.snaps.clear()\n\n\tconst shouldSnap =\n\t\t(app.userDocumentSettings.isSnapMode ? !inputs.ctrlKey : inputs.ctrlKey) &&\n\t\tapp.inputs.pointerVelocity.len() < 0.5 // ...and if the user is not dragging fast\n\n\tif (shouldSnap) {\n\t\tconst { nudge } = app.snaps.snapTranslate({\n\t\t\tdragDelta: delta,\n\t\t\tinitialSelectionPageBounds,\n\t\t\tlockedAxis: flatten,\n\t\t\tinitialSelectionSnapPoints,\n\t\t})\n\n\t\tdelta.add(nudge)\n\t}\n\n\tconst averageSnappedPoint = Vec2d.Add(averagePagePoint, delta)\n\n\tif (isGridMode && !inputs.ctrlKey) {\n\t\taverageSnappedPoint.snapToGrid(gridSize)\n\t}\n\n\tconst averageSnap = Vec2d.Sub(averageSnappedPoint, averagePagePoint)\n\n\tapp.updateShapes(\n\t\tcompact(\n\t\t\tsnapshots.map(({ shape, pagePoint, parentTransform }): TLShapePartial | null => {\n\t\t\t\tconst newPagePoint = Vec2d.Add(pagePoint, averageSnap)\n\t\t\t\tconst newLocalPoint = parentTransform\n\t\t\t\t\t? Matrix2d.applyToPoint(parentTransform, newPagePoint)\n\t\t\t\t\t: newPagePoint\n\n\t\t\t\treturn {\n\t\t\t\t\tid: shape.id,\n\t\t\t\t\ttype: shape.type,\n\t\t\t\t\tx: newLocalPoint.x,\n\t\t\t\t\ty: newLocalPoint.y,\n\t\t\t\t}\n\t\t\t})\n\t\t),\n\t\ttrue\n\t)\n}\n","import {\n\tBox2d,\n\tMatrix2d,\n\tpointInPolygon,\n\tpolygonsIntersect,\n\tVec2d,\n\tVecLike,\n} from '@tldraw/primitives'\nimport { TLPageId, TLShape, TLShapeId } from '@tldraw/tlschema'\nimport { TLShapeUtil } from '../../../shapeutils'\nimport {\n\tTLCancelEvent,\n\tTLEventHandlers,\n\tTLInterruptEvent,\n\tTLKeyboardEvent,\n\tTLPointerEventInfo,\n} from '../../../types/event-types'\nimport { StateNode } from '../../StateNode'\n\nexport class Brushing extends StateNode {\n\tstatic override id = 'brushing'\n\n\tinfo = {} as TLPointerEventInfo & { target: 'canvas' }\n\n\tbrush = new Box2d()\n\tinitialSelectedIds: TLShapeId[] = []\n\n\t// The shape that the brush started on\n\tinitialStartShape: TLShape | null = null\n\n\tonEnter = (info: TLPointerEventInfo & { target: 'canvas' }) => {\n\t\tconst { altKey, currentPagePoint } = this.app.inputs\n\n\t\tif (altKey) {\n\t\t\tthis.parent.transition('scribble_brushing', info)\n\t\t\treturn\n\t\t}\n\n\t\tthis.info = info\n\t\tthis.initialSelectedIds = this.app.selectedIds.slice()\n\t\tthis.initialStartShape = this.app.getShapesAtPoint(currentPagePoint)[0]\n\t\tthis.onPointerMove()\n\t}\n\n\tonExit = () => {\n\t\tthis.initialSelectedIds = []\n\t\tthis.app.setBrush(null)\n\t}\n\n\tonPointerMove = () => {\n\t\tthis.hitTestShapes()\n\t}\n\n\tonPointerUp: TLEventHandlers['onPointerUp'] = () => {\n\t\tthis.complete()\n\t}\n\n\tonComplete: TLEventHandlers['onComplete'] = () => {\n\t\tthis.complete()\n\t}\n\n\tonCancel?: TLCancelEvent | undefined = (info) => {\n\t\tthis.app.setSelectedIds(this.initialSelectedIds, true)\n\t\tthis.parent.transition('idle', info)\n\t}\n\n\tonKeyDown: TLEventHandlers['onKeyDown'] = (info) => {\n\t\tif (this.app.inputs.altKey) {\n\t\t\tthis.parent.transition('scribble_brushing', info)\n\t\t} else {\n\t\t\tthis.hitTestShapes()\n\t\t}\n\t}\n\n\tonKeyUp?: TLKeyboardEvent | undefined = () => {\n\t\tthis.hitTestShapes()\n\t}\n\n\tprivate complete() {\n\t\tthis.parent.transition('idle', {})\n\t}\n\n\tprivate hitTestShapes() {\n\t\tconst {\n\t\t\tcurrentPageId,\n\t\t\tshapesArray,\n\t\t\tinputs: { originPagePoint, currentPagePoint, shiftKey, ctrlKey },\n\t\t} = this.app\n\n\t\t// Set the brush to contain the current and origin points\n\t\tthis.brush.setTo(Box2d.FromPoints([originPagePoint, currentPagePoint]))\n\n\t\t// We'll be collecting shape ids\n\t\tconst results = new Set(shiftKey ? this.initialSelectedIds : [])\n\n\t\tlet A: VecLike,\n\t\t\tB: VecLike,\n\t\t\tshape: TLShape,\n\t\t\tutil: TLShapeUtil<TLShape>,\n\t\t\tpageBounds: Box2d | undefined,\n\t\t\tpageTransform: Matrix2d | undefined,\n\t\t\tlocalCorners: VecLike[]\n\n\t\t// We'll be testing the corners of the brush against the shapes\n\t\tconst { corners } = this.brush\n\n\t\ttestAllShapes: for (let i = 0, n = shapesArray.length; i < n; i++) {\n\t\t\tshape = shapesArray[i]\n\n\t\t\t// don't select groups directly, only via their children\n\t\t\tif (shape.type === 'group') continue testAllShapes\n\n\t\t\tif (results.has(shape.id)) continue testAllShapes\n\n\t\t\tpageBounds = this.app.getPageBounds(shape)\n\t\t\tif (!pageBounds) continue testAllShapes\n\n\t\t\t// If the brush fully wraps a shape, it's almost certainly a hit\n\t\t\tif (this.brush.contains(pageBounds)) {\n\t\t\t\tthis.handleHit(shape, currentPagePoint, currentPageId, results, corners)\n\t\t\t\tcontinue testAllShapes\n\t\t\t}\n\n\t\t\t// Should we even test for a single segment intersections? Only if\n\t\t\t// we're not holding the ctrl key for alternate selection mode\n\t\t\t// (only wraps count!), or if the shape is a frame.\n\t\t\tif (ctrlKey || shape.type === 'frame') {\n\t\t\t\tcontinue testAllShapes\n\t\t\t}\n\n\t\t\t// If the brush collides the page bounds, then do hit tests against\n\t\t\t// each of the brush's four sides.\n\t\t\tif (this.brush.collides(pageBounds)) {\n\t\t\t\t// Shapes expect to hit test line segments in their own coordinate system,\n\t\t\t\t// so we first need to get the brush corners in the shape's local space.\n\t\t\t\tutil = this.app.getShapeUtil(shape)\n\n\t\t\t\tpageTransform = this.app.getPageTransform(shape)\n\n\t\t\t\tif (!pageTransform) {\n\t\t\t\t\tcontinue testAllShapes\n\t\t\t\t}\n\n\t\t\t\t// Check whether any of the the brush edges intersect the shape\n\t\t\t\tlocalCorners = Matrix2d.applyToPoints(Matrix2d.Inverse(pageTransform), corners)\n\n\t\t\t\thitTestBrushEdges: for (let i = 0; i < localCorners.length; i++) {\n\t\t\t\t\tA = localCorners[i]\n\t\t\t\t\tB = localCorners[(i + 1) % localCorners.length]\n\n\t\t\t\t\tif (util.hitTestLineSegment(shape, A, B)) {\n\t\t\t\t\t\tthis.handleHit(shape, currentPagePoint, currentPageId, results, corners)\n\t\t\t\t\t\tbreak hitTestBrushEdges\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.app.setBrush({ ...this.brush.toJson() })\n\t\tthis.app.setSelectedIds(Array.from(results), true)\n\t}\n\n\tonInterrupt: TLInterruptEvent = () => {\n\t\tthis.app.setBrush(null)\n\t}\n\n\tprivate handleHit(\n\t\tshape: TLShape,\n\t\tcurrentPagePoint: Vec2d,\n\t\tcurrentPageId: TLPageId,\n\t\tresults: Set<TLShapeId>,\n\t\tcorners: Vec2d[]\n\t) {\n\t\tif (shape.parentId === currentPageId) {\n\t\t\tresults.add(shape.id)\n\t\t\treturn\n\t\t}\n\n\t\t// Find the outermost selectable shape, check to see if it has a\n\t\t// page mask; and if so, check to see if the brush intersects it\n\t\tconst selectedShape = this.app.getOutermostSelectableShape(shape)\n\t\tconst pageMask = this.app.getPageMaskById(selectedShape.id)\n\n\t\tif (\n\t\t\tpageMask &&\n\t\t\tpolygonsIntersect(pageMask, corners) !== null &&\n\t\t\t!pointInPolygon(currentPagePoint, pageMask)\n\t\t) {\n\t\t\treturn\n\t\t}\n\n\t\tresults.add(selectedShape.id)\n\t}\n}\n","import { Matrix2d, snapAngle, Vec2d } from '@tldraw/primitives'\nimport {\n\tTLArrowShape,\n\tTLArrowTerminal,\n\tTLHandle,\n\tTLShapeId,\n\tTLShapePartial,\n} from '@tldraw/tlschema'\nimport { deepCopy } from '@tldraw/utils'\nimport { sortByIndex } from '../../../../utils'\nimport {\n\tTLCancelEvent,\n\tTLEventHandlers,\n\tTLKeyboardEvent,\n\tTLPointerEventInfo,\n\tUiEnterHandler,\n} from '../../../types/event-types'\nimport { StateNode } from '../../StateNode'\n\nexport class DraggingHandle extends StateNode {\n\tstatic id = 'dragging_handle'\n\n\tshapeId = '' as TLShapeId\n\tinitialHandle = {} as TLHandle\n\tinitialAdjacentHandle = null as TLHandle | null\n\n\tmarkId = ''\n\tinitialPageTransform: any\n\tinitialPageRotation: any\n\n\tinfo = {} as TLPointerEventInfo & {\n\t\tshape: TLArrowShape\n\t\ttarget: 'handle'\n\t\tonInteractionEnd?: string\n\t\tisCreating: boolean\n\t}\n\n\tisPrecise = false\n\tisPreciseId = null as TLShapeId | null\n\tpointingId = null as TLShapeId | null\n\n\tonEnter: UiEnterHandler = (\n\t\tinfo: TLPointerEventInfo & {\n\t\t\tshape: TLArrowShape\n\t\t\ttarget: 'handle'\n\t\t\tonInteractionEnd?: string\n\t\t\tisCreating: boolean\n\t\t}\n\t) => {\n\t\tconst { shape, isCreating, handle } = info\n\t\tthis.info = info\n\t\tthis.shapeId = shape.id\n\t\tthis.markId = isCreating ? 'creating' : this.app.mark('dragging handle')\n\t\tthis.initialHandle = deepCopy(handle)\n\t\tthis.initialPageTransform = this.app.getPageTransform(shape)!\n\t\tthis.initialPageRotation = this.app.getPageRotation(shape)!\n\n\t\tthis.app.setCursor({ type: isCreating ? 'cross' : 'grabbing', rotation: 0 })\n\n\t\tconst handles = this.app.getShapeUtil(shape).handles(shape).sort(sortByIndex)\n\t\tconst index = handles.findIndex((h) => h.id === info.handle.id)\n\n\t\tthis.initialAdjacentHandle = null\n\n\t\t// Start from the handle and work forward\n\t\tfor (let i = index + 1; i < handles.length; i++) {\n\t\t\tconst handle = handles[i]\n\t\t\tif (handle.type === 'vertex' && handle.id !== 'middle' && handle.id !== info.handle.id) {\n\t\t\t\tthis.initialAdjacentHandle = handle\n\t\t\t\tbreak\n\t\t\t}\n\t\t}\n\n\t\t// If still no handle, start from the end and work backward\n\t\tif (!this.initialAdjacentHandle) {\n\t\t\tfor (let i = handles.length - 1; i >= 0; i--) {\n\t\t\t\tconst handle = handles[i]\n\t\t\t\tif (handle.type === 'vertex' && handle.id !== 'middle' && handle.id !== info.handle.id) {\n\t\t\t\t\tthis.initialAdjacentHandle = handle\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst initialTerminal = shape.props[info.handle.id as 'start' | 'end']\n\n\t\tthis.isPrecise = false\n\n\t\tif (initialTerminal?.type === 'binding') {\n\t\t\tthis.app.setHintingIds([initialTerminal.boundShapeId])\n\n\t\t\tthis.isPrecise = !Vec2d.Equals(initialTerminal.normalizedAnchor, { x: 0.5, y: 0.5 })\n\t\t\tif (this.isPrecise) {\n\t\t\t\tthis.isPreciseId = initialTerminal.boundShapeId\n\t\t\t} else {\n\t\t\t\tthis.resetExactTimeout()\n\t\t\t}\n\t\t}\n\n\t\tthis.update()\n\t}\n\n\texactTimeout = -1 as any\n\n\tresetExactTimeout() {\n\t\tif (this.exactTimeout !== -1) {\n\t\t\tthis.clearExactTimeout()\n\t\t}\n\n\t\tthis.exactTimeout = setTimeout(() => {\n\t\t\tif (this.isActive && !this.isPrecise) {\n\t\t\t\tthis.isPrecise = true\n\t\t\t\tthis.isPreciseId = this.pointingId\n\t\t\t\tthis.update()\n\t\t\t}\n\t\t\tthis.exactTimeout = -1\n\t\t}, 750)\n\t}\n\n\tclearExactTimeout() {\n\t\tif (this.exactTimeout !== -1) {\n\t\t\tclearTimeout(this.exactTimeout)\n\t\t\tthis.exactTimeout = -1\n\t\t}\n\t}\n\n\tonPointerMove: TLEventHandlers['onPointerMove'] = () => {\n\t\tthis.update()\n\t}\n\n\tonKeyDown: TLKeyboardEvent | undefined = () => {\n\t\tthis.update()\n\t}\n\n\tonKeyUp: TLKeyboardEvent | undefined = () => {\n\t\tthis.update()\n\t}\n\n\tonPointerUp: TLEventHandlers['onPointerUp'] = () => {\n\t\tthis.complete()\n\t}\n\n\tonComplete: TLEventHandlers['onComplete'] = () => {\n\t\tthis.complete()\n\t}\n\n\tonCancel: TLCancelEvent = () => {\n\t\tthis.cancel()\n\t}\n\n\tonExit = () => {\n\t\tthis.app.setHintingIds([])\n\t\tthis.app.snaps.clear()\n\t\tthis.app.setCursor({ type: 'default' })\n\t}\n\n\tprivate complete() {\n\t\tthis.app.snaps.clear()\n\n\t\tconst { onInteractionEnd } = this.info\n\t\tif (this.app.instanceState.isToolLocked && onInteractionEnd) {\n\t\t\t// Return to the tool that was active before this one,\n\t\t\t// but only if tool lock is turned on!\n\t\t\tthis.app.setSelectedTool(onInteractionEnd, { shapeId: this.shapeId })\n\t\t\treturn\n\t\t}\n\n\t\tthis.parent.transition('idle', {})\n\t}\n\n\tprivate cancel() {\n\t\tthis.app.bailToMark(this.markId)\n\t\tthis.app.snaps.clear()\n\n\t\tconst { onInteractionEnd } = this.info\n\t\tif (onInteractionEnd) {\n\t\t\t// Return to the tool that was active before this one,\n\t\t\t// whether tool lock is turned on or not!\n\t\t\tthis.app.setSelectedTool(onInteractionEnd, { shapeId: this.shapeId })\n\t\t\treturn\n\t\t}\n\n\t\tthis.parent.transition('idle', {})\n\t}\n\n\tprivate update() {\n\t\tconst { currentPagePoint, originPagePoint, shiftKey } = this.app.inputs\n\t\tconst shape = this.app.getShapeById(this.shapeId)\n\n\t\tif (!shape) return\n\n\t\tlet point = Vec2d.Add(\n\t\t\tVec2d.Rot(Vec2d.Sub(currentPagePoint, originPagePoint), -this.initialPageRotation),\n\t\t\tthis.initialHandle\n\t\t)\n\n\t\tif (shiftKey && this.initialHandle.id !== 'middle') {\n\t\t\tconst { initialAdjacentHandle } = this\n\n\t\t\tif (initialAdjacentHandle) {\n\t\t\t\tconst angle = Vec2d.Angle(initialAdjacentHandle, point)\n\t\t\t\tconst snappedAngle = snapAngle(angle, 24)\n\t\t\t\tconst angleDifference = snappedAngle - angle\n\t\t\t\tpoint = Vec2d.RotWith(point, initialAdjacentHandle, angleDifference)\n\t\t\t}\n\t\t}\n\n\t\tthis.app.snaps.clear()\n\n\t\tconst { ctrlKey } = this.app.inputs\n\t\tconst shouldSnap = this.app.userDocumentSettings.isSnapMode ? !ctrlKey : ctrlKey\n\n\t\tif (shouldSnap && shape.type === 'line') {\n\t\t\tconst pagePoint = Matrix2d.applyToPoint(this.app.getPageTransformById(shape.id)!, point)\n\t\t\tconst snapData = this.app.snaps.snapLineHandleTranslate({\n\t\t\t\tlineId: shape.id,\n\t\t\t\thandleId: this.initialHandle.id,\n\t\t\t\thandlePoint: pagePoint,\n\t\t\t})\n\n\t\t\tconst { nudge } = snapData\n\t\t\tif (nudge.x || nudge.y) {\n\t\t\t\tconst shapeSpaceNudge = this.app.getDeltaInShapeSpace(shape, nudge)\n\t\t\t\tpoint = Vec2d.Add(point, shapeSpaceNudge)\n\t\t\t}\n\t\t}\n\n\t\tconst util = this.app.getShapeUtil(shape)\n\n\t\tconst changes = util.onHandleChange?.(shape, {\n\t\t\thandle: {\n\t\t\t\t...this.initialHandle,\n\t\t\t\tx: point.x,\n\t\t\t\ty: point.y,\n\t\t\t},\n\t\t\tisPrecise: this.isPrecise || this.app.inputs.altKey,\n\t\t})\n\n\t\tconst next: TLShapePartial<any> = { ...shape, ...changes }\n\n\t\tif (this.initialHandle.canBind) {\n\t\t\tconst bindingAfter = (next.props as any)[this.initialHandle.id] as TLArrowTerminal | undefined\n\n\t\t\tif (bindingAfter?.type === 'binding') {\n\t\t\t\tif (this.app.hintingIds[0] !== bindingAfter.boundShapeId) {\n\t\t\t\t\tthis.app.setHintingIds([bindingAfter.boundShapeId])\n\t\t\t\t\tthis.pointingId = bindingAfter.boundShapeId\n\t\t\t\t\tthis.isPrecise = this.app.inputs.pointerVelocity.len() < 0.5 || this.app.inputs.altKey\n\t\t\t\t\tthis.isPreciseId = this.isPrecise ? bindingAfter.boundShapeId : null\n\t\t\t\t\tthis.resetExactTimeout()\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (this.app.hintingIds.length > 0) {\n\t\t\t\t\tthis.app.setHintingIds([])\n\t\t\t\t\tthis.pointingId = null\n\t\t\t\t\tthis.isPrecise = false\n\t\t\t\t\tthis.isPreciseId = null\n\t\t\t\t\tthis.resetExactTimeout()\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (changes) {\n\t\t\tthis.app.updateShapes([next], true)\n\t\t}\n\t}\n}\n","import { TLEventHandlers } from '../../../types/event-types'\nimport { StateNode } from '../../StateNode'\n\nexport class EditingShape extends StateNode {\n\tstatic override id = 'editing_shape'\n\n\tonPointerEnter: TLEventHandlers['onPointerEnter'] = (info) => {\n\t\tswitch (info.target) {\n\t\t\tcase 'shape': {\n\t\t\t\tconst { selectedIds, focusLayerId } = this.app\n\t\t\t\tconst hoveringShape = this.app.getOutermostSelectableShape(\n\t\t\t\t\tinfo.shape,\n\t\t\t\t\t(parent) => !selectedIds.includes(parent.id)\n\t\t\t\t)\n\t\t\t\tif (hoveringShape.id !== focusLayerId) {\n\t\t\t\t\tthis.app.setHoveredId(hoveringShape.id)\n\t\t\t\t}\n\t\t\t\tbreak\n\t\t\t}\n\t\t}\n\t}\n\n\tonPointerLeave: TLEventHandlers['onPointerEnter'] = (info) => {\n\t\tswitch (info.target) {\n\t\t\tcase 'shape': {\n\t\t\t\tthis.app.setHoveredId(null)\n\t\t\t\tbreak\n\t\t\t}\n\t\t}\n\t}\n\n\tonExit = () => {\n\t\tif (!this.app.pageState.editingId) return\n\t\tconst { editingId } = this.app.pageState\n\t\tif (!editingId) return\n\n\t\t// Clear the editing shape\n\t\tthis.app.setEditingId(null)\n\n\t\tconst shape = this.app.getShapeById(editingId)!\n\t\tconst util = this.app.getShapeUtil(shape)\n\n\t\t// Check for changes on editing end\n\t\tutil.onEditEnd?.(shape)\n\t}\n\n\tonPointerDown: TLEventHandlers['onPointerDown'] = (info) => {\n\t\tswitch (info.target) {\n\t\t\tcase 'shape': {\n\t\t\t\tconst { shape } = info\n\n\t\t\t\tconst { editingId } = this.app.pageState\n\n\t\t\t\tif (editingId) {\n\t\t\t\t\tif (shape.id === editingId) {\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\n\t\t\t\t\tconst editingShape = this.app.getShapeById(editingId)\n\n\t\t\t\t\tif (editingShape) {\n\t\t\t\t\t\tconst util = this.app.getShapeUtil(shape)\n\n\t\t\t\t\t\t// If the user has clicked onto a different shape of the same type\n\t\t\t\t\t\t// which is available to edit, select it and begin editing it.\n\t\t\t\t\t\tif (shape.type === editingShape.type && util.canEdit?.(shape)) {\n\t\t\t\t\t\t\tthis.app.setEditingId(shape.id)\n\t\t\t\t\t\t\tthis.app.setHoveredId(shape.id)\n\t\t\t\t\t\t\tthis.app.setSelectedIds([shape.id])\n\t\t\t\t\t\t\treturn\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.parent.transition('idle', info)\n\t\tthis.parent.current.value?.onPointerDown?.(info)\n\t}\n\n\tonComplete: TLEventHandlers['onComplete'] = (info) => {\n\t\tthis.parent.transition('idle', info)\n\t}\n\n\tonCancel: TLEventHandlers['onCancel'] = (info) => {\n\t\tthis.parent.transition('idle', info)\n\t}\n\n\tonBlur: TLEventHandlers['onBlur'] = (info) => {\n\t\tthis.parent.transition('idle', info)\n\t}\n}\n","import { createShapeId, TLShape } from '@tldraw/tlschema'\nimport { TLClickEventInfo, TLEventHandlers, TLKeyboardEventInfo } from '../../../types/event-types'\nimport { StateNode } from '../../StateNode'\n\nexport class Idle extends StateNode {\n\tstatic override id = 'idle'\n\n\tonPointerEnter: TLEventHandlers['onPointerEnter'] = (info) => {\n\t\tswitch (info.target) {\n\t\t\tcase 'canvas': {\n\t\t\t\t// noop\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tcase 'shape': {\n\t\t\t\tconst { selectedIds, focusLayerId } = this.app\n\t\t\t\tconst hoveringShape = this.app.getOutermostSelectableShape(\n\t\t\t\t\tinfo.shape,\n\t\t\t\t\t(parent) => !selectedIds.includes(parent.id)\n\t\t\t\t)\n\t\t\t\tif (hoveringShape.id !== focusLayerId) {\n\t\t\t\t\tthis.app.setHoveredId(hoveringShape.id)\n\t\t\t\t}\n\t\t\t\tbreak\n\t\t\t}\n\t\t}\n\t}\n\n\tonPointerLeave: TLEventHandlers['onPointerEnter'] = (info) => {\n\t\tswitch (info.target) {\n\t\t\tcase 'shape': {\n\t\t\t\tthis.app.setHoveredId(null)\n\t\t\t\tbreak\n\t\t\t}\n\t\t}\n\t}\n\n\tonPointerDown: TLEventHandlers['onPointerDown'] = (info) => {\n\t\tif (this.app.isMenuOpen) return\n\n\t\tif (info.ctrlKey) {\n\t\t\tthis.parent.transition('brushing', info)\n\t\t\treturn\n\t\t}\n\n\t\tswitch (info.target) {\n\t\t\tcase 'canvas': {\n\t\t\t\tthis.parent.transition('pointing_canvas', info)\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tcase 'shape': {\n\t\t\t\tthis.parent.transition('pointing_shape', info)\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tcase 'handle': {\n\t\t\t\tif (this.app.isReadOnly) break\n\t\t\t\tthis.parent.transition('pointing_handle', info)\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tcase 'selection': {\n\t\t\t\tswitch (info.handle) {\n\t\t\t\t\tcase 'mobile_rotate':\n\t\t\t\t\tcase 'top_left_rotate':\n\t\t\t\t\tcase 'top_right_rotate':\n\t\t\t\t\tcase 'bottom_left_rotate':\n\t\t\t\t\tcase 'bottom_right_rotate': {\n\t\t\t\t\t\tthis.parent.transition('pointing_rotate_handle', info)\n\t\t\t\t\t\tbreak\n\t\t\t\t\t}\n\t\t\t\t\tcase 'top':\n\t\t\t\t\tcase 'right':\n\t\t\t\t\tcase 'bottom':\n\t\t\t\t\tcase 'left': {\n\t\t\t\t\t\tthis.parent.transition('pointing_resize_handle', info)\n\t\t\t\t\t\tbreak\n\t\t\t\t\t}\n\t\t\t\t\tcase 'top_left':\n\t\t\t\t\tcase 'top_right':\n\t\t\t\t\tcase 'bottom_left':\n\t\t\t\t\tcase 'bottom_right': {\n\t\t\t\t\t\tthis.parent.transition('pointing_resize_handle', info)\n\t\t\t\t\t\tbreak\n\t\t\t\t\t}\n\t\t\t\t\tdefault: {\n\t\t\t\t\t\tthis.parent.transition('pointing_selection', info)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak\n\t\t\t}\n\t\t}\n\t}\n\n\tonDoubleClick: TLEventHandlers['onDoubleClick'] = (info) => {\n\t\tswitch (info.target) {\n\t\t\tcase 'canvas': {\n\t\t\t\t// Create text shape and transition to editing_shape\n\t\t\t\tthis.createTextShapeAtPoint(info)\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tcase 'selection': {\n\t\t\t\tif (this.app.isReadOnly) break\n\t\t\t\tconst { onlySelectedShape } = this.app\n\t\t\t\tif (onlySelectedShape) {\n\t\t\t\t\tconst util = this.app.getShapeUtil(onlySelectedShape)\n\t\t\t\t\tif (\n\t\t\t\t\t\tinfo.handle === 'right' ||\n\t\t\t\t\t\tinfo.handle === 'left' ||\n\t\t\t\t\t\tinfo.handle === 'top' ||\n\t\t\t\t\t\tinfo.handle === 'bottom'\n\t\t\t\t\t) {\n\t\t\t\t\t\tconst change = util.onDoubleClickEdge?.(onlySelectedShape)\n\t\t\t\t\t\tif (change) {\n\t\t\t\t\t\t\tthis.app.mark('double click edge')\n\t\t\t\t\t\t\tthis.app.updateShapes([change])\n\t\t\t\t\t\t\treturn\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (util.canEdit(onlySelectedShape)) {\n\t\t\t\t\t\tthis.startEditingShape(onlySelectedShape, info)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tcase 'shape': {\n\t\t\t\tconst { shape } = info\n\t\t\t\tconst util = this.app.getShapeUtil(shape)\n\n\t\t\t\t// Allow video playing\n\t\t\t\tif (shape.type !== 'video' && this.app.isReadOnly) break\n\n\t\t\t\tif (util.onDoubleClick) {\n\t\t\t\t\t// Call the shape's double click handler\n\t\t\t\t\tconst change = util.onDoubleClick?.(shape)\n\t\t\t\t\tif (change) {\n\t\t\t\t\t\tthis.app.updateShapes([change])\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// If the shape can edit, then begin editing\n\t\t\t\t\tif (util.canEdit(shape)) {\n\t\t\t\t\t\tthis.startEditingShape(shape, info)\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// If the shape's double click handler has not created a change,\n\t\t\t\t\t\t// and if the shape cannot edit, then create a text shape and\n\t\t\t\t\t\t// begin editing the text shape\n\t\t\t\t\t\tthis.createTextShapeAtPoint(info)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tcase 'handle': {\n\t\t\t\tif (this.app.isReadOnly) break\n\t\t\t\tconst { shape, handle } = info\n\n\t\t\t\tconst util = this.app.getShapeUtil(shape)\n\t\t\t\tconst changes = util.onDoubleClickHandle?.(shape, handle)\n\n\t\t\t\tif (changes) {\n\t\t\t\t\tthis.app.updateShapes([changes])\n\t\t\t\t} else {\n\t\t\t\t\t// If the shape's double click handler has not created a change,\n\t\t\t\t\t// and if the shape can edit, then begin editing the shape.\n\t\t\t\t\tif (util.canEdit(shape)) {\n\t\t\t\t\t\tthis.startEditingShape(shape, info)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tonRightClick: TLEventHandlers['onRightClick'] = (info) => {\n\t\tswitch (info.target) {\n\t\t\tcase 'canvas': {\n\t\t\t\tthis.app.selectNone()\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tcase 'shape': {\n\t\t\t\tconst { selectedIds } = this.app.pageState\n\t\t\t\tconst { shape } = info\n\n\t\t\t\tconst targetShape = this.app.getOutermostSelectableShape(\n\t\t\t\t\tshape,\n\t\t\t\t\t(parent) => !this.app.isSelected(parent.id)\n\t\t\t\t)\n\n\t\t\t\tif (!selectedIds.includes(targetShape.id)) {\n\t\t\t\t\tthis.app.mark('selecting shape')\n\t\t\t\t\tthis.app.setSelectedIds([targetShape.id])\n\t\t\t\t}\n\t\t\t\tbreak\n\t\t\t}\n\t\t}\n\t}\n\n\tonEnter = () => {\n\t\tthis.app.setHoveredId(null)\n\t\tthis.app.setCursor({ type: 'default' })\n\t}\n\n\tonCancel: TLEventHandlers['onCancel'] = () => {\n\t\tif (\n\t\t\t// if there are no selected shapes\n\t\t\tthis.app.selectedIds.length === 0 ||\n\t\t\t// or if the only selected shape is a group and the focus layer is not the page\n\t\t\t(this.app.selectedIds.length === 1 &&\n\t\t\t\tthis.app.getShapeById(this.app.selectedIds[0])?.type === 'group' &&\n\t\t\t\tthis.app.focusLayerId !== this.app.currentPageId)\n\t\t) {\n\t\t\tthis.app.popFocusLayer()\n\t\t} else {\n\t\t\tthis.app.mark('clearing selection')\n\t\t\tthis.app.selectNone()\n\t\t}\n\t}\n\n\tonKeyUp = (info: TLKeyboardEventInfo) => {\n\t\tif (this.app.isReadOnly) return\n\t\tswitch (info.key) {\n\t\t\tcase 'Enter': {\n\t\t\t\tconst { selectedShapes } = this.app\n\n\t\t\t\tif (selectedShapes.every((shape) => shape.type === 'group')) {\n\t\t\t\t\tthis.app.setSelectedIds(\n\t\t\t\t\t\tselectedShapes.flatMap((shape) => this.app.getSortedChildIds(shape.id))\n\t\t\t\t\t)\n\t\t\t\t\treturn\n\t\t\t\t}\n\n\t\t\t\tconst { onlySelectedShape } = this.app\n\t\t\t\tif (\n\t\t\t\t\tonlySelectedShape &&\n\t\t\t\t\tthis.app.getShapeUtil(onlySelectedShape).canEdit(onlySelectedShape)\n\t\t\t\t) {\n\t\t\t\t\tthis.startEditingShape(onlySelectedShape, {\n\t\t\t\t\t\t...info,\n\t\t\t\t\t\ttarget: 'shape',\n\t\t\t\t\t\tshape: onlySelectedShape,\n\t\t\t\t\t})\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\tbreak\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate startEditingShape(shape: TLShape, info: TLClickEventInfo | TLKeyboardEventInfo) {\n\t\tthis.app.mark('editing shape')\n\t\tthis.app.setEditingId(shape.id)\n\t\tthis.parent.transition('editing_shape', info)\n\t}\n\n\tprivate createTextShapeAtPoint(info: TLClickEventInfo) {\n\t\tthis.app.mark('creating text shape')\n\n\t\tconst id = createShapeId()\n\n\t\tconst { x, y } = this.app.inputs.currentPagePoint\n\n\t\tthis.app.createShapes([\n\t\t\t{\n\t\t\t\tid,\n\t\t\t\ttype: 'text',\n\t\t\t\tx,\n\t\t\t\ty,\n\t\t\t\tprops: {\n\t\t\t\t\ttext: '',\n\t\t\t\t\tautoSize: true,\n\t\t\t\t},\n\t\t\t},\n\t\t])\n\n\t\tconst shape = this.app.getShapeById(id)\n\t\tif (!shape) return\n\n\t\tconst bounds = this.app.getBounds(shape)\n\n\t\tthis.app.updateShapes([\n\t\t\t{\n\t\t\t\tid,\n\t\t\t\ttype: 'text',\n\t\t\t\tx: shape.x - bounds.width / 2,\n\t\t\t\ty: shape.y - bounds.height / 2,\n\t\t\t},\n\t\t])\n\n\t\tthis.app.setEditingId(id)\n\t\tthis.app.select(id)\n\t\tthis.parent.transition('editing_shape', info)\n\t}\n}\n","import { isShapeId } from '@tldraw/tlschema'\nimport { TLEventHandlers } from '../../../types/event-types'\nimport { StateNode } from '../../StateNode'\n\nexport class PointingCanvas extends StateNode {\n\tstatic override id = 'pointing_canvas'\n\n\tonEnter = () => {\n\t\tconst { inputs } = this.app\n\n\t\tif (!inputs.shiftKey) {\n\t\t\tif (this.app.selectedIds.length > 0) {\n\t\t\t\tthis.app.mark('selecting none')\n\t\t\t\tthis.app.selectNone()\n\t\t\t}\n\t\t}\n\t}\n\n\t_clickWasInsideFocusedGroup() {\n\t\tconst { focusLayerId, inputs } = this.app\n\t\tif (!isShapeId(focusLayerId)) {\n\t\t\treturn false\n\t\t}\n\t\tconst groupShape = this.app.getShapeById(focusLayerId)\n\t\tif (!groupShape) {\n\t\t\treturn false\n\t\t}\n\t\tconst clickPoint = this.app.getPointInShapeSpace(groupShape, inputs.currentPagePoint)\n\t\tconst util = this.app.getShapeUtil(groupShape)\n\t\treturn util.hitTestPoint(groupShape, clickPoint)\n\t}\n\n\tonPointerMove: TLEventHandlers['onPointerMove'] = (info) => {\n\t\tif (this.app.inputs.isDragging) {\n\t\t\tthis.parent.transition('brushing', info)\n\t\t}\n\t}\n\n\tonPointerUp: TLEventHandlers['onPointerUp'] = () => {\n\t\tthis.complete()\n\t}\n\n\tonComplete: TLEventHandlers['onComplete'] = () => {\n\t\tthis.complete()\n\t}\n\n\toverride onInterrupt = () => {\n\t\tthis.parent.transition('idle', {})\n\t}\n\n\tprivate complete() {\n\t\tconst { shiftKey } = this.app.inputs\n\t\tif (!shiftKey) {\n\t\t\tthis.app.selectNone()\n\t\t\tif (!this._clickWasInsideFocusedGroup()) {\n\t\t\t\tthis.app.setFocusLayer(null)\n\t\t\t}\n\t\t}\n\t\tthis.parent.transition('idle', {})\n\t}\n}\n","import { TLArrowShape } from '@tldraw/tlschema'\nimport { TLEventHandlers, TLPointerEventInfo } from '../../../types/event-types'\nimport { StateNode } from '../../StateNode'\n\nexport class PointingHandle extends StateNode {\n\tstatic override id = 'pointing_handle'\n\n\tinfo = {} as TLPointerEventInfo & { target: 'handle' }\n\n\tonEnter = (info: TLPointerEventInfo & { target: 'handle' }) => {\n\t\tthis.info = info\n\n\t\tconst initialTerminal = (info.shape as TLArrowShape).props[info.handle.id as 'start' | 'end']\n\n\t\tif (initialTerminal?.type === 'binding') {\n\t\t\tthis.app.setHintingIds([initialTerminal.boundShapeId])\n\t\t}\n\n\t\tthis.app.setCursor({ type: 'grabbing' })\n\t}\n\n\tonExit = () => {\n\t\tthis.app.setHintingIds([])\n\t\tthis.app.setCursor({ type: 'default' })\n\t}\n\n\tonPointerUp: TLEventHandlers['onPointerUp'] = () => {\n\t\tthis.parent.transition('idle', this.info)\n\t}\n\n\tonPointerMove: TLEventHandlers['onPointerMove'] = () => {\n\t\tif (this.app.inputs.isDragging) {\n\t\t\tthis.parent.transition('dragging_handle', this.info)\n\t\t}\n\t}\n\n\toverride onCancel: TLEventHandlers['onCancel'] = () => {\n\t\tthis.cancel()\n\t}\n\n\toverride onComplete: TLEventHandlers['onComplete'] = () => {\n\t\tthis.cancel()\n\t}\n\n\toverride onInterrupt = () => {\n\t\tthis.cancel()\n\t}\n\n\tprivate cancel() {\n\t\tthis.parent.transition('idle', {})\n\t}\n}\n","import { TLCursorType } from '@tldraw/tlschema'\nimport { TLEventHandlers, TLPointerEventInfo } from '../../../types/event-types'\nimport { TLSelectionHandle } from '../../../types/selection-types'\nimport { StateNode } from '../../StateNode'\n\nexport const CursorTypeMap: Record<TLSelectionHandle, TLCursorType> = {\n\tbottom: 'ns-resize',\n\ttop: 'ns-resize',\n\tleft: 'ew-resize',\n\tright: 'ew-resize',\n\tbottom_left: 'nesw-resize',\n\tbottom_right: 'nwse-resize',\n\ttop_left: 'nwse-resize',\n\ttop_right: 'nesw-resize',\n\tbottom_left_rotate: 'swne-rotate',\n\tbottom_right_rotate: 'senw-rotate',\n\ttop_left_rotate: 'nwse-rotate',\n\ttop_right_rotate: 'nesw-rotate',\n\tmobile_rotate: 'grabbing',\n}\n\ntype TLPointingResizeHandleInfo = Extract<\n\tTLPointerEventInfo,\n\t{\n\t\ttarget: 'selection'\n\t}\n>\n\nexport class PointingResizeHandle extends StateNode {\n\tstatic override id = 'pointing_resize_handle'\n\n\tprivate info = {} as TLPointingResizeHandleInfo\n\n\tprivate updateCursor() {\n\t\tconst selected = this.app.selectedShapes\n\t\tconst cursorType = CursorTypeMap[this.info.handle!]\n\t\tthis.app.setCursor({\n\t\t\ttype: cursorType,\n\t\t\trotation: selected.length === 1 ? selected[0].rotation : 0,\n\t\t})\n\t}\n\n\toverride onEnter = (info: TLPointingResizeHandleInfo) => {\n\t\tthis.info = info\n\t\tthis.updateCursor()\n\t}\n\n\toverride onPointerMove: TLEventHandlers['onPointerMove'] = () => {\n\t\tconst isDragging = this.app.inputs.isDragging\n\n\t\tif (isDragging) {\n\t\t\tthis.parent.transition('resizing', this.info)\n\t\t}\n\t}\n\n\toverride onPointerUp: TLEventHandlers['onPointerUp'] = () => {\n\t\tthis.parent.transition('idle', {})\n\t}\n\n\t// override onPinchStart: TLEventHandlers['onPinchStart'] = (info) => {\n\t// \tthis.parent.transition('pinching', info)\n\t// }\n\n\toverride onCancel: TLEventHandlers['onCancel'] = () => {\n\t\tthis.cancel()\n\t}\n\n\toverride onComplete: TLEventHandlers['onComplete'] = () => {\n\t\tthis.cancel()\n\t}\n\n\toverride onInterrupt = () => {\n\t\tthis.cancel()\n\t}\n\n\tprivate cancel() {\n\t\tthis.parent.transition('idle', {})\n\t}\n}\n","import { RotateCorner } from '@tldraw/primitives'\nimport { TLEventHandlers, TLPointerEventInfo } from '../../../types/event-types'\nimport { StateNode } from '../../StateNode'\nimport { CursorTypeMap } from './PointingResizeHandle'\n\nexport class PointingRotateHandle extends StateNode {\n\tstatic override id = 'pointing_rotate_handle'\n\n\tprivate info = {} as Extract<TLPointerEventInfo, { target: 'selection' }>\n\n\tprivate updateCursor() {\n\t\tconst { selectionRotation } = this.app\n\t\tthis.app.setCursor({\n\t\t\ttype: CursorTypeMap[this.info.handle as RotateCorner],\n\t\t\trotation: selectionRotation,\n\t\t})\n\t}\n\n\toverride onEnter = (info: Extract<TLPointerEventInfo, { target: 'selection' }>) => {\n\t\tthis.info = info\n\t\tthis.updateCursor()\n\t}\n\n\toverride onPointerMove = () => {\n\t\tconst { isDragging } = this.app.inputs\n\n\t\tif (isDragging) {\n\t\t\tthis.parent.transition('rotating', this.info)\n\t\t}\n\t}\n\n\toverride onPointerUp = () => {\n\t\tthis.parent.transition('idle', this.info)\n\t}\n\n\toverride onCancel: TLEventHandlers['onCancel'] = () => {\n\t\tthis.cancel()\n\t}\n\n\toverride onComplete: TLEventHandlers['onComplete'] = () => {\n\t\tthis.cancel()\n\t}\n\n\toverride onInterrupt = () => {\n\t\tthis.cancel()\n\t}\n\n\tprivate cancel() {\n\t\tthis.parent.transition('idle', {})\n\t}\n}\n","import { TLEventHandlers, TLPointerEventInfo } from '../../../types/event-types'\nimport { StateNode } from '../../StateNode'\n\nexport class PointingSelection extends StateNode {\n\tstatic override id = 'pointing_selection'\n\n\tinfo = {} as TLPointerEventInfo & {\n\t\ttarget: 'selection'\n\t}\n\n\tonEnter = (info: TLPointerEventInfo & { target: 'selection' }) => {\n\t\tthis.info = info\n\t}\n\n\tonPointerUp: TLEventHandlers['onPointerUp'] = (info) => {\n\t\tthis.app.selectNone()\n\t\tthis.parent.transition('idle', info)\n\t}\n\n\tonPointerMove: TLEventHandlers['onPointerMove'] = (info) => {\n\t\tif (this.app.inputs.isDragging) {\n\t\t\tif (this.app.isReadOnly) return\n\t\t\tthis.parent.transition('translating', info)\n\t\t}\n\t}\n\n\toverride onCancel: TLEventHandlers['onCancel'] = () => {\n\t\tthis.cancel()\n\t}\n\n\toverride onComplete: TLEventHandlers['onComplete'] = () => {\n\t\tthis.cancel()\n\t}\n\n\toverride onInterrupt = () => {\n\t\tthis.cancel()\n\t}\n\n\tprivate cancel() {\n\t\tthis.parent.transition('idle', {})\n\t}\n}\n","import { TLShape } from '@tldraw/tlschema'\nimport { TLEventHandlers, TLPointerEventInfo } from '../../../types/event-types'\nimport { StateNode } from '../../StateNode'\n\nexport class PointingShape extends StateNode {\n\tstatic override id = 'pointing_shape'\n\n\teventTargetShape = {} as TLShape\n\tselectingShape = {} as TLShape\n\n\tdidSelectOnEnter = false\n\n\tonEnter = (info: TLPointerEventInfo & { target: 'shape' }) => {\n\t\tconst { shape } = info\n\n\t\tif (shape) {\n\t\t\t// If a shape has a click handler, then don't do anything here;\n\t\t\t// we're run its click handler on pointer up.\n\t\t\tconst util = this.app.getShapeUtil(shape)\n\t\t\tif (util.onClick !== undefined) return\n\t\t}\n\n\t\tthis.eventTargetShape = info.shape\n\t\tthis.selectingShape = this.app.getOutermostSelectableShape(info.shape)\n\n\t\tif (this.selectingShape.id === this.app.focusLayerId) {\n\t\t\tthis.didSelectOnEnter = false\n\t\t\treturn\n\t\t}\n\n\t\tconst isSelected = this.app.isWithinSelection(this.selectingShape.id)\n\n\t\tconst isBehindSelectionBounds =\n\t\t\tthis.app.selectedIds.length > 1 && // only on 2+ selected shapes!\n\t\t\tthis.app.selectionBounds?.containsPoint(this.app.inputs.currentPagePoint)\n\n\t\tthis.didSelectOnEnter =\n\t\t\t!isSelected && this.selectingShape.id !== this.app.focusLayerId && !isBehindSelectionBounds\n\n\t\tif (this.didSelectOnEnter) {\n\t\t\tconst { inputs, selectedIds } = this.app\n\n\t\t\tconst parent = this.app.getParentShape(info.shape)\n\n\t\t\tif (parent && parent.type === 'group') {\n\t\t\t\tthis.app.cancelDoubleClick()\n\t\t\t}\n\n\t\t\tif (inputs.shiftKey && !inputs.altKey) {\n\t\t\t\tif (!selectedIds.includes(this.selectingShape.id)) {\n\t\t\t\t\tthis.app.mark('shift selecting shape')\n\t\t\t\t\tthis.app.setSelectedIds([...selectedIds, this.selectingShape.id])\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.app.mark('selecting shape')\n\t\t\t\tthis.app.setSelectedIds([this.selectingShape.id])\n\t\t\t}\n\t\t}\n\t}\n\n\tonPointerUp: TLEventHandlers['onPointerUp'] = (info) => {\n\t\tconst { shape } = info\n\n\t\tif (shape) {\n\t\t\tconst util = this.app.getShapeUtil(shape)\n\t\t\tif (util.onClick) {\n\t\t\t\tconst change = util.onClick?.(shape)\n\t\t\t\tif (change) {\n\t\t\t\t\tthis.app.updateShapes([change])\n\t\t\t\t}\n\t\t\t\treturn\n\t\t\t}\n\t\t}\n\n\t\tif (!this.didSelectOnEnter && this.selectingShape.id !== this.app.focusLayerId) {\n\t\t\tthis.app.mark('selecting shape (pointer up)')\n\t\t\t// if the shape has an ancestor which is a focusable layer and it is not focused but it is selected\n\t\t\t// then we should focus the layer and select the shape\n\n\t\t\tconst targetShape = this.app.getOutermostSelectableShape(\n\t\t\t\tthis.eventTargetShape,\n\t\t\t\t// if a group is selected, we want to stop before reaching that group\n\t\t\t\t// so we can drill down into the group\n\t\t\t\t(parent) => !this.app.isSelected(parent.id)\n\t\t\t)\n\n\t\t\tif (this.app.selectedIds.includes(targetShape.id)) {\n\t\t\t\t// same shape, so deselect it if shift is pressed, otherwise deselect all others\n\t\t\t\tthis.app.setSelectedIds(\n\t\t\t\t\tthis.app.inputs.shiftKey\n\t\t\t\t\t\t? this.app.selectedIds.filter((id) => id !== this.selectingShape.id)\n\t\t\t\t\t\t: [this.selectingShape.id]\n\t\t\t\t)\n\t\t\t} else if (this.app.inputs.shiftKey) {\n\t\t\t\t// Different shape, so we are drilling down into a group with shift key held.\n\t\t\t\t// Deselect any ancestors and add the target shape to the selection\n\t\t\t\tconst ancestors = this.app.getAncestors(targetShape)\n\n\t\t\t\tthis.app.setSelectedIds([\n\t\t\t\t\t...this.app.selectedIds.filter((id) => !ancestors.find((a) => a.id === id)),\n\t\t\t\t\ttargetShape.id,\n\t\t\t\t])\n\t\t\t} else {\n\t\t\t\t// different shape and we are drilling down, but no shift held so just select it straight up\n\t\t\t\tthis.app.setSelectedIds([targetShape.id])\n\t\t\t}\n\t\t} else if (this.selectingShape.id === this.app.focusLayerId) {\n\t\t\t// clicking the 'background' of a focused group should deselect. equivalent to a click on the canvas\n\t\t\tif (this.app.selectedIds.length > 0) {\n\t\t\t\tthis.app.setSelectedIds([])\n\t\t\t} else {\n\t\t\t\tthis.app.popFocusLayer()\n\t\t\t}\n\t\t}\n\n\t\tthis.parent.transition('idle', info)\n\t}\n\n\tonPointerMove: TLEventHandlers['onPointerMove'] = (info) => {\n\t\tif (this.app.inputs.isDragging) {\n\t\t\tif (this.app.isReadOnly) return\n\t\t\tthis.parent.transition('translating', info)\n\t\t}\n\t}\n\n\toverride onCancel: TLEventHandlers['onCancel'] = () => {\n\t\tthis.cancel()\n\t}\n\n\toverride onComplete: TLEventHandlers['onComplete'] = () => {\n\t\tthis.cancel()\n\t}\n\n\toverride onInterrupt = () => {\n\t\tthis.cancel()\n\t}\n\n\tprivate cancel() {\n\t\tthis.parent.transition('idle', {})\n\t}\n}\n","import {\n\tareAnglesCompatible,\n\tMatrix2d,\n\tPI,\n\tPI2,\n\tSelectionCorner,\n\tSelectionEdge,\n\tTAU,\n\tVec2d,\n\tVecLike,\n} from '@tldraw/primitives'\nimport { TLShape, TLShapeId, TLShapePartial } from '@tldraw/tlschema'\nimport { TLEventHandlers, TLPointerEventInfo, UiEnterHandler } from '../../../types/event-types'\nimport { StateNode } from '../../StateNode'\n\ntype TLResizingInfo = TLPointerEventInfo & {\n\ttarget: 'selection'\n\thandle: SelectionEdge | SelectionCorner\n}\n\nexport class Resizing extends StateNode {\n\tstatic override id = 'resizing'\n\n\tinfo = {} as TLResizingInfo & {\n\t\tisCreating?: boolean\n\t\teditAfterComplete?: boolean\n\t\tcreationCursorOffset?: VecLike\n\t\tonInteractionEnd?: string\n\t}\n\n\tmarkId = ''\n\n\t// we transition into the resizing state from the geo pointing state, which starts with a shape of size w: 1, h: 1,\n\t// so if the user drags x: +50, y: +50 after mouseDown, the shape will be w: 51, h: 51, which is too many pixels, alas\n\t// so we allow passing a further offset into this state to negate such issues\n\tcreationCursorOffset = { x: 0, y: 0 } as VecLike\n\teditAfterComplete = false\n\n\tprivate snapshot = {} as any as Snapshot\n\n\tonEnter: UiEnterHandler = (\n\t\tinfo: TLResizingInfo & {\n\t\t\tisCreating?: boolean\n\t\t\teditAfterComplete?: boolean\n\t\t\tcreationCursorOffset?: VecLike\n\t\t\tonInteractionEnd?: string\n\t\t}\n\t) => {\n\t\tconst {\n\t\t\tisCreating = false,\n\t\t\teditAfterComplete = false,\n\t\t\tcreationCursorOffset = { x: 0, y: 0 },\n\t\t} = info\n\n\t\tthis.info = info\n\t\tthis.editAfterComplete = editAfterComplete\n\t\tthis.creationCursorOffset = creationCursorOffset\n\n\t\tif (info.isCreating) {\n\t\t\tthis.app.setCursor({ type: 'cross', rotation: 0 })\n\t\t}\n\n\t\tthis.snapshot = this._createSnapshot()\n\t\tthis.markId = isCreating ? 'creating' : this.app.mark('starting resizing')\n\n\t\tthis.handleResizeStart()\n\t\tthis.updateShapes()\n\t}\n\n\tonPointerMove: TLEventHandlers['onPointerMove'] = () => {\n\t\tthis.updateShapes()\n\t}\n\n\tonKeyDown: TLEventHandlers['onKeyDown'] = () => {\n\t\tthis.updateShapes()\n\t}\n\tonKeyUp: TLEventHandlers['onKeyUp'] = () => {\n\t\tthis.updateShapes()\n\t}\n\n\tonPointerUp: TLEventHandlers['onPointerUp'] = () => {\n\t\tthis.complete()\n\t}\n\n\tonComplete: TLEventHandlers['onComplete'] = () => {\n\t\tthis.complete()\n\t}\n\n\tonCancel: TLEventHandlers['onCancel'] = () => {\n\t\tthis.cancel()\n\t}\n\n\tprivate cancel() {\n\t\t// Restore initial models\n\t\tthis.app.bailToMark(this.markId)\n\t\tif (this.info.onInteractionEnd) {\n\t\t\tthis.app.setSelectedTool(this.info.onInteractionEnd)\n\t\t} else {\n\t\t\tthis.parent.transition('idle', {})\n\t\t}\n\t}\n\n\tprivate complete() {\n\t\tthis.handleResizeEnd()\n\n\t\tif (this.editAfterComplete && this.app.onlySelectedShape) {\n\t\t\tthis.app.setEditingId(this.app.onlySelectedShape.id)\n\t\t\tthis.app.setSelectedTool('select')\n\t\t\tthis.app.root.current.value!.transition('editing_shape', {})\n\t\t\treturn\n\t\t}\n\n\t\tif (this.app.instanceState.isToolLocked && this.info.onInteractionEnd) {\n\t\t\tthis.app.setSelectedTool(this.info.onInteractionEnd)\n\t\t\treturn\n\t\t}\n\n\t\tthis.parent.transition('idle', {})\n\t}\n\n\tprivate handleResizeStart() {\n\t\tconst { shapeSnapshots } = this.snapshot\n\n\t\tconst changes: TLShapePartial[] = []\n\n\t\tshapeSnapshots.forEach(({ shape }) => {\n\t\t\tconst util = this.app.getShapeUtil(shape)\n\t\t\tconst change = util.onResizeStart?.(shape)\n\t\t\tif (change) {\n\t\t\t\tchanges.push(change)\n\t\t\t}\n\t\t})\n\n\t\tif (changes.length > 0) {\n\t\t\tthis.app.updateShapes(changes)\n\t\t}\n\t}\n\n\tprivate handleResizeEnd() {\n\t\tconst { shapeSnapshots } = this.snapshot\n\n\t\tconst changes: TLShapePartial[] = []\n\n\t\tshapeSnapshots.forEach(({ shape }) => {\n\t\t\tconst current = this.app.getShapeById(shape.id)!\n\t\t\tconst util = this.app.getShapeUtil(shape)\n\t\t\tconst change = util.onResizeEnd?.(shape, current)\n\t\t\tif (change) {\n\t\t\t\tchanges.push(change)\n\t\t\t}\n\t\t})\n\n\t\tif (changes.length > 0) {\n\t\t\tthis.app.updateShapes(changes)\n\t\t}\n\t}\n\n\tprivate updateShapes() {\n\t\tconst { altKey, shiftKey } = this.app.inputs\n\t\tconst {\n\t\t\tshapeSnapshots,\n\t\t\tselectionBounds,\n\t\t\tcursorHandleOffset,\n\t\t\tselectedIds,\n\t\t\tselectionRotation,\n\t\t\tcanShapesDeform,\n\t\t} = this.snapshot\n\n\t\tconst isAspectRatioLocked = shiftKey || !canShapesDeform\n\n\t\t// first negate the 'cursor handle offset'\n\t\t// we need to do this because we do grid snapping based on the page point of the handle\n\t\t// rather than the page point of the cursor, so it's easier to pretend that the cursor\n\t\t// is really where the handle actually is\n\t\t//\n\t\t// *** Massively zoomed-in diagram of the initial mouseDown ***\n\t\t//\n\t\t//\n\t\t//                         \n\t\t//                         \n\t\t//                         \n\t\t//                         \n\t\t//                         \n\t\t//                         \n\t\t//                         \n\t\t//                         corner handle\n\t\t//                     \n\t\t//   selection                \n\t\t//     x drag handle point   \n\t\t//                                                     \n\t\t//                                               cursorHandleOffset.y\n\t\t//                                                       \n\t\t//        originPagePointx                     \n\t\t//                                \n\t\t//                                  \n\t\t//                                     mouse (sorry)\n\t\t//                                \n\t\t//                                   \n\t\t//                                  \n\t\t//                         \n\t\t//                            \n\t\t//                   cursorHandleOffset.x\n\n\t\tconst { ctrlKey } = this.app.inputs\n\n\t\tconst currentPagePoint = this.app.inputs.currentPagePoint\n\t\t\t.clone()\n\t\t\t.sub(cursorHandleOffset)\n\t\t\t.sub(this.creationCursorOffset)\n\t\tconst originPagePoint = this.app.inputs.originPagePoint.clone().sub(cursorHandleOffset)\n\n\t\tif (this.app.isGridMode && !ctrlKey) {\n\t\t\tcurrentPagePoint.snapToGrid(this.app.gridSize)\n\t\t}\n\n\t\tconst dragHandle = this.info.handle as SelectionCorner | SelectionEdge\n\t\tconst scaleOriginHandle = rotateSelectionHandle(dragHandle, Math.PI)\n\n\t\tthis.app.snaps.clear()\n\n\t\tconst shouldSnap = this.app.userDocumentSettings.isSnapMode ? !ctrlKey : ctrlKey\n\n\t\tif (shouldSnap && selectionRotation % TAU === 0) {\n\t\t\tconst { nudge } = this.app.snaps.snapResize({\n\t\t\t\tdragDelta: Vec2d.Sub(currentPagePoint, originPagePoint),\n\t\t\t\tinitialSelectionPageBounds: this.snapshot.initialSelectionPageBounds,\n\t\t\t\thandle: rotateSelectionHandle(dragHandle, selectionRotation),\n\t\t\t\tisAspectRatioLocked,\n\t\t\t\tisResizingFromCenter: altKey,\n\t\t\t})\n\n\t\t\tcurrentPagePoint.add(nudge)\n\t\t}\n\n\t\t// get the page point of the selection handle opposite to the drag handle\n\t\t// or the center of the selection box if altKey is pressed\n\t\tconst scaleOriginPage = Vec2d.RotWith(\n\t\t\taltKey ? selectionBounds.center : selectionBounds.getHandlePoint(scaleOriginHandle),\n\t\t\tselectionBounds.point,\n\t\t\tselectionRotation\n\t\t)\n\n\t\t// calculate the scale by measuring the current distance between the drag handle and the scale origin\n\t\t// and dividing by the original distance between the drag handle and the scale origin\n\n\t\tconst distanceFromScaleOriginNow = Vec2d.Sub(currentPagePoint, scaleOriginPage).rot(\n\t\t\t-selectionRotation\n\t\t)\n\n\t\tconst distanceFromScaleOriginAtStart = Vec2d.Sub(originPagePoint, scaleOriginPage).rot(\n\t\t\t-selectionRotation\n\t\t)\n\n\t\tconst scale = Vec2d.DivV(distanceFromScaleOriginNow, distanceFromScaleOriginAtStart)\n\n\t\tif (!Number.isFinite(scale.x)) scale.x = 1\n\t\tif (!Number.isFinite(scale.y)) scale.y = 1\n\n\t\tconst isXLocked = dragHandle === 'top' || dragHandle === 'bottom'\n\t\tconst isYLocked = dragHandle === 'left' || dragHandle === 'right'\n\n\t\t// lock an axis if required\n\t\tif (isAspectRatioLocked) {\n\t\t\tif (isYLocked) {\n\t\t\t\t// holding shift and dragging either the left or the right edge\n\t\t\t\tscale.y = Math.abs(scale.x)\n\t\t\t} else if (isXLocked) {\n\t\t\t\t// holding shift and dragging either the top or the bottom edge\n\t\t\t\tscale.x = Math.abs(scale.y)\n\t\t\t} else if (Math.abs(scale.x) > Math.abs(scale.y)) {\n\t\t\t\t// holding shift and the drag has moved further in the x dimension\n\t\t\t\tscale.y = Math.abs(scale.x) * (scale.y < 0 ? -1 : 1)\n\t\t\t} else {\n\t\t\t\t// holding shift and the drag has moved further in the y dimension\n\t\t\t\tscale.x = Math.abs(scale.y) * (scale.x < 0 ? -1 : 1)\n\t\t\t}\n\t\t} else {\n\t\t\t// not holding shift, but still need to lock axes if dragging an edge\n\t\t\tif (isXLocked) {\n\t\t\t\tscale.x = 1\n\t\t\t}\n\t\t\tif (isYLocked) {\n\t\t\t\tscale.y = 1\n\t\t\t}\n\t\t}\n\n\t\tif (!this.info.isCreating) {\n\t\t\tthis.updateCursor({\n\t\t\t\tdragHandle,\n\t\t\t\tisFlippedX: scale.x < 0,\n\t\t\t\tisFlippedY: scale.y < 0,\n\t\t\t\trotation: selectionRotation,\n\t\t\t})\n\t\t}\n\n\t\tfor (const id of shapeSnapshots.keys()) {\n\t\t\tconst snapshot = shapeSnapshots.get(id)!\n\t\t\tthis.app.resizeShape(id, scale, {\n\t\t\t\tinitialBounds: snapshot.bounds,\n\t\t\t\tdragHandle,\n\t\t\t\tinitialPageTransform: snapshot.pageTransform,\n\t\t\t\tinitialShape: snapshot.shape,\n\t\t\t\tmode: selectedIds.length === 1 && id === selectedIds[0] ? 'resize_bounds' : 'scale_shape',\n\t\t\t\tscaleOrigin: scaleOriginPage,\n\t\t\t\tscaleAxisRotation: selectionRotation,\n\t\t\t})\n\t\t}\n\t}\n\n\t// ---\n\n\tprivate updateCursor({\n\t\tdragHandle,\n\t\tisFlippedX,\n\t\tisFlippedY,\n\t\trotation,\n\t}: {\n\t\tdragHandle: SelectionCorner | SelectionEdge\n\t\tisFlippedX: boolean\n\t\tisFlippedY: boolean\n\t\trotation: number\n\t}) {\n\t\tconst nextCursor = { ...this.app.cursor }\n\n\t\tswitch (dragHandle) {\n\t\t\tcase 'top_left':\n\t\t\tcase 'bottom_right': {\n\t\t\t\tnextCursor.type = 'nwse-resize'\n\t\t\t\tif (isFlippedX !== isFlippedY) {\n\t\t\t\t\tnextCursor.type = 'nesw-resize'\n\t\t\t\t}\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tcase 'top_right':\n\t\t\tcase 'bottom_left': {\n\t\t\t\tnextCursor.type = 'nesw-resize'\n\t\t\t\tif (isFlippedX !== isFlippedY) {\n\t\t\t\t\tnextCursor.type = 'nwse-resize'\n\t\t\t\t}\n\t\t\t\tbreak\n\t\t\t}\n\t\t}\n\n\t\tnextCursor.rotation = rotation\n\n\t\tthis.app.setCursor(nextCursor)\n\t}\n\n\tonExit = () => {\n\t\tthis.app.snaps.clear()\n\t}\n\n\t_createSnapshot = () => {\n\t\tconst {\n\t\t\tselectedIds,\n\t\t\tselectionRotation,\n\t\t\tinputs: { originPagePoint },\n\t\t} = this.app\n\n\t\tconst selectionBounds = this.app.selectionBounds!\n\n\t\tconst dragHandlePoint = Vec2d.RotWith(\n\t\t\tselectionBounds.getHandlePoint(this.info.handle!),\n\t\t\tselectionBounds.point,\n\t\t\tselectionRotation\n\t\t)\n\n\t\tconst cursorHandleOffset = Vec2d.Sub(originPagePoint, dragHandlePoint)\n\n\t\tconst shapeSnapshots = new Map<TLShapeId, ShapeSnapshot>()\n\n\t\tselectedIds.forEach((id) => {\n\t\t\tconst shape = this.app.getShapeById(id)\n\t\t\tif (shape) {\n\t\t\t\tshapeSnapshots.set(shape.id, this._createShapeSnapshot(shape))\n\t\t\t\tif (shape.type === 'frame' && selectedIds.length === 1) return\n\t\t\t\tthis.app.visitDescendants(shape.id, (descendantId) => {\n\t\t\t\t\tconst descendent = this.app.getShapeById(descendantId)\n\t\t\t\t\tif (descendent) {\n\t\t\t\t\t\tshapeSnapshots.set(descendent.id, this._createShapeSnapshot(descendent))\n\t\t\t\t\t\tif (descendent.type === 'frame') {\n\t\t\t\t\t\t\treturn false\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\t\t})\n\n\t\tconst canShapesDeform = ![...shapeSnapshots.values()].some(\n\t\t\t(shape) =>\n\t\t\t\t!areAnglesCompatible(shape.pageRotation, selectionRotation) || shape.isAspectRatioLocked\n\t\t)\n\n\t\treturn {\n\t\t\tshapeSnapshots,\n\t\t\tselectionBounds,\n\t\t\tcursorHandleOffset,\n\t\t\tselectionRotation,\n\t\t\tselectedIds,\n\t\t\tcanShapesDeform,\n\t\t\tinitialSelectionPageBounds: this.app.selectedPageBounds!,\n\t\t}\n\t}\n\n\t_createShapeSnapshot = (shape: TLShape) => {\n\t\tconst pageTransform = this.app.getPageTransform(shape)!\n\t\tconst util = this.app.getShapeUtil(shape)\n\n\t\treturn {\n\t\t\tshape,\n\t\t\tbounds: util.bounds(shape),\n\t\t\tpageTransform,\n\t\t\tpageRotation: Matrix2d.Decompose(pageTransform!).rotation,\n\t\t\tisAspectRatioLocked: util.isAspectRatioLocked(shape),\n\t\t}\n\t}\n}\n\ntype Snapshot = ReturnType<Resizing['_createSnapshot']>\ntype ShapeSnapshot = ReturnType<Resizing['_createShapeSnapshot']>\n\nconst ORDERED_SELECTION_HANDLES: (SelectionEdge | SelectionCorner)[] = [\n\t'top',\n\t'top_right',\n\t'right',\n\t'bottom_right',\n\t'bottom',\n\t'bottom_left',\n\t'left',\n\t'top_left',\n]\n\nexport function rotateSelectionHandle(handle: SelectionEdge | SelectionCorner, rotation: number) {\n\t// first find out how many tau we need to rotate by\n\trotation = rotation % PI2\n\tconst numSteps = Math.round(rotation / (PI / 4))\n\n\tconst currentIndex = ORDERED_SELECTION_HANDLES.indexOf(handle)\n\treturn ORDERED_SELECTION_HANDLES[(currentIndex + numSteps) % ORDERED_SELECTION_HANDLES.length]\n}\n","import { angleDelta, degreesToRadians, EPSILON, RotateCorner, snapAngle } from '@tldraw/primitives'\nimport {\n\tapplyRotationToSnapshotShapes,\n\tgetRotationSnapshot,\n\tRotationSnapshot,\n} from '../../../../utils'\nimport { TLEventHandlers, TLPointerEventInfo } from '../../../types/event-types'\nimport { StateNode } from '../../StateNode'\nimport { CursorTypeMap } from './PointingResizeHandle'\n\nexport class Rotating extends StateNode {\n\tstatic override id = 'rotating'\n\n\tsnapshot = {} as RotationSnapshot\n\n\tinfo = {} as Extract<TLPointerEventInfo, { target: 'selection' }>\n\n\tmarkId = ''\n\n\toverride onEnter = (info: Extract<TLPointerEventInfo, { target: 'selection' }>) => {\n\t\t// Store the event information\n\t\tthis.info = info\n\n\t\tthis.markId = this.app.mark('rotate start')\n\n\t\tthis.snapshot = getRotationSnapshot({ app: this.app })\n\n\t\t// Trigger a pointer move\n\t\tthis.handleStart()\n\t}\n\n\toverride onExit = () => {\n\t\tthis.app.setCursor({ type: 'none' })\n\n\t\tthis.snapshot = {} as RotationSnapshot\n\t}\n\n\toverride onPointerMove = () => {\n\t\tthis.update()\n\t}\n\n\toverride onKeyDown = () => {\n\t\tthis.update()\n\t}\n\n\toverride onKeyUp = () => {\n\t\tthis.update()\n\t}\n\n\toverride onPointerUp: TLEventHandlers['onPointerUp'] = () => {\n\t\tthis.complete()\n\t}\n\n\toverride onComplete: TLEventHandlers['onComplete'] = () => {\n\t\tthis.complete()\n\t}\n\n\toverride onCancel = () => {\n\t\tthis.app.bailToMark(this.markId)\n\t\tthis.parent.transition('idle', this.info)\n\t}\n\n\t// ---\n\n\tprivate update = () => {\n\t\tconst newSelectionRotation = this._getRotationFromPointerPosition({\n\t\t\tsnapToNearestDegree: false,\n\t\t})\n\n\t\tapplyRotationToSnapshotShapes({\n\t\t\tapp: this.app,\n\t\t\tdelta: newSelectionRotation,\n\t\t\tsnapshot: this.snapshot,\n\t\t\tstage: 'update',\n\t\t})\n\n\t\t// Update cursor\n\t\tthis.app.setCursor({\n\t\t\ttype: CursorTypeMap[this.info.handle as RotateCorner],\n\t\t\trotation: newSelectionRotation + this.snapshot.initialSelectionRotation,\n\t\t})\n\t}\n\n\tprivate complete = () => {\n\t\tapplyRotationToSnapshotShapes({\n\t\t\tapp: this.app,\n\t\t\tdelta: this._getRotationFromPointerPosition({ snapToNearestDegree: true }),\n\t\t\tsnapshot: this.snapshot,\n\t\t\tstage: 'end',\n\t\t})\n\t\tthis.parent.transition('idle', this.info)\n\t}\n\n\tprotected handleStart() {\n\t\tconst newSelectionRotation = this._getRotationFromPointerPosition({\n\t\t\tsnapToNearestDegree: false,\n\t\t})\n\n\t\tapplyRotationToSnapshotShapes({\n\t\t\tapp: this.app,\n\t\t\tdelta: this._getRotationFromPointerPosition({ snapToNearestDegree: false }),\n\t\t\tsnapshot: this.snapshot,\n\t\t\tstage: 'start',\n\t\t})\n\n\t\t// Update cursor\n\t\tthis.app.setCursor({\n\t\t\ttype: CursorTypeMap[this.info.handle as RotateCorner],\n\t\t\trotation: newSelectionRotation + this.snapshot.initialSelectionRotation,\n\t\t})\n\t}\n\n\t_getRotationFromPointerPosition({ snapToNearestDegree }: { snapToNearestDegree: boolean }) {\n\t\tconst {\n\t\t\tselectionPageCenter,\n\t\t\tinputs: { shiftKey, currentPagePoint },\n\t\t} = this.app\n\t\tconst { initialCursorAngle, initialSelectionRotation } = this.snapshot\n\n\t\t// The delta is the difference between the current angle and the initial angle\n\t\tconst preSnapRotationDelta = selectionPageCenter!.angle(currentPagePoint) - initialCursorAngle\n\t\tlet newSelectionRotation = initialSelectionRotation + preSnapRotationDelta\n\n\t\tif (shiftKey) {\n\t\t\tnewSelectionRotation = snapAngle(newSelectionRotation, 24)\n\t\t} else if (snapToNearestDegree) {\n\t\t\tnewSelectionRotation = Math.round(newSelectionRotation / EPSILON) * EPSILON\n\n\t\t\tif (this.app.isCoarsePointer) {\n\t\t\t\tconst snappedToRightAngle = snapAngle(newSelectionRotation, 4)\n\t\t\t\tconst angleToRightAngle = angleDelta(newSelectionRotation, snappedToRightAngle)\n\t\t\t\tif (Math.abs(angleToRightAngle) < degreesToRadians(5)) {\n\t\t\t\t\tnewSelectionRotation = snappedToRightAngle\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn newSelectionRotation - initialSelectionRotation\n\t}\n}\n","import { intersectLineSegmentPolyline, pointInPolygon } from '@tldraw/primitives'\nimport { TLScribble, TLShape, TLShapeId } from '@tldraw/tlschema'\nimport { ScribbleManager } from '../../../managers/ScribbleManager'\nimport { TLShapeUtil } from '../../../shapeutils'\nimport { TLEventHandlers } from '../../../types/event-types'\nimport { StateNode } from '../../StateNode'\n\nexport class ScribbleBrushing extends StateNode {\n\tstatic override id = 'scribble_brushing'\n\n\tstatic canActivateInReadOnly = true\n\n\thits = new Set<TLShapeId>()\n\n\tsize = 0\n\n\tscribble = {} as ScribbleManager\n\n\tinitialSelectedIds = new Set<TLShapeId>()\n\tnewlySelectedIds = new Set<TLShapeId>()\n\n\toverride onEnter = () => {\n\t\tthis.initialSelectedIds = new Set<TLShapeId>(\n\t\t\tthis.app.inputs.shiftKey ? this.app.selectedIds : []\n\t\t)\n\t\tthis.newlySelectedIds = new Set<TLShapeId>()\n\t\tthis.size = 0\n\t\tthis.hits.clear()\n\n\t\tthis.startScribble()\n\n\t\tthis.updateBrushSelection()\n\t\trequestAnimationFrame(() => {\n\t\t\tthis.app.setBrush(null)\n\t\t})\n\t}\n\n\toverride onExit = () => {\n\t\tthis.app.setErasingIds([])\n\t\tthis.scribble.stop()\n\t}\n\n\toverride onPointerMove = () => {\n\t\tthis.updateBrushSelection()\n\t}\n\n\toverride onPointerUp = () => {\n\t\tthis.complete()\n\t}\n\n\toverride onKeyDown = () => {\n\t\tthis.updateBrushSelection()\n\t}\n\n\toverride onKeyUp = () => {\n\t\tif (!this.app.inputs.altKey) {\n\t\t\tthis.parent.transition('brushing', {})\n\t\t} else {\n\t\t\tthis.updateBrushSelection()\n\t\t}\n\t}\n\n\tprivate startScribble = () => {\n\t\tthis.scribble = new ScribbleManager({\n\t\t\tonUpdate: this.onScribbleUpdate,\n\t\t\tonComplete: this.onScribbleComplete,\n\t\t\tcolor: 'selection-stroke',\n\t\t\topacity: 0.32,\n\t\t\tsize: 12,\n\t\t})\n\n\t\tthis.app.on('tick', this.scribble.tick)\n\t}\n\n\tprivate pushPointToScribble = () => {\n\t\tconst { x, y } = this.app.inputs.currentPagePoint\n\t\tthis.scribble.addPoint(x, y)\n\t}\n\n\tprivate onScribbleUpdate = (scribble: TLScribble) => {\n\t\tthis.app.setScribble(scribble)\n\t}\n\n\tprivate onScribbleComplete = () => {\n\t\tthis.app.off('tick', this.scribble.tick)\n\t\tthis.app.setScribble(null)\n\t}\n\n\tprivate updateBrushSelection() {\n\t\tconst {\n\t\t\tshapesArray,\n\t\t\tinputs: { originPagePoint, previousPagePoint, currentPagePoint },\n\t\t} = this.app\n\n\t\tthis.pushPointToScribble()\n\n\t\tconst shapes = shapesArray\n\t\tlet shape: TLShape, util: TLShapeUtil<TLShape>\n\n\t\tfor (let i = 0, n = shapes.length; i < n; i++) {\n\t\t\tshape = shapes[i]\n\t\t\tutil = this.app.getShapeUtil(shape)\n\n\t\t\tif (\n\t\t\t\tshape.type === 'group' ||\n\t\t\t\tthis.newlySelectedIds.has(shape.id) ||\n\t\t\t\t(shape.type === 'frame' &&\n\t\t\t\t\tutil.hitTestPoint(shape, this.app.getPointInShapeSpace(shape, originPagePoint)))\n\t\t\t) {\n\t\t\t\tcontinue\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tutil.hitTestLineSegment(\n\t\t\t\t\tshape,\n\t\t\t\t\tthis.app.getPointInShapeSpace(shape, previousPagePoint),\n\t\t\t\t\tthis.app.getPointInShapeSpace(shape, currentPagePoint)\n\t\t\t\t)\n\t\t\t) {\n\t\t\t\tconst outermostShape = this.app.getOutermostSelectableShape(shape)\n\n\t\t\t\tconst pageMask = this.app.getPageMaskById(outermostShape.id)\n\n\t\t\t\tif (pageMask) {\n\t\t\t\t\tconst intersection = intersectLineSegmentPolyline(\n\t\t\t\t\t\tpreviousPagePoint,\n\t\t\t\t\t\tcurrentPagePoint,\n\t\t\t\t\t\tpageMask\n\t\t\t\t\t)\n\n\t\t\t\t\tif (intersection !== null) {\n\t\t\t\t\t\tconst isInMask = pointInPolygon(currentPagePoint, pageMask)\n\t\t\t\t\t\tif (!isInMask) continue\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis.newlySelectedIds.add(outermostShape.id)\n\t\t\t}\n\t\t}\n\n\t\tthis.app.setSelectedIds(\n\t\t\t[...new Set<TLShapeId>([...this.newlySelectedIds, ...this.initialSelectedIds])],\n\t\t\ttrue\n\t\t)\n\t}\n\n\toverride onCancel: TLEventHandlers['onCancel'] = () => {\n\t\tthis.cancel()\n\t}\n\n\toverride onComplete: TLEventHandlers['onComplete'] = () => {\n\t\tthis.complete()\n\t}\n\n\tprivate complete() {\n\t\tthis.parent.transition('idle', {})\n\t}\n\n\tprivate cancel() {\n\t\tthis.app.setSelectedIds([...this.initialSelectedIds], true)\n\t\tthis.parent.transition('idle', {})\n\t}\n}\n","import { StateNode } from '../StateNode'\n\nimport { TLStyleType } from '@tldraw/tlschema'\nimport { Translating } from './Translating'\nimport { Brushing } from './children/Brushing'\nimport { DraggingHandle } from './children/DraggingHandle'\nimport { EditingShape } from './children/EditingShape'\nimport { Idle } from './children/Idle'\nimport { PointingCanvas } from './children/PointingCanvas'\nimport { PointingHandle } from './children/PointingHandle'\nimport { PointingResizeHandle } from './children/PointingResizeHandle'\nimport { PointingRotateHandle } from './children/PointingRotateHandle'\nimport { PointingSelection } from './children/PointingSelection'\nimport { PointingShape } from './children/PointingShape'\nimport { Resizing } from './children/Resizing'\nimport { Rotating } from './children/Rotating'\nimport { ScribbleBrushing } from './children/ScribbleBrushing'\n\nexport class TLSelectTool extends StateNode {\n\tstatic override id = 'select'\n\tstatic initial = 'idle'\n\tstatic children = () => [\n\t\tIdle,\n\t\tPointingCanvas,\n\t\tPointingShape,\n\t\tTranslating,\n\t\tBrushing,\n\t\tScribbleBrushing,\n\t\tPointingSelection,\n\t\tPointingResizeHandle,\n\t\tEditingShape,\n\t\tResizing,\n\t\tRotating,\n\t\tPointingRotateHandle,\n\t\tPointingHandle,\n\t\tDraggingHandle,\n\t]\n\n\tstyles = ['color', 'opacity', 'dash', 'fill', 'size'] as TLStyleType[]\n\n\tonExit = () => {\n\t\tif (this.app.pageState.editingId) {\n\t\t\tthis.app.setEditingId(null)\n\t\t}\n\t}\n}\n","import { TLEventHandlers } from '../../../types/event-types'\nimport { StateNode } from '../../StateNode'\n\nexport class Idle extends StateNode {\n\tstatic override id = 'idle'\n\n\tonPointerEnter: TLEventHandlers['onPointerEnter'] = (info) => {\n\t\tswitch (info.target) {\n\t\t\tcase 'canvas': {\n\t\t\t\t// noop\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tcase 'shape': {\n\t\t\t\tconst { selectedIds, focusLayerId } = this.app\n\t\t\t\tconst hoveringShape = this.app.getOutermostSelectableShape(\n\t\t\t\t\tinfo.shape,\n\t\t\t\t\t(parent) => !selectedIds.includes(parent.id)\n\t\t\t\t)\n\t\t\t\tif (hoveringShape.id !== focusLayerId) {\n\t\t\t\t\tif (hoveringShape.type === 'text') {\n\t\t\t\t\t\tthis.app.setHoveredId(hoveringShape.id)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak\n\t\t\t}\n\t\t}\n\t}\n\n\tonPointerLeave: TLEventHandlers['onPointerEnter'] = (info) => {\n\t\tswitch (info.target) {\n\t\t\tcase 'shape': {\n\t\t\t\tthis.app.setHoveredId(null)\n\t\t\t\tbreak\n\t\t\t}\n\t\t}\n\t}\n\n\tonPointerDown: TLEventHandlers['onPointerDown'] = (info) => {\n\t\tconst { hoveredId } = this.app\n\t\tif (hoveredId) {\n\t\t\tconst shape = this.app.getShapeById(hoveredId)!\n\t\t\tif (shape.type === 'text') {\n\t\t\t\trequestAnimationFrame(() => {\n\t\t\t\t\tthis.app.setSelectedIds([shape.id])\n\t\t\t\t\tthis.app.setEditingId(shape.id)\n\t\t\t\t\tthis.app.setSelectedTool('select.editing_shape', {\n\t\t\t\t\t\t...info,\n\t\t\t\t\t\ttarget: 'shape',\n\t\t\t\t\t\tshape,\n\t\t\t\t\t})\n\t\t\t\t})\n\t\t\t\treturn\n\t\t\t}\n\t\t}\n\n\t\tthis.parent.transition('pointing', info)\n\t}\n\n\tonEnter = () => {\n\t\tthis.app.setCursor({ type: 'cross' })\n\t}\n\n\tonKeyDown: TLEventHandlers['onKeyDown'] = (info) => {\n\t\tif (info.key === 'Enter') {\n\t\t\tconst shape = this.app.selectedShapes[0]\n\t\t\tif (shape && shape.type === 'geo') {\n\t\t\t\tthis.app.setSelectedTool('select')\n\t\t\t\tthis.app.setEditingId(shape.id)\n\t\t\t\tthis.app.root.current.value!.transition('editing_shape', {\n\t\t\t\t\t...info,\n\t\t\t\t\ttarget: 'shape',\n\t\t\t\t\tshape,\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\t}\n\n\tonCancel = () => {\n\t\tthis.app.setSelectedTool('select')\n\t}\n}\n","import { createShapeId, TLTextShape } from '@tldraw/tlschema'\nimport { TLEventHandlers } from '../../../types/event-types'\nimport { StateNode } from '../../StateNode'\n\nexport class Pointing extends StateNode {\n\tstatic override id = 'pointing'\n\n\tshape?: TLTextShape\n\n\tonExit = () => {\n\t\tthis.app.setHintingIds([])\n\t}\n\n\tonPointerMove: TLEventHandlers['onPointerMove'] = (info) => {\n\t\tif (this.app.inputs.isDragging) {\n\t\t\tconst {\n\t\t\t\tinputs: { originPagePoint },\n\t\t\t} = this.app\n\n\t\t\tconst id = createShapeId()\n\n\t\t\tthis.app.mark('creating')\n\n\t\t\tthis.app.createShapes([\n\t\t\t\t{\n\t\t\t\t\tid,\n\t\t\t\t\ttype: 'text',\n\t\t\t\t\tx: originPagePoint.x,\n\t\t\t\t\ty: originPagePoint.y,\n\t\t\t\t\tprops: {\n\t\t\t\t\t\ttext: '',\n\t\t\t\t\t\tautoSize: false,\n\t\t\t\t\t\tw: 20,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t])\n\n\t\t\tthis.app.select(id)\n\n\t\t\tthis.shape = this.app.getShapeById(id)\n\t\t\tif (!this.shape) return\n\n\t\t\tthis.app.setSelectedTool('select.resizing', {\n\t\t\t\t...info,\n\t\t\t\ttarget: 'selection',\n\t\t\t\thandle: 'right',\n\t\t\t\tisCreating: true,\n\t\t\t\tcreationCursorOffset: { x: 1, y: 1 },\n\t\t\t\teditAfterComplete: true,\n\t\t\t\tonInteractionEnd: 'text',\n\t\t\t})\n\t\t}\n\t}\n\n\tonPointerUp = () => {\n\t\tthis.complete()\n\t}\n\n\tonComplete = () => {\n\t\tthis.cancel()\n\t}\n\tonCancel = () => {\n\t\tthis.cancel()\n\t}\n\n\tonInterrupt = () => {\n\t\tthis.cancel()\n\t}\n\n\tcomplete() {\n\t\tthis.app.mark('creating text shape')\n\t\tconst id = createShapeId()\n\t\tconst { x, y } = this.app.inputs.currentPagePoint\n\t\tthis.app.createShapes(\n\t\t\t[\n\t\t\t\t{\n\t\t\t\t\tid,\n\t\t\t\t\ttype: 'text',\n\t\t\t\t\tx,\n\t\t\t\t\ty,\n\t\t\t\t\tprops: {\n\t\t\t\t\t\ttext: '',\n\t\t\t\t\t\tautoSize: true,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t\ttrue\n\t\t)\n\n\t\tthis.app.setEditingId(id)\n\t\tthis.app.setSelectedTool('select')\n\t\tthis.app.root.current.value?.transition('editing_shape', {})\n\t}\n\n\tcancel() {\n\t\tthis.parent.transition('idle', {})\n\t\tthis.app.bailToMark('creating')\n\t}\n}\n","import { TLStyleType } from '@tldraw/tlschema'\nimport { StateNode } from '../StateNode'\nimport { Idle } from './children/Idle'\nimport { Pointing } from './children/Pointing'\n\nexport class TLTextTool extends StateNode {\n\tstatic override id = 'text'\n\tstatic initial = 'idle'\n\n\tstatic children = () => [Idle, Pointing]\n\n\tstyles = ['color', 'opacity', 'font', 'align', 'size'] as TLStyleType[]\n}\n","import { StateNode } from './StateNode'\nimport { TLArrowTool } from './TLArrowTool'\nimport { TLDrawTool } from './TLDrawTool'\nimport { TLEraserTool } from './TLEraserTool'\nimport { TLFrameTool } from './TLFrameTool'\nimport { TLGeoTool } from './TLGeoTool'\nimport { TLHandTool } from './TLHandTool'\nimport { TLLineTool } from './TLLineTool'\nimport { TLNoteTool } from './TLNoteTool'\nimport { TLSelectTool } from './TLSelectTool'\nimport { TLTextTool } from './TLTextTool'\n\nexport class RootState extends StateNode {\n\tstatic override id = 'root'\n\tstatic initial = 'select'\n\tstatic children = () => [\n\t\tTLSelectTool,\n\t\tTLHandTool,\n\t\tTLEraserTool,\n\t\tTLDrawTool,\n\t\tTLTextTool,\n\t\tTLLineTool,\n\t\tTLArrowTool,\n\t\tTLGeoTool,\n\t\tTLNoteTool,\n\t\tTLFrameTool,\n\t]\n}\n","import {\n\tapproximately,\n\tareAnglesCompatible,\n\tBox2d,\n\tclamp,\n\tEASINGS,\n\tintersectPolygonPolygon,\n\tMatLike,\n\tMatrix2d,\n\tMatrix2dModel,\n\tPI2,\n\tpointInPolygon,\n\tVec2d,\n\tVecLike,\n} from '@tldraw/primitives'\nimport {\n\tBox2dModel,\n\tcreateCustomShapeId,\n\tcreateShapeId,\n\tisShape,\n\tisShapeId,\n\tTLArrowShape,\n\tTLArrowTerminal,\n\tTLAsset,\n\tTLAssetId,\n\tTLAssetPartial,\n\tTLCamera,\n\tTLColorStyle,\n\tTLColorType,\n\tTLCursor,\n\tTLCursorType,\n\tTLDOCUMENT_ID,\n\tTLFrameShape,\n\tTLGroupShape,\n\tTLImageAsset,\n\tTLInstance,\n\tTLInstanceId,\n\tTLInstancePageState,\n\tTLNullableShapeProps,\n\tTLPage,\n\tTLPageId,\n\tTLParentId,\n\tTLRecord,\n\tTLScribble,\n\tTLShape,\n\tTLShapeId,\n\tTLShapePartial,\n\tTLShapeProp,\n\tTLShapeType,\n\tTLSizeStyle,\n\tTLStore,\n\tTLUnknownShape,\n\tTLUser,\n\tTLUserDocument,\n\tTLUserId,\n\tTLVideoAsset,\n\tVec2dModel,\n} from '@tldraw/tlschema'\nimport { ComputedCache, HistoryEntry } from '@tldraw/tlstore'\nimport { annotateError, compact, dedupe, deepCopy, partition, structuredClone } from '@tldraw/utils'\nimport { EventEmitter } from 'eventemitter3'\nimport { atom, computed, EMPTY_ARRAY, transact } from 'signia'\nimport { TldrawEditorConfig } from '../config/TldrawEditorConfig'\nimport { TLShapeDef } from '../config/TLShapeDefinition'\nimport {\n\tANIMATION_MEDIUM_MS,\n\tDEFAULT_ANIMATION_OPTIONS,\n\tDIRECTION_DELTAS,\n\tDRAG_DISTANCE,\n\tGRID_INCREMENT,\n\tHAND_TOOL_FRICTION,\n\tMAJOR_NUDGE_FACTOR,\n\tMAX_PAGES,\n\tMAX_SHAPES_PER_PAGE,\n\tMAX_ZOOM,\n\tMIN_ZOOM,\n\tMINOR_NUDGE_FACTOR,\n\tSTYLES,\n\tSVG_PADDING,\n\tZOOMS,\n} from '../constants'\nimport { exportPatternSvgDefs } from '../hooks/usePattern'\nimport {\n\tapplyRotationToSnapshotShapes,\n\tdataUrlToFile,\n\tgetIncrementedName,\n\tgetIndexAbove,\n\tgetIndexBetween,\n\tgetIndices,\n\tgetIndicesAbove,\n\tgetIndicesBetween,\n\tgetMediaAssetFromFile,\n\tgetRotationSnapshot,\n\tsetPropsForNextShape,\n\tsortById,\n\tsortByIndex,\n\tuniqueId,\n\tWeakMapCache,\n} from '../utils'\nimport { arrowBindingsIndex } from './derivations/arrowBindingsIndex'\nimport { parentsToChildrenWithIndexes } from './derivations/parentsToChildrenWithIndexes'\nimport { shapeIdsInCurrentPage } from './derivations/shapeIdsInCurrentPage'\nimport {\n\tActiveAreaManager,\n\tCameraManager,\n\tClickManager,\n\tDprManager,\n\tgetActiveAreaScreenSpace,\n\tHistoryManager,\n\tSnapManager,\n\tTextManager,\n\tTickManager,\n} from './managers'\nimport {\n\tTLArrowShapeDef,\n\tTLGroupShapeDef,\n\tTLResizeMode,\n\tTLShapeUtil,\n\tTLTextShapeDef,\n} from './shapeutils'\nimport { TLExportColors } from './shapeutils/shared'\nimport { getArrowTerminalsInArrowSpace } from './shapeutils/TLArrowUtil/arrow/shared'\nimport { TLFrameShapeDef } from './shapeutils/TLFrameUtil/TLFrameUtil'\nimport { RootState } from './statechart/RootState'\nimport { StateNode } from './statechart/StateNode'\nimport { TLClipboardModel } from './types/clipboard-types'\nimport { TLEventInfo, TLPinchEventInfo, TLPointerEventInfo } from './types/event-types'\nimport { RequiredKeys, TLDeltaDirection } from './types/misc-types'\nimport { TLReorderOperation } from './types/reorder-types'\nimport { TLResizeHandle } from './types/selection-types'\n\n/** @public */\nexport type TLChange = HistoryEntry<any>\n\n/** @public */\nexport type AnimationOptions = Partial<{\n\tduration: number\n\teasing: typeof EASINGS.easeInOutCubic\n}>\n\n/** @public */\nexport interface AppOptions {\n\t/**\n\t * The Store instance to use for keeping the app's data.\n\t * This may be prepopulated, e.g. by loading from a server or database.\n\t */\n\tstore: TLStore\n\t/**\n\t * A configuration defining major customizations to the app, such as custom\n\t * shapes and new tools\n\t */\n\tconfig?: TldrawEditorConfig\n\t/**\n\t * Should return a containing html element which has all the styles applied to the app.\n\t * If not given, the body element will be used.\n\t */\n\tgetContainer: () => HTMLElement\n\n\t/**\n\t * The id of the current user. If not given, one will be generated.\n\t */\n\tuserId?: TLUserId\n\t/**\n\t * The id of the app instance (e.g. a browser tab if the app will have only one tldraw app per tab).\n\t * If not given, one will be generated.\n\t */\n\tinstanceId?: TLInstanceId\n}\n\n/** @public */\nexport function isShapeWithHandles(shape: TLShape) {\n\treturn shape.type === 'arrow' || shape.type === 'line' || shape.type === 'draw'\n}\n\n/** @public */\nexport class App extends EventEmitter {\n\tconstructor({ config = TldrawEditorConfig.default, store, getContainer }: AppOptions) {\n\t\tsuper()\n\n\t\tif (store.schema !== config.storeSchema) {\n\t\t\tthrow new Error('Store schema does not match schema given to App')\n\t\t}\n\n\t\tthis.config = config\n\t\tthis.store = store\n\n\t\tthis.getContainer = getContainer ?? (() => document.body)\n\n\t\tthis.textMeasure = new TextManager(this)\n\n\t\t// Set the shape utils\n\t\tthis.shapeUtils = Object.fromEntries(\n\t\t\tconfig.shapes.map((def) => [\n\t\t\t\tdef.type,\n\t\t\t\tdef.createShapeUtils(this) as TLShapeUtil<TLUnknownShape>,\n\t\t\t])\n\t\t)\n\n\t\tif (typeof window !== 'undefined' && 'navigator' in window) {\n\t\t\tthis.isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent)\n\t\t\tthis.isIos = !!navigator.userAgent.match(/iPad/i) || !!navigator.userAgent.match(/iPhone/i)\n\t\t} else {\n\t\t\tthis.isSafari = false\n\t\t\tthis.isIos = false\n\t\t}\n\n\t\t// Set styles\n\t\tthis.colors = new Map(App.styles.color.map((c) => [c.id, `var(--palette-${c.id})`]))\n\n\t\tthis.root = new RootState(this)\n\t\tif (this.root.children) {\n\t\t\tconfig.tools.forEach((Ctor) => {\n\t\t\t\tthis.root.children![Ctor.id] = new Ctor(this)\n\t\t\t})\n\t\t}\n\n\t\tthis.store.onBeforeDelete = (record) => {\n\t\t\tif (record.typeName === 'shape') {\n\t\t\t\tthis._shapeWillBeDeleted(record)\n\t\t\t} else if (record.typeName === 'page') {\n\t\t\t\tthis._pageWillBeDeleted(record)\n\t\t\t}\n\t\t}\n\n\t\tthis.store.onAfterChange = (prev, next) => {\n\t\t\tthis._updateDepth++\n\t\t\tif (this._updateDepth > 1000) {\n\t\t\t\tconsole.error('[onAfterChange] Maximum update depth exceeded, bailing out.')\n\t\t\t}\n\t\t\tif (prev.typeName === 'shape' && next.typeName === 'shape') {\n\t\t\t\tthis._shapeDidChange(prev, next)\n\t\t\t} else if (\n\t\t\t\tprev.typeName === 'instance_page_state' &&\n\t\t\t\tnext.typeName === 'instance_page_state'\n\t\t\t) {\n\t\t\t\tthis._tabStateDidChange(prev, next)\n\t\t\t}\n\n\t\t\tthis._updateDepth--\n\t\t}\n\t\tthis.store.onAfterCreate = (record) => {\n\t\t\tif (record.typeName === 'shape' && TLArrowShapeDef.is(record)) {\n\t\t\t\tthis._arrowDidUpdate(record)\n\t\t\t}\n\t\t}\n\n\t\tthis._shapeIds = shapeIdsInCurrentPage(this.store, () => this.currentPageId)\n\t\tthis._parentIdsToChildIds = parentsToChildrenWithIndexes(this.store)\n\n\t\tthis.disposables.add(\n\t\t\tthis.store.listen((changes) => {\n\t\t\t\tthis.emit('change', changes as TLChange)\n\t\t\t})\n\t\t)\n\n\t\tthis.store.ensureStoreIsUsable()\n\n\t\tthis.root.enter(undefined, 'initial')\n\n\t\tthis.updateCullingBounds()\n\n\t\trequestAnimationFrame(() => {\n\t\t\tthis._tickManager.start()\n\t\t})\n\t}\n\n\t/**\n\t * The editor's store\n\t *\n\t * @public\n\t */\n\treadonly store: TLStore\n\n\t/**\n\t * The editor's config\n\t *\n\t * @public\n\t */\n\treadonly config: TldrawEditorConfig\n\n\t/**\n\t * The root state of the statechart.\n\t *\n\t * @public\n\t */\n\treadonly root: RootState\n\n\t/**\n\t * A cache of shape ids in the current page.\n\t *\n\t * @internal\n\t */\n\tprivate readonly _shapeIds: ReturnType<typeof shapeIdsInCurrentPage>\n\n\t/**\n\t * A set of functions to call when the app is disposed.\n\t *\n\t * @public\n\t */\n\treadonly disposables = new Set<() => void>()\n\n\t/** @internal */\n\tprivate _dprManager = new DprManager(this)\n\n\t/** @internal */\n\tprivate _cameraManager = new CameraManager(this)\n\n\t/** @internal */\n\tprivate _activeAreaManager = new ActiveAreaManager(this)\n\n\t/** @internal */\n\tprivate _tickManager = new TickManager(this)\n\n\t/** @internal */\n\tprivate _updateDepth = 0\n\n\t/**\n\t * A manager for the app's snapping feature.\n\t *\n\t * @public\n\t */\n\treadonly snaps = new SnapManager(this)\n\n\t/**\n\t * Whether the editor is running in Safari.\n\t *\n\t * @public\n\t */\n\treadonly isSafari: boolean\n\n\t/**\n\t * Whether the editor is running on iOS.\n\t *\n\t * @public\n\t */\n\treadonly isIos: boolean\n\n\t// Flags\n\n\tprivate _canMoveCamera = atom('can move camera', true)\n\n\t/**\n\t * Set whether the editor's camera can move.\n\t *\n\t * @param canMove - Whether the camera can move.\n\t *\n\t * @example\n\t * ```ts\n\t * app.canMoveCamera = false\n\t * ```\n\t *\n\t * @public\n\t */\n\t@computed get canMoveCamera() {\n\t\treturn this._canMoveCamera.value\n\t}\n\n\tset canMoveCamera(canMove: boolean) {\n\t\tthis._canMoveCamera.set(canMove)\n\t}\n\n\t/**\n\t * The current HTML element containing the editor.\n\t *\n\t * @example\n\t * ```ts\n\t * const container = app.getContainer()\n\t * ```\n\t *\n\t * @public\n\t */\n\tgetContainer: () => HTMLElement\n\n\t/**\n\t * The editor's userId (defined in its store.props).\n\t *\n\t * @example\n\t * ```ts\n\t * const userId = app.userId\n\t * ```\n\t *\n\t * @public\n\t */\n\tget userId(): TLUserId {\n\t\treturn this.store.props.userId\n\t}\n\n\t/**\n\t * The editor's instanceId (defined in its store.props).\n\t *\n\t * @example\n\t * ```ts\n\t * const instanceId = app.instanceId\n\t * ```\n\t *\n\t * @public\n\t */\n\tget instanceId(): TLInstanceId {\n\t\treturn this.store.props.instanceId\n\t}\n\n\t/** @internal */\n\tannotateError(\n\t\terror: unknown,\n\t\t{\n\t\t\torigin,\n\t\t\twillCrashApp,\n\t\t\ttags,\n\t\t\textras,\n\t\t}: {\n\t\t\torigin: string\n\t\t\twillCrashApp: boolean\n\t\t\ttags?: Record<string, string | boolean | number>\n\t\t\textras?: Record<string, unknown>\n\t\t}\n\t) {\n\t\tconst defaultAnnotations = this.createErrorAnnotations(origin, willCrashApp)\n\t\tannotateError(error, {\n\t\t\ttags: { ...defaultAnnotations.tags, ...tags },\n\t\t\textras: { ...defaultAnnotations.extras, ...extras },\n\t\t})\n\t\tif (willCrashApp) {\n\t\t\tthis.store.markAsPossiblyCorrupted()\n\t\t}\n\t}\n\n\t/** @internal */\n\tcreateErrorAnnotations(\n\t\torigin: string,\n\t\twillCrashApp: boolean | 'unknown'\n\t): {\n\t\ttags: { origin: string; willCrashApp: boolean | 'unknown' }\n\t\textras: {\n\t\t\tactiveStateNode?: string\n\t\t\tselectedShapes?: TLUnknownShape[]\n\t\t\teditingShape?: TLUnknownShape\n\t\t\tinputs?: Record<string, unknown>\n\t\t}\n\t} {\n\t\ttry {\n\t\t\treturn {\n\t\t\t\ttags: {\n\t\t\t\t\torigin: origin,\n\t\t\t\t\twillCrashApp,\n\t\t\t\t},\n\t\t\t\textras: {\n\t\t\t\t\tactiveStateNode: this.root.path.value,\n\t\t\t\t\tselectedShapes: this.selectedShapes,\n\t\t\t\t\teditingShape: this.editingId ? this.getShapeById(this.editingId) : undefined,\n\t\t\t\t\tinputs: this.inputs,\n\t\t\t\t},\n\t\t\t}\n\t\t} catch {\n\t\t\treturn {\n\t\t\t\ttags: {\n\t\t\t\t\torigin: origin,\n\t\t\t\t\twillCrashApp,\n\t\t\t\t},\n\t\t\t\textras: {},\n\t\t\t}\n\t\t}\n\t}\n\n\t/** @internal */\n\tprivate _crashingError: unknown | null = null\n\n\t/**\n\t * we can't use an `atom` here because there's a chance that when\n\t * `crashAndReportError` is called, we're in a transaction that's about to\n\t * be rolled back due to the same error we're currently reporting.\n\t *\n\t * instead, to listen to changes to this value, you need to listen to app's\n\t * `crash` event.\n\t *\n\t * @internal\n\t */\n\tget crashingError() {\n\t\treturn this._crashingError\n\t}\n\n\t/** @internal */\n\tcrash(error: unknown) {\n\t\tthis._crashingError = error\n\t\tthis.store.markAsPossiblyCorrupted()\n\t\tthis.emit('crash')\n\t}\n\n\tget devicePixelRatio() {\n\t\treturn this._dprManager.dpr.value\n\t}\n\n\t/**\n\t * A set of strings representing any open menus or modals.\n\t *\n\t * @public\n\t */\n\topenMenus = new Set<string>()\n\n\t/**\n\t * Get whether any menus are open.\n\t *\n\t * @public\n\t */\n\tget isMenuOpen() {\n\t\treturn this.openMenus.size > 0\n\t}\n\n\t/** @internal */\n\tprivate _isCoarsePointer = atom<boolean>('isCoarsePointer', false as any)\n\n\t/**\n\t * Whether the user is using a \"coarse\" pointer, such as on a touch screen.\n\t *\n\t * @public\n\t */\n\tget isCoarsePointer() {\n\t\treturn this._isCoarsePointer.value\n\t}\n\n\tset isCoarsePointer(v) {\n\t\tthis._isCoarsePointer.set(v)\n\t}\n\n\t/** @internal */\n\tprivate _isChangingStyle = atom<boolean>('isChangingStyle', false as any)\n\n\t/** @internal */\n\tprivate _isChangingStyleTimeout = -1 as any\n\n\t/**\n\t * Whether the user is currently changing the style of a shape. This may cause the UI to change.\n\t *\n\t * @example\n\t * ```ts\n\t * app.isChangingStyle = true\n\t * ```\n\t *\n\t * @public\n\t */\n\tget isChangingStyle() {\n\t\treturn this._isChangingStyle.value\n\t}\n\n\tset isChangingStyle(v) {\n\t\tthis._isChangingStyle.set(v)\n\t\t// Clear any reset timeout\n\t\tclearTimeout(this._isChangingStyleTimeout)\n\t\tif (v) {\n\t\t\t// If we've set to true, set a new reset timeout to change the value back to false after 2 seonds\n\t\t\tthis._isChangingStyleTimeout = setTimeout(() => (this.isChangingStyle = false), 2000)\n\t\t}\n\t}\n\n\t/**\n\t * A cache of page transforms.\n\t *\n\t * @internal\n\t */\n\t@computed private get _pageTransformCache(): ComputedCache<Matrix2d, TLShape> {\n\t\treturn this.store.createComputedCache<Matrix2d, TLShape>('pageTransformCache', (shape) => {\n\t\t\tif (TLPage.isId(shape.parentId)) {\n\t\t\t\treturn this.getTransform(shape)\n\t\t\t}\n\t\t\t// some weird circular type thing here that I had to work wround with (as any)\n\t\t\tconst parent = (this._pageTransformCache as any).get(shape.parentId)\n\n\t\t\treturn Matrix2d.Compose(parent, this.getTransform(shape))\n\t\t})\n\t}\n\n\t/**\n\t * A cache of axis aligned page bounding boxes.\n\t *\n\t * @internal\n\t */\n\t@computed private get _pageBoundsCache(): ComputedCache<Box2d, TLShape> {\n\t\treturn this.store.createComputedCache<Box2d, TLShape>('pageBoundsCache', (shape) => {\n\t\t\tconst pageTransform = this._pageTransformCache.get(shape.id)\n\n\t\t\tif (!pageTransform) return new Box2d()\n\n\t\t\tconst result = Box2d.FromPoints(\n\t\t\t\tMatrix2d.applyToPoints(pageTransform, this.getShapeUtil(shape).outline(shape))\n\t\t\t)\n\n\t\t\treturn result\n\t\t})\n\t}\n\n\t/**\n\t * A cache of page masks used for clipping.\n\t *\n\t * @internal\n\t */\n\t@computed private get _pageMaskCache(): ComputedCache<VecLike[], TLShape> {\n\t\treturn this.store.createComputedCache<VecLike[], TLShape>('pageMaskCache', (shape) => {\n\t\t\tif (TLPage.isId(shape.parentId)) {\n\t\t\t\treturn undefined\n\t\t\t}\n\n\t\t\tconst frameAncestors = this.getAncestorsById(shape.id).filter((s) => s.type === 'frame')\n\n\t\t\tif (frameAncestors.length === 0) return undefined\n\n\t\t\tconst pageMask = frameAncestors\n\t\t\t\t.map<VecLike[] | undefined>((s) =>\n\t\t\t\t\t// Apply the frame transform to the frame outline to get the frame outline in page space\n\t\t\t\t\tMatrix2d.applyToPoints(this._pageTransformCache.get(s.id)!, this.getOutline(s))\n\t\t\t\t)\n\t\t\t\t.reduce((acc, b) => (b && acc ? intersectPolygonPolygon(acc, b) ?? undefined : undefined))\n\n\t\t\treturn pageMask\n\t\t})\n\t}\n\n\t/**\n\t * Get the page mask for a shape.\n\t *\n\t * @example\n\t * ```ts\n\t * const pageMask = app.getPageMaskById(shape.id)\n\t * ```\n\t *\n\t * @public\n\t *\n\t * @param id - The id of the shape to get the page mask for.\n\t *\n\t * @returns The page mask for the shape.\n\t */\n\tgetPageMaskById(id: TLShapeId) {\n\t\treturn this._pageMaskCache.get(id)\n\t}\n\n\t/**\n\t * A cache of clip paths used for clipping.\n\t *\n\t * @internal\n\t */\n\t@computed private get _clipPathCache(): ComputedCache<string, TLShape> {\n\t\treturn this.store.createComputedCache<string, TLShape>('clipPathCache', (shape) => {\n\t\t\tconst pageMask = this._pageMaskCache.get(shape.id)\n\t\t\tif (!pageMask) return undefined\n\t\t\tconst pageTransform = this._pageTransformCache.get(shape.id)\n\t\t\tif (!pageTransform) return undefined\n\n\t\t\tif (pageMask.length === 0) {\n\t\t\t\treturn `polygon(0px 0px, 0px 0px, 0px 0px)`\n\t\t\t}\n\n\t\t\tconst localMask = Matrix2d.applyToPoints(Matrix2d.Inverse(pageTransform), pageMask)\n\n\t\t\treturn `polygon(${localMask.map((p) => `${p.x}px ${p.y}px`).join(',')})`\n\t\t})\n\t}\n\n\t/**\n\t * Get the clip path for a shape.\n\t *\n\t * @example\n\t * ```ts\n\t * const clipPath = app.getClipPathById(shape.id)\n\t * ```\n\t *\n\t * @param id - The shape id.\n\t *\n\t * @returns The clip path or undefined.\n\t *\n\t * @public\n\t */\n\tgetClipPathById(id: TLShapeId) {\n\t\treturn this._clipPathCache.get(id)\n\t}\n\n\t/**\n\t * A cache of parents to children.\n\t *\n\t * @internal\n\t */\n\tprivate readonly _parentIdsToChildIds: ReturnType<typeof parentsToChildrenWithIndexes>\n\n\t/**\n\t * Dispose the app.\n\t *\n\t * @public\n\t */\n\tdispose() {\n\t\tthis.disposables.forEach((dispose) => dispose())\n\t\tthis.disposables.clear()\n\t}\n\n\t/**\n\t * A manager for the app's history.\n\t *\n\t * @readonly\n\t */\n\treadonly history = new HistoryManager(\n\t\tthis,\n\t\t() => this._complete(),\n\t\t(error) => {\n\t\t\tthis.annotateError(error, { origin: 'history.batch', willCrashApp: true })\n\t\t\tthis.crash(error)\n\t\t}\n\t)\n\n\t/**\n\t * Undo to the last mark.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.undo()\n\t * ```\n\t *\n\t * @public\n\t */\n\tundo() {\n\t\treturn this.history.undo()\n\t}\n\n\t/**\n\t * Whether the app can undo.\n\t *\n\t * @public\n\t */\n\t@computed get canUndo() {\n\t\treturn this.history.numUndos > 0\n\t}\n\n\t/**\n\t * Redo to the next mark.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.redo()\n\t * ```\n\t *\n\t * @public\n\t */\n\tredo() {\n\t\tthis.history.redo()\n\t\treturn this\n\t}\n\n\t/**\n\t * Whether the app can redo.\n\t *\n\t * @public\n\t */\n\t@computed get canRedo() {\n\t\treturn this.history.numRedos > 0\n\t}\n\n\t/**\n\t * Create a new \"mark\", or stopping point, in the undo redo history. Creating a mark will clear\n\t * any redos.\n\t *\n\t * @example\n\t * ```ts\n\t * app.mark()\n\t * app.mark('flip shapes')\n\t * ```\n\t *\n\t * @param reason - The reason for the mark.\n\t * @param onUndo - Whether to stop at the mark when undoing.\n\t * @param onRedo - Whether to stop at the mark when redoing.\n\t * @public\n\t */\n\tmark(reason?: string, onUndo?: boolean, onRedo?: boolean) {\n\t\treturn this.history.mark(reason, onUndo, onRedo)\n\t}\n\n\t/**\n\t * Clear all marks in the undo stack back to the next mark.\n\t *\n\t * @example\n\t * ```ts\n\t * app.bail()\n\t * ```\n\t *\n\t * @public\n\t */\n\tbail() {\n\t\tthis.history.bail()\n\t\treturn this\n\t}\n\n\t/**\n\t * Clear all marks in the undo stack back to the mark with the provided mark id.\n\t *\n\t * @example\n\t * ```ts\n\t * app.bailToMark(\"creating\")\n\t * ```\n\t *\n\t * @public\n\t */\n\tbailToMark(id: string) {\n\t\tthis.history.bailToMark(id)\n\t\treturn this\n\t}\n\n\t/**\n\t * Run a function in a batch, which will be undone/redone as a single action.\n\t *\n\t * @example\n\t * ```ts\n\t * app.batch(() => {\n\t *   app.selectAll()\n\t *   app.deleteShapes()\n\t *   app.createShapes(myShapes)\n\t *   app.selectNone()\n\t * })\n\t *\n\t * app.undo() // will undo all of the above\n\t * ```\n\t *\n\t * @public\n\t */\n\tbatch(fn: () => void) {\n\t\tthis.history.batch(fn)\n\t\treturn this\n\t}\n\n\t/**\n\t * A map of shape utility classes (TLShapeUtils) by shape type.\n\t *\n\t * @public\n\t */\n\tshapeUtils: { readonly [K in string]?: TLShapeUtil<TLUnknownShape> }\n\n\t/**\n\t * Get a shape util for a given shape or shape type.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.getShapeUtil('geo')\n\t * ```\n\t * \tapp.getShapeUtil(myBoxShape)\n\t *\n\t * @param type - The shape type.\n\t *\n\t * @public\n\t */\n\tgetShapeUtil<T extends TLShape = TLShape>(shape: T): TLShapeUtil<T> {\n\t\treturn this.shapeUtils[shape.type] as any as TLShapeUtil<T>\n\t}\n\n\t/**\n\t * Get a shape util by its definition.\n\t *\n\t * @example\n\t * ```ts\n\t * app.getShapeUtilByDef(TLDrawShapeDef)\n\t * ```\n\t *\n\t * @param def - The shape definition.\n\t *\n\t * @public\n\t */\n\tgetShapeUtilByDef<Def extends TLShapeDef<any, any>>(\n\t\tdef: Def\n\t): ReturnType<Def['createShapeUtils']> {\n\t\treturn this.shapeUtils[def.type] as ReturnType<Def['createShapeUtils']>\n\t}\n\n\t/**\n\t * A cache of children for each parent.\n\t *\n\t * @internal\n\t */\n\tprivate _childIdsCache = new WeakMapCache<any[], TLShapeId[]>()\n\n\t/**\n\t * Get an array of all the children of a shape.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.getSortedChildIds('frame1')\n\t * ```\n\t *\n\t * @param parentId - The id of the parent shape.\n\t * @public\n\t */\n\tgetSortedChildIds(parentId: TLParentId): TLShapeId[] {\n\t\tconst withIndices = this._parentIdsToChildIds.value[parentId]\n\t\tif (!withIndices) return EMPTY_ARRAY\n\t\treturn this._childIdsCache.get(withIndices, () => withIndices.map(([id]) => id))\n\t}\n\n\t/**\n\t * Run a visitor function for all descendants of a shape.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.visitDescendants('frame1', myCallback)\n\t * ```\n\t *\n\t * @param parentId - The id of the parent shape.\n\t * @param visitor - The visitor function.\n\t * @public\n\t */\n\tvisitDescendants(parentId: TLParentId, visitor: (id: TLShapeId) => void | false) {\n\t\tconst children = this.getSortedChildIds(parentId)\n\t\tfor (const id of children) {\n\t\t\tif (visitor(id) === false) continue\n\t\t\tthis.visitDescendants(id, visitor)\n\t\t}\n\t}\n\n\t/**\n\t * The editor's current erasing ids.\n\t *\n\t * @public\n\t */\n\t@computed get erasingIds() {\n\t\treturn this.pageState.erasingIds\n\t}\n\n\t/**\n\t * The editor's current hinting ids.\n\t *\n\t * @public\n\t */\n\t@computed get hintingIds() {\n\t\treturn this.pageState.hintingIds\n\t}\n\n\t/**\n\t * A derived set containing the current erasing ids.\n\t *\n\t * @public\n\t */\n\t@computed get erasingIdsSet() {\n\t\t// todo: Make incremental derivation, so that this only gets updated when erasingIds changes: we're creating this too often!\n\t\treturn new Set<TLShapeId>(this.erasingIds)\n\t}\n\n\t/**\n\t * Get all the current props among the users selected shapes\n\t *\n\t * @internal\n\t */\n\tprivate _extractSharedProps(shape: TLShape, sharedProps: TLNullableShapeProps) {\n\t\tif (shape.type === 'group') {\n\t\t\t// For groups, ignore the props of the group shape and instead include\n\t\t\t// the props of the group's children. These are the shapes that would have\n\t\t\t// their props changed if the user called `setProp` on the current selection.\n\t\t\tconst childIds = this._parentIdsToChildIds.value[shape.id]\n\t\t\tif (!childIds) return\n\n\t\t\tfor (let i = 0, n = childIds.length; i < n; i++) {\n\t\t\t\tthis._extractSharedProps(this.getShapeById(childIds[i][0])!, sharedProps)\n\t\t\t}\n\t\t} else {\n\t\t\tconst props = Object.entries(shape.props)\n\t\t\tlet prop: [TLShapeProp, any]\n\t\t\tfor (let i = 0, n = props.length; i < n; i++) {\n\t\t\t\tprop = props[i] as [TLShapeProp, any]\n\n\t\t\t\t// Check the value of this prop on the shared props object.\n\t\t\t\tswitch (sharedProps[prop[0]]) {\n\t\t\t\t\tcase undefined: {\n\t\t\t\t\t\t// If this key hasn't been defined yet in the shared props object,\n\t\t\t\t\t\t// we can set it to the value from the shape's props object.\n\t\t\t\t\t\tsharedProps[prop[0]] = prop[1]\n\t\t\t\t\t\tbreak\n\t\t\t\t\t}\n\t\t\t\t\tcase null:\n\t\t\t\t\tcase prop[1]: {\n\t\t\t\t\t\t// If the value in the shared props object matches the value from\n\t\t\t\t\t\t// the shape's props object exactlyor if there is already a mixed\n\t\t\t\t\t\t// value (null) in the shared props objectthen this is a noop. We\n\t\t\t\t\t\t// want to leave the value as it is in the shared props object.\n\t\t\t\t\t\tcontinue\n\t\t\t\t\t}\n\t\t\t\t\tdefault: {\n\t\t\t\t\t\t// If there's a value in the shared props object that isn't null AND\n\t\t\t\t\t\t// that isn't undefined AND that doesn't match the shape's props object,\n\t\t\t\t\t\t// then we've got a conflict, mixed props, so set the value to null.\n\t\t\t\t\t\tsharedProps[prop[0]] = null\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * A derived object containing all current props among the user's selected shapes.\n\t *\n\t * @internal\n\t */\n\tprivate _selectionSharedProps = computed<TLNullableShapeProps>('_selectionSharedProps', () => {\n\t\tconst { selectedShapes } = this\n\n\t\tconst sharedProps = {} as TLNullableShapeProps\n\n\t\tfor (let i = 0, n = selectedShapes.length; i < n; i++) {\n\t\t\tthis._extractSharedProps(selectedShapes[i], sharedProps)\n\t\t}\n\n\t\treturn sharedProps as TLNullableShapeProps\n\t})\n\n\t@computed get allowUiPaste() {\n\t\treturn Boolean(navigator.clipboard) && Boolean(navigator.clipboard.read)\n\t}\n\n\t/** @internal */\n\tprivate _prevProps: any = {}\n\n\t/**\n\t * A derived object containing either all current props among the user's selected shapes, or else\n\t * the user's most recent prop choices that correspond to the current active state (i.e. the\n\t * selected tool).\n\t *\n\t * @internal\n\t */\n\t@computed get props(): TLNullableShapeProps | null {\n\t\tlet next: TLNullableShapeProps | null\n\n\t\t// If we're in selecting and if we have a selection,\n\t\t// return the shared props from the current selection\n\t\tif (this.isIn('select') && this.selectedIds.length > 0) {\n\t\t\tnext = this._selectionSharedProps.value\n\t\t} else {\n\t\t\t// Otherwise, pull the style props from the app state\n\t\t\t// (the most recent choices made by the user) that are\n\t\t\t// exposed by the current state (i.e. the active tool).\n\t\t\tconst currentState = this.root.current.value!\n\t\t\tif (currentState.styles.length === 0) {\n\t\t\t\tnext = null\n\t\t\t} else {\n\t\t\t\tconst { propsForNextShape } = this.instanceState\n\t\t\t\tnext = Object.fromEntries(\n\t\t\t\t\tcurrentState.styles.map((k) => {\n\t\t\t\t\t\treturn [k, propsForNextShape[k]]\n\t\t\t\t\t})\n\t\t\t\t)\n\t\t\t}\n\t\t}\n\n\t\t// todo: any way to improve this? still faster than rendering the style panel every frame\n\t\tif (JSON.stringify(this._prevProps) === JSON.stringify(next)) return this._prevProps\n\n\t\tthis._prevProps = next\n\n\t\treturn next\n\t}\n\n\t/**\n\t * An array of all of the shapes on the current page.\n\t *\n\t * @public\n\t */\n\tget shapeIds() {\n\t\treturn this._shapeIds.value\n\t}\n\n\t/**\n\t * _invalidParents is used to trigger the 'onChildrenChange' callback that shapes\n\t * can have.\n\t *\n\t * @internal\n\t */\n\tprivate readonly _invalidParents = new Set<TLShapeId>()\n\n\t/** @internal */\n\tprivate _complete() {\n\t\tconst { lastUpdatedPageId, lastUsedTabId } = this.userDocumentSettings\n\t\tif (lastUsedTabId !== this.instanceId || lastUpdatedPageId !== this.currentPageId) {\n\t\t\tthis.store.put([\n\t\t\t\t{\n\t\t\t\t\t...this.userDocumentSettings,\n\t\t\t\t\tlastUsedTabId: this.instanceId,\n\t\t\t\t\tlastUpdatedPageId: this.currentPageId,\n\t\t\t\t},\n\t\t\t])\n\t\t}\n\t\tfor (const parentId of this._invalidParents) {\n\t\t\tthis._invalidParents.delete(parentId)\n\t\t\tconst parent = this.getShapeById(parentId)\n\t\t\tif (!parent) continue\n\n\t\t\tconst util = this.getShapeUtil(parent)\n\t\t\tconst changes = util.onChildrenChange?.(parent)\n\n\t\t\tif (changes?.length) {\n\t\t\t\tthis.updateShapes(changes, true)\n\t\t\t}\n\t\t}\n\n\t\tthis.updateUserPresence()\n\t\tthis.emit('update')\n\t}\n\n\t/** @internal */\n\t@computed\n\tprivate get _arrowBindingsIndex() {\n\t\treturn arrowBindingsIndex(this.store)\n\t}\n\n\t/**\n\t * getArrowsBoundTo\n\t */\n\tgetArrowsBoundTo(shapeId: TLShapeId) {\n\t\treturn this._arrowBindingsIndex.value[shapeId] || EMPTY_ARRAY\n\t}\n\n\t/** @internal */\n\tprivate _reparentArrow(arrowId: TLShapeId) {\n\t\tconst arrow = this.getShapeById(arrowId) as TLArrowShape | undefined\n\t\tif (!arrow) return\n\t\tconst { start, end } = arrow.props\n\t\tconst startShape = start.type === 'binding' ? this.getShapeById(start.boundShapeId) : undefined\n\t\tconst endShape = end.type === 'binding' ? this.getShapeById(end.boundShapeId) : undefined\n\n\t\tconst parentPageId = this.getParentPageId(arrow)\n\t\tif (!parentPageId) return\n\n\t\tlet nextParentId: TLParentId\n\t\tif (startShape && endShape) {\n\t\t\t// if arrow has two bindings, always parent arrow to closest common ancestor of the bindings\n\t\t\tnextParentId = this.findCommonAncestor([startShape, endShape]) ?? parentPageId\n\t\t} else if (startShape || endShape) {\n\t\t\t// if arrow has one binding, keep arrow on its own page\n\t\t\tnextParentId = parentPageId\n\t\t} else {\n\t\t\treturn\n\t\t}\n\n\t\tif (nextParentId && nextParentId !== arrow.parentId) {\n\t\t\tthis.reparentShapesById([arrowId], nextParentId)\n\t\t}\n\n\t\tconst reparentedArrow = this.getShapeById(arrowId) as TLArrowShape\n\n\t\tconst startSibling = this.getNearestSiblingShape(reparentedArrow, startShape)\n\t\tconst endSibling = this.getNearestSiblingShape(reparentedArrow, endShape)\n\n\t\tlet highestSibling: TLShape | undefined\n\n\t\tif (startSibling && endSibling) {\n\t\t\thighestSibling = startSibling.index > endSibling.index ? startSibling : endSibling\n\t\t} else if (startSibling && !endSibling) {\n\t\t\thighestSibling = startSibling\n\t\t} else if (endSibling && !startSibling) {\n\t\t\thighestSibling = endSibling\n\t\t} else {\n\t\t\treturn\n\t\t}\n\n\t\tlet finalIndex: string\n\n\t\tconst higherSiblings = this.getSortedChildIds(highestSibling.parentId)\n\t\t\t.map((id) => this.getShapeById(id)!)\n\t\t\t.filter((sibling) => sibling.index > highestSibling!.index)\n\n\t\tif (higherSiblings.length) {\n\t\t\t// there are siblings above the highest bound sibling, we need to\n\t\t\t// insert between them.\n\n\t\t\t// if the next sibling is also a bound arrow though, we can end up\n\t\t\t// all fighting for the same indexes. so lets find the next\n\t\t\t// non-arrow sibling...\n\t\t\tconst nextHighestNonArrowSibling = higherSiblings.find((sibling) => sibling.type !== 'arrow')\n\n\t\t\tif (\n\t\t\t\t// ...then, if we're above the last shape we want to be above...\n\t\t\t\treparentedArrow.index > highestSibling.index &&\n\t\t\t\t// ...but below the next non-arrow sibling...\n\t\t\t\t(!nextHighestNonArrowSibling || reparentedArrow.index < nextHighestNonArrowSibling.index)\n\t\t\t) {\n\t\t\t\t// ...then we're already in the right place. no need to update!\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\t// otherwise, we need to find the index between the highest sibling\n\t\t\t// we want to be above, and the next highest sibling we want to be\n\t\t\t// below:\n\t\t\tfinalIndex = getIndexBetween(highestSibling.index, higherSiblings[0].index)\n\t\t} else {\n\t\t\t// if there are no siblings above us, we can just get the next index:\n\t\t\tfinalIndex = getIndexAbove(highestSibling.index)\n\t\t}\n\n\t\tif (finalIndex !== reparentedArrow.index) {\n\t\t\tthis.updateShapes([{ id: arrowId, type: 'arrow', index: finalIndex }])\n\t\t}\n\t}\n\n\t/** @internal */\n\tprivate _unbindArrowTerminal(arrow: TLArrowShape, handleId: 'start' | 'end') {\n\t\tconst { x, y } = getArrowTerminalsInArrowSpace(this, arrow)[handleId]\n\t\tthis.store.put([{ ...arrow, props: { ...arrow.props, [handleId]: { type: 'point', x, y } } }])\n\t}\n\n\t// private _shapeWillUpdate = (prev: TLShape, next: TLShape) => {\n\t// \tconst update = this.getShapeUtil(next).onUpdate?.(prev, next)\n\t// \treturn update ?? next\n\t// }\n\n\t/** @internal */\n\tprivate _shapeWillBeDeleted(deletedShape: TLShape) {\n\t\t// if the deleted shape has a parent shape make sure we call it's onChildrenChange callback\n\t\tif (deletedShape.parentId && isShapeId(deletedShape.parentId)) {\n\t\t\tthis._invalidParents.add(deletedShape.parentId)\n\t\t}\n\t\t// clean up any arrows bound to this shape\n\t\tconst bindings = this._arrowBindingsIndex.value[deletedShape.id]\n\t\tif (bindings?.length) {\n\t\t\tfor (const { arrowId, handleId } of bindings) {\n\t\t\t\tconst arrow = this.getShapeById<TLArrowShape>(arrowId)\n\t\t\t\tif (!arrow) continue\n\t\t\t\tthis._unbindArrowTerminal(arrow, handleId)\n\t\t\t}\n\t\t}\n\n\t\tconst pageStates = this.store.query.records('instance_page_state').value\n\t\tconst deletedIds = new Set([deletedShape.id])\n\t\tconst updates = compact(\n\t\t\tpageStates.map((pageState) => {\n\t\t\t\treturn this._cleanupInstancePageState(pageState, deletedIds)\n\t\t\t})\n\t\t)\n\n\t\tif (updates.length) {\n\t\t\tthis.store.put(updates)\n\t\t}\n\t}\n\n\t/** @internal */\n\tprivate _arrowDidUpdate(arrow: TLArrowShape) {\n\t\t// if the shape is an arrow and its bound shape is on another page\n\t\t// or was deleted, unbind it\n\t\tfor (const handle of ['start', 'end'] as const) {\n\t\t\tconst terminal = arrow.props[handle]\n\t\t\tif (terminal.type !== 'binding') continue\n\t\t\tconst boundShape = this.getShapeById(terminal.boundShapeId)\n\t\t\tconst isShapeInSamePageAsArrow =\n\t\t\t\tthis.getParentPageId(arrow) === this.getParentPageId(boundShape)\n\t\t\tif (!boundShape || !isShapeInSamePageAsArrow) {\n\t\t\t\tthis._unbindArrowTerminal(arrow, handle)\n\t\t\t}\n\t\t}\n\n\t\t// always check the arrow parents\n\t\tthis._reparentArrow(arrow.id)\n\t}\n\n\t/** @internal */\n\tprivate _cleanupInstancePageState(\n\t\tprevPageState: TLInstancePageState,\n\t\tshapesNoLongerInPage: Set<TLShapeId>\n\t) {\n\t\tlet nextPageState = null as null | TLInstancePageState\n\n\t\tconst selectedIds = prevPageState.selectedIds.filter((id) => !shapesNoLongerInPage.has(id))\n\t\tif (selectedIds.length !== prevPageState.selectedIds.length) {\n\t\t\tif (!nextPageState) nextPageState = { ...prevPageState }\n\t\t\tnextPageState.selectedIds = selectedIds\n\t\t}\n\n\t\tconst erasingIds = prevPageState.erasingIds.filter((id) => !shapesNoLongerInPage.has(id))\n\t\tif (erasingIds.length !== prevPageState.erasingIds.length) {\n\t\t\tif (!nextPageState) nextPageState = { ...prevPageState }\n\t\t\tnextPageState.erasingIds = erasingIds\n\t\t}\n\n\t\tif (prevPageState.hoveredId && shapesNoLongerInPage.has(prevPageState.hoveredId)) {\n\t\t\tif (!nextPageState) nextPageState = { ...prevPageState }\n\t\t\tnextPageState.hoveredId = null\n\t\t}\n\n\t\tif (prevPageState.editingId && shapesNoLongerInPage.has(prevPageState.editingId)) {\n\t\t\tif (!nextPageState) nextPageState = { ...prevPageState }\n\t\t\tnextPageState.editingId = null\n\t\t}\n\n\t\tconst hintingIds = prevPageState.hintingIds.filter((id) => !shapesNoLongerInPage.has(id))\n\t\tif (hintingIds.length !== prevPageState.hintingIds.length) {\n\t\t\tif (!nextPageState) nextPageState = { ...prevPageState }\n\t\t\tnextPageState.hintingIds = hintingIds\n\t\t}\n\n\t\tif (prevPageState.focusLayerId && shapesNoLongerInPage.has(prevPageState.focusLayerId)) {\n\t\t\tif (!nextPageState) nextPageState = { ...prevPageState }\n\t\t\tnextPageState.focusLayerId = null\n\t\t}\n\t\treturn nextPageState\n\t}\n\n\t/** @internal */\n\tprivate _shapeDidChange(prev: TLShape, next: TLShape) {\n\t\tif (TLArrowShapeDef.is(next)) {\n\t\t\tthis._arrowDidUpdate(next)\n\t\t}\n\n\t\t// if the shape's parent changed and it is bound to an arrow, update the arrow's parent\n\t\tif (prev.parentId !== next.parentId) {\n\t\t\tconst reparentBoundArrows = (id: TLShapeId) => {\n\t\t\t\tconst boundArrows = this._arrowBindingsIndex.value[id]\n\t\t\t\tif (boundArrows?.length) {\n\t\t\t\t\tfor (const arrow of boundArrows) {\n\t\t\t\t\t\tthis._reparentArrow(arrow.arrowId)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treparentBoundArrows(next.id)\n\t\t\tthis.visitDescendants(next.id, reparentBoundArrows)\n\t\t}\n\n\t\t// if this shape moved to a new page, clean up any previous page's instance state\n\t\tif (prev.parentId !== next.parentId && TLPage.isId(next.parentId)) {\n\t\t\tconst allMovingIds = new Set([prev.id])\n\t\t\tthis.visitDescendants(prev.id, (id) => {\n\t\t\t\tallMovingIds.add(id)\n\t\t\t})\n\n\t\t\tfor (const instancePageState of this.store.query.records('instance_page_state').value) {\n\t\t\t\tif (instancePageState.pageId === next.parentId) continue\n\t\t\t\tconst nextPageState = this._cleanupInstancePageState(instancePageState, allMovingIds)\n\n\t\t\t\tif (nextPageState) {\n\t\t\t\t\tthis.store.put([nextPageState])\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (prev.parentId && isShapeId(prev.parentId)) {\n\t\t\tthis._invalidParents.add(prev.parentId)\n\t\t}\n\n\t\tif (next.parentId !== prev.parentId && isShapeId(next.parentId)) {\n\t\t\tthis._invalidParents.add(next.parentId)\n\t\t}\n\t}\n\n\t/** @internal */\n\tprivate _tabStateDidChange(prev: TLInstancePageState, next: TLInstancePageState) {\n\t\tif (prev?.selectedIds !== next?.selectedIds) {\n\t\t\t// ensure that descendants and ascenants are not selected at the same time\n\t\t\tconst filtered = next.selectedIds.filter((id) => {\n\t\t\t\tlet parentId = this.getShapeById(id)?.parentId\n\t\t\t\twhile (isShapeId(parentId)) {\n\t\t\t\t\tif (next.selectedIds.includes(parentId)) {\n\t\t\t\t\t\treturn false\n\t\t\t\t\t}\n\t\t\t\t\tparentId = this.getShapeById(parentId)?.parentId\n\t\t\t\t}\n\t\t\t\treturn true\n\t\t\t})\n\n\t\t\tconst nextFocusLayerId =\n\t\t\t\tfiltered.length === 0\n\t\t\t\t\t? next?.focusLayerId\n\t\t\t\t\t: this.findCommonAncestor(\n\t\t\t\t\t\t\tcompact(filtered.map((id) => this.getShapeById(id))),\n\t\t\t\t\t\t\t(shape) => shape.type === 'group'\n\t\t\t\t\t  )\n\n\t\t\tif (filtered.length !== next.selectedIds.length || nextFocusLayerId != next.focusLayerId) {\n\t\t\t\tthis.store.put([{ ...next, selectedIds: filtered, focusLayerId: nextFocusLayerId ?? null }])\n\t\t\t}\n\t\t}\n\t}\n\n\t/** @internal */\n\tprivate _pageWillBeDeleted(page: TLPage) {\n\t\t// page was deleted, need to check whether it's the current page and select another one if so\n\t\tconst instanceStates = this.store.query.exec('instance', { currentPageId: { eq: page.id } })\n\n\t\tif (!instanceStates.length) return\n\t\tconst backupPageId = this.pages.find((p) => p.id !== page.id)?.id\n\n\t\tif (!backupPageId) return\n\n\t\tthis.store.put(instanceStates.map((state) => ({ ...state, currentPageId: backupPageId })))\n\t}\n\n\t/* -------------------- Shortcuts ------------------- */\n\n\t/** The global document settings that applies to all users */\n\t@computed get documentSettings() {\n\t\treturn this.store.get(TLDOCUMENT_ID)!\n\t}\n\n\tget gridSize() {\n\t\treturn this.documentSettings.gridSize\n\t}\n\n\t/**\n\t * The user's global settings.\n\t *\n\t * @public\n\t * @readonly\n\t */\n\tget userSettings(): TLUser {\n\t\treturn this.store.get(this.userId)!\n\t}\n\n\t/** @internal */\n\t@computed private get _userDocumentSettings() {\n\t\treturn this.store.query.record('user_document', () => ({ userId: { eq: this.userId } }))\n\t}\n\n\tget userDocumentSettings(): TLUserDocument {\n\t\treturn this._userDocumentSettings.value!\n\t}\n\n\tget isReadOnly() {\n\t\treturn this.userDocumentSettings.isReadOnly\n\t}\n\n\tget isGridMode() {\n\t\treturn this.userDocumentSettings.isGridMode\n\t}\n\n\tsetGridMode(isGridMode: boolean) {\n\t\tthis.updateUserDocumentSettings({ isGridMode }, true)\n\t}\n\n\tsetDarkMode(isDarkMode: boolean) {\n\t\tthis.updateUserDocumentSettings({ isDarkMode }, true)\n\t}\n\n\t//** @public */\n\tenableReadOnlyMode() {\n\t\tthis.updateUserDocumentSettings({ isReadOnly: true })\n\t\tthis.setSelectedTool('hand')\n\t}\n\n\t/** @internal */\n\tprivate _isPenMode = atom<boolean>('isPenMode', false as any)\n\n\t/** @internal */\n\tprivate _touchEventsRemainingBeforeExitingPenMode = 0\n\n\tget isPenMode() {\n\t\treturn this._isPenMode.value\n\t}\n\n\tsetPenMode(isPenMode: boolean) {\n\t\tif (isPenMode) this._touchEventsRemainingBeforeExitingPenMode = 3\n\n\t\tthis._isPenMode.set(isPenMode)\n\t}\n\n\t// User / User App State\n\n\t/**\n\t * The current user state.\n\t *\n\t * @public\n\t */\n\tget user(): TLUser {\n\t\treturn this.store.get(this.userId)!\n\t}\n\n\t/** The current tab state */\n\tget instanceState(): TLInstance {\n\t\treturn this.store.get(this.instanceId)!\n\t}\n\n\tget cursor() {\n\t\treturn this.instanceState.cursor\n\t}\n\n\tget brush() {\n\t\treturn this.instanceState.brush\n\t}\n\n\tget scribble() {\n\t\treturn this.instanceState.scribble\n\t}\n\n\t/** @internal */\n\t@computed private get _pageState() {\n\t\treturn this.store.query.record(\n\t\t\t'instance_page_state',\n\t\t\t() => {\n\t\t\t\treturn {\n\t\t\t\t\tpageId: { eq: this.currentPageId },\n\t\t\t\t\tinstanceId: { eq: this.instanceId },\n\t\t\t\t}\n\t\t\t},\n\t\t\t'app._pageState'\n\t\t)\n\t}\n\n\t/**\n\t * The current page state.\n\t *\n\t * @public\n\t */\n\tget pageState(): TLInstancePageState {\n\t\treturn this._pageState.value!\n\t}\n\n\t/**\n\t * The current camera.\n\t */\n\t@computed get camera() {\n\t\treturn this.store.get(this.pageState.cameraId)!\n\t}\n\n\t/**\n\t * The current camera zoom level.\n\t */\n\t@computed get zoomLevel() {\n\t\treturn this.camera.z\n\t}\n\n\t/**\n\t * The current selected ids.\n\t *\n\t * @public\n\t */\n\t@computed get selectedIds() {\n\t\treturn this.pageState.selectedIds\n\t}\n\n\t/**\n\t * The current selected ids as a set\n\t * @public\n\t */\n\t@computed get selectedIdsSet(): ReadonlySet<TLShapeId> {\n\t\treturn new Set(this.selectedIds)\n\t}\n\n\t// Pages\n\n\t/** @internal */\n\t@computed private get _pages() {\n\t\treturn this.store.query.records('page')\n\t}\n\n\t/**\n\t * Info about the project's current pages.\n\t *\n\t * @public\n\t * @readonly\n\t */\n\t@computed get pages() {\n\t\treturn this._pages.value.sort(sortByIndex)\n\t}\n\n\t/**\n\t * The current page.\n\t *\n\t * @public\n\t */\n\tget currentPage() {\n\t\treturn this.getPageById(this.currentPageId)!\n\t}\n\n\t/**\n\t * The current page id.\n\t *\n\t * @public\n\t */\n\tget currentPageId() {\n\t\treturn this.instanceState.currentPageId\n\t}\n\n\t/**\n\t * Get a page by its ID.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.getPageById(myPage.id)\n\t * ```\n\t *\n\t * @public\n\t */\n\tgetPageById(id: TLPage['id']) {\n\t\treturn this.store.get(id)\n\t}\n\n\t/** @internal */\n\t@computed private get _pageStates() {\n\t\treturn this.store.query.records('instance_page_state', () => ({\n\t\t\tinstanceId: { eq: this.instanceId },\n\t\t}))\n\t}\n\n\t/**\n\t * Get a page state by its id.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.getPageStateByPageId('page1')\n\t * ```\n\t *\n\t * @public\n\t */\n\tgetPageStateByPageId(id: TLPageId) {\n\t\treturn this._pageStates.value.find((p) => p.pageId === id)\n\t}\n\n\t/**\n\t * Get a page by its ID.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.getPageById(myPage.id)\n\t * ```\n\t *\n\t * @public\n\t */\n\tgetPageInfoById(id: TLPage['id']) {\n\t\treturn this.store.get(id)\n\t}\n\n\t/**\n\t * Get shapes on a page.\n\t */\n\tgetShapesInPage(pageId: TLPageId) {\n\t\tconst result = this.store.query.exec('shape', { parentId: { eq: pageId } })\n\t\treturn this.getShapesAndDescendantsInOrder(result.map((s) => s.id))\n\t}\n\n\t/* --------------------- Shapes --------------------- */\n\n\t/**\n\t * Get the local transform for a shape as a matrix model. This transform reflects both its\n\t * translation (x, y) from from either its parent's top left corner, if the shape's parent is\n\t * another shape, or else from the 0,0 of the page, if the shape's parent is the page; and the\n\t * shape's rotation.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.getTransform(myShape)\n\t * ```\n\t *\n\t * @param shape - The shape to get the local transform for.\n\t * @public\n\t */\n\tgetTransform(shape: TLShape) {\n\t\tconst util = this.getShapeUtil(shape)\n\t\treturn util.transform(shape)\n\t}\n\n\t/**\n\t * Get the local transform of a shape's parent as a matrix model.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.getParentTransform(myShape)\n\t * ```\n\t *\n\t * @param shape - The shape to get the parent transform for.\n\t * @public\n\t */\n\tgetParentTransform(shape: TLShape) {\n\t\tif (TLPage.isId(shape.parentId)) {\n\t\t\treturn Matrix2d.Identity()\n\t\t}\n\t\treturn this._pageTransformCache.get(shape.parentId) ?? Matrix2d.Identity()\n\t}\n\n\t/**\n\t * Get the page transform (or absolute transform) of a shape.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.getPageTransform(myShape)\n\t * ```\n\t *\n\t * @param shape - The shape to get the page transform for.\n\t * @public\n\t */\n\tgetPageTransform(shape: TLShape) {\n\t\treturn this.getPageTransformById(shape.id)\n\t}\n\n\t/**\n\t * Get the page transform (or absolute transform) of a shape by its id.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.getPageTransformById(myShape)\n\t * ```\n\t *\n\t * @param id - The if of the shape to get the page transform for.\n\t * @public\n\t */\n\tgetPageTransformById(id: TLShapeId) {\n\t\treturn this._pageTransformCache.get(id)\n\t}\n\n\t/**\n\t * Get the page point (or absolute point) of a shape.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.getPagePoint(myShape)\n\t * ```\n\t *\n\t * @param shape - The shape to get the page point for.\n\t * @public\n\t */\n\tgetPagePointById(id: TLShapeId) {\n\t\tconst pageTransform = this.getPageTransformById(id)\n\t\tif (!pageTransform) return\n\t\treturn Matrix2d.applyToPoint(pageTransform, new Vec2d())\n\t}\n\n\t/**\n\t * Get the page point (or absolute point) of a shape.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.getPagePoint(myShape)\n\t * ```\n\t *\n\t * @param shape - The shape to get the page point for.\n\t * @public\n\t */\n\tgetPageCenter(shape: TLShape) {\n\t\tconst pageTransform = this.getPageTransformById(shape.id)\n\t\tif (!pageTransform) return null\n\t\tconst util = this.getShapeUtil(shape)\n\t\tconst center = util.center(shape)\n\t\treturn Matrix2d.applyToPoint(pageTransform, center)\n\t}\n\n\t/**\n\t * Get the page point (or absolute point) of a shape by its id.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.getPagePoint(myShape)\n\t * ```\n\t *\n\t * @param id - The shape id to get the page point for.\n\t * @public\n\t */\n\tgetPageCenterById(id: TLShapeId) {\n\t\tconst shape = this.getShapeById(id)!\n\t\treturn this.getPageCenter(shape)\n\t}\n\n\t/**\n\t * Get the page rotation (or absolute rotation) of a shape.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.getPageRotation(myShape)\n\t * ```\n\t *\n\t * @param shape - The shape to get the page rotation for.\n\t * @public\n\t */\n\tgetPageRotation(shape: TLShape): number {\n\t\treturn this.getPageRotationById(shape.id)\n\t}\n\n\t/**\n\t * Get the page rotation (or absolute rotation) of a shape by its id.\n\t *\n\t * @param id - The id of the shape to get the page rotation for.\n\t */\n\tgetPageRotationById(id: TLShapeId): number {\n\t\tconst pageTransform = this.getPageTransformById(id)\n\t\tif (pageTransform) {\n\t\t\treturn Matrix2d.Decompose(pageTransform).rotation\n\t\t}\n\t\treturn 0\n\t}\n\n\t/**\n\t * Get the local bounds of a shape.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.getBounds(myShape)\n\t * ```\n\t *\n\t * @param shape - The shape to get the bounds for.\n\t * @public\n\t */\n\tgetBounds(shape: TLShape): Box2d {\n\t\treturn this.getShapeUtil(shape).bounds(shape)\n\t}\n\n\t/**\n\t * Get the local bounds of a shape by its id.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.getBoundsById(myShape)\n\t * ```\n\t *\n\t * @param id - The id of the shape to get the bounds for.\n\t * @public\n\t */\n\tgetBoundsById(id: TLShapeId): Box2d | undefined {\n\t\tconst shape = this.getShapeById(id)\n\t\tif (!shape) return undefined\n\t\treturn this.getBounds(shape)\n\t}\n\n\t/**\n\t * Get the page (or absolute) bounds of a shape.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.getPageBounds(myShape)\n\t * ```\n\t *\n\t * @param shape - The shape to get the bounds for.\n\t * @public\n\t */\n\tgetPageBounds(shape: TLShape): Box2d | undefined {\n\t\treturn this.getPageBoundsById(shape.id)\n\t}\n\n\t/**\n\t * Get the page (or absolute) bounds of a shape by its id.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.getPageBoundsById(myShape)\n\t * ```\n\t *\n\t * @param id - The id of the shape to get the page bounds for.\n\t * @public\n\t */\n\tgetPageBoundsById(id: TLShapeId): Box2d | undefined {\n\t\treturn this._pageBoundsCache.get(id)\n\t}\n\n\t/**\n\t * Get the page (or absolute) bounds of a shape, incorporating any masks.\n\t * For example, if the shape were the child of a frame and was half way out of the frame,\n\t * the bounds would be the half of the shape that was in the frame.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.getMaskedPageBounds(myShape)\n\t * ```\n\t *\n\t * @param shape - The shape to get the masked bounds for.\n\t * @public\n\t */\n\tgetMaskedPageBounds(shape: TLShape): Box2d | undefined {\n\t\treturn this.getMaskedPageBoundsById(shape.id)\n\t}\n\n\t/**\n\t * Get the page (or absolute) bounds of a shape by its id, incorporating any masks.\n\t * For example, if the shape were the child of a frame and was half way out of the frame,\n\t * the bounds would be the half of the shape that was in the frame.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.getMaskedPageBoundsById(myShape)\n\t * ```\n\t *\n\t * @param id - The id of the shape to get the masked page bounds for.\n\t * @public\n\t */\n\tgetMaskedPageBoundsById(id: TLShapeId): Box2d | undefined {\n\t\tconst pageBounds = this._pageBoundsCache.get(id)\n\t\tif (!pageBounds) return\n\t\tconst pageMask = this._pageMaskCache.get(id)\n\t\tif (pageMask) {\n\t\t\tconst intersection = intersectPolygonPolygon(pageMask, pageBounds.corners)\n\t\t\tif (!intersection) return\n\t\t\treturn Box2d.FromPoints(intersection)\n\t\t}\n\t\treturn pageBounds\n\t}\n\n\t/**\n\t * Get the local outline of a shape.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.getOutline(myShape)\n\t * ```\n\t *\n\t * @param shape - The shape to get the outline for.\n\t * @public\n\t */\n\tgetOutline(shape: TLShape) {\n\t\treturn this.getShapeUtil(shape).outline(shape)\n\t}\n\n\t/**\n\t * Get the local outline of a shape.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.getOutlineById(myShape)\n\t * ```\n\t *\n\t * @param id - The shape id to get the outline for.\n\t * @public\n\t */\n\tgetOutlineById(id: TLShapeId) {\n\t\treturn this.getOutline(this.getShapeById(id)!)\n\t}\n\n\t/**\n\t * Get the ancestors of a shape.\n\t *\n\t * @example\n\t * ```ts\n\t * \tconst ancestors = app.getAncestors(myShape)\n\t * ```\n\t *\n\t * @param shape - The shape to get the ancestors for.\n\t * @public\n\t */\n\tgetAncestors(shape: TLShape, acc: TLShape[] = []): TLShape[] {\n\t\tconst parentId = shape.parentId\n\t\tif (TLPage.isId(parentId)) {\n\t\t\tacc.reverse()\n\t\t\treturn acc\n\t\t}\n\n\t\tconst parent = this.store.get(parentId)!\n\t\tacc.push(parent)\n\t\treturn this.getAncestors(parent, acc)\n\t}\n\n\t/**\n\t * Get the ancestors of a shape by its id.\n\t *\n\t * @example\n\t * ```ts\n\t * \tconst ancestors = app.getAncestorsById(myShape)\n\t * ```\n\t *\n\t * @param id - The id of the shape to get the ancestors for.\n\t * @public\n\t */\n\tgetAncestorsById(id: TLShapeId, acc: TLShape[] = []): TLShape[] {\n\t\tconst shape = this.getShapeById(id)!\n\t\treturn this.getAncestors(shape, acc)\n\t}\n\n\t/**\n\t * Find the first ancestor matching the given predicate\n\t *\n\t * @example\n\t * ```ts\n\t * \tconst ancestor = app.findAncestor(myShape)\n\t * ```\n\t *\n\t * @param shape - The shape to check the ancestors for.\n\t * @public\n\t */\n\tfindAncestor(shape: TLShape, predicate: (parent: TLShape) => boolean): TLShape | undefined {\n\t\tconst parentId = shape.parentId\n\n\t\tif (TLPage.isId(parentId)) {\n\t\t\treturn undefined\n\t\t}\n\n\t\tconst parent = this.getShapeById(parentId)\n\n\t\tif (parent) {\n\t\t\tif (predicate(parent)) {\n\t\t\t\treturn parent\n\t\t\t}\n\t\t\treturn this.findAncestor(parent, predicate)\n\t\t}\n\n\t\treturn undefined\n\t}\n\n\t/**\n\t * Returns true if the the given shape has the given ancestor\n\t *\n\t */\n\thasAncestor(shape: TLShape | undefined, ancestorId: TLShapeId): boolean {\n\t\tif (!shape) return false\n\t\tif (shape.parentId === ancestorId) return true\n\t\treturn this.hasAncestor(this.getParentShape(shape), ancestorId)\n\t}\n\n\t/**\n\t * Get the common ancestor of two or more shapes that matches a predicate.\n\t *\n\t * @param shapes - The shapes to check.\n\t * @param predicate - The predicate to match.\n\t */\n\tfindCommonAncestor(\n\t\tshapes: TLShape[],\n\t\tpredicate?: (shape: TLShape) => boolean\n\t): TLShapeId | undefined {\n\t\tif (shapes.length === 0) {\n\t\t\treturn\n\t\t}\n\t\tif (shapes.length === 1) {\n\t\t\tconst parentId = shapes[0].parentId\n\t\t\tif (TLPage.isId(parentId)) {\n\t\t\t\treturn\n\t\t\t}\n\t\t\treturn predicate ? this.findAncestor(shapes[0], predicate)?.id : parentId\n\t\t}\n\n\t\tconst [nodeA, ...others] = shapes\n\t\tlet ancestor = this.getParentShape(nodeA)\n\t\twhile (ancestor) {\n\t\t\t// TODO: this is not ideal, optimize\n\t\t\tif (predicate && !predicate(ancestor)) {\n\t\t\t\tancestor = this.getParentShape(ancestor)\n\t\t\t\tcontinue\n\t\t\t}\n\t\t\tif (others.every((shape) => this.hasAncestor(shape, ancestor!.id))) {\n\t\t\t\treturn ancestor!.id\n\t\t\t}\n\t\t\tancestor = this.getParentShape(ancestor)\n\t\t}\n\t\treturn undefined\n\t}\n\n\t/**\n\t * Check whether a shape is within the bounds of the current viewport.\n\t *\n\t * @param id - The id of the shape to check.\n\t *\n\t * @public\n\t */\n\tisShapeInViewport(id: TLShapeId) {\n\t\tconst pageBounds = this.getPageBoundsById(id)\n\t\tif (!pageBounds) return false\n\t\treturn this.viewportPageBounds.includes(pageBounds)\n\t}\n\n\t/**\n\t * Get the shapes that should be displayed in the current viewport.\n\t *\n\t * @public\n\t */\n\t@computed get renderingShapes() {\n\t\t// Here we get the shape as well as any of its children, as well as their\n\t\t// opacities. If the shape is beign erased, and none of its ancestors are\n\t\t// being erased, then we reduce the opacity of the shape and all of its\n\t\t// ancestors; but we don't apply this effect more than once among a set\n\t\t// of descendants so that it does not compound.\n\n\t\t// This is designed to keep all the shapes in a single list which\n\t\t// allows the DOM nodes to be reused even when they become children\n\t\t// of other nodes.\n\n\t\t// Its IMPORTANT that the result be sorted by id AND include the index\n\t\t// that the shape should be displayed at. Steve, this is the past you\n\t\t// telling the present you not to change this.\n\n\t\t// We want to sort by id because moving elements about in the DOM will\n\t\t// cause the element to get removed by react as it moves the DOM node. This\n\t\t// causes <iframes/> to re-render which is hella annoying and a perf\n\t\t// drain. By always sorting by 'id' we keep the shapes always in the\n\t\t// same order; but we later use index to set the element's 'z-index'\n\t\t// to change the \"rendered\" position in z-space.\n\n\t\tconst { currentPageId, cullingBounds, cullingBoundsExpanded, erasingIdsSet, editingId } = this\n\n\t\tconst renderingShapes: {\n\t\t\tid: TLShapeId\n\t\t\tindex: number\n\t\t\topacity: number\n\t\t\tisCulled: boolean\n\t\t\tisInViewport: boolean\n\t\t}[] = []\n\n\t\tconst getShapeToDisplay = (\n\t\t\tid: TLShapeId,\n\t\t\tparentOpacity: number,\n\t\t\tisAncestorErasing: boolean\n\t\t) => {\n\t\t\tconst shape = this.getShapeById(id)\n\n\t\t\tif (!shape) return\n\n\t\t\t// todo: move opacity to a property of shape, rather than a property of props\n\t\t\tlet opacity = (+(shape.props as { opacity: string }).opacity ?? 1) * parentOpacity\n\t\t\tlet isShapeErasing = false\n\n\t\t\tif (!isAncestorErasing && erasingIdsSet.has(id)) {\n\t\t\t\tisShapeErasing = true\n\t\t\t\topacity *= 0.32\n\t\t\t}\n\n\t\t\t// If a child is outside of its parent's clipping bounds, then bounds will be undefined.\n\t\t\tconst bounds = this.getMaskedPageBoundsById(id)\n\n\t\t\t// Whether the shape is on screen. Use the \"strict\" viewport here.\n\t\t\tconst isInViewport = bounds ? cullingBounds.includes(bounds) : false\n\n\t\t\t// Whether the shape should actually be culled / unmounted.\n\t\t\t// - Use the \"expanded\" culling viewport to include shapes that are just off-screen.\n\t\t\t// - Editing shapes should never be culled.\n\t\t\tconst isCulled = bounds ? editingId !== id && !cullingBoundsExpanded.includes(bounds) : true\n\n\t\t\trenderingShapes.push({ id, index: renderingShapes.length, opacity, isCulled, isInViewport })\n\n\t\t\tthis.getSortedChildIds(id).forEach((id) => {\n\t\t\t\tgetShapeToDisplay(id, opacity, isAncestorErasing || isShapeErasing)\n\t\t\t})\n\t\t}\n\n\t\tthis.getSortedChildIds(currentPageId).forEach((shapeId) => getShapeToDisplay(shapeId, 1, false))\n\n\t\treturn renderingShapes.sort(sortById)\n\t}\n\n\t/**\n\t * The common bounds of all of the shapes on the page.\n\t *\n\t * @public\n\t */\n\t@computed get allShapesCommonBounds(): Box2d | null {\n\t\tlet commonBounds = null as Box2d | null\n\n\t\tthis.shapeIds.forEach((shapeId) => {\n\t\t\tconst bounds = this.getMaskedPageBoundsById(shapeId)\n\t\t\tif (bounds) {\n\t\t\t\tif (commonBounds) {\n\t\t\t\t\tcommonBounds.expand(bounds)\n\t\t\t\t} else {\n\t\t\t\t\tcommonBounds = bounds.clone()\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\n\t\treturn commonBounds\n\t}\n\n\t/**\n\t * Get the corners of a shape in page space.\n\t *\n\t * @example\n\t * ```ts\n\t * \tconst corners = app.getPageCorners(myShape)\n\t * ```\n\t *\n\t * @param shape - The shape to get the corners for.\n\t * @public\n\t */\n\tgetPageCorners(shape: TLShape): Vec2d[] {\n\t\tconst ancestors = this.getAncestors(shape)\n\t\tconst corners = this.getBounds(shape).corners\n\n\t\tconst transform = Matrix2d.Compose(\n\t\t\t...ancestors.flatMap((s) => [Matrix2d.Translate(s.x, s.y), Matrix2d.Rotate(s.rotation)]),\n\t\t\tMatrix2d.Translate(shape.x, shape.y),\n\t\t\tMatrix2d.Rotate(shape.rotation, 0, 0)\n\t\t)\n\n\t\treturn Matrix2d.applyToPoints(transform, corners)\n\t}\n\n\t/**\n\t * Test whether a point (in page space) will will a shape. This method takes into\n\t * account masks, such as when a shape is the child of a frame and is partially\n\t * clipped by the frame.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.isPointInShape({ x: 100, y: 100 }, myShape)\n\t * ```\n\t *\n\t * @param point - The page point to test.\n\t * @param shape - The shape to test against.\n\t * @public\n\t */\n\tisPointInShape(point: VecLike, shape: TLShape): boolean {\n\t\tconst util = this.getShapeUtil(shape)\n\n\t\tconst pageMask = this._pageMaskCache.get(shape.id)\n\n\t\tif (pageMask) {\n\t\t\tconst hit = pointInPolygon(point, pageMask)\n\t\t\tif (!hit) return false\n\t\t}\n\n\t\treturn util.hitTestPoint(shape, this.getPointInShapeSpace(shape, point))\n\t}\n\n\t/**\n\t * Get the shapes, if any, at a given page point.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.getShapesAtPoint({ x: 100, y: 100 })\n\t * ```\n\t *\n\t * @param point - The page point to test.\n\t * @public\n\t */\n\tgetShapesAtPoint(point: VecLike): TLShape[] {\n\t\treturn this.sortedShapesArray.filter((shape) => {\n\t\t\tconst pageMask = this._pageMaskCache.get(shape.id)\n\t\t\tif (pageMask) {\n\t\t\t\tconst hasHit = pointInPolygon(point, pageMask)\n\t\t\t\tif (!hasHit) return false\n\t\t\t}\n\n\t\t\treturn this.getShapeUtil(shape).hitTestPoint(shape, this.getPointInShapeSpace(shape, point))\n\t\t})\n\t}\n\n\t/**\n\t * Convert a point in page space to a point in the local space of a shape. For example, if a\n\t * shape's page point were `{ x: 100, y: 100 }`, a page point at `{ x: 110, y: 110 }` would be at\n\t * `{ x: 10, y: 10 }` in the shape's local space.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.getPointInShapeSpace(myShape, { x: 100, y: 100 })\n\t * ```\n\t *\n\t * @param shape - The shape to get the point in the local space of.\n\t * @param point - The page point to get in the local space of the shape.\n\t * @public\n\t */\n\tgetPointInShapeSpace(shape: TLShape, point: VecLike): Vec2d {\n\t\treturn Matrix2d.applyToPoint(Matrix2d.Inverse(this.getPageTransform(shape)!), point)\n\t}\n\n\t/**\n\t * Convert a delta in page space to a point in the local space of a shape. For example, if a\n\t * shape's page point were `{ x: 100, y: 100 }`, a page point at `{ x: 110, y: 110 }` would be at\n\t * `{ x: 10, y: 10 }` in the shape's local space.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.getPointInShapeSpace(myShape.id, { x: 100, y: 100 })\n\t * ```\n\t *\n\t * @param shape - The shape to get the point in the local space of.\n\t * @param point - The page point to get in the local space of the shape.\n\t * @public\n\t */\n\tgetPointInParentSpace(shapeId: TLShapeId, point: VecLike): Vec2d {\n\t\tconst shape = this.getShapeById(shapeId)!\n\t\tif (!shape) {\n\t\t\treturn new Vec2d(0, 0)\n\t\t}\n\t\tif (TLPage.isId(shape.parentId)) return Vec2d.From(point)\n\n\t\tconst parentTransform = this.getPageTransformById(shape.parentId)\n\t\tif (!parentTransform) return Vec2d.From(point)\n\n\t\treturn Matrix2d.applyToPoint(Matrix2d.Inverse(parentTransform), point)\n\t}\n\n\t/**\n\t * Convert a delta in page space to a delta in the local space of a shape.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.getDeltaInShapeSpace(myShape, { x: 100, y: 100 })\n\t * ```\n\t *\n\t * @param shape - The shape to get the delta in the local space of.\n\t * @param delta - The page delta to convert.\n\t * @public\n\t */\n\tgetDeltaInShapeSpace(shape: TLShape, delta: VecLike): Vec2d {\n\t\tconst pageTransform = this.getPageTransform(shape)\n\t\tif (!pageTransform) return Vec2d.From(delta)\n\t\treturn Vec2d.Rot(delta, -Matrix2d.Decompose(pageTransform).rotation)\n\t}\n\n\t/**\n\t * Convert a delta in page space to a delta in the parent space of a shape.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.getDeltaInParentSpace(myShape, { x: 100, y: 100 })\n\t * ```\n\t *\n\t * @param shape - The shape to get the delta in the parent space of.\n\t * @param delta - The page delta to convert.\n\t * @public\n\t */\n\tgetDeltaInParentSpace(shape: TLShape, delta: VecLike): Vec2d {\n\t\tif (TLPage.isId(shape.parentId)) return Vec2d.From(delta)\n\n\t\tconst parent = this.getShapeById(shape.parentId)\n\t\tif (!parent) return Vec2d.From(delta)\n\n\t\treturn this.getDeltaInShapeSpace(parent, delta)\n\t}\n\n\t/**\n\t * For a given set of ids, get a map containing the ids of their parents and the children of those\n\t * parents.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.getParentsMappedToChildren(['id1', 'id2', 'id3'])\n\t * ```\n\t *\n\t * @param ids - The ids to get the parents and children of.\n\t * @public\n\t */\n\tgetParentsMappedToChildren(ids: TLShapeId[]) {\n\t\tconst shapes = ids.map((id) => this.store.get(id)!)\n\t\tconst parents = new Map<TLParentId, Set<TLShape>>()\n\t\tshapes.forEach((shape) => {\n\t\t\tif (!parents.has(shape.parentId)) {\n\t\t\t\tparents.set(shape.parentId, new Set())\n\t\t\t}\n\t\t\tparents.get(shape.parentId)?.add(shape)\n\t\t})\n\t\treturn parents\n\t}\n\n\t/* -------------------- Viewport -------------------- */\n\n\t/**\n\t * Update the viewport. The viewport will measure the size and\n\t * screen position of its container element. This should be done whenever\n\t * the container's position on the screen changes.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.updateViewportScreenBounds()\n\t * ```\n\t *\n\t * @param center - Whether to preserve the viewport page center as the viewport changes. (optional)\n\t *\n\t * @public\n\t */\n\tupdateViewportScreenBounds(center = false) {\n\t\tconst container = this.getContainer()\n\n\t\tif (!container) return this\n\t\tconst rect = container.getBoundingClientRect()\n\t\tconst screenBounds = new Box2d(0, 0, Math.max(rect.width, 1), Math.max(rect.height, 1))\n\n\t\tconst boundsAreEqual = screenBounds.equals(this.viewportScreenBounds)\n\n\t\t// Get the current value\n\t\tconst { _willSetInitialBounds } = this\n\n\t\tif (boundsAreEqual) {\n\t\t\tthis._willSetInitialBounds = false\n\t\t} else {\n\t\t\tif (_willSetInitialBounds) {\n\t\t\t\t// If we have just received the initial bounds, don't center the camera.\n\t\t\t\tthis._willSetInitialBounds = false\n\t\t\t\tthis.updateInstanceState({ screenBounds: screenBounds.toJson() }, true, true)\n\t\t\t} else {\n\t\t\t\tconst { zoomLevel } = this\n\t\t\t\tif (center) {\n\t\t\t\t\tconst before = this.viewportPageCenter\n\t\t\t\t\tthis.updateInstanceState({ screenBounds: screenBounds.toJson() }, true, true)\n\t\t\t\t\tconst after = this.viewportPageCenter\n\t\t\t\t\tthis.pan((after.x - before.x) * zoomLevel, (after.y - before.y) * zoomLevel)\n\t\t\t\t} else {\n\t\t\t\t\tconst before = this.screenToPage(0, 0)\n\t\t\t\t\tthis.updateInstanceState({ screenBounds: screenBounds.toJson() }, true, true)\n\t\t\t\t\tconst after = this.screenToPage(0, 0)\n\t\t\t\t\tthis.pan((after.x - before.x) * zoomLevel, (after.y - before.y) * zoomLevel)\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis._cameraManager.tick()\n\t\tthis.updateCullingBounds()\n\n\t\tconst { editingId } = this\n\n\t\tif (editingId) {\n\t\t\tthis.panZoomIntoView([editingId])\n\t\t}\n\n\t\treturn this\n\t}\n\n\t/**\n\t * The bounds of the editor's viewport in screen space.\n\t *\n\t * @public\n\t */\n\t@computed get viewportScreenBounds() {\n\t\tconst { x, y, w, h } = this.instanceState.screenBounds\n\t\treturn new Box2d(x, y, w, h)\n\t}\n\n\t/**\n\t * The center of the editor's viewport in screen space.\n\t *\n\t * @public\n\t */\n\t@computed get viewportScreenCenter() {\n\t\treturn this.viewportScreenBounds.center\n\t}\n\n\t/**\n\t * The current viewport in page space.\n\t *\n\t * @public\n\t */\n\t@computed get viewportPageBounds() {\n\t\tconst { x, y, w, h } = this.viewportScreenBounds\n\t\tconst tl = this.screenToPage(x, y)\n\t\tconst br = this.screenToPage(x + w, y + h)\n\t\treturn new Box2d(tl.x, tl.y, br.x - tl.x, br.y - tl.y)\n\t}\n\n\t/**\n\t * The current culling bounds in page space, used for checking which shapes are \"on screen\".\n\t *\n\t * @public\n\t */\n\t@computed get cullingBounds() {\n\t\treturn this._cullingBounds.value\n\t}\n\n\t/** @internal */\n\treadonly _cullingBounds = atom('culling viewport', new Box2d())\n\n\t/**\n\t * The current culling bounds in page space, expanded slightly. Used for determining which shapes to render and which to \"cull\".\n\t *\n\t * @public\n\t */\n\t@computed get cullingBoundsExpanded() {\n\t\treturn this._cullingBoundsExpanded.value\n\t}\n\n\t/** @internal */\n\treadonly _cullingBoundsExpanded = atom('culling viewport expanded', new Box2d())\n\n\t/**\n\t * Update the culling bounds. This should be called when the viewport has stopped changing, such as at the end of a pan, zoom, or animation.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.updateCullingBounds()\n\t * ```\n\t *\n\t * @internal\n\t */\n\tupdateCullingBounds(): this {\n\t\tconst { viewportPageBounds } = this\n\t\tif (viewportPageBounds.equals(this._cullingBounds.__unsafe__getWithoutCapture())) return this\n\t\tthis._cullingBounds.set(viewportPageBounds.clone())\n\t\tthis._cullingBoundsExpanded.set(viewportPageBounds.clone().expandBy(100 / this.zoomLevel))\n\t\treturn this\n\t}\n\n\t/**\n\t * The center of the viewport in page space.\n\t *\n\t * @public\n\t */\n\t@computed get viewportPageCenter() {\n\t\treturn this.viewportPageBounds.center\n\t}\n\n\t/**\n\t * Convert a point in screen space to a point in page space.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.screenToPage(100, 100)\n\t * ```\n\t *\n\t * @param x - The x coordinate of the point in screen space.\n\t * @param y - The y coordinate of the point in screen space.\n\t * @param camera - The camera to use. Defaults to the current camera.\n\t * @public\n\t */\n\tscreenToPage(x: number, y: number, z = 0.5, camera: Vec2dModel = this.camera) {\n\t\tconst { screenBounds } = this.store.unsafeGetWithoutCapture(this.instanceId)!\n\t\tconst { x: cx, y: cy, z: cz = 1 } = camera\n\t\treturn {\n\t\t\tx: (x - screenBounds.x) / cz - cx,\n\t\t\ty: (y - screenBounds.y) / cz - cy,\n\t\t\tz,\n\t\t}\n\t}\n\n\t/**\n\t * Convert a point in page space to a point in screen space.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.pageToScreen(100, 100)\n\t * ```\n\t *\n\t * @param x - The x coordinate of the point in screen space.\n\t * @param y - The y coordinate of the point in screen space.\n\t * @param camera - The camera to use. Defaults to the current camera.\n\t * @public\n\t */\n\tpageToScreen(x: number, y: number, z = 0.5, camera: Vec2dModel = this.camera) {\n\t\tconst { x: cx, y: cy, z: cz = 1 } = camera\n\t\treturn {\n\t\t\tx: x + cx * cz,\n\t\t\ty: y + cy * cz,\n\t\t\tz,\n\t\t}\n\t}\n\n\t/* Focus Layers */\n\n\tget focusLayerId() {\n\t\treturn this.pageState.focusLayerId ?? this.currentPageId\n\t}\n\n\tget focusLayerShape(): TLShape | undefined {\n\t\tconst id = this.pageState.focusLayerId\n\t\tif (!id) {\n\t\t\treturn\n\t\t}\n\t\treturn this.getShapeById(id)\n\t}\n\n\tpopFocusLayer() {\n\t\tconst current = this.pageState.focusLayerId\n\t\tconst focusedShape = current && this.getShapeById(current)\n\n\t\tif (focusedShape) {\n\t\t\t// If we have a focused layer, look for an ancestor of the focused shape that is a group\n\t\t\tconst match = this.findAncestor(focusedShape, (s) => s.type === 'group')\n\t\t\t// If we have an ancestor that can become a focused layer, set it as the focused layer\n\t\t\tthis.setFocusLayer(match?.id ?? null)\n\t\t\tthis.select(focusedShape.id)\n\t\t} else {\n\t\t\t// If there's no focused shape, then clear the focus layer and clear selection\n\t\t\tthis.setFocusLayer(null)\n\t\t\tthis.selectNone()\n\t\t}\n\n\t\treturn this\n\t}\n\n\t/**\n\t * Set the focus layer to the given shape id.\n\t *\n\t * @param next - The next focus layer id or null to reset the focus layer to the page\n\t *\n\t * @public\n\t */\n\tsetFocusLayer(next: null | TLShapeId) {\n\t\tthis._setFocusLayer(next)\n\t\treturn this\n\t}\n\n\t/** @internal */\n\tprivate _setFocusLayer = this.history.createCommand(\n\t\t'setFocusLayer',\n\t\t(next: null | TLShapeId) => {\n\t\t\t// When we first click an empty canvas we don't want this to show up in the undo stack\n\t\t\tif (next === null && !this.canUndo) {\n\t\t\t\treturn\n\t\t\t}\n\t\t\tconst prev = this.pageState.focusLayerId\n\t\t\treturn { data: { prev, next }, preservesRedoStack: true, squashing: true }\n\t\t},\n\t\t{\n\t\t\tdo: ({ next }) => {\n\t\t\t\tthis.store.update(this.pageState.id, (s) => ({ ...s, focusLayerId: next }))\n\t\t\t},\n\t\t\tundo: ({ prev }) => {\n\t\t\t\tthis.store.update(this.pageState.id, (s) => ({ ...s, focusLayerId: prev }))\n\t\t\t},\n\t\t\tsquash({ prev }, { next }) {\n\t\t\t\treturn { prev, next }\n\t\t\t},\n\t\t}\n\t)\n\n\t/**\n\t * Set the hinted shape ids.\n\t *\n\t * @param ids - The ids to set as hinted.\n\t *\n\t * @public\n\t */\n\tsetHintingIds(ids: TLShapeId[]): this {\n\t\t// always ephemeral\n\t\tthis.store.update(this.pageState.id, (s) => ({ ...s, hintingIds: dedupe(ids) }))\n\t\treturn this\n\t}\n\n\t/**\n\t * The current editing shape's id.\n\t *\n\t * @public\n\t */\n\tget editingId() {\n\t\treturn this.pageState.editingId\n\t}\n\n\t@computed get editingShape() {\n\t\tif (!this.editingId) return null\n\t\treturn this.getShapeById(this.editingId) ?? null\n\t}\n\n\t/**\n\t * Set the current editing id.\n\t *\n\t * @param id - The id of the shape to edit or null to clear the editing id.\n\t *\n\t * @public\n\t */\n\tsetEditingId(id: TLShapeId | null): this {\n\t\tif (!id) {\n\t\t\tthis.setInstancePageState({ editingId: null })\n\t\t} else {\n\t\t\tif (id !== this.editingId) {\n\t\t\t\tconst shape = this.getShapeById(id)!\n\t\t\t\tconst util = this.getShapeUtil(shape)\n\t\t\t\tif (shape && util.canEdit(shape)) {\n\t\t\t\t\tthis.setInstancePageState({ editingId: id, hoveredId: null }, false)\n\t\t\t\t\tconst { viewportPageBounds } = this\n\t\t\t\t\tconst localEditingBounds = util.getEditingBounds(shape)!\n\t\t\t\t\tconst pageTransform = this.getPageTransformById(id)!\n\t\t\t\t\tconst pageEditingBounds = Box2d.FromPoints(\n\t\t\t\t\t\tMatrix2d.applyToPoints(pageTransform, localEditingBounds.corners)\n\t\t\t\t\t)\n\n\t\t\t\t\tif (!viewportPageBounds.contains(pageEditingBounds)) {\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tpageEditingBounds.width > viewportPageBounds.width ||\n\t\t\t\t\t\t\tpageEditingBounds.height > viewportPageBounds.height\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tthis.zoomToBounds(\n\t\t\t\t\t\t\t\tpageEditingBounds.minX,\n\t\t\t\t\t\t\t\tpageEditingBounds.minY,\n\t\t\t\t\t\t\t\tpageEditingBounds.width,\n\t\t\t\t\t\t\t\tpageEditingBounds.height\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.centerOnPoint(pageEditingBounds.midX, pageEditingBounds.midY)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn this\n\t}\n\n\tgetParentIdForNewShapeAtPoint(point: VecLike, shapeType: TLShapeType) {\n\t\tconst shapes = this.sortedShapesArray\n\n\t\tfor (let i = shapes.length - 1; i >= 0; i--) {\n\t\t\tconst shape = shapes[i]\n\t\t\tconst util = this.getShapeUtil(shape)\n\t\t\tif (!util.canReceiveNewChildrenOfType(shapeType)) continue\n\t\t\tconst maskedPageBounds = this.getMaskedPageBoundsById(shape.id)\n\t\t\tif (\n\t\t\t\tmaskedPageBounds &&\n\t\t\t\tmaskedPageBounds.containsPoint(point) &&\n\t\t\t\tutil.hitTestPoint(shape, this.getPointInShapeSpace(shape, point))\n\t\t\t) {\n\t\t\t\treturn shape.id\n\t\t\t}\n\t\t}\n\n\t\treturn this.focusLayerId\n\t}\n\n\tgetDroppingShape(point: VecLike, droppingShapes: TLShape[] = []) {\n\t\tconst shapes = this.sortedShapesArray\n\n\t\tfor (let i = shapes.length - 1; i >= 0; i--) {\n\t\t\tconst shape = shapes[i]\n\t\t\t// don't allow dropping a shape on itself or one of it's children\n\t\t\tif (droppingShapes.find((s) => s.id === shape.id || this.hasAncestor(shape, s.id))) continue\n\t\t\tconst util = this.getShapeUtil(shape)\n\t\t\tif (!util.canDropShapes(shape, droppingShapes)) continue\n\t\t\tconst maskedPageBounds = this.getMaskedPageBoundsById(shape.id)\n\t\t\tif (\n\t\t\t\tmaskedPageBounds &&\n\t\t\t\tmaskedPageBounds.containsPoint(point) &&\n\t\t\t\tutil.hitTestPoint(shape, this.getPointInShapeSpace(shape, point))\n\t\t\t) {\n\t\t\t\treturn shape\n\t\t\t}\n\t\t}\n\n\t\treturn undefined\n\t}\n\n\t// This returns the node that should be selected when you click on this one, assuming there is nothing\n\t// already selected. It will not return anything higher than or including the current focus layer.\n\tgetOutermostSelectableShape(shape: TLShape, filter?: (shape: TLShape) => boolean): TLShape {\n\t\tlet match = shape\n\t\tlet node = shape as TLShape | undefined\n\t\twhile (node) {\n\t\t\tif (\n\t\t\t\tnode.type === 'group' &&\n\t\t\t\tthis.focusLayerId !== node.id &&\n\t\t\t\t!this.hasAncestor(this.focusLayerShape, node.id) &&\n\t\t\t\t(filter?.(node) ?? true)\n\t\t\t) {\n\t\t\t\tmatch = node\n\t\t\t} else if (this.focusLayerId === node.id) {\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tnode = this.getParentShape(node)\n\t\t}\n\n\t\treturn match\n\t}\n\n\t/* --------------------- Shapes --------------------- */\n\n\t/**\n\t * The app's set of styles.\n\t *\n\t * @public\n\t */\n\tstatic styles = STYLES\n\n\t/**\n\t * The current page bounds of all the selected shapes (Not the same thing as the page bounds of\n\t * the selection bounding box when the selection has been rotated)\n\t *\n\t * @readonly\n\t * @public\n\t */\n\t@computed get selectedPageBounds(): Box2d | null {\n\t\tconst {\n\t\t\tpageState: { selectedIds },\n\t\t} = this\n\n\t\tif (selectedIds.length === 0) return null\n\n\t\treturn Box2d.Common(compact(selectedIds.map((id) => this.getPageBoundsById(id))))\n\t}\n\n\t/** The rotation of the selection bounding box. */\n\t@computed get selectionRotation(): number {\n\t\tconst { selectedIds } = this\n\t\tif (selectedIds.length === 0) {\n\t\t\treturn 0\n\t\t}\n\t\tif (selectedIds.length === 1) {\n\t\t\treturn this.getPageRotationById(this.selectedIds[0])\n\t\t}\n\n\t\tconst allRotations = selectedIds.map((id) => this.getPageRotationById(id) % (Math.PI / 2))\n\t\t// if the rotations are all compatible with each other, return the rotation of any one of them\n\t\tif (allRotations.every((rotation) => Math.abs(rotation - allRotations[0]) < Math.PI / 180)) {\n\t\t\treturn this.getPageRotationById(selectedIds[0])\n\t\t}\n\t\treturn 0\n\t}\n\n\t@computed get selectionBounds(): Box2d | undefined {\n\t\tconst { selectedIds } = this\n\n\t\tif (selectedIds.length === 0) {\n\t\t\treturn undefined\n\t\t}\n\n\t\tconst { selectionRotation } = this\n\t\tif (selectionRotation === 0) {\n\t\t\treturn this.selectedPageBounds!\n\t\t}\n\n\t\tif (selectedIds.length === 1) {\n\t\t\tconst bounds = this.getBounds(this.getShapeById(selectedIds[0])!).clone()\n\t\t\tbounds.point = Matrix2d.applyToPoint(this.getPageTransformById(selectedIds[0])!, bounds.point)\n\t\t\treturn bounds\n\t\t}\n\n\t\t// need to 'un-rotate' all the outlines of the existing nodes so we can fit them inside a box\n\t\tconst allPoints = this.selectedIds\n\t\t\t.flatMap((id) => {\n\t\t\t\tconst pageTransform = this.getPageTransformById(id)\n\t\t\t\tif (!pageTransform) return []\n\t\t\t\treturn this.getOutlineById(id).map((point) => Matrix2d.applyToPoint(pageTransform, point))\n\t\t\t})\n\t\t\t.map((p) => Vec2d.Rot(p, -selectionRotation))\n\t\tconst box = Box2d.FromPoints(allPoints)\n\t\t// now position box so that it's top-left corner is in the right place\n\t\tbox.point = box.point.rot(selectionRotation)\n\t\treturn box\n\t}\n\n\t@computed get selectionPageCenter() {\n\t\tconst { selectionBounds, selectionRotation } = this\n\t\tif (!selectionBounds) return null\n\t\treturn Vec2d.RotWith(selectionBounds.center, selectionBounds.point, selectionRotation)\n\t}\n\n\t/**\n\t * An array containing all of the shapes in the current page.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.shapesArray\n\t * ```\n\t *\n\t * @readonly\n\t * @public\n\t */\n\t@computed get shapesArray() {\n\t\treturn Array.from(this.shapeIds).map((id) => this.store.get(id)! as TLShape)\n\t}\n\n\t/**\n\t * An array containing all of the shapes in the current page, sorted in z-index order (accounting\n\t * for nested shapes): e.g. A, B, BA, BB, C.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.sortedShapesArray\n\t * ```\n\t *\n\t * @readonly\n\t * @public\n\t */\n\t@computed get sortedShapesArray(): TLShape[] {\n\t\tconst shapes = new Set(this.shapesArray.sort(sortByIndex))\n\n\t\tconst results: TLShape[] = []\n\n\t\tfunction pushShapeWithDescendants(shape: TLShape): void {\n\t\t\tresults.push(shape)\n\t\t\tshapes.delete(shape)\n\n\t\t\tshapes.forEach((otherShape) => {\n\t\t\t\tif (otherShape.parentId === shape.id) {\n\t\t\t\t\tpushShapeWithDescendants(otherShape)\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\n\t\tshapes.forEach((shape) => {\n\t\t\tconst parent = this.getShapeById(shape.parentId)\n\t\t\tif (!isShape(parent)) {\n\t\t\t\tpushShapeWithDescendants(shape)\n\t\t\t}\n\t\t})\n\n\t\treturn results\n\t}\n\n\t/**\n\t * An array containing all of the currently selected shapes.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.selectedShapes\n\t * ```\n\t *\n\t * @public\n\t * @readonly\n\t */\n\t@computed get selectedShapes() {\n\t\tconst { selectedIds } = this.pageState\n\t\treturn compact(selectedIds.map((id) => this.store.get(id)))\n\t}\n\n\t/**\n\t * The app's only selected shape.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.onlySelectedShape\n\t * ```\n\t *\n\t * @returns Null if there is no shape or more than one selected shape, otherwise the selected\n\t *   shape.\n\t * @public\n\t * @readonly\n\t */\n\t@computed get onlySelectedShape() {\n\t\tconst { selectedShapes } = this\n\t\treturn selectedShapes.length === 1 ? selectedShapes[0] : null\n\t}\n\n\t/**\n\t * Get a shape by its id.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.getShapeById('box1')\n\t * ```\n\t *\n\t * @param id - The id of the shape to get.\n\t * @public\n\t */\n\tgetShapeById<T extends TLShape = TLShape>(id: TLParentId): T | undefined {\n\t\tif (!isShapeId(id)) return undefined\n\t\treturn this.store.get(id) as T\n\t}\n\n\t/**\n\t * Get the parent shape for a given shape. Returns undefined if the shape is the direct child of\n\t * the page.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.getParentShape(myShape)\n\t * ```\n\t *\n\t * @public\n\t */\n\tgetParentShape(shape?: TLShape): TLShape | undefined {\n\t\tif (shape === undefined || !isShapeId(shape.parentId)) return undefined\n\t\treturn this.store.get(shape.parentId)\n\t}\n\n\t/**\n\t * If siblingShape and targetShape are siblings, this returns targetShape\n\t * If targetShape has an ancestor who is a sibling of siblingShape, this returns that ancestor\n\t * Otherwise, this returns undefined\n\t */\n\tprivate getNearestSiblingShape(\n\t\tsiblingShape: TLShape,\n\t\ttargetShape: TLShape | undefined\n\t): TLShape | undefined {\n\t\tif (!targetShape) {\n\t\t\treturn undefined\n\t\t}\n\t\tif (targetShape.parentId === siblingShape.parentId) {\n\t\t\treturn targetShape\n\t\t}\n\n\t\tconst ancestor = this.findAncestor(\n\t\t\ttargetShape,\n\t\t\t(ancestor) => ancestor.parentId === siblingShape.parentId\n\t\t)\n\n\t\treturn ancestor\n\t}\n\n\t/**\n\t * Get the id of the containing page for a given shape.\n\t */\n\tgetParentPageId(shape?: TLShape): TLPageId | undefined {\n\t\tif (shape === undefined) return undefined\n\t\tif (TLPage.isId(shape.parentId)) {\n\t\t\treturn shape.parentId\n\t\t} else {\n\t\t\treturn this.getParentPageId(this.getShapeById(shape.parentId))\n\t\t}\n\t}\n\n\t/**\n\t * Get whether the given shape is the descendant of the given page.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.isShapeInPage(myShape)\n\t * \tapp.isShapeInPage(myShape, 'page1')\n\t\n\t * ```\n\t * @param shape - The shape to check.\n\t * @param pageId - The id of the page to check against. Defaults to the current page.\n\t * @public\n\t */\n\tisShapeInPage(shape: TLShape, pageId = this.currentPageId): boolean {\n\t\tlet shapeIsInPage = false\n\n\t\tif (shape.parentId === pageId) {\n\t\t\tshapeIsInPage = true\n\t\t} else {\n\t\t\tlet parent = this.getShapeById(shape.parentId)\n\t\t\tisInPageSearch: while (parent) {\n\t\t\t\tif (parent.parentId === pageId) {\n\t\t\t\t\tshapeIsInPage = true\n\t\t\t\t\tbreak isInPageSearch\n\t\t\t\t}\n\t\t\t\tparent = this.getShapeById(parent.parentId)\n\t\t\t}\n\t\t}\n\n\t\treturn shapeIsInPage\n\t}\n\n\t/* --------------------- Styles --------------------- */\n\n\t/**\n\t * A mapping of color ids to CSS color values.\n\t *\n\t * @internal\n\t */\n\tprivate colors: Map<TLColorStyle['id'], string>\n\n\t/**\n\t * A mapping of size ids to size values.\n\t *\n\t * @internal\n\t */\n\tprivate sizes = {\n\t\ts: 2,\n\t\tm: 3.5,\n\t\tl: 5,\n\t\txl: 10,\n\t}\n\n\t/**\n\t * Get the CSS color value for a given color id.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.getCssColor('red')\n\t * ```\n\t *\n\t * @param id - The id of the color to get.\n\t * @public\n\t */\n\tgetCssColor(id: TLColorStyle['id']): string {\n\t\treturn this.colors.get(id)!\n\t}\n\n\t/**\n\t * Get the stroke width value for a given size id.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.getStrokeWidth('m')\n\t * ```\n\t *\n\t * @param id - The id of the size to get.\n\t * @public\n\t */\n\tgetStrokeWidth(id: TLSizeStyle['id']): number {\n\t\treturn this.sizes[id]\n\t}\n\n\t/* ------------------- Statechart ------------------- */\n\n\t/**\n\t * The id of the current selected tool.\n\t *\n\t * @public\n\t */\n\tget currentToolId(): string {\n\t\tconst activeTool = this.root.current.value\n\t\tlet activeToolId = activeTool?.id\n\n\t\t// Often a tool will transition into one of the following select states after the initial pointerdown: 'translating', 'resizing', 'dragging_handle'\n\t\t// It should then supply the tool id to the `onInteractionEnd` property to tell us which tool initially triggered the interaction.\n\t\t// If tool lock mode is on then tldraw will switch to the given tool id.\n\t\t// If tool lock mode is off then tldraw will switch back to the select tool when the interaction ends.\n\n\t\tif (activeToolId === 'select') {\n\t\t\tconst currentChildState = activeTool?.current.value as any\n\t\t\tactiveToolId = currentChildState?.info?.onInteractionEnd ?? 'select'\n\t\t}\n\n\t\treturn activeToolId ?? 'select'\n\t}\n\n\t/**\n\t * Set the selected tool.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.setSelectedTool('hand')\n\t * \tapp.setSelectedTool('hand', { date: Date.now() })\n\t * ```\n\t *\n\t * @param id - The id of the tool to select.\n\t * @param info - Arbitrary data to pass along into the transition.\n\t * @public\n\t */\n\tsetSelectedTool(id: string, info = {}) {\n\t\tthis.root.transition(id, info)\n\t\treturn this\n\t}\n\n\t/**\n\t * Get a descendant by its path.\n\t *\n\t * @example\n\t * ```ts\n\t * \tstate.getStateDescendant('select')\n\t * \tstate.getStateDescendant('select.brushing')\n\t * ```\n\t *\n\t * @param path - The descendant's path of state ids, separated by periods.\n\t * @public\n\t */\n\tgetStateDescendant(path: string): StateNode | undefined {\n\t\tconst ids = path.split('.').reverse()\n\t\tlet state = this.root as StateNode\n\t\twhile (ids.length > 0) {\n\t\t\tconst id = ids.pop()\n\t\t\tif (!id) return state\n\t\t\tconst childState = state.children?.[id]\n\t\t\tif (!childState) return undefined\n\t\t\tstate = childState\n\t\t}\n\t\treturn state\n\t}\n\n\t/**\n\t * Get whether a certain tool (or other state node) is currently active.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.isIn('select')\n\t * \tapp.isIn('select.brushing')\n\t * ```\n\t *\n\t * @param path - The path of active states, separated by periods.\n\t * @public\n\t */\n\tisIn(path: string): boolean {\n\t\tconst ids = path.split('.').reverse()\n\t\tlet state = this.root as StateNode\n\t\twhile (ids.length > 0) {\n\t\t\tconst id = ids.pop()\n\t\t\tif (!id) return true\n\t\t\tconst current = state.current.value\n\t\t\tif (current?.id === id) {\n\t\t\t\tif (ids.length === 0) return true\n\t\t\t\tstate = current\n\t\t\t\tcontinue\n\t\t\t} else return false\n\t\t}\n\t\treturn false\n\t}\n\n\t/**\n\t * Get whether the state node is in any of the given active paths.\n\t *\n\t * @example\n\t * ```ts\n\t * \tstate.isInAny('select', 'erase')\n\t * \tstate.isInAny('select.brushing', 'erase.idle')\n\t * ```\n\t *\n\t * @public\n\t */\n\tisInAny(...paths: string[]): boolean {\n\t\treturn paths.some((path) => this.isIn(path))\n\t}\n\n\t/* --------------------- Inputs --------------------- */\n\n\t/**\n\t * The app's current input state.\n\t *\n\t * @public\n\t */\n\tinputs = {\n\t\t/** The most recent pointer down's position in page space. */\n\t\toriginPagePoint: new Vec2d(),\n\t\t/** The most recent pointer down's position in screen space. */\n\t\toriginScreenPoint: new Vec2d(),\n\t\t/** The previous pointer position in page space. */\n\t\tpreviousPagePoint: new Vec2d(),\n\t\t/** The previous pointer position in screen space. */\n\t\tpreviousScreenPoint: new Vec2d(),\n\t\t/** The most recent pointer position in page space. */\n\t\tcurrentPagePoint: new Vec2d(),\n\t\t/** The most recent pointer position in screen space. */\n\t\tcurrentScreenPoint: new Vec2d(),\n\t\t/** A set containing the currently pressed keys. */\n\t\tkeys: new Set<string>(),\n\t\t/** A set containing the currently pressed buttons. */\n\t\tbuttons: new Set<number>(),\n\t\t/** Whether the input is from a pe. */\n\t\tisPen: false,\n\t\t/** Whether the shift key is currently pressed. */\n\t\tshiftKey: false,\n\t\t/** Whether the control or command key is currently pressed. */\n\t\tctrlKey: false,\n\t\t/** Whether the alt or option key is currently pressed. */\n\t\taltKey: false,\n\t\t/** Whether the user is dragging. */\n\t\tisDragging: false,\n\t\t/** Whether the user is pointing. */\n\t\tisPointing: false,\n\t\t/** Whether the user is pinching. */\n\t\tisPinching: false,\n\t\t/** Whether the user is editing. */\n\t\tisEditing: false,\n\t\t/** Whether the user is panning. */\n\t\tisPanning: false,\n\t\t/** Veclocity of mouse pointer, in pixels per millisecond */\n\t\tpointerVelocity: new Vec2d(),\n\t}\n\n\t/**\n\t * Update the input points from a pointer or pinch event.\n\t *\n\t * @internal\n\t * @param info - The event info.\n\t */\n\tprivate _updateInputsFromEvent(info: TLPointerEventInfo | TLPinchEventInfo) {\n\t\tconst { previousScreenPoint, previousPagePoint, currentScreenPoint, currentPagePoint } =\n\t\t\tthis.inputs\n\n\t\tconst { screenBounds } = this.store.unsafeGetWithoutCapture(this.instanceId)!\n\t\tconst { x: sx, y: sy, z: sz } = info.point\n\t\tconst { x: cx, y: cy, z: cz } = this.camera\n\n\t\tpreviousScreenPoint.setTo(currentScreenPoint)\n\t\tpreviousPagePoint.setTo(currentPagePoint)\n\n\t\tconst px = (sx - screenBounds.x) / cz - cx\n\t\tconst py = (sy - screenBounds.y) / cz - cy\n\n\t\tcurrentScreenPoint.set(sx, sy)\n\t\tcurrentPagePoint.set(px, py, sz ?? 0.5)\n\n\t\tthis.inputs.isPen = info.type === 'pointer' && info.isPen\n\n\t\t// Reset velocity on pointer down\n\t\tif (info.name === 'pointer_down') {\n\t\t\tthis.inputs.pointerVelocity = new Vec2d()\n\t\t}\n\n\t\t// todo: We only have to do this if there are multiple users in the document\n\t\tthis.updateUserPresence({ cursor: currentPagePoint.toJson() })\n\t}\n\n\t/* --------------------- Events --------------------- */\n\n\t/**\n\t * A manager for recording multiple click events.\n\t *\n\t * @internal\n\t */\n\tprotected _clickManager = new ClickManager(this)\n\n\t/**\n\t * Prevent a double click event from firing the next time the user clicks\n\t *\n\t * @public\n\t */\n\tcancelDoubleClick() {\n\t\tthis._clickManager.cancelDoubleClickTimeout()\n\t}\n\n\t/**\n\t * The previous cursor. Used for restoring the cursor after pan events.\n\t *\n\t * @internal\n\t */\n\tprivate _prevCursor: TLCursorType = 'default'\n\n\t/** @internal */\n\tprivate _shiftKeyTimeout = -1 as any\n\n\t/** @internal */\n\tprivate _setShiftKeyTimeout = () => {\n\t\tthis.inputs.shiftKey = false\n\t\tthis.dispatch({\n\t\t\ttype: 'keyboard',\n\t\t\tname: 'key_up',\n\t\t\tkey: 'Shift',\n\t\t\tshiftKey: this.inputs.shiftKey,\n\t\t\tctrlKey: this.inputs.ctrlKey,\n\t\t\taltKey: this.inputs.altKey,\n\t\t})\n\t}\n\n\t/** @internal */\n\tprivate _altKeyTimeout = -1 as any\n\n\t/** @internal */\n\tprivate _setAltKeyTimeout = () => {\n\t\tthis.inputs.altKey = false\n\t\tthis.dispatch({\n\t\t\ttype: 'keyboard',\n\t\t\tname: 'key_up',\n\t\t\tkey: 'Alt',\n\t\t\tshiftKey: this.inputs.shiftKey,\n\t\t\tctrlKey: this.inputs.ctrlKey,\n\t\t\taltKey: this.inputs.altKey,\n\t\t})\n\t}\n\n\t/** @internal */\n\tprivate _ctrlKeyTimeout = -1 as any\n\n\t/** @internal */\n\tprivate _setCtrlKeyTimeout = () => {\n\t\tthis.inputs.ctrlKey = false\n\t\tthis.dispatch({\n\t\t\ttype: 'keyboard',\n\t\t\tname: 'key_up',\n\t\t\tkey: 'Ctrl',\n\t\t\tshiftKey: this.inputs.shiftKey,\n\t\t\tctrlKey: this.inputs.ctrlKey,\n\t\t\taltKey: this.inputs.altKey,\n\t\t})\n\t}\n\n\t/** @internal */\n\tprivate _restoreToolId = 'select'\n\n\t/** @internal */\n\tprivate _pinchStart = 1\n\n\t/** @internal */\n\tprivate _didPinch = false\n\n\t/** @internal */\n\tprivate _selectedIdsAtPointerDown: TLShapeId[] = []\n\n\t/**\n\t * Dispatch an event to the app.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.dispatch(myPointerEvent)\n\t * ```\n\t *\n\t * @param info - The event info.\n\t * @public\n\t */\n\tdispatch = (info: TLEventInfo): this => {\n\t\t// prevent us from spamming similar event errors if we're crashed.\n\t\t// todo: replace with new readonly mode?\n\t\tif (this.crashingError) return this\n\n\t\tconst { inputs } = this\n\t\tconst { type } = info\n\n\t\tthis.batch(() => {\n\t\t\tif (info.type === 'misc') {\n\t\t\t\tif (info.name === 'blur') {\n\t\t\t\t\tif (this.inputs.isPanning) {\n\t\t\t\t\t\tthis.inputs.isPanning = false\n\t\t\t\t\t\tthis.setCursor({\n\t\t\t\t\t\t\ttype: this._prevCursor,\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis.root.handleEvent(info)\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tif (info.shiftKey) {\n\t\t\t\tclearInterval(this._shiftKeyTimeout)\n\t\t\t\tthis._shiftKeyTimeout = -1\n\t\t\t\tinputs.shiftKey = true\n\t\t\t} else if (!info.shiftKey && inputs.shiftKey && this._shiftKeyTimeout === -1) {\n\t\t\t\tthis._shiftKeyTimeout = setTimeout(this._setShiftKeyTimeout, 150)\n\t\t\t}\n\n\t\t\tif (info.altKey) {\n\t\t\t\tclearInterval(this._altKeyTimeout)\n\t\t\t\tthis._altKeyTimeout = -1\n\t\t\t\tinputs.altKey = true\n\t\t\t} else if (!info.altKey && inputs.altKey && this._altKeyTimeout === -1) {\n\t\t\t\tthis._altKeyTimeout = setTimeout(this._setAltKeyTimeout, 150)\n\t\t\t}\n\n\t\t\tif (info.ctrlKey) {\n\t\t\t\tclearInterval(this._ctrlKeyTimeout)\n\t\t\t\tthis._ctrlKeyTimeout = -1\n\t\t\t\tinputs.ctrlKey = true /** @internal */ /** @internal */ /** @internal */\n\t\t\t} else if (!info.ctrlKey && inputs.ctrlKey && this._ctrlKeyTimeout === -1) {\n\t\t\t\tthis._ctrlKeyTimeout = setTimeout(this._setCtrlKeyTimeout, 150)\n\t\t\t}\n\n\t\t\tconst { originPagePoint, originScreenPoint, currentPagePoint, currentScreenPoint } = inputs\n\n\t\t\tif (!inputs.isPointing) {\n\t\t\t\tinputs.isDragging = false\n\t\t\t}\n\n\t\t\tswitch (type) {\n\t\t\t\tcase 'pinch': {\n\t\t\t\t\tif (!this.canMoveCamera) return\n\t\t\t\t\tthis._updateInputsFromEvent(info)\n\n\t\t\t\t\tswitch (info.name) {\n\t\t\t\t\t\tcase 'pinch_start': {\n\t\t\t\t\t\t\tif (inputs.isPinching) return\n\n\t\t\t\t\t\t\tif (!inputs.isEditing) {\n\t\t\t\t\t\t\t\tthis._pinchStart = this.camera.z\n\t\t\t\t\t\t\t\tif (!this._selectedIdsAtPointerDown.length) {\n\t\t\t\t\t\t\t\t\tthis._selectedIdsAtPointerDown = this.selectedIds.slice()\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tthis._didPinch = true\n\n\t\t\t\t\t\t\t\tinputs.isPinching = true\n\n\t\t\t\t\t\t\t\tthis.interrupt()\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\treturn // Stop here!\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcase 'pinch': {\n\t\t\t\t\t\t\tif (!inputs.isPinching) return\n\n\t\t\t\t\t\t\tconst {\n\t\t\t\t\t\t\t\tpoint: { x, y, z = 1 },\n\t\t\t\t\t\t\t\tdelta: { x: dx, y: dy },\n\t\t\t\t\t\t\t} = info\n\n\t\t\t\t\t\t\tconst {\n\t\t\t\t\t\t\t\tcamera: { x: cx, y: cy, z: cz },\n\t\t\t\t\t\t\t} = this\n\n\t\t\t\t\t\t\tconst zoom = Math.min(MAX_ZOOM, Math.max(MIN_ZOOM, z))\n\n\t\t\t\t\t\t\tthis.setCamera(\n\t\t\t\t\t\t\t\tcx + dx / cz - x / cz + x / zoom,\n\t\t\t\t\t\t\t\tcy + dy / cz - y / cz + y / zoom,\n\t\t\t\t\t\t\t\tzoom\n\t\t\t\t\t\t\t)\n\n\t\t\t\t\t\t\treturn // Stop here!\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcase 'pinch_end': {\n\t\t\t\t\t\t\tif (!inputs.isPinching) return this\n\n\t\t\t\t\t\t\tinputs.isPinching = false\n\t\t\t\t\t\t\tconst { _selectedIdsAtPointerDown } = this\n\t\t\t\t\t\t\tthis.setSelectedIds(this._selectedIdsAtPointerDown, true)\n\t\t\t\t\t\t\tthis._selectedIdsAtPointerDown = []\n\n\t\t\t\t\t\t\tconst {\n\t\t\t\t\t\t\t\tcamera: { x: cx, y: cy, z: cz },\n\t\t\t\t\t\t\t} = this\n\n\t\t\t\t\t\t\tlet zoom: number | undefined\n\n\t\t\t\t\t\t\tif (cz > 0.9 && cz < 1.05) {\n\t\t\t\t\t\t\t\tzoom = 1\n\t\t\t\t\t\t\t} else if (cz > 0.49 && cz < 0.505) {\n\t\t\t\t\t\t\t\tzoom = 0.5\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (cz > this._pinchStart - 0.1 && cz < this._pinchStart + 0.05) {\n\t\t\t\t\t\t\t\tzoom = this._pinchStart\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (zoom !== undefined) {\n\t\t\t\t\t\t\t\tconst { x, y } = this.viewportScreenCenter\n\t\t\t\t\t\t\t\tthis.animateCamera(\n\t\t\t\t\t\t\t\t\tcx + (x / zoom - x) - (x / cz - x),\n\t\t\t\t\t\t\t\t\tcy + (y / zoom - y) - (y / cz - y),\n\t\t\t\t\t\t\t\t\tzoom,\n\t\t\t\t\t\t\t\t\t{ duration: 100 }\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (this._didPinch) {\n\t\t\t\t\t\t\t\tthis._didPinch = false\n\t\t\t\t\t\t\t\trequestAnimationFrame(() => {\n\t\t\t\t\t\t\t\t\tif (!this._didPinch) {\n\t\t\t\t\t\t\t\t\t\tthis.setSelectedIds(_selectedIdsAtPointerDown, true)\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\treturn // Stop here!\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcase 'wheel': {\n\t\t\t\t\tif (!this.canMoveCamera) return\n\n\t\t\t\t\tif (this._viewportAnimation || this.isMenuOpen) {\n\t\t\t\t\t\t// noop\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (inputs.ctrlKey) {\n\t\t\t\t\t\t\t// todo: Start or update the zoom end interval\n\n\t\t\t\t\t\t\t// If the alt or ctrl keys are pressed,\n\t\t\t\t\t\t\t// zoom or pan the camera and then return.\n\t\t\t\t\t\t\tconst { x, y } = this.inputs.currentScreenPoint\n\t\t\t\t\t\t\tconst { x: cx, y: cy, z: cz } = this.camera\n\n\t\t\t\t\t\t\tconst zoom = Math.min(MAX_ZOOM, Math.max(MIN_ZOOM, cz + (info.delta.z ?? 0) * cz))\n\n\t\t\t\t\t\t\tthis.setCamera(\n\t\t\t\t\t\t\t\tcx + (x / zoom - x) - (x / cz - x),\n\t\t\t\t\t\t\t\tcy + (y / zoom - y) - (y / cz - y),\n\t\t\t\t\t\t\t\tzoom\n\t\t\t\t\t\t\t)\n\n\t\t\t\t\t\t\t// We want to return here because none of the states in our\n\t\t\t\t\t\t\t// statechart should respond to this event (a camera zoom)\n\t\t\t\t\t\t\treturn\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.pan(info.delta.x, info.delta.y)\n\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tinputs.isPointing &&\n\t\t\t\t\t\t\t!inputs.isDragging &&\n\t\t\t\t\t\t\tVec2d.Dist(\n\t\t\t\t\t\t\t\toriginScreenPoint,\n\t\t\t\t\t\t\t\tthis.pageToScreen(currentScreenPoint.x, currentScreenPoint.y)\n\t\t\t\t\t\t\t) > DRAG_DISTANCE\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tinputs.isDragging = true\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Important!\n\t\t\t\t\t\t// Before we handle the wheel event, first handle the event\n\t\t\t\t\t\t// as a pointer move.\n\n\t\t\t\t\t\tthis.dispatch({\n\t\t\t\t\t\t\ttype: 'pointer',\n\t\t\t\t\t\t\ttarget: 'canvas',\n\t\t\t\t\t\t\tname: 'pointer_move',\n\t\t\t\t\t\t\tpoint: currentScreenPoint,\n\t\t\t\t\t\t\tpointerId: 0,\n\t\t\t\t\t\t\tctrlKey: info.ctrlKey,\n\t\t\t\t\t\t\taltKey: info.altKey,\n\t\t\t\t\t\t\tshiftKey: info.shiftKey,\n\t\t\t\t\t\t\tbutton: 0,\n\t\t\t\t\t\t\tisPen: this.isPenMode ?? false,\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t\tcase 'pointer': {\n\t\t\t\t\t// If we're pinching, return\n\t\t\t\t\tif (inputs.isPinching) return\n\n\t\t\t\t\tthis._updateInputsFromEvent(info)\n\n\t\t\t\t\tconst { isPen } = info\n\n\t\t\t\t\tswitch (info.name) {\n\t\t\t\t\t\tcase 'pointer_down': {\n\t\t\t\t\t\t\tthis._selectedIdsAtPointerDown = this.selectedIds.slice()\n\n\t\t\t\t\t\t\t// Add the button from the buttons set\n\t\t\t\t\t\t\tinputs.buttons.add(info.button)\n\n\t\t\t\t\t\t\tinputs.isPointing = true\n\t\t\t\t\t\t\tinputs.isDragging = false\n\n\t\t\t\t\t\t\tif (this.isPenMode) {\n\t\t\t\t\t\t\t\tif (!isPen) {\n\t\t\t\t\t\t\t\t\t// decrement the remaining taps before exiting pen mode\n\t\t\t\t\t\t\t\t\tthis._touchEventsRemainingBeforeExitingPenMode--\n\t\t\t\t\t\t\t\t\tif (this._touchEventsRemainingBeforeExitingPenMode === 0) {\n\t\t\t\t\t\t\t\t\t\tthis.setPenMode(false)\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\treturn\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t// reset the remaining taps before exiting pen mode\n\t\t\t\t\t\t\t\t\tthis._touchEventsRemainingBeforeExitingPenMode = 3\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif (isPen) {\n\t\t\t\t\t\t\t\t\tthis.setPenMode(true)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (info.button === 5) {\n\t\t\t\t\t\t\t\t// Eraser button activates eraser\n\t\t\t\t\t\t\t\tthis._restoreToolId = this.currentToolId\n\t\t\t\t\t\t\t\tthis.complete()\n\t\t\t\t\t\t\t\tthis.setSelectedTool('eraser')\n\t\t\t\t\t\t\t} else if (info.button === 1) {\n\t\t\t\t\t\t\t\t// Middle mouse pan activates panning\n\t\t\t\t\t\t\t\tif (!this.inputs.isPanning) {\n\t\t\t\t\t\t\t\t\tthis._prevCursor = this.instanceState.cursor.type\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tthis.inputs.isPanning = true\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (this.inputs.isPanning) {\n\t\t\t\t\t\t\t\tthis.stopCameraAnimation()\n\t\t\t\t\t\t\t\tthis.setCursor({\n\t\t\t\t\t\t\t\t\ttype: 'grabbing',\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\treturn this\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\toriginScreenPoint.setTo(currentScreenPoint)\n\t\t\t\t\t\t\toriginPagePoint.setTo(currentPagePoint)\n\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcase 'pointer_move': {\n\t\t\t\t\t\t\t// If the user is in pen mode, but the pointer is not a pen, stop here.\n\t\t\t\t\t\t\tif (!isPen && this.isPenMode) {\n\t\t\t\t\t\t\t\treturn\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (this.inputs.isPanning && this.inputs.isPointing) {\n\t\t\t\t\t\t\t\t// Handle panning\n\t\t\t\t\t\t\t\tconst { currentScreenPoint, previousScreenPoint } = this.inputs\n\t\t\t\t\t\t\t\tconst delta = Vec2d.Sub(currentScreenPoint, previousScreenPoint)\n\t\t\t\t\t\t\t\tthis.pan(delta.x, delta.y)\n\t\t\t\t\t\t\t\treturn\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\tinputs.isPointing &&\n\t\t\t\t\t\t\t\t!inputs.isDragging &&\n\t\t\t\t\t\t\t\tVec2d.Dist(originScreenPoint, currentScreenPoint) > DRAG_DISTANCE\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t// Start dragging\n\t\t\t\t\t\t\t\tinputs.isDragging = true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcase 'pointer_up': {\n\t\t\t\t\t\t\t// Remove the button from the buttons set\n\t\t\t\t\t\t\tinputs.buttons.delete(info.button)\n\n\t\t\t\t\t\t\tinputs.isPointing = false\n\t\t\t\t\t\t\tinputs.isDragging = false\n\n\t\t\t\t\t\t\tif (this.isMenuOpen) {\n\t\t\t\t\t\t\t\t// Surpressing pointerup here as <ContextMenu/> doesn't seem to do what we what here.\n\t\t\t\t\t\t\t\treturn\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (!isPen && this.isPenMode) {\n\t\t\t\t\t\t\t\treturn\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (inputs.isPanning) {\n\t\t\t\t\t\t\t\tif (info.button === 1) {\n\t\t\t\t\t\t\t\t\tif (!this.inputs.keys.has(' ')) {\n\t\t\t\t\t\t\t\t\t\tinputs.isPanning = false\n\n\t\t\t\t\t\t\t\t\t\tthis.slideCamera({\n\t\t\t\t\t\t\t\t\t\t\tspeed: Math.min(2, this.inputs.pointerVelocity.len()),\n\t\t\t\t\t\t\t\t\t\t\tdirection: this.inputs.pointerVelocity,\n\t\t\t\t\t\t\t\t\t\t\tfriction: HAND_TOOL_FRICTION,\n\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\tthis.setCursor({\n\t\t\t\t\t\t\t\t\t\t\ttype: this._prevCursor,\n\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tthis.slideCamera({\n\t\t\t\t\t\t\t\t\t\t\tspeed: Math.min(2, this.inputs.pointerVelocity.len()),\n\t\t\t\t\t\t\t\t\t\t\tdirection: this.inputs.pointerVelocity,\n\t\t\t\t\t\t\t\t\t\t\tfriction: HAND_TOOL_FRICTION,\n\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\tthis.setCursor({\n\t\t\t\t\t\t\t\t\t\t\ttype: 'grab',\n\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else if (info.button === 0) {\n\t\t\t\t\t\t\t\t\tthis.slideCamera({\n\t\t\t\t\t\t\t\t\t\tspeed: Math.min(2, this.inputs.pointerVelocity.len()),\n\t\t\t\t\t\t\t\t\t\tdirection: this.inputs.pointerVelocity,\n\t\t\t\t\t\t\t\t\t\tfriction: HAND_TOOL_FRICTION,\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\tthis.setCursor({\n\t\t\t\t\t\t\t\t\t\ttype: 'grab',\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif (info.button === 5) {\n\t\t\t\t\t\t\t\t\t// Eraser button activates eraser\n\t\t\t\t\t\t\t\t\tthis.complete()\n\t\t\t\t\t\t\t\t\tthis.setSelectedTool(this._restoreToolId)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t\tcase 'keyboard': {\n\t\t\t\t\tswitch (info.name) {\n\t\t\t\t\t\tcase 'key_down': {\n\t\t\t\t\t\t\t// Ignore key presses after the first one\n\t\t\t\t\t\t\tif (inputs.keys.has(info.key)) {\n\t\t\t\t\t\t\t\treturn\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// Add the key from the keys set\n\t\t\t\t\t\t\tinputs.keys.add(info.key)\n\n\t\t\t\t\t\t\t// If the space key is pressed (but meta / control isn't!) activate panning\n\t\t\t\t\t\t\tif (!info.ctrlKey && info.key === ' ') {\n\t\t\t\t\t\t\t\tif (!this.inputs.isPanning) {\n\t\t\t\t\t\t\t\t\tthis._prevCursor = this.instanceState.cursor.type\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tthis.inputs.isPanning = true\n\t\t\t\t\t\t\t\tthis.setCursor({\n\t\t\t\t\t\t\t\t\ttype: this.inputs.isPointing ? 'grabbing' : 'grab',\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcase 'key_up': {\n\t\t\t\t\t\t\t// Remove the key from the keys set\n\t\t\t\t\t\t\tinputs.keys.delete(info.key)\n\n\t\t\t\t\t\t\tif (info.key === ' ' && !this.inputs.buttons.has(1)) {\n\t\t\t\t\t\t\t\tthis.inputs.isPanning = false\n\t\t\t\t\t\t\t\tthis.setCursor({\n\t\t\t\t\t\t\t\t\ttype: this._prevCursor,\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Correct the info name for right / middle clicks\n\t\t\tif (info.type === 'pointer') {\n\t\t\t\tif (info.button === 1) {\n\t\t\t\t\tinfo.name = 'middle_click'\n\t\t\t\t} else if (info.button === 2) {\n\t\t\t\t\tinfo.name = 'right_click'\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// If a pointer event, send the event to the click manager.\n\t\t\tif (info.type === 'pointer' && info.isPen === this.isPenMode) {\n\t\t\t\tswitch (info.name) {\n\t\t\t\t\tcase 'pointer_down': {\n\t\t\t\t\t\tconst otherEvent = this._clickManager.transformPointerDownEvent(info)\n\t\t\t\t\t\tif (info.name !== otherEvent.name) {\n\t\t\t\t\t\t\tthis.root.handleEvent(info)\n\t\t\t\t\t\t\tthis.emit('event', info)\n\t\t\t\t\t\t\tthis.root.handleEvent(otherEvent)\n\t\t\t\t\t\t\tthis.emit('event', otherEvent)\n\t\t\t\t\t\t\treturn\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak\n\t\t\t\t\t}\n\t\t\t\t\tcase 'pointer_up': {\n\t\t\t\t\t\tconst otherEvent = this._clickManager.transformPointerUpEvent(info)\n\t\t\t\t\t\tif (info.name !== otherEvent.name) {\n\t\t\t\t\t\t\tthis.root.handleEvent(info)\n\t\t\t\t\t\t\tthis.emit('event', info)\n\t\t\t\t\t\t\tthis.root.handleEvent(otherEvent)\n\t\t\t\t\t\t\tthis.emit('event', otherEvent)\n\t\t\t\t\t\t\treturn\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak\n\t\t\t\t\t}\n\t\t\t\t\tcase 'pointer_move': {\n\t\t\t\t\t\tthis._clickManager.handleMove()\n\t\t\t\t\t\tbreak\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Send the event to the statechart. It will be handled by all\n\t\t\t// active states, starting at the root.\n\t\t\tthis.root.handleEvent(info)\n\t\t\tthis.emit('event', info)\n\t\t})\n\n\t\treturn this\n\t}\n\n\treplaceStoreContentsWithRecordsForOtherDocument(records: TLRecord[]) {\n\t\ttransact(() => {\n\t\t\tthis.store.clear()\n\t\t\tconst [shapes, nonShapes] = partition(records, (record) => record.typeName === 'shape')\n\t\t\tthis.store.put(nonShapes, 'initialize')\n\t\t\tthis.store.ensureStoreIsUsable()\n\t\t\tthis.store.put(shapes, 'initialize')\n\t\t\tthis.history.clear()\n\t\t\tthis.updateViewportScreenBounds()\n\t\t\tthis.updateCullingBounds()\n\n\t\t\tconst bounds = this.allShapesCommonBounds\n\t\t\tif (bounds) {\n\t\t\t\tthis.zoomToBounds(bounds.minX, bounds.minY, bounds.width, bounds.height, 1)\n\t\t\t}\n\t\t})\n\t}\n\n\tgetContent(ids: TLShapeId[] = this.selectedIds): TLClipboardModel | undefined {\n\t\tif (!ids) return\n\t\tif (ids.length === 0) return\n\n\t\tconst pageTransforms: Record<string, Matrix2dModel> = {}\n\n\t\tlet shapes = dedupe(\n\t\t\tids\n\t\t\t\t.map((id) => this.getShapeById(id) as TLShape)\n\t\t\t\t.sort(sortByIndex)\n\t\t\t\t.flatMap((shape) => {\n\t\t\t\t\tconst allShapes = [shape]\n\t\t\t\t\tthis.visitDescendants(shape.id, (descendant) => {\n\t\t\t\t\t\tallShapes.push(this.getShapeById(descendant) as TLShape)\n\t\t\t\t\t})\n\t\t\t\t\treturn allShapes\n\t\t\t\t})\n\t\t)\n\n\t\tshapes = shapes.map((shape) => {\n\t\t\tshape = structuredClone(shape) as typeof shape\n\n\t\t\tpageTransforms[shape.id] = this.getPageTransformById(shape.id)!\n\n\t\t\tif (!TLArrowShapeDef.is(shape)) return shape\n\t\t\tif (shape.props.start.type === 'binding') {\n\t\t\t\tconst boundId = shape.props.start.boundShapeId\n\t\t\t\tif (!shapes.find((s) => s.id === boundId)) {\n\t\t\t\t\tconst { start } = getArrowTerminalsInArrowSpace(this, shape)\n\t\t\t\t\tshape.props.start = {\n\t\t\t\t\t\ttype: 'point',\n\t\t\t\t\t\tx: start.x,\n\t\t\t\t\t\ty: start.y,\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (shape.props.end.type === 'binding') {\n\t\t\t\tconst boundId = shape.props.end.boundShapeId\n\t\t\t\tif (!shapes.find((s) => s.id === boundId)) {\n\t\t\t\t\tconst { end } = getArrowTerminalsInArrowSpace(this, shape)\n\t\t\t\t\tshape.props.end = {\n\t\t\t\t\t\ttype: 'point',\n\t\t\t\t\t\tx: end.x,\n\t\t\t\t\t\ty: end.y,\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn shape\n\t\t})\n\n\t\tconst rootShapeIds: TLShapeId[] = []\n\n\t\tshapes.forEach((shape) => {\n\t\t\tif (shapes.find((s) => s.id === shape.parentId) === undefined) {\n\t\t\t\t// Need to get page point and rotation of the shape because shapes in\n\t\t\t\t// groups use local position/rotation\n\n\t\t\t\tconst pagePoint = this.getPagePointById(shape.id)!\n\t\t\t\tconst pageRotation = this.getPageRotationById(shape.id)!\n\t\t\t\tshape.x = pagePoint.x\n\t\t\t\tshape.y = pagePoint.y\n\t\t\t\tshape.rotation = pageRotation\n\t\t\t\tshape.parentId = this.currentPageId\n\n\t\t\t\trootShapeIds.push(shape.id)\n\t\t\t}\n\t\t})\n\n\t\tconst assetsSet = new Set<TLAssetId>()\n\n\t\tshapes.forEach((shape) => {\n\t\t\tif ('assetId' in shape.props) {\n\t\t\t\tif (shape.props.assetId !== null) {\n\t\t\t\t\tassetsSet.add(shape.props.assetId)\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\n\t\treturn {\n\t\t\tshapes,\n\t\t\trootShapeIds,\n\t\t\tschema: this.store.schema.serialize(),\n\t\t\tassets: compact(Array.from(assetsSet).map((id) => this.getAssetById(id))),\n\t\t}\n\t}\n\n\t/* --------------------- Commands --------------------- */\n\n\tputContent(\n\t\tcontent: TLClipboardModel,\n\t\toptions: {\n\t\t\tpoint?: VecLike\n\t\t\tselect?: boolean\n\t\t\tpreservePosition?: boolean\n\t\t\tpreserveIds?: boolean\n\t\t} = {}\n\t): this {\n\t\tif (this.isReadOnly) return this\n\n\t\tif (!content.schema) {\n\t\t\tthrow Error('Could not put content: content is missing a schema.')\n\t\t}\n\n\t\tconst { select = false, preserveIds = false, preservePosition = false } = options\n\t\tlet { point = undefined } = options\n\n\t\t// decide on a parent for the put shapes; if the parent is among the put shapes(?) then use its parent\n\n\t\tconst { currentPageId } = this\n\t\tconst { assets, shapes, rootShapeIds } = content\n\n\t\tconst idMap = new Map<any, TLShapeId>(shapes.map((shape) => [shape.id, createShapeId()]))\n\n\t\t// By default, the paste parent will be the current page.\n\t\tlet pasteParentId = this.currentPageId as TLPageId | TLShapeId\n\t\tlet lowestDepth = Infinity\n\t\tlet lowestAncestors: TLShape[] = []\n\n\t\t// Among the selected shapes, find the shape with the fewest ancestors and use its first ancestor.\n\t\tfor (const shape of this.selectedShapes) {\n\t\t\tif (lowestDepth === 0) break\n\n\t\t\tconst ancestors = this.getAncestors(shape)\n\t\t\tif (shape.type === 'frame') ancestors.push(shape)\n\n\t\t\tconst depth = shape.type === 'frame' ? ancestors.length + 1 : ancestors.length\n\n\t\t\tif (depth < lowestDepth) {\n\t\t\t\tlowestDepth = depth\n\t\t\t\tlowestAncestors = ancestors\n\t\t\t\tpasteParentId = shape.type === 'frame' ? shape.id : shape.parentId\n\t\t\t} else if (depth === lowestDepth) {\n\t\t\t\tif (lowestAncestors.length !== ancestors.length) {\n\t\t\t\t\tthrow Error(`Ancestors: ${lowestAncestors.length} !== ${ancestors.length}`)\n\t\t\t\t}\n\n\t\t\t\tif (lowestAncestors.length === 0) {\n\t\t\t\t\tpasteParentId = currentPageId\n\t\t\t\t\tbreak\n\t\t\t\t} else {\n\t\t\t\t\tpasteParentId = currentPageId\n\t\t\t\t\tfor (let i = 0; i < lowestAncestors.length; i++) {\n\t\t\t\t\t\tif (ancestors[i] !== lowestAncestors[i]) break\n\t\t\t\t\t\tpasteParentId = ancestors[i].id\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tlet isDuplicating = false\n\n\t\tif (!TLPage.isId(pasteParentId)) {\n\t\t\tconst parent = this.getShapeById(pasteParentId)\n\t\t\tif (parent) {\n\t\t\t\tif (!this.viewportPageBounds.includes(this.getPageBounds(parent)!)) {\n\t\t\t\t\tpasteParentId = currentPageId\n\t\t\t\t} else {\n\t\t\t\t\tif (rootShapeIds.length === 1) {\n\t\t\t\t\t\tconst rootShape = shapes.find((s) => s.id === rootShapeIds[0])!\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tTLFrameShapeDef.is(parent) &&\n\t\t\t\t\t\t\tTLFrameShapeDef.is(rootShape) &&\n\t\t\t\t\t\t\trootShape.props.w === parent?.props.w &&\n\t\t\t\t\t\t\trootShape.props.h === parent?.props.h\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tisDuplicating = true\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tpasteParentId = currentPageId\n\t\t\t}\n\t\t}\n\n\t\tif (!isDuplicating) {\n\t\t\tisDuplicating = idMap.has(pasteParentId)\n\t\t}\n\n\t\tif (isDuplicating) {\n\t\t\tpasteParentId = this.getShapeById(pasteParentId)!.parentId\n\t\t}\n\n\t\tlet index = this.getHighestIndexForParent(pasteParentId)\n\n\t\tconst rootShapes: TLShape[] = []\n\n\t\tconst newShapes: TLShapePartial[] = shapes.map((shape): TLShape => {\n\t\t\tlet newShape: TLShape\n\n\t\t\tif (preserveIds) {\n\t\t\t\tnewShape = deepCopy(shape)\n\t\t\t\tidMap.set(shape.id, shape.id)\n\t\t\t} else {\n\t\t\t\tconst id = idMap.get(shape.id)!\n\n\t\t\t\t// Create the new shape (new except for the id)\n\t\t\t\tnewShape = deepCopy({ ...shape, id })\n\t\t\t}\n\n\t\t\tif (rootShapeIds.includes(shape.id)) {\n\t\t\t\tnewShape.parentId = currentPageId\n\t\t\t\trootShapes.push(newShape)\n\t\t\t}\n\n\t\t\t// Assign the child to its new parent.\n\n\t\t\t// If the child's parent is among the putting shapes, then assign\n\t\t\t// it to the new parent's id.\n\t\t\tif (idMap.has(newShape.parentId)) {\n\t\t\t\tnewShape.parentId = idMap.get(shape.parentId)!\n\t\t\t} else {\n\t\t\t\trootShapeIds.push(newShape.id)\n\t\t\t\t// newShape.parentId = pasteParentId\n\t\t\t\tnewShape.index = index\n\t\t\t\tindex = getIndexAbove(index)\n\t\t\t}\n\n\t\t\tif (TLArrowShapeDef.is(newShape)) {\n\t\t\t\tif (newShape.props.start.type === 'binding') {\n\t\t\t\t\tconst mappedId = idMap.get(newShape.props.start.boundShapeId)\n\t\t\t\t\tnewShape.props.start = mappedId\n\t\t\t\t\t\t? { ...newShape.props.start, boundShapeId: mappedId }\n\t\t\t\t\t\t: // this shouldn't happen, if you copy an arrow but not it's bound shape it should\n\t\t\t\t\t\t  // convert the binding to a point at the time of copying\n\t\t\t\t\t\t  { type: 'point', x: 0, y: 0 }\n\t\t\t\t}\n\t\t\t\tif (newShape.props.end.type === 'binding') {\n\t\t\t\t\tconst mappedId = idMap.get(newShape.props.end.boundShapeId)\n\t\t\t\t\tnewShape.props.end = mappedId\n\t\t\t\t\t\t? { ...newShape.props.end, boundShapeId: mappedId }\n\t\t\t\t\t\t: // this shouldn't happen, if you copy an arrow but not it's bound shape it should\n\t\t\t\t\t\t  // convert the binding to a point at the time of copying\n\t\t\t\t\t\t  { type: 'point', x: 0, y: 0 }\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn newShape\n\t\t})\n\n\t\tif (newShapes.length + this.shapeIds.size > MAX_SHAPES_PER_PAGE) {\n\t\t\t// There's some complexity here involving children\n\t\t\t// that might be created without their parents, so\n\t\t\t// if we're going over the limit then just don't paste.\n\t\t\talertMaxShapes(this)\n\t\t\treturn this\n\t\t}\n\n\t\t// Migrate the new shapes\n\n\t\tlet assetsToCreate: TLAsset[] = []\n\n\t\tif (assets) {\n\t\t\tfor (let i = 0; i < assets.length; i++) {\n\t\t\t\tconst asset = assets[i]\n\t\t\t\tconst result = this.store.schema.migratePersistedRecord(asset, content.schema)\n\t\t\t\tif (result.type === 'success') {\n\t\t\t\t\tassets[i] = result.value as TLAsset\n\t\t\t\t} else {\n\t\t\t\t\tthrow Error(\n\t\t\t\t\t\t`Could not put content: could not migrate content for asset:\\n${JSON.stringify(\n\t\t\t\t\t\t\tasset,\n\t\t\t\t\t\t\tnull,\n\t\t\t\t\t\t\t2\n\t\t\t\t\t\t)}`\n\t\t\t\t\t)\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst assetsToUpdate: (TLImageAsset | TLVideoAsset)[] = []\n\n\t\t\tassetsToCreate = assets\n\t\t\t\t.filter((asset) => !this.store.has(asset.id))\n\t\t\t\t.map((asset) => {\n\t\t\t\t\tif (asset.type === 'image' || asset.type === 'video') {\n\t\t\t\t\t\tif (asset.props.src && asset.props.src?.startsWith('data:image')) {\n\t\t\t\t\t\t\tassetsToUpdate.push(structuredClone(asset))\n\t\t\t\t\t\t\tasset.props.src = null\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tassetsToUpdate.push(structuredClone(asset))\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\treturn asset\n\t\t\t\t})\n\n\t\t\tPromise.allSettled(\n\t\t\t\tassetsToUpdate.map(async (asset) => {\n\t\t\t\t\tconst file = await dataUrlToFile(\n\t\t\t\t\t\tasset.props.src!,\n\t\t\t\t\t\tasset.props.name,\n\t\t\t\t\t\tasset.props.mimeType ?? 'image/png'\n\t\t\t\t\t)\n\n\t\t\t\t\tconst newAsset = await this.onCreateAssetFromFile(file)\n\n\t\t\t\t\treturn [asset, newAsset] as const\n\t\t\t\t})\n\t\t\t).then((assets) => {\n\t\t\t\tthis.updateAssets(\n\t\t\t\t\tcompact(\n\t\t\t\t\t\tassets.map((result) =>\n\t\t\t\t\t\t\tresult.status === 'fulfilled'\n\t\t\t\t\t\t\t\t? { ...result.value[1], id: result.value[0].id }\n\t\t\t\t\t\t\t\t: undefined\n\t\t\t\t\t\t)\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t})\n\t\t}\n\n\t\tfor (let i = 0; i < newShapes.length; i++) {\n\t\t\tconst shape = newShapes[i] as TLShape\n\t\t\tconst result = this.store.schema.migratePersistedRecord(shape, content.schema)\n\t\t\tif (result.type === 'success') {\n\t\t\t\tnewShapes[i] = result.value as TLShape\n\t\t\t} else {\n\t\t\t\tthrow Error(\n\t\t\t\t\t`Could not put content: could not migrate content for shape:\\n${JSON.stringify(\n\t\t\t\t\t\tshape,\n\t\t\t\t\t\tnull,\n\t\t\t\t\t\t2\n\t\t\t\t\t)}`\n\t\t\t\t)\n\t\t\t}\n\t\t}\n\n\t\tthis.batch(() => {\n\t\t\t// Create any assets that need to be created\n\t\t\tif (assetsToCreate.length > 0) {\n\t\t\t\tthis.createAssets(assetsToCreate)\n\t\t\t}\n\n\t\t\t// Create the shapes with root shapes as children of the page\n\t\t\tthis.createShapes(newShapes, select)\n\n\t\t\t// And then, if needed, reparent the root shapes to the paste parent\n\t\t\tif (pasteParentId !== currentPageId) {\n\t\t\t\tthis.reparentShapesById(\n\t\t\t\t\trootShapes.map((s) => s.id),\n\t\t\t\t\tpasteParentId\n\t\t\t\t)\n\t\t\t}\n\n\t\t\tconst newCreatedShapes = newShapes.map((s) => this.getShapeById(s.id)!)\n\t\t\tconst bounds = Box2d.Common(newCreatedShapes.map((s) => this.getPageBounds(s)!))\n\n\t\t\tif (point === undefined) {\n\t\t\t\tif (!TLPage.isId(pasteParentId)) {\n\t\t\t\t\t// Put the shapes in the middle of the (on screen) parent\n\t\t\t\t\tconst shape = this.getShapeById(pasteParentId)!\n\t\t\t\t\tconst util = this.getShapeUtil(shape)\n\t\t\t\t\tpoint = util.center(shape)\n\t\t\t\t} else {\n\t\t\t\t\tconst { viewportPageBounds } = this\n\t\t\t\t\tif (preservePosition || viewportPageBounds.includes(Box2d.From(bounds))) {\n\t\t\t\t\t\t// Otherwise, put shapes where they used to be\n\t\t\t\t\t\tpoint = bounds.center\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// If the old bounds are outside of the viewport...\n\t\t\t\t\t\t// put the shapes in the middle of the viewport\n\t\t\t\t\t\tpoint = viewportPageBounds.center\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (rootShapes.length === 1) {\n\t\t\t\tconst onlyRoot = rootShapes[0] as TLFrameShape\n\t\t\t\t// If the old bounds are in the viewport...\n\t\t\t\tif (onlyRoot.type === 'frame') {\n\t\t\t\t\twhile (\n\t\t\t\t\t\tthis.getShapesAtPoint(point).some(\n\t\t\t\t\t\t\t(shape) =>\n\t\t\t\t\t\t\t\tTLFrameShapeDef.is(shape) &&\n\t\t\t\t\t\t\t\tshape.props.w === onlyRoot.props.w &&\n\t\t\t\t\t\t\t\tshape.props.h === onlyRoot.props.h\n\t\t\t\t\t\t)\n\t\t\t\t\t) {\n\t\t\t\t\t\tpoint.x += bounds.w + 16\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.updateShapes(\n\t\t\t\trootShapes.map((s) => {\n\t\t\t\t\tconst delta = {\n\t\t\t\t\t\tx: (s.x ?? 0) - (bounds.x + bounds.w / 2),\n\t\t\t\t\t\ty: (s.y ?? 0) - (bounds.y + bounds.h / 2),\n\t\t\t\t\t}\n\n\t\t\t\t\treturn { id: s.id, type: s.type, x: point!.x + delta.x, y: point!.y + delta.y }\n\t\t\t\t})\n\t\t\t)\n\t\t})\n\n\t\treturn this\n\t}\n\n\t/* --------------------- Shapes --------------------- */\n\n\t/**\n\t * Get a unique id for a shape.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.createShapeId()\n\t * \tapp.createShapeId('box1')\n\t * ```\n\t *\n\t * @param id - The id to use.\n\t * @public\n\t */\n\tcreateShapeId(id?: string) {\n\t\treturn id ? createCustomShapeId(id) : createShapeId()\n\t}\n\n\tgetHighestIndexForParent(parentId: TLShapeId | TLPageId) {\n\t\tconst children = this._parentIdsToChildIds.value[parentId]\n\n\t\tif (!children || children.length === 0) {\n\t\t\treturn 'a1'\n\t\t}\n\t\treturn getIndexAbove(children[children.length - 1][1])\n\t}\n\n\t/**\n\t * Create shapes.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.createShapes([{ id: \"box1\", type: \"box\" }]\n\t * ```\n\t *\n\t * @param partials - The shape partials to create.\n\t * @param select - Whether to select the created shapes. Defaults to false.\n\t * @public\n\t */\n\tcreateShapes(partials: TLShapePartial[], select = false) {\n\t\tthis._createShapes(partials, select)\n\t\treturn this\n\t}\n\n\t/** @internal */\n\tprivate _createShapes = this.history.createCommand(\n\t\t'createShapes',\n\t\t(partials: TLShapePartial[], select = false) => {\n\t\t\tif (this.isReadOnly) return null\n\t\t\tif (partials.length <= 0) return null\n\n\t\t\tconst { shapeIds, selectedIds } = this\n\n\t\t\tconst prevSelectedIds = select ? selectedIds : undefined\n\n\t\t\tconst maxShapesReached = partials.length + shapeIds.size > MAX_SHAPES_PER_PAGE\n\n\t\t\tif (maxShapesReached) {\n\t\t\t\talertMaxShapes(this)\n\t\t\t}\n\n\t\t\tconst partialsToCreate = maxShapesReached\n\t\t\t\t? partials.slice(0, MAX_SHAPES_PER_PAGE - shapeIds.size)\n\t\t\t\t: partials\n\n\t\t\tif (partialsToCreate.length === 0) return null\n\n\t\t\treturn {\n\t\t\t\tdata: {\n\t\t\t\t\tprevSelectedIds,\n\t\t\t\t\tpartials: partialsToCreate,\n\t\t\t\t\tselect,\n\t\t\t\t},\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\tdo: ({ partials, select }) => {\n\t\t\t\tconst { focusLayerId } = this\n\n\t\t\t\t// 1. Parents\n\n\t\t\t\t// Make sure that each partial will become the child of either the\n\t\t\t\t// page or another shape that exists (or that will exist) in this page.\n\n\t\t\t\tpartials = partials.map((partial) => {\n\t\t\t\t\tif (\n\t\t\t\t\t\t// No parentId provided\n\t\t\t\t\t\t!partial.parentId ||\n\t\t\t\t\t\t// A parentId is proved but the parent is neither a) in the store\n\t\t\t\t\t\t// or b) among the other creating shape partials\n\t\t\t\t\t\t(!this.store.get(partial.parentId) && !partials.find((p) => p.id === partial.parentId))\n\t\t\t\t\t) {\n\t\t\t\t\t\tpartial = { ...partial }\n\t\t\t\t\t\tconst parentId = this.getParentIdForNewShapeAtPoint(\n\t\t\t\t\t\t\t{ x: partial.x ?? 0, y: partial.y ?? 0 },\n\t\t\t\t\t\t\tpartial.type\n\t\t\t\t\t\t)\n\t\t\t\t\t\tpartial.parentId = parentId\n\t\t\t\t\t\t// If the parent is a shape (rather than a page) then insert the\n\t\t\t\t\t\t// shapes into the shape's children. Ajust the point and page rotation to be\n\t\t\t\t\t\t// preserved relative to the parent.\n\t\t\t\t\t\tif (isShapeId(parentId)) {\n\t\t\t\t\t\t\tconst point = this.getPointInShapeSpace(this.getShapeById(parentId)!, {\n\t\t\t\t\t\t\t\tx: partial.x ?? 0,\n\t\t\t\t\t\t\t\ty: partial.y ?? 0,\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\tpartial.x = point.x\n\t\t\t\t\t\t\tpartial.y = point.y\n\t\t\t\t\t\t\tpartial.rotation = -this.getPageRotationById(parentId) + (partial.rotation ?? 0)\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn partial\n\t\t\t\t\t}\n\t\t\t\t\treturn partial\n\t\t\t\t})\n\n\t\t\t\t// 2. Indices\n\n\t\t\t\t// Get the highest index among the parents of each of the\n\t\t\t\t// the shapes being created; we'll increment from there.\n\n\t\t\t\tconst parentIndices = new Map<string, string>()\n\n\t\t\t\tconst shapeRecordsTocreate: TLShape[] = []\n\n\t\t\t\tfor (const partial of partials) {\n\t\t\t\t\tconst util = this.getShapeUtil(partial as TLShape)\n\n\t\t\t\t\t// If an index is not explicitly provided, then add the\n\t\t\t\t\t// shapes to the top of their parents' children; using the\n\t\t\t\t\t// value in parentsMappedToIndex, get the index above, use it,\n\t\t\t\t\t// and set it back to parentsMappedToIndex for next time.\n\t\t\t\t\tlet index = partial.index\n\n\t\t\t\t\tif (!index) {\n\t\t\t\t\t\tconst parentId = partial.parentId ?? focusLayerId\n\t\t\t\t\t\tif (!parentIndices.has(parentId)) {\n\t\t\t\t\t\t\tparentIndices.set(parentId, this.getHighestIndexForParent(parentId))\n\t\t\t\t\t\t}\n\t\t\t\t\t\tindex = parentIndices.get(parentId)!\n\t\t\t\t\t\tparentIndices.set(parentId, getIndexAbove(index))\n\t\t\t\t\t}\n\n\t\t\t\t\t// The initial props starts as the shape utility's default props\n\t\t\t\t\tconst initialProps = util.defaultProps()\n\n\t\t\t\t\t// We then look up each key in the tab state's props; and if it's there,\n\t\t\t\t\t// we use the value from the tab state's props instead of the default.\n\t\t\t\t\t// Note that props will never include opacity.\n\t\t\t\t\tconst { propsForNextShape } = this.instanceState\n\t\t\t\t\tfor (const key in initialProps) {\n\t\t\t\t\t\tif (key in propsForNextShape) {\n\t\t\t\t\t\t\tif (key === 'url') continue\n\t\t\t\t\t\t\t;(initialProps as any)[key] = (propsForNextShape as any)[key]\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// When we create the shape, take in the partial (the props coming into the\n\t\t\t\t\t// function) and merge it with the default props.\n\t\t\t\t\tlet shapeRecordToCreate = this.config.TLShape.create({\n\t\t\t\t\t\t...partial,\n\t\t\t\t\t\tindex,\n\t\t\t\t\t\tparentId: partial.parentId ?? focusLayerId,\n\t\t\t\t\t\tprops: 'props' in partial ? { ...initialProps, ...partial.props } : initialProps,\n\t\t\t\t\t})\n\n\t\t\t\t\tif (shapeRecordToCreate.index === undefined) {\n\t\t\t\t\t\tthrow Error('no index!')\n\t\t\t\t\t}\n\n\t\t\t\t\tconst next = this.getShapeUtil(shapeRecordToCreate).onBeforeCreate?.(shapeRecordToCreate)\n\n\t\t\t\t\tif (next) {\n\t\t\t\t\t\tshapeRecordToCreate = next\n\t\t\t\t\t}\n\n\t\t\t\t\tshapeRecordsTocreate.push(shapeRecordToCreate)\n\t\t\t\t}\n\n\t\t\t\tthis.store.put(shapeRecordsTocreate)\n\n\t\t\t\t// If we're also selecting the newly created shapes, attempt to select all of them;\n\t\t\t\t// the engine will filter out any shapes that are descendants of other new shapes.\n\t\t\t\tif (select) {\n\t\t\t\t\tconst selectedIds = partials.map((partial) => partial.id)\n\t\t\t\t\tthis.store.update(this.pageState.id, (state) => ({ ...state, selectedIds }))\n\t\t\t\t}\n\t\t\t},\n\t\t\tundo: ({ partials, prevSelectedIds }) => {\n\t\t\t\tthis.store.remove(partials.map((p) => p.id))\n\n\t\t\t\tif (prevSelectedIds) {\n\t\t\t\t\tthis.store.update(this.pageState.id, (state) => ({\n\t\t\t\t\t\t...state,\n\t\t\t\t\t\tselectedIds: prevSelectedIds,\n\t\t\t\t\t}))\n\t\t\t\t}\n\t\t\t},\n\t\t}\n\t)\n\n\tprivate animatingShapes = new Map<TLShapeId, string>()\n\n\t/**\n\t * Animate shapes.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.animateShapes([{ id: \"box1\", type: \"box\", x: 100, y: 100}])\n\t * ```\n\t *\n\t * @param partials - The shape partials to update.\n\t * @public\n\t */\n\tanimateShapes(\n\t\tpartials: (TLShapePartial | null | undefined)[],\n\t\toptions: {\n\t\t\t/** The animation's duration in milliseconds. */\n\t\t\tduration?: number\n\t\t\t/** The animation's easing function. */\n\t\t\tease?: (t: number) => number\n\t\t} = {}\n\t) {\n\t\tconst { duration = 500, ease = EASINGS.linear } = options\n\n\t\tconst animationId = uniqueId()\n\n\t\tlet remaining = duration\n\t\tlet t: number\n\n\t\ttype FromTo = { prop: string; from: number; to: number }\n\t\ttype ShapeAnimation = { partial: TLShapePartial; values: FromTo[] }\n\n\t\tconst animations: ShapeAnimation[] = []\n\n\t\tpartials.forEach((partial) => {\n\t\t\tif (!partial) return\n\n\t\t\tconst result: ShapeAnimation = {\n\t\t\t\tpartial,\n\t\t\t\tvalues: [],\n\t\t\t}\n\n\t\t\tconst shape = this.getShapeById(partial.id)!\n\n\t\t\tif (!shape) return\n\n\t\t\tfor (const key of ['x', 'y', 'rotation'] as const) {\n\t\t\t\tif (partial[key] !== undefined && shape[key] !== partial[key]) {\n\t\t\t\t\tresult.values.push({ prop: key, from: shape[key], to: partial[key] as number })\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tanimations.push(result)\n\t\t\tthis.animatingShapes.set(shape.id, animationId)\n\t\t})\n\n\t\tlet value: ShapeAnimation\n\n\t\tconst handleTick = (elapsed: number) => {\n\t\t\tremaining -= elapsed\n\n\t\t\tif (remaining < 0) {\n\t\t\t\tconst { animatingShapes } = this\n\t\t\t\tconst partialsToUpdate = partials.filter(\n\t\t\t\t\t(p) => p && animatingShapes.get(p.id) === animationId\n\t\t\t\t)\n\t\t\t\tif (partialsToUpdate.length) {\n\t\t\t\t\tthis.updateShapes(partialsToUpdate, false)\n\t\t\t\t\t// update shapes also removes the shape from animating shapes\n\t\t\t\t}\n\n\t\t\t\tthis.removeListener('tick', handleTick)\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tt = ease(1 - remaining / duration)\n\n\t\t\tconst { animatingShapes } = this\n\n\t\t\ttry {\n\t\t\t\tconst tPartials: TLShapePartial[] = []\n\n\t\t\t\tfor (let i = 0; i < animations.length; i++) {\n\t\t\t\t\tvalue = animations[i]\n\n\t\t\t\t\tif (animatingShapes.get(value.partial.id) === animationId) {\n\t\t\t\t\t\ttPartials.push({\n\t\t\t\t\t\t\tid: value.partial.id,\n\t\t\t\t\t\t\ttype: value.partial.type,\n\t\t\t\t\t\t\t...value.values.reduce((acc, { prop, from, to }) => {\n\t\t\t\t\t\t\t\tacc[prop] = from + (to - from) * t\n\t\t\t\t\t\t\t\treturn acc\n\t\t\t\t\t\t\t}, {} as any),\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis._updateShapes(tPartials, true)\n\t\t\t} catch (e) {\n\t\t\t\t// noop\n\t\t\t}\n\t\t}\n\n\t\tthis.addListener('tick', handleTick)\n\n\t\treturn this\n\t}\n\n\t/**\n\t * Update shapes.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.updateShapes([{ id: \"box1\", type: \"box\", x: 100, y: 100}])\n\t * ```\n\t *\n\t * @param partials - The shape partials to update.\n\t * @param squashing - Whether the change is ephemeral.\n\t * @public\n\t */\n\tupdateShapes(partials: (TLShapePartial | null | undefined)[], squashing = false) {\n\t\tif (this.animatingShapes.size > 0) {\n\t\t\tlet partial: TLShapePartial | null | undefined\n\t\t\tfor (let i = 0; i < partials.length; i++) {\n\t\t\t\tpartial = partials[i]\n\t\t\t\tif (partial) {\n\t\t\t\t\tthis.animatingShapes.delete(partial.id)\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis._updateShapes(partials, squashing)\n\t\treturn this\n\t}\n\n\t/** @internal */\n\tprivate _updateShapes = this.history.createCommand(\n\t\t'updateShapes',\n\t\t(_partials: (TLShapePartial | null | undefined)[], squashing = false) => {\n\t\t\tif (this.isReadOnly) return null\n\n\t\t\tconst partials = compact(_partials)\n\n\t\t\tconst snapshots = Object.fromEntries(\n\t\t\t\tcompact(partials.map(({ id }) => this.getShapeById(id))).map((shape) => {\n\t\t\t\t\treturn [shape.id, shape]\n\t\t\t\t})\n\t\t\t)\n\n\t\t\tif (partials.length <= 0) return null\n\n\t\t\tconst updated = compact(\n\t\t\t\tpartials.map((partial) => {\n\t\t\t\t\tconst prev = snapshots[partial.id]\n\t\t\t\t\tif (!prev) return null\n\t\t\t\t\tlet newRecord = null as null | TLShape\n\t\t\t\t\tfor (const [k, v] of Object.entries(partial)) {\n\t\t\t\t\t\tswitch (k) {\n\t\t\t\t\t\t\tcase 'id':\n\t\t\t\t\t\t\tcase 'type':\n\t\t\t\t\t\t\tcase 'typeName': {\n\t\t\t\t\t\t\t\tcontinue\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdefault: {\n\t\t\t\t\t\t\t\tif (v !== (prev as any)[k]) {\n\t\t\t\t\t\t\t\t\tif (!newRecord) {\n\t\t\t\t\t\t\t\t\t\tnewRecord = { ...prev }\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tif (k === 'props') {\n\t\t\t\t\t\t\t\t\t\tnewRecord!.props = { ...prev.props, ...(v as any) }\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t;(newRecord as any)[k] = v\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\treturn newRecord ?? prev\n\t\t\t\t})\n\t\t\t) as TLShape[]\n\n\t\t\tconst updates = Object.fromEntries(updated.map((shape) => [shape.id, shape]))\n\n\t\t\treturn { data: { snapshots, updates }, squashing }\n\t\t},\n\t\t{\n\t\t\tdo: ({ updates }) => {\n\t\t\t\tconst arr = Object.values(updates)\n\n\t\t\t\t// Iterate through array; if any shape has an onUpdate handler, call it\n\t\t\t\t// and, if the handler returns a new shape, replace the old shape with\n\t\t\t\t// the new one. This is used for example when repositioning a text shape\n\t\t\t\t// based on its new text content.\n\t\t\t\tlet shape: TLShape\n\t\t\t\tlet next: TLShape | void\n\t\t\t\tfor (let i = 0, n = arr.length; i < n; i++) {\n\t\t\t\t\tshape = arr[i]\n\t\t\t\t\tnext = this.getShapeUtil(shape).onBeforeUpdate?.(this.store.get(shape.id)!, shape)\n\t\t\t\t\tif (next) {\n\t\t\t\t\t\tarr[i] = next\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.store.put(arr)\n\t\t\t},\n\t\t\tundo: ({ snapshots }) => {\n\t\t\t\tthis.store.put(Object.values(snapshots))\n\t\t\t},\n\t\t\tsquash(prevData, nextData) {\n\t\t\t\treturn {\n\t\t\t\t\t// keep the oldest snapshots\n\t\t\t\t\tsnapshots: { ...nextData.snapshots, ...prevData.snapshots },\n\t\t\t\t\t// keep the newest updates\n\t\t\t\t\tupdates: { ...prevData.updates, ...nextData.updates },\n\t\t\t\t}\n\t\t\t},\n\t\t}\n\t)\n\n\t/**\n\t * Delete shapes.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.deleteShapes()\n\t * \tapp.deleteShapes(['box1', 'box2'])\n\t * ```\n\t *\n\t * @param ids - The ids of the shapes to delete. Defaults to the selected shapes.\n\t * @public\n\t */\n\tdeleteShapes(ids: TLShapeId[] = this.selectedIds) {\n\t\tthis._deleteShapes(ids)\n\t\treturn this\n\t}\n\n\t/** @internal */\n\tprivate _deleteShapes = this.history.createCommand(\n\t\t'delete_shapes',\n\t\t(ids: TLShapeId[]) => {\n\t\t\tif (this.isReadOnly) return null\n\t\t\tif (ids.length === 0) return null\n\t\t\tconst prevSelectedIds = [...this.pageState.selectedIds]\n\n\t\t\tconst allIds = new Set(ids)\n\n\t\t\tfor (const id of ids) {\n\t\t\t\tthis.visitDescendants(id, (childId) => {\n\t\t\t\t\tallIds.add(childId)\n\t\t\t\t})\n\t\t\t}\n\n\t\t\tconst deletedIds = [...allIds]\n\t\t\tconst arrowBindings = this._arrowBindingsIndex.value\n\t\t\tconst snapshots = compact(\n\t\t\t\tdeletedIds.flatMap((id) => {\n\t\t\t\t\tconst shape = this.getShapeById(id)\n\n\t\t\t\t\t// Add any bound arrows to the snapshots, so that we can restore the bindings on undo\n\t\t\t\t\tconst bindings = arrowBindings[id]\n\t\t\t\t\tif (bindings && bindings.length > 0) {\n\t\t\t\t\t\treturn bindings.map(({ arrowId }) => this.getShapeById(arrowId)).concat(shape)\n\t\t\t\t\t}\n\t\t\t\t\treturn shape\n\t\t\t\t})\n\t\t\t)\n\n\t\t\tconst postSelectedIds = prevSelectedIds.filter((id) => !allIds.has(id))\n\n\t\t\treturn { data: { deletedIds, snapshots, prevSelectedIds, postSelectedIds } }\n\t\t},\n\t\t{\n\t\t\tdo: ({ deletedIds, postSelectedIds }) => {\n\t\t\t\tthis.store.remove(deletedIds)\n\t\t\t\tthis.store.update(this.pageState.id, (state) => ({\n\t\t\t\t\t...state,\n\t\t\t\t\tselectedIds: postSelectedIds,\n\t\t\t\t}))\n\t\t\t},\n\t\t\tundo: ({ snapshots, prevSelectedIds }) => {\n\t\t\t\tthis.store.put(snapshots)\n\t\t\t\tthis.store.update(this.pageState.id, (state) => ({\n\t\t\t\t\t...state,\n\t\t\t\t\tselectedIds: prevSelectedIds,\n\t\t\t\t}))\n\t\t\t},\n\t\t}\n\t)\n\n\t/**\n\t * Update user document settings\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.updateUserDocumentSettings({ isGridMode: true })\n\t * ```\n\t *\n\t * @public\n\t */\n\tupdateUserDocumentSettings(partial: Partial<TLUserDocument>, ephemeral = false) {\n\t\tthis._updateUserDocumentSettings(partial, ephemeral)\n\t\treturn this\n\t}\n\n\t/** @internal */\n\tprivate _updateUserDocumentSettings = this.history.createCommand(\n\t\t'updateUserDocumentSettings',\n\t\t(partial: Partial<TLUserDocument>, ephemeral = false) => {\n\t\t\tconst { isReadOnly } = partial\n\t\t\tif (isReadOnly === false) return\n\n\t\t\tconst prev = this.userDocumentSettings\n\t\t\tconst next = { ...prev, ...partial }\n\t\t\treturn { data: { prev, next }, ephemeral }\n\t\t},\n\t\t{\n\t\t\tdo: ({ next }) => {\n\t\t\t\tthis.store.put([next])\n\t\t\t},\n\t\t\tundo: ({ prev }) => {\n\t\t\t\tthis.store.put([prev])\n\t\t\t},\n\t\t}\n\t)\n\n\t/**\n\t * Update a page.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.updatePage({ id: 'page2', name: 'Page 2' })\n\t * ```\n\t *\n\t * @param partial - The partial of the shape to update.\n\t * @public\n\t */\n\tupdatePage(partial: RequiredKeys<TLPage, 'id'>, squashing = false) {\n\t\tthis._updatePage(partial, squashing)\n\t\treturn this\n\t}\n\n\t/** @internal */\n\tprivate _updatePage = this.history.createCommand(\n\t\t'updatePage',\n\t\t(partial: RequiredKeys<TLPage, 'id'>, squashing = false) => {\n\t\t\tif (this.isReadOnly) return null\n\n\t\t\tconst prev = this.getPageById(partial.id)\n\n\t\t\tif (!prev) return null\n\n\t\t\treturn { data: { prev, partial }, squashing }\n\t\t},\n\t\t{\n\t\t\tdo: ({ partial }) => {\n\t\t\t\tthis.store.update(partial.id, (page) => ({ ...page, ...partial }))\n\t\t\t},\n\t\t\tundo: ({ prev, partial }) => {\n\t\t\t\tthis.store.update(partial.id, () => prev)\n\t\t\t},\n\t\t\tsquash(prevData, nextData) {\n\t\t\t\treturn {\n\t\t\t\t\tprev: { ...prevData.prev, ...nextData.prev },\n\t\t\t\t\tpartial: nextData.partial,\n\t\t\t\t}\n\t\t\t},\n\t\t}\n\t)\n\n\t/**\n\t * Create a page.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.createPage('New Page')\n\t * \tapp.createPage('New Page', 'page1')\n\t * ```\n\t *\n\t * @param id - The new page's id.\n\t * @param title - The new page's title.\n\t * @public\n\t */\n\tcreatePage(title: string, id: TLPageId = TLPage.createId(), belowPageIndex?: string) {\n\t\tthis._createPage(title, id, belowPageIndex)\n\t\treturn this\n\t}\n\n\t/** @internal */\n\tprivate _createPage = this.history.createCommand(\n\t\t'createPage',\n\t\t(title: string, id: TLPageId = TLPage.createId(), belowPageIndex?: string) => {\n\t\t\tif (this.isReadOnly) return null\n\t\t\tif (this.pages.length >= MAX_PAGES) return null\n\t\t\tconst pageInfo = this.pages\n\t\t\tconst topIndex = belowPageIndex ?? pageInfo[pageInfo.length - 1]?.index ?? 'a1'\n\t\t\tconst bottomIndex = pageInfo[pageInfo.findIndex((p) => p.index === topIndex) + 1]?.index\n\n\t\t\tconst prevPageState = { ...this.pageState }\n\t\t\tconst prevInstanceState = { ...this.instanceState }\n\n\t\t\ttitle = getIncrementedName(\n\t\t\t\ttitle,\n\t\t\t\tpageInfo.map((p) => p.name)\n\t\t\t)\n\n\t\t\tconst newPage = TLPage.create({\n\t\t\t\tid,\n\t\t\t\tname: title,\n\t\t\t\tindex: bottomIndex ? getIndexBetween(topIndex, bottomIndex) : getIndexAbove(topIndex),\n\t\t\t})\n\n\t\t\tconst newCamera = TLCamera.create({})\n\n\t\t\tconst newTabPageState = TLInstancePageState.create({\n\t\t\t\tpageId: newPage.id,\n\t\t\t\tinstanceId: this.instanceId,\n\t\t\t\tcameraId: newCamera.id,\n\t\t\t})\n\n\t\t\treturn {\n\t\t\t\tdata: {\n\t\t\t\t\tprevPageState,\n\t\t\t\t\tprevTabState: prevInstanceState,\n\t\t\t\t\tnewPage,\n\t\t\t\t\tnewTabPageState,\n\t\t\t\t\tnewCamera,\n\t\t\t\t},\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\tdo: ({ newPage, newTabPageState, newCamera }) => {\n\t\t\t\tthis.store.put([\n\t\t\t\t\tnewPage,\n\t\t\t\t\tnewCamera,\n\t\t\t\t\tnewTabPageState,\n\t\t\t\t\t{ ...this.instanceState, currentPageId: newPage.id },\n\t\t\t\t])\n\t\t\t\tthis.updateCullingBounds()\n\t\t\t},\n\t\t\tundo: ({ newPage, prevPageState, prevTabState, newTabPageState }) => {\n\t\t\t\tthis.store.put([prevPageState, prevTabState])\n\t\t\t\tthis.store.remove([newTabPageState.id, newPage.id, newTabPageState.cameraId])\n\t\t\t\tthis.updateCullingBounds()\n\t\t\t},\n\t\t}\n\t)\n\n\tduplicatePage(id: TLPageId = this.currentPageId, createId: TLPageId = TLPage.createId()) {\n\t\tif (this.pages.length >= MAX_PAGES) return\n\t\tconst page = this.getPageById(id)\n\t\tif (!page) return\n\n\t\tconst camera = { ...this.camera }\n\t\tconst content = this.getContent(this.getSortedChildIds(page.id))\n\n\t\tthis.batch(() => {\n\t\t\tthis.createPage(page.name + ' Copy', createId, page.index)\n\t\t\tthis.setCurrentPageId(createId)\n\t\t\tthis.setCamera(camera.x, camera.y, camera.z)\n\n\t\t\t// will change page automatically\n\t\t\tif (content) {\n\t\t\t\treturn this.putContent(content)\n\t\t\t}\n\t\t})\n\t}\n\n\t/**\n\t * Delete a page.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.deletePage('page1')\n\t * ```\n\t *\n\t * @param id - The id of the page to delete.\n\t * @public\n\t */\n\tdeletePage(id: TLPageId) {\n\t\tthis._deletePage(id)\n\t}\n\n\t/** @internal */\n\tprivate _deletePage = this.history.createCommand(\n\t\t'delete_page',\n\t\t(id: TLPageId) => {\n\t\t\tif (this.isReadOnly) return null\n\t\t\tconst { pages } = this\n\t\t\tif (pages.length === 1) return null\n\n\t\t\tconst deletedPage = this.getPageById(id)\n\t\t\tconst deletedPageStates = this._pageStates.value.filter((s) => s.pageId === id)\n\n\t\t\tif (!deletedPage) return null\n\n\t\t\tif (id === this.currentPageId) {\n\t\t\t\tconst index = pages.findIndex((page) => page.id === id)\n\t\t\t\tconst next = pages[index - 1] ?? pages[index + 1]\n\t\t\t\tthis.setCurrentPageId(next.id)\n\t\t\t}\n\n\t\t\treturn { data: { id, deletedPage, deletedPageStates } }\n\t\t},\n\t\t{\n\t\t\tdo: ({ deletedPage, deletedPageStates }) => {\n\t\t\t\tthis.store.remove(deletedPageStates.map((s) => s.id)) // remove the page state\n\t\t\t\tthis.store.remove([deletedPage.id]) // remove the page\n\t\t\t\tthis.updateCullingBounds()\n\t\t\t},\n\t\t\tundo: ({ deletedPage, deletedPageStates }) => {\n\t\t\t\tthis.store.put([deletedPage])\n\t\t\t\tthis.store.put(deletedPageStates)\n\t\t\t\tthis.updateCullingBounds()\n\t\t\t},\n\t\t}\n\t)\n\n\t/**\n\t * Update a page state.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.setInstancePageState({ id: 'page1', editingId: \"shape:123\" })\n\t * \tapp.setInstancePageState({ id: 'page1', editingId: \"shape:123\" }, true)\n\t * ```\n\t *\n\t * @param partial - The partial of the page state object containing the changes.\n\t * @param ephemeral - Whether the command is ephemeral.\n\t * @public\n\t */\n\tsetInstancePageState(partial: Partial<TLInstancePageState>, ephemeral = false) {\n\t\tthis._setInstancePageState(partial, ephemeral)\n\t}\n\n\t/** @internal */\n\tprivate _setInstancePageState = this.history.createCommand(\n\t\t'setInstancePageState',\n\t\t(partial: Partial<TLInstancePageState>, ephemeral = false) => {\n\t\t\tconst prev = this.store.get(partial.id ?? this.pageState.id)!\n\t\t\treturn { data: { prev, partial }, ephemeral }\n\t\t},\n\t\t{\n\t\t\tdo: ({ prev, partial }) => {\n\t\t\t\tthis.store.update(prev.id, (state) => ({ ...state, ...partial }))\n\t\t\t},\n\t\t\tundo: ({ prev }) => {\n\t\t\t\tthis.store.update(prev.id, () => prev)\n\t\t\t},\n\t\t}\n\t)\n\n\t/**\n\t * Set user state. Always ephemeral for now.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.updateUser({ color: '#923433' })\n\t * ```\n\t *\n\t * @param partial - The partial of the user state object containing the changes.\n\t * @public\n\t */\n\tupdateUser(partial: Partial<TLUser>) {\n\t\tconst next = { ...this.user, ...partial }\n\t\tthis.store.put([next])\n\t}\n\n\t/** @internal */\n\t@computed private get _currentUserPresence() {\n\t\treturn this.store.query.record('user_presence', () => ({ userId: { eq: this.userId } }))\n\t}\n\n\tget userPresence() {\n\t\treturn this._currentUserPresence.value\n\t}\n\n\t// when a user performs any action in the app, we update their presence record\n\tupdateUserPresence = ({ cursor, color }: { cursor?: Vec2dModel; color?: string } = {}) => {\n\t\tconst presence = this._currentUserPresence.value\n\t\tif (!presence) {\n\t\t\tconsole.error('No presence found for current user')\n\t\t\treturn\n\t\t}\n\n\t\tthis.store.put([\n\t\t\t{\n\t\t\t\t...presence,\n\t\t\t\tcursor: cursor ?? presence.cursor,\n\t\t\t\tcolor: color ?? presence.color,\n\t\t\t\tlastUsedInstanceId: this.instanceId,\n\t\t\t\tlastActivityTimestamp: Date.now(),\n\t\t\t},\n\t\t])\n\t}\n\n\t/**\n\t * Select one or more shapes.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.setSelectedIds(['id1'])\n\t * \tapp.setSelectedIds(['id1', 'id2'])\n\t * ```\n\t *\n\t * @param ids - The ids to select.\n\t * @param squashing - Whether the change should create a new history entry or combine with the\n\t *   previous (if the previous is the same type).\n\t * @public\n\t */\n\tsetSelectedIds(ids: TLShapeId[], squashing = false) {\n\t\tthis._setSelectedIds(ids, squashing)\n\t\treturn this\n\t}\n\n\t/** @internal */\n\tprivate _setSelectedIds = this.history.createCommand(\n\t\t'setSelectedIds',\n\t\t(ids: TLShapeId[], squashing = false) => {\n\t\t\tconst prevSelectedIds = this.pageState.selectedIds\n\n\t\t\tconst prevSet = new Set(this.pageState.selectedIds)\n\n\t\t\tif (ids.length === prevSet.size && ids.every((id) => prevSet.has(id))) return null\n\n\t\t\treturn { data: { ids, prevSelectedIds }, squashing, preservesRedoStack: true }\n\t\t},\n\t\t{\n\t\t\tdo: ({ ids }) => {\n\t\t\t\tthis.store.update(this.pageState.id, (state) => ({ ...state, selectedIds: ids }))\n\t\t\t},\n\t\t\tundo: ({ prevSelectedIds }) => {\n\t\t\t\tthis.store.update(this.pageState.id, () => ({\n\t\t\t\t\t...this.pageState,\n\t\t\t\t\tselectedIds: prevSelectedIds,\n\t\t\t\t}))\n\t\t\t},\n\t\t\tsquash(prev, next) {\n\t\t\t\treturn { ids: next.ids, prevSelectedIds: prev.prevSelectedIds }\n\t\t\t},\n\t\t}\n\t)\n\n\t/**\n\t * Determine whether or not a shape is selected\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.isSelected('id1')\n\t * ```\n\t *\n\t * @param id - The id of the shape to check.\n\t * @public\n\t */\n\tisSelected(id: TLShapeId) {\n\t\treturn this.selectedIdsSet.has(id)\n\t}\n\n\t/**\n\t * Determine whether a not a shape is within the current selection. A shape\n\t * is within the selection if it or any of its parents is selected.\n\t *\n\t * @param id - The id of the shape to check.\n\t * @public\n\t */\n\tisWithinSelection(id: TLShapeId) {\n\t\tconst shape = this.getShapeById(id)\n\t\tif (!shape) return false\n\n\t\tif (this.isSelected(id)) return true\n\n\t\treturn !!this.findAncestor(shape, (parent) => this.isSelected(parent.id))\n\t}\n\n\t/* --------------------- Assets --------------------- */\n\n\t/** @internal */\n\t@computed private get _assets() {\n\t\treturn this.store.query.records('asset')\n\t}\n\n\t/**\n\t * Get all assets in the app.\n\t */\n\tget assets() {\n\t\treturn this._assets.value\n\t}\n\n\t/**\n\t * Create one or more assets.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.createAssets([...myAssets])\n\t * ```\n\t *\n\t * @param assets - The assets to create.\n\t * @public\n\t */\n\tcreateAssets(assets: TLAsset[]) {\n\t\tthis._createAssets(assets)\n\t\treturn this\n\t}\n\n\t/** @internal */\n\tprivate _createAssets = this.history.createCommand(\n\t\t'createAssets',\n\t\t(assets: TLAsset[]) => {\n\t\t\tif (this.isReadOnly) return null\n\t\t\tif (assets.length <= 0) return null\n\n\t\t\treturn { data: { assets } }\n\t\t},\n\t\t{\n\t\t\tdo: ({ assets }) => {\n\t\t\t\tthis.store.put(assets)\n\t\t\t},\n\t\t\tundo: ({ assets }) => {\n\t\t\t\tthis.store.remove(assets.map((a) => a.id))\n\t\t\t},\n\t\t}\n\t)\n\n\t/**\n\t * Delete one or more assets.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.deleteAssets(['asset1', 'asset2'])\n\t * ```\n\t *\n\t * @param ids - The assets to delete.\n\t * @public\n\t */\n\tdeleteAssets(ids: TLAssetId[]) {\n\t\tthis._deleteAssets(ids)\n\t\treturn this\n\t}\n\n\t/** @internal */\n\tprivate _deleteAssets = this.history.createCommand(\n\t\t'deleteAssets',\n\t\t(ids: TLAssetId[]) => {\n\t\t\tif (this.isReadOnly) return\n\t\t\tif (ids.length <= 0) return\n\n\t\t\tconst prev = compact(ids.map((id) => this.store.get(id)))\n\n\t\t\treturn { data: { ids, prev } }\n\t\t},\n\t\t{\n\t\t\tdo: ({ ids }) => {\n\t\t\t\tthis.store.remove(ids)\n\t\t\t},\n\t\t\tundo: ({ prev }) => {\n\t\t\t\tthis.store.put(prev)\n\t\t\t},\n\t\t}\n\t)\n\n\t/**\n\t * Update one or more assets.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.updateAssets([{ id: 'asset1', name: 'New name' }])\n\t * ```\n\t *\n\t * @param assets - The assets to update.\n\t * @public\n\t */\n\tupdateAssets(assets: TLAssetPartial[]) {\n\t\tthis._updateAssets(assets)\n\t\treturn this\n\t}\n\n\t/** @internal */\n\tprivate _updateAssets = this.history.createCommand(\n\t\t'updateAssets',\n\t\t(assets: TLAssetPartial[]) => {\n\t\t\tif (this.isReadOnly) return\n\t\t\tif (assets.length <= 0) return\n\n\t\t\tconst snapshots: Record<string, TLAsset> = {}\n\n\t\t\treturn { data: { snapshots, assets } }\n\t\t},\n\t\t{\n\t\t\tdo: ({ assets, snapshots }) => {\n\t\t\t\tthis.store.put(\n\t\t\t\t\tassets.map((a) => {\n\t\t\t\t\t\tconst asset = this.store.get(a.id)!\n\t\t\t\t\t\tsnapshots[a.id] = asset\n\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t...asset,\n\t\t\t\t\t\t\t...a,\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t)\n\t\t\t},\n\t\t\tundo: ({ snapshots }) => {\n\t\t\t\tthis.store.put(Object.values(snapshots))\n\t\t\t},\n\t\t}\n\t)\n\n\t/**\n\t * Get an asset by its src property.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.getAssetBySource('https://example.com/image.png')\n\t * ```\n\t *\n\t * @param src - The source value of the asset.\n\t * @public\n\t */\n\tgetAssetBySrc(src: string) {\n\t\treturn this.assets.find((a) => a.props.src === src)\n\t}\n\n\t/**\n\t * Get an asset by its id.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.getAssetById('asset1')\n\t * ```\n\t *\n\t * @param id - The id of the asset.\n\t * @public\n\t */\n\tgetAssetById(id: TLAssetId): TLAsset | undefined {\n\t\treturn this.store.get(id) as TLAsset | undefined\n\t}\n\n\t/* ------------------- SubCommands ------------------ */\n\tasync getSvg(\n\t\tids: TLShapeId[] = (this.selectedIds.length\n\t\t\t? this.selectedIds\n\t\t\t: Object.keys(this.shapeIds)) as TLShapeId[],\n\t\topts = {} as Partial<{\n\t\t\tscale: number\n\t\t\tbackground: boolean\n\t\t\tpadding: number\n\t\t\tdarkMode?: boolean\n\t\t\tpreserveAspectRatio: React.SVGAttributes<SVGSVGElement>['preserveAspectRatio']\n\t\t}>\n\t) {\n\t\tif (ids.length === 0) return\n\t\tif (!window.document) throw Error('No document')\n\n\t\tconst {\n\t\t\tscale = 1,\n\t\t\tbackground = false,\n\t\t\tpadding = SVG_PADDING,\n\t\t\tdarkMode = this.userDocumentSettings.isDarkMode,\n\t\t\tpreserveAspectRatio = false,\n\t\t} = opts\n\n\t\tconst realContainerEl = this.getContainer()\n\t\tconst realContainerStyle = getComputedStyle(realContainerEl)\n\n\t\t// Get the styles from the container. We'll use these to pull out colors etc.\n\t\t// NOTE: We can force force a light theme here becasue we don't want export\n\t\tconst fakeContainerEl = document.createElement('div')\n\t\tfakeContainerEl.className = `rs-container rs-theme__${darkMode ? 'dark' : 'light'}`\n\t\tdocument.body.appendChild(fakeContainerEl)\n\n\t\tconst containerStyle = getComputedStyle(fakeContainerEl)\n\t\tconst fontsUsedInExport = new Map<string, string>()\n\n\t\tconst colors: TLExportColors = {\n\t\t\tfill: Object.fromEntries(\n\t\t\t\tSTYLES.color.map((color) => [\n\t\t\t\t\tcolor.id,\n\t\t\t\t\tcontainerStyle.getPropertyValue(`--palette-${color.id}`),\n\t\t\t\t])\n\t\t\t) as Record<TLColorType, string>,\n\t\t\tpattern: Object.fromEntries(\n\t\t\t\tSTYLES.color.map((color) => [\n\t\t\t\t\tcolor.id,\n\t\t\t\t\tcontainerStyle.getPropertyValue(`--palette-${color.id}-pattern`),\n\t\t\t\t])\n\t\t\t) as Record<TLColorType, string>,\n\t\t\tsemi: Object.fromEntries(\n\t\t\t\tSTYLES.color.map((color) => [\n\t\t\t\t\tcolor.id,\n\t\t\t\t\tcontainerStyle.getPropertyValue(`--palette-${color.id}-semi`),\n\t\t\t\t])\n\t\t\t) as Record<TLColorType, string>,\n\t\t\ttext: containerStyle.getPropertyValue(`--color-text`),\n\t\t\tbackground: containerStyle.getPropertyValue(`--color-background`),\n\t\t\tsolid: containerStyle.getPropertyValue(`--palette-solid`),\n\t\t}\n\n\t\t// Remove containerEl from DOM (temp DOM node)\n\t\tdocument.body.removeChild(fakeContainerEl)\n\n\t\t// ---Figure out which shapes we need to include\n\n\t\tconst shapes = this.getShapesAndDescendantsInOrder(ids)\n\n\t\t// --- Common bounding box of all shapes\n\n\t\t// Get the common bounding box for the selected nodes (with some padding)\n\t\tconst bbox = Box2d.FromPoints(\n\t\t\tshapes\n\t\t\t\t.map((shape) => {\n\t\t\t\t\tconst pageTransform = this.getPageTransform(shape)!\n\t\t\t\t\tconst pageOutline = Matrix2d.applyToPoints(pageTransform, this.getOutline(shape))\n\t\t\t\t\treturn pageOutline\n\t\t\t\t})\n\t\t\t\t.flat()\n\t\t)\n\n\t\t// Expand by an extra 32 pixels\n\t\tbbox.expandBy(padding)\n\n\t\t// --- Create the SVG\n\n\t\t// Embed our custom fonts\n\t\tconst svg = window.document.createElementNS('http://www.w3.org/2000/svg', 'svg')\n\n\t\tif (preserveAspectRatio) {\n\t\t\tsvg.setAttribute('preserveAspectRatio', preserveAspectRatio)\n\t\t}\n\n\t\t// Use the bounding box to set the size and viewBox of the svg\n\n\t\t// We want the svg image to be BIGGER THAN USUAL to account for image quality\n\t\tconst w = bbox.width * scale\n\t\tconst h = bbox.height * scale\n\n\t\tsvg.setAttribute('direction', 'ltr')\n\t\tsvg.setAttribute('width', w + '')\n\t\tsvg.setAttribute('height', h + '')\n\t\tsvg.setAttribute('viewBox', `${bbox.minX} ${bbox.minY} ${bbox.width} ${bbox.height}`)\n\t\tsvg.setAttribute('stroke-linecap', 'round')\n\t\tsvg.setAttribute('stroke-linejoin', 'round')\n\t\t// Add current background color, or else background will be transparent\n\t\tsvg.style.setProperty('background-color', background ? colors.background : 'transparent')\n\n\t\t// Add the defs to the svg\n\t\tconst defs = window.document.createElementNS('http://www.w3.org/2000/svg', 'defs')\n\n\t\tfor (const element of Array.from(exportPatternSvgDefs())) {\n\t\t\tdefs.appendChild(element)\n\t\t}\n\n\t\ttry {\n\t\t\tdocument.body.focus?.() // weird but necessary\n\t\t} catch (e) {\n\t\t\t// not implemented\n\t\t}\n\n\t\tsvg.append(defs)\n\n\t\t// Must happen in order, not using a promise.all, or else the order of the\n\t\t// elements in the svg will be wrong.\n\n\t\tfor (const shape of shapes) {\n\t\t\tlet font: string | undefined\n\n\t\t\tif ('font' in shape.props) {\n\t\t\t\tif (shape.props.font) {\n\t\t\t\t\tif (fontsUsedInExport.has(shape.props.font)) {\n\t\t\t\t\t\tfont = fontsUsedInExport.get(shape.props.font)!\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// For some reason these styles aren't present in the fake element\n\t\t\t\t\t\t// so we need to get them from the real element\n\t\t\t\t\t\tfont = realContainerStyle.getPropertyValue(`--rs-font-${shape.props.font}`)\n\t\t\t\t\t\tfontsUsedInExport.set(shape.props.font, font)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst util = this.getShapeUtil(shape)\n\n\t\t\tlet utilSvgElement = await util.toSvg?.(shape, font, colors)\n\n\t\t\tif (!utilSvgElement) {\n\t\t\t\tconst bounds = this.getPageBounds(shape)!\n\t\t\t\tconst elm = window.document.createElementNS('http://www.w3.org/2000/svg', 'rect')\n\t\t\t\telm.setAttribute('width', bounds.width + '')\n\t\t\t\telm.setAttribute('height', bounds.height + '')\n\t\t\t\telm.setAttribute('fill', colors.solid)\n\t\t\t\telm.setAttribute('stroke', colors.pattern.grey)\n\t\t\t\telm.setAttribute('stroke-width', '1')\n\t\t\t\tutilSvgElement = elm\n\t\t\t}\n\n\t\t\t// If the node implements toSvg, use that\n\t\t\tconst shapeSvg = utilSvgElement\n\n\t\t\tlet pageTransform = this.getPageTransform(shape)!.toCssString()\n\n\t\t\tif ('scale' in shape.props) {\n\t\t\t\tif (shape.props.scale !== 1) {\n\t\t\t\t\tpageTransform = `${pageTransform} scale(${shape.props.scale}, ${shape.props.scale})`\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tshapeSvg.setAttribute('transform', pageTransform)\n\t\t\tif ('opacity' in shape.props) shapeSvg.setAttribute('opacity', shape.props.opacity + '')\n\n\t\t\t// Append it to the SVG\n\t\t\tsvg.appendChild(shapeSvg)\n\n\t\t\t// Create svg mask if shape has a frame as parent\n\t\t\tconst clipPath = this._clipPathCache.get(shape.id)\n\t\t\tif (shapeSvg && clipPath) {\n\t\t\t\t// Safari doesn't rotate clip-path's unless they are nested within an element\n\t\t\t\t// See <https://linear.app/tldraw/issue/TLD-1011/svg-export-gets-clipped-in-safari>\n\t\t\t\tconst innerElement = document.createElementNS('http://www.w3.org/2000/svg', 'g')\n\t\t\t\tinnerElement.style.clipPath = clipPath\n\t\t\t\tconst nodes = Array.from(shapeSvg.childNodes)\n\t\t\t\tnodes.forEach((node) => innerElement.appendChild(node))\n\t\t\t\tshapeSvg.appendChild(innerElement)\n\t\t\t}\n\t\t}\n\n\t\t// Add styles to the defs\n\n\t\tlet styles = ``\n\t\tconst style = window.document.createElementNS('http://www.w3.org/2000/svg', 'style')\n\n\t\t// Insert fonts into app\n\t\tconst fontInstances: any[] = []\n\n\t\tif ('fonts' in document) {\n\t\t\tdocument.fonts.forEach((font) => fontInstances.push(font))\n\t\t}\n\n\t\tfor (const font of fontInstances) {\n\t\t\tconst fileReader = new FileReader()\n\n\t\t\tlet isUsed = false\n\n\t\t\tfontsUsedInExport.forEach((fontName) => {\n\t\t\t\tif (fontName.includes(font.family)) {\n\t\t\t\t\tisUsed = true\n\t\t\t\t}\n\t\t\t})\n\n\t\t\tif (!isUsed) continue\n\n\t\t\tconst url = (font as any).$$_url\n\n\t\t\tconst fontFaceRule = (font as any).$$_fontface\n\n\t\t\tif (url) {\n\t\t\t\tconst fontFile = await (await fetch(url)).blob()\n\n\t\t\t\tconst base64Font = await new Promise<string>((resolve, reject) => {\n\t\t\t\t\tfileReader.onload = () => resolve(fileReader.result as string)\n\t\t\t\t\tfileReader.onerror = () => reject(fileReader.error)\n\t\t\t\t\tfileReader.readAsDataURL(fontFile)\n\t\t\t\t})\n\n\t\t\t\tconst newFontFaceRule = '\\n' + fontFaceRule.replaceAll(url, base64Font)\n\t\t\t\tstyles += newFontFaceRule\n\t\t\t}\n\t\t}\n\n\t\tstyle.textContent = styles\n\n\t\tdefs.append(style)\n\n\t\treturn svg\n\t}\n\n\t/**\n\t * Rename a page.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.renamePage('page1', 'My Page')\n\t * ```\n\t *\n\t * @param id - The id of the page to rename.\n\t * @param name - The new name.\n\t * @public\n\t */\n\trenamePage(id: TLPageId, name: string, squashing = false) {\n\t\tif (this.isReadOnly) return this\n\t\tthis.updatePage({ id, name }, squashing)\n\t\treturn this\n\t}\n\n\t/**\n\t * Move shapes to page.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.moveShapesToPage(['box1', 'box2'], 'page1')\n\t * ```\n\t *\n\t * @param ids - The ids of the shapes to move.\n\t * @param pageId - The id of the page where the shapes will be moved.\n\t * @public\n\t */\n\tmoveShapesToPage(ids: TLShapeId[], pageId: TLPageId): this {\n\t\tif (ids.length === 0) return this\n\t\tif (this.isReadOnly) return this\n\n\t\tconst { currentPageId } = this\n\n\t\tif (pageId === currentPageId) return this\n\t\tif (!this.store.has(pageId)) return this\n\n\t\t// Basically copy the shapes\n\t\tconst content = this.getContent(ids)\n\n\t\t// Just to be sure\n\t\tif (!content) return this\n\n\t\t// If there is no space on pageId, or if the selected shapes\n\t\t// would take the new page above the limit, don't move the shapes\n\t\tif (this.getShapesInPage(pageId).length + content.shapes.length > MAX_SHAPES_PER_PAGE) {\n\t\t\talertMaxShapes(this, pageId)\n\t\t\treturn this\n\t\t}\n\n\t\tconst fromPageZ = this.camera.z\n\n\t\tthis.history.batch(() => {\n\t\t\t// Delete the shapes on the current page\n\t\t\tthis.deleteShapes(ids)\n\n\t\t\t// Move to the next page\n\t\t\tthis.setCurrentPageId(pageId)\n\n\t\t\t// Put the shape content onto the new page; parents and indices will\n\t\t\t// be taken care of by the putContent method; make sure to pop any focus\n\t\t\t// layers so that the content will be put onto the page.\n\t\t\tthis.setFocusLayer(null)\n\t\t\tthis.selectNone()\n\t\t\tthis.putContent(content, { select: true, preserveIds: true, preservePosition: true })\n\n\t\t\t// Force the new page's camera to be at the same zoom level as the\n\t\t\t// \"from\" page's camera, then center the \"to\" page's camera on the\n\t\t\t// pasted shapes\n\t\t\tconst {\n\t\t\t\tcenter: { x, y },\n\t\t\t} = this.selectionBounds!\n\t\t\tthis.setCamera(this.camera.x, this.camera.y, fromPageZ)\n\t\t\tthis.centerOnPoint(x, y)\n\t\t})\n\n\t\tthis.emit('moved-to-page', { name: this.currentPage.name, toId: pageId, fromId: currentPageId })\n\n\t\treturn this\n\t}\n\n\tlockShapes(_ids: TLShapeId[] = this.pageState.selectedIds): this {\n\t\tif (this.isReadOnly) return this\n\t\t// todo\n\t\treturn this\n\t}\n\n\t/**\n\t * Reorder shapes.\n\t *\n\t * @param operation - The operation to perform.\n\t * @param ids - The ids to reorder.\n\t * @public\n\t */\n\treorderShapes(operation: TLReorderOperation, ids: TLShapeId[]) {\n\t\tif (this.isReadOnly) return this\n\t\tif (ids.length === 0) return this\n\n\t\tconst parents = this.getParentsMappedToChildren(ids)\n\n\t\tconst changes: TLShapePartial[] = []\n\n\t\tswitch (operation) {\n\t\t\tcase 'toBack': {\n\t\t\t\tparents.forEach((movingSet, parentId) => {\n\t\t\t\t\tconst siblings = compact(\n\t\t\t\t\t\tthis.getSortedChildIds(parentId).map((id) => this.getShapeById(id))\n\t\t\t\t\t)\n\n\t\t\t\t\tif (movingSet.size === siblings.length) return\n\n\t\t\t\t\tlet below: string | undefined\n\t\t\t\t\tlet above: string | undefined\n\n\t\t\t\t\tfor (const shape of siblings) {\n\t\t\t\t\t\tif (!movingSet.has(shape)) {\n\t\t\t\t\t\t\tabove = shape.index\n\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\t}\n\t\t\t\t\t\tmovingSet.delete(shape)\n\t\t\t\t\t\tbelow = shape.index\n\t\t\t\t\t}\n\n\t\t\t\t\tif (movingSet.size === 0) return\n\n\t\t\t\t\tconst indices = getIndicesBetween(below, above, movingSet.size)\n\n\t\t\t\t\tArray.from(movingSet.values())\n\t\t\t\t\t\t.sort(sortByIndex)\n\t\t\t\t\t\t.forEach((node, i) =>\n\t\t\t\t\t\t\tchanges.push({ id: node.id as any, type: node.type, index: indices[i] })\n\t\t\t\t\t\t)\n\t\t\t\t})\n\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tcase 'toFront': {\n\t\t\t\tparents.forEach((movingSet, parentId) => {\n\t\t\t\t\tconst siblings = compact(\n\t\t\t\t\t\tthis.getSortedChildIds(parentId).map((id) => this.getShapeById(id))\n\t\t\t\t\t)\n\t\t\t\t\tconst len = siblings.length\n\n\t\t\t\t\tif (movingSet.size === len) return\n\n\t\t\t\t\tlet below: string | undefined\n\t\t\t\t\tlet above: string | undefined\n\n\t\t\t\t\tfor (let i = len - 1; i > -1; i--) {\n\t\t\t\t\t\tconst shape = siblings[i]\n\n\t\t\t\t\t\tif (!movingSet.has(shape)) {\n\t\t\t\t\t\t\tbelow = shape.index\n\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tmovingSet.delete(shape)\n\t\t\t\t\t\tabove = shape.index\n\t\t\t\t\t}\n\n\t\t\t\t\tif (movingSet.size === 0) return\n\n\t\t\t\t\tconst indices = getIndicesBetween(below, above, movingSet.size)\n\n\t\t\t\t\tArray.from(movingSet.values())\n\t\t\t\t\t\t.sort(sortByIndex)\n\t\t\t\t\t\t.forEach((node, i) =>\n\t\t\t\t\t\t\tchanges.push({ id: node.id as any, type: node.type, index: indices[i] })\n\t\t\t\t\t\t)\n\t\t\t\t})\n\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tcase 'forward': {\n\t\t\t\tparents.forEach((movingSet, parentId) => {\n\t\t\t\t\tconst siblings = compact(\n\t\t\t\t\t\tthis.getSortedChildIds(parentId).map((id) => this.getShapeById(id))\n\t\t\t\t\t)\n\t\t\t\t\tconst len = siblings.length\n\n\t\t\t\t\tif (movingSet.size === len) return\n\n\t\t\t\t\tconst movingIndices = new Set(Array.from(movingSet).map((n) => siblings.indexOf(n)))\n\n\t\t\t\t\tlet selectIndex = -1\n\t\t\t\t\tlet isSelecting = false\n\t\t\t\t\tlet below: string | undefined\n\t\t\t\t\tlet above: string | undefined\n\t\t\t\t\tlet count: number\n\n\t\t\t\t\tfor (let i = 0; i < len; i++) {\n\t\t\t\t\t\tconst isMoving = movingIndices.has(i)\n\n\t\t\t\t\t\tif (!isSelecting && isMoving) {\n\t\t\t\t\t\t\tisSelecting = true\n\t\t\t\t\t\t\tselectIndex = i\n\t\t\t\t\t\t\tabove = undefined\n\t\t\t\t\t\t} else if (isSelecting && !isMoving) {\n\t\t\t\t\t\t\tisSelecting = false\n\t\t\t\t\t\t\tcount = i - selectIndex\n\t\t\t\t\t\t\tbelow = siblings[i].index\n\t\t\t\t\t\t\tabove = siblings[i + 1]?.index\n\n\t\t\t\t\t\t\tconst indices = getIndicesBetween(below, above, count)\n\n\t\t\t\t\t\t\tfor (let k = 0; k < count; k++) {\n\t\t\t\t\t\t\t\tconst node = siblings[selectIndex + k]\n\t\t\t\t\t\t\t\tchanges.push({ id: node.id as any, type: node.type, index: indices[k] })\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t})\n\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tcase 'backward': {\n\t\t\t\tparents.forEach((movingSet, parentId) => {\n\t\t\t\t\tconst siblings = compact(\n\t\t\t\t\t\tthis.getSortedChildIds(parentId).map((id) => this.getShapeById(id))\n\t\t\t\t\t)\n\t\t\t\t\tconst len = siblings.length\n\n\t\t\t\t\tif (movingSet.size === len) return\n\n\t\t\t\t\tconst movingIndices = new Set(Array.from(movingSet).map((n) => siblings.indexOf(n)))\n\n\t\t\t\t\tlet selectIndex = -1\n\t\t\t\t\tlet isSelecting = false\n\t\t\t\t\tlet count: number\n\n\t\t\t\t\tfor (let i = len - 1; i > -1; i--) {\n\t\t\t\t\t\tconst isMoving = movingIndices.has(i)\n\n\t\t\t\t\t\tif (!isSelecting && isMoving) {\n\t\t\t\t\t\t\tisSelecting = true\n\t\t\t\t\t\t\tselectIndex = i\n\t\t\t\t\t\t} else if (isSelecting && !isMoving) {\n\t\t\t\t\t\t\tisSelecting = false\n\t\t\t\t\t\t\tcount = selectIndex - i\n\n\t\t\t\t\t\t\tconst indices = getIndicesBetween(siblings[i - 1]?.index, siblings[i].index, count)\n\n\t\t\t\t\t\t\tfor (let k = 0; k < count; k++) {\n\t\t\t\t\t\t\t\tconst node = siblings[i + k + 1]\n\t\t\t\t\t\t\t\tchanges.push({ id: node.id as any, type: node.type, index: indices[k] })\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t})\n\n\t\t\t\tbreak\n\t\t\t}\n\t\t}\n\n\t\tthis.updateShapes(changes)\n\t\treturn this\n\t}\n\n\t/**\n\t * Send shapes to the back of the page's object list.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.sendToBack()\n\t * \tapp.sendToBack(['id1', 'id2'])\n\t * ```\n\t *\n\t * @param ids - The ids of the shapes to move. Defaults to the ids of the selected\n\t *   shapes.\n\t * @public\n\t */\n\tsendToBack(ids = this.pageState.selectedIds) {\n\t\tthis.reorderShapes('toBack', ids)\n\t\treturn this\n\t}\n\n\t/**\n\t * Send shapes backward in the page's object list.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.sendBackward()\n\t * \tapp.sendBackward(['id1', 'id2'])\n\t * ```\n\t *\n\t * @param ids - The ids of the shapes to move. Defaults to the ids of the selected\n\t *   shapes.\n\t * @public\n\t */\n\tsendBackward(ids = this.pageState.selectedIds) {\n\t\tthis.reorderShapes('backward', ids)\n\t\treturn this\n\t}\n\n\t/**\n\t * Bring shapes forward in the page's object list.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.bringForward()\n\t * \tapp.bringForward(['id1', 'id2'])\n\t * ```\n\t *\n\t * @param ids - The ids of the shapes to move. Defaults to the ids of the selected\n\t *   shapes.\n\t * @public\n\t */\n\tbringForward(ids = this.pageState.selectedIds) {\n\t\tthis.reorderShapes('forward', ids)\n\t\treturn this\n\t}\n\n\t/**\n\t * Bring shapes to the front of the page's object list.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.bringToFront()\n\t * \tapp.bringToFront(['id1', 'id2'])\n\t * ```\n\t *\n\t * @param ids - The ids of the shapes to move. Defaults to the ids of the selected\n\t *   shapes.\n\t * @public\n\t */\n\tbringToFront(ids = this.pageState.selectedIds) {\n\t\tthis.reorderShapes('toFront', ids)\n\t\treturn this\n\t}\n\n\t/**\n\t * Flip shape positions.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.flipShapes('horizontal')\n\t * \tapp.flipShapes('horizontal', ['box1', 'box2'])\n\t * ```\n\t *\n\t * @param operation - Whether to flip horizontally or vertically.\n\t * @param ids - The ids of the shapes to flip. Defaults to selected shapes.\n\t * @public\n\t */\n\tflipShapes(operation: 'horizontal' | 'vertical', ids: TLShapeId[] = this.selectedIds) {\n\t\tif (this.isReadOnly) return this\n\n\t\tlet shapes = compact(ids.map((id) => this.getShapeById(id)))\n\n\t\tif (!shapes.length) return this\n\n\t\tshapes = shapes\n\t\t\t.map((shape) => {\n\t\t\t\tif (shape.type === 'group') {\n\t\t\t\t\treturn this.getSortedChildIds(shape.id).map((id) => this.getShapeById(id))\n\t\t\t\t}\n\n\t\t\t\treturn shape\n\t\t\t})\n\t\t\t.flat() as TLShape[]\n\n\t\tconst scaleOriginPage = Box2d.Common(compact(shapes.map((id) => this.getPageBounds(id)))).center\n\n\t\tfor (const shape of shapes) {\n\t\t\tconst util = this.getShapeUtil(shape)\n\t\t\tconst bounds = util.bounds(shape)\n\t\t\tconst initialPageTransform = this.getPageTransformById(shape.id)\n\t\t\tif (!initialPageTransform) continue\n\t\t\tthis.resizeShape(\n\t\t\t\tshape.id,\n\t\t\t\t{ x: operation === 'horizontal' ? -1 : 1, y: operation === 'vertical' ? -1 : 1 },\n\t\t\t\t{\n\t\t\t\t\tinitialBounds: bounds,\n\t\t\t\t\tinitialPageTransform,\n\t\t\t\t\tinitialShape: shape,\n\t\t\t\t\tmode: 'scale_shape',\n\t\t\t\t\tscaleOrigin: scaleOriginPage,\n\t\t\t\t\tscaleAxisRotation: 0,\n\t\t\t\t}\n\t\t\t)\n\t\t}\n\n\t\treturn this\n\t}\n\n\t/**\n\t * Stack shape.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.stackShapes('horizontal')\n\t * \tapp.stackShapes('horizontal', ['box1', 'box2'])\n\t * \tapp.stackShapes('horizontal', ['box1', 'box2'], 20)\n\t * ```\n\t *\n\t * @param operation - Whether to stack horizontally or vertically.\n\t * @param ids - The ids of the shapes to stack. Defaults to selected shapes.\n\t * @param gap - A specific gap to use when stacking.\n\t * @public\n\t */\n\tstackShapes(\n\t\toperation: 'horizontal' | 'vertical',\n\t\tids: TLShapeId[] = this.pageState.selectedIds,\n\t\tgap?: number\n\t) {\n\t\tif (this.isReadOnly) return this\n\n\t\tconst shapes = compact(ids.map((id) => this.getShapeById(id))).filter((shape) => {\n\t\t\tif (!shape) return false\n\n\t\t\tif (TLArrowShapeDef.is(shape)) {\n\t\t\t\tif (shape.props.start.type === 'binding' || shape.props.end.type === 'binding') {\n\t\t\t\t\treturn false\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn true\n\t\t})\n\n\t\tconst len = shapes.length\n\n\t\tif ((gap === undefined && len < 3) || len < 2) return this\n\n\t\tconst pageBounds = Object.fromEntries(\n\t\t\tshapes.map((shape) => [shape.id, this.getPageBounds(shape)!])\n\t\t)\n\n\t\tlet val: 'x' | 'y'\n\t\tlet min: 'minX' | 'minY'\n\t\tlet max: 'maxX' | 'maxY'\n\t\tlet dim: 'width' | 'height'\n\n\t\tif (operation === 'horizontal') {\n\t\t\tval = 'x'\n\t\t\tmin = 'minX'\n\t\t\tmax = 'maxX'\n\t\t\tdim = 'width'\n\t\t} else {\n\t\t\tval = 'y'\n\t\t\tmin = 'minY'\n\t\t\tmax = 'maxY'\n\t\t\tdim = 'height'\n\t\t}\n\n\t\tlet shapeGap: number\n\n\t\tif (gap === undefined) {\n\t\t\tconst gaps: { gap: number; count: number }[] = []\n\n\t\t\tshapes.sort((a, b) => pageBounds[a.id][min] - pageBounds[b.id][min])\n\n\t\t\t// Collect all of the gaps between shapes. We want to find\n\t\t\t// patterns (equal gaps between shapes) and use the most common\n\t\t\t// one as the gap for all of the shapes.\n\t\t\tfor (let i = 0; i < len - 1; i++) {\n\t\t\t\tconst shape = shapes[i]\n\t\t\t\tconst nextShape = shapes[i + 1]\n\n\t\t\t\tconst bounds = pageBounds[shape.id]\n\t\t\t\tconst nextBounds = pageBounds[nextShape.id]\n\n\t\t\t\tconst gap = nextBounds[min] - bounds[max]\n\n\t\t\t\tconst current = gaps.find((g) => g.gap === gap)\n\n\t\t\t\tif (current) {\n\t\t\t\t\tcurrent.count++\n\t\t\t\t} else {\n\t\t\t\t\tgaps.push({ gap, count: 1 })\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Which gap is the most common?\n\t\t\tlet maxCount = 0\n\t\t\tgaps.forEach((g) => {\n\t\t\t\tif (g.count > maxCount) {\n\t\t\t\t\tmaxCount = g.count\n\t\t\t\t\tshapeGap = g.gap\n\t\t\t\t}\n\t\t\t})\n\n\t\t\t// If there is no most-common gap, use the average gap.\n\t\t\tif (maxCount === 1) {\n\t\t\t\tshapeGap = Math.max(0, gaps.reduce((a, c) => a + c.gap * c.count, 0) / (len - 1))\n\t\t\t}\n\t\t} else {\n\t\t\t// If a gap was provided, then use that instead.\n\t\t\tshapeGap = gap\n\t\t}\n\n\t\tconst changes: TLShapePartial[] = []\n\n\t\tlet v = pageBounds[shapes[0].id][max]\n\n\t\tshapes.forEach((shape, i) => {\n\t\t\tif (i === 0) return\n\n\t\t\tconst delta = { x: 0, y: 0 }\n\t\t\tdelta[val] = v + shapeGap - pageBounds[shape.id][val]\n\n\t\t\tconst parent = this.getParentShape(shape)\n\t\t\tconst localDelta = parent ? Vec2d.Rot(delta, -this.getPageRotation(parent)) : delta\n\n\t\t\tconst translateStartChanges = this.getShapeUtil(shape).onTranslateStart?.(shape)\n\n\t\t\tchanges.push(\n\t\t\t\ttranslateStartChanges\n\t\t\t\t\t? {\n\t\t\t\t\t\t\t...translateStartChanges,\n\t\t\t\t\t\t\t[val]: shape[val] + localDelta[val],\n\t\t\t\t\t  }\n\t\t\t\t\t: {\n\t\t\t\t\t\t\tid: shape.id as any,\n\t\t\t\t\t\t\ttype: shape.type,\n\t\t\t\t\t\t\t[val]: shape[val] + localDelta[val],\n\t\t\t\t\t  }\n\t\t\t)\n\n\t\t\tv += pageBounds[shape.id][dim] + shapeGap\n\t\t})\n\n\t\tthis.updateShapes(changes)\n\t\treturn this\n\t}\n\n\t/**\n\t * Pack shapes into a grid centered on their current position.\n\t * Based on potpack (https://github.com/mapbox/potpack)\n\t *\n\t * @param ids - The ids of the shapes to pack. Defaults to selected shapes.\n\t * @param padding - The padding to apply to the packed shapes.\n\t */\n\tpackShapes(ids: TLShapeId[] = this.pageState.selectedIds, padding = 16) {\n\t\tif (this.isReadOnly) return this\n\t\tif (ids.length < 2) return this\n\n\t\tconst shapes = compact(\n\t\t\tids\n\t\t\t\t.map((id) => this.getShapeById(id))\n\t\t\t\t.filter((shape) => {\n\t\t\t\t\tif (!shape) return false\n\n\t\t\t\t\tif (TLArrowShapeDef.is(shape)) {\n\t\t\t\t\t\tif (shape.props.start.type === 'binding' || shape.props.end.type === 'binding') {\n\t\t\t\t\t\t\treturn false\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\treturn true\n\t\t\t\t})\n\t\t)\n\t\tconst shapePageBounds: Record<string, Box2d> = {}\n\t\tconst nextShapePageBounds: Record<string, Box2d> = {}\n\n\t\tlet shape: TLShape,\n\t\t\tbounds: Box2d,\n\t\t\tarea = 0\n\n\t\tfor (let i = 0; i < shapes.length; i++) {\n\t\t\tshape = shapes[i]\n\t\t\tbounds = this.getPageBounds(shape)!\n\t\t\tshapePageBounds[shape.id] = bounds\n\t\t\tnextShapePageBounds[shape.id] = bounds.clone()\n\t\t\tarea += bounds.width * bounds.height\n\t\t}\n\n\t\tconst commonBounds = Box2d.Common(compact(Object.values(shapePageBounds)))\n\n\t\tconst maxWidth = commonBounds.width\n\n\t\t// sort the shapes by height, descending\n\t\tshapes.sort((a, b) => shapePageBounds[b.id].height - shapePageBounds[a.id].height)\n\n\t\t// Start with is (sort of) the square of the area\n\t\tconst startWidth = Math.max(Math.ceil(Math.sqrt(area / 0.95)), maxWidth)\n\n\t\t// first shape fills the width and is infinitely tall\n\t\tconst spaces: Box2d[] = [new Box2d(commonBounds.x, commonBounds.y, startWidth, Infinity)]\n\n\t\tlet width = 0\n\t\tlet height = 0\n\t\tlet space: Box2d\n\t\tlet last: Box2d\n\n\t\tfor (let i = 0; i < shapes.length; i++) {\n\t\t\tshape = shapes[i]\n\t\t\tbounds = nextShapePageBounds[shape.id]\n\n\t\t\t// starting at the back (smaller shapes)\n\t\t\tfor (let i = spaces.length - 1; i >= 0; i--) {\n\t\t\t\tspace = spaces[i]\n\n\t\t\t\t// find a space that is big enough to contain the shape\n\t\t\t\tif (bounds.width > space.width || bounds.height > space.height) continue\n\n\t\t\t\t// add the shape to its top-left corner\n\t\t\t\tbounds.x = space.x\n\t\t\t\tbounds.y = space.y\n\n\t\t\t\theight = Math.max(height, bounds.maxY)\n\t\t\t\twidth = Math.max(width, bounds.maxX)\n\n\t\t\t\tif (bounds.width === space.width && bounds.height === space.height) {\n\t\t\t\t\t// remove the space on a perfect fit\n\t\t\t\t\tlast = spaces.pop()!\n\t\t\t\t\tif (i < spaces.length) spaces[i] = last\n\t\t\t\t} else if (bounds.height === space.height) {\n\t\t\t\t\t// fit the shape into the space (width)\n\t\t\t\t\tspace.x += bounds.width + padding\n\t\t\t\t\tspace.width -= bounds.width + padding\n\t\t\t\t} else if (bounds.width === space.width) {\n\t\t\t\t\t// fit the shape into the space (height)\n\t\t\t\t\tspace.y += bounds.height + padding\n\t\t\t\t\tspace.height -= bounds.height + padding\n\t\t\t\t} else {\n\t\t\t\t\t// split the space into two spaces\n\t\t\t\t\tspaces.push(\n\t\t\t\t\t\tnew Box2d(\n\t\t\t\t\t\t\tspace.x + (bounds.width + padding),\n\t\t\t\t\t\t\tspace.y,\n\t\t\t\t\t\t\tspace.width - (bounds.width + padding),\n\t\t\t\t\t\t\tbounds.height\n\t\t\t\t\t\t)\n\t\t\t\t\t)\n\t\t\t\t\tspace.y += bounds.height + padding\n\t\t\t\t\tspace.height -= bounds.height + padding\n\t\t\t\t}\n\t\t\t\tbreak\n\t\t\t}\n\t\t}\n\n\t\tconst commonAfter = Box2d.Common(Object.values(nextShapePageBounds))\n\t\tconst centerDelta = Vec2d.Sub(commonBounds.center, commonAfter.center)\n\n\t\tlet nextBounds: Box2d\n\n\t\tconst changes: TLShapePartial<any>[] = []\n\n\t\tfor (let i = 0; i < shapes.length; i++) {\n\t\t\tshape = shapes[i]\n\t\t\tbounds = shapePageBounds[shape.id]\n\t\t\tnextBounds = nextShapePageBounds[shape.id]\n\n\t\t\tconst delta = this.getDeltaInParentSpace(\n\t\t\t\tshape,\n\t\t\t\tVec2d.Sub(nextBounds.point, bounds.point).add(centerDelta)\n\t\t\t)\n\n\t\t\tconst change: TLShapePartial = {\n\t\t\t\tid: shape.id,\n\t\t\t\ttype: shape.type,\n\t\t\t\tx: shape.x + delta.x,\n\t\t\t\ty: shape.y + delta.y,\n\t\t\t}\n\n\t\t\tconst translateStartChange = this.getShapeUtil(shape).onTranslateStart?.({\n\t\t\t\t...shape,\n\t\t\t\t...change,\n\t\t\t} as TLShape)\n\n\t\t\tif (translateStartChange) {\n\t\t\t\tchanges.push({ ...change, ...translateStartChange })\n\t\t\t} else {\n\t\t\t\tchanges.push(change)\n\t\t\t}\n\t\t}\n\n\t\tif (changes.length) {\n\t\t\tthis.updateShapes(changes)\n\t\t}\n\n\t\treturn this\n\t}\n\n\t/**\n\t * Align shape positions.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.alignShapes('left')\n\t * \tapp.alignShapes('left', ['box1', 'box2'])\n\t * ```\n\t *\n\t * @param operation - The align operation to apply.\n\t * @param ids - The ids of the shapes to align. Defaults to selected shapes.\n\t * @public\n\t */\n\talignShapes(\n\t\toperation: 'left' | 'center-horizontal' | 'right' | 'top' | 'center-vertical' | 'bottom',\n\t\tids: TLShapeId[] = this.pageState.selectedIds\n\t) {\n\t\tif (this.isReadOnly) return this\n\t\tif (ids.length < 2) return this\n\n\t\tconst shapes = compact(ids.map((id) => this.getShapeById(id)))\n\t\tconst shapePageBounds = Object.fromEntries(\n\t\t\tshapes.map((shape) => [shape.id, this.getPageBounds(shape)])\n\t\t)\n\t\tconst commonBounds = Box2d.Common(compact(Object.values(shapePageBounds)))\n\n\t\tconst changes: TLShapePartial[] = []\n\n\t\tshapes.forEach((shape) => {\n\t\t\tconst pageBounds = shapePageBounds[shape.id]\n\t\t\tif (!pageBounds) return\n\n\t\t\tconst delta = { x: 0, y: 0 }\n\n\t\t\tswitch (operation) {\n\t\t\t\tcase 'top': {\n\t\t\t\t\tdelta.y = commonBounds.minY - pageBounds.minY\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t\tcase 'center-vertical': {\n\t\t\t\t\tdelta.y = commonBounds.midY - pageBounds.minY - pageBounds.height / 2\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t\tcase 'bottom': {\n\t\t\t\t\tdelta.y = commonBounds.maxY - pageBounds.minY - pageBounds.height\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t\tcase 'left': {\n\t\t\t\t\tdelta.x = commonBounds.minX - pageBounds.minX\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t\tcase 'center-horizontal': {\n\t\t\t\t\tdelta.x = commonBounds.midX - pageBounds.minX - pageBounds.width / 2\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t\tcase 'right': {\n\t\t\t\t\tdelta.x = commonBounds.maxX - pageBounds.minX - pageBounds.width\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst parent = this.getParentShape(shape)\n\t\t\tconst localDelta = parent ? Vec2d.Rot(delta, -this.getPageRotation(parent)) : delta\n\n\t\t\tconst translateChanges = this.getShapeUtil(shape).onTranslateStart?.(shape)\n\n\t\t\tchanges.push(\n\t\t\t\ttranslateChanges\n\t\t\t\t\t? {\n\t\t\t\t\t\t\t...translateChanges,\n\t\t\t\t\t\t\tx: shape.x + localDelta.x,\n\t\t\t\t\t\t\ty: shape.y + localDelta.y,\n\t\t\t\t\t  }\n\t\t\t\t\t: {\n\t\t\t\t\t\t\tid: shape.id,\n\t\t\t\t\t\t\ttype: shape.type,\n\t\t\t\t\t\t\tx: shape.x + localDelta.x,\n\t\t\t\t\t\t\ty: shape.y + localDelta.y,\n\t\t\t\t\t  }\n\t\t\t)\n\t\t})\n\n\t\tthis.updateShapes(changes)\n\t\treturn this\n\t}\n\n\t/**\n\t * Distribute shape positions.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.distributeShapes('left')\n\t * \tapp.distributeShapes('left', ['box1', 'box2'])\n\t * ```\n\t *\n\t * @param operation - Whether to distribute shapes horizontally or vertically.\n\t * @param ids - The ids of the shapes to distribute. Defaults to selected shapes.\n\t * @public\n\t */\n\tdistributeShapes(\n\t\toperation: 'horizontal' | 'vertical',\n\t\tids: TLShapeId[] = this.pageState.selectedIds\n\t) {\n\t\tif (this.isReadOnly) return this\n\t\tif (ids.length < 3) return this\n\n\t\tconst len = ids.length\n\t\tconst shapes = compact(ids.map((id) => this.getShapeById(id)))\n\t\tconst pageBounds = Object.fromEntries(\n\t\t\tshapes.map((shape) => [shape.id, this.getPageBounds(shape)!])\n\t\t)\n\n\t\tlet val: 'x' | 'y'\n\t\tlet min: 'minX' | 'minY'\n\t\tlet max: 'maxX' | 'maxY'\n\t\tlet mid: 'midX' | 'midY'\n\t\tlet dim: 'width' | 'height'\n\n\t\tif (operation === 'horizontal') {\n\t\t\tval = 'x'\n\t\t\tmin = 'minX'\n\t\t\tmax = 'maxX'\n\t\t\tmid = 'midX'\n\t\t\tdim = 'width'\n\t\t} else {\n\t\t\tval = 'y'\n\t\t\tmin = 'minY'\n\t\t\tmax = 'maxY'\n\t\t\tmid = 'midY'\n\t\t\tdim = 'height'\n\t\t}\n\t\tconst changes: TLShapePartial[] = []\n\n\t\t// Clustered\n\t\tconst first = shapes.sort((a, b) => pageBounds[a.id][min] - pageBounds[b.id][min])[0]\n\t\tconst last = shapes.sort((a, b) => pageBounds[b.id][max] - pageBounds[a.id][max])[0]\n\n\t\tconst midFirst = pageBounds[first.id][mid]\n\t\tconst step = (pageBounds[last.id][mid] - midFirst) / (len - 1)\n\t\tconst v = midFirst + step\n\n\t\tshapes\n\t\t\t.filter((shape) => shape !== first && shape !== last)\n\t\t\t.sort((a, b) => pageBounds[a.id][mid] - pageBounds[b.id][mid])\n\t\t\t.forEach((shape, i) => {\n\t\t\t\tconst delta = { x: 0, y: 0 }\n\t\t\t\tdelta[val] = v + step * i - pageBounds[shape.id][dim] / 2 - pageBounds[shape.id][val]\n\n\t\t\t\tconst parent = this.getParentShape(shape)\n\t\t\t\tconst localDelta = parent ? Vec2d.Rot(delta, -this.getPageRotation(parent)) : delta\n\t\t\t\tconst translateStartChanges = this.getShapeUtil(shape).onTranslateStart?.(shape)\n\n\t\t\t\tchanges.push(\n\t\t\t\t\ttranslateStartChanges\n\t\t\t\t\t\t? {\n\t\t\t\t\t\t\t\t...translateStartChanges,\n\t\t\t\t\t\t\t\t[val]: shape[val] + localDelta[val],\n\t\t\t\t\t\t  }\n\t\t\t\t\t\t: {\n\t\t\t\t\t\t\t\tid: shape.id,\n\t\t\t\t\t\t\t\ttype: shape.type,\n\t\t\t\t\t\t\t\t[val]: shape[val] + localDelta[val],\n\t\t\t\t\t\t  }\n\t\t\t\t)\n\t\t\t})\n\n\t\tthis.updateShapes(changes)\n\t\treturn this\n\t}\n\n\t/** @internal */\n\tprivate _resizeUnalignedShape(\n\t\tid: TLShapeId,\n\t\tscale: VecLike,\n\t\toptions: {\n\t\t\tinitialBounds: Box2d\n\t\t\tscaleOrigin: VecLike\n\t\t\tscaleAxisRotation: number\n\t\t\tinitialShape: TLShape\n\t\t\tinitialPageTransform: MatLike\n\t\t}\n\t) {\n\t\tconst { type } = options.initialShape\n\t\t// If a shape is not aligned with the scale axis we need to treat it differently to avoid skewing.\n\t\t// Instead of skewing we normalise the scale aspect ratio (i.e. keep the same scale magnitude in both axes)\n\t\t// and then after applying the scale to the shape we also rotate it if required and translate it so that it's center\n\t\t// point ends up in the right place.\n\n\t\tconst shapeScale = new Vec2d(scale.x, scale.y)\n\n\t\t// // make sure we are contraining aspect ratio, and using the smallest scale axis to avoid shapes getting bigger\n\t\t// // than the selection bounding box\n\t\tif (Math.abs(scale.x) > Math.abs(scale.y)) {\n\t\t\tshapeScale.x = Math.sign(scale.x) * Math.abs(scale.y)\n\t\t} else {\n\t\t\tshapeScale.y = Math.sign(scale.y) * Math.abs(scale.x)\n\t\t}\n\n\t\t// first we can scale the shape about its center point\n\t\tthis.resizeShape(id, shapeScale, {\n\t\t\tinitialShape: options.initialShape,\n\t\t\tinitialBounds: options.initialBounds,\n\t\t})\n\n\t\t// then if the shape is flipped in one axis only, we need to apply an extra rotation\n\t\t// to make sure the shape is mirrored correctly\n\t\tif (Math.sign(scale.x) * Math.sign(scale.y) < 0) {\n\t\t\tlet { rotation } = Matrix2d.Decompose(options.initialPageTransform)\n\t\t\trotation -= 2 * rotation\n\t\t\tthis.updateShapes([{ id, type, rotation }], true)\n\t\t}\n\n\t\t// Next we need to translate the shape so that it's center point ends up in the right place.\n\t\t// To do that we first need to calculate the center point of the shape in page space before the scale was applied.\n\t\tconst preScaleShapePageCenter = Matrix2d.applyToPoint(\n\t\t\toptions.initialPageTransform,\n\t\t\toptions.initialBounds.center\n\t\t)\n\n\t\t// And now we scale the center point by the original scale factor\n\t\tconst postScaleShapePageCenter = this._scalePagePoint(\n\t\t\tpreScaleShapePageCenter,\n\t\t\toptions.scaleOrigin,\n\t\t\tscale,\n\t\t\toptions.scaleAxisRotation\n\t\t)\n\n\t\t// now caculate how far away the shape is from where it needs to be\n\t\tconst currentPageCenter = this.getPageCenterById(id)\n\t\tconst currentPagePoint = this.getPagePointById(id)\n\t\tif (!currentPageCenter || !currentPagePoint) return this\n\t\tconst pageDelta = Vec2d.Sub(postScaleShapePageCenter, currentPageCenter)\n\n\t\t// and finally figure out what the shape's new position should be\n\t\tconst postScaleShapePagePoint = Vec2d.Add(currentPagePoint, pageDelta)\n\t\tconst { x, y } = this.getPointInParentSpace(id, postScaleShapePagePoint)\n\n\t\tthis.updateShapes([{ id, type, x, y }], true)\n\n\t\treturn this\n\t}\n\n\t/** @internal */\n\tprivate _scalePagePoint(\n\t\tpoint: VecLike,\n\t\tscaleOrigin: VecLike,\n\t\tscale: VecLike,\n\t\tscaleAxisRotation: number\n\t) {\n\t\tconst relativePoint = Vec2d.RotWith(point, scaleOrigin, -scaleAxisRotation).sub(scaleOrigin)\n\n\t\t// calculate the new point position relative to the scale origin\n\t\tconst newRelativePagePoint = Vec2d.MulV(relativePoint, scale)\n\n\t\t// and rotate it back to page coords to get the new page point of the resized shape\n\t\tconst destination = Vec2d.Add(newRelativePagePoint, scaleOrigin).rotWith(\n\t\t\tscaleOrigin,\n\t\t\tscaleAxisRotation\n\t\t)\n\n\t\treturn destination\n\t}\n\n\tresizeShape(\n\t\tid: TLShapeId,\n\t\tscale: VecLike,\n\t\toptions?: {\n\t\t\tinitialBounds?: Box2d\n\t\t\tscaleOrigin?: VecLike\n\t\t\tscaleAxisRotation?: number\n\t\t\tinitialShape?: TLShape\n\t\t\tinitialPageTransform?: MatLike\n\t\t\tdragHandle?: TLResizeHandle\n\t\t\tmode?: TLResizeMode\n\t\t}\n\t) {\n\t\tif (this.isReadOnly) return this\n\n\t\tif (!Number.isFinite(scale.x)) scale = new Vec2d(1, scale.y)\n\t\tif (!Number.isFinite(scale.y)) scale = new Vec2d(scale.x, 1)\n\n\t\tconst initialShape = options?.initialShape ?? this.getShapeById(id)\n\t\tif (!initialShape) return this\n\n\t\tconst scaleOrigin = options?.scaleOrigin ?? this.getPageBoundsById(id)?.center\n\t\tif (!scaleOrigin) return this\n\n\t\tconst pageRotation = this.getPageRotationById(id)\n\n\t\tif (pageRotation == null) return this\n\n\t\tconst scaleAxisRotation = options?.scaleAxisRotation ?? pageRotation\n\n\t\tconst pageTransform = options?.initialPageTransform ?? this.getPageTransformById(id)\n\t\tif (!pageTransform) return this\n\n\t\tconst initialBounds = options?.initialBounds ?? this.getBoundsById(id)\n\n\t\tif (!initialBounds) return this\n\n\t\tif (!areAnglesCompatible(pageRotation, scaleAxisRotation)) {\n\t\t\t// shape is awkwardly rotated, keep the aspect ratio locked and adopt the scale factor\n\t\t\t// from whichever axis is being scaled the least, to avoid the shape getting bigger\n\t\t\t// than the bounds of the selection\n\t\t\t// const minScale = Math.min(Math.abs(scale.x), Math.abs(scale.y))\n\t\t\treturn this._resizeUnalignedShape(id, scale, {\n\t\t\t\t...options,\n\t\t\t\tinitialBounds,\n\t\t\t\tscaleOrigin,\n\t\t\t\tscaleAxisRotation,\n\t\t\t\tinitialPageTransform: pageTransform,\n\t\t\t\tinitialShape,\n\t\t\t})\n\t\t}\n\n\t\tconst util = this.getShapeUtil(initialShape)\n\n\t\tif (util.isAspectRatioLocked(initialShape)) {\n\t\t\tif (Math.abs(scale.x) > Math.abs(scale.y)) {\n\t\t\t\tscale = new Vec2d(scale.x, Math.sign(scale.y) * Math.abs(scale.x))\n\t\t\t} else {\n\t\t\t\tscale = new Vec2d(Math.sign(scale.x) * Math.abs(scale.y), scale.y)\n\t\t\t}\n\t\t}\n\n\t\tif (util.onResize && util.canResize(initialShape)) {\n\t\t\t// get the model changes from the shape util\n\t\t\tconst newPagePoint = this._scalePagePoint(\n\t\t\t\tMatrix2d.applyToPoint(pageTransform, new Vec2d(0, 0)),\n\t\t\t\tscaleOrigin,\n\t\t\t\tscale,\n\t\t\t\tscaleAxisRotation\n\t\t\t)\n\n\t\t\tconst newLocalPoint = this.getPointInParentSpace(initialShape.id, newPagePoint)\n\n\t\t\t// resize the shape's local bounding box\n\t\t\tconst myScale = new Vec2d(scale.x, scale.y)\n\t\t\t// the shape is algined with the rest of the shpaes in the selection, but may be\n\t\t\t// 90deg offset from the main rotation of the selection, in which case\n\t\t\t// we need to flip the width and height scale factors\n\t\t\tconst areWidthAndHeightAlignedWithCorrectAxis = approximately(\n\t\t\t\t(pageRotation - scaleAxisRotation) % Math.PI,\n\t\t\t\t0\n\t\t\t)\n\t\t\tmyScale.x = areWidthAndHeightAlignedWithCorrectAxis ? scale.x : scale.y\n\t\t\tmyScale.y = areWidthAndHeightAlignedWithCorrectAxis ? scale.y : scale.x\n\n\t\t\t// adjust initial model for situations where the parent has moved during the resize\n\t\t\t// e.g. groups\n\t\t\tconst initialPagePoint = Matrix2d.applyToPoint(pageTransform, new Vec2d())\n\n\t\t\t// need to adjust the shape's x and y points in case the parent has moved since start of resizing\n\t\t\tconst { x, y } = this.getPointInParentSpace(initialShape.id, initialPagePoint)\n\n\t\t\tthis.updateShapes(\n\t\t\t\t[\n\t\t\t\t\t{\n\t\t\t\t\t\tid,\n\t\t\t\t\t\ttype: initialShape.type as any,\n\t\t\t\t\t\tx: newLocalPoint.x,\n\t\t\t\t\t\ty: newLocalPoint.y,\n\t\t\t\t\t\t...util.onResize(\n\t\t\t\t\t\t\t{ ...initialShape, x, y },\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tnewPoint: newLocalPoint,\n\t\t\t\t\t\t\t\thandle: options?.dragHandle ?? 'bottom_right',\n\t\t\t\t\t\t\t\t// don't set isSingle to true for children\n\t\t\t\t\t\t\t\tmode: options?.mode ?? 'scale_shape',\n\t\t\t\t\t\t\t\tscaleX: myScale.x,\n\t\t\t\t\t\t\t\tscaleY: myScale.y,\n\t\t\t\t\t\t\t\tinitialBounds,\n\t\t\t\t\t\t\t\tinitialShape,\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t),\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\ttrue\n\t\t\t)\n\t\t} else {\n\t\t\tconst initialPageCenter = Matrix2d.applyToPoint(pageTransform, initialBounds.center)\n\t\t\t// get the model changes from the shape util\n\t\t\tconst newPageCenter = this._scalePagePoint(\n\t\t\t\tinitialPageCenter,\n\t\t\t\tscaleOrigin,\n\t\t\t\tscale,\n\t\t\t\tscaleAxisRotation\n\t\t\t)\n\n\t\t\tconst initialPageCenterInParentSpace = this.getPointInParentSpace(\n\t\t\t\tinitialShape.id,\n\t\t\t\tinitialPageCenter\n\t\t\t)\n\t\t\tconst newPageCenterInParentSpace = this.getPointInParentSpace(initialShape.id, newPageCenter)\n\n\t\t\tconst delta = Vec2d.Sub(newPageCenterInParentSpace, initialPageCenterInParentSpace)\n\t\t\t// apply the changes to the model\n\t\t\tthis.updateShapes(\n\t\t\t\t[\n\t\t\t\t\t{\n\t\t\t\t\t\tid,\n\t\t\t\t\t\ttype: initialShape.type as any,\n\t\t\t\t\t\tx: initialShape.x + delta.x,\n\t\t\t\t\t\ty: initialShape.y + delta.y,\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\ttrue\n\t\t\t)\n\t\t}\n\n\t\treturn this\n\t}\n\n\t/**\n\t * Stretch shape sizes and positions to fill their common bounding box.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.stretchShapes('horizontal')\n\t * \tapp.stretchShapes('horizontal', ['box1', 'box2'])\n\t * ```\n\t *\n\t * @param operation - Whether to stretch shapes horizontally or vertically.\n\t * @param ids - The ids of the shapes to stretch. Defaults to selected shapes.\n\t * @public\n\t */\n\tstretchShapes(\n\t\toperation: 'horizontal' | 'vertical',\n\t\tids: TLShapeId[] = this.pageState.selectedIds\n\t) {\n\t\tif (this.isReadOnly) return this\n\t\tif (ids.length < 2) return this\n\n\t\tconst shapes = compact(ids.map((id) => this.getShapeById(id)))\n\t\tconst shapeBounds = Object.fromEntries(shapes.map((shape) => [shape.id, this.getBounds(shape)]))\n\t\tconst shapePageBounds = Object.fromEntries(\n\t\t\tshapes.map((shape) => [shape.id, this.getPageBounds(shape)!])\n\t\t)\n\t\tconst commonBounds = Box2d.Common(compact(Object.values(shapePageBounds)))\n\n\t\tconst changes: TLShapePartial[] = []\n\n\t\tswitch (operation) {\n\t\t\tcase 'vertical': {\n\t\t\t\tthis.batch(() => {\n\t\t\t\t\tfor (const shape of shapes) {\n\t\t\t\t\t\tconst pageRotation = this.getPageRotation(shape)\n\t\t\t\t\t\tif (pageRotation % PI2) continue\n\t\t\t\t\t\tconst bounds = shapeBounds[shape.id]\n\t\t\t\t\t\tconst pageBounds = shapePageBounds[shape.id]\n\t\t\t\t\t\tconst localOffset = this.getDeltaInParentSpace(\n\t\t\t\t\t\t\tshape,\n\t\t\t\t\t\t\tnew Vec2d(0, commonBounds.minY - pageBounds.minY)\n\t\t\t\t\t\t)\n\t\t\t\t\t\tconst { x, y } = Vec2d.Add(localOffset, shape)\n\t\t\t\t\t\tthis.updateShapes([{ id: shape.id, type: shape.type, x, y }], true)\n\t\t\t\t\t\tconst scale = new Vec2d(1, commonBounds.height / pageBounds.height)\n\t\t\t\t\t\tthis.resizeShape(shape.id, scale, {\n\t\t\t\t\t\t\tinitialBounds: bounds,\n\t\t\t\t\t\t\tscaleOrigin: new Vec2d(pageBounds.center.x, commonBounds.minY),\n\t\t\t\t\t\t\tscaleAxisRotation: 0,\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tcase 'horizontal': {\n\t\t\t\tthis.batch(() => {\n\t\t\t\t\tfor (const shape of shapes) {\n\t\t\t\t\t\tconst bounds = shapeBounds[shape.id]\n\t\t\t\t\t\tconst pageBounds = shapePageBounds[shape.id]\n\t\t\t\t\t\tconst pageRotation = this.getPageRotation(shape)\n\t\t\t\t\t\tif (pageRotation % PI2) continue\n\t\t\t\t\t\tconst localOffset = this.getDeltaInParentSpace(\n\t\t\t\t\t\t\tshape,\n\t\t\t\t\t\t\tnew Vec2d(commonBounds.minX - pageBounds.minX, 0)\n\t\t\t\t\t\t)\n\t\t\t\t\t\tconst { x, y } = Vec2d.Add(localOffset, shape)\n\t\t\t\t\t\tthis.updateShapes([{ id: shape.id, type: shape.type, x, y }], true)\n\t\t\t\t\t\tconst scale = new Vec2d(commonBounds.width / pageBounds.width, 1)\n\t\t\t\t\t\tthis.resizeShape(shape.id, scale, {\n\t\t\t\t\t\t\tinitialBounds: bounds,\n\t\t\t\t\t\t\tscaleOrigin: new Vec2d(commonBounds.minX, pageBounds.center.y),\n\t\t\t\t\t\t\tscaleAxisRotation: 0,\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t})\n\n\t\t\t\tbreak\n\t\t\t}\n\t\t}\n\n\t\tthis.updateShapes(changes)\n\t\treturn this\n\t}\n\n\t/**\n\t * Reparent shapes to a new parent. This operation preserves the shape's current page positions /\n\t * rotations.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.reparentShapesById(['box1', 'box2'], 'frame1')\n\t * ```\n\t *\n\t * @param ids - The ids of the shapes to reparent.\n\t * @param parentId - The id of the new parent shape.\n\t * @param insertIndex - The index to insert the children.\n\t * @public\n\t */\n\treparentShapesById(ids: TLShapeId[], parentId: TLParentId, insertIndex?: string) {\n\t\tconst changes: TLShapePartial[] = []\n\n\t\tconst parentTransform = TLPage.isId(parentId)\n\t\t\t? Matrix2d.Identity()\n\t\t\t: this.getPageTransformById(parentId)!\n\n\t\tconst parentPageRotation = parentTransform.decompose().rotation\n\n\t\tlet indices: string[] = []\n\n\t\tconst sibs = compact(this.getSortedChildIds(parentId).map((id) => this.getShapeById(id)))\n\n\t\tif (insertIndex) {\n\t\t\tconst sibWithInsertIndex = sibs.find((s) => s.index === insertIndex)\n\t\t\tif (sibWithInsertIndex) {\n\t\t\t\t// If there's a sibling with the same index as the insert index...\n\t\t\t\tconst sibAbove = sibs[sibs.indexOf(sibWithInsertIndex) + 1]\n\t\t\t\tif (sibAbove) {\n\t\t\t\t\t// If the sibling has a sibling above it, insert the shapes\n\t\t\t\t\t// between the sibling and its sibling above it.\n\t\t\t\t\tindices = getIndicesBetween(insertIndex, sibAbove.index, ids.length)\n\t\t\t\t} else {\n\t\t\t\t\t// Or if the sibling is the top sibling, insert the shapes\n\t\t\t\t\t// above the sibling\n\t\t\t\t\tindices = getIndicesAbove(insertIndex, ids.length)\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// If there's no collision, then we can start at the insert index\n\t\t\t\tconst sibAbove = sibs.sort(sortByIndex).find((s) => s.index > insertIndex)\n\n\t\t\t\tif (sibAbove) {\n\t\t\t\t\t// If the siblings include a sibling with a higher index, insert the shapes\n\t\t\t\t\t// between the insert index and the sibling with the higher index.\n\t\t\t\t\tindices = getIndicesBetween(insertIndex, sibAbove.index, ids.length)\n\t\t\t\t} else {\n\t\t\t\t\t// Otherwise, we're at the top of the order, so insert the shapes above\n\t\t\t\t\t// the insert index.\n\t\t\t\t\tindices = getIndicesAbove(insertIndex, ids.length)\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\t// If insert index is not specified, start the index at the top.\n\t\t\tconst sib = sibs.length && sibs[sibs.length - 1]\n\t\t\tindices = sib ? getIndicesAbove(sib.index, ids.length) : getIndices(ids.length)\n\t\t}\n\n\t\tlet id: TLShapeId\n\t\tfor (let i = 0; i < ids.length; i++) {\n\t\t\tid = ids[i]\n\t\t\tconst shape = this.getShapeById(id)\n\t\t\tconst pagePoint = this.getPagePointById(id)\n\n\t\t\tif (!shape || !pagePoint) continue\n\n\t\t\tconst newPoint = Matrix2d.applyToPoint(Matrix2d.Inverse(parentTransform), pagePoint)\n\t\t\tconst newRotation = this.getPageRotation(shape) - parentPageRotation\n\n\t\t\tchanges.push({\n\t\t\t\tid: shape.id,\n\t\t\t\ttype: shape.type,\n\t\t\t\tparentId: parentId,\n\t\t\t\tx: newPoint.x,\n\t\t\t\ty: newPoint.y,\n\t\t\t\trotation: newRotation,\n\t\t\t\tindex: indices[i],\n\t\t\t})\n\t\t}\n\n\t\tthis.updateShapes(changes)\n\t\treturn this\n\t}\n\n\t/**\n\t * Select one or more shapes.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.select('id1')\n\t * \tapp.select('id1', 'id2')\n\t * ```\n\t *\n\t * @param ids - The ids to select.\n\t * @public\n\t */\n\tselect(...ids: TLShapeId[]) {\n\t\tthis.setSelectedIds(ids)\n\t\treturn this\n\t}\n\n\t/**\n\t * Remove a shpae from the existing set of selected shapes.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.deselect(shape.id)\n\t * ```\n\t *\n\t * @public\n\t */\n\tdeselect(...ids: TLShapeId[]) {\n\t\tconst { selectedIds } = this\n\t\tif (selectedIds.length > 0 && ids.length > 0) {\n\t\t\tthis.setSelectedIds(selectedIds.filter((id) => !ids.includes(id)))\n\t\t}\n\t\treturn this\n\t}\n\n\t/**\n\t * Select all direct children of the current page.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.selectAll()\n\t * ```\n\t *\n\t * @public\n\t */\n\tselectAll() {\n\t\tconst ids = this.getSortedChildIds(this.currentPageId)\n\t\t// page might have no shapes\n\t\tif (ids.length <= 0) return this\n\t\tthis.setSelectedIds(ids)\n\t\treturn this\n\t}\n\n\tgetShapesAndDescendantsInOrder(ids: TLShapeId[]) {\n\t\tconst idsToInclude: TLShapeId[] = []\n\t\tconst visitedIds = new Set<string>()\n\n\t\tconst idsToCheck = [...ids]\n\n\t\twhile (idsToCheck.length > 0) {\n\t\t\tconst id = idsToCheck.pop()\n\t\t\tif (!id) break\n\t\t\tif (visitedIds.has(id)) continue\n\t\t\tidsToInclude.push(id)\n\t\t\tthis.getSortedChildIds(id).forEach((id) => {\n\t\t\t\tidsToCheck.push(id)\n\t\t\t})\n\t\t}\n\n\t\t// Map the ids into nodes AND their descendants\n\t\tconst shapes = idsToInclude.map((s) => this.getShapeById(s)!).filter((s) => s.type !== 'group')\n\n\t\t// Sort by the shape's appearance in the sorted shapes array\n\t\tconst { sortedShapesArray } = this\n\t\tshapes.sort((a, b) => sortedShapesArray.indexOf(a) - sortedShapesArray.indexOf(b))\n\n\t\treturn shapes\n\t}\n\n\t/**\n\t * Clear the selection.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.selectNone()\n\t * ```\n\t *\n\t * @public\n\t */\n\tselectNone() {\n\t\tif (this.selectedIds.length > 0) {\n\t\t\tthis.setSelectedIds([])\n\t\t}\n\t\treturn this\n\t}\n\n\t/**\n\t * Set the current page.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.setCurrentPageId('page1')\n\t * ```\n\t *\n\t * @param pageId - The id of the page to set as the current page.\n\t * @public\n\t */\n\tsetCurrentPageId(pageId: TLPageId) {\n\t\tthis._setCurrentPageId(pageId)\n\t\treturn this\n\t}\n\n\t/** @internal */\n\tprivate _setCurrentPageId = this.history.createCommand(\n\t\t'setCurrentPage',\n\t\t(pageId: TLPageId) => {\n\t\t\tif (!this.store.has(pageId)) {\n\t\t\t\tconsole.error(\"Tried to set the current page id to a page that doesn't exist.\")\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tdata: { pageId, prev: this.currentPageId },\n\t\t\t\tsquashing: true,\n\t\t\t\tpreservesRedoStack: true,\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\tdo: ({ pageId }) => {\n\t\t\t\tif (!this.getPageStateByPageId(pageId)) {\n\t\t\t\t\tconst camera = TLCamera.create({})\n\t\t\t\t\tthis.store.put([\n\t\t\t\t\t\tcamera,\n\t\t\t\t\t\tTLInstancePageState.create({\n\t\t\t\t\t\t\tpageId,\n\t\t\t\t\t\t\tinstanceId: this.instanceId,\n\t\t\t\t\t\t\tcameraId: camera.id,\n\t\t\t\t\t\t}),\n\t\t\t\t\t])\n\t\t\t\t}\n\n\t\t\t\tthis.store.put([{ ...this.instanceState, currentPageId: pageId }])\n\n\t\t\t\tthis.updateCullingBounds()\n\t\t\t},\n\t\t\tundo: ({ prev }) => {\n\t\t\t\tthis.store.put([{ ...this.instanceState, currentPageId: prev }])\n\n\t\t\t\tthis.updateCullingBounds()\n\t\t\t},\n\t\t\tsquash: ({ prev }, { pageId }) => {\n\t\t\t\treturn { pageId, prev }\n\t\t\t},\n\t\t}\n\t)\n\n\t/** Set the current user tab state */\n\tupdateInstanceState(\n\t\tpartial: Partial<Omit<TLInstance, 'documentId' | 'userId' | 'currentPageId'>>,\n\t\tephemeral = false,\n\t\tsquashing = false\n\t) {\n\t\tthis._updateInstanceState(partial, ephemeral, squashing)\n\t\treturn this\n\t}\n\n\t/** @internal */\n\tprivate _updateInstanceState = this.history.createCommand(\n\t\t'updateTabState',\n\t\t(\n\t\t\tpartial: Partial<Omit<TLInstance, 'documentId' | 'userId' | 'currentPageId'>>,\n\t\t\tephemeral = false,\n\t\t\tsquashing = false\n\t\t) => {\n\t\t\tconst prev = this.instanceState\n\t\t\tconst next = { ...prev, ...partial }\n\n\t\t\treturn {\n\t\t\t\tdata: { prev, next },\n\t\t\t\tsquashing,\n\t\t\t\tephemeral,\n\t\t\t}\n\t\t},\n\t\t{\n\t\t\tdo: ({ next }) => {\n\t\t\t\tthis.store.put([next])\n\t\t\t},\n\t\t\tundo: ({ prev }) => {\n\t\t\t\tthis.store.put([prev])\n\t\t\t},\n\t\t\tsquash({ prev }, { next }) {\n\t\t\t\treturn { prev, next }\n\t\t\t},\n\t\t}\n\t)\n\n\t@computed get hoveredId() {\n\t\treturn this.pageState.hoveredId\n\t}\n\n\t@computed get hoveredShape() {\n\t\tif (!this.hoveredId) return null\n\t\treturn this.getShapeById(this.hoveredId) ?? null\n\t}\n\n\t/**\n\t * Set the current hovered shape.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.setHoveredId('box1')\n\t * \tapp.setHoveredId() // Clears the hovered shape.\n\t * ```\n\t *\n\t * @param id - The id of the page to set as the current page\n\t * @public\n\t */\n\tsetHoveredId(id: TLShapeId | null = null) {\n\t\tif (id === this.pageState.hoveredId) return this\n\n\t\tthis.setInstancePageState({ hoveredId: id }, true)\n\t\treturn this\n\t}\n\n\t/**\n\t * Set the current erasing shapes.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.setErasingIds(['box1', 'box2'])\n\t * \tapp.setErasingIds() // Clears the erasing set\n\t * ```\n\t *\n\t * @param ids - The ids of shapes to set as erasing.\n\t * @public\n\t */\n\tsetErasingIds(ids: TLShapeId[] = []) {\n\t\tconst erasingIds = this.erasingIdsSet\n\t\tif (ids.length === erasingIds.size && ids.every((id) => erasingIds.has(id))) return this\n\n\t\tthis.setInstancePageState({ erasingIds: ids }, true)\n\t\treturn this\n\t}\n\n\t/**\n\t * Set the current cursor.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.setCursor({ type: 'default' })\n\t * \tapp.setCursor({ type: 'default', rotation: Math.PI / 2, color: 'red' })\n\t * ```\n\t *\n\t * @param cursor - A partial of the cursor object.\n\t * @public\n\t */\n\tsetCursor(cursor: Partial<TLCursor>) {\n\t\tconst current = this.cursor\n\t\tconst next = {\n\t\t\t...current,\n\t\t\trotation: 0,\n\t\t\t...cursor,\n\t\t}\n\n\t\tif (\n\t\t\t!(\n\t\t\t\tcurrent.type === next.type &&\n\t\t\t\tcurrent.rotation === next.rotation &&\n\t\t\t\tcurrent.color === next.color\n\t\t\t)\n\t\t) {\n\t\t\tthis.updateInstanceState({ cursor: next }, true)\n\t\t}\n\n\t\treturn this\n\t}\n\n\t/**\n\t * Set the current scribble.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.setScribble(nextScribble)\n\t * \tapp.setScribble() // clears the scribble\n\t * ```\n\t *\n\t * @param scribble - The new scribble object.\n\t * @public\n\t */\n\tsetScribble(scribble: TLScribble | null = null) {\n\t\tthis.updateInstanceState({ scribble }, true)\n\t\treturn this\n\t}\n\n\t/**\n\t * Set the current brush.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.setBrush({ x: 0, y: 0, w: 100, h: 100 })\n\t * \tapp.setBrush() // Clears the brush\n\t * ```\n\t *\n\t * @param brush - The brush box model to set, or null for no brush model.\n\t * @public\n\t */\n\tsetBrush(brush: Box2dModel | null = null) {\n\t\t!brush && !this.brush\n\t\tthis.batch(() => {\n\t\t\tthis.updateInstanceState({ brush }, true)\n\t\t})\n\t\treturn this\n\t}\n\n\t/**\n\t * Rotate shapes by a delta in radians.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.rotateShapesBy(['box1', 'box2'], Math.PI)\n\t * \tapp.rotateShapesBy(['box1', 'box2'], 'Math.PI / 2)\n\t * ```\n\t *\n\t * @param ids - The ids of the shapes to move.\n\t * @param delta - The delta in radians to apply to the selection rotation.\n\t */\n\trotateShapesBy(ids: TLShapeId[], delta: number): this {\n\t\tif (ids.length <= 0) return this\n\n\t\tconst snapshot = getRotationSnapshot({ app: this })\n\t\tapplyRotationToSnapshotShapes({ delta, snapshot, app: this, stage: 'one-off' })\n\t\treturn this\n\t}\n\n\t/**\n\t * Move shapes by a delta.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.nudgeShapes(['box1', 'box2'], 'left')\n\t * \tapp.nudgeShapes(['box1', 'box2'], 'left', true)\n\t * ```\n\t *\n\t * @param ids - The ids of the shapes to move.\n\t * @param direction - The direction in which to move the shapes.\n\t * @param major - Whether this is a major nudge, e.g. a shift + arrow nudge.\n\t */\n\tnudgeShapes(ids: TLShapeId[], direction: TLDeltaDirection, major = false) {\n\t\tif (ids.length <= 0) return this\n\n\t\tconst step = this.isGridMode\n\t\t\t? major\n\t\t\t\t? this.gridSize * GRID_INCREMENT\n\t\t\t\t: this.gridSize\n\t\t\t: major\n\t\t\t? MAJOR_NUDGE_FACTOR\n\t\t\t: MINOR_NUDGE_FACTOR\n\n\t\tconst steppedDelta = Vec2d.Mul(DIRECTION_DELTAS[direction], step)\n\t\tconst changes: TLShapePartial[] = []\n\n\t\tfor (const id of ids) {\n\t\t\tconst shape = this.getShapeById(id)\n\n\t\t\tif (!shape) {\n\t\t\t\tthrow Error(`Could not find a shape with the id ${id}.`)\n\t\t\t}\n\n\t\t\tconst localDelta = this.getDeltaInParentSpace(shape, steppedDelta)\n\t\t\tconst translateStartChanges = this.getShapeUtil(shape).onTranslateStart?.(shape)\n\n\t\t\tchanges.push(\n\t\t\t\ttranslateStartChanges\n\t\t\t\t\t? {\n\t\t\t\t\t\t\t...translateStartChanges,\n\t\t\t\t\t\t\tx: shape.x + localDelta.x,\n\t\t\t\t\t\t\ty: shape.y + localDelta.y,\n\t\t\t\t\t  }\n\t\t\t\t\t: {\n\t\t\t\t\t\t\tid,\n\t\t\t\t\t\t\tx: shape.x + localDelta.x,\n\t\t\t\t\t\t\ty: shape.y + localDelta.y,\n\t\t\t\t\t\t\ttype: shape.type,\n\t\t\t\t\t  }\n\t\t\t)\n\t\t}\n\n\t\tthis.updateShapes(changes)\n\n\t\treturn this\n\t}\n\n\t/**\n\t * Duplicate shapes.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.duplicateShapes()\n\t * \tapp.duplicateShapes(['id1', 'id2'])\n\t * \tapp.duplicateShapes(['id1', 'id2'], { x: 8, y: 8 })\n\t * ```\n\t *\n\t * @param ids - The ids of the shapes to duplicate. Defaults to the ids of the selected\n\t *   shapes.\n\t * @param offset - The offset (in pixels) to apply to the duplicated shapes.\n\t * @public\n\t */\n\tduplicateShapes(ids: TLShapeId[] = this.selectedIds, offset?: VecLike) {\n\t\tif (ids.length <= 0) return this\n\n\t\tconst initialIds = new Set(ids)\n\t\tconst idsToCreate: TLShapeId[] = []\n\t\tconst idsToCheck = [...ids]\n\n\t\twhile (idsToCheck.length > 0) {\n\t\t\tconst id = idsToCheck.pop()\n\t\t\tif (!id) break\n\t\t\tidsToCreate.push(id)\n\t\t\tthis.getSortedChildIds(id).forEach((childId) => idsToCheck.push(childId))\n\t\t}\n\n\t\tidsToCreate.reverse()\n\n\t\tconst idsMap = new Map<any, TLShapeId>(idsToCreate.map((id) => [id, this.createShapeId()]))\n\n\t\tconst shapesToCreate = compact(\n\t\t\tidsToCreate.map((id) => {\n\t\t\t\tconst shape = this.getShapeById(id)\n\n\t\t\t\tif (!shape) {\n\t\t\t\t\treturn null\n\t\t\t\t}\n\n\t\t\t\tconst createId = idsMap.get(id)!\n\n\t\t\t\tlet ox = 0\n\t\t\t\tlet oy = 0\n\n\t\t\t\tif (offset && initialIds.has(id)) {\n\t\t\t\t\tconst parentTransform = this.getParentTransform(shape)\n\t\t\t\t\tconst vec = new Vec2d(offset.x, offset.y).rot(\n\t\t\t\t\t\t-Matrix2d.Decompose(parentTransform).rotation\n\t\t\t\t\t)\n\t\t\t\t\tox = vec.x\n\t\t\t\t\toy = vec.y\n\t\t\t\t}\n\n\t\t\t\tconst parentId = shape.parentId ?? this.currentPageId\n\t\t\t\tconst siblings = this.getSortedChildIds(parentId)\n\t\t\t\tconst currentIndex = siblings.indexOf(shape.id)\n\t\t\t\tconst siblingAboveId = siblings[currentIndex + 1]\n\t\t\t\tconst siblingAbove = siblingAboveId ? this.getShapeById(siblingAboveId) : null\n\n\t\t\t\tconst index = siblingAbove\n\t\t\t\t\t? getIndexBetween(shape.index, siblingAbove.index)\n\t\t\t\t\t: getIndexAbove(shape.index)\n\n\t\t\t\tconst newShape: TLShape = {\n\t\t\t\t\t...deepCopy(shape),\n\t\t\t\t\tid: createId,\n\t\t\t\t\tx: shape.x + ox,\n\t\t\t\t\ty: shape.y + oy,\n\t\t\t\t\tindex,\n\t\t\t\t}\n\n\t\t\t\tif (TLArrowShapeDef.is(shape) && TLArrowShapeDef.is(newShape)) {\n\t\t\t\t\tif (shape.props.start.type === 'binding') {\n\t\t\t\t\t\tconst newBoundShapeId = idsMap.get(shape.props.start.boundShapeId)\n\n\t\t\t\t\t\tif (newBoundShapeId) {\n\t\t\t\t\t\t\t;(newShape.props.start as TLArrowTerminal & { type: 'binding' }).boundShapeId =\n\t\t\t\t\t\t\t\tnewBoundShapeId\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconst bounds = this.getPageBoundsById(shape.props.start.boundShapeId)!\n\t\t\t\t\t\t\tconst pointInTargetSpace = new Vec2d(\n\t\t\t\t\t\t\t\tshape.props.start.normalizedAnchor.x * bounds.width + bounds.minX,\n\t\t\t\t\t\t\t\tshape.props.start.normalizedAnchor.y * bounds.height + bounds.minY\n\t\t\t\t\t\t\t)\n\n\t\t\t\t\t\t\tconst pointInArrowSpace = Matrix2d.applyToPoint(\n\t\t\t\t\t\t\t\tMatrix2d.Inverse(this.getTransform(newShape)),\n\t\t\t\t\t\t\t\tpointInTargetSpace\n\t\t\t\t\t\t\t)\n\n\t\t\t\t\t\t\tnewShape.props.start = {\n\t\t\t\t\t\t\t\ttype: 'point',\n\t\t\t\t\t\t\t\tx: pointInArrowSpace.x + ox,\n\t\t\t\t\t\t\t\ty: pointInArrowSpace.y + oy,\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (shape.props.end.type === 'binding') {\n\t\t\t\t\t\tconst newBoundShapeId = idsMap.get(shape.props.end.boundShapeId)\n\n\t\t\t\t\t\tif (newBoundShapeId) {\n\t\t\t\t\t\t\t;(newShape.props.end as TLArrowTerminal & { type: 'binding' }).boundShapeId =\n\t\t\t\t\t\t\t\tnewBoundShapeId\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconst bounds = this.getPageBoundsById(shape.props.end.boundShapeId)!\n\t\t\t\t\t\t\tconst pointInTargetSpace = new Vec2d(\n\t\t\t\t\t\t\t\tshape.props.end.normalizedAnchor.x * bounds.width + bounds.minX,\n\t\t\t\t\t\t\t\tshape.props.end.normalizedAnchor.y * bounds.height + bounds.minY\n\t\t\t\t\t\t\t)\n\n\t\t\t\t\t\t\tconst pointInArrowSpace = Matrix2d.applyToPoint(\n\t\t\t\t\t\t\t\tMatrix2d.Inverse(this.getTransform(newShape)),\n\t\t\t\t\t\t\t\tpointInTargetSpace\n\t\t\t\t\t\t\t)\n\n\t\t\t\t\t\t\tnewShape.props.end = {\n\t\t\t\t\t\t\t\ttype: 'point',\n\t\t\t\t\t\t\t\tx: pointInArrowSpace.x + ox,\n\t\t\t\t\t\t\t\ty: pointInArrowSpace.y + oy,\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn newShape\n\t\t\t})\n\t\t)\n\n\t\tshapesToCreate.forEach((shape) => {\n\t\t\tif (isShapeId(shape.parentId)) {\n\t\t\t\tif (idsMap.has(shape.parentId)) {\n\t\t\t\t\tshape.parentId = idsMap.get(shape.parentId)!\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\n\t\tthis.history.batch(() => {\n\t\t\tconst maxShapesReached = shapesToCreate.length + this.shapeIds.size > MAX_SHAPES_PER_PAGE\n\n\t\t\tif (maxShapesReached) {\n\t\t\t\talertMaxShapes(this)\n\t\t\t}\n\n\t\t\tconst newShapes = maxShapesReached\n\t\t\t\t? shapesToCreate.slice(0, MAX_SHAPES_PER_PAGE - this.shapeIds.size)\n\t\t\t\t: shapesToCreate\n\n\t\t\tconst ids = newShapes.map((s) => s.id)\n\n\t\t\tthis.createShapes(newShapes)\n\t\t\tthis.setSelectedIds(ids)\n\n\t\t\tif (offset !== undefined) {\n\t\t\t\t// If we've offset the duplicated shapes, check to see whether their new bounds is entirely\n\t\t\t\t// contained in the current viewport. If not, then animate the camera to be centered on the\n\t\t\t\t// new shapes.\n\t\t\t\tconst { viewportPageBounds, selectedPageBounds } = this\n\t\t\t\tif (selectedPageBounds && !viewportPageBounds.contains(selectedPageBounds)) {\n\t\t\t\t\tthis.centerOnPoint(selectedPageBounds.center.x, selectedPageBounds.center.y, {\n\t\t\t\t\t\tduration: ANIMATION_MEDIUM_MS,\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\n\t\treturn this\n\t}\n\n\t/**\n\t * Set the current props (generally styles).\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.setProp('color', 'red')\n\t * \tapp.setProp('color', 'red', true)\n\t * ```\n\t *\n\t * @param key - The key to set.\n\t * @param value - The value to set.\n\t * @param ephemeral - Whether the style is ephemeral. Defaults to false.\n\t * @public\n\t */\n\tsetProp(key: TLShapeProp, value: any, ephemeral = false, squashing = false) {\n\t\tconst children: (TLShape | undefined)[] = []\n\t\t// We can have many deep levels of grouped shape\n\t\t// Making a recursive function to look through all the levels\n\t\tconst getChildProp = (id: TLShape['id']) => {\n\t\t\tconst childIds = this.getSortedChildIds(id)\n\t\t\tfor (const childId of childIds) {\n\t\t\t\tconst childShape = this.getShapeById(childId)\n\t\t\t\tif (childShape?.type === 'group') {\n\t\t\t\t\tgetChildProp(childShape.id)\n\t\t\t\t}\n\t\t\t\tchildren.push(childShape)\n\t\t\t}\n\t\t}\n\n\t\tthis.history.batch(() => {\n\t\t\tthis.updateInstanceState(\n\t\t\t\t{\n\t\t\t\t\tpropsForNextShape: setPropsForNextShape(this.instanceState.propsForNextShape, {\n\t\t\t\t\t\t[key]: value,\n\t\t\t\t\t}),\n\t\t\t\t},\n\t\t\t\tephemeral,\n\t\t\t\tsquashing\n\t\t\t)\n\n\t\t\tif (this.isIn('select')) {\n\t\t\t\tconst {\n\t\t\t\t\tpageState: { selectedIds },\n\t\t\t\t} = this\n\n\t\t\t\tif (selectedIds.length > 0) {\n\t\t\t\t\tconst shapes = compact(\n\t\t\t\t\t\tselectedIds.map((id) => {\n\t\t\t\t\t\t\tconst shape = this.getShapeById(id)\n\t\t\t\t\t\t\tif (shape?.type === 'group') {\n\t\t\t\t\t\t\t\tconst childIds = this.getSortedChildIds(shape.id)\n\t\t\t\t\t\t\t\tfor (const childId of childIds) {\n\t\t\t\t\t\t\t\t\tconst childShape = this.getShapeById(childId)\n\t\t\t\t\t\t\t\t\tif (childShape?.type === 'group') {\n\t\t\t\t\t\t\t\t\t\tgetChildProp(childShape.id)\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tchildren.push(childShape)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\treturn children\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\treturn shape\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t)\n\t\t\t\t\t\t.flat()\n\t\t\t\t\t\t.filter(\n\t\t\t\t\t\t\t(shape) =>\n\t\t\t\t\t\t\t\tshape!.props[key as keyof TLShape['props']] !== undefined && shape?.type !== 'group'\n\t\t\t\t\t\t) as TLShape[]\n\n\t\t\t\t\tthis.updateShapes(\n\t\t\t\t\t\tshapes.map((shape) => {\n\t\t\t\t\t\t\tconst props = { ...shape.props, [key]: value }\n\t\t\t\t\t\t\tif (key === 'color' && 'labelColor' in props) {\n\t\t\t\t\t\t\t\tprops.labelColor = 'black'\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\tid: shape.id,\n\t\t\t\t\t\t\t\ttype: shape.type,\n\t\t\t\t\t\t\t\tprops,\n\t\t\t\t\t\t\t} as TLShape\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tephemeral\n\t\t\t\t\t)\n\n\t\t\t\t\tif (key !== 'color' && key !== 'opacity') {\n\t\t\t\t\t\tconst changes: TLShapePartial[] = []\n\n\t\t\t\t\t\tfor (const shape of shapes) {\n\t\t\t\t\t\t\tconst currentShape = this.getShapeById(shape.id)\n\t\t\t\t\t\t\tif (!currentShape) continue\n\t\t\t\t\t\t\tconst util = this.getShapeUtil(currentShape)\n\n\t\t\t\t\t\t\tconst boundsA = util.bounds(shape)\n\t\t\t\t\t\t\tconst boundsB = util.bounds(currentShape)\n\n\t\t\t\t\t\t\tconst change: TLShapePartial = { id: shape.id, type: shape.type }\n\n\t\t\t\t\t\t\tlet didChange = false\n\n\t\t\t\t\t\t\tif (boundsA.width !== boundsB.width) {\n\t\t\t\t\t\t\t\tdidChange = true\n\n\t\t\t\t\t\t\t\tif (TLTextShapeDef.is(shape)) {\n\t\t\t\t\t\t\t\t\tswitch (shape.props.align) {\n\t\t\t\t\t\t\t\t\t\tcase 'middle': {\n\t\t\t\t\t\t\t\t\t\t\tchange.x = currentShape.x + (boundsA.width - boundsB.width) / 2\n\t\t\t\t\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tcase 'end': {\n\t\t\t\t\t\t\t\t\t\t\tchange.x = currentShape.x + boundsA.width - boundsB.width\n\t\t\t\t\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tchange.x = currentShape.x + (boundsA.width - boundsB.width) / 2\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (boundsA.height !== boundsB.height) {\n\t\t\t\t\t\t\t\tdidChange = true\n\t\t\t\t\t\t\t\tchange.y = currentShape.y + (boundsA.height - boundsB.height) / 2\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (didChange) {\n\t\t\t\t\t\t\t\tchanges.push(change)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (changes.length) {\n\t\t\t\t\t\t\tthis.updateShapes(changes, ephemeral)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.updateInstanceState(\n\t\t\t\t{\n\t\t\t\t\tpropsForNextShape: setPropsForNextShape(this.instanceState.propsForNextShape, {\n\t\t\t\t\t\t[key]: value,\n\t\t\t\t\t}),\n\t\t\t\t},\n\t\t\t\tephemeral,\n\t\t\t\tsquashing\n\t\t\t)\n\t\t})\n\n\t\treturn this\n\t}\n\n\t/** @internal */\n\tprivate _willSetInitialBounds = true\n\n\t/** @internal */\n\tprivate _setCamera(x: number, y: number, z = this.camera.z) {\n\t\tconst currentCamera = this.camera\n\t\tif (currentCamera.x === x && currentCamera.y === y && currentCamera.z === z) return this\n\t\tthis.store.put([{ ...currentCamera, x, y, z }])\n\n\t\tthis._cameraManager.tick()\n\n\t\tthis.emit('change-camera', this.camera)\n\n\t\treturn this\n\t}\n\n\t/**\n\t * Set the current camera.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.setCamera(0, 0)\n\t * \tapp.setCamera(0, 0, 1)\n\t * ```\n\t *\n\t * @param x - The camera's x position.\n\t * @param y - The camera's y position.\n\t * @param z - The camera's z position. Defaults to the current zoom.\n\t *\n\t * @public\n\t */\n\tsetCamera(x: number, y: number, z = this.camera.z) {\n\t\tthis.stopCameraAnimation()\n\t\tx = Number.isNaN(x) ? 0 : x\n\t\ty = Number.isNaN(y) ? 0 : y\n\t\tz = Number.isNaN(z) ? 1 : z\n\t\tthis._setCamera(x, y, z)\n\t\treturn this\n\t}\n\n\t/**\n\t * Animate the camera.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.animateCamera(0, 0)\n\t * \tapp.animateCamera(0, 0, 1)\n\t * \tapp.animateCamera(0, 0, 1, { duration: 1000, easing: (t) => t * t })\n\t * ```\n\t *\n\t * @param x - The camera's x position.\n\t * @param y - The camera's y position.\n\t * @param z - The camera's z position. Defaults to the current zoom.\n\t * @param opts - Options for the animation.\n\t *\n\t * @public\n\t */\n\tanimateCamera(\n\t\tx: number,\n\t\ty: number,\n\t\tz = this.camera.z,\n\t\topts: AnimationOptions = DEFAULT_ANIMATION_OPTIONS\n\t) {\n\t\tx = Number.isNaN(x) ? 0 : x\n\t\ty = Number.isNaN(y) ? 0 : y\n\t\tz = Number.isNaN(z) ? 1 : z\n\t\tconst { width, height } = this.viewportScreenBounds\n\t\tconst w = width / z\n\t\tconst h = height / z\n\n\t\tconst targetViewport = new Box2d(-x, -y, w, h)\n\n\t\treturn this._animateToViewport(targetViewport, opts)\n\t}\n\n\t/**\n\t * Center the camera on a point (in page space).\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.centerOnPoint(100, 100)\n\t * ```\n\t *\n\t * @param x - The x position of the point.\n\t * @param y - The y position of the point.\n\t * @param opts - The options for an animation.\n\t *\n\t * @public\n\t */\n\tcenterOnPoint(x: number, y: number, opts?: AnimationOptions): this {\n\t\tif (!this.canMoveCamera) return this\n\n\t\tconst {\n\t\t\tviewportPageBounds: { width: pw, height: ph },\n\t\t\tcamera,\n\t\t} = this\n\n\t\tif (opts?.duration) {\n\t\t\tthis.animateCamera(-(x - pw / 2), -(y - ph / 2), camera.z, opts)\n\t\t} else {\n\t\t\tthis.setCamera(-(x - pw / 2), -(y - ph / 2), camera.z)\n\t\t}\n\t\treturn this\n\t}\n\n\t/**\n\t * Zoom the camera to fit the current page's content in the viewport.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.zoomToFit()\n\t * ```\n\t *\n\t * @public\n\t */\n\tzoomToFit(opts?: AnimationOptions): this {\n\t\tif (!this.canMoveCamera) return this\n\n\t\tconst ids = [...this.shapeIds]\n\t\tif (ids.length <= 0) return this\n\n\t\tconst pageBounds = Box2d.Common(compact(ids.map((id) => this.getPageBoundsById(id))))\n\t\tthis.zoomToBounds(\n\t\t\tpageBounds.minX,\n\t\t\tpageBounds.minY,\n\t\t\tpageBounds.width,\n\t\t\tpageBounds.height,\n\t\t\tundefined,\n\t\t\topts\n\t\t)\n\t\treturn this\n\t}\n\n\t/**\n\t * Set the zoom back to 100%.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.resetZoom()\n\t * ```\n\t *\n\t * @param opts - The options for an animation.\n\t * @public\n\t */\n\tresetZoom(point = this.viewportScreenCenter, opts?: AnimationOptions): this {\n\t\tif (!this.canMoveCamera) return this\n\n\t\tconst { x: cx, y: cy, z: cz } = this.camera\n\t\tconst { x, y } = point\n\t\tif (opts?.duration) {\n\t\t\tthis.animateCamera(cx + (x / 1 - x) - (x / cz - x), cy + (y / 1 - y) - (y / cz - y), 1, opts)\n\t\t} else {\n\t\t\tthis.setCamera(cx + (x / 1 - x) - (x / cz - x), cy + (y / 1 - y) - (y / cz - y), 1)\n\t\t}\n\t\treturn this\n\t}\n\n\t/**\n\t * Zoom the camera in.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.zoomIn()\n\t * \tapp.zoomIn(app.viewportScreenCenter, { duration: 120 })\n\t * \tapp.zoomIn(app.inputs.currentScreenPoint, { duration: 120 })\n\t * ```\n\t *\n\t * @param opts - The options for an animation.\n\t * @public\n\t */\n\tzoomIn(point = this.viewportScreenCenter, opts?: AnimationOptions): this {\n\t\tif (!this.canMoveCamera) return this\n\n\t\tconst { x: cx, y: cy, z: cz } = this.camera\n\n\t\tlet zoom = MAX_ZOOM\n\n\t\tfor (let i = 1; i < ZOOMS.length; i++) {\n\t\t\tconst z1 = ZOOMS[i - 1]\n\t\t\tconst z2 = ZOOMS[i]\n\t\t\tif (z2 - cz <= (z2 - z1) / 2) continue\n\t\t\tzoom = z2\n\t\t\tbreak\n\t\t}\n\n\t\tconst { x, y } = point\n\t\tif (opts?.duration) {\n\t\t\tthis.animateCamera(\n\t\t\t\tcx + (x / zoom - x) - (x / cz - x),\n\t\t\t\tcy + (y / zoom - y) - (y / cz - y),\n\t\t\t\tzoom,\n\t\t\t\topts\n\t\t\t)\n\t\t} else {\n\t\t\tthis.setCamera(cx + (x / zoom - x) - (x / cz - x), cy + (y / zoom - y) - (y / cz - y), zoom)\n\t\t}\n\t\treturn this\n\t}\n\n\t/**\n\t * Zoom the camera out.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.zoomOut()\n\t * \tapp.zoomOut(app.viewportScreenCenter, { duration: 120 })\n\t * \tapp.zoomOut(app.inputs.currentScreenPoint, { duration: 120 })\n\t * ```\n\t *\n\t * @param opts - The options for an animation.\n\t * @public\n\t */\n\tzoomOut(point = this.viewportScreenCenter, opts?: AnimationOptions): this {\n\t\tif (!this.canMoveCamera) return this\n\n\t\tconst { x: cx, y: cy, z: cz } = this.camera\n\n\t\tlet zoom = MIN_ZOOM\n\n\t\tfor (let i = ZOOMS.length - 1; i > 0; i--) {\n\t\t\tconst z1 = ZOOMS[i - 1]\n\t\t\tconst z2 = ZOOMS[i]\n\t\t\tif (z2 - cz >= (z2 - z1) / 2) continue\n\t\t\tzoom = z1\n\t\t\tbreak\n\t\t}\n\n\t\tconst { x, y } = point\n\n\t\tif (opts?.duration) {\n\t\t\tthis.animateCamera(\n\t\t\t\tcx + (x / zoom - x) - (x / cz - x),\n\t\t\t\tcy + (y / zoom - y) - (y / cz - y),\n\t\t\t\tzoom,\n\t\t\t\topts\n\t\t\t)\n\t\t} else {\n\t\t\tthis.setCamera(cx + (x / zoom - x) - (x / cz - x), cy + (y / zoom - y) - (y / cz - y), zoom)\n\t\t}\n\t\treturn this\n\t}\n\n\t/**\n\t * Zoom the camera to fit the current selection in the viewport.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.zoomToSelection()\n\t * ```\n\t *\n\t * @param opts - The options for an animation.\n\t * @public\n\t */\n\tzoomToSelection(opts?: AnimationOptions): this {\n\t\tif (!this.canMoveCamera) return this\n\n\t\tconst ids = this.selectedIds\n\t\tif (ids.length <= 0) return this\n\n\t\tconst selectedBounds = Box2d.Common(compact(ids.map((id) => this.getPageBoundsById(id))))\n\n\t\tthis.zoomToBounds(\n\t\t\tselectedBounds.minX,\n\t\t\tselectedBounds.minY,\n\t\t\tselectedBounds.width,\n\t\t\tselectedBounds.height,\n\t\t\tMath.max(1, this.camera.z),\n\t\t\topts\n\t\t)\n\t\treturn this\n\t}\n\n\t/**\n\t * Pan or pan/zoom the selected ids into view. This method tries to not\n\t * change the zoom if possible.\n\t *\n\t * @param ids - The ids of the shapes to pan and zoom into view.\n\t * @param opts - The options for an animation.\n\t * @public\n\t */\n\tpanZoomIntoView(ids: TLShapeId[], opts?: AnimationOptions): this {\n\t\tif (!this.canMoveCamera) return this\n\n\t\tif (ids.length <= 0) return this\n\t\tconst selectedBounds = Box2d.Common(compact(ids.map((id) => this.getPageBoundsById(id))))\n\n\t\tconst { viewportPageBounds } = this\n\n\t\tif (viewportPageBounds.h < selectedBounds.h || viewportPageBounds.w < selectedBounds.w) {\n\t\t\tthis.zoomToBounds(\n\t\t\t\tselectedBounds.minX,\n\t\t\t\tselectedBounds.minY,\n\t\t\t\tselectedBounds.width,\n\t\t\t\tselectedBounds.height,\n\t\t\t\tthis.camera.z,\n\t\t\t\topts\n\t\t\t)\n\n\t\t\treturn this\n\t\t} else {\n\t\t\t// TODO: This buffer should calculate the 'active area' of the UI\n\t\t\tconst bufferOffsets = this._activeAreaManager.offsets.value\n\n\t\t\tconst pageTop = viewportPageBounds.y + bufferOffsets.top\n\t\t\tconst pageRight = viewportPageBounds.maxY - bufferOffsets.right\n\t\t\tconst pageBottom = viewportPageBounds.maxY - bufferOffsets.bottom\n\t\t\tconst pageLeft = viewportPageBounds.x + bufferOffsets.left\n\n\t\t\tconst selectedTop = selectedBounds.y\n\t\t\tconst selectedRight = selectedBounds.maxX\n\t\t\tconst selectedBottom = selectedBounds.maxY\n\t\t\tconst selectedLeft = selectedBounds.x\n\n\t\t\tlet offsetX = 0\n\t\t\tlet offsetY = 0\n\t\t\tif (pageBottom < selectedBottom) {\n\t\t\t\t// off bottom\n\t\t\t\toffsetY = pageBottom - selectedBottom\n\t\t\t} else if (pageTop > selectedTop) {\n\t\t\t\t// off top\n\t\t\t\toffsetY = pageTop - selectedTop\n\t\t\t} else {\n\t\t\t\t// inside y-bounds\n\t\t\t}\n\n\t\t\tif (pageRight < selectedRight) {\n\t\t\t\t// off right\n\t\t\t\toffsetX = pageRight - selectedRight\n\t\t\t} else if (pageLeft > selectedLeft) {\n\t\t\t\t// off left\n\t\t\t\toffsetX = pageLeft - selectedLeft\n\t\t\t} else {\n\t\t\t\t// inside x-bounds\n\t\t\t}\n\n\t\t\tconst { camera } = this\n\n\t\t\tif (opts?.duration) {\n\t\t\t\tthis.animateCamera(camera.x + offsetX, camera.y + offsetY, camera.z, opts)\n\t\t\t} else {\n\t\t\t\tthis.setCamera(camera.x + offsetX, camera.y + offsetY, camera.z)\n\t\t\t}\n\t\t}\n\n\t\treturn this\n\t}\n\n\t/**\n\t * Zoom the camera to fit a bounding box (in page space).\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.zoomToBounds(0, 0, 100, 100)\n\t * ```\n\t *\n\t * @param x - The bounding box's x position.\n\t * @param y - The bounding box's y position.\n\t * @param width - The bounding box's width.\n\t * @param height - The bounding box's height.\n\t * @param targetZoom - The desired zoom level. Defaults to 0.1.\n\t * @public\n\t */\n\tzoomToBounds(\n\t\tx: number,\n\t\ty: number,\n\t\twidth: number,\n\t\theight: number,\n\t\ttargetZoom?: number,\n\t\topts?: AnimationOptions\n\t): this {\n\t\tif (!this.canMoveCamera) return this\n\n\t\tconst { viewportScreenBounds } = this\n\n\t\tconst inset = Math.min(256, viewportScreenBounds.width * 0.28)\n\n\t\tlet zoom = clamp(\n\t\t\tMath.min(\n\t\t\t\t(viewportScreenBounds.width - inset) / width,\n\t\t\t\t(viewportScreenBounds.height - inset) / height\n\t\t\t),\n\t\t\tMIN_ZOOM,\n\t\t\tMAX_ZOOM\n\t\t)\n\n\t\tif (targetZoom !== undefined) {\n\t\t\tzoom = Math.min(targetZoom, zoom)\n\t\t}\n\n\t\tif (opts?.duration) {\n\t\t\tthis.animateCamera(\n\t\t\t\t-x + (viewportScreenBounds.width - width * zoom) / 2 / zoom,\n\t\t\t\t-y + (viewportScreenBounds.height - height * zoom) / 2 / zoom,\n\t\t\t\tzoom,\n\t\t\t\topts\n\t\t\t)\n\t\t} else {\n\t\t\tthis.setCamera(\n\t\t\t\t-x + (viewportScreenBounds.width - width * zoom) / 2 / zoom,\n\t\t\t\t-y + (viewportScreenBounds.height - height * zoom) / 2 / zoom,\n\t\t\t\tzoom\n\t\t\t)\n\t\t}\n\n\t\treturn this\n\t}\n\n\t/**\n\t * Pan the camera.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.pan(100, 100)\n\t * \tapp.pan(100, 100, {duration: 1000})\n\t * ```\n\t *\n\t * @param dx - The amount to pan on the x axis.\n\t * @param dy - The amount to pan on the y axis.\n\t * @param opts - the animation options\n\t */\n\tpan(dx: number, dy: number, opts?: AnimationOptions): this {\n\t\tif (!this.canMoveCamera) return this\n\n\t\tconst { camera } = this\n\t\tconst { x: cx, y: cy, z: cz } = camera\n\t\tconst d = new Vec2d(dx, dy).div(cz)\n\n\t\tif (opts?.duration ?? 0 > 0) {\n\t\t\treturn this.animateCamera(cx + d.x, cy + d.y, cz, opts)\n\t\t} else {\n\t\t\tthis.setCamera(cx + d.x, cy + d.y, cz)\n\t\t}\n\n\t\treturn this\n\t}\n\n\t/**\n\t * Stop the current camera animation, if any.\n\t *\n\t * @public\n\t */\n\tstopCameraAnimation() {\n\t\tthis.emit('stop-camera-animation')\n\n\t\treturn this\n\t}\n\n\t/** @internal */\n\tprivate _viewportAnimation = null as null | {\n\t\telapsed: number\n\t\tduration: number\n\t\teasing: (t: number) => number\n\t\tstart: Box2d\n\t\tend: Box2d\n\t}\n\n\t/** @internal */\n\tprivate _animateViewport(ms: number) {\n\t\tif (!this._viewportAnimation) return\n\n\t\tconst cancel = () => {\n\t\t\tthis.removeListener('tick', this._animateViewport)\n\t\t\tthis.removeListener('stop-camera-animation', cancel)\n\t\t}\n\n\t\tthis.once('stop-camera-animation', cancel)\n\n\t\tthis._viewportAnimation.elapsed += ms\n\n\t\tconst { elapsed, easing, duration, start, end } = this._viewportAnimation\n\n\t\tif (elapsed > duration) {\n\t\t\tconst z = this.viewportScreenBounds.width / end.width\n\t\t\tconst x = -end.x\n\t\t\tconst y = -end.y\n\n\t\t\tthis._setCamera(x, y, z)\n\t\t\tthis.removeListener('tick', this._animateViewport)\n\t\t\tthis._viewportAnimation = null\n\t\t\treturn\n\t\t}\n\n\t\tconst remaining = duration - elapsed\n\t\tconst t = easing(1 - remaining / duration)\n\n\t\tconst left = start.minX + (end.minX - start.minX) * t\n\t\tconst top = start.minY + (end.minY - start.minY) * t\n\t\tconst right = start.maxX + (end.maxX - start.maxX) * t\n\t\tconst bottom = start.maxY + (end.maxY - start.maxY) * t\n\n\t\tconst easedViewport = new Box2d(left, top, right - left, bottom - top)\n\n\t\tconst z = this.viewportScreenBounds.width / easedViewport.width\n\t\tconst x = -easedViewport.x\n\t\tconst y = -easedViewport.y\n\n\t\tthis._setCamera(x, y, z)\n\t}\n\n\t/** @internal */\n\tprivate _animateToViewport(targetViewportPage: Box2d, opts = {} as AnimationOptions) {\n\t\tconst { duration = 0, easing = EASINGS.easeInOutCubic } = opts\n\t\tconst startViewport = this.viewportPageBounds.clone()\n\n\t\tthis.stopCameraAnimation()\n\n\t\tthis._viewportAnimation = {\n\t\t\telapsed: 0,\n\t\t\tduration,\n\t\t\teasing,\n\t\t\tstart: startViewport,\n\t\t\tend: targetViewportPage,\n\t\t}\n\n\t\tthis.addListener('tick', this._animateViewport)\n\n\t\treturn this\n\t}\n\n\tslideCamera(\n\t\topts = {} as {\n\t\t\tspeed: number\n\t\t\tdirection: Vec2d\n\t\t\tfriction: number\n\t\t\tspeedThreshold?: number\n\t\t}\n\t) {\n\t\tif (!this.canMoveCamera) return this\n\n\t\tconst { speed, direction, friction, speedThreshold = 0.01 } = opts\n\t\tlet currentSpeed = speed\n\n\t\tthis.stopCameraAnimation()\n\n\t\tconst cancel = () => {\n\t\t\tthis.removeListener('tick', moveCamera)\n\t\t\tthis.removeListener('stop-camera-animation', cancel)\n\t\t}\n\n\t\tthis.once('stop-camera-animation', cancel)\n\n\t\tconst moveCamera = (elapsed: number) => {\n\t\t\tconst { x: cx, y: cy, z: cz } = this.camera\n\t\t\tconst movementVec = direction.clone().mul((currentSpeed * elapsed) / cz)\n\n\t\t\t// Apply friction\n\t\t\tcurrentSpeed *= 1 - friction\n\t\t\tif (currentSpeed < speedThreshold) {\n\t\t\t\tcancel()\n\t\t\t} else {\n\t\t\t\tthis._setCamera(cx + movementVec.x, cy + movementVec.y, cz)\n\t\t\t}\n\t\t}\n\n\t\tthis.addListener('tick', moveCamera)\n\n\t\treturn this\n\t}\n\n\tanimateToShape(shapeId: TLShapeId, opts: AnimationOptions = DEFAULT_ANIMATION_OPTIONS): this {\n\t\tif (!this.canMoveCamera) return this\n\n\t\tconst activeArea = getActiveAreaScreenSpace(this)\n\t\tconst viewportAspectRatio = activeArea.width / activeArea.height\n\n\t\tconst shapePageBounds = this.getPageBoundsById(shapeId)\n\n\t\tif (!shapePageBounds) return this\n\n\t\tconst shapeAspectRatio = shapePageBounds.width / shapePageBounds.height\n\n\t\tconst targetViewportPage = shapePageBounds.clone()\n\n\t\tconst z = shapePageBounds.width / activeArea.width\n\t\ttargetViewportPage.width += (activeArea.left + activeArea.right) * z\n\t\ttargetViewportPage.height += (activeArea.top + activeArea.bottom) * z\n\t\ttargetViewportPage.x -= activeArea.left * z\n\t\ttargetViewportPage.y -= activeArea.top * z\n\n\t\tif (shapeAspectRatio > viewportAspectRatio) {\n\t\t\ttargetViewportPage.height = shapePageBounds.width / viewportAspectRatio\n\t\t\ttargetViewportPage.y -= (targetViewportPage.height - shapePageBounds.height) / 2\n\t\t} else {\n\t\t\ttargetViewportPage.width = shapePageBounds.height * viewportAspectRatio\n\t\t\ttargetViewportPage.x -= (targetViewportPage.width - shapePageBounds.width) / 2\n\t\t}\n\n\t\treturn this._animateToViewport(targetViewportPage, opts)\n\t}\n\n\t/**\n\t * Blur the app, cancelling any interaction state.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.blur()\n\t * ```\n\t *\n\t * @public\n\t */\n\tblur() {\n\t\tthis.dispatch({ type: 'misc', name: 'blur' })\n\t\treturn this\n\t}\n\n\t/**\n\t * Dispatch a cancel event.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.cancel()\n\t * ```\n\t *\n\t * @public\n\t */\n\tcancel() {\n\t\tthis.dispatch({ type: 'misc', name: 'cancel' })\n\t\treturn this\n\t}\n\n\t/**\n\t * Dispatch an interrupt event.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.interrupt()\n\t * ```\n\t *\n\t * @public\n\t */\n\tinterrupt() {\n\t\tthis.dispatch({ type: 'misc', name: 'interrupt' })\n\t\treturn this\n\t}\n\n\t/**\n\t * Dispatch a complete event.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.complete()\n\t * ```\n\t *\n\t * @public\n\t */\n\tcomplete() {\n\t\tthis.dispatch({ type: 'misc', name: 'complete' })\n\t\treturn this\n\t}\n\n\t/* -------------------- Callbacks ------------------- */\n\n\t/**\n\t * A callback fired when a file is converted to an asset. This callback should return the asset partial.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.onCreateAssetFromFile(myFile)\n\t * ```\n\t *\n\t * @param file - The file to upload.\n\t * @public\n\t */\n\n\tasync onCreateAssetFromFile(file: File): Promise<TLAsset> {\n\t\treturn await getMediaAssetFromFile(file)\n\t}\n\n\t/**\n\t * A callback fired when a URL is converted to a bookmark. This callback should return the\n\t * metadata for the bookmark.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.onCreateBookmarkFromUrl(url, id)\n\t * ```\n\t *\n\t * @param url - The url that was created.\n\t * @public\n\t */\n\tasync onCreateBookmarkFromUrl(\n\t\turl: string\n\t): Promise<{ image: string; title: string; description: string }> {\n\t\ttry {\n\t\t\tconst resp = await fetch(url, { method: 'GET', mode: 'no-cors' })\n\t\t\tconst html = await resp.text()\n\t\t\tconst doc = new DOMParser().parseFromString(html, 'text/html')\n\n\t\t\treturn {\n\t\t\t\timage: doc.head.querySelector('meta[property=\"og:image\"]')?.getAttribute('content') ?? '',\n\t\t\t\ttitle: doc.head.querySelector('meta[property=\"og:title\"]')?.getAttribute('content') ?? '',\n\t\t\t\tdescription:\n\t\t\t\t\tdoc.head.querySelector('meta[property=\"og:description\"]')?.getAttribute('content') ?? '',\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tconsole.error(error)\n\t\t\treturn { image: '', title: '', description: '' }\n\t\t}\n\t}\n\n\t/* ---------------- Text Measurement ---------------- */\n\n\t/**\n\t * A helper for measuring text.\n\t *\n\t * @public\n\t */\n\ttextMeasure: TextManager\n\n\t/* --------------------- Groups --------------------- */\n\n\tgroupShapes(ids: TLShapeId[] = this.selectedIds, groupId = createShapeId()) {\n\t\tif (this.isReadOnly) return this\n\n\t\tif (ids.length <= 1) return this\n\n\t\tconst shapes = compact(ids.map((id) => this.getShapeById(id)))\n\t\tconst sortedShapeIds = shapes.sort(sortByIndex).map((s) => s.id)\n\t\tconst pageBounds = Box2d.Common(compact(shapes.map((id) => this.getPageBounds(id))))\n\n\t\tconst { x, y } = pageBounds.point\n\n\t\tconst parentId = this.findCommonAncestor(shapes) ?? this.currentPageId\n\n\t\t// Only group when the select tool is active\n\t\tif (this.currentToolId !== 'select') return this\n\n\t\t// If not already in idle, cancel the current interaction (get back to idle)\n\t\tif (!this.isIn('select.idle')) {\n\t\t\tthis.cancel()\n\t\t}\n\n\t\t// Find all the shapes that have the same parentId, and use the highest index.\n\t\tconst shapesWithRootParent = shapes\n\t\t\t.filter((shape) => shape.parentId === parentId)\n\t\t\t.sort(sortByIndex)\n\n\t\tconst highestIndex = shapesWithRootParent[shapesWithRootParent.length - 1]?.index\n\n\t\tthis.batch(() => {\n\t\t\tthis.createShapes([\n\t\t\t\t{\n\t\t\t\t\tid: groupId,\n\t\t\t\t\ttype: 'group',\n\t\t\t\t\tparentId,\n\t\t\t\t\tindex: highestIndex,\n\t\t\t\t\tx,\n\t\t\t\t\ty,\n\t\t\t\t\tprops: {\n\t\t\t\t\t\topacity: '1',\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t])\n\t\t\tthis.reparentShapesById(sortedShapeIds, groupId)\n\t\t\tthis.select(groupId)\n\t\t})\n\n\t\treturn this\n\t}\n\n\tungroupShapes(ids: TLShapeId[] = this.selectedIds) {\n\t\tif (this.isReadOnly) return this\n\t\tif (ids.length === 0) return this\n\n\t\t// Only ungroup when the select tool is active\n\t\tif (this.currentToolId !== 'select') return this\n\n\t\t// If not already in idle, cancel the current interaction (get back to idle)\n\t\tif (!this.isIn('select.idle')) {\n\t\t\tthis.cancel()\n\t\t}\n\n\t\t// The ids of the selected shapes after ungrouping;\n\t\t// these include all of the grouped shapes children,\n\t\t// plus any shapes that were selected apart from the groups.\n\t\tconst idsToSelect = new Set<TLShapeId>()\n\n\t\t// Get all groups in the selection\n\t\tconst shapes = compact(ids.map((id) => this.getShapeById(id)))\n\n\t\tconst groups: TLGroupShape[] = []\n\n\t\tshapes.forEach((shape) => {\n\t\t\tif (TLGroupShapeDef.is(shape)) {\n\t\t\t\tgroups.push(shape)\n\t\t\t} else {\n\t\t\t\tidsToSelect.add(shape.id)\n\t\t\t}\n\t\t})\n\n\t\tif (groups.length === 0) return this\n\n\t\tthis.batch(() => {\n\t\t\tlet group: TLShape\n\n\t\t\tfor (let i = 0, n = groups.length; i < n; i++) {\n\t\t\t\tgroup = groups[i] as TLGroupShape\n\t\t\t\tconst childIds = this.getSortedChildIds(group.id)\n\n\t\t\t\tfor (let j = 0, n = childIds.length; j < n; j++) {\n\t\t\t\t\tidsToSelect.add(childIds[j])\n\t\t\t\t}\n\n\t\t\t\tthis.reparentShapesById(childIds, group.parentId, group.index)\n\t\t\t}\n\n\t\t\tthis.deleteShapes(groups.map((group) => group.id))\n\t\t\tthis.select(...idsToSelect)\n\t\t})\n\n\t\treturn this\n\t}\n}\n\nfunction alertMaxShapes(app: App, pageId = app.currentPageId) {\n\tconst name = app.getPageById(pageId)!.name\n\tapp.emit('max-shapes', { name, pageId, count: MAX_SHAPES_PER_PAGE })\n}\n","import { isShape, TLParentId, TLRecord, TLShapeId, TLStore } from '@tldraw/tlschema'\nimport { RecordsDiff } from '@tldraw/tlstore'\nimport { computed, isUninitialized, RESET_VALUE } from 'signia'\n\ntype Parents2Children = Record<TLParentId, [id: TLShapeId, index: string][]>\n\nexport const parentsToChildrenWithIndexes = (store: TLStore) => {\n\tconst shapeIds = store.query.ids<'shape'>('shape')\n\tfunction fromScratch() {\n\t\tconst result: Parents2Children = {}\n\n\t\t// Populate the result object with an array for each parent.\n\t\tshapeIds.value.forEach((id) => {\n\t\t\tconst shape = store.get(id)!\n\n\t\t\tif (!result[shape.parentId]) {\n\t\t\t\tresult[shape.parentId] = []\n\t\t\t}\n\n\t\t\tresult[shape.parentId].push([id, shape.index])\n\t\t})\n\n\t\t// Sort the children by index\n\t\tObject.values(result).forEach((arr) => arr.sort((a, b) => (a[1] < b[1] ? -1 : 1)))\n\n\t\treturn result\n\t}\n\treturn computed<Parents2Children>(\n\t\t'parentsToChildrenWithIndexes',\n\t\t(lastValue, lastComputedEpoch) => {\n\t\t\tif (isUninitialized(lastValue)) {\n\t\t\t\treturn fromScratch()\n\t\t\t}\n\n\t\t\tconst diff = store.history.getDiffSince(lastComputedEpoch)\n\n\t\t\tif (diff === RESET_VALUE) {\n\t\t\t\treturn fromScratch()\n\t\t\t}\n\n\t\t\tif (diff.length === 0) return lastValue\n\n\t\t\tlet newValue: Record<TLParentId, [id: TLShapeId, index: string][]> | null = null\n\n\t\t\tconst ensureNewArray = (parentId: TLParentId) => {\n\t\t\t\tif (!newValue) {\n\t\t\t\t\tnewValue = { ...lastValue }\n\t\t\t\t}\n\t\t\t\tif (!newValue[parentId]) {\n\t\t\t\t\tnewValue[parentId] = []\n\t\t\t\t} else if (newValue[parentId] === lastValue[parentId]) {\n\t\t\t\t\tnewValue[parentId] = [...newValue[parentId]!]\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst toSort = new Set<[id: TLShapeId, index: string][]>()\n\n\t\t\tlet changes: RecordsDiff<TLRecord>\n\n\t\t\tfor (let i = 0, n = diff.length; i < n; i++) {\n\t\t\t\tchanges = diff[i]\n\n\t\t\t\t// Iterate through the added shapes, add them to the new value and mark them for sorting\n\t\t\t\tfor (const record of Object.values(changes.added)) {\n\t\t\t\t\tif (!isShape(record)) continue\n\t\t\t\t\tensureNewArray(record.parentId)\n\t\t\t\t\tnewValue![record.parentId].push([record.id, record.index])\n\t\t\t\t\ttoSort.add(newValue![record.parentId])\n\t\t\t\t}\n\n\t\t\t\t// Iterate through the updated shapes, add them to their parents in the new value and mark them for sorting\n\t\t\t\tfor (const [from, to] of Object.values(changes.updated)) {\n\t\t\t\t\tif (!isShape(to)) continue\n\t\t\t\t\tif (!isShape(from)) continue\n\n\t\t\t\t\tif (from.parentId !== to.parentId) {\n\t\t\t\t\t\t// If the parents have changed, remove the new value from the old parent and add it to the new parent\n\t\t\t\t\t\tensureNewArray(from.parentId)\n\t\t\t\t\t\tensureNewArray(to.parentId)\n\t\t\t\t\t\tnewValue![from.parentId].splice(\n\t\t\t\t\t\t\tnewValue![from.parentId].findIndex((i) => i[0] === to.id),\n\t\t\t\t\t\t\t1\n\t\t\t\t\t\t)\n\t\t\t\t\t\tnewValue![to.parentId].push([to.id, to.index])\n\t\t\t\t\t\ttoSort.add(newValue![to.parentId])\n\t\t\t\t\t} else if (from.index !== to.index) {\n\t\t\t\t\t\t// If the parent is the same but the index has changed (e.g. if they've been reordered), update the parent's array at the new index\n\t\t\t\t\t\tensureNewArray(to.parentId)\n\t\t\t\t\t\tconst idx = newValue![to.parentId].findIndex((i) => i[0] === to.id)\n\t\t\t\t\t\tnewValue![to.parentId][idx] = [to.id, to.index]\n\t\t\t\t\t\ttoSort.add(newValue![to.parentId])\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Iterate through the removed shapes, remove them from their parents in new value\n\t\t\t\tfor (const record of Object.values(changes.removed)) {\n\t\t\t\t\tif (!isShape(record)) continue\n\t\t\t\t\tensureNewArray(record.parentId)\n\t\t\t\t\tnewValue![record.parentId].splice(\n\t\t\t\t\t\tnewValue![record.parentId].findIndex((i) => i[0] === record.id),\n\t\t\t\t\t\t1\n\t\t\t\t\t)\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Sort the arrays that have been marked for sorting\n\t\t\tfor (const arr of toSort) {\n\t\t\t\tarr.sort((a, b) => (a[1] < b[1] ? -1 : 1))\n\t\t\t}\n\n\t\t\treturn newValue ?? lastValue\n\t\t}\n\t)\n}\n","/** @public */\nexport type EditorAssetUrls = {\n\tfonts: {\n\t\tmonospace: string\n\t\tserif: string\n\t\tsansSerif: string\n\t\tdraw: string\n\t}\n}\n\n/** @public */\nexport const defaultEditorAssetUrls: EditorAssetUrls = {\n\tfonts: {\n\t\tdraw: '/fonts/Shantell_Sans-Normal-SemiBold.woff2',\n\t\tserif: '/fonts/IBMPlexSerif-Medium.woff2',\n\t\tsansSerif: '/fonts/IBMPlexSans-Medium.woff2',\n\t\tmonospace: '/fonts/IBMPlexMono-Medium.woff2',\n\t},\n}\n","import * as React from 'react'\n\n/** @public */\nexport interface ErrorBoundaryProps {\n\tchildren: React.ReactNode\n\tonError?: ((error: unknown) => void) | null\n\tfallback: (error: unknown) => React.ReactNode\n}\n\ntype ErrorBoundaryState = { error: Error | null }\n\nconst initialState: ErrorBoundaryState = { error: null }\n\n/** @public */\nexport class ErrorBoundary extends React.Component<\n\tReact.PropsWithRef<React.PropsWithChildren<ErrorBoundaryProps>>,\n\tErrorBoundaryState\n> {\n\tstatic getDerivedStateFromError(error: Error) {\n\t\treturn { error }\n\t}\n\n\tstate = initialState\n\n\tcomponentDidCatch(error: unknown) {\n\t\tthis.props.onError?.(error)\n\t}\n\n\trender() {\n\t\tconst { error } = this.state\n\n\t\tif (error !== null) {\n\t\t\treturn this.props.fallback(error)\n\t\t}\n\n\t\treturn this.props.children\n\t}\n}\n","import { toDomPrecision } from '@tldraw/primitives'\nimport { track } from 'signia-react'\nimport { useApp } from '../../hooks'\n\nexport const Brush = track(function Brush() {\n\tconst app = useApp()\n\tconst brush = app.brush\n\n\tconst shouldDisplay = app.isIn('select.brushing')\n\n\tif (!brush || !shouldDisplay) return null\n\n\treturn (\n\t\t<rect\n\t\t\tclassName=\"rs-brush\"\n\t\t\twidth={toDomPrecision(Math.max(1, brush.w))}\n\t\t\theight={toDomPrecision(Math.max(1, brush.h))}\n\t\t\ttransform={`translate(${brush.x},${brush.y})`}\n\t\t/>\n\t)\n})\n","import { modulate } from '@tldraw/utils'\nimport { track } from 'signia-react'\nimport { GRID_STEPS } from '../../constants'\nimport { useApp } from '../../hooks'\n\nexport interface UiGridProps {\n\tsize: number\n}\n\nexport type UiGridComponent = (props: UiGridProps) => any | null\n\nexport const Grid = track(function Grid({ size }: UiGridProps) {\n\tconst app = useApp()\n\n\tconst { x, y, z } = app.camera\n\tconst isGridMode = app.isGridMode\n\n\tif (!isGridMode) return null\n\n\treturn (\n\t\t<svg className=\"tl-grid\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\">\n\t\t\t<defs>\n\t\t\t\t{GRID_STEPS.map(({ min, mid, step }, i) => (\n\t\t\t\t\t<GridLayer\n\t\t\t\t\t\tkey={`grid-layer-${i}`}\n\t\t\t\t\t\tmin={min}\n\t\t\t\t\t\tmid={mid}\n\t\t\t\t\t\tstep={step}\n\t\t\t\t\t\tx={x}\n\t\t\t\t\t\ty={y}\n\t\t\t\t\t\tz={z}\n\t\t\t\t\t\tsize={size}\n\t\t\t\t\t/>\n\t\t\t\t))}\n\t\t\t</defs>\n\t\t\t{GRID_STEPS.map(({ step }, i) => (\n\t\t\t\t<rect key={`grid-rect-${i}`} width=\"100%\" height=\"100%\" fill={`url(#grid-${step})`} />\n\t\t\t))}\n\t\t</svg>\n\t)\n})\n\nfunction GridLayer({\n\tstep,\n\tmin,\n\tmid,\n\tsize,\n\tx,\n\ty,\n\tz,\n}: {\n\tstep: number\n\tmin: number\n\tmid: number\n\tsize: number\n\tx: number\n\ty: number\n\tz: number\n}) {\n\tconst s = step * size * z\n\tconst xo = 0.5 + x * z\n\tconst yo = 0.5 + y * z\n\tconst gxo = xo > 0 ? xo % s : s + (xo % s)\n\tconst gyo = yo > 0 ? yo % s : s + (yo % s)\n\tconst opacity = z < mid ? modulate(z, [min, mid], [0, 1]) : 1\n\n\treturn (\n\t\t<pattern\n\t\t\tkey={`grid-pattern-${step}`}\n\t\t\tid={`grid-${step}`}\n\t\t\twidth={s}\n\t\t\theight={s}\n\t\t\tpatternUnits=\"userSpaceOnUse\"\n\t\t>\n\t\t\t<circle className={`tl-grid-dot`} cx={gxo} cy={gyo} r={1} opacity={opacity} />\n\t\t</pattern>\n\t)\n}\n","import { TLHandle, TLShapeId } from '@tldraw/tlschema'\nimport classNames from 'classnames'\nimport { useHandleEvents } from '../../hooks'\n\nexport interface UiHandleProps<H extends TLHandle = TLHandle> {\n\tid: TLShapeId\n\thandle: H\n}\n\nexport type UiHandleComponent<H extends TLHandle = TLHandle> = (\n\tprops: UiHandleProps<H>\n) => any | null\n\nexport function Handle<H extends TLHandle>({ id, handle }: UiHandleProps<H>) {\n\tconst events = useHandleEvents(id, handle.id)\n\n\tconst { x, y, type } = handle\n\n\treturn (\n\t\t<g\n\t\t\tclassName={classNames('rs-handle', { 'rs-handle-hint': type !== 'vertex' })}\n\t\t\taria-label=\"handle\"\n\t\t\ttransform={`translate(${x}, ${y})`}\n\t\t\t{...events}\n\t\t>\n\t\t\t<circle className=\"rs-handle-bg\" />\n\t\t\t<circle className=\"rs-handle-fg\" />\n\t\t</g>\n\t)\n}\n","import { Matrix2d } from '@tldraw/primitives'\nimport { TLHandle } from '@tldraw/tlschema'\nimport { track } from 'signia-react'\nimport { useApp } from '../../hooks'\nimport { Handle } from './Handle'\n\nconst MIN_DISTANCE = 48\n\nexport const HandlesContainer = track(function HandlesContainer() {\n\tconst app = useApp()\n\tconst zoom = app.zoomLevel\n\tconst isChangingStyle = app.isChangingStyle\n\n\tconst onlySelectedShape = app.onlySelectedShape\n\n\tconst shouldDisplayHandles =\n\t\tapp.isInAny('select.idle', 'select.pointing_handle') && !isChangingStyle && !app.isReadOnly\n\n\tif (!(onlySelectedShape && shouldDisplayHandles)) return null\n\n\tconst util = app.getShapeUtil(onlySelectedShape)\n\tconst handles = util.handles?.(onlySelectedShape)\n\n\tif (!handles) return null\n\n\tconst transform = app.getPageTransform(onlySelectedShape)\n\n\tif (!transform) return null\n\n\t// Don't display a temporary handle if the distance between it and its neighbors is too small.\n\tconst handlesToDisplay: TLHandle[] = []\n\n\tfor (let i = 0, handle = handles[i]; i < handles.length; i++, handle = handles[i]) {\n\t\tif (handle.type !== 'vertex') {\n\t\t\tconst prev = handles[i - 1]\n\t\t\tconst next = handles[i + 1]\n\t\t\tif (prev && next) {\n\t\t\t\tif (Math.hypot(prev.y - next.y, prev.x - next.x) < MIN_DISTANCE / zoom) {\n\t\t\t\t\tcontinue\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\thandlesToDisplay.push(handle)\n\t}\n\n\thandlesToDisplay.sort((a) => (a.type === 'vertex' ? 1 : -1))\n\n\treturn (\n\t\t<g transform={Matrix2d.toCssString(transform)}>\n\t\t\t{handlesToDisplay.map((handle) => {\n\t\t\t\treturn <Handle key={handle.id} id={onlySelectedShape.id} handle={handle} />\n\t\t\t})}\n\t\t</g>\n\t)\n})\n","import { Vec2dModel } from '@tldraw/tlschema'\nimport { memo } from 'react'\n\nexport interface UiCursorProps {\n\tpoint: Vec2dModel | null\n\tzoom: number\n\tcolor?: string\n}\n\nexport type UiCursorComponent = (props: UiCursorProps) => any | null\n\nconst _Cursor = ({ zoom, point, color }: UiCursorProps) => {\n\tif (!point) return null\n\n\treturn (\n\t\t<use\n\t\t\thref=\"#cursor\"\n\t\t\ttransform={`translate(${point.x}, ${point.y}) scale(${1 / zoom})`}\n\t\t\tcolor={color}\n\t\t/>\n\t)\n}\n\nexport const Cursor = memo(_Cursor)\n","import { Box2d, clamp, radiansToDegrees, Vec2d } from '@tldraw/primitives'\nimport { Vec2dModel } from '@tldraw/tlschema'\n\nexport interface UiCursorHintProps {\n\tpoint: Vec2dModel\n\tviewport: Box2d\n\tzoom: number\n\tcolor: string\n}\n\nexport const CursorHint = ({ zoom, point, color, viewport }: UiCursorHintProps) => {\n\tconst x = clamp(point.x, viewport.minX + 5 / zoom, viewport.maxX - 5 / zoom)\n\tconst y = clamp(point.y, viewport.minY + 5 / zoom, viewport.maxY - 5 / zoom)\n\n\tconst direction = radiansToDegrees(Vec2d.Angle(viewport.center, point))\n\n\treturn (\n\t\t<>\n\t\t\t<use\n\t\t\t\thref=\"#cursor_hint\"\n\t\t\t\ttransform={`translate(${x}, ${y}) scale(${1 / zoom}) rotate(${direction})`}\n\t\t\t\tcolor={color}\n\t\t\t/>\n\t\t</>\n\t)\n}\n","import { Matrix2d } from '@tldraw/primitives'\nimport { TLShape, TLShapeId } from '@tldraw/tlschema'\nimport classNames from 'classnames'\nimport * as React from 'react'\nimport {\n\t// @ts-expect-error 'private' export\n\tuseStateTracking,\n\tuseValue,\n} from 'signia-react'\n\nimport type { App } from '../../app/App'\nimport { TLShapeUtil } from '../../app/shapeutils'\nimport { useApp } from '../../hooks'\nimport { ErrorBoundary } from '../ErrorBoundary'\n\nclass ShapeWithPropsEquality {\n\tconstructor(public shape: TLShape | undefined) {}\n\tequals(other: ShapeWithPropsEquality) {\n\t\treturn this.shape?.props === other?.shape?.props\n\t}\n}\n\n// need an extra layer of indirection here to allow hooks to be used inside the indicator render\nconst EvenInnererIndicator = ({ shape, util }: { shape: TLShape; util: TLShapeUtil<any> }) => {\n\treturn useStateTracking('Indicator:', () => util.indicator(shape))\n}\n\nexport const InnerIndicator = ({ app, id }: { app: App; id: TLShapeId }) => {\n\tconst shape = useValue('shape', () => new ShapeWithPropsEquality(app.store.get(id)), [app, id])\n\tif (!shape.shape) return null\n\treturn (\n\t\t<ErrorBoundary\n\t\t\tfallback={IndicatorErrorFallback}\n\t\t\tonError={(error) =>\n\t\t\t\tapp.annotateError(error, { origin: 'react.shapeIndicator', willCrashApp: false })\n\t\t\t}\n\t\t>\n\t\t\t<EvenInnererIndicator shape={shape.shape} util={app.getShapeUtil(shape.shape)} />\n\t\t</ErrorBoundary>\n\t)\n}\n\nfunction IndicatorErrorFallback() {\n\treturn <circle cx={4} cy={4} r={8} strokeWidth=\"1\" stroke=\"red\" />\n}\n\nexport const ShapeIndicator = React.memo(function ShapeIndicator({\n\tid,\n\tisHinting,\n\tcolor,\n}: {\n\tid: TLShapeId\n\tisHinting?: boolean\n\tcolor?: string\n}) {\n\tconst app = useApp()\n\n\tconst transform = useValue(\n\t\t'transform',\n\t\t() => {\n\t\t\tconst pageTransform = app.getPageTransformById(id)\n\t\t\tif (!pageTransform) return ''\n\t\t\treturn Matrix2d.toCssString(pageTransform)\n\t\t},\n\t\t[app, id]\n\t)\n\n\treturn (\n\t\t<g\n\t\t\tclassName={classNames('rs-shape-indicator', {\n\t\t\t\t'rs-shape-indicator__hinting': isHinting,\n\t\t\t})}\n\t\t\ttransform={transform}\n\t\t\tstroke={color ?? 'var(--color-selected)'}\n\t\t>\n\t\t\t<InnerIndicator app={app} id={id} />\n\t\t</g>\n\t)\n})\n","import { Box2d, getStroke, toDomPrecision } from '@tldraw/primitives'\nimport { TLScribble, TLUserPresence } from '@tldraw/tlschema'\nimport React, { useMemo } from 'react'\nimport { track, useAtom } from 'signia-react'\nimport { useApp } from '../../hooks'\nimport { getSvgPathFromStroke } from '../../utils'\nimport { Cursor } from '../Cursor'\nimport { CursorHint } from '../CursorHint'\nimport { ShapeIndicator } from '../ShapeIndicator'\n\nexport const useActivePresences = () => {\n\tconst app = useApp()\n\tconst time = useAtom('time', Date.now())\n\n\tReact.useEffect(() => {\n\t\tconst interval = setInterval(() => time.set(Date.now()), 1000 * 5)\n\t\treturn () => clearInterval(interval)\n\t}, [time])\n\n\treturn useMemo(\n\t\t() =>\n\t\t\tapp.store.query.records('user_presence', () => ({\n\t\t\t\tlastActivityTimestamp: { gt: time.value - COLLABORATOR_INACTIVITY_TIMEOUT },\n\t\t\t\tuserId: { neq: app.userId },\n\t\t\t})),\n\t\t[app, time]\n\t)\n}\n\nexport const LiveCollaborators = track(function Collaborators() {\n\tconst app = useApp()\n\tconst { viewportPageBounds, zoomLevel } = app\n\tconst presences = useActivePresences()\n\n\treturn (\n\t\t<g>\n\t\t\t{presences.value.map((userPresence) => (\n\t\t\t\t<Collaborator\n\t\t\t\t\tkey={userPresence.id}\n\t\t\t\t\tpresence={userPresence}\n\t\t\t\t\tviewport={viewportPageBounds}\n\t\t\t\t\tzoom={zoomLevel}\n\t\t\t\t/>\n\t\t\t))}\n\t\t</g>\n\t)\n})\n\nconst COLLABORATOR_INACTIVITY_TIMEOUT = 1000 * 10\n\nconst Collaborator = track(function Collaborator({\n\tpresence,\n\tviewport,\n\tzoom,\n}: {\n\tpresence: TLUserPresence\n\tviewport: Box2d\n\tzoom: number\n}) {\n\tconst app = useApp()\n\n\tconst { userId, color, cursor, lastUsedInstanceId } = presence\n\tconst pageState = useMemo(\n\t\t() =>\n\t\t\tlastUsedInstanceId\n\t\t\t\t? app.store.query.record('instance_page_state', () => ({\n\t\t\t\t\t\tinstanceId: { eq: lastUsedInstanceId },\n\t\t\t\t\t\tpageId: { eq: app.currentPageId },\n\t\t\t\t  }))\n\t\t\t\t: null,\n\t\t[app, lastUsedInstanceId]\n\t)\n\n\tif (!lastUsedInstanceId || !pageState) return null\n\tconst instance = app.store.get(lastUsedInstanceId)\n\tif (!instance) return null\n\n\t// if the collaborator is on another page, ignore them\n\tif (instance.currentPageId !== app.currentPageId) return null\n\n\tif (!pageState.value) return null\n\n\tconst { brush, scribble } = instance\n\tconst { selectedIds } = pageState.value\n\n\t// Add a little padding to the top-left of the viewport\n\t// so that the cursor doesn't get cut off\n\tconst isCursorInViewport = !(\n\t\tcursor.x < viewport.minX - 12 / zoom ||\n\t\tcursor.y < viewport.minY - 16 / zoom ||\n\t\tcursor.x > viewport.maxX - 12 / zoom ||\n\t\tcursor.y > viewport.maxY - 16 / zoom\n\t)\n\n\treturn (\n\t\t<>\n\t\t\t{brush ? (\n\t\t\t\t<g\n\t\t\t\t\tkey={userId + '_brush'}\n\t\t\t\t\tclassName=\"rs-collaborator-brush\"\n\t\t\t\t\ttransform={`translate(${brush.x},${brush.y})`}\n\t\t\t\t>\n\t\t\t\t\t<rect\n\t\t\t\t\t\twidth={toDomPrecision(Math.max(1, brush.w))}\n\t\t\t\t\t\theight={toDomPrecision(Math.max(1, brush.h))}\n\t\t\t\t\t\tfill={color}\n\t\t\t\t\t\topacity={0.1}\n\t\t\t\t\t/>\n\t\t\t\t\t<rect\n\t\t\t\t\t\twidth={toDomPrecision(Math.max(1, brush.w))}\n\t\t\t\t\t\theight={toDomPrecision(Math.max(1, brush.h))}\n\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\tstroke={color}\n\t\t\t\t\t\topacity={0.1}\n\t\t\t\t\t/>\n\t\t\t\t</g>\n\t\t\t) : null}\n\t\t\t{isCursorInViewport ? (\n\t\t\t\t<Cursor key={userId + '_cursor'} point={cursor} color={color} zoom={zoom} />\n\t\t\t) : (\n\t\t\t\t<CursorHint\n\t\t\t\t\tkey={userId + '_cursor_hint'}\n\t\t\t\t\tpoint={cursor}\n\t\t\t\t\tcolor={color}\n\t\t\t\t\tzoom={zoom}\n\t\t\t\t\tviewport={viewport}\n\t\t\t\t/>\n\t\t\t)}\n\t\t\t{scribble ? (\n\t\t\t\t<CollaboratorScribble\n\t\t\t\t\tkey={userId + '_scribble'}\n\t\t\t\t\tscribble={scribble}\n\t\t\t\t\tcolor={color}\n\t\t\t\t\tzoom={zoom}\n\t\t\t\t/>\n\t\t\t) : null}\n\t\t\t{selectedIds.map((shapeId) => (\n\t\t\t\t<ShapeIndicator key={userId + '_' + shapeId} id={shapeId} color={color} />\n\t\t\t))}\n\t\t</>\n\t)\n})\n\nfunction CollaboratorScribble({\n\tscribble,\n\tcolor,\n\tzoom,\n}: {\n\tscribble: TLScribble\n\tcolor: string\n\tzoom: number\n}) {\n\tif (!scribble) return null\n\n\tconst bounds = Box2d.FromPoints(scribble.points)\n\n\tconst d = getSvgPathFromStroke(\n\t\tgetStroke(scribble.points, {\n\t\t\tsize: scribble.size / zoom,\n\t\t\tstart: { taper: true },\n\t\t\tlast: scribble.state === 'stopping' || (bounds.width < 128 && bounds.height < 128),\n\t\t})\n\t)\n\n\treturn <path className=\"tl-scribble\" d={d} fill={color} opacity={0.1} />\n}\n","import { EASINGS, getStroke } from '@tldraw/primitives'\nimport { track } from 'signia-react'\nimport { useApp } from '../../hooks'\nimport { getSvgPathFromStroke } from '../../utils'\n\nexport const Scribble = track(function Scribble() {\n\tconst app = useApp()\n\tconst scribble = app.scribble\n\tconst zoom = app.zoomLevel\n\n\tif (!scribble) return null\n\n\tconst d = getSvgPathFromStroke(\n\t\tgetStroke(scribble.points, {\n\t\t\tsize: scribble.size / zoom,\n\t\t\tstart: { taper: true, easing: EASINGS.linear },\n\t\t\tlast: false,\n\t\t\tsimulatePressure: false,\n\t\t})\n\t)\n\n\treturn (\n\t\t<path\n\t\t\tclassName=\"tl-scribble\"\n\t\t\td={d}\n\t\t\tfill={`var(--color-${scribble.color})`}\n\t\t\topacity={scribble.opacity}\n\t\t/>\n\t)\n})\n","import { Matrix2d, toDomPrecision } from '@tldraw/primitives'\nimport * as React from 'react'\nimport { track } from 'signia-react'\nimport { TLPointerEventInfo } from '../../app/types/event-types'\nimport { useApp } from '../../hooks'\nimport { getPointerInfo, releasePointerCapture, setPointerCapture } from '../../utils'\n\nexport const SelectionBg = track(function SelectionBg() {\n\tconst app = useApp()\n\n\tconst events = React.useMemo(() => {\n\t\tconst onPointerDown = (e: React.PointerEvent) => {\n\t\t\tif ((e as any).isKilled) return\n\n\t\t\tsetPointerCapture(e.currentTarget, e)\n\n\t\t\tconst info: TLPointerEventInfo = {\n\t\t\t\ttype: 'pointer',\n\t\t\t\ttarget: 'selection',\n\t\t\t\tname: 'pointer_down',\n\t\t\t\t...getPointerInfo(e, app.getContainer()),\n\t\t\t}\n\n\t\t\tapp.dispatch(info)\n\t\t}\n\n\t\tconst onPointerMove = (e: React.PointerEvent) => {\n\t\t\tif ((e as any).isKilled) return\n\n\t\t\tconst info: TLPointerEventInfo = {\n\t\t\t\ttype: 'pointer',\n\t\t\t\ttarget: 'selection',\n\t\t\t\tname: 'pointer_move',\n\t\t\t\t...getPointerInfo(e, app.getContainer()),\n\t\t\t}\n\n\t\t\tapp.dispatch(info)\n\t\t}\n\n\t\tconst onPointerUp = (e: React.PointerEvent) => {\n\t\t\tif ((e as any).isKilled) return\n\n\t\t\treleasePointerCapture(e.currentTarget, e)\n\n\t\t\tconst info: TLPointerEventInfo = {\n\t\t\t\ttype: 'pointer',\n\t\t\t\ttarget: 'selection',\n\t\t\t\tname: 'pointer_up',\n\t\t\t\t...getPointerInfo(e, app.getContainer()),\n\t\t\t}\n\n\t\t\tapp.dispatch(info)\n\t\t}\n\n\t\tconst onPointerEnter = (e: React.PointerEvent) => {\n\t\t\tif ((e as any).isKilled) return\n\n\t\t\tconst info: TLPointerEventInfo = {\n\t\t\t\ttype: 'pointer',\n\t\t\t\ttarget: 'selection',\n\t\t\t\tname: 'pointer_enter',\n\t\t\t\t...getPointerInfo(e, app.getContainer()),\n\t\t\t}\n\n\t\t\tapp.dispatch(info)\n\t\t}\n\n\t\tconst onPointerLeave = (e: React.PointerEvent) => {\n\t\t\tif ((e as any).isKilled) return\n\n\t\t\tconst info: TLPointerEventInfo = {\n\t\t\t\ttype: 'pointer',\n\t\t\t\ttarget: 'selection',\n\t\t\t\tname: 'pointer_leave',\n\t\t\t\t...getPointerInfo(e, app.getContainer()),\n\t\t\t}\n\n\t\t\tapp.dispatch(info)\n\t\t}\n\n\t\treturn {\n\t\t\tonPointerDown,\n\t\t\tonPointerMove,\n\t\t\tonPointerUp,\n\t\t\tonPointerEnter,\n\t\t\tonPointerLeave,\n\t\t}\n\t}, [app])\n\n\tconst { selectionBounds: bounds, selectedIds } = app\n\tif (!bounds) return null\n\n\tconst shouldDisplay = app.isInAny(\n\t\t'select.idle',\n\t\t'select.brushing',\n\t\t'select.scribble_brushing',\n\t\t'select.pointing_shape',\n\t\t'select.pointing_selection',\n\t\t'text.resizing'\n\t)\n\n\tif (selectedIds.length === 1) {\n\t\tconst shape = app.getShapeById(selectedIds[0])\n\t\tif (!shape) {\n\t\t\treturn null\n\t\t}\n\t\tconst util = app.getShapeUtil(shape)\n\t\tif (util.hideSelectionBoundsBg(shape)) {\n\t\t\treturn null\n\t\t}\n\t}\n\n\tconst transform = Matrix2d.toCssString(\n\t\tMatrix2d.Compose(\n\t\t\tMatrix2d.Translate(bounds.minX, bounds.minY),\n\t\t\tMatrix2d.Rotate(app.selectionRotation)\n\t\t)\n\t)\n\n\treturn (\n\t\t<div\n\t\t\tclassName=\"tlui-selection__bg\"\n\t\t\tdraggable={false}\n\t\t\tstyle={{\n\t\t\t\ttransform,\n\t\t\t\twidth: toDomPrecision(Math.max(1, bounds.width)),\n\t\t\t\theight: toDomPrecision(Math.max(1, bounds.height)),\n\t\t\t\tpointerEvents: shouldDisplay ? 'all' : 'none',\n\t\t\t\topacity: shouldDisplay ? 1 : 0,\n\t\t\t}}\n\t\t\t{...events}\n\t\t/>\n\t)\n})\n","import { useMemo } from 'react'\nimport { TLSelectionHandle } from '../app/types/selection-types'\nimport {\n\tgetPointerInfo,\n\tloopToHtmlElement,\n\treleasePointerCapture,\n\tsetPointerCapture,\n} from '../utils'\nimport { useApp } from './useApp'\n\nexport function useSelectionEvents(handle: TLSelectionHandle) {\n\tconst app = useApp()\n\n\tconst events = useMemo(\n\t\tfunction selectionEvents() {\n\t\t\tconst onPointerDown: React.PointerEventHandler = (e) => {\n\t\t\t\tif ((e as any).isKilled) return\n\t\t\t\tif (e.button !== 0) return\n\n\t\t\t\t// Because the events are probably set on SVG elements,\n\t\t\t\t// we need to instead place pointer capture on the first HTML\n\t\t\t\t// element above the event's target; and set a listener to\n\t\t\t\t// remove pointer capture when the pointer is released.\n\n\t\t\t\tconst elm = loopToHtmlElement(e.currentTarget)\n\n\t\t\t\tfunction releaseCapture() {\n\t\t\t\t\telm.removeEventListener('pointerup', releaseCapture)\n\t\t\t\t\treleasePointerCapture(elm, e)\n\t\t\t\t}\n\n\t\t\t\tsetPointerCapture(elm, e)\n\t\t\t\telm.addEventListener('pointerup', releaseCapture)\n\n\t\t\t\tapp.dispatch({\n\t\t\t\t\tname: 'pointer_down',\n\t\t\t\t\ttype: 'pointer',\n\t\t\t\t\ttarget: 'selection',\n\t\t\t\t\thandle,\n\t\t\t\t\t...getPointerInfo(e, app.getContainer()),\n\t\t\t\t})\n\t\t\t\te.stopPropagation()\n\t\t\t}\n\n\t\t\t// Track the last screen point\n\t\t\tlet lastX: number, lastY: number\n\n\t\t\tfunction onPointerMove(e: React.PointerEvent) {\n\t\t\t\tif ((e as any).isKilled) return\n\t\t\t\tif (e.button !== 0) return\n\t\t\t\tif (e.clientX === lastX && e.clientY === lastY) return\n\t\t\t\tlastX = e.clientX\n\t\t\t\tlastY = e.clientY\n\n\t\t\t\tapp.dispatch({\n\t\t\t\t\tname: 'pointer_move',\n\t\t\t\t\ttype: 'pointer',\n\t\t\t\t\ttarget: 'selection',\n\t\t\t\t\thandle,\n\t\t\t\t\t...getPointerInfo(e, app.getContainer()),\n\t\t\t\t})\n\t\t\t}\n\n\t\t\tconst onPointerUp: React.PointerEventHandler = (e) => {\n\t\t\t\tif ((e as any).isKilled) return\n\t\t\t\tif (e.button !== 0) return\n\n\t\t\t\tapp.dispatch({\n\t\t\t\t\tname: 'pointer_up',\n\t\t\t\t\ttype: 'pointer',\n\t\t\t\t\ttarget: 'selection',\n\t\t\t\t\thandle,\n\t\t\t\t\t...getPointerInfo(e, app.getContainer()),\n\t\t\t\t})\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tonPointerDown,\n\t\t\t\tonPointerMove,\n\t\t\t\tonPointerUp,\n\t\t\t}\n\t\t},\n\t\t[app, handle]\n\t)\n\n\treturn events\n}\n","import classNames from 'classnames'\nimport { useSelectionEvents } from '../../../hooks/useSelectionEvents'\n\ninterface RotateHandleProps {\n\tcx: number\n\tcy: number\n\tsize: number\n\tisHidden: boolean\n\t'data-wd'?: string\n}\n\nconst SQUARE_ROOT_PI = Math.sqrt(Math.PI)\n\nexport const MobileRotateHandle = function RotateHandle({\n\tcx,\n\tcy,\n\tsize,\n\tisHidden,\n\t'data-wd': dataWd,\n}: RotateHandleProps) {\n\tconst events = useSelectionEvents('mobile_rotate')\n\n\treturn (\n\t\t<g>\n\t\t\t<circle\n\t\t\t\tdata-wd={dataWd}\n\t\t\t\tclassName={classNames('rs-transparent', 'rs-mobile-rotate__bg', { 'rs-hidden': isHidden })}\n\t\t\t\tcx={cx}\n\t\t\t\tcy={cy}\n\t\t\t\t{...events}\n\t\t\t/>\n\t\t\t<circle\n\t\t\t\tclassName={classNames('rs-mobile-rotate__fg', { 'rs-hidden': isHidden })}\n\t\t\t\tcx={cx}\n\t\t\t\tcy={cy}\n\t\t\t\tr={size / SQUARE_ROOT_PI}\n\t\t\t/>\n\t\t</g>\n\t)\n}\n","import { RotateCorner, toDomPrecision } from '@tldraw/primitives'\nimport classNames from 'classnames'\nimport { useSelectionEvents } from '../../../hooks/useSelectionEvents'\n\ninterface RotateCornerHandleProps {\n\tcx: number\n\tcy: number\n\ttargetSize: number\n\tcorner: RotateCorner\n\tcursor?: string\n\tisHidden: boolean\n\t'data-wd'?: string\n}\n\nexport const RotateCornerHandle = function RotateCornerHandle({\n\tcx,\n\tcy,\n\ttargetSize,\n\tcorner,\n\tcursor,\n\tisHidden,\n\t'data-wd': dataWd,\n}: RotateCornerHandleProps) {\n\tconst events = useSelectionEvents(corner)\n\treturn (\n\t\t<rect\n\t\t\tclassName={classNames('rs-transparent', 'rs-rotate-corner', { 'rs-hidden': isHidden })}\n\t\t\tdata-wd={dataWd}\n\t\t\taria-label={`${corner} target`}\n\t\t\tx={toDomPrecision(cx - targetSize * 3)}\n\t\t\ty={toDomPrecision(cy - targetSize * 3)}\n\t\t\twidth={toDomPrecision(Math.max(1, targetSize * 3))}\n\t\t\theight={toDomPrecision(Math.max(1, targetSize * 3))}\n\t\t\tcursor={cursor}\n\t\t\t{...events}\n\t\t/>\n\t)\n}\n","import { Matrix2d, toDomPrecision } from '@tldraw/primitives'\nimport classNames from 'classnames'\nimport { track, useValue } from 'signia-react'\nimport { getCursor, useApp } from '../../hooks'\nimport { useSelectionEvents } from '../../hooks/useSelectionEvents'\nimport { MobileRotateHandle, RotateCornerHandle } from './handles'\n\nexport const SelectionFg = track(function SelectionFg() {\n\tconst app = useApp()\n\tconst isReadonlyMode = useValue('isReadOnlyMode', () => app.isReadOnly, [app])\n\n\tconst topEvents = useSelectionEvents('top')\n\tconst rightEvents = useSelectionEvents('right')\n\tconst bottomEvents = useSelectionEvents('bottom')\n\tconst leftEvents = useSelectionEvents('left')\n\tconst topLeftEvents = useSelectionEvents('top_left')\n\tconst topRightEvents = useSelectionEvents('top_right')\n\tconst bottomRightEvents = useSelectionEvents('bottom_right')\n\tconst bottomLeftEvents = useSelectionEvents('bottom_left')\n\n\tconst isDefaultCursor = !app.isMenuOpen && app.cursor.type === 'default'\n\tconst isCoarsePointer = app.isCoarsePointer\n\n\tconst bounds = app.selectionBounds\n\n\tif (!bounds) return null\n\n\tconst shapes = app.selectedShapes\n\tconst rotation = app.selectionRotation\n\tconst isChangingStyles = app.isChangingStyle\n\n\tconst width = Math.max(1, bounds.width)\n\tconst height = Math.max(1, bounds.height)\n\n\tconst zoom = app.zoomLevel\n\tconst size = 8 / zoom\n\n\tconst isTinyX = width < size * 2\n\tconst isTinyY = height < size * 2\n\n\tconst isSmallX = width < size * 4\n\tconst isSmallY = height < size * 4\n\n\tconst mobileHandleMultiplier = isCoarsePointer ? 1.75 : 1\n\tconst targetSize = (6 / zoom) * mobileHandleMultiplier\n\n\tconst targetSizeX = (isSmallX ? targetSize / 2 : targetSize) * (mobileHandleMultiplier * 0.75)\n\tconst targetSizeY = (isSmallY ? targetSize / 2 : targetSize) * (mobileHandleMultiplier * 0.75)\n\n\tconst transform = Matrix2d.toCssString(\n\t\tMatrix2d.Compose(\n\t\t\tMatrix2d.Translate(bounds.minX, bounds.minY),\n\t\t\tMatrix2d.Rotate(app.selectionRotation)\n\t\t)\n\t)\n\n\tconst onlyShape = shapes.length === 1 ? shapes[0] : null\n\n\tconst showSelectionBounds =\n\t\t(onlyShape ? !app.getShapeUtil(onlyShape).hideSelectionBoundsFg(onlyShape) : true) &&\n\t\t!isChangingStyles\n\n\tconst shouldDisplayBox =\n\t\t(app.isInAny(\n\t\t\t'select.idle',\n\t\t\t'select.brushing',\n\t\t\t'select.editing_shape',\n\t\t\t'select.scribble_brushing',\n\t\t\t'select.pointing_canvas',\n\t\t\t'select.pointing_selection',\n\t\t\t'select.pointing_shape'\n\t\t) ||\n\t\t\t(app.isIn('select.resizing') && onlyShape && shapes[0].type === 'text') ||\n\t\t\t(app.isIn('select') && app.inputs.ctrlKey)) &&\n\t\tshowSelectionBounds\n\n\tconst shouldDisplayControls =\n\t\tapp.isInAny(\n\t\t\t'select.idle',\n\t\t\t'select.pointing_selection',\n\t\t\t'select.pointing_shape',\n\t\t\t'select.pointing_selection'\n\t\t) &&\n\t\t!isChangingStyles &&\n\t\t!isReadonlyMode\n\n\tconst showCornerRotateHandles =\n\t\t!isCoarsePointer &&\n\t\t!(isTinyX || isTinyY) &&\n\t\tshouldDisplayControls &&\n\t\t(onlyShape ? !app.getShapeUtil(onlyShape).hideRotateHandle(onlyShape) : true)\n\n\tconst showMobileRotateHandle =\n\t\tisCoarsePointer &&\n\t\t(!isSmallX || !isSmallY) &&\n\t\tshouldDisplayControls &&\n\t\t(onlyShape ? !app.getShapeUtil(onlyShape).hideRotateHandle(onlyShape) : true)\n\n\tconst showResizeHandles =\n\t\tshouldDisplayControls &&\n\t\t(onlyShape\n\t\t\t? app.getShapeUtil(onlyShape).canResize(onlyShape) &&\n\t\t\t  !app.getShapeUtil(onlyShape).hideResizeHandles(onlyShape)\n\t\t\t: true)\n\n\tconst hideAlternateCornerHandles = isTinyX || isTinyY\n\tconst showOnlyOneHandle = isTinyX && isTinyY\n\n\tconst hideRotateCornerHandles = !shouldDisplayControls || !showCornerRotateHandles\n\tconst hideMobileRotateHandle = !shouldDisplayControls || !showMobileRotateHandle\n\tconst hideTopLeftCorner = !shouldDisplayControls || !showResizeHandles\n\tconst hideTopRightCorner =\n\t\t!shouldDisplayControls || !showResizeHandles || hideAlternateCornerHandles\n\tconst hideBottomLeftCorner =\n\t\t!shouldDisplayControls || !showResizeHandles || hideAlternateCornerHandles\n\tconst hideBottomRightCorner = !shouldDisplayControls || !showResizeHandles || showOnlyOneHandle\n\n\tlet hideEdgeTargetsDueToCoarsePointer = isCoarsePointer\n\n\tif (\n\t\thideEdgeTargetsDueToCoarsePointer &&\n\t\tshapes.every((shape) => app.getShapeUtil(shape).isAspectRatioLocked(shape))\n\t) {\n\t\thideEdgeTargetsDueToCoarsePointer = false\n\t}\n\n\tconst hideEdgeTargets =\n\t\t!shouldDisplayControls ||\n\t\t!showResizeHandles ||\n\t\thideAlternateCornerHandles ||\n\t\tshowOnlyOneHandle ||\n\t\thideEdgeTargetsDueToCoarsePointer\n\n\treturn (\n\t\t<g transform={transform}>\n\t\t\t{shouldDisplayBox && (\n\t\t\t\t<rect\n\t\t\t\t\tclassName=\"tlui-selection__fg-outline\"\n\t\t\t\t\twidth={toDomPrecision(width)}\n\t\t\t\t\theight={toDomPrecision(height)}\n\t\t\t\t/>\n\t\t\t)}\n\n\t\t\t<g>\n\t\t\t\t<g pointerEvents=\"all\">\n\t\t\t\t\t<>\n\t\t\t\t\t\t<RotateCornerHandle\n\t\t\t\t\t\t\tdata-wd=\"selection.rotate.top-left\"\n\t\t\t\t\t\t\tcx={0}\n\t\t\t\t\t\t\tcy={0}\n\t\t\t\t\t\t\ttargetSize={targetSize}\n\t\t\t\t\t\t\tcorner=\"top_left_rotate\"\n\t\t\t\t\t\t\tcursor={isDefaultCursor ? getCursor('nwse-rotate', rotation) : undefined}\n\t\t\t\t\t\t\tisHidden={hideRotateCornerHandles}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<RotateCornerHandle\n\t\t\t\t\t\t\tdata-wd=\"selection.rotate.top-right\"\n\t\t\t\t\t\t\tcx={width + targetSize * 3}\n\t\t\t\t\t\t\tcy={0}\n\t\t\t\t\t\t\ttargetSize={targetSize}\n\t\t\t\t\t\t\tcorner=\"top_right_rotate\"\n\t\t\t\t\t\t\tcursor={isDefaultCursor ? getCursor('nesw-rotate', rotation) : undefined}\n\t\t\t\t\t\t\tisHidden={hideRotateCornerHandles}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<RotateCornerHandle\n\t\t\t\t\t\t\tdata-wd=\"selection.rotate.bottom-left\"\n\t\t\t\t\t\t\tcx={0}\n\t\t\t\t\t\t\tcy={height + targetSize * 3}\n\t\t\t\t\t\t\ttargetSize={targetSize}\n\t\t\t\t\t\t\tcorner=\"bottom_left_rotate\"\n\t\t\t\t\t\t\tcursor={isDefaultCursor ? getCursor('swne-rotate', rotation) : undefined}\n\t\t\t\t\t\t\tisHidden={hideRotateCornerHandles}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<RotateCornerHandle\n\t\t\t\t\t\t\tdata-wd=\"selection.rotate.bottom-right\"\n\t\t\t\t\t\t\tcx={width + targetSize * 3}\n\t\t\t\t\t\t\tcy={height + targetSize * 3}\n\t\t\t\t\t\t\ttargetSize={targetSize}\n\t\t\t\t\t\t\tcorner=\"bottom_right_rotate\"\n\t\t\t\t\t\t\tcursor={isDefaultCursor ? getCursor('senw-rotate', rotation) : undefined}\n\t\t\t\t\t\t\tisHidden={hideRotateCornerHandles}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</>\n\t\t\t\t</g>\n\t\t\t\t<MobileRotateHandle\n\t\t\t\t\tdata-wd=\"selection.rotate.mobile\"\n\t\t\t\t\tcx={isSmallX ? -targetSize * 1.5 : width / 2}\n\t\t\t\t\tcy={isSmallX ? height / 2 : -targetSize * 1.5}\n\t\t\t\t\tsize={size}\n\t\t\t\t\tisHidden={hideMobileRotateHandle}\n\t\t\t\t/>\n\t\t\t\t<g pointerEvents=\"all\">\n\t\t\t\t\t{/* Edges Targets */}\n\t\t\t\t\t<rect\n\t\t\t\t\t\tclassName={classNames('rs-transparent', {\n\t\t\t\t\t\t\t'rs-hidden': hideEdgeTargets,\n\t\t\t\t\t\t})}\n\t\t\t\t\t\tdata-wd=\"selection.resize.top\"\n\t\t\t\t\t\taria-label=\"top target\"\n\t\t\t\t\t\tx={0}\n\t\t\t\t\t\ty={toDomPrecision(0 - (isSmallY ? targetSizeY * 2 : targetSizeY))}\n\t\t\t\t\t\twidth={toDomPrecision(Math.max(1, width))}\n\t\t\t\t\t\theight={toDomPrecision(Math.max(1, targetSizeY * 2))}\n\t\t\t\t\t\tstyle={isDefaultCursor ? { cursor: getCursor('ns-resize', rotation) } : undefined}\n\t\t\t\t\t\t{...topEvents}\n\t\t\t\t\t/>\n\t\t\t\t\t<rect\n\t\t\t\t\t\tclassName={classNames('rs-transparent', {\n\t\t\t\t\t\t\t'rs-hidden': hideEdgeTargets,\n\t\t\t\t\t\t})}\n\t\t\t\t\t\tdata-wd=\"selection.resize.right\"\n\t\t\t\t\t\taria-label=\"right target\"\n\t\t\t\t\t\tx={toDomPrecision(width - (isSmallX ? 0 : targetSizeX))}\n\t\t\t\t\t\ty={0}\n\t\t\t\t\t\theight={toDomPrecision(Math.max(1, height))}\n\t\t\t\t\t\twidth={toDomPrecision(Math.max(1, targetSizeX * 2))}\n\t\t\t\t\t\tstyle={isDefaultCursor ? { cursor: getCursor('ew-resize', rotation) } : undefined}\n\t\t\t\t\t\t{...rightEvents}\n\t\t\t\t\t/>\n\t\t\t\t\t<rect\n\t\t\t\t\t\tclassName={classNames('rs-transparent', {\n\t\t\t\t\t\t\t'rs-hidden': hideEdgeTargets,\n\t\t\t\t\t\t})}\n\t\t\t\t\t\tdata-wd=\"selection.resize.bottom\"\n\t\t\t\t\t\taria-label=\"bottom target\"\n\t\t\t\t\t\tx={0}\n\t\t\t\t\t\ty={toDomPrecision(height - (isSmallY ? 0 : targetSizeY))}\n\t\t\t\t\t\twidth={toDomPrecision(Math.max(1, width))}\n\t\t\t\t\t\theight={toDomPrecision(Math.max(1, targetSizeY * 2))}\n\t\t\t\t\t\tstyle={isDefaultCursor ? { cursor: getCursor('ns-resize', rotation) } : undefined}\n\t\t\t\t\t\t{...bottomEvents}\n\t\t\t\t\t/>\n\t\t\t\t\t<rect\n\t\t\t\t\t\tclassName={classNames('rs-transparent', {\n\t\t\t\t\t\t\t'rs-hidden': hideEdgeTargets,\n\t\t\t\t\t\t})}\n\t\t\t\t\t\tdata-wd=\"selection.resize.left\"\n\t\t\t\t\t\taria-label=\"left target\"\n\t\t\t\t\t\tx={toDomPrecision(0 - (isSmallX ? targetSizeX * 2 : targetSizeX))}\n\t\t\t\t\t\ty={0}\n\t\t\t\t\t\theight={toDomPrecision(Math.max(1, height))}\n\t\t\t\t\t\twidth={toDomPrecision(Math.max(1, targetSizeX * 2))}\n\t\t\t\t\t\tstyle={isDefaultCursor ? { cursor: getCursor('ew-resize', rotation) } : undefined}\n\t\t\t\t\t\t{...leftEvents}\n\t\t\t\t\t/>\n\t\t\t\t\t{/* Corner Targets */}\n\t\t\t\t\t<rect\n\t\t\t\t\t\tclassName={classNames('rs-transparent', {\n\t\t\t\t\t\t\t'rs-hidden': hideTopLeftCorner,\n\t\t\t\t\t\t})}\n\t\t\t\t\t\tdata-wd=\"selection.resize.top-left\"\n\t\t\t\t\t\taria-label=\"top-left target\"\n\t\t\t\t\t\tx={toDomPrecision(0 - (isSmallX ? targetSizeX * 2 : targetSizeX * 1.5))}\n\t\t\t\t\t\ty={toDomPrecision(0 - (isSmallY ? targetSizeY * 2 : targetSizeY * 1.5))}\n\t\t\t\t\t\twidth={toDomPrecision(targetSizeX * 3)}\n\t\t\t\t\t\theight={toDomPrecision(targetSizeY * 3)}\n\t\t\t\t\t\tstyle={isDefaultCursor ? { cursor: getCursor('nwse-resize', rotation) } : undefined}\n\t\t\t\t\t\t{...topLeftEvents}\n\t\t\t\t\t/>\n\t\t\t\t\t<rect\n\t\t\t\t\t\tclassName={classNames('rs-transparent', {\n\t\t\t\t\t\t\t'rs-hidden': hideTopRightCorner,\n\t\t\t\t\t\t})}\n\t\t\t\t\t\tdata-wd=\"selection.resize.top-right\"\n\t\t\t\t\t\taria-label=\"top-right target\"\n\t\t\t\t\t\tx={toDomPrecision(width - (isSmallX ? 0 : targetSizeX * 1.5))}\n\t\t\t\t\t\ty={toDomPrecision(0 - (isSmallY ? targetSizeY * 2 : targetSizeY * 1.5))}\n\t\t\t\t\t\twidth={toDomPrecision(targetSizeX * 3)}\n\t\t\t\t\t\theight={toDomPrecision(targetSizeY * 3)}\n\t\t\t\t\t\tstyle={isDefaultCursor ? { cursor: getCursor('nesw-resize', rotation) } : undefined}\n\t\t\t\t\t\t{...topRightEvents}\n\t\t\t\t\t/>\n\t\t\t\t\t<rect\n\t\t\t\t\t\tclassName={classNames('rs-transparent', {\n\t\t\t\t\t\t\t'rs-hidden': hideBottomRightCorner,\n\t\t\t\t\t\t})}\n\t\t\t\t\t\tdata-wd=\"selection.resize.bottom-right\"\n\t\t\t\t\t\taria-label=\"bottom-right target\"\n\t\t\t\t\t\tx={toDomPrecision(width - (isSmallX ? targetSizeX : targetSizeX * 1.5))}\n\t\t\t\t\t\ty={toDomPrecision(height - (isSmallY ? targetSizeY : targetSizeY * 1.5))}\n\t\t\t\t\t\twidth={toDomPrecision(targetSizeX * 3)}\n\t\t\t\t\t\theight={toDomPrecision(targetSizeY * 3)}\n\t\t\t\t\t\tstyle={isDefaultCursor ? { cursor: getCursor('nwse-resize', rotation) } : undefined}\n\t\t\t\t\t\t{...bottomRightEvents}\n\t\t\t\t\t/>\n\t\t\t\t\t<rect\n\t\t\t\t\t\tclassName={classNames('rs-transparent', {\n\t\t\t\t\t\t\t'rs-hidden': hideBottomLeftCorner,\n\t\t\t\t\t\t})}\n\t\t\t\t\t\tdata-wd=\"selection.resize.bottom-left\"\n\t\t\t\t\t\taria-label=\"bottom-left target\"\n\t\t\t\t\t\tx={toDomPrecision(0 - (isSmallX ? targetSizeX * 3 : targetSizeX * 1.5))}\n\t\t\t\t\t\ty={toDomPrecision(height - (isSmallY ? 0 : targetSizeY * 1.5))}\n\t\t\t\t\t\twidth={toDomPrecision(targetSizeX * 3)}\n\t\t\t\t\t\theight={toDomPrecision(targetSizeY * 3)}\n\t\t\t\t\t\tstyle={isDefaultCursor ? { cursor: getCursor('nesw-resize', rotation) } : undefined}\n\t\t\t\t\t\t{...bottomLeftEvents}\n\t\t\t\t\t/>\n\t\t\t\t\t{/* Handles */}\n\t\t\t\t\t<rect\n\t\t\t\t\t\tdata-wd=\"selection.resize.top-left\"\n\t\t\t\t\t\tclassName={classNames('rs-corner-handle', {\n\t\t\t\t\t\t\t'rs-hidden': hideTopLeftCorner,\n\t\t\t\t\t\t})}\n\t\t\t\t\t\taria-label=\"top_left handle\"\n\t\t\t\t\t\tx={toDomPrecision(0 - size / 2)}\n\t\t\t\t\t\ty={toDomPrecision(0 - size / 2)}\n\t\t\t\t\t\twidth={toDomPrecision(size)}\n\t\t\t\t\t\theight={toDomPrecision(size)}\n\t\t\t\t\t/>\n\t\t\t\t\t<rect\n\t\t\t\t\t\tdata-wd=\"selection.resize.top-right\"\n\t\t\t\t\t\tclassName={classNames('rs-corner-handle', {\n\t\t\t\t\t\t\t'rs-hidden': hideTopRightCorner,\n\t\t\t\t\t\t})}\n\t\t\t\t\t\taria-label=\"top_right handle\"\n\t\t\t\t\t\tx={toDomPrecision(width - size / 2)}\n\t\t\t\t\t\ty={toDomPrecision(0 - size / 2)}\n\t\t\t\t\t\twidth={toDomPrecision(size)}\n\t\t\t\t\t\theight={toDomPrecision(size)}\n\t\t\t\t\t/>\n\t\t\t\t\t<rect\n\t\t\t\t\t\tdata-wd=\"selection.resize.bottom-right\"\n\t\t\t\t\t\tclassName={classNames('rs-corner-handle', {\n\t\t\t\t\t\t\t'rs-hidden': hideBottomRightCorner,\n\t\t\t\t\t\t})}\n\t\t\t\t\t\taria-label=\"bottom_right handle\"\n\t\t\t\t\t\tx={toDomPrecision(width - size / 2)}\n\t\t\t\t\t\ty={toDomPrecision(height - size / 2)}\n\t\t\t\t\t\twidth={toDomPrecision(size)}\n\t\t\t\t\t\theight={toDomPrecision(size)}\n\t\t\t\t\t/>\n\t\t\t\t\t<rect\n\t\t\t\t\t\tdata-wd=\"selection.resize.bottom-left\"\n\t\t\t\t\t\tclassName={classNames('rs-corner-handle', {\n\t\t\t\t\t\t\t'rs-hidden': hideBottomLeftCorner,\n\t\t\t\t\t\t})}\n\t\t\t\t\t\taria-label=\"bottom_left handle\"\n\t\t\t\t\t\tx={toDomPrecision(0 - size / 2)}\n\t\t\t\t\t\ty={toDomPrecision(height - size / 2)}\n\t\t\t\t\t\twidth={toDomPrecision(size)}\n\t\t\t\t\t\theight={toDomPrecision(size)}\n\t\t\t\t\t/>\n\t\t\t\t</g>\n\t\t\t</g>\n\t\t</g>\n\t)\n})\n","export function ShapeErrorFallback() {\n\treturn <div className=\"rs-shape-error-boundary\" />\n}\n","import { Matrix2d } from '@tldraw/primitives'\nimport { TLShape, TLShapeId } from '@tldraw/tlschema'\nimport * as React from 'react'\nimport {\n\ttrack,\n\t// @ts-expect-error 'private' export\n\tuseStateTracking,\n} from 'signia-react'\nimport { TLShapeUtil } from '../../app/shapeutils'\nimport { useApp, useQuickReactor, useShapeEvents } from '../../hooks'\nimport { ErrorBoundary } from '../ErrorBoundary'\nimport { ShapeErrorFallback } from '../ErrorBoundary/ShapeErrorFallback'\n\n/*\nThis component renders shapes on the canvas. There are two stages: positioning\nand styling the shape's container using CSS, and then rendering the shape's \nJSX using its shape util's render method. Rendering the \"inside\" of a shape is\nmore expensive than positioning it or changing its color, so we use React.memo\nto wrap the inner shape and only re-render it when the shape's props change. \n\nThe shape also receives props for its index and opacity. The index is used to\ndetermine the z-index of the shape, and the opacity is used to set the shape's\nopacity based on its own opacity and that of its parent's.\n*/\nexport const Shape = track(function Shape({\n\tid,\n\tindex,\n\topacity,\n\tisCulled,\n}: {\n\tid: TLShapeId\n\tindex: number\n\topacity: number\n\tisCulled: boolean\n}) {\n\tconst app = useApp()\n\n\tconst events = useShapeEvents(id)\n\n\tconst rContainer = React.useRef<HTMLDivElement>(null)\n\n\tuseQuickReactor(\n\t\t'set shape container transform position',\n\t\t() => {\n\t\t\tconst elm = rContainer.current\n\t\t\tif (!elm) return\n\n\t\t\tconst shape = app.getShapeById(id)\n\t\t\tconst pageTransform = app.getPageTransformById(id)\n\n\t\t\tif (!shape || !pageTransform) return null\n\n\t\t\tconst transform = Matrix2d.toCssString(pageTransform)\n\t\t\telm.style.setProperty('transform', transform)\n\t\t},\n\t\t[app]\n\t)\n\n\tuseQuickReactor(\n\t\t'set shape container clip path / color',\n\t\t() => {\n\t\t\tconst elm = rContainer.current\n\t\t\tconst shape = app.getShapeById(id)\n\t\t\tif (!elm) return\n\t\t\tif (!shape) return null\n\n\t\t\tconst clipPath = app.getClipPathById(id)\n\t\t\telm.style.setProperty('clip-path', clipPath ?? 'none')\n\t\t\tif ('color' in shape.props) {\n\t\t\t\telm.style.setProperty('color', app.getCssColor(shape.props.color))\n\t\t\t}\n\t\t},\n\t\t[app]\n\t)\n\n\tuseQuickReactor(\n\t\t'set shape height and width',\n\t\t() => {\n\t\t\tconst elm = rContainer.current\n\t\t\tconst shape = app.getShapeById(id)\n\t\t\tif (!elm) return\n\t\t\tif (!shape) return null\n\n\t\t\tconst util = app.getShapeUtil(shape)\n\t\t\tconst bounds = util.bounds(shape)\n\t\t\telm.style.setProperty('width', Math.ceil(bounds.width) + 'px')\n\t\t\telm.style.setProperty('height', Math.ceil(bounds.height) + 'px')\n\t\t},\n\t\t[app]\n\t)\n\n\t// Set the opacity of the container when the opacity changes\n\tReact.useLayoutEffect(() => {\n\t\tconst elm = rContainer.current\n\t\tif (!elm) return\n\t\telm.style.setProperty('opacity', opacity + '')\n\t\telm.style.setProperty('z-index', index + '')\n\t}, [opacity, index])\n\n\tconst shape = app.getShapeById(id)\n\n\tif (!shape) return null\n\n\tconst util = app.getShapeUtil(shape)\n\n\treturn (\n\t\t<div\n\t\t\tkey={id}\n\t\t\tref={rContainer}\n\t\t\tclassName=\"rs-shape\"\n\t\t\tdata-shape-type={shape.type}\n\t\t\tdraggable={false}\n\t\t\tonPointerDown={events.onPointerDown}\n\t\t\tonPointerMove={events.onPointerMove}\n\t\t\tonPointerUp={events.onPointerUp}\n\t\t\tonPointerEnter={events.onPointerEnter}\n\t\t\tonPointerLeave={events.onPointerLeave}\n\t\t>\n\t\t\t{isCulled && util.canUnmount(shape) ? (\n\t\t\t\t<CulledShape shape={shape} util={util} />\n\t\t\t) : (\n\t\t\t\t<ErrorBoundary\n\t\t\t\t\tfallback={ShapeErrorFallback}\n\t\t\t\t\tonError={(error) =>\n\t\t\t\t\t\tapp.annotateError(error, { origin: 'react.shape', willCrashApp: false })\n\t\t\t\t\t}\n\t\t\t\t>\n\t\t\t\t\t{' '}\n\t\t\t\t\t<InnerShape shape={shape} util={util} />\n\t\t\t\t</ErrorBoundary>\n\t\t\t)}\n\t\t</div>\n\t)\n})\n\nconst InnerShape = React.memo(\n\tfunction InnerShape<T extends TLShape>({ shape, util }: { shape: T; util: TLShapeUtil<T> }) {\n\t\treturn useStateTracking('InnerShape:' + util.type, () => util.render(shape))\n\t},\n\t(prev, next) => prev.shape.props === next.shape.props\n)\n\nconst CulledShape = React.memo(\n\tfunction CulledShap<T extends TLShape>({ shape, util }: { shape: T; util: TLShapeUtil<T> }) {\n\t\tconst bounds = util.bounds(shape)\n\t\treturn (\n\t\t\t<div\n\t\t\t\tclassName=\"rs-shape__culled\"\n\t\t\t\tstyle={{\n\t\t\t\t\ttransform: `translate(${bounds.minX}px, ${bounds.minY}px)`,\n\t\t\t\t\twidth: bounds.width,\n\t\t\t\t\theight: bounds.height,\n\t\t\t\t}}\n\t\t\t/>\n\t\t)\n\t},\n\t() => true\n)\n","import { rangeIntersection } from '@tldraw/primitives'\nimport * as React from 'react'\nimport { track } from 'signia-react'\nimport { GapsSnapLine, PointsSnapLine, SnapLine } from '../../app/managers/SnapManager'\nimport { useApp } from '../../hooks'\n\ninterface TLSnapLineProps {\n\tline: SnapLine\n\tzoom: number\n}\n\nfunction PointsSnapLine({ points, zoom }: { zoom: number } & PointsSnapLine) {\n\tconst l = 2.5 / zoom\n\n\tconst minX = points.reduce((acc, p) => Math.min(acc, p.x), Infinity)\n\tconst maxX = points.reduce((acc, p) => Math.max(acc, p.x), -Infinity)\n\tconst minY = points.reduce((acc, p) => Math.min(acc, p.y), Infinity)\n\tconst maxY = points.reduce((acc, p) => Math.max(acc, p.y), -Infinity)\n\n\tconst useNWtoSEdireciton = points.some((p) => p.x === minX && p.y === minY)\n\tlet firstX: number, firstY: number, secondX: number, secondY: number\n\tif (useNWtoSEdireciton) {\n\t\tfirstX = minX\n\t\tfirstY = minY\n\t\tsecondX = maxX\n\t\tsecondY = maxY\n\t} else {\n\t\tfirstX = minX\n\t\tfirstY = maxY\n\t\tsecondX = maxX\n\t\tsecondY = minY\n\t}\n\n\treturn (\n\t\t<g className=\"rs-snap-line\">\n\t\t\t<line x1={firstX} y1={firstY} x2={secondX} y2={secondY} />\n\t\t\t{points.map((p, i) => (\n\t\t\t\t<g transform={`translate(${p.x},${p.y})`} key={i}>\n\t\t\t\t\t<path\n\t\t\t\t\t\tclassName=\"rs-snap-point\"\n\t\t\t\t\t\td={`M ${-l},${-l} L ${l},${l} M ${-l},${l} L ${l},${-l}`}\n\t\t\t\t\t/>\n\t\t\t\t</g>\n\t\t\t))}\n\t\t</g>\n\t)\n}\n\nfunction GapsSnapLine({ gaps, direction, zoom }: { zoom: number } & GapsSnapLine) {\n\tconst l = 3.5 / zoom\n\n\tlet edgeIntersection: number[] | null = [-Infinity, +Infinity]\n\tlet nextEdgeIntersection: number[] | null = null\n\n\tconst horizontal = direction === 'horizontal'\n\n\t// find intersection of all gaps so we can render a straight line through it;\n\t// some range intersections may return null, in which case we skip that gap.\n\tfor (const gap of gaps) {\n\t\tnextEdgeIntersection = rangeIntersection(\n\t\t\tedgeIntersection[0],\n\t\t\tedgeIntersection[1],\n\t\t\thorizontal ? gap.startEdge[0].y : gap.startEdge[0].x,\n\t\t\thorizontal ? gap.startEdge[1].y : gap.startEdge[1].x\n\t\t)\n\n\t\tif (nextEdgeIntersection) {\n\t\t\tedgeIntersection = nextEdgeIntersection\n\t\t} else {\n\t\t\tcontinue\n\t\t}\n\n\t\tnextEdgeIntersection = rangeIntersection(\n\t\t\tedgeIntersection[0],\n\t\t\tedgeIntersection[1],\n\t\t\thorizontal ? gap.endEdge[0].y : gap.endEdge[0].x,\n\t\t\thorizontal ? gap.endEdge[1].y : gap.endEdge[1].x\n\t\t)\n\n\t\tif (nextEdgeIntersection) {\n\t\t\tedgeIntersection = nextEdgeIntersection\n\t\t} else {\n\t\t\tcontinue\n\t\t}\n\t}\n\n\tif (edgeIntersection === null) {\n\t\treturn null\n\t}\n\n\tconst midPoint = (edgeIntersection[0] + edgeIntersection[1]) / 2\n\n\treturn (\n\t\t<g className=\"rs-snap-line\">\n\t\t\t{gaps.map(({ startEdge, endEdge }, i) => (\n\t\t\t\t<React.Fragment key={i}>\n\t\t\t\t\t{horizontal ? (\n\t\t\t\t\t\t// horizontal gap\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t{/* start edge */}\n\t\t\t\t\t\t\t<line\n\t\t\t\t\t\t\t\tx1={startEdge[0].x}\n\t\t\t\t\t\t\t\ty1={midPoint - 2 * l}\n\t\t\t\t\t\t\t\tx2={startEdge[1].x}\n\t\t\t\t\t\t\t\ty2={midPoint + 2 * l}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t{/* end edge */}\n\t\t\t\t\t\t\t<line\n\t\t\t\t\t\t\t\tx1={endEdge[0].x}\n\t\t\t\t\t\t\t\ty1={midPoint - 2 * l}\n\t\t\t\t\t\t\t\tx2={endEdge[1].x}\n\t\t\t\t\t\t\t\ty2={midPoint + 2 * l}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t{/* joining line */}\n\t\t\t\t\t\t\t<line x1={startEdge[0].x} y1={midPoint} x2={endEdge[0].x} y2={midPoint} />\n\t\t\t\t\t\t\t{/* center point marker */}\n\t\t\t\t\t\t\t<line\n\t\t\t\t\t\t\t\tx1={(startEdge[0].x + endEdge[0].x) / 2}\n\t\t\t\t\t\t\t\ty1={midPoint - l}\n\t\t\t\t\t\t\t\tx2={(startEdge[0].x + endEdge[0].x) / 2}\n\t\t\t\t\t\t\t\ty2={midPoint + l}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t// vertical gap\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t{/* start edge */}\n\t\t\t\t\t\t\t<line\n\t\t\t\t\t\t\t\tx1={midPoint - 2 * l}\n\t\t\t\t\t\t\t\ty1={startEdge[0].y}\n\t\t\t\t\t\t\t\tx2={midPoint + 2 * l}\n\t\t\t\t\t\t\t\ty2={startEdge[1].y}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t{/* end edge */}\n\t\t\t\t\t\t\t<line\n\t\t\t\t\t\t\t\tx1={midPoint - 2 * l}\n\t\t\t\t\t\t\t\ty1={endEdge[0].y}\n\t\t\t\t\t\t\t\tx2={midPoint + 2 * l}\n\t\t\t\t\t\t\t\ty2={endEdge[1].y}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t{/* joining line */}\n\t\t\t\t\t\t\t<line x1={midPoint} y1={startEdge[0].y} x2={midPoint} y2={endEdge[0].y} />\n\t\t\t\t\t\t\t{/* center point marker */}\n\t\t\t\t\t\t\t<line\n\t\t\t\t\t\t\t\tx1={midPoint - l}\n\t\t\t\t\t\t\t\ty1={(startEdge[0].y + endEdge[0].y) / 2}\n\t\t\t\t\t\t\t\tx2={midPoint + l}\n\t\t\t\t\t\t\t\ty2={(startEdge[0].y + endEdge[0].y) / 2}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</>\n\t\t\t\t\t)}\n\t\t\t\t</React.Fragment>\n\t\t\t))}\n\t\t</g>\n\t)\n}\n\nfunction SnapLine({ line, zoom }: TLSnapLineProps) {\n\tswitch (line.type) {\n\t\tcase 'points':\n\t\t\treturn <PointsSnapLine {...line} zoom={zoom} />\n\t\tcase 'gaps':\n\t\t\treturn <GapsSnapLine {...line} zoom={zoom} />\n\t\tdefault:\n\t\t\treturn null\n\t}\n}\n\nexport const SnapLines = track(function SnapLines() {\n\tconst app = useApp()\n\n\tconst zoom = app.zoomLevel\n\treturn (\n\t\t<>\n\t\t\t{app.snaps.lines.map((line) => (\n\t\t\t\t<SnapLine line={line} key={line.id} zoom={zoom} />\n\t\t\t))}\n\t\t</>\n\t)\n})\n","import { toDomPrecision } from '@tldraw/primitives'\nimport { TLShapeId } from '@tldraw/tlschema'\nimport { dedupe, modulate } from '@tldraw/utils'\nimport * as React from 'react'\nimport { track } from 'signia-react'\nimport {\n\tuseApp,\n\tuseCanvasEvents,\n\tuseCoarsePointer,\n\tuseDocumentEvents,\n\tuseFixSafariDoubleTapZoomPencilEvents,\n\tuseGestureEvents,\n\tuseQuickReactor,\n\tuseScreenBounds,\n} from '../../hooks'\nimport { usePattern } from '../../hooks/usePattern'\nimport { debugFlags } from '../../utils/debug-flags'\nimport { Brush } from '../Brush'\nimport { Grid } from '../Grid'\nimport { HandlesContainer } from '../Handle'\nimport { LiveCollaborators } from '../LiveCollaborators'\nimport { Scribble } from '../Scribble'\nimport { SelectionBg, SelectionFg } from '../Selection'\nimport { Shape } from '../Shape'\nimport { ShapeIndicator } from '../ShapeIndicator'\nimport { SnapLines } from '../SnapLine/SnapLine'\n\nconst DupSvg = track(function DupSvg({ id }: { id: TLShapeId }) {\n\tconst app = useApp()\n\tconst shape = app.getShapeById(id)\n\n\tconst [html, setHtml] = React.useState('')\n\n\tReact.useEffect(() => {\n\t\tlet cancelled = false\n\t\t;(async () => {\n\t\t\tif (cancelled) return\n\t\t\tconst bb = app.getPageBoundsById(id)\n\t\t\tconst el = await app.getSvg([id], { padding: 0 })\n\t\t\tif (el && bb && !cancelled) {\n\t\t\t\tel.style.setProperty('overflow', 'visible')\n\t\t\t\tel.setAttribute('preserveAspectRatio', 'xMidYMin slice')\n\t\t\t\tel.style.setProperty('transform', `translate(${bb.x}px, ${bb.y + bb.h + 12}px)`)\n\t\t\t\tel.style.setProperty('border', '1px solid black')\n\t\t\t\tsetHtml(el?.outerHTML)\n\t\t\t}\n\t\t})()\n\n\t\treturn () => {\n\t\t\tcancelled = true\n\t\t}\n\t}, [app, shape, id])\n\treturn (\n\t\t<div style={{ paddingTop: 12, position: 'absolute' }}>\n\t\t\t<div style={{ display: 'flex' }} dangerouslySetInnerHTML={{ __html: html }} />\n\t\t</div>\n\t)\n})\n\n/** @public */\nexport const Canvas = track(function Canvas({\n\tonDropOverride,\n}: {\n\tonDropOverride?: (\n\t\tdefaultOnDrop: (e: React.DragEvent<Element>) => Promise<void>\n\t) => (e: React.DragEvent<Element>) => Promise<void>\n}) {\n\tconst app = useApp()\n\n\tconst rCanvas = React.useRef<HTMLDivElement>(null)\n\tconst rHtmlLayer = React.useRef<HTMLDivElement>(null)\n\tconst rSvgLayer = React.useRef<SVGGElement>(null)\n\n\tuseDocumentEvents()\n\tuseCoarsePointer()\n\tuseGestureEvents(rCanvas)\n\tuseFixSafariDoubleTapZoomPencilEvents(rCanvas)\n\tuseScreenBounds()\n\n\tuseQuickReactor(\n\t\t'position layers',\n\t\t() => {\n\t\t\tconst svgElm = rSvgLayer.current\n\t\t\tconst htmlElm = rHtmlLayer.current\n\t\t\tif (!(svgElm && htmlElm)) return\n\n\t\t\tconst { x, y, z } = app.camera\n\n\t\t\t// Because the html container has a width/height of 1px, we\n\t\t\t// need to create a small offset when zoomed to ensure that\n\t\t\t// the html container and svg container are lined up exactly.\n\t\t\tconst offset =\n\t\t\t\tz >= 1 ? modulate(z, [1, 8], [0.125, 0.5], true) : modulate(z, [0.1, 1], [-2, 0.125], true)\n\n\t\t\tsvgElm.style.setProperty(\n\t\t\t\t'transform',\n\t\t\t\t`scale(${toDomPrecision(z)}) translate(${toDomPrecision(x)}px,${toDomPrecision(y)}px)`\n\t\t\t)\n\t\t\thtmlElm.style.setProperty(\n\t\t\t\t'transform',\n\t\t\t\t`scale(${toDomPrecision(z)}) translate(${toDomPrecision(x + offset)}px,${toDomPrecision(\n\t\t\t\t\ty + offset\n\t\t\t\t)}px)`\n\t\t\t)\n\t\t},\n\t\t[app]\n\t)\n\n\tconst { context: patternContext, isReady: patternIsReady } = usePattern()\n\n\tconst events = useCanvasEvents()\n\tif (onDropOverride) {\n\t\tevents.onDrop = onDropOverride(events.onDrop)\n\t}\n\n\tReact.useEffect(() => {\n\t\tif (patternIsReady && app.isSafari) {\n\t\t\tconst svgElm = rSvgLayer.current\n\t\t\tconst htmlElm = rHtmlLayer.current\n\n\t\t\tif (svgElm && htmlElm) {\n\t\t\t\t// Wait for `patternContext` to be picked up\n\t\t\t\trequestAnimationFrame(() => {\n\t\t\t\t\tsvgElm.style.display = 'none'\n\t\t\t\t\thtmlElm.style.display = 'none'\n\n\t\t\t\t\t// Wait for 'display = \"none\"' to take effect\n\t\t\t\t\trequestAnimationFrame(() => {\n\t\t\t\t\t\tsvgElm.style.display = ''\n\t\t\t\t\t\thtmlElm.style.display = ''\n\t\t\t\t\t})\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\t}, [app, patternIsReady])\n\n\tReact.useEffect(() => {\n\t\trCanvas.current?.focus()\n\t}, [])\n\n\treturn (\n\t\t<div\n\t\t\tref={rCanvas}\n\t\t\ttabIndex={-1}\n\t\t\tdraggable={false}\n\t\t\tclassName=\"rs-canvas\"\n\t\t\tdata-wd=\"canvas\"\n\t\t\t{...events}\n\t\t>\n\t\t\t<Grid size={app.gridSize} />\n\t\t\t<div ref={rHtmlLayer} className=\"rs-html-layer\" draggable={false}>\n\t\t\t\t<SelectionBg />\n\t\t\t\t<ShapesToDisplay />\n\t\t\t</div>\n\t\t\t<svg className=\"rs-svg-layer\">\n\t\t\t\t{patternContext}\n\t\t\t\t<defs>\n\t\t\t\t\t<Cursor />\n\t\t\t\t\t<CursorHint />\n\t\t\t\t\t<marker id=\"arrowhead-dot\" className=\"rs-arrow-hint\" refX=\"3.0\" refY=\"3.0\" orient=\"0\">\n\t\t\t\t\t\t<circle cx=\"3\" cy=\"3\" r=\"2\" strokeDasharray=\"100%\" />\n\t\t\t\t\t</marker>\n\t\t\t\t\t<marker\n\t\t\t\t\t\tid=\"arrowhead-cross\"\n\t\t\t\t\t\tclassName=\"rs-arrow-hint\"\n\t\t\t\t\t\trefX=\"3.0\"\n\t\t\t\t\t\trefY=\"3.0\"\n\t\t\t\t\t\torient=\"auto\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<line x1=\"1.5\" y1=\"1.5\" x2=\"4.5\" y2=\"4.5\" strokeDasharray=\"100%\" />\n\t\t\t\t\t\t<line x1=\"1.5\" y1=\"4.5\" x2=\"4.5\" y2=\"1.5\" strokeDasharray=\"100%\" />\n\t\t\t\t\t</marker>\n\t\t\t\t</defs>\n\t\t\t\t<g ref={rSvgLayer}>\n\t\t\t\t\t<LiveCollaborators />\n\t\t\t\t\t<Scribble />\n\t\t\t\t\t<Brush />\n\t\t\t\t\t<SelectedIdIndicators />\n\t\t\t\t\t<HoveredShapeIndicator />\n\t\t\t\t\t<SelectionFg />\n\t\t\t\t\t<HintedShapeIndicator />\n\t\t\t\t\t<HandlesContainer />\n\t\t\t\t\t<SnapLines />\n\t\t\t\t</g>\n\t\t\t</svg>\n\t\t</div>\n\t)\n})\n\nconst ShapesToDisplay = track(function ShapesToDisplay() {\n\tconst app = useApp()\n\n\tconst { renderingShapes } = app\n\n\tconst debugSvg = debugFlags.debugSvg.value\n\tif (debugSvg) {\n\t\treturn (\n\t\t\t<>\n\t\t\t\t{renderingShapes.map((result) => (\n\t\t\t\t\t<React.Fragment key={result.id + '_fragment'}>\n\t\t\t\t\t\t<Shape key={result.id + '_shape'} {...result} />\n\t\t\t\t\t\t<DupSvg key={result.id + '_shape_debug'} id={result.id} />\n\t\t\t\t\t</React.Fragment>\n\t\t\t\t))}\n\t\t\t</>\n\t\t)\n\t}\n\n\treturn (\n\t\t<>\n\t\t\t{renderingShapes.map((result) => (\n\t\t\t\t<Shape key={result.id + '_shape'} {...result} />\n\t\t\t))}\n\t\t</>\n\t)\n})\n\nconst SelectedIdIndicators = track(function SelectedIdIndicators() {\n\tconst app = useApp()\n\n\tconst selectedIds = app.selectedIds\n\n\tconst isChangingStyle = app.isChangingStyle\n\n\tconst shouldDisplay =\n\t\tapp.isInAny(\n\t\t\t'select.idle',\n\t\t\t'select.brushing',\n\t\t\t'select.scribble_brushing',\n\t\t\t'select.pointing_shape',\n\t\t\t'select.pointing_selection',\n\t\t\t'select.pointing_handle'\n\t\t) && !isChangingStyle\n\n\tif (!shouldDisplay) return null\n\n\treturn (\n\t\t<g aria-label=\"SELECTED INDICATORS\">\n\t\t\t{selectedIds.map((id) => (\n\t\t\t\t<ShapeIndicator key={id + '_indicator'} id={id} />\n\t\t\t))}\n\t\t</g>\n\t)\n})\n\nconst HoveredShapeIndicator = track(function HoveredShapeIndicator() {\n\tconst app = useApp()\n\n\tconst id = app.pageState.hoveredId\n\n\tconst shouldDisplay = app.isInAny('select.idle', 'select.editing_shape')\n\n\tif (!(id && shouldDisplay)) return null\n\n\treturn <ShapeIndicator id={id} key={id} />\n})\n\nconst HintedShapeIndicator = track(function HintedShapeIndicator() {\n\tconst app = useApp()\n\n\tconst ids = dedupe(app.hintingIds)\n\n\tif (!ids.length) return null\n\n\treturn (\n\t\t<g aria-label=\"HINTED SHAPES\">\n\t\t\t{ids.map((id) => (\n\t\t\t\t<ShapeIndicator id={id} key={id + '_hinting'} isHinting />\n\t\t\t))}\n\t\t</g>\n\t)\n})\n\nfunction Cursor() {\n\treturn (\n\t\t<g id=\"cursor\">\n\t\t\t<g fill=\"rgba(0,0,0,.2)\" transform=\"translate(-11,-11)\">\n\t\t\t\t<path d=\"m12 24.4219v-16.015l11.591 11.619h-6.781l-.411.124z\" />\n\t\t\t\t<path d=\"m21.0845 25.0962-3.605 1.535-4.682-11.089 3.686-1.553z\" />\n\t\t\t</g>\n\t\t\t<g fill=\"white\" transform=\"translate(-12,-12)\">\n\t\t\t\t<path d=\"m12 24.4219v-16.015l11.591 11.619h-6.781l-.411.124z\" />\n\t\t\t\t<path d=\"m21.0845 25.0962-3.605 1.535-4.682-11.089 3.686-1.553z\" />\n\t\t\t</g>\n\t\t\t<g fill=\"currentColor\" transform=\"translate(-12,-12)\">\n\t\t\t\t<path d=\"m19.751 24.4155-1.844.774-3.1-7.374 1.841-.775z\" />\n\t\t\t\t<path d=\"m13 10.814v11.188l2.969-2.866.428-.139h4.768z\" />\n\t\t\t</g>\n\t\t</g>\n\t)\n}\n\n// A triangle pointing right\nfunction CursorHint() {\n\treturn <path id=\"cursor_hint\" fill=\"currentColor\" d=\"M -2,-5 2,0 -2,5 Z\" opacity=\".8\" />\n}\n","import { useEffect } from 'react'\nimport { useApp } from './useApp'\n\nexport function useCoarsePointer() {\n\tconst app = useApp()\n\tuseEffect(() => {\n\t\tconst mql = window.matchMedia('(pointer: coarse)')\n\t\tconst handler = () => {\n\t\t\tapp.isCoarsePointer = mql.matches\n\t\t}\n\t\thandler()\n\t\tmql.addEventListener('change', handler)\n\t\treturn () => mql.removeEventListener('change', handler)\n\t}, [app])\n}\n","import throttle from 'lodash.throttle'\nimport { useLayoutEffect } from 'react'\nimport { useApp } from './useApp'\nimport { useContainer } from './useContainer'\n\nexport function useScreenBounds() {\n\tconst app = useApp()\n\tconst container = useContainer()\n\n\tuseLayoutEffect(() => {\n\t\tconst updateBounds = throttle(\n\t\t\t() => {\n\t\t\t\tapp.updateViewportScreenBounds()\n\t\t\t},\n\t\t\t200,\n\t\t\t{ trailing: true }\n\t\t)\n\n\t\tconst resizeObserver = new ResizeObserver((entries) => {\n\t\t\tif (entries[0].contentRect) {\n\t\t\t\tupdateBounds()\n\t\t\t}\n\t\t})\n\n\t\tif (container) {\n\t\t\tresizeObserver.observe(container)\n\t\t}\n\n\t\tupdateBounds()\n\n\t\treturn () => {\n\t\t\tresizeObserver.disconnect()\n\t\t}\n\t}, [app, container])\n}\n","import React, { useMemo } from 'react'\nimport {\n\tcreateShapesFromFiles,\n\tgetPointerInfo,\n\tpreventDefault,\n\treleasePointerCapture,\n\tsetPointerCapture,\n} from '../utils'\nimport { useApp } from './useApp'\n\nexport function useCanvasEvents() {\n\tconst app = useApp()\n\n\tconst events = useMemo(\n\t\tfunction canvasEvents() {\n\t\t\t// Track the last screen point\n\t\t\tlet lastX: number, lastY: number\n\n\t\t\tfunction onPointerDown(e: React.PointerEvent) {\n\t\t\t\tif ((e as any).isKilled) return\n\t\t\t\tif (e.button !== 0 && e.button !== 1 && e.button !== 5) return\n\n\t\t\t\tsetPointerCapture(e.currentTarget, e)\n\n\t\t\t\tapp.dispatch({\n\t\t\t\t\ttype: 'pointer',\n\t\t\t\t\ttarget: 'canvas',\n\t\t\t\t\tname: 'pointer_down',\n\t\t\t\t\t...getPointerInfo(e, app.getContainer()),\n\t\t\t\t})\n\t\t\t}\n\n\t\t\tfunction onPointerMove(e: React.PointerEvent) {\n\t\t\t\tif ((e as any).isKilled) return\n\n\t\t\t\tif (e.clientX === lastX && e.clientY === lastY) return\n\t\t\t\tlastX = e.clientX\n\t\t\t\tlastY = e.clientY\n\n\t\t\t\tapp.dispatch({\n\t\t\t\t\ttype: 'pointer',\n\t\t\t\t\ttarget: 'canvas',\n\t\t\t\t\tname: 'pointer_move',\n\t\t\t\t\t...getPointerInfo(e, app.getContainer()),\n\t\t\t\t})\n\t\t\t}\n\n\t\t\tfunction onPointerUp(e: React.PointerEvent) {\n\t\t\t\tif ((e as any).isKilled) return\n\t\t\t\tif (e.button !== 0 && e.button !== 1 && e.button !== 5) return\n\t\t\t\tlastX = e.clientX\n\t\t\t\tlastY = e.clientY\n\n\t\t\t\treleasePointerCapture(e.currentTarget, e)\n\n\t\t\t\tapp.dispatch({\n\t\t\t\t\ttype: 'pointer',\n\t\t\t\t\ttarget: 'canvas',\n\t\t\t\t\tname: 'pointer_up',\n\t\t\t\t\t...getPointerInfo(e, app.getContainer()),\n\t\t\t\t})\n\t\t\t}\n\n\t\t\tfunction onPointerEnter(e: React.PointerEvent) {\n\t\t\t\tif ((e as any).isKilled) return\n\n\t\t\t\tapp.dispatch({\n\t\t\t\t\ttype: 'pointer',\n\t\t\t\t\ttarget: 'canvas',\n\t\t\t\t\tname: 'pointer_enter',\n\t\t\t\t\t...getPointerInfo(e, app.getContainer()),\n\t\t\t\t})\n\t\t\t}\n\n\t\t\tfunction onPointerLeave(e: React.PointerEvent) {\n\t\t\t\tif ((e as any).isKilled) return\n\n\t\t\t\tapp.dispatch({\n\t\t\t\t\ttype: 'pointer',\n\t\t\t\t\ttarget: 'canvas',\n\t\t\t\t\tname: 'pointer_leave',\n\t\t\t\t\t...getPointerInfo(e, app.getContainer()),\n\t\t\t\t})\n\t\t\t}\n\n\t\t\tfunction onTouchStart(e: React.TouchEvent) {\n\t\t\t\t;(e as any).isKilled = true\n\t\t\t\tdocument.body.click() // god damn it, but necessary for long presses to open the context menu\n\t\t\t\tpreventDefault(e)\n\t\t\t}\n\n\t\t\tfunction onTouchEnd(e: React.TouchEvent) {\n\t\t\t\t;(e as any).isKilled = true\n\t\t\t\tif (\n\t\t\t\t\t(e.target as HTMLElement).tagName !== 'A' &&\n\t\t\t\t\t(e.target as HTMLElement).tagName !== 'TEXTAREA'\n\t\t\t\t) {\n\t\t\t\t\tpreventDefault(e)\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction onDragOver(e: React.DragEvent<Element>) {\n\t\t\t\tpreventDefault(e)\n\t\t\t}\n\n\t\t\tasync function onDrop(e: React.DragEvent<Element>) {\n\t\t\t\tpreventDefault(e)\n\t\t\t\tif (!e.dataTransfer?.files?.length) return\n\n\t\t\t\tconst files = Array.from(e.dataTransfer.files).filter(\n\t\t\t\t\t(file) => !file.name.endsWith('.tldr')\n\t\t\t\t)\n\n\t\t\t\tawait createShapesFromFiles(app, files, app.screenToPage(e.clientX, e.clientY), false)\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tonPointerDown,\n\t\t\t\tonPointerMove,\n\t\t\t\tonPointerUp,\n\t\t\t\tonPointerEnter,\n\t\t\t\tonPointerLeave,\n\t\t\t\tonDragOver,\n\t\t\t\tonDrop,\n\t\t\t\tonTouchStart,\n\t\t\t\tonTouchEnd,\n\t\t\t}\n\t\t},\n\t\t[app]\n\t)\n\n\treturn events\n}\n","import classNames from 'classnames'\nimport { useEffect, useLayoutEffect, useRef, useState } from 'react'\nimport { useValue } from 'signia-react'\nimport { App } from '../../app/App'\nimport { AppContext } from '../../hooks'\nimport { Canvas } from '../Canvas'\nimport { ErrorBoundary } from './ErrorBoundary'\n\nconst BASE_ERROR_URL = 'https://github.com/tldraw/editor/issues/new'\n\n// eslint-disable-next-line @typescript-eslint/no-empty-function\nfunction noop() {}\n\n/** @public */\nexport function ErrorFallback({ error, app }: { error: unknown; app?: App }) {\n\tconst containerRef = useRef<HTMLDivElement>(null)\n\tconst [shouldShowError, setShouldShowError] = useState(process.env.NODE_ENV === 'development')\n\tconst [didCopy, setDidCopy] = useState(false)\n\tconst [shouldShowResetConfirmation, setShouldShowResetConfirmation] = useState(false)\n\n\tconst errorMessage = error instanceof Error ? error.message : String(error)\n\tconst errorStack = error instanceof Error ? error.stack : null\n\n\tconst isDarkModeFromApp = useValue(\n\t\t'isDarkMode',\n\t\t() => {\n\t\t\ttry {\n\t\t\t\tif (app) {\n\t\t\t\t\treturn app.userDocumentSettings.isDarkMode\n\t\t\t\t}\n\t\t\t} catch {\n\t\t\t\t// we're in a funky error state so this might not work for spooky\n\t\t\t\t// reasons. if not, we'll have another attempt later:\n\t\t\t}\n\t\t\treturn null\n\t\t},\n\t\t[app]\n\t)\n\tconst [isDarkMode, setIsDarkMode] = useState<null | boolean>(null)\n\tuseLayoutEffect(() => {\n\t\t// if we found a theme class from the app, we can just use that\n\t\tif (isDarkModeFromApp !== null) {\n\t\t\tsetIsDarkMode(isDarkModeFromApp)\n\t\t}\n\n\t\t// do any of our parents have a theme class? if yes then we can just\n\t\t// rely on that and don't need to set our own class\n\t\tlet parent = containerRef.current?.parentElement\n\t\tlet foundParentThemeClass = false\n\t\twhile (parent) {\n\t\t\tif (\n\t\t\t\tparent.classList.contains('rs-theme__dark') ||\n\t\t\t\tparent.classList.contains('rs-theme__light')\n\t\t\t) {\n\t\t\t\tfoundParentThemeClass = true\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tparent = parent.parentElement\n\t\t}\n\t\tif (foundParentThemeClass) {\n\t\t\tsetIsDarkMode(null)\n\t\t\treturn\n\t\t}\n\n\t\t// if we can't find a theme class from the app or from a parent, we have\n\t\t// to fall back on using a media query:\n\t\tsetIsDarkMode(window.matchMedia('(prefers-color-scheme: dark)').matches)\n\t}, [isDarkModeFromApp])\n\n\tuseEffect(() => {\n\t\tif (didCopy) {\n\t\t\tconst timeout = setTimeout(() => {\n\t\t\t\tsetDidCopy(false)\n\t\t\t}, 2000)\n\t\t\treturn () => clearTimeout(timeout)\n\t\t}\n\t}, [didCopy])\n\n\tconst copyError = () => {\n\t\tconst textarea = document.createElement('textarea')\n\t\ttextarea.value = errorStack ?? errorMessage\n\t\tdocument.body.appendChild(textarea)\n\t\ttextarea.select()\n\t\tdocument.execCommand('copy')\n\t\ttextarea.remove()\n\t\tsetDidCopy(true)\n\t}\n\n\tconst refreshPage = () => {\n\t\twindow.location.reload()\n\t}\n\n\tconst resetLocalState = async () => {\n\t\tawait (window as any).__tldraw__hardReset?.()\n\t}\n\n\tconst url = new URL(BASE_ERROR_URL)\n\turl.searchParams.set('title', errorMessage)\n\turl.searchParams.set('labels', `bug`)\n\turl.searchParams.set(\n\t\t'body',\n\t\t`Hey, I ran into an error while using tldraw:\n\n\\`\\`\\`js\n${errorStack ?? errorMessage}\n\\`\\`\\`\n\nMy browser: ${navigator.userAgent}`\n\t)\n\n\treturn (\n\t\t<div\n\t\t\tref={containerRef}\n\t\t\tclassName={classNames(\n\t\t\t\t'rs-container rs-error-boundary',\n\t\t\t\t// error-boundary is sometimes used outside of the theme\n\t\t\t\t// container, so we need to provide it with a theme for our\n\t\t\t\t// styles to work correctly\n\t\t\t\tisDarkMode === null ? '' : isDarkMode ? 'rs-theme__dark' : 'rs-theme__light'\n\t\t\t)}\n\t\t>\n\t\t\t<div className=\"rs-error-boundary__overlay\" />\n\t\t\t{app && (\n\t\t\t\t// opportunistically attempt to render the canvas to reassure\n\t\t\t\t// the user that their document is still there. there's a good\n\t\t\t\t// chance this won't work (ie the error that we're currently\n\t\t\t\t// notifying the user about originates in the canvas) so it's\n\t\t\t\t// not a big deal if it doesn't work - in that case we just have\n\t\t\t\t// a plain grey background.\n\t\t\t\t<ErrorBoundary onError={noop} fallback={() => null}>\n\t\t\t\t\t<AppContext.Provider value={app}>\n\t\t\t\t\t\t<div className=\"rs-overlay rs-error-boundary__canvas\">\n\t\t\t\t\t\t\t<Canvas />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</AppContext.Provider>\n\t\t\t\t</ErrorBoundary>\n\t\t\t)}\n\t\t\t<div\n\t\t\t\tclassName={classNames('rs-modal', 'rs-error-boundary__content', {\n\t\t\t\t\t'rs-error-boundary__content__expanded': shouldShowError && !shouldShowResetConfirmation,\n\t\t\t\t})}\n\t\t\t>\n\t\t\t\t{shouldShowResetConfirmation ? (\n\t\t\t\t\t<>\n\t\t\t\t\t\t<h2>Are you sure?</h2>\n\t\t\t\t\t\t<p>Resetting your data will delete your drawing and cannot be undone.</p>\n\t\t\t\t\t\t<div className=\"rs-error-boundary__content__actions\">\n\t\t\t\t\t\t\t<button onClick={() => setShouldShowResetConfirmation(false)}>Cancel</button>\n\t\t\t\t\t\t\t<button className=\"rs-error-boundary__reset\" onClick={resetLocalState}>\n\t\t\t\t\t\t\t\tReset data\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</>\n\t\t\t\t) : (\n\t\t\t\t\t<>\n\t\t\t\t\t\t<h2>Something&apos;s gone wrong.</h2>\n\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\tSorry, we encountered an error. Please refresh the page to continue. If you keep\n\t\t\t\t\t\t\tseeing this error, you can <a href={url.toString()}>create a GitHub issue</a> or{' '}\n\t\t\t\t\t\t\t<a href=\"https://discord.gg/Cq6cPsTfNy\">ask for help on Discord</a>.\n\t\t\t\t\t\t</p>\n\t\t\t\t\t\t{shouldShowError && (\n\t\t\t\t\t\t\t<div className=\"rs-error-boundary__content__error\">\n\t\t\t\t\t\t\t\t<pre>\n\t\t\t\t\t\t\t\t\t<code>{errorStack ?? errorMessage}</code>\n\t\t\t\t\t\t\t\t</pre>\n\t\t\t\t\t\t\t\t<button onClick={copyError}>{didCopy ? 'Copied!' : 'Copy'}</button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t<div className=\"rs-error-boundary__content__actions\">\n\t\t\t\t\t\t\t<button onClick={() => setShouldShowError(!shouldShowError)}>\n\t\t\t\t\t\t\t\t{shouldShowError ? 'Hide details' : 'Show details'}\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<div className=\"rs-error-boundary__content__actions__group\">\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\tclassName=\"rs-error-boundary__reset\"\n\t\t\t\t\t\t\t\t\tonClick={() => setShouldShowResetConfirmation(true)}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\tReset data\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t<button className=\"rs-error-boundary__refresh\" onClick={refreshPage}>\n\t\t\t\t\t\t\t\t\tRefresh Page\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</>\n\t\t\t\t)}\n\t\t\t</div>\n\t\t</div>\n\t)\n}\n","import * as React from 'react'\nimport { useApp } from './useApp'\n\nlet isMobileSafari = false\n\nif (typeof window !== 'undefined') {\n\tconst ua = window.navigator.userAgent\n\tconst iOS = !!ua.match(/iPad/i) || !!ua.match(/iPhone/i)\n\tconst webkit = !!ua.match(/WebKit/i)\n\tisMobileSafari = iOS && webkit && !ua.match(/CriOS/i)\n}\n\nexport function useSafariFocusOutFix(): void {\n\tconst app = useApp()\n\n\tReact.useEffect(() => {\n\t\tif (!isMobileSafari) return\n\n\t\tfunction handleFocusOut(e: FocusEvent) {\n\t\t\tif (\n\t\t\t\t(e.target instanceof HTMLInputElement && e.target.type === 'text') ||\n\t\t\t\te.target instanceof HTMLTextAreaElement\n\t\t\t) {\n\t\t\t\tapp.complete()\n\t\t\t}\n\t\t}\n\n\t\t// Send event on iOS when a user presses the \"Done\" key while editing a text element.\n\t\tdocument.addEventListener('focusout', handleFocusOut)\n\t\treturn () => document.removeEventListener('focusout', handleFocusOut)\n\t}, [app])\n}\n","import { useCursor, useDarkMode, useForceUpdate, useZoomCss } from '../../hooks'\nimport { useSafariFocusOutFix } from '../../hooks/useSafariFocusOutFix'\n\n/** @public */\nexport const Layout = ({ children }: { children: any }) => {\n\tuseZoomCss()\n\tuseCursor()\n\tuseDarkMode()\n\tuseForceUpdate()\n\tuseSafariFocusOutFix()\n\n\treturn children\n}\n","import { debounce } from '@tldraw/utils'\nimport * as React from 'react'\nimport { EffectScheduler } from 'signia'\nimport { useApp } from './useApp'\nimport { useContainer } from './useContainer'\n\nexport function useZoomCss() {\n\tconst app = useApp()\n\tconst container = useContainer()\n\n\tReact.useEffect(() => {\n\t\tconst setScale = (s: number) => container.style.setProperty('--rs-zoom', s.toString())\n\t\tconst setScaleDebounced = debounce(setScale, 100)\n\n\t\tconst scheduler = new EffectScheduler('useZoomCss', () => {\n\t\t\tconst numShapes = app.shapeIds.size\n\t\t\tif (numShapes < 300) {\n\t\t\t\tsetScale(app.zoomLevel)\n\t\t\t} else {\n\t\t\t\tsetScaleDebounced(app.zoomLevel)\n\t\t\t}\n\t\t})\n\n\t\tscheduler.attach()\n\t\tscheduler.execute()\n\n\t\treturn () => {\n\t\t\tscheduler.detach()\n\t\t}\n\t}, [app, container])\n}\n","import React from 'react'\nimport { useValue } from 'signia-react'\nimport { useApp } from './useApp'\nimport { useContainer } from './useContainer'\n\nexport function useDarkMode() {\n\tconst app = useApp()\n\tconst container = useContainer()\n\tconst isDarkMode = useValue('isDarkMode', () => app.userDocumentSettings.isDarkMode, [app])\n\n\tReact.useEffect(() => {\n\t\tif (isDarkMode) {\n\t\t\tcontainer.setAttribute('data-color-mode', 'dark')\n\t\t\tcontainer.classList.remove('rs-theme__light')\n\t\t\tcontainer.classList.add('rs-theme__dark')\n\t\t\tapp.setCursor({\n\t\t\t\tcolor: 'white',\n\t\t\t})\n\t\t} else {\n\t\t\tcontainer.setAttribute('data-color-mode', 'light')\n\t\t\tcontainer.classList.remove('rs-theme__dark')\n\t\t\tcontainer.classList.add('rs-theme__light')\n\t\t\tapp.setCursor({\n\t\t\t\tcolor: 'black',\n\t\t\t})\n\t\t}\n\t}, [app, container, isDarkMode])\n}\n","import { useEffect, useState } from 'react'\n\n/** @public */\nexport function useForceUpdate() {\n\tconst [_, ss] = useState(0)\n\tuseEffect(() => ss((s) => s + 1), [])\n}\n","import { useEffect, useMemo, useState } from 'react'\nimport { EditorAssetUrls } from '../assetUrls'\n\nexport type TLTypeFace = {\n\turl: string\n\tdisplay?: any // FontDisplay\n\tfeatureSettings?: string\n\tstretch?: string\n\tstyle?: string\n\tunicodeRange?: string\n\tvariant?: string\n\tweight?: string\n}\n\nexport type TLTypeFaces = {\n\tdraw: TLTypeFace\n\tmonospace: TLTypeFace\n\tserif: TLTypeFace\n\tsansSerif: TLTypeFace\n}\n\nenum PreloadStatus {\n\tSUCCESS,\n\tFAILED,\n\tWAITING,\n}\n\nconst usePreloadFont = (id: string, font: TLTypeFace): PreloadStatus => {\n\tconst [state, setState] = useState<PreloadStatus>(PreloadStatus.WAITING)\n\n\tuseEffect(() => {\n\t\tconst {\n\t\t\turl,\n\t\t\tstyle = 'normal',\n\t\t\tweight = '500',\n\t\t\tdisplay,\n\t\t\tfeatureSettings,\n\t\t\tstretch,\n\t\t\tunicodeRange,\n\t\t\tvariant,\n\t\t} = font\n\n\t\tlet cancelled = false\n\t\tsetState(PreloadStatus.WAITING)\n\n\t\tconst descriptors: FontFaceDescriptors = {\n\t\t\tstyle,\n\t\t\tweight,\n\t\t\tdisplay,\n\t\t\tfeatureSettings,\n\t\t\tstretch,\n\t\t\tunicodeRange,\n\t\t\tvariant,\n\t\t}\n\n\t\tconst fontInstance = new FontFace(id, `url(${url})`, descriptors)\n\n\t\tfontInstance\n\t\t\t.load()\n\t\t\t.then(() => {\n\t\t\t\tif (cancelled) return\n\t\t\t\tdocument.fonts.add(fontInstance)\n\t\t\t\tsetState(PreloadStatus.SUCCESS)\n\t\t\t})\n\t\t\t.catch((err) => {\n\t\t\t\tif (cancelled) return\n\t\t\t\tconsole.error(err)\n\t\t\t\tsetState(PreloadStatus.FAILED)\n\t\t\t})\n\n\t\t// @ts-expect-error\n\t\tfontInstance.$$_url = url\n\n\t\t// @ts-expect-error\n\t\tfontInstance.$$_fontface = `\n@font-face {\n\tfont-family: ${fontInstance.family};\n\tfont-stretch: ${fontInstance.stretch};\n\tfont-weight: ${fontInstance.weight};\n\tfont-style: ${fontInstance.style};\n\tsrc: url(\"${url}\") format(\"woff2\")\n}`\n\n\t\treturn () => {\n\t\t\tdocument.fonts.delete(fontInstance)\n\t\t\tcancelled = true\n\t\t}\n\t}, [id, font])\n\n\treturn state\n}\n\nfunction getTypefaces(assetUrls: EditorAssetUrls) {\n\treturn {\n\t\tdraw: { url: assetUrls.fonts.draw },\n\t\tserif: { url: assetUrls.fonts.serif },\n\t\tsansSerif: { url: assetUrls.fonts.sansSerif },\n\t\tmonospace: { url: assetUrls.fonts.monospace },\n\t}\n}\n\n// todo: Expose this via a public API (prop on <Tldraw>).\n\nexport function usePreloadAssets(assetUrls: EditorAssetUrls) {\n\tconst typefaces = useMemo(() => getTypefaces(assetUrls), [assetUrls])\n\n\tconst results = [\n\t\tusePreloadFont('tldraw_draw', typefaces.draw),\n\t\tusePreloadFont('tldraw_serif', typefaces.serif),\n\t\tusePreloadFont('tldraw_sans', typefaces.sansSerif),\n\t\tusePreloadFont('tldraw_mono', typefaces.monospace),\n\t]\n\n\treturn {\n\t\t// If any of the results have errored, then preloading has failed\n\t\terror: results.some((result) => result === PreloadStatus.FAILED),\n\t\t// If any of the results are waiting, then we're not done yet\n\t\tdone: !results.some((result) => result === PreloadStatus.WAITING),\n\t}\n}\n","import { TLAsset, TLInstance, TLInstanceId, TLStore, TLUser, TLUserId } from '@tldraw/tlschema'\nimport { Store } from '@tldraw/tlstore'\nimport { annotateError } from '@tldraw/utils'\nimport React, { useCallback, useSyncExternalStore } from 'react'\nimport { App } from './app/App'\nimport { EditorAssetUrls, defaultEditorAssetUrls } from './assetUrls'\nimport { ErrorBoundary } from './components/ErrorBoundary'\nimport { ErrorFallback } from './components/ErrorBoundary/ErrorFallback'\nimport { Layout } from './components/Layout'\nimport { Spinner } from './components/Spinner'\nimport { SyncedStore } from './config/SyncedStore'\nimport { TldrawEditorConfig } from './config/TldrawEditorConfig'\nimport { ContainerProvider, useContainer, useEvent } from './hooks'\nimport { AppContext } from './hooks/useApp'\nimport { usePreloadAssets } from './hooks/usePreloadAssets'\n\n/** @public */\nexport interface TldrawEditorProps {\n\tchildren?: any\n\t/** Whether to display the dark mode. */\n\tisDarkMode?: boolean\n\t/**\n\t * A configuration defining major customizations to the app, such as custom\n\t * shapes and new tools\n\t */\n\tconfig?: TldrawEditorConfig\n\t/**\n\t * Called when the app has mounted.\n\t *\n\t * @example\n\t * ```ts\n\t * \tfunction TldrawEditor() {\n\t * \t\treturn <Editor onMount={(app) => app.selectAll()} />\n\t * \t}\n\t * ```\n\t *\n\t * @param app - The app instance.\n\t */\n\tonMount?: (app: App) => void\n\t/**\n\t * Called when the app generates a new asset from a file, such as when an image is dropped into\n\t * the canvas.\n\t *\n\t * @example\n\t * ```ts\n\t * \tconst app = new App({\n\t * \t\tonCreateAssetFromFile: (file) => uploadFileAndCreateAsset(file),\n\t * \t})\n\t * ```\n\t *\n\t * @param file - The file to generate an asset from.\n\t * @param id - The id to be assigned to the resulting asset.\n\t */\n\tonCreateAssetFromFile?: (file: File) => Promise<TLAsset>\n\n\t/**\n\t * Called when a URL is converted to a bookmark. This callback should return the metadata for the\n\t * bookmark.\n\t *\n\t * @example\n\t * ```ts\n\t * \tapp.onCreateBookmarkFromUrl(url, id)\n\t * ```\n\t *\n\t * @param url - The url that was created.\n\t * @public\n\t */\n\tonCreateBookmarkFromUrl?: (\n\t\turl: string\n\t) => Promise<{ image: string; title: string; description: string }>\n\n\t/**\n\t * The Store instance to use for keeping the app's data.\n\t * This may be prepopulated, e.g. by loading from a server or database.\n\t */\n\tstore?: TLStore | SyncedStore\n\t/**\n\t * The id of the current user. If not given, one will be generated.\n\t */\n\tuserId?: TLUserId\n\t/**\n\t * The id of the app instance (e.g. a browser tab if the app will have only one tldraw app per tab).\n\t * If not given, one will be generated.\n\t */\n\tinstanceId?: TLInstanceId\n\t/**\n\t * Asset URLs\n\t */\n\tassetUrls?: EditorAssetUrls\n}\n\ndeclare global {\n\tinterface Window {\n\t\ttldrawReady: boolean\n\t}\n}\n\n/** @public */\nexport function TldrawEditor(props: TldrawEditorProps) {\n\tconst [container, setContainer] = React.useState<HTMLDivElement | null>(null)\n\n\treturn (\n\t\t<div ref={setContainer} draggable={false} className=\"rs-container rs-theme__light\">\n\t\t\t<ErrorBoundary\n\t\t\t\tfallback={(error) => <ErrorFallback error={error} />}\n\t\t\t\tonError={(error) => annotateError(error, { tags: { origin: 'react.tldraw-before-app' } })}\n\t\t\t>\n\t\t\t\t{container && (\n\t\t\t\t\t<ContainerProvider container={container}>\n\t\t\t\t\t\t<TldrawEditorBeforeLoading {...props} />\n\t\t\t\t\t</ContainerProvider>\n\t\t\t\t)}\n\t\t\t</ErrorBoundary>\n\t\t</div>\n\t)\n}\n\nfunction TldrawEditorBeforeLoading({\n\tconfig = TldrawEditorConfig.default,\n\tuserId,\n\tinstanceId,\n\tstore,\n\t...props\n}: TldrawEditorProps) {\n\tconst { done: preloadingComplete, error: preloadingError } = usePreloadAssets(\n\t\tprops.assetUrls ?? defaultEditorAssetUrls\n\t)\n\n\tstore ??= config.createStore({\n\t\tuserId: userId ?? TLUser.createId(),\n\t\tinstanceId: instanceId ?? TLInstance.createId(),\n\t})\n\n\tlet loadedStore\n\tif (!(store instanceof Store)) {\n\t\tif (store.error) {\n\t\t\t// for error handling, we fall back to the default error boundary.\n\t\t\t// if users want to handle this error differently, they can render\n\t\t\t// their own error screen before the TldrawEditor component\n\t\t\tthrow store.error\n\t\t}\n\t\tif (!store.store) {\n\t\t\treturn <LoadingScreen>Connecting...</LoadingScreen>\n\t\t}\n\n\t\tloadedStore = store.store\n\t} else {\n\t\tloadedStore = store\n\t}\n\n\tif (instanceId && loadedStore.props.instanceId !== instanceId) {\n\t\tconsole.error(\n\t\t\t`The store's instanceId (${loadedStore.props.instanceId}) does not match the instanceId prop (${instanceId}). This may cause unexpected behavior.`\n\t\t)\n\t}\n\n\tif (userId && loadedStore.props.userId !== userId) {\n\t\tconsole.error(\n\t\t\t`The store's userId (${loadedStore.props.userId}) does not match the userId prop (${userId}). This may cause unexpected behavior.`\n\t\t)\n\t}\n\n\tif (preloadingError) {\n\t\treturn <ErrorScreen>Could not load assets. Please refresh the page.</ErrorScreen>\n\t}\n\n\tif (!preloadingComplete) {\n\t\treturn <LoadingScreen>Loading assets...</LoadingScreen>\n\t}\n\n\treturn <TldrawEditorAfterLoading {...props} store={loadedStore} config={config} />\n}\n\nfunction TldrawEditorAfterLoading({\n\tonMount,\n\tconfig,\n\tisDarkMode,\n\tchildren,\n\tonCreateAssetFromFile,\n\tonCreateBookmarkFromUrl,\n\tstore,\n}: Omit<TldrawEditorProps, 'store' | 'config' | 'instanceId' | 'userId'> & {\n\tconfig: TldrawEditorConfig\n\tstore: TLStore\n}) {\n\tconst container = useContainer()\n\n\tconst [app, setApp] = React.useState<App | null>(null)\n\n\tReact.useLayoutEffect(() => {\n\t\tconst app = new App({\n\t\t\tstore,\n\t\t\tgetContainer: () => container,\n\t\t\tconfig,\n\t\t})\n\t\tsetApp(app)\n\t\t;(window as any).app = app\n\t\treturn () => {\n\t\t\tapp.dispose()\n\t\t\tsetApp((prevApp) => (prevApp === app ? null : prevApp))\n\t\t}\n\t}, [container, config, store])\n\n\tReact.useEffect(() => {\n\t\tif (app) {\n\t\t\t// Overwrite the default onCreateAssetFromFile handler.\n\t\t\tif (onCreateAssetFromFile) {\n\t\t\t\tapp.onCreateAssetFromFile = onCreateAssetFromFile\n\t\t\t}\n\n\t\t\tif (onCreateBookmarkFromUrl) {\n\t\t\t\tapp.onCreateBookmarkFromUrl = onCreateBookmarkFromUrl\n\t\t\t}\n\t\t}\n\t}, [app, isDarkMode, onCreateAssetFromFile, onCreateBookmarkFromUrl])\n\n\tconst onMountEvent = useEvent((app: App) => onMount?.(app))\n\tReact.useEffect(() => {\n\t\tif (app) {\n\t\t\t// Set the initial theme state.\n\t\t\tif (isDarkMode !== undefined) {\n\t\t\t\tapp.updateUserDocumentSettings({ isDarkMode })\n\t\t\t}\n\n\t\t\t// Run onMount\n\t\t\twindow.tldrawReady = true\n\t\t\tonMountEvent(app)\n\t\t}\n\t}, [app, onMountEvent, isDarkMode])\n\n\tconst crashingError = useSyncExternalStore(\n\t\tuseCallback(\n\t\t\t(onStoreChange) => {\n\t\t\t\tif (app) {\n\t\t\t\t\tapp.on('crash', onStoreChange)\n\t\t\t\t\treturn () => app.off('crash', onStoreChange)\n\t\t\t\t}\n\t\t\t\treturn () => {\n\t\t\t\t\t// noop\n\t\t\t\t}\n\t\t\t},\n\t\t\t[app]\n\t\t),\n\t\t() => app?.crashingError ?? null\n\t)\n\n\tif (!app) {\n\t\treturn null\n\t}\n\n\treturn (\n\t\t// the top-level tldraw component also renders an error boundary almost\n\t\t// identical to this one. the reason we have two is because this one has\n\t\t// access to `App`, which means that here we can enrich errors with data\n\t\t// from app for reporting, and also still attempt to render the user's\n\t\t// document in the event of an error to reassure them that their work is\n\t\t// not lost.\n\t\t<ErrorBoundary\n\t\t\tfallback={(error) => <ErrorFallback error={error} app={app} />}\n\t\t\tonError={(error) => app.annotateError(error, { origin: 'react.tldraw', willCrashApp: true })}\n\t\t>\n\t\t\t{crashingError ? (\n\t\t\t\t<ErrorFallback error={crashingError} app={app} />\n\t\t\t) : (\n\t\t\t\t<AppContext.Provider value={app}>\n\t\t\t\t\t<Layout>{children}</Layout>\n\t\t\t\t</AppContext.Provider>\n\t\t\t)}\n\t\t</ErrorBoundary>\n\t)\n}\n\n/** @public */\nexport function LoadingScreen({ children }: { children: any }) {\n\treturn (\n\t\t<div className=\"rs-loading\">\n\t\t\t<Spinner />\n\t\t\t{children}\n\t\t</div>\n\t)\n}\n\n/** @public */\nexport function ErrorScreen({ children }: { children: any }) {\n\treturn <div className=\"rs-loading\">{children}</div>\n}\n","import { assert } from '@tldraw/utils'\nimport { useCallback, useDebugValue, useLayoutEffect, useRef } from 'react'\n\n/**\n * Allows you to define event handlers that can read the latest props/state but\n * has a stable function identity.\n *\n * These event callbacks may not be called in React render functions! An error\n * won't be thrown, but in the real implementation it would be!\n *\n * Uses a modified version of the user-land implementation included in the\n * [`useEvent()` RFC][1]. Our version until such a hook is available natively.\n *\n * The RFC was closed on 27 September 2022, the React team plans to come up with\n * a new RFC to provide similar functionality in the future. We will migrate to\n * this functionality when available.\n *\n * IMPORTANT CAVEAT: You should not call event callbacks in layout effects of\n * React component children! Internally this hook uses a layout effect and\n * parent component layout effects run after child component layout effects. Use\n * this hook responsibly.\n *\n * [1]: https://github.com/reactjs/rfcs/pull/220\n *\n * @internal\n */\nexport function useEvent<Args extends Array<unknown>, Result>(\n\thandler: (...args: Args) => Result\n): (...args: Args) => Result {\n\tconst handlerRef = useRef<(...args: Args) => Result>()\n\n\t// In a real implementation, this would run before layout effects\n\tuseLayoutEffect(() => {\n\t\thandlerRef.current = handler\n\t})\n\n\tuseDebugValue(handler)\n\n\treturn useCallback((...args: Args) => {\n\t\t// In a real implementation, this would throw if called during render\n\t\tconst fn = handlerRef.current\n\t\tassert(fn, 'fn does not exist')\n\t\treturn fn(...args)\n\t}, [])\n}\n","const instanceOfAny = (object, constructors) => constructors.some((c) => object instanceof c);\n\nlet idbProxyableTypes;\nlet cursorAdvanceMethods;\n// This is a function to prevent it throwing up in node environments.\nfunction getIdbProxyableTypes() {\n    return (idbProxyableTypes ||\n        (idbProxyableTypes = [\n            IDBDatabase,\n            IDBObjectStore,\n            IDBIndex,\n            IDBCursor,\n            IDBTransaction,\n        ]));\n}\n// This is a function to prevent it throwing up in node environments.\nfunction getCursorAdvanceMethods() {\n    return (cursorAdvanceMethods ||\n        (cursorAdvanceMethods = [\n            IDBCursor.prototype.advance,\n            IDBCursor.prototype.continue,\n            IDBCursor.prototype.continuePrimaryKey,\n        ]));\n}\nconst cursorRequestMap = new WeakMap();\nconst transactionDoneMap = new WeakMap();\nconst transactionStoreNamesMap = new WeakMap();\nconst transformCache = new WeakMap();\nconst reverseTransformCache = new WeakMap();\nfunction promisifyRequest(request) {\n    const promise = new Promise((resolve, reject) => {\n        const unlisten = () => {\n            request.removeEventListener('success', success);\n            request.removeEventListener('error', error);\n        };\n        const success = () => {\n            resolve(wrap(request.result));\n            unlisten();\n        };\n        const error = () => {\n            reject(request.error);\n            unlisten();\n        };\n        request.addEventListener('success', success);\n        request.addEventListener('error', error);\n    });\n    promise\n        .then((value) => {\n        // Since cursoring reuses the IDBRequest (*sigh*), we cache it for later retrieval\n        // (see wrapFunction).\n        if (value instanceof IDBCursor) {\n            cursorRequestMap.set(value, request);\n        }\n        // Catching to avoid \"Uncaught Promise exceptions\"\n    })\n        .catch(() => { });\n    // This mapping exists in reverseTransformCache but doesn't doesn't exist in transformCache. This\n    // is because we create many promises from a single IDBRequest.\n    reverseTransformCache.set(promise, request);\n    return promise;\n}\nfunction cacheDonePromiseForTransaction(tx) {\n    // Early bail if we've already created a done promise for this transaction.\n    if (transactionDoneMap.has(tx))\n        return;\n    const done = new Promise((resolve, reject) => {\n        const unlisten = () => {\n            tx.removeEventListener('complete', complete);\n            tx.removeEventListener('error', error);\n            tx.removeEventListener('abort', error);\n        };\n        const complete = () => {\n            resolve();\n            unlisten();\n        };\n        const error = () => {\n            reject(tx.error || new DOMException('AbortError', 'AbortError'));\n            unlisten();\n        };\n        tx.addEventListener('complete', complete);\n        tx.addEventListener('error', error);\n        tx.addEventListener('abort', error);\n    });\n    // Cache it for later retrieval.\n    transactionDoneMap.set(tx, done);\n}\nlet idbProxyTraps = {\n    get(target, prop, receiver) {\n        if (target instanceof IDBTransaction) {\n            // Special handling for transaction.done.\n            if (prop === 'done')\n                return transactionDoneMap.get(target);\n            // Polyfill for objectStoreNames because of Edge.\n            if (prop === 'objectStoreNames') {\n                return target.objectStoreNames || transactionStoreNamesMap.get(target);\n            }\n            // Make tx.store return the only store in the transaction, or undefined if there are many.\n            if (prop === 'store') {\n                return receiver.objectStoreNames[1]\n                    ? undefined\n                    : receiver.objectStore(receiver.objectStoreNames[0]);\n            }\n        }\n        // Else transform whatever we get back.\n        return wrap(target[prop]);\n    },\n    set(target, prop, value) {\n        target[prop] = value;\n        return true;\n    },\n    has(target, prop) {\n        if (target instanceof IDBTransaction &&\n            (prop === 'done' || prop === 'store')) {\n            return true;\n        }\n        return prop in target;\n    },\n};\nfunction replaceTraps(callback) {\n    idbProxyTraps = callback(idbProxyTraps);\n}\nfunction wrapFunction(func) {\n    // Due to expected object equality (which is enforced by the caching in `wrap`), we\n    // only create one new func per func.\n    // Edge doesn't support objectStoreNames (booo), so we polyfill it here.\n    if (func === IDBDatabase.prototype.transaction &&\n        !('objectStoreNames' in IDBTransaction.prototype)) {\n        return function (storeNames, ...args) {\n            const tx = func.call(unwrap(this), storeNames, ...args);\n            transactionStoreNamesMap.set(tx, storeNames.sort ? storeNames.sort() : [storeNames]);\n            return wrap(tx);\n        };\n    }\n    // Cursor methods are special, as the behaviour is a little more different to standard IDB. In\n    // IDB, you advance the cursor and wait for a new 'success' on the IDBRequest that gave you the\n    // cursor. It's kinda like a promise that can resolve with many values. That doesn't make sense\n    // with real promises, so each advance methods returns a new promise for the cursor object, or\n    // undefined if the end of the cursor has been reached.\n    if (getCursorAdvanceMethods().includes(func)) {\n        return function (...args) {\n            // Calling the original function with the proxy as 'this' causes ILLEGAL INVOCATION, so we use\n            // the original object.\n            func.apply(unwrap(this), args);\n            return wrap(cursorRequestMap.get(this));\n        };\n    }\n    return function (...args) {\n        // Calling the original function with the proxy as 'this' causes ILLEGAL INVOCATION, so we use\n        // the original object.\n        return wrap(func.apply(unwrap(this), args));\n    };\n}\nfunction transformCachableValue(value) {\n    if (typeof value === 'function')\n        return wrapFunction(value);\n    // This doesn't return, it just creates a 'done' promise for the transaction,\n    // which is later returned for transaction.done (see idbObjectHandler).\n    if (value instanceof IDBTransaction)\n        cacheDonePromiseForTransaction(value);\n    if (instanceOfAny(value, getIdbProxyableTypes()))\n        return new Proxy(value, idbProxyTraps);\n    // Return the same value back if we're not going to transform it.\n    return value;\n}\nfunction wrap(value) {\n    // We sometimes generate multiple promises from a single IDBRequest (eg when cursoring), because\n    // IDB is weird and a single IDBRequest can yield many responses, so these can't be cached.\n    if (value instanceof IDBRequest)\n        return promisifyRequest(value);\n    // If we've already transformed this value before, reuse the transformed value.\n    // This is faster, but it also provides object equality.\n    if (transformCache.has(value))\n        return transformCache.get(value);\n    const newValue = transformCachableValue(value);\n    // Not all types are transformed.\n    // These may be primitive types, so they can't be WeakMap keys.\n    if (newValue !== value) {\n        transformCache.set(value, newValue);\n        reverseTransformCache.set(newValue, value);\n    }\n    return newValue;\n}\nconst unwrap = (value) => reverseTransformCache.get(value);\n\nexport { reverseTransformCache as a, instanceOfAny as i, replaceTraps as r, unwrap as u, wrap as w };\n","import { w as wrap, r as replaceTraps } from './wrap-idb-value.js';\nexport { u as unwrap, w as wrap } from './wrap-idb-value.js';\n\n/**\n * Open a database.\n *\n * @param name Name of the database.\n * @param version Schema version.\n * @param callbacks Additional callbacks.\n */\nfunction openDB(name, version, { blocked, upgrade, blocking, terminated } = {}) {\n    const request = indexedDB.open(name, version);\n    const openPromise = wrap(request);\n    if (upgrade) {\n        request.addEventListener('upgradeneeded', (event) => {\n            upgrade(wrap(request.result), event.oldVersion, event.newVersion, wrap(request.transaction), event);\n        });\n    }\n    if (blocked) {\n        request.addEventListener('blocked', (event) => blocked(\n        // Casting due to https://github.com/microsoft/TypeScript-DOM-lib-generator/pull/1405\n        event.oldVersion, event.newVersion, event));\n    }\n    openPromise\n        .then((db) => {\n        if (terminated)\n            db.addEventListener('close', () => terminated());\n        if (blocking) {\n            db.addEventListener('versionchange', (event) => blocking(event.oldVersion, event.newVersion, event));\n        }\n    })\n        .catch(() => { });\n    return openPromise;\n}\n/**\n * Delete a database.\n *\n * @param name Name of the database.\n */\nfunction deleteDB(name, { blocked } = {}) {\n    const request = indexedDB.deleteDatabase(name);\n    if (blocked) {\n        request.addEventListener('blocked', (event) => blocked(\n        // Casting due to https://github.com/microsoft/TypeScript-DOM-lib-generator/pull/1405\n        event.oldVersion, event));\n    }\n    return wrap(request).then(() => undefined);\n}\n\nconst readMethods = ['get', 'getKey', 'getAll', 'getAllKeys', 'count'];\nconst writeMethods = ['put', 'add', 'delete', 'clear'];\nconst cachedMethods = new Map();\nfunction getMethod(target, prop) {\n    if (!(target instanceof IDBDatabase &&\n        !(prop in target) &&\n        typeof prop === 'string')) {\n        return;\n    }\n    if (cachedMethods.get(prop))\n        return cachedMethods.get(prop);\n    const targetFuncName = prop.replace(/FromIndex$/, '');\n    const useIndex = prop !== targetFuncName;\n    const isWrite = writeMethods.includes(targetFuncName);\n    if (\n    // Bail if the target doesn't exist on the target. Eg, getAll isn't in Edge.\n    !(targetFuncName in (useIndex ? IDBIndex : IDBObjectStore).prototype) ||\n        !(isWrite || readMethods.includes(targetFuncName))) {\n        return;\n    }\n    const method = async function (storeName, ...args) {\n        // isWrite ? 'readwrite' : undefined gzipps better, but fails in Edge :(\n        const tx = this.transaction(storeName, isWrite ? 'readwrite' : 'readonly');\n        let target = tx.store;\n        if (useIndex)\n            target = target.index(args.shift());\n        // Must reject if op rejects.\n        // If it's a write operation, must reject if tx.done rejects.\n        // Must reject with op rejection first.\n        // Must resolve with op value.\n        // Must handle both promises (no unhandled rejections)\n        return (await Promise.all([\n            target[targetFuncName](...args),\n            isWrite && tx.done,\n        ]))[0];\n    };\n    cachedMethods.set(prop, method);\n    return method;\n}\nreplaceTraps((oldTraps) => ({\n    ...oldTraps,\n    get: (target, prop, receiver) => getMethod(target, prop) || oldTraps.get(target, prop, receiver),\n    has: (target, prop) => !!getMethod(target, prop) || oldTraps.has(target, prop),\n}));\n\nexport { deleteDB, openDB };\n","import { TLInstance, TLInstanceId, TLUser, uniqueId } from '@tldraw/editor'\nimport { Store } from '@tldraw/tlstore'\nimport { atom, react } from 'signia'\n\nconst tabIdKey = 'TLDRAW_TAB_ID_v2' as const\n\nconst window = globalThis.window as\n\t| {\n\t\t\tnavigator: Window['navigator']\n\t\t\tlocalStorage: Window['localStorage']\n\t\t\tsessionStorage: Window['sessionStorage']\n\t\t\taddEventListener: Window['addEventListener']\n\t\t\tTLDRAW_TAB_ID_v2?: string\n\t  }\n\t| undefined\n\n// https://stackoverflow.com/a/9039885\nfunction iOS() {\n\tif (!window) return false\n\treturn (\n\t\t['iPad Simulator', 'iPhone Simulator', 'iPod Simulator', 'iPad', 'iPhone', 'iPod'].includes(\n\t\t\twindow.navigator.platform\n\t\t) ||\n\t\t// iPad on iOS 13 detection\n\t\t(window.navigator.userAgent.includes('Mac') && 'ontouchend' in document)\n\t)\n}\n\n// the id of the user, stored in localStorage so that it persists across sessions\nconst USER_DATA_KEY = 'TLDRAW_USER_DATA_v2'\n\nconst globalUserData = atom<TLUser>(\n\t'globalUserData',\n\tJSON.parse(window?.localStorage.getItem(USER_DATA_KEY) || 'null') ?? TLUser.create({})\n)\n\nreact('set global user data', () => {\n\tif (window) {\n\t\twindow.localStorage.setItem(USER_DATA_KEY, JSON.stringify(globalUserData.value))\n\t}\n})\n\n/** @public */\nexport function getUserData() {\n\treturn globalUserData.value\n}\n\n/** @public */\nexport function subscribeToUserData(store: Store<any>) {\n\tconst userId = globalUserData.value.id\n\treturn store.listen(({ changes }) => {\n\t\tfor (const record of Object.values(changes.added)) {\n\t\t\tif (record.typeName === 'user' && userId === record.id) {\n\t\t\t\tglobalUserData.set(record)\n\t\t\t}\n\t\t}\n\t\tfor (const [_, record] of Object.values(changes.updated)) {\n\t\t\tif (record.typeName === 'user' && userId === record.id) {\n\t\t\t\tglobalUserData.set(record)\n\t\t\t}\n\t\t}\n\t})\n}\n\n// the id of the document that will be loaded if the URL doesn't contain a document id\n// again, stored in localStorage\nconst defaultDocumentKey = 'TLDRAW_DEFAULT_DOCUMENT_NAME_v2'\n/** @public */\nexport const DEFAULT_DOCUMENT_NAME =\n\t(window?.localStorage.getItem(defaultDocumentKey) as any) ?? uniqueId()\nwindow?.localStorage.setItem(defaultDocumentKey, DEFAULT_DOCUMENT_NAME)\n\n// the prefix for the IndexedDB store with the id matching either the URL's document id or the default document id\n/** @public */\nexport const STORE_PREFIX = 'TLDRAW_DOCUMENT_v2'\n\n/** @public */\nexport const TAB_ID: TLInstanceId =\n\twindow?.[tabIdKey] ?? window?.sessionStorage[tabIdKey] ?? TLInstance.createId()\nif (window) {\n\twindow[tabIdKey] = TAB_ID\n\tif (iOS()) {\n\t\t// iOS does not trigger beforeunload\n\t\t// so we need to keep the sessionStorage value around\n\t\t// and hope the user doesn't figure out a way to duplicate their tab\n\t\t// in which case they'll have two tabs with the same UI state.\n\t\t// It's not a big deal, but it's not ideal.\n\t\t// And anyway I can't see a way to duplicate a tab in iOS Safari.\n\t\twindow.sessionStorage[tabIdKey] = TAB_ID\n\t} else {\n\t\tdelete window.sessionStorage[tabIdKey]\n\t}\n}\nwindow?.addEventListener('beforeunload', () => {\n\twindow.sessionStorage[tabIdKey] = TAB_ID\n})\n\nconst dbNameIndexKey = 'TLDRAW_DB_NAME_INDEX_v2'\n\n/** @public */\nexport function getAllIndexDbNames(): string[] {\n\tconst result = JSON.parse(window?.localStorage.getItem(dbNameIndexKey) || '[]') ?? []\n\tif (!Array.isArray(result)) {\n\t\treturn []\n\t}\n\treturn result\n}\n\n/** @public */\nexport function addDbName(name: string) {\n\tconst all = new Set(getAllIndexDbNames())\n\tall.add(name)\n\twindow?.localStorage.setItem(dbNameIndexKey, JSON.stringify([...all]))\n}\n","import { TLRecord, TLStoreSchema } from '@tldraw/editor'\nimport { RecordsDiff, SerializedSchema, StoreSnapshot } from '@tldraw/tlstore'\nimport { IDBPDatabase, openDB } from 'idb'\nimport { STORE_PREFIX, addDbName, getAllIndexDbNames } from './persistence-constants'\n\nasync function withDb<T>(storeId: string, cb: (db: IDBPDatabase<unknown>) => Promise<T>) {\n\taddDbName(storeId)\n\tconst db = await openDB(storeId, 2, {\n\t\tupgrade(database) {\n\t\t\tif (!database.objectStoreNames.contains('records')) {\n\t\t\t\tdatabase.createObjectStore('records')\n\t\t\t}\n\t\t\tdatabase.createObjectStore('schema')\n\t\t},\n\t})\n\ttry {\n\t\treturn await cb(db)\n\t} finally {\n\t\tdb.close()\n\t}\n}\n\n/** @public */\nexport async function loadDataFromStore(\n\tuniversalPersistenceKey: string,\n\topts?: {\n\t\tdidCancel?: () => boolean\n\t}\n): Promise<undefined | { records: TLRecord[]; schema?: SerializedSchema }> {\n\tconst storeId = STORE_PREFIX + universalPersistenceKey\n\tif (!getAllIndexDbNames().includes(storeId)) return undefined\n\treturn await withDb(storeId, async (db) => {\n\t\tif (opts?.didCancel?.()) return undefined\n\t\tconst tx = db.transaction(['records', 'schema'], 'readonly')\n\t\tconst recordsStore = tx.objectStore('records')\n\t\tconst schemaStore = tx.objectStore('schema')\n\t\treturn {\n\t\t\trecords: await recordsStore.getAll(),\n\t\t\tschema: await schemaStore.get('schema'),\n\t\t}\n\t})\n}\n\n/** @public */\nexport async function storeChangesInIndexedDb(\n\tuniversalPersistenceKey: string,\n\tschema: TLStoreSchema,\n\tchanges: RecordsDiff<any>,\n\topts?: {\n\t\tdidCancel?: () => boolean\n\t}\n) {\n\tconst storeId = STORE_PREFIX + universalPersistenceKey\n\tawait withDb(storeId, async (db) => {\n\t\tconst tx = db.transaction(['records', 'schema'], 'readwrite')\n\t\tconst recordsStore = tx.objectStore('records')\n\t\tconst schemaStore = tx.objectStore('schema')\n\n\t\tfor (const [id, record] of Object.entries(changes.added)) {\n\t\t\tawait recordsStore.put(record, id)\n\t\t}\n\n\t\tfor (const [_prev, updated] of Object.values(changes.updated)) {\n\t\t\tawait recordsStore.put(updated, updated.id)\n\t\t}\n\n\t\tfor (const id of Object.keys(changes.removed)) {\n\t\t\tawait recordsStore.delete(id)\n\t\t}\n\n\t\tschemaStore.put(schema.serialize(), 'schema')\n\n\t\tif (opts?.didCancel?.()) return tx.abort()\n\n\t\tawait tx.done\n\t})\n}\n\n/** @public */\nexport async function storeSnapshotInIndexedDb(\n\tuniversalPersistenceKey: string,\n\tschema: TLStoreSchema,\n\tsnapshot: StoreSnapshot<any>,\n\topts?: {\n\t\tdidCancel?: () => boolean\n\t}\n) {\n\tconst storeId = STORE_PREFIX + universalPersistenceKey\n\tawait withDb(storeId, async (db) => {\n\t\tconst tx = db.transaction(['records', 'schema'], 'readwrite')\n\t\tconst recordsStore = tx.objectStore('records')\n\t\tconst schemaStore = tx.objectStore('schema')\n\n\t\tawait recordsStore.clear()\n\n\t\tfor (const [id, record] of Object.entries(snapshot)) {\n\t\t\tawait recordsStore.put(record, id)\n\t\t}\n\n\t\tschemaStore.put(schema.serialize(), 'schema')\n\n\t\tif (opts?.didCancel?.()) return tx.abort()\n\n\t\tawait tx.done\n\t})\n}\n\n/** @public */\nexport function clearDb(universalPersistenceKey: string) {\n\tconst dbId = STORE_PREFIX + universalPersistenceKey\n\tindexedDB.deleteDatabase(dbId)\n}\n","import { TLInstanceId, TLRecord, TLStore } from '@tldraw/editor'\nimport { RecordsDiff, SerializedSchema, compareSchemas, squashRecordDiffs } from '@tldraw/tlstore'\nimport { assert, hasOwnProperty } from '@tldraw/utils'\nimport { transact } from 'signia'\nimport { showCantReadFromIndexDbAlert, showCantWriteToIndexDbAlert } from './alerts'\nimport { loadDataFromStore, storeChangesInIndexedDb, storeSnapshotInIndexedDb } from './indexedDb'\n\n/** How should we debounce persists? */\nconst PERSIST_THROTTLE_MS = 350\n/** If we're in an error state, how long should we wait before retrying a write? */\nconst PERSIST_RETRY_THROTTLE_MS = 10_000\n\n/**\n * IMPORTANT!!!\n *\n * This is just a quick-n-dirty temporary solution that will be replaced with the remote sync client once it has the db integrated\n */\n\ntype SyncMessage = {\n\ttype: 'diff'\n\tinstanceId: TLInstanceId\n\tchanges: RecordsDiff<any>\n\tschema: SerializedSchema\n}\n\n// Sent by new clients when they connect\n// If another client is on the channel with a newer schema version\n// It will\ntype AnnounceMessage = {\n\ttype: 'announce'\n\tschema: SerializedSchema\n}\n\ntype Message = SyncMessage | AnnounceMessage\n\nconst msg = (msg: Message) => msg\n\n/** @public */\nexport class BroadcastChannelMock {\n\tonmessage?: (e: MessageEvent) => void\n\tconstructor(_name: string) {\n\t\t// noop\n\t}\n\tpostMessage(_msg: Message) {\n\t\t// noop\n\t}\n\tclose() {\n\t\t// noop\n\t}\n}\n\nconst BC = typeof BroadcastChannel === 'undefined' ? BroadcastChannelMock : BroadcastChannel\n\n/** @public */\nexport class TLLocalSyncClient {\n\tprivate disposables = new Set<() => void>()\n\tprivate diffQueue: RecordsDiff<any>[] = []\n\tprivate didDispose = false\n\tprivate shouldDoFullDBWrite = true\n\tprivate isReloading = false\n\treadonly universalPersistenceKey: string\n\treadonly serializedSchema: SerializedSchema\n\tprivate isDebugging = false\n\n\tinitTime = Date.now()\n\tprivate debug(...args: any[]) {\n\t\tif (this.isDebugging) {\n\t\t\t// eslint-disable-next-line no-console\n\t\t\tconsole.debug(...args)\n\t\t}\n\t}\n\tconstructor(\n\t\tpublic readonly store: TLStore,\n\t\t{\n\t\t\tuniversalPersistenceKey,\n\t\t\tonLoad,\n\t\t\tonLoadError,\n\t\t}: {\n\t\t\tuniversalPersistenceKey: string\n\t\t\tonLoad: (self: TLLocalSyncClient) => void\n\t\t\tonLoadError: (error: Error) => void\n\t\t},\n\t\tpublic readonly channel = new BC(`tldraw-tab-sync-${universalPersistenceKey}`)\n\t) {\n\t\tif (typeof window !== 'undefined') {\n\t\t\t;(window as any).tlsync = this\n\t\t}\n\t\tthis.universalPersistenceKey = universalPersistenceKey\n\n\t\tthis.serializedSchema = this.store.schema.serialize()\n\n\t\tthis.disposables.add(\n\t\t\t// Set up a subscription to changes from the store: When\n\t\t\t// the store changes (and if the change was made by the user)\n\t\t\t// then immediately send the diff to other tabs via postMessage\n\t\t\t// and schedule a persist.\n\t\t\tstore.listen(({ changes, source }) => {\n\t\t\t\tthis.debug('changes', changes, source)\n\t\t\t\tif (source === 'user') {\n\t\t\t\t\tthis.diffQueue.push(changes)\n\t\t\t\t\tthis.channel.postMessage(\n\t\t\t\t\t\tmsg({\n\t\t\t\t\t\t\ttype: 'diff',\n\t\t\t\t\t\t\tinstanceId: this.store.props.instanceId,\n\t\t\t\t\t\t\tchanges,\n\t\t\t\t\t\t\tschema: this.serializedSchema,\n\t\t\t\t\t\t})\n\t\t\t\t\t)\n\t\t\t\t\tthis.schedulePersist()\n\t\t\t\t}\n\t\t\t})\n\t\t)\n\n\t\tthis.connect(onLoad, onLoadError)\n\t}\n\n\tprivate async connect(onLoad: (client: this) => void, onLoadError: (error: Error) => void) {\n\t\tthis.debug('connecting')\n\t\tlet data:\n\t\t\t| {\n\t\t\t\t\trecords: TLRecord[]\n\t\t\t\t\tschema?: SerializedSchema\n\t\t\t  }\n\t\t\t| undefined\n\n\t\ttry {\n\t\t\tdata = await loadDataFromStore(this.universalPersistenceKey)\n\t\t} catch (error: any) {\n\t\t\tonLoadError(error)\n\t\t\tshowCantReadFromIndexDbAlert()\n\t\t\tif (typeof window !== 'undefined') {\n\t\t\t\twindow.location.reload()\n\t\t\t}\n\t\t\treturn\n\t\t}\n\n\t\tthis.debug('loaded data from store', data, 'didDispose', this.didDispose)\n\t\tif (this.didDispose) return\n\n\t\ttry {\n\t\t\tif (data) {\n\t\t\t\tconst snapshot = Object.fromEntries(data.records.map((r) => [r.id, r]))\n\t\t\t\tconst migrationResult = this.store.schema.migrateStoreSnapshot(\n\t\t\t\t\tsnapshot,\n\t\t\t\t\tdata.schema ?? this.store.schema.serializeEarliestVersion()\n\t\t\t\t)\n\n\t\t\t\tif (migrationResult.type === 'error') {\n\t\t\t\t\tconsole.error('failed to migrate store', migrationResult)\n\t\t\t\t\tonLoadError(new Error(`Failed to migrate store: ${migrationResult.reason}`))\n\t\t\t\t\treturn\n\t\t\t\t}\n\n\t\t\t\t// 3. Merge the changes into the REAL STORE\n\t\t\t\tthis.store.mergeRemoteChanges(() => {\n\t\t\t\t\t// Calling put will validate the records!\n\t\t\t\t\tthis.store.put(Object.values(migrationResult.value), 'initialize')\n\t\t\t\t})\n\t\t\t}\n\n\t\t\tthis.channel.onmessage = ({ data }) => {\n\t\t\t\tthis.debug('got message', data)\n\t\t\t\tconst msg = data as Message\n\t\t\t\t// if their schema is eralier than ours, we need to tell them so they can refresh\n\t\t\t\t// if their schema is later than ours, we need to refresh\n\t\t\t\tconst comparison = compareSchemas(\n\t\t\t\t\tthis.serializedSchema,\n\t\t\t\t\tmsg.schema ?? this.store.schema.serializeEarliestVersion()\n\t\t\t\t)\n\t\t\t\tif (comparison === -1) {\n\t\t\t\t\t// we are older, refresh\n\t\t\t\t\t// but add a safety check to make sure we don't get in an infnite loop\n\t\t\t\t\tconst timeSinceInit = Date.now() - this.initTime\n\t\t\t\t\tif (timeSinceInit < 5000) {\n\t\t\t\t\t\t// This tab was just reloaded, but is out of date compared to other tabs.\n\t\t\t\t\t\t// Not expecting this to ever happen. It should only happen if we roll back a release that incremented\n\t\t\t\t\t\t// the schema version (which we should never do)\n\t\t\t\t\t\t// Or maybe during development if you have multiple local tabs open running the app on prod mode and you\n\t\t\t\t\t\t// check out an older commit. Dev server should be fine.\n\t\t\t\t\t\tonLoadError(new Error('Schema mismatch, please close other tabs and reload the page'))\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\t\t\t\t\tthis.debug('reloading')\n\t\t\t\t\tthis.isReloading = true\n\t\t\t\t\twindow?.location?.reload?.()\n\t\t\t\t\treturn\n\t\t\t\t} else if (comparison === 1) {\n\t\t\t\t\t// they are older, tell them to refresh and not write any more data\n\t\t\t\t\tthis.debug('telling them to reload')\n\t\t\t\t\tthis.channel.postMessage({ type: 'announce', schema: this.serializedSchema })\n\t\t\t\t\t// schedule a full db write in case they wrote data anyway\n\t\t\t\t\tthis.shouldDoFullDBWrite = true\n\t\t\t\t\tthis.persistIfNeeded()\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\t// otherwise, all good, same version :)\n\t\t\t\tif (msg.type === 'diff') {\n\t\t\t\t\tthis.debug('applying diff')\n\t\t\t\t\tconst doesDeleteInstance = hasOwnProperty(\n\t\t\t\t\t\tmsg.changes.removed,\n\t\t\t\t\t\tthis.store.props.instanceId\n\t\t\t\t\t)\n\t\t\t\t\ttransact(() => {\n\t\t\t\t\t\tthis.store.mergeRemoteChanges(() => {\n\t\t\t\t\t\t\tthis.store.applyDiff(msg.changes)\n\t\t\t\t\t\t})\n\t\t\t\t\t\tif (doesDeleteInstance) {\n\t\t\t\t\t\t\tthis.store.ensureStoreIsUsable()\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.channel.postMessage({ type: 'announce', schema: this.serializedSchema })\n\t\t\tthis.disposables.add(() => {\n\t\t\t\tthis.channel.close()\n\t\t\t})\n\t\t\tonLoad(this)\n\t\t} catch (e: any) {\n\t\t\tthis.debug('error loading data from store', e)\n\t\t\tif (this.didDispose) return\n\t\t\tonLoadError(e)\n\t\t\treturn\n\t\t}\n\t}\n\n\tclose() {\n\t\tthis.debug('closing')\n\t\tthis.didDispose = true\n\t\tthis.disposables.forEach((d) => d())\n\t}\n\n\tprivate isPersisting = false\n\tprivate didLastWriteError = false\n\tprivate scheduledPersistTimeout: ReturnType<typeof setTimeout> | null = null\n\n\t/**\n\t * Schedule a persist. Persists don't happen immediately: they are throttled to\n\t * avoid writing too often, and will retry if failed.\n\t * @internal\n\t */\n\tprivate schedulePersist() {\n\t\tthis.debug('schedulePersist', this.scheduledPersistTimeout)\n\t\tif (this.scheduledPersistTimeout) return\n\t\tthis.scheduledPersistTimeout = setTimeout(\n\t\t\t() => {\n\t\t\t\tthis.scheduledPersistTimeout = null\n\t\t\t\tthis.persistIfNeeded()\n\t\t\t},\n\t\t\tthis.didLastWriteError ? PERSIST_RETRY_THROTTLE_MS : PERSIST_THROTTLE_MS\n\t\t)\n\t}\n\n\t/**\n\t * Persist to indexeddb only under certain circumstances:\n\t * - if we're not already persisting\n\t * - if we're not reloading the page\n\t * - and we have something to persist (a full db write scheduled or changes in the diff queue)\n\t *\n\t * @internal\n\t */\n\tprivate persistIfNeeded() {\n\t\tthis.debug('persistIfNeeded', {\n\t\t\tisPersisting: this.isPersisting,\n\t\t\tisReloading: this.isReloading,\n\t\t\tshouldDoFullDBWrite: this.shouldDoFullDBWrite,\n\t\t\tdiffQueueLength: this.diffQueue.length,\n\t\t\tstoreIsPossiblyCorrupt: this.store.isPossiblyCorrupted(),\n\t\t})\n\n\t\t// if we've scheduled a persist for the future, that's no longer needed\n\t\tif (this.scheduledPersistTimeout) {\n\t\t\tclearTimeout(this.scheduledPersistTimeout)\n\t\t\tthis.scheduledPersistTimeout = null\n\t\t}\n\n\t\t// if a persist is already in progress, we don't need to do anything -\n\t\t// if there are still outstanding changes once it's finished, it'll\n\t\t// schedule another persist\n\t\tif (this.isPersisting) return\n\n\t\t// if we're reloading the page, it's because there's a newer client\n\t\t// present so lets not overwrite their changes\n\t\tif (this.isReloading) return\n\n\t\t// if the store is possibly corrupted, we don't want to persist\n\t\tif (this.store.isPossiblyCorrupted()) return\n\n\t\t// if we're scheduled for a full write or if we have changes outstanding, let's persist them!\n\t\tif (this.shouldDoFullDBWrite || this.diffQueue.length > 0) {\n\t\t\tthis.doPersist()\n\t\t}\n\t}\n\n\t/**\n\t * Actually persist to indexeddb. If the write fails, then we'll\n\t * retry with a full db write after a short delay.\n\t */\n\tprivate async doPersist() {\n\t\tassert(!this.isPersisting, 'persist already in progress')\n\t\tthis.isPersisting = true\n\n\t\tthis.debug('doPersist start')\n\n\t\t// instantly empty the diff queue, but keep our own copy of it. this way\n\t\t// diffs that come in during the persist will still get tracked\n\t\tconst diffQueue = this.diffQueue\n\t\tthis.diffQueue = []\n\n\t\ttry {\n\t\t\tif (this.shouldDoFullDBWrite) {\n\t\t\t\tthis.shouldDoFullDBWrite = false\n\t\t\t\tawait storeSnapshotInIndexedDb(\n\t\t\t\t\tthis.universalPersistenceKey,\n\t\t\t\t\tthis.store.schema,\n\t\t\t\t\tthis.store.serialize(),\n\t\t\t\t\t{\n\t\t\t\t\t\tdidCancel: () => this.didDispose,\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t} else {\n\t\t\t\tconst diffs = squashRecordDiffs(diffQueue)\n\t\t\t\tawait storeChangesInIndexedDb(this.universalPersistenceKey, this.store.schema, diffs)\n\t\t\t}\n\t\t\tthis.didLastWriteError = false\n\t\t} catch (e) {\n\t\t\t// set this.shouldDoFullDBWrite because we clear the diffQueue no matter what,\n\t\t\t// so if this is just a temporary error, we will still persist all changes\n\t\t\tthis.shouldDoFullDBWrite = true\n\t\t\tthis.didLastWriteError = true\n\t\t\tconsole.error('failed to store changes in indexed db', e)\n\n\t\t\tshowCantWriteToIndexDbAlert()\n\t\t\tif (typeof window !== 'undefined') {\n\t\t\t\t// adios\n\t\t\t\twindow.location.reload()\n\t\t\t}\n\t\t}\n\n\t\tthis.isPersisting = false\n\t\tthis.debug('doPersist end')\n\n\t\t// changes might have come in between when we started the persist and\n\t\t// now. we request another persist so any new changes can get written\n\t\tthis.schedulePersist()\n\t}\n}\n","/** @public */\nexport function showCantWriteToIndexDbAlert() {\n\twindow.alert(\n\t\t`Oops! We could not save changes to your browser's storage. We now need to reload the page and try again.\n\nKeep seeing this message?\n If you're using tldraw in a private or \"incognito\" window, try loading tldraw in a regular window or in a different browser.\n If your hard disk is full, try clearing up some space and then reload the page.`\n\t)\n}\n\n/** @public */\nexport function showCantReadFromIndexDbAlert() {\n\twindow.alert(\n\t\t`Oops! We could not access to your browser's storageand the app won't work correctly without that. We now need to reload the page and try again.\n\nKeep seeing this message?\n If you're using tldraw in a private or \"incognito\" window, try loading tldraw in a regular window or in a different browser.`\n\t)\n}\n","import { deleteDB } from 'idb'\nimport { getAllIndexDbNames } from './persistence-constants'\n\n/** @public */\nexport async function hardReset({ shouldReload = true } = {}) {\n\tsessionStorage.clear()\n\n\tawait Promise.all(getAllIndexDbNames().map((db) => deleteDB(db)))\n\n\tlocalStorage.clear()\n\tif (shouldReload) {\n\t\twindow.location.reload()\n\t}\n}\n\nif (typeof window !== 'undefined') {\n\tif (process.env.NODE_ENV === 'development') {\n\t\t;(window as any).hardReset = hardReset\n\t}\n\t// window.__tldraw__hardReset is used to inject the logic into the tldraw library\n\t;(window as any).__tldraw__hardReset = hardReset\n}\n","import { SyncedStore, TldrawEditorConfig, TLInstanceId, TLUserId, uniqueId } from '@tldraw/editor'\nimport { useEffect, useState } from 'react'\nimport '../hardReset'\nimport { subscribeToUserData } from '../persistence-constants'\nimport { TLLocalSyncClient } from '../TLLocalSyncClient'\n\n/**\n * This is a temporary solution that will be replaced with the remote sync client once it has the db integrated\n * @public\n */\nexport function useLocalSyncClient({\n\tuniversalPersistenceKey,\n\tinstanceId,\n\tuserId,\n\tconfig = TldrawEditorConfig.default,\n}: {\n\tuniversalPersistenceKey: string\n\tinstanceId: TLInstanceId\n\tuserId: TLUserId\n\tconfig?: TldrawEditorConfig\n}): SyncedStore {\n\tconst [state, setState] = useState<{ id: string; syncedStore: SyncedStore } | null>(null)\n\n\tuseEffect(() => {\n\t\tconst id = uniqueId()\n\t\tsetState({\n\t\t\tid,\n\t\t\tsyncedStore: { status: 'loading' },\n\t\t})\n\t\tconst setSyncedStore = (syncedStore: SyncedStore) => {\n\t\t\tsetState((prev) => {\n\t\t\t\tif (prev?.id === id) {\n\t\t\t\t\treturn { id, syncedStore }\n\t\t\t\t}\n\t\t\t\treturn prev\n\t\t\t})\n\t\t}\n\n\t\tconst store = config.createStore({ userId, instanceId })\n\n\t\tconst client = new TLLocalSyncClient(store, {\n\t\t\tuniversalPersistenceKey,\n\t\t\tonLoad() {\n\t\t\t\tsetSyncedStore({ status: 'synced', store })\n\t\t\t},\n\t\t\tonLoadError(err) {\n\t\t\t\tsetSyncedStore({ status: 'error', error: err })\n\t\t\t},\n\t\t})\n\n\t\tconst userDataUnsubcribe = subscribeToUserData(store)\n\n\t\treturn () => {\n\t\t\tsetState((prevState) => (prevState?.id === id ? null : prevState))\n\t\t\tuserDataUnsubcribe()\n\t\t\tclient.close()\n\t\t}\n\t}, [instanceId, universalPersistenceKey, config, userId])\n\n\treturn state?.syncedStore ?? { status: 'loading' }\n}\n","export default function _extends() {\n  _extends = Object.assign ? Object.assign.bind() : function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends.apply(this, arguments);\n}","function composeEventHandlers<E>(\n  originalEventHandler?: (event: E) => void,\n  ourEventHandler?: (event: E) => void,\n  { checkForDefaultPrevented = true } = {}\n) {\n  return function handleEvent(event: E) {\n    originalEventHandler?.(event);\n\n    if (checkForDefaultPrevented === false || !((event as unknown) as Event).defaultPrevented) {\n      return ourEventHandler?.(event);\n    }\n  };\n}\n\nexport { composeEventHandlers };\n","import * as React from 'react';\n\ntype PossibleRef<T> = React.Ref<T> | undefined;\n\n/**\n * Set a given ref to a given value\n * This utility takes care of different types of refs: callback refs and RefObject(s)\n */\nfunction setRef<T>(ref: PossibleRef<T>, value: T) {\n  if (typeof ref === 'function') {\n    ref(value);\n  } else if (ref !== null && ref !== undefined) {\n    (ref as React.MutableRefObject<T>).current = value;\n  }\n}\n\n/**\n * A utility to compose multiple refs together\n * Accepts callback refs and RefObject(s)\n */\nfunction composeRefs<T>(...refs: PossibleRef<T>[]) {\n  return (node: T) => refs.forEach((ref) => setRef(ref, node));\n}\n\n/**\n * A custom hook that composes multiple refs\n * Accepts callback refs and RefObject(s)\n */\nfunction useComposedRefs<T>(...refs: PossibleRef<T>[]) {\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  return React.useCallback(composeRefs(...refs), refs);\n}\n\nexport { composeRefs, useComposedRefs };\n","import * as React from 'react';\n\nfunction createContext<ContextValueType extends object | null>(\n  rootComponentName: string,\n  defaultContext?: ContextValueType\n) {\n  const Context = React.createContext<ContextValueType | undefined>(defaultContext);\n\n  function Provider(props: ContextValueType & { children: React.ReactNode }) {\n    const { children, ...context } = props;\n    // Only re-memoize when prop values change\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    const value = React.useMemo(() => context, Object.values(context)) as ContextValueType;\n    return <Context.Provider value={value}>{children}</Context.Provider>;\n  }\n\n  function useContext(consumerName: string) {\n    const context = React.useContext(Context);\n    if (context) return context;\n    if (defaultContext !== undefined) return defaultContext;\n    // if a defaultContext wasn't specified, it's a required context.\n    throw new Error(`\\`${consumerName}\\` must be used within \\`${rootComponentName}\\``);\n  }\n\n  Provider.displayName = rootComponentName + 'Provider';\n  return [Provider, useContext] as const;\n}\n\n/* -------------------------------------------------------------------------------------------------\n * createContextScope\n * -----------------------------------------------------------------------------------------------*/\n\ntype Scope<C = any> = { [scopeName: string]: React.Context<C>[] } | undefined;\ntype ScopeHook = (scope: Scope) => { [__scopeProp: string]: Scope };\ninterface CreateScope {\n  scopeName: string;\n  (): ScopeHook;\n}\n\nfunction createContextScope(scopeName: string, createContextScopeDeps: CreateScope[] = []) {\n  let defaultContexts: any[] = [];\n\n  /* -----------------------------------------------------------------------------------------------\n   * createContext\n   * ---------------------------------------------------------------------------------------------*/\n\n  function createContext<ContextValueType extends object | null>(\n    rootComponentName: string,\n    defaultContext?: ContextValueType\n  ) {\n    const BaseContext = React.createContext<ContextValueType | undefined>(defaultContext);\n    const index = defaultContexts.length;\n    defaultContexts = [...defaultContexts, defaultContext];\n\n    function Provider(\n      props: ContextValueType & { scope: Scope<ContextValueType>; children: React.ReactNode }\n    ) {\n      const { scope, children, ...context } = props;\n      const Context = scope?.[scopeName][index] || BaseContext;\n      // Only re-memoize when prop values change\n      // eslint-disable-next-line react-hooks/exhaustive-deps\n      const value = React.useMemo(() => context, Object.values(context)) as ContextValueType;\n      return <Context.Provider value={value}>{children}</Context.Provider>;\n    }\n\n    function useContext(consumerName: string, scope: Scope<ContextValueType | undefined>) {\n      const Context = scope?.[scopeName][index] || BaseContext;\n      const context = React.useContext(Context);\n      if (context) return context;\n      if (defaultContext !== undefined) return defaultContext;\n      // if a defaultContext wasn't specified, it's a required context.\n      throw new Error(`\\`${consumerName}\\` must be used within \\`${rootComponentName}\\``);\n    }\n\n    Provider.displayName = rootComponentName + 'Provider';\n    return [Provider, useContext] as const;\n  }\n\n  /* -----------------------------------------------------------------------------------------------\n   * createScope\n   * ---------------------------------------------------------------------------------------------*/\n\n  const createScope: CreateScope = () => {\n    const scopeContexts = defaultContexts.map((defaultContext) => {\n      return React.createContext(defaultContext);\n    });\n    return function useScope(scope: Scope) {\n      const contexts = scope?.[scopeName] || scopeContexts;\n      return React.useMemo(\n        () => ({ [`__scope${scopeName}`]: { ...scope, [scopeName]: contexts } }),\n        [scope, contexts]\n      );\n    };\n  };\n\n  createScope.scopeName = scopeName;\n  return [createContext, composeContextScopes(createScope, ...createContextScopeDeps)] as const;\n}\n\n/* -------------------------------------------------------------------------------------------------\n * composeContextScopes\n * -----------------------------------------------------------------------------------------------*/\n\nfunction composeContextScopes(...scopes: CreateScope[]) {\n  const baseScope = scopes[0];\n  if (scopes.length === 1) return baseScope;\n\n  const createScope: CreateScope = () => {\n    const scopeHooks = scopes.map((createScope) => ({\n      useScope: createScope(),\n      scopeName: createScope.scopeName,\n    }));\n\n    return function useComposedScopes(overrideScopes) {\n      const nextScopes = scopeHooks.reduce((nextScopes, { useScope, scopeName }) => {\n        // We are calling a hook inside a callback which React warns against to avoid inconsistent\n        // renders, however, scoping doesn't have render side effects so we ignore the rule.\n        // eslint-disable-next-line react-hooks/rules-of-hooks\n        const scopeProps = useScope(overrideScopes);\n        const currentScope = scopeProps[`__scope${scopeName}`];\n        return { ...nextScopes, ...currentScope };\n      }, {});\n\n      return React.useMemo(() => ({ [`__scope${baseScope.scopeName}`]: nextScopes }), [nextScopes]);\n    };\n  };\n\n  createScope.scopeName = baseScope.scopeName;\n  return createScope;\n}\n\n/* -----------------------------------------------------------------------------------------------*/\n\nexport { createContext, createContextScope };\nexport type { CreateScope, Scope };\n","import * as React from 'react';\nimport { composeRefs } from '@radix-ui/react-compose-refs';\n\n/* -------------------------------------------------------------------------------------------------\n * Slot\n * -----------------------------------------------------------------------------------------------*/\n\ninterface SlotProps extends React.HTMLAttributes<HTMLElement> {\n  children?: React.ReactNode;\n}\n\nconst Slot = React.forwardRef<HTMLElement, SlotProps>((props, forwardedRef) => {\n  const { children, ...slotProps } = props;\n  const childrenArray = React.Children.toArray(children);\n  const slottable = childrenArray.find(isSlottable);\n\n  if (slottable) {\n    // the new element to render is the one passed as a child of `Slottable`\n    const newElement = slottable.props.children as React.ReactNode;\n\n    const newChildren = childrenArray.map((child) => {\n      if (child === slottable) {\n        // because the new element will be the one rendered, we are only interested\n        // in grabbing its children (`newElement.props.children`)\n        if (React.Children.count(newElement) > 1) return React.Children.only(null);\n        return React.isValidElement(newElement)\n          ? (newElement.props.children as React.ReactNode)\n          : null;\n      } else {\n        return child;\n      }\n    });\n\n    return (\n      <SlotClone {...slotProps} ref={forwardedRef}>\n        {React.isValidElement(newElement)\n          ? React.cloneElement(newElement, undefined, newChildren)\n          : null}\n      </SlotClone>\n    );\n  }\n\n  return (\n    <SlotClone {...slotProps} ref={forwardedRef}>\n      {children}\n    </SlotClone>\n  );\n});\n\nSlot.displayName = 'Slot';\n\n/* -------------------------------------------------------------------------------------------------\n * SlotClone\n * -----------------------------------------------------------------------------------------------*/\n\ninterface SlotCloneProps {\n  children: React.ReactNode;\n}\n\nconst SlotClone = React.forwardRef<any, SlotCloneProps>((props, forwardedRef) => {\n  const { children, ...slotProps } = props;\n\n  if (React.isValidElement(children)) {\n    return React.cloneElement(children, {\n      ...mergeProps(slotProps, children.props),\n      ref: composeRefs(forwardedRef, (children as any).ref),\n    });\n  }\n\n  return React.Children.count(children) > 1 ? React.Children.only(null) : null;\n});\n\nSlotClone.displayName = 'SlotClone';\n\n/* -------------------------------------------------------------------------------------------------\n * Slottable\n * -----------------------------------------------------------------------------------------------*/\n\nconst Slottable = ({ children }: { children: React.ReactNode }) => {\n  return <>{children}</>;\n};\n\n/* ---------------------------------------------------------------------------------------------- */\n\ntype AnyProps = Record<string, any>;\n\nfunction isSlottable(child: React.ReactNode): child is React.ReactElement {\n  return React.isValidElement(child) && child.type === Slottable;\n}\n\nfunction mergeProps(slotProps: AnyProps, childProps: AnyProps) {\n  // all child props should override\n  const overrideProps = { ...childProps };\n\n  for (const propName in childProps) {\n    const slotPropValue = slotProps[propName];\n    const childPropValue = childProps[propName];\n\n    const isHandler = /^on[A-Z]/.test(propName);\n    if (isHandler) {\n      // if the handler exists on both, we compose them\n      if (slotPropValue && childPropValue) {\n        overrideProps[propName] = (...args: unknown[]) => {\n          childPropValue(...args);\n          slotPropValue(...args);\n        };\n      }\n      // but if it exists only on the slot, we use only this one\n      else if (slotPropValue) {\n        overrideProps[propName] = slotPropValue;\n      }\n    }\n    // if it's `style`, we merge them\n    else if (propName === 'style') {\n      overrideProps[propName] = { ...slotPropValue, ...childPropValue };\n    } else if (propName === 'className') {\n      overrideProps[propName] = [slotPropValue, childPropValue].filter(Boolean).join(' ');\n    }\n  }\n\n  return { ...slotProps, ...overrideProps };\n}\n\nconst Root = Slot;\n\nexport {\n  Slot,\n  Slottable,\n  //\n  Root,\n};\nexport type { SlotProps };\n","import React from 'react';\nimport { createContextScope } from '@radix-ui/react-context';\nimport { useComposedRefs } from '@radix-ui/react-compose-refs';\nimport { Slot } from '@radix-ui/react-slot';\n\nimport type * as Radix from '@radix-ui/react-primitive';\n\ntype SlotProps = Radix.ComponentPropsWithoutRef<typeof Slot>;\ntype CollectionElement = HTMLElement;\ninterface CollectionProps extends SlotProps {\n  scope: any;\n}\n\n// We have resorted to returning slots directly rather than exposing primitives that can then\n// be slotted like `<CollectionItem as={Slot}></CollectionItem>`.\n// This is because we encountered issues with generic types that cannot be statically analysed\n// due to creating them dynamically via createCollection.\n\nfunction createCollection<ItemElement extends HTMLElement, ItemData = {}>(name: string) {\n  /* -----------------------------------------------------------------------------------------------\n   * CollectionProvider\n   * ---------------------------------------------------------------------------------------------*/\n\n  const PROVIDER_NAME = name + 'CollectionProvider';\n  const [createCollectionContext, createCollectionScope] = createContextScope(PROVIDER_NAME);\n\n  type ContextValue = {\n    collectionRef: React.RefObject<CollectionElement>;\n    itemMap: Map<React.RefObject<ItemElement>, { ref: React.RefObject<ItemElement> } & ItemData>;\n  };\n\n  const [CollectionProviderImpl, useCollectionContext] = createCollectionContext<ContextValue>(\n    PROVIDER_NAME,\n    { collectionRef: { current: null }, itemMap: new Map() }\n  );\n\n  const CollectionProvider: React.FC<{ children?: React.ReactNode; scope: any }> = (props) => {\n    const { scope, children } = props;\n    const ref = React.useRef<CollectionElement>(null);\n    const itemMap = React.useRef<ContextValue['itemMap']>(new Map()).current;\n    return (\n      <CollectionProviderImpl scope={scope} itemMap={itemMap} collectionRef={ref}>\n        {children}\n      </CollectionProviderImpl>\n    );\n  };\n\n  CollectionProvider.displayName = PROVIDER_NAME;\n\n  /* -----------------------------------------------------------------------------------------------\n   * CollectionSlot\n   * ---------------------------------------------------------------------------------------------*/\n\n  const COLLECTION_SLOT_NAME = name + 'CollectionSlot';\n\n  const CollectionSlot = React.forwardRef<CollectionElement, CollectionProps>(\n    (props, forwardedRef) => {\n      const { scope, children } = props;\n      const context = useCollectionContext(COLLECTION_SLOT_NAME, scope);\n      const composedRefs = useComposedRefs(forwardedRef, context.collectionRef);\n      return <Slot ref={composedRefs}>{children}</Slot>;\n    }\n  );\n\n  CollectionSlot.displayName = COLLECTION_SLOT_NAME;\n\n  /* -----------------------------------------------------------------------------------------------\n   * CollectionItem\n   * ---------------------------------------------------------------------------------------------*/\n\n  const ITEM_SLOT_NAME = name + 'CollectionItemSlot';\n  const ITEM_DATA_ATTR = 'data-radix-collection-item';\n\n  type CollectionItemSlotProps = ItemData & {\n    children: React.ReactNode;\n    scope: any;\n  };\n\n  const CollectionItemSlot = React.forwardRef<ItemElement, CollectionItemSlotProps>(\n    (props, forwardedRef) => {\n      const { scope, children, ...itemData } = props;\n      const ref = React.useRef<ItemElement>(null);\n      const composedRefs = useComposedRefs(forwardedRef, ref);\n      const context = useCollectionContext(ITEM_SLOT_NAME, scope);\n\n      React.useEffect(() => {\n        context.itemMap.set(ref, { ref, ...(itemData as unknown as ItemData) });\n        return () => void context.itemMap.delete(ref);\n      });\n\n      return (\n        <Slot {...{ [ITEM_DATA_ATTR]: '' }} ref={composedRefs}>\n          {children}\n        </Slot>\n      );\n    }\n  );\n\n  CollectionItemSlot.displayName = ITEM_SLOT_NAME;\n\n  /* -----------------------------------------------------------------------------------------------\n   * useCollection\n   * ---------------------------------------------------------------------------------------------*/\n\n  function useCollection(scope: any) {\n    const context = useCollectionContext(name + 'CollectionConsumer', scope);\n\n    const getItems = React.useCallback(() => {\n      const collectionNode = context.collectionRef.current;\n      if (!collectionNode) return [];\n      const orderedNodes = Array.from(collectionNode.querySelectorAll(`[${ITEM_DATA_ATTR}]`));\n      const items = Array.from(context.itemMap.values());\n      const orderedItems = items.sort(\n        (a, b) => orderedNodes.indexOf(a.ref.current!) - orderedNodes.indexOf(b.ref.current!)\n      );\n      return orderedItems;\n    }, [context.collectionRef, context.itemMap]);\n\n    return getItems;\n  }\n\n  return [\n    { Provider: CollectionProvider, Slot: CollectionSlot, ItemSlot: CollectionItemSlot },\n    useCollection,\n    createCollectionScope,\n  ] as const;\n}\n\nexport { createCollection };\nexport type { CollectionProps };\n","import * as React from 'react';\nimport * as ReactDOM from 'react-dom';\nimport { Slot } from '@radix-ui/react-slot';\n\nconst NODES = [\n  'a',\n  'button',\n  'div',\n  'form',\n  'h2',\n  'h3',\n  'img',\n  'input',\n  'label',\n  'li',\n  'nav',\n  'ol',\n  'p',\n  'span',\n  'svg',\n  'ul',\n] as const;\n\n// Temporary while we await merge of this fix:\n// https://github.com/DefinitelyTyped/DefinitelyTyped/pull/55396\n// prettier-ignore\ntype PropsWithoutRef<P> = P extends any ? ('ref' extends keyof P ? Pick<P, Exclude<keyof P, 'ref'>> : P) : P;\ntype ComponentPropsWithoutRef<T extends React.ElementType> = PropsWithoutRef<\n  React.ComponentProps<T>\n>;\n\ntype Primitives = { [E in typeof NODES[number]]: PrimitiveForwardRefComponent<E> };\ntype PrimitivePropsWithRef<E extends React.ElementType> = React.ComponentPropsWithRef<E> & {\n  asChild?: boolean;\n};\n\ninterface PrimitiveForwardRefComponent<E extends React.ElementType>\n  extends React.ForwardRefExoticComponent<PrimitivePropsWithRef<E>> {}\n\n/* -------------------------------------------------------------------------------------------------\n * Primitive\n * -----------------------------------------------------------------------------------------------*/\n\nconst Primitive = NODES.reduce((primitive, node) => {\n  const Node = React.forwardRef((props: PrimitivePropsWithRef<typeof node>, forwardedRef: any) => {\n    const { asChild, ...primitiveProps } = props;\n    const Comp: any = asChild ? Slot : node;\n\n    React.useEffect(() => {\n      (window as any)[Symbol.for('radix-ui')] = true;\n    }, []);\n\n    return <Comp {...primitiveProps} ref={forwardedRef} />;\n  });\n\n  Node.displayName = `Primitive.${node}`;\n\n  return { ...primitive, [node]: Node };\n}, {} as Primitives);\n\n/* -------------------------------------------------------------------------------------------------\n * Utils\n * -----------------------------------------------------------------------------------------------*/\n\n/**\n * Flush custom event dispatch\n * https://github.com/radix-ui/primitives/pull/1378\n *\n * React batches *all* event handlers since version 18, this introduces certain considerations when using custom event types.\n *\n * Internally, React prioritises events in the following order:\n *  - discrete\n *  - continuous\n *  - default\n *\n * https://github.com/facebook/react/blob/a8a4742f1c54493df00da648a3f9d26e3db9c8b5/packages/react-dom/src/events/ReactDOMEventListener.js#L294-L350\n *\n * `discrete` is an  important distinction as updates within these events are applied immediately.\n * React however, is not able to infer the priority of custom event types due to how they are detected internally.\n * Because of this, it's possible for updates from custom events to be unexpectedly batched when\n * dispatched by another `discrete` event.\n *\n * In order to ensure that updates from custom events are applied predictably, we need to manually flush the batch.\n * This utility should be used when dispatching a custom event from within another `discrete` event, this utility\n * is not nessesary when dispatching known event types, or if dispatching a custom type inside a non-discrete event.\n * For example:\n *\n * dispatching a known click \n * target.dispatchEvent(new Event(click))\n *\n * dispatching a custom type within a non-discrete event \n * onScroll={(event) => event.target.dispatchEvent(new CustomEvent(customType))}\n *\n * dispatching a custom type within a `discrete` event \n * onPointerDown={(event) => dispatchDiscreteCustomEvent(event.target, new CustomEvent(customType))}\n *\n * Note: though React classifies `focus`, `focusin` and `focusout` events as `discrete`, it's  not recommended to use\n * this utility with them. This is because it's possible for those handlers to be called implicitly during render\n * e.g. when focus is within a component as it is unmounted, or when managing focus on mount.\n */\n\nfunction dispatchDiscreteCustomEvent<E extends CustomEvent>(target: E['target'], event: E) {\n  if (target) ReactDOM.flushSync(() => target.dispatchEvent(event));\n}\n\n/* -----------------------------------------------------------------------------------------------*/\n\nconst Root = Primitive;\n\nexport {\n  Primitive,\n  //\n  Root,\n  //\n  dispatchDiscreteCustomEvent,\n};\nexport type { ComponentPropsWithoutRef, PrimitivePropsWithRef };\n","import * as React from 'react';\n\n/**\n * A custom hook that converts a callback to a ref to avoid triggering re-renders when passed as a\n * prop or avoid re-executing effects when passed as a dependency\n */\nfunction useCallbackRef<T extends (...args: any[]) => any>(callback: T | undefined): T {\n  const callbackRef = React.useRef(callback);\n\n  React.useEffect(() => {\n    callbackRef.current = callback;\n  });\n\n  // https://github.com/facebook/react/issues/19240\n  return React.useMemo(() => ((...args) => callbackRef.current?.(...args)) as T, []);\n}\n\nexport { useCallbackRef };\n","import * as React from 'react';\nimport { composeEventHandlers } from '@radix-ui/primitive';\nimport { Primitive, dispatchDiscreteCustomEvent } from '@radix-ui/react-primitive';\nimport { useComposedRefs } from '@radix-ui/react-compose-refs';\nimport { useCallbackRef } from '@radix-ui/react-use-callback-ref';\nimport { useEscapeKeydown } from '@radix-ui/react-use-escape-keydown';\n\nimport type * as Radix from '@radix-ui/react-primitive';\n\n/* -------------------------------------------------------------------------------------------------\n * DismissableLayer\n * -----------------------------------------------------------------------------------------------*/\n\nconst DISMISSABLE_LAYER_NAME = 'DismissableLayer';\nconst CONTEXT_UPDATE = 'dismissableLayer.update';\nconst POINTER_DOWN_OUTSIDE = 'dismissableLayer.pointerDownOutside';\nconst FOCUS_OUTSIDE = 'dismissableLayer.focusOutside';\n\nlet originalBodyPointerEvents: string;\n\nconst DismissableLayerContext = React.createContext({\n  layers: new Set<DismissableLayerElement>(),\n  layersWithOutsidePointerEventsDisabled: new Set<DismissableLayerElement>(),\n  branches: new Set<DismissableLayerBranchElement>(),\n});\n\ntype DismissableLayerElement = React.ElementRef<typeof Primitive.div>;\ntype PrimitiveDivProps = Radix.ComponentPropsWithoutRef<typeof Primitive.div>;\ninterface DismissableLayerProps extends PrimitiveDivProps {\n  /**\n   * When `true`, hover/focus/click interactions will be disabled on elements outside\n   * the `DismissableLayer`. Users will need to click twice on outside elements to\n   * interact with them: once to close the `DismissableLayer`, and again to trigger the element.\n   */\n  disableOutsidePointerEvents?: boolean;\n  /**\n   * Event handler called when the escape key is down.\n   * Can be prevented.\n   */\n  onEscapeKeyDown?: (event: KeyboardEvent) => void;\n  /**\n   * Event handler called when the a `pointerdown` event happens outside of the `DismissableLayer`.\n   * Can be prevented.\n   */\n  onPointerDownOutside?: (event: PointerDownOutsideEvent) => void;\n  /**\n   * Event handler called when the focus moves outside of the `DismissableLayer`.\n   * Can be prevented.\n   */\n  onFocusOutside?: (event: FocusOutsideEvent) => void;\n  /**\n   * Event handler called when an interaction happens outside the `DismissableLayer`.\n   * Specifically, when a `pointerdown` event happens outside or focus moves outside of it.\n   * Can be prevented.\n   */\n  onInteractOutside?: (event: PointerDownOutsideEvent | FocusOutsideEvent) => void;\n  /**\n   * Handler called when the `DismissableLayer` should be dismissed\n   */\n  onDismiss?: () => void;\n}\n\nconst DismissableLayer = React.forwardRef<DismissableLayerElement, DismissableLayerProps>(\n  (props, forwardedRef) => {\n    const {\n      disableOutsidePointerEvents = false,\n      onEscapeKeyDown,\n      onPointerDownOutside,\n      onFocusOutside,\n      onInteractOutside,\n      onDismiss,\n      ...layerProps\n    } = props;\n    const context = React.useContext(DismissableLayerContext);\n    const [node, setNode] = React.useState<DismissableLayerElement | null>(null);\n    const ownerDocument = node?.ownerDocument ?? globalThis?.document;\n    const [, force] = React.useState({});\n    const composedRefs = useComposedRefs(forwardedRef, (node) => setNode(node));\n    const layers = Array.from(context.layers);\n    const [highestLayerWithOutsidePointerEventsDisabled] = [...context.layersWithOutsidePointerEventsDisabled].slice(-1); // prettier-ignore\n    const highestLayerWithOutsidePointerEventsDisabledIndex = layers.indexOf(highestLayerWithOutsidePointerEventsDisabled); // prettier-ignore\n    const index = node ? layers.indexOf(node) : -1;\n    const isBodyPointerEventsDisabled = context.layersWithOutsidePointerEventsDisabled.size > 0;\n    const isPointerEventsEnabled = index >= highestLayerWithOutsidePointerEventsDisabledIndex;\n\n    const pointerDownOutside = usePointerDownOutside((event) => {\n      const target = event.target as HTMLElement;\n      const isPointerDownOnBranch = [...context.branches].some((branch) => branch.contains(target));\n      if (!isPointerEventsEnabled || isPointerDownOnBranch) return;\n      onPointerDownOutside?.(event);\n      onInteractOutside?.(event);\n      if (!event.defaultPrevented) onDismiss?.();\n    }, ownerDocument);\n\n    const focusOutside = useFocusOutside((event) => {\n      const target = event.target as HTMLElement;\n      const isFocusInBranch = [...context.branches].some((branch) => branch.contains(target));\n      if (isFocusInBranch) return;\n      onFocusOutside?.(event);\n      onInteractOutside?.(event);\n      if (!event.defaultPrevented) onDismiss?.();\n    }, ownerDocument);\n\n    useEscapeKeydown((event) => {\n      const isHighestLayer = index === context.layers.size - 1;\n      if (!isHighestLayer) return;\n      onEscapeKeyDown?.(event);\n      if (!event.defaultPrevented && onDismiss) {\n        event.preventDefault();\n        onDismiss();\n      }\n    }, ownerDocument);\n\n    React.useEffect(() => {\n      if (!node) return;\n      if (disableOutsidePointerEvents) {\n        if (context.layersWithOutsidePointerEventsDisabled.size === 0) {\n          originalBodyPointerEvents = ownerDocument.body.style.pointerEvents;\n          ownerDocument.body.style.pointerEvents = 'none';\n        }\n        context.layersWithOutsidePointerEventsDisabled.add(node);\n      }\n      context.layers.add(node);\n      dispatchUpdate();\n      return () => {\n        if (\n          disableOutsidePointerEvents &&\n          context.layersWithOutsidePointerEventsDisabled.size === 1\n        ) {\n          ownerDocument.body.style.pointerEvents = originalBodyPointerEvents;\n        }\n      };\n    }, [node, ownerDocument, disableOutsidePointerEvents, context]);\n\n    /**\n     * We purposefully prevent combining this effect with the `disableOutsidePointerEvents` effect\n     * because a change to `disableOutsidePointerEvents` would remove this layer from the stack\n     * and add it to the end again so the layering order wouldn't be _creation order_.\n     * We only want them to be removed from context stacks when unmounted.\n     */\n    React.useEffect(() => {\n      return () => {\n        if (!node) return;\n        context.layers.delete(node);\n        context.layersWithOutsidePointerEventsDisabled.delete(node);\n        dispatchUpdate();\n      };\n    }, [node, context]);\n\n    React.useEffect(() => {\n      const handleUpdate = () => force({});\n      document.addEventListener(CONTEXT_UPDATE, handleUpdate);\n      return () => document.removeEventListener(CONTEXT_UPDATE, handleUpdate);\n    }, []);\n\n    return (\n      <Primitive.div\n        {...layerProps}\n        ref={composedRefs}\n        style={{\n          pointerEvents: isBodyPointerEventsDisabled\n            ? isPointerEventsEnabled\n              ? 'auto'\n              : 'none'\n            : undefined,\n          ...props.style,\n        }}\n        onFocusCapture={composeEventHandlers(props.onFocusCapture, focusOutside.onFocusCapture)}\n        onBlurCapture={composeEventHandlers(props.onBlurCapture, focusOutside.onBlurCapture)}\n        onPointerDownCapture={composeEventHandlers(\n          props.onPointerDownCapture,\n          pointerDownOutside.onPointerDownCapture\n        )}\n      />\n    );\n  }\n);\n\nDismissableLayer.displayName = DISMISSABLE_LAYER_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * DismissableLayerBranch\n * -----------------------------------------------------------------------------------------------*/\n\nconst BRANCH_NAME = 'DismissableLayerBranch';\n\ntype DismissableLayerBranchElement = React.ElementRef<typeof Primitive.div>;\ninterface DismissableLayerBranchProps extends PrimitiveDivProps {}\n\nconst DismissableLayerBranch = React.forwardRef<\n  DismissableLayerBranchElement,\n  DismissableLayerBranchProps\n>((props, forwardedRef) => {\n  const context = React.useContext(DismissableLayerContext);\n  const ref = React.useRef<DismissableLayerBranchElement>(null);\n  const composedRefs = useComposedRefs(forwardedRef, ref);\n\n  React.useEffect(() => {\n    const node = ref.current;\n    if (node) {\n      context.branches.add(node);\n      return () => {\n        context.branches.delete(node);\n      };\n    }\n  }, [context.branches]);\n\n  return <Primitive.div {...props} ref={composedRefs} />;\n});\n\nDismissableLayerBranch.displayName = BRANCH_NAME;\n\n/* -----------------------------------------------------------------------------------------------*/\n\ntype PointerDownOutsideEvent = CustomEvent<{ originalEvent: PointerEvent }>;\ntype FocusOutsideEvent = CustomEvent<{ originalEvent: FocusEvent }>;\n\n/**\n * Listens for `pointerdown` outside a react subtree. We use `pointerdown` rather than `pointerup`\n * to mimic layer dismissing behaviour present in OS.\n * Returns props to pass to the node we want to check for outside events.\n */\nfunction usePointerDownOutside(\n  onPointerDownOutside?: (event: PointerDownOutsideEvent) => void,\n  ownerDocument: Document = globalThis?.document\n) {\n  const handlePointerDownOutside = useCallbackRef(onPointerDownOutside) as EventListener;\n  const isPointerInsideReactTreeRef = React.useRef(false);\n  const handleClickRef = React.useRef(() => {});\n\n  React.useEffect(() => {\n    const handlePointerDown = (event: PointerEvent) => {\n      if (event.target && !isPointerInsideReactTreeRef.current) {\n        const eventDetail = { originalEvent: event };\n\n        function handleAndDispatchPointerDownOutsideEvent() {\n          handleAndDispatchCustomEvent(\n            POINTER_DOWN_OUTSIDE,\n            handlePointerDownOutside,\n            eventDetail,\n            { discrete: true }\n          );\n        }\n\n        /**\n         * On touch devices, we need to wait for a click event because browsers implement\n         * a ~350ms delay between the time the user stops touching the display and when the\n         * browser executres events. We need to ensure we don't reactivate pointer-events within\n         * this timeframe otherwise the browser may execute events that should have been prevented.\n         *\n         * Additionally, this also lets us deal automatically with cancellations when a click event\n         * isn't raised because the page was considered scrolled/drag-scrolled, long-pressed, etc.\n         *\n         * This is why we also continuously remove the previous listener, because we cannot be\n         * certain that it was raised, and therefore cleaned-up.\n         */\n        if (event.pointerType === 'touch') {\n          ownerDocument.removeEventListener('click', handleClickRef.current);\n          handleClickRef.current = handleAndDispatchPointerDownOutsideEvent;\n          ownerDocument.addEventListener('click', handleClickRef.current, { once: true });\n        } else {\n          handleAndDispatchPointerDownOutsideEvent();\n        }\n      }\n      isPointerInsideReactTreeRef.current = false;\n    };\n    /**\n     * if this hook executes in a component that mounts via a `pointerdown` event, the event\n     * would bubble up to the document and trigger a `pointerDownOutside` event. We avoid\n     * this by delaying the event listener registration on the document.\n     * This is not React specific, but rather how the DOM works, ie:\n     * ```\n     * button.addEventListener('pointerdown', () => {\n     *   console.log('I will log');\n     *   document.addEventListener('pointerdown', () => {\n     *     console.log('I will also log');\n     *   })\n     * });\n     */\n    const timerId = window.setTimeout(() => {\n      ownerDocument.addEventListener('pointerdown', handlePointerDown);\n    }, 0);\n    return () => {\n      window.clearTimeout(timerId);\n      ownerDocument.removeEventListener('pointerdown', handlePointerDown);\n      ownerDocument.removeEventListener('click', handleClickRef.current);\n    };\n  }, [ownerDocument, handlePointerDownOutside]);\n\n  return {\n    // ensures we check React component tree (not just DOM tree)\n    onPointerDownCapture: () => (isPointerInsideReactTreeRef.current = true),\n  };\n}\n\n/**\n * Listens for when focus happens outside a react subtree.\n * Returns props to pass to the root (node) of the subtree we want to check.\n */\nfunction useFocusOutside(\n  onFocusOutside?: (event: FocusOutsideEvent) => void,\n  ownerDocument: Document = globalThis?.document\n) {\n  const handleFocusOutside = useCallbackRef(onFocusOutside) as EventListener;\n  const isFocusInsideReactTreeRef = React.useRef(false);\n\n  React.useEffect(() => {\n    const handleFocus = (event: FocusEvent) => {\n      if (event.target && !isFocusInsideReactTreeRef.current) {\n        const eventDetail = { originalEvent: event };\n        handleAndDispatchCustomEvent(FOCUS_OUTSIDE, handleFocusOutside, eventDetail, {\n          discrete: false,\n        });\n      }\n    };\n    ownerDocument.addEventListener('focusin', handleFocus);\n    return () => ownerDocument.removeEventListener('focusin', handleFocus);\n  }, [ownerDocument, handleFocusOutside]);\n\n  return {\n    onFocusCapture: () => (isFocusInsideReactTreeRef.current = true),\n    onBlurCapture: () => (isFocusInsideReactTreeRef.current = false),\n  };\n}\n\nfunction dispatchUpdate() {\n  const event = new CustomEvent(CONTEXT_UPDATE);\n  document.dispatchEvent(event);\n}\n\nfunction handleAndDispatchCustomEvent<E extends CustomEvent, OriginalEvent extends Event>(\n  name: string,\n  handler: ((event: E) => void) | undefined,\n  detail: { originalEvent: OriginalEvent } & (E extends CustomEvent<infer D> ? D : never),\n  { discrete }: { discrete: boolean }\n) {\n  const target = detail.originalEvent.target;\n  const event = new CustomEvent(name, { bubbles: false, cancelable: true, detail });\n  if (handler) target.addEventListener(name, handler as EventListener, { once: true });\n\n  if (discrete) {\n    dispatchDiscreteCustomEvent(target, event);\n  } else {\n    target.dispatchEvent(event);\n  }\n}\n\nconst Root = DismissableLayer;\nconst Branch = DismissableLayerBranch;\n\nexport {\n  DismissableLayer,\n  DismissableLayerBranch,\n  //\n  Root,\n  Branch,\n};\nexport type { DismissableLayerProps };\n","import * as React from 'react';\nimport { useCallbackRef } from '@radix-ui/react-use-callback-ref';\n\n/**\n * Listens for when the escape key is down\n */\nfunction useEscapeKeydown(\n  onEscapeKeyDownProp?: (event: KeyboardEvent) => void,\n  ownerDocument: Document = globalThis?.document\n) {\n  const onEscapeKeyDown = useCallbackRef(onEscapeKeyDownProp);\n\n  React.useEffect(() => {\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (event.key === 'Escape') {\n        onEscapeKeyDown(event);\n      }\n    };\n    ownerDocument.addEventListener('keydown', handleKeyDown);\n    return () => ownerDocument.removeEventListener('keydown', handleKeyDown);\n  }, [onEscapeKeyDown, ownerDocument]);\n}\n\nexport { useEscapeKeydown };\n","import * as React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Primitive } from '@radix-ui/react-primitive';\n\nimport type * as Radix from '@radix-ui/react-primitive';\n\n/* -------------------------------------------------------------------------------------------------\n * Portal\n * -----------------------------------------------------------------------------------------------*/\n\nconst PORTAL_NAME = 'Portal';\n\ntype PortalElement = React.ElementRef<typeof Primitive.div>;\ntype PrimitiveDivProps = Radix.ComponentPropsWithoutRef<typeof Primitive.div>;\ninterface PortalProps extends PrimitiveDivProps {\n  container?: HTMLElement | null;\n}\n\nconst Portal = React.forwardRef<PortalElement, PortalProps>((props, forwardedRef) => {\n  const { container = globalThis?.document?.body, ...portalProps } = props;\n  return container\n    ? ReactDOM.createPortal(<Primitive.div {...portalProps} ref={forwardedRef} />, container)\n    : null;\n});\n\nPortal.displayName = PORTAL_NAME;\n\n/* -----------------------------------------------------------------------------------------------*/\n\nconst Root = Portal;\n\nexport {\n  Portal,\n  //\n  Root,\n};\nexport type { PortalProps };\n","import * as React from 'react';\n\n/**\n * On the server, React emits a warning when calling `useLayoutEffect`.\n * This is because neither `useLayoutEffect` nor `useEffect` run on the server.\n * We use this safe version which suppresses the warning by replacing it with a noop on the server.\n *\n * See: https://reactjs.org/docs/hooks-reference.html#uselayouteffect\n */\nconst useLayoutEffect = Boolean(globalThis?.document) ? React.useLayoutEffect : () => {};\n\nexport { useLayoutEffect };\n","import * as React from 'react';\nimport * as ReactDOM from 'react-dom';\nimport { useComposedRefs } from '@radix-ui/react-compose-refs';\nimport { useLayoutEffect } from '@radix-ui/react-use-layout-effect';\nimport { useStateMachine } from './useStateMachine';\n\ninterface PresenceProps {\n  children: React.ReactElement | ((props: { present: boolean }) => React.ReactElement);\n  present: boolean;\n}\n\nconst Presence: React.FC<PresenceProps> = (props) => {\n  const { present, children } = props;\n  const presence = usePresence(present);\n\n  const child = (\n    typeof children === 'function'\n      ? children({ present: presence.isPresent })\n      : React.Children.only(children)\n  ) as React.ReactElement;\n\n  const ref = useComposedRefs(presence.ref, (child as any).ref);\n  const forceMount = typeof children === 'function';\n  return forceMount || presence.isPresent ? React.cloneElement(child, { ref }) : null;\n};\n\nPresence.displayName = 'Presence';\n\n/* -------------------------------------------------------------------------------------------------\n * usePresence\n * -----------------------------------------------------------------------------------------------*/\n\nfunction usePresence(present: boolean) {\n  const [node, setNode] = React.useState<HTMLElement>();\n  const stylesRef = React.useRef<CSSStyleDeclaration>({} as any);\n  const prevPresentRef = React.useRef(present);\n  const prevAnimationNameRef = React.useRef<string>('none');\n  const initialState = present ? 'mounted' : 'unmounted';\n  const [state, send] = useStateMachine(initialState, {\n    mounted: {\n      UNMOUNT: 'unmounted',\n      ANIMATION_OUT: 'unmountSuspended',\n    },\n    unmountSuspended: {\n      MOUNT: 'mounted',\n      ANIMATION_END: 'unmounted',\n    },\n    unmounted: {\n      MOUNT: 'mounted',\n    },\n  });\n\n  React.useEffect(() => {\n    const currentAnimationName = getAnimationName(stylesRef.current);\n    prevAnimationNameRef.current = state === 'mounted' ? currentAnimationName : 'none';\n  }, [state]);\n\n  useLayoutEffect(() => {\n    const styles = stylesRef.current;\n    const wasPresent = prevPresentRef.current;\n    const hasPresentChanged = wasPresent !== present;\n\n    if (hasPresentChanged) {\n      const prevAnimationName = prevAnimationNameRef.current;\n      const currentAnimationName = getAnimationName(styles);\n\n      if (present) {\n        send('MOUNT');\n      } else if (currentAnimationName === 'none' || styles?.display === 'none') {\n        // If there is no exit animation or the element is hidden, animations won't run\n        // so we unmount instantly\n        send('UNMOUNT');\n      } else {\n        /**\n         * When `present` changes to `false`, we check changes to animation-name to\n         * determine whether an animation has started. We chose this approach (reading\n         * computed styles) because there is no `animationrun` event and `animationstart`\n         * fires after `animation-delay` has expired which would be too late.\n         */\n        const isAnimating = prevAnimationName !== currentAnimationName;\n\n        if (wasPresent && isAnimating) {\n          send('ANIMATION_OUT');\n        } else {\n          send('UNMOUNT');\n        }\n      }\n\n      prevPresentRef.current = present;\n    }\n  }, [present, send]);\n\n  useLayoutEffect(() => {\n    if (node) {\n      /**\n       * Triggering an ANIMATION_OUT during an ANIMATION_IN will fire an `animationcancel`\n       * event for ANIMATION_IN after we have entered `unmountSuspended` state. So, we\n       * make sure we only trigger ANIMATION_END for the currently active animation.\n       */\n      const handleAnimationEnd = (event: AnimationEvent) => {\n        const currentAnimationName = getAnimationName(stylesRef.current);\n        const isCurrentAnimation = currentAnimationName.includes(event.animationName);\n        if (event.target === node && isCurrentAnimation) {\n          // With React 18 concurrency this update is applied\n          // a frame after the animation ends, creating a flash of visible content.\n          // By manually flushing we ensure they sync within a frame, removing the flash.\n          ReactDOM.flushSync(() => send('ANIMATION_END'));\n        }\n      };\n      const handleAnimationStart = (event: AnimationEvent) => {\n        if (event.target === node) {\n          // if animation occurred, store its name as the previous animation.\n          prevAnimationNameRef.current = getAnimationName(stylesRef.current);\n        }\n      };\n      node.addEventListener('animationstart', handleAnimationStart);\n      node.addEventListener('animationcancel', handleAnimationEnd);\n      node.addEventListener('animationend', handleAnimationEnd);\n      return () => {\n        node.removeEventListener('animationstart', handleAnimationStart);\n        node.removeEventListener('animationcancel', handleAnimationEnd);\n        node.removeEventListener('animationend', handleAnimationEnd);\n      };\n    } else {\n      // Transition to the unmounted state if the node is removed prematurely.\n      // We avoid doing so during cleanup as the node may change but still exist.\n      send('ANIMATION_END');\n    }\n  }, [node, send]);\n\n  return {\n    isPresent: ['mounted', 'unmountSuspended'].includes(state),\n    ref: React.useCallback((node: HTMLElement) => {\n      if (node) stylesRef.current = getComputedStyle(node);\n      setNode(node);\n    }, []),\n  };\n}\n\n/* -----------------------------------------------------------------------------------------------*/\n\nfunction getAnimationName(styles?: CSSStyleDeclaration) {\n  return styles?.animationName || 'none';\n}\n\nexport { Presence };\nexport type { PresenceProps };\n","import * as React from 'react';\n\ntype Machine<S> = { [k: string]: { [k: string]: S } };\ntype MachineState<T> = keyof T;\ntype MachineEvent<T> = keyof UnionToIntersection<T[keyof T]>;\n\n//  https://fettblog.eu/typescript-union-to-intersection/\ntype UnionToIntersection<T> = (T extends any ? (x: T) => any : never) extends (x: infer R) => any\n  ? R\n  : never;\n\nexport function useStateMachine<M>(\n  initialState: MachineState<M>,\n  machine: M & Machine<MachineState<M>>\n) {\n  return React.useReducer((state: MachineState<M>, event: MachineEvent<M>): MachineState<M> => {\n    const nextState = (machine[state] as any)[event];\n    return nextState ?? state;\n  }, initialState);\n}\n","import * as React from 'react';\nimport { useCallbackRef } from '@radix-ui/react-use-callback-ref';\n\ntype UseControllableStateParams<T> = {\n  prop?: T | undefined;\n  defaultProp?: T | undefined;\n  onChange?: (state: T) => void;\n};\n\ntype SetStateFn<T> = (prevState?: T) => T;\n\nfunction useControllableState<T>({\n  prop,\n  defaultProp,\n  onChange = () => {},\n}: UseControllableStateParams<T>) {\n  const [uncontrolledProp, setUncontrolledProp] = useUncontrolledState({ defaultProp, onChange });\n  const isControlled = prop !== undefined;\n  const value = isControlled ? prop : uncontrolledProp;\n  const handleChange = useCallbackRef(onChange);\n\n  const setValue: React.Dispatch<React.SetStateAction<T | undefined>> = React.useCallback(\n    (nextValue) => {\n      if (isControlled) {\n        const setter = nextValue as SetStateFn<T>;\n        const value = typeof nextValue === 'function' ? setter(prop) : nextValue;\n        if (value !== prop) handleChange(value as T);\n      } else {\n        setUncontrolledProp(nextValue);\n      }\n    },\n    [isControlled, prop, setUncontrolledProp, handleChange]\n  );\n\n  return [value, setValue] as const;\n}\n\nfunction useUncontrolledState<T>({\n  defaultProp,\n  onChange,\n}: Omit<UseControllableStateParams<T>, 'prop'>) {\n  const uncontrolledState = React.useState<T | undefined>(defaultProp);\n  const [value] = uncontrolledState;\n  const prevValueRef = React.useRef(value);\n  const handleChange = useCallbackRef(onChange);\n\n  React.useEffect(() => {\n    if (prevValueRef.current !== value) {\n      handleChange(value as T);\n      prevValueRef.current = value;\n    }\n  }, [value, prevValueRef, handleChange]);\n\n  return uncontrolledState;\n}\n\nexport { useControllableState };\n","import * as React from 'react';\nimport { Primitive } from '@radix-ui/react-primitive';\n\nimport type * as Radix from '@radix-ui/react-primitive';\n\n/* -------------------------------------------------------------------------------------------------\n * VisuallyHidden\n * -----------------------------------------------------------------------------------------------*/\n\nconst NAME = 'VisuallyHidden';\n\ntype VisuallyHiddenElement = React.ElementRef<typeof Primitive.span>;\ntype PrimitiveSpanProps = Radix.ComponentPropsWithoutRef<typeof Primitive.span>;\ninterface VisuallyHiddenProps extends PrimitiveSpanProps {}\n\nconst VisuallyHidden = React.forwardRef<VisuallyHiddenElement, VisuallyHiddenProps>(\n  (props, forwardedRef) => {\n    return (\n      <Primitive.span\n        {...props}\n        ref={forwardedRef}\n        style={{\n          // See: https://github.com/twbs/bootstrap/blob/master/scss/mixins/_screen-reader.scss\n          position: 'absolute',\n          border: 0,\n          width: 1,\n          height: 1,\n          padding: 0,\n          margin: -1,\n          overflow: 'hidden',\n          clip: 'rect(0, 0, 0, 0)',\n          whiteSpace: 'nowrap',\n          wordWrap: 'normal',\n          ...props.style,\n        }}\n      />\n    );\n  }\n);\n\nVisuallyHidden.displayName = NAME;\n\n/* -----------------------------------------------------------------------------------------------*/\n\nconst Root = VisuallyHidden;\n\nexport {\n  VisuallyHidden,\n  //\n  Root,\n};\nexport type { VisuallyHiddenProps };\n","import * as React from 'react';\nimport * as ReactDOM from 'react-dom';\nimport { composeEventHandlers } from '@radix-ui/primitive';\nimport { useComposedRefs } from '@radix-ui/react-compose-refs';\nimport { createCollection } from '@radix-ui/react-collection';\nimport { createContextScope } from '@radix-ui/react-context';\nimport * as DismissableLayer from '@radix-ui/react-dismissable-layer';\nimport { Portal } from '@radix-ui/react-portal';\nimport { Presence } from '@radix-ui/react-presence';\nimport { Primitive, dispatchDiscreteCustomEvent } from '@radix-ui/react-primitive';\nimport { useCallbackRef } from '@radix-ui/react-use-callback-ref';\nimport { useControllableState } from '@radix-ui/react-use-controllable-state';\nimport { useLayoutEffect } from '@radix-ui/react-use-layout-effect';\nimport { VisuallyHidden } from '@radix-ui/react-visually-hidden';\n\nimport type * as Radix from '@radix-ui/react-primitive';\nimport type { Scope } from '@radix-ui/react-context';\n\n/* -------------------------------------------------------------------------------------------------\n * ToastProvider\n * -----------------------------------------------------------------------------------------------*/\n\nconst PROVIDER_NAME = 'ToastProvider';\n\nconst [Collection, useCollection, createCollectionScope] = createCollection<ToastElement>('Toast');\n\ntype SwipeDirection = 'up' | 'down' | 'left' | 'right';\ntype ToastProviderContextValue = {\n  label: string;\n  duration: number;\n  swipeDirection: SwipeDirection;\n  swipeThreshold: number;\n  toastCount: number;\n  viewport: ToastViewportElement | null;\n  onViewportChange(viewport: ToastViewportElement): void;\n  onToastAdd(): void;\n  onToastRemove(): void;\n  isFocusedToastEscapeKeyDownRef: React.MutableRefObject<boolean>;\n  isClosePausedRef: React.MutableRefObject<boolean>;\n};\n\ntype ScopedProps<P> = P & { __scopeToast?: Scope };\nconst [createToastContext, createToastScope] = createContextScope('Toast', [createCollectionScope]);\nconst [ToastProviderProvider, useToastProviderContext] =\n  createToastContext<ToastProviderContextValue>(PROVIDER_NAME);\n\ninterface ToastProviderProps {\n  children?: React.ReactNode;\n  /**\n   * An author-localized label for each toast. Used to help screen reader users\n   * associate the interruption with a toast.\n   * @defaultValue 'Notification'\n   */\n  label?: string;\n  /**\n   * Time in milliseconds that each toast should remain visible for.\n   * @defaultValue 5000\n   */\n  duration?: number;\n  /**\n   * Direction of pointer swipe that should close the toast.\n   * @defaultValue 'right'\n   */\n  swipeDirection?: SwipeDirection;\n  /**\n   * Distance in pixels that the swipe must pass before a close is triggered.\n   * @defaultValue 50\n   */\n  swipeThreshold?: number;\n}\n\nconst ToastProvider: React.FC<ToastProviderProps> = (props: ScopedProps<ToastProviderProps>) => {\n  const {\n    __scopeToast,\n    label = 'Notification',\n    duration = 5000,\n    swipeDirection = 'right',\n    swipeThreshold = 50,\n    children,\n  } = props;\n  const [viewport, setViewport] = React.useState<ToastViewportElement | null>(null);\n  const [toastCount, setToastCount] = React.useState(0);\n  const isFocusedToastEscapeKeyDownRef = React.useRef(false);\n  const isClosePausedRef = React.useRef(false);\n  return (\n    <Collection.Provider scope={__scopeToast}>\n      <ToastProviderProvider\n        scope={__scopeToast}\n        label={label}\n        duration={duration}\n        swipeDirection={swipeDirection}\n        swipeThreshold={swipeThreshold}\n        toastCount={toastCount}\n        viewport={viewport}\n        onViewportChange={setViewport}\n        onToastAdd={React.useCallback(() => setToastCount((prevCount) => prevCount + 1), [])}\n        onToastRemove={React.useCallback(() => setToastCount((prevCount) => prevCount - 1), [])}\n        isFocusedToastEscapeKeyDownRef={isFocusedToastEscapeKeyDownRef}\n        isClosePausedRef={isClosePausedRef}\n      >\n        {children}\n      </ToastProviderProvider>\n    </Collection.Provider>\n  );\n};\n\nToastProvider.propTypes = {\n  label(props) {\n    if (props.label && typeof props.label === 'string' && !props.label.trim()) {\n      const error = `Invalid prop \\`label\\` supplied to \\`${PROVIDER_NAME}\\`. Expected non-empty \\`string\\`.`;\n      return new Error(error);\n    }\n    return null;\n  },\n};\n\nToastProvider.displayName = PROVIDER_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * ToastViewport\n * -----------------------------------------------------------------------------------------------*/\n\nconst VIEWPORT_NAME = 'ToastViewport';\nconst VIEWPORT_DEFAULT_HOTKEY = ['F8'];\nconst VIEWPORT_PAUSE = 'toast.viewportPause';\nconst VIEWPORT_RESUME = 'toast.viewportResume';\n\ntype ToastViewportElement = React.ElementRef<typeof Primitive.ol>;\ntype PrimitiveOrderedListProps = Radix.ComponentPropsWithoutRef<typeof Primitive.ol>;\ninterface ToastViewportProps extends PrimitiveOrderedListProps {\n  /**\n   * The keys to use as the keyboard shortcut that will move focus to the toast viewport.\n   * @defaultValue ['F8']\n   */\n  hotkey?: string[];\n  /**\n   * An author-localized label for the toast viewport to provide context for screen reader users\n   * when navigating page landmarks. The available `{hotkey}` placeholder will be replaced for you.\n   * @defaultValue 'Notifications ({hotkey})'\n   */\n  label?: string;\n}\n\nconst ToastViewport = React.forwardRef<ToastViewportElement, ToastViewportProps>(\n  (props: ScopedProps<ToastViewportProps>, forwardedRef) => {\n    const {\n      __scopeToast,\n      hotkey = VIEWPORT_DEFAULT_HOTKEY,\n      label = 'Notifications ({hotkey})',\n      ...viewportProps\n    } = props;\n    const context = useToastProviderContext(VIEWPORT_NAME, __scopeToast);\n    const getItems = useCollection(__scopeToast);\n    const wrapperRef = React.useRef<HTMLDivElement>(null);\n    const headFocusProxyRef = React.useRef<FocusProxyElement>(null);\n    const tailFocusProxyRef = React.useRef<FocusProxyElement>(null);\n    const ref = React.useRef<ToastViewportElement>(null);\n    const composedRefs = useComposedRefs(forwardedRef, ref, context.onViewportChange);\n    const hotkeyLabel = hotkey.join('+').replace(/Key/g, '').replace(/Digit/g, '');\n    const hasToasts = context.toastCount > 0;\n\n    React.useEffect(() => {\n      const handleKeyDown = (event: KeyboardEvent) => {\n        // we use `event.code` as it is consistent regardless of meta keys that were pressed.\n        // for example, `event.key` for `Control+Alt+t` is `` and `t !== `\n        const isHotkeyPressed = hotkey.every((key) => (event as any)[key] || event.code === key);\n        if (isHotkeyPressed) ref.current?.focus();\n      };\n      document.addEventListener('keydown', handleKeyDown);\n      return () => document.removeEventListener('keydown', handleKeyDown);\n    }, [hotkey]);\n\n    React.useEffect(() => {\n      const wrapper = wrapperRef.current;\n      const viewport = ref.current;\n      if (hasToasts && wrapper && viewport) {\n        const handlePause = () => {\n          if (!context.isClosePausedRef.current) {\n            const pauseEvent = new CustomEvent(VIEWPORT_PAUSE);\n            viewport.dispatchEvent(pauseEvent);\n            context.isClosePausedRef.current = true;\n          }\n        };\n\n        const handleResume = () => {\n          if (context.isClosePausedRef.current) {\n            const resumeEvent = new CustomEvent(VIEWPORT_RESUME);\n            viewport.dispatchEvent(resumeEvent);\n            context.isClosePausedRef.current = false;\n          }\n        };\n\n        const handleFocusOutResume = (event: FocusEvent) => {\n          const isFocusMovingOutside = !wrapper.contains(event.relatedTarget as HTMLElement);\n          if (isFocusMovingOutside) handleResume();\n        };\n\n        const handlePointerLeaveResume = () => {\n          const isFocusInside = wrapper.contains(document.activeElement);\n          if (!isFocusInside) handleResume();\n        };\n\n        // Toasts are not in the viewport React tree so we need to bind DOM events\n        wrapper.addEventListener('focusin', handlePause);\n        wrapper.addEventListener('focusout', handleFocusOutResume);\n        wrapper.addEventListener('pointermove', handlePause);\n        wrapper.addEventListener('pointerleave', handlePointerLeaveResume);\n        window.addEventListener('blur', handlePause);\n        window.addEventListener('focus', handleResume);\n        return () => {\n          wrapper.removeEventListener('focusin', handlePause);\n          wrapper.removeEventListener('focusout', handleFocusOutResume);\n          wrapper.removeEventListener('pointermove', handlePause);\n          wrapper.removeEventListener('pointerleave', handlePointerLeaveResume);\n          window.removeEventListener('blur', handlePause);\n          window.removeEventListener('focus', handleResume);\n        };\n      }\n    }, [hasToasts, context.isClosePausedRef]);\n\n    const getSortedTabbableCandidates = React.useCallback(\n      ({ tabbingDirection }: { tabbingDirection: 'forwards' | 'backwards' }) => {\n        const toastItems = getItems();\n        const tabbableCandidates = toastItems.map((toastItem) => {\n          const toastNode = toastItem.ref.current!;\n          const toastTabbableCandidates = [toastNode, ...getTabbableCandidates(toastNode)];\n          return tabbingDirection === 'forwards'\n            ? toastTabbableCandidates\n            : toastTabbableCandidates.reverse();\n        });\n        return (\n          tabbingDirection === 'forwards' ? tabbableCandidates.reverse() : tabbableCandidates\n        ).flat();\n      },\n      [getItems]\n    );\n\n    React.useEffect(() => {\n      const viewport = ref.current;\n      // We programmatically manage tabbing as we are unable to influence\n      // the source order with portals, this allows us to reverse the\n      // tab order so that it runs from most recent toast to least\n      if (viewport) {\n        const handleKeyDown = (event: KeyboardEvent) => {\n          const isMetaKey = event.altKey || event.ctrlKey || event.metaKey;\n          const isTabKey = event.key === 'Tab' && !isMetaKey;\n\n          if (isTabKey) {\n            const focusedElement = document.activeElement;\n            const isTabbingBackwards = event.shiftKey;\n            const targetIsViewport = event.target === viewport;\n\n            // If we're back tabbing after jumping to the viewport then we simply\n            // proxy focus out to the preceding document\n            if (targetIsViewport && isTabbingBackwards) {\n              headFocusProxyRef.current?.focus();\n              return;\n            }\n\n            const tabbingDirection = isTabbingBackwards ? 'backwards' : 'forwards';\n            const sortedCandidates = getSortedTabbableCandidates({ tabbingDirection });\n            const index = sortedCandidates.findIndex((candidate) => candidate === focusedElement);\n            if (focusFirst(sortedCandidates.slice(index + 1))) {\n              event.preventDefault();\n            } else {\n              // If we can't focus that means we're at the edges so we\n              // proxy to the corresponding exit point and let the browser handle\n              // tab/shift+tab keypress and implicitly pass focus to the next valid element in the document\n              isTabbingBackwards\n                ? headFocusProxyRef.current?.focus()\n                : tailFocusProxyRef.current?.focus();\n            }\n          }\n        };\n\n        // Toasts are not in the viewport React tree so we need to bind DOM events\n        viewport.addEventListener('keydown', handleKeyDown);\n        return () => viewport.removeEventListener('keydown', handleKeyDown);\n      }\n    }, [getItems, getSortedTabbableCandidates]);\n\n    return (\n      <DismissableLayer.Branch\n        ref={wrapperRef}\n        role=\"region\"\n        aria-label={label.replace('{hotkey}', hotkeyLabel)}\n        // Ensure virtual cursor from landmarks menus triggers focus/blur for pause/resume\n        tabIndex={-1}\n        // incase list has size when empty (e.g. padding), we remove pointer events so\n        // it doesn't prevent interactions with page elements that it overlays\n        style={{ pointerEvents: hasToasts ? undefined : 'none' }}\n      >\n        {hasToasts && (\n          <FocusProxy\n            ref={headFocusProxyRef}\n            onFocusFromOutsideViewport={() => {\n              const tabbableCandidates = getSortedTabbableCandidates({\n                tabbingDirection: 'forwards',\n              });\n              focusFirst(tabbableCandidates);\n            }}\n          />\n        )}\n        {/**\n         * tabindex on the the list so that it can be focused when items are removed. we focus\n         * the list instead of the viewport so it announces number of items remaining.\n         */}\n        <Collection.Slot scope={__scopeToast}>\n          <Primitive.ol tabIndex={-1} {...viewportProps} ref={composedRefs} />\n        </Collection.Slot>\n        {hasToasts && (\n          <FocusProxy\n            ref={tailFocusProxyRef}\n            onFocusFromOutsideViewport={() => {\n              const tabbableCandidates = getSortedTabbableCandidates({\n                tabbingDirection: 'backwards',\n              });\n              focusFirst(tabbableCandidates);\n            }}\n          />\n        )}\n      </DismissableLayer.Branch>\n    );\n  }\n);\n\nToastViewport.displayName = VIEWPORT_NAME;\n\n/* -----------------------------------------------------------------------------------------------*/\n\nconst FOCUS_PROXY_NAME = 'ToastFocusProxy';\n\ntype FocusProxyElement = React.ElementRef<typeof VisuallyHidden>;\ntype VisuallyHiddenProps = Radix.ComponentPropsWithoutRef<typeof VisuallyHidden>;\ninterface FocusProxyProps extends VisuallyHiddenProps {\n  onFocusFromOutsideViewport(): void;\n}\n\nconst FocusProxy = React.forwardRef<FocusProxyElement, ScopedProps<FocusProxyProps>>(\n  (props, forwardedRef) => {\n    const { __scopeToast, onFocusFromOutsideViewport, ...proxyProps } = props;\n    const context = useToastProviderContext(FOCUS_PROXY_NAME, __scopeToast);\n\n    return (\n      <VisuallyHidden\n        aria-hidden\n        tabIndex={0}\n        {...proxyProps}\n        ref={forwardedRef}\n        // Avoid page scrolling when focus is on the focus proxy\n        style={{ position: 'fixed' }}\n        onFocus={(event) => {\n          const prevFocusedElement = event.relatedTarget as HTMLElement | null;\n          const isFocusFromOutsideViewport = !context.viewport?.contains(prevFocusedElement);\n          if (isFocusFromOutsideViewport) onFocusFromOutsideViewport();\n        }}\n      />\n    );\n  }\n);\n\nFocusProxy.displayName = FOCUS_PROXY_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * Toast\n * -----------------------------------------------------------------------------------------------*/\n\nconst TOAST_NAME = 'Toast';\nconst TOAST_SWIPE_START = 'toast.swipeStart';\nconst TOAST_SWIPE_MOVE = 'toast.swipeMove';\nconst TOAST_SWIPE_CANCEL = 'toast.swipeCancel';\nconst TOAST_SWIPE_END = 'toast.swipeEnd';\n\ntype ToastElement = ToastImplElement;\ninterface ToastProps extends Omit<ToastImplProps, keyof ToastImplPrivateProps> {\n  open?: boolean;\n  defaultOpen?: boolean;\n  onOpenChange?(open: boolean): void;\n  /**\n   * Used to force mounting when more control is needed. Useful when\n   * controlling animation with React animation libraries.\n   */\n  forceMount?: true;\n}\n\nconst Toast = React.forwardRef<ToastElement, ToastProps>(\n  (props: ScopedProps<ToastProps>, forwardedRef) => {\n    const { forceMount, open: openProp, defaultOpen, onOpenChange, ...toastProps } = props;\n    const [open = true, setOpen] = useControllableState({\n      prop: openProp,\n      defaultProp: defaultOpen,\n      onChange: onOpenChange,\n    });\n    return (\n      <Presence present={forceMount || open}>\n        <ToastImpl\n          open={open}\n          {...toastProps}\n          ref={forwardedRef}\n          onClose={() => setOpen(false)}\n          onPause={useCallbackRef(props.onPause)}\n          onResume={useCallbackRef(props.onResume)}\n          onSwipeStart={composeEventHandlers(props.onSwipeStart, (event) => {\n            event.currentTarget.setAttribute('data-swipe', 'start');\n          })}\n          onSwipeMove={composeEventHandlers(props.onSwipeMove, (event) => {\n            const { x, y } = event.detail.delta;\n            event.currentTarget.setAttribute('data-swipe', 'move');\n            event.currentTarget.style.setProperty('--radix-toast-swipe-move-x', `${x}px`);\n            event.currentTarget.style.setProperty('--radix-toast-swipe-move-y', `${y}px`);\n          })}\n          onSwipeCancel={composeEventHandlers(props.onSwipeCancel, (event) => {\n            event.currentTarget.setAttribute('data-swipe', 'cancel');\n            event.currentTarget.style.removeProperty('--radix-toast-swipe-move-x');\n            event.currentTarget.style.removeProperty('--radix-toast-swipe-move-y');\n            event.currentTarget.style.removeProperty('--radix-toast-swipe-end-x');\n            event.currentTarget.style.removeProperty('--radix-toast-swipe-end-y');\n          })}\n          onSwipeEnd={composeEventHandlers(props.onSwipeEnd, (event) => {\n            const { x, y } = event.detail.delta;\n            event.currentTarget.setAttribute('data-swipe', 'end');\n            event.currentTarget.style.removeProperty('--radix-toast-swipe-move-x');\n            event.currentTarget.style.removeProperty('--radix-toast-swipe-move-y');\n            event.currentTarget.style.setProperty('--radix-toast-swipe-end-x', `${x}px`);\n            event.currentTarget.style.setProperty('--radix-toast-swipe-end-y', `${y}px`);\n            setOpen(false);\n          })}\n        />\n      </Presence>\n    );\n  }\n);\n\nToast.displayName = TOAST_NAME;\n\n/* -----------------------------------------------------------------------------------------------*/\n\ntype SwipeEvent = { currentTarget: EventTarget & ToastElement } & Omit<\n  CustomEvent<{ originalEvent: React.PointerEvent; delta: { x: number; y: number } }>,\n  'currentTarget'\n>;\n\nconst [ToastInteractiveProvider, useToastInteractiveContext] = createToastContext(TOAST_NAME, {\n  onClose() {},\n});\n\ntype ToastImplElement = React.ElementRef<typeof Primitive.li>;\ntype DismissableLayerProps = Radix.ComponentPropsWithoutRef<typeof DismissableLayer.Root>;\ntype ToastImplPrivateProps = { open: boolean; onClose(): void };\ntype PrimitiveListItemProps = Radix.ComponentPropsWithoutRef<typeof Primitive.li>;\ninterface ToastImplProps extends ToastImplPrivateProps, PrimitiveListItemProps {\n  type?: 'foreground' | 'background';\n  /**\n   * Time in milliseconds that toast should remain visible for. Overrides value\n   * given to `ToastProvider`.\n   */\n  duration?: number;\n  onEscapeKeyDown?: DismissableLayerProps['onEscapeKeyDown'];\n  onPause?(): void;\n  onResume?(): void;\n  onSwipeStart?(event: SwipeEvent): void;\n  onSwipeMove?(event: SwipeEvent): void;\n  onSwipeCancel?(event: SwipeEvent): void;\n  onSwipeEnd?(event: SwipeEvent): void;\n}\n\nconst ToastImpl = React.forwardRef<ToastImplElement, ToastImplProps>(\n  (props: ScopedProps<ToastImplProps>, forwardedRef) => {\n    const {\n      __scopeToast,\n      type = 'foreground',\n      duration: durationProp,\n      open,\n      onClose,\n      onEscapeKeyDown,\n      onPause,\n      onResume,\n      onSwipeStart,\n      onSwipeMove,\n      onSwipeCancel,\n      onSwipeEnd,\n      ...toastProps\n    } = props;\n    const context = useToastProviderContext(TOAST_NAME, __scopeToast);\n    const [node, setNode] = React.useState<ToastImplElement | null>(null);\n    const composedRefs = useComposedRefs(forwardedRef, (node) => setNode(node));\n    const pointerStartRef = React.useRef<{ x: number; y: number } | null>(null);\n    const swipeDeltaRef = React.useRef<{ x: number; y: number } | null>(null);\n    const duration = durationProp || context.duration;\n    const closeTimerStartTimeRef = React.useRef(0);\n    const closeTimerRemainingTimeRef = React.useRef(duration);\n    const closeTimerRef = React.useRef(0);\n    const { onToastAdd, onToastRemove } = context;\n    const handleClose = useCallbackRef(() => {\n      // focus viewport if focus is within toast to read the remaining toast\n      // count to SR users and ensure focus isn't lost\n      const isFocusInToast = node?.contains(document.activeElement);\n      if (isFocusInToast) context.viewport?.focus();\n      onClose();\n    });\n\n    const startTimer = React.useCallback(\n      (duration: number) => {\n        if (!duration || duration === Infinity) return;\n        window.clearTimeout(closeTimerRef.current);\n        closeTimerStartTimeRef.current = new Date().getTime();\n        closeTimerRef.current = window.setTimeout(handleClose, duration);\n      },\n      [handleClose]\n    );\n\n    React.useEffect(() => {\n      const viewport = context.viewport;\n      if (viewport) {\n        const handleResume = () => {\n          startTimer(closeTimerRemainingTimeRef.current);\n          onResume?.();\n        };\n        const handlePause = () => {\n          const elapsedTime = new Date().getTime() - closeTimerStartTimeRef.current;\n          closeTimerRemainingTimeRef.current = closeTimerRemainingTimeRef.current - elapsedTime;\n          window.clearTimeout(closeTimerRef.current);\n          onPause?.();\n        };\n        viewport.addEventListener(VIEWPORT_PAUSE, handlePause);\n        viewport.addEventListener(VIEWPORT_RESUME, handleResume);\n        return () => {\n          viewport.removeEventListener(VIEWPORT_PAUSE, handlePause);\n          viewport.removeEventListener(VIEWPORT_RESUME, handleResume);\n        };\n      }\n    }, [context.viewport, duration, onPause, onResume, startTimer]);\n\n    // start timer when toast opens or duration changes.\n    // we include `open` in deps because closed !== unmounted when animating\n    // so it could reopen before being completely unmounted\n    React.useEffect(() => {\n      if (open && !context.isClosePausedRef.current) startTimer(duration);\n    }, [open, duration, context.isClosePausedRef, startTimer]);\n\n    React.useEffect(() => {\n      onToastAdd();\n      return () => onToastRemove();\n    }, [onToastAdd, onToastRemove]);\n\n    const announceTextContent = React.useMemo(() => {\n      return node ? getAnnounceTextContent(node) : null;\n    }, [node]);\n\n    if (!context.viewport) return null;\n\n    return (\n      <>\n        {announceTextContent && (\n          <ToastAnnounce\n            __scopeToast={__scopeToast}\n            // Toasts are always role=status to avoid stuttering issues with role=alert in SRs.\n            role=\"status\"\n            aria-live={type === 'foreground' ? 'assertive' : 'polite'}\n            aria-atomic\n          >\n            {announceTextContent}\n          </ToastAnnounce>\n        )}\n\n        <ToastInteractiveProvider scope={__scopeToast} onClose={handleClose}>\n          {ReactDOM.createPortal(\n            <Collection.ItemSlot scope={__scopeToast}>\n              <DismissableLayer.Root\n                asChild\n                onEscapeKeyDown={composeEventHandlers(onEscapeKeyDown, () => {\n                  if (!context.isFocusedToastEscapeKeyDownRef.current) handleClose();\n                  context.isFocusedToastEscapeKeyDownRef.current = false;\n                })}\n              >\n                <Primitive.li\n                  // Ensure toasts are announced as status list or status when focused\n                  role=\"status\"\n                  aria-live=\"off\"\n                  aria-atomic\n                  tabIndex={0}\n                  data-state={open ? 'open' : 'closed'}\n                  data-swipe-direction={context.swipeDirection}\n                  {...toastProps}\n                  ref={composedRefs}\n                  style={{ userSelect: 'none', touchAction: 'none', ...props.style }}\n                  onKeyDown={composeEventHandlers(props.onKeyDown, (event) => {\n                    if (event.key !== 'Escape') return;\n                    onEscapeKeyDown?.(event.nativeEvent);\n                    if (!event.nativeEvent.defaultPrevented) {\n                      context.isFocusedToastEscapeKeyDownRef.current = true;\n                      handleClose();\n                    }\n                  })}\n                  onPointerDown={composeEventHandlers(props.onPointerDown, (event) => {\n                    if (event.button !== 0) return;\n                    pointerStartRef.current = { x: event.clientX, y: event.clientY };\n                  })}\n                  onPointerMove={composeEventHandlers(props.onPointerMove, (event) => {\n                    if (!pointerStartRef.current) return;\n                    const x = event.clientX - pointerStartRef.current.x;\n                    const y = event.clientY - pointerStartRef.current.y;\n                    const hasSwipeMoveStarted = Boolean(swipeDeltaRef.current);\n                    const isHorizontalSwipe = ['left', 'right'].includes(context.swipeDirection);\n                    const clamp = ['left', 'up'].includes(context.swipeDirection)\n                      ? Math.min\n                      : Math.max;\n                    const clampedX = isHorizontalSwipe ? clamp(0, x) : 0;\n                    const clampedY = !isHorizontalSwipe ? clamp(0, y) : 0;\n                    const moveStartBuffer = event.pointerType === 'touch' ? 10 : 2;\n                    const delta = { x: clampedX, y: clampedY };\n                    const eventDetail = { originalEvent: event, delta };\n                    if (hasSwipeMoveStarted) {\n                      swipeDeltaRef.current = delta;\n                      handleAndDispatchCustomEvent(TOAST_SWIPE_MOVE, onSwipeMove, eventDetail, {\n                        discrete: false,\n                      });\n                    } else if (isDeltaInDirection(delta, context.swipeDirection, moveStartBuffer)) {\n                      swipeDeltaRef.current = delta;\n                      handleAndDispatchCustomEvent(TOAST_SWIPE_START, onSwipeStart, eventDetail, {\n                        discrete: false,\n                      });\n                      (event.target as HTMLElement).setPointerCapture(event.pointerId);\n                    } else if (Math.abs(x) > moveStartBuffer || Math.abs(y) > moveStartBuffer) {\n                      // User is swiping in wrong direction so we disable swipe gesture\n                      // for the current pointer down interaction\n                      pointerStartRef.current = null;\n                    }\n                  })}\n                  onPointerUp={composeEventHandlers(props.onPointerUp, (event) => {\n                    const delta = swipeDeltaRef.current;\n                    const target = event.target as HTMLElement;\n                    if (target.hasPointerCapture(event.pointerId)) {\n                      target.releasePointerCapture(event.pointerId);\n                    }\n                    swipeDeltaRef.current = null;\n                    pointerStartRef.current = null;\n                    if (delta) {\n                      const toast = event.currentTarget;\n                      const eventDetail = { originalEvent: event, delta };\n                      if (\n                        isDeltaInDirection(delta, context.swipeDirection, context.swipeThreshold)\n                      ) {\n                        handleAndDispatchCustomEvent(TOAST_SWIPE_END, onSwipeEnd, eventDetail, {\n                          discrete: true,\n                        });\n                      } else {\n                        handleAndDispatchCustomEvent(\n                          TOAST_SWIPE_CANCEL,\n                          onSwipeCancel,\n                          eventDetail,\n                          {\n                            discrete: true,\n                          }\n                        );\n                      }\n                      // Prevent click event from triggering on items within the toast when\n                      // pointer up is part of a swipe gesture\n                      toast.addEventListener('click', (event) => event.preventDefault(), {\n                        once: true,\n                      });\n                    }\n                  })}\n                />\n              </DismissableLayer.Root>\n            </Collection.ItemSlot>,\n            context.viewport\n          )}\n        </ToastInteractiveProvider>\n      </>\n    );\n  }\n);\n\nToastImpl.propTypes = {\n  type(props) {\n    if (props.type && !['foreground', 'background'].includes(props.type)) {\n      const error = `Invalid prop \\`type\\` supplied to \\`${TOAST_NAME}\\`. Expected \\`foreground | background\\`.`;\n      return new Error(error);\n    }\n    return null;\n  },\n};\n\n/* -----------------------------------------------------------------------------------------------*/\n\ninterface ToastAnnounceProps\n  extends Omit<React.ComponentPropsWithoutRef<'div'>, 'children'>,\n    ScopedProps<{ children: string[] }> {}\n\nconst ToastAnnounce: React.FC<ToastAnnounceProps> = (props: ScopedProps<ToastAnnounceProps>) => {\n  const { __scopeToast, children, ...announceProps } = props;\n  const context = useToastProviderContext(TOAST_NAME, __scopeToast);\n  const [renderAnnounceText, setRenderAnnounceText] = React.useState(false);\n  const [isAnnounced, setIsAnnounced] = React.useState(false);\n\n  // render text content in the next frame to ensure toast is announced in NVDA\n  useNextFrame(() => setRenderAnnounceText(true));\n\n  // cleanup after announcing\n  React.useEffect(() => {\n    const timer = window.setTimeout(() => setIsAnnounced(true), 1000);\n    return () => window.clearTimeout(timer);\n  }, []);\n\n  return isAnnounced ? null : (\n    <Portal asChild>\n      <VisuallyHidden {...announceProps}>\n        {renderAnnounceText && (\n          <>\n            {context.label} {children}\n          </>\n        )}\n      </VisuallyHidden>\n    </Portal>\n  );\n};\n\n/* -------------------------------------------------------------------------------------------------\n * ToastTitle\n * -----------------------------------------------------------------------------------------------*/\n\nconst TITLE_NAME = 'ToastTitle';\n\ntype ToastTitleElement = React.ElementRef<typeof Primitive.div>;\ntype PrimitiveDivProps = Radix.ComponentPropsWithoutRef<typeof Primitive.div>;\ninterface ToastTitleProps extends PrimitiveDivProps {}\n\nconst ToastTitle = React.forwardRef<ToastTitleElement, ToastTitleProps>(\n  (props: ScopedProps<ToastTitleProps>, forwardedRef) => {\n    const { __scopeToast, ...titleProps } = props;\n    return <Primitive.div {...titleProps} ref={forwardedRef} />;\n  }\n);\n\nToastTitle.displayName = TITLE_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * ToastDescription\n * -----------------------------------------------------------------------------------------------*/\n\nconst DESCRIPTION_NAME = 'ToastDescription';\n\ntype ToastDescriptionElement = React.ElementRef<typeof Primitive.div>;\ninterface ToastDescriptionProps extends PrimitiveDivProps {}\n\nconst ToastDescription = React.forwardRef<ToastDescriptionElement, ToastDescriptionProps>(\n  (props: ScopedProps<ToastDescriptionProps>, forwardedRef) => {\n    const { __scopeToast, ...descriptionProps } = props;\n    return <Primitive.div {...descriptionProps} ref={forwardedRef} />;\n  }\n);\n\nToastDescription.displayName = DESCRIPTION_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * ToastAction\n * -----------------------------------------------------------------------------------------------*/\n\nconst ACTION_NAME = 'ToastAction';\n\ntype ToastActionElement = ToastCloseElement;\ninterface ToastActionProps extends ToastCloseProps {\n  /**\n   * A short description for an alternate way to carry out the action. For screen reader users\n   * who will not be able to navigate to the button easily/quickly.\n   * @example <ToastAction altText=\"Goto account settings to updgrade\">Upgrade</ToastAction>\n   * @example <ToastAction altText=\"Undo (Alt+U)\">Undo</ToastAction>\n   */\n  altText: string;\n}\n\nconst ToastAction = React.forwardRef<ToastActionElement, ToastActionProps>(\n  (props: ScopedProps<ToastActionProps>, forwardedRef) => {\n    const { altText, ...actionProps } = props;\n    if (!altText) return null;\n    return (\n      <ToastAnnounceExclude altText={altText} asChild>\n        <ToastClose {...actionProps} ref={forwardedRef} />\n      </ToastAnnounceExclude>\n    );\n  }\n);\n\nToastAction.propTypes = {\n  altText(props) {\n    if (!props.altText) {\n      return new Error(`Missing prop \\`altText\\` expected on \\`${ACTION_NAME}\\``);\n    }\n    return null;\n  },\n};\n\nToastAction.displayName = ACTION_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * ToastClose\n * -----------------------------------------------------------------------------------------------*/\n\nconst CLOSE_NAME = 'ToastClose';\n\ntype ToastCloseElement = React.ElementRef<typeof Primitive.button>;\ntype PrimitiveButtonProps = Radix.ComponentPropsWithoutRef<typeof Primitive.button>;\ninterface ToastCloseProps extends PrimitiveButtonProps {}\n\nconst ToastClose = React.forwardRef<ToastCloseElement, ToastCloseProps>(\n  (props: ScopedProps<ToastCloseProps>, forwardedRef) => {\n    const { __scopeToast, ...closeProps } = props;\n    const interactiveContext = useToastInteractiveContext(CLOSE_NAME, __scopeToast);\n\n    return (\n      <ToastAnnounceExclude asChild>\n        <Primitive.button\n          type=\"button\"\n          {...closeProps}\n          ref={forwardedRef}\n          onClick={composeEventHandlers(props.onClick, interactiveContext.onClose)}\n        />\n      </ToastAnnounceExclude>\n    );\n  }\n);\n\nToastClose.displayName = CLOSE_NAME;\n\n/* ---------------------------------------------------------------------------------------------- */\n\ntype ToastAnnounceExcludeElement = React.ElementRef<typeof Primitive.div>;\ninterface ToastAnnounceExcludeProps extends PrimitiveDivProps {\n  altText?: string;\n}\n\nconst ToastAnnounceExclude = React.forwardRef<\n  ToastAnnounceExcludeElement,\n  ToastAnnounceExcludeProps\n>((props: ScopedProps<ToastAnnounceExcludeProps>, forwardedRef) => {\n  const { __scopeToast, altText, ...announceExcludeProps } = props;\n\n  return (\n    <Primitive.div\n      data-radix-toast-announce-exclude=\"\"\n      data-radix-toast-announce-alt={altText || undefined}\n      {...announceExcludeProps}\n      ref={forwardedRef}\n    />\n  );\n});\n\nfunction getAnnounceTextContent(container: HTMLElement) {\n  const textContent: string[] = [];\n  const childNodes = Array.from(container.childNodes);\n\n  childNodes.forEach((node) => {\n    if (node.nodeType === node.TEXT_NODE && node.textContent) textContent.push(node.textContent);\n    if (isHTMLElement(node)) {\n      const isHidden = node.ariaHidden || node.hidden || node.style.display === 'none';\n      const isExcluded = node.dataset.radixToastAnnounceExclude === '';\n\n      if (!isHidden) {\n        if (isExcluded) {\n          const altText = node.dataset.radixToastAnnounceAlt;\n          if (altText) textContent.push(altText);\n        } else {\n          textContent.push(...getAnnounceTextContent(node));\n        }\n      }\n    }\n  });\n\n  // We return a collection of text rather than a single concatenated string.\n  // This allows SR VO to naturally pause break between nodes while announcing.\n  return textContent;\n}\n\n/* ---------------------------------------------------------------------------------------------- */\n\nfunction handleAndDispatchCustomEvent<\n  E extends CustomEvent,\n  ReactEvent extends React.SyntheticEvent\n>(\n  name: string,\n  handler: ((event: E) => void) | undefined,\n  detail: { originalEvent: ReactEvent } & (E extends CustomEvent<infer D> ? D : never),\n  { discrete }: { discrete: boolean }\n) {\n  const currentTarget = detail.originalEvent.currentTarget as HTMLElement;\n  const event = new CustomEvent(name, { bubbles: true, cancelable: true, detail });\n  if (handler) currentTarget.addEventListener(name, handler as EventListener, { once: true });\n\n  if (discrete) {\n    dispatchDiscreteCustomEvent(currentTarget, event);\n  } else {\n    currentTarget.dispatchEvent(event);\n  }\n}\n\nconst isDeltaInDirection = (\n  delta: { x: number; y: number },\n  direction: SwipeDirection,\n  threshold = 0\n) => {\n  const deltaX = Math.abs(delta.x);\n  const deltaY = Math.abs(delta.y);\n  const isDeltaX = deltaX > deltaY;\n  if (direction === 'left' || direction === 'right') {\n    return isDeltaX && deltaX > threshold;\n  } else {\n    return !isDeltaX && deltaY > threshold;\n  }\n};\n\nfunction useNextFrame(callback = () => {}) {\n  const fn = useCallbackRef(callback);\n  useLayoutEffect(() => {\n    let raf1 = 0;\n    let raf2 = 0;\n    raf1 = window.requestAnimationFrame(() => (raf2 = window.requestAnimationFrame(fn)));\n    return () => {\n      window.cancelAnimationFrame(raf1);\n      window.cancelAnimationFrame(raf2);\n    };\n  }, [fn]);\n}\n\nfunction isHTMLElement(node: any): node is HTMLElement {\n  return node.nodeType === node.ELEMENT_NODE;\n}\n\n/**\n * Returns a list of potential tabbable candidates.\n *\n * NOTE: This is only a close approximation. For example it doesn't take into account cases like when\n * elements are not visible. This cannot be worked out easily by just reading a property, but rather\n * necessitate runtime knowledge (computed styles, etc). We deal with these cases separately.\n *\n * See: https://developer.mozilla.org/en-US/docs/Web/API/TreeWalker\n * Credit: https://github.com/discord/focus-layers/blob/master/src/util/wrapFocus.tsx#L1\n */\nfunction getTabbableCandidates(container: HTMLElement) {\n  const nodes: HTMLElement[] = [];\n  const walker = document.createTreeWalker(container, NodeFilter.SHOW_ELEMENT, {\n    acceptNode: (node: any) => {\n      const isHiddenInput = node.tagName === 'INPUT' && node.type === 'hidden';\n      if (node.disabled || node.hidden || isHiddenInput) return NodeFilter.FILTER_SKIP;\n      // `.tabIndex` is not the same as the `tabindex` attribute. It works on the\n      // runtime's understanding of tabbability, so this automatically accounts\n      // for any kind of element that could be tabbed to.\n      return node.tabIndex >= 0 ? NodeFilter.FILTER_ACCEPT : NodeFilter.FILTER_SKIP;\n    },\n  });\n  while (walker.nextNode()) nodes.push(walker.currentNode as HTMLElement);\n  // we do not take into account the order of nodes with positive `tabIndex` as it\n  // hinders accessibility to have tab order different from visual order.\n  return nodes;\n}\n\nfunction focusFirst(candidates: HTMLElement[]) {\n  const previouslyFocusedElement = document.activeElement;\n  return candidates.some((candidate) => {\n    // if focus is already where we want to go, we don't want to keep going through the candidates\n    if (candidate === previouslyFocusedElement) return true;\n    candidate.focus();\n    return document.activeElement !== previouslyFocusedElement;\n  });\n}\n\nconst Provider = ToastProvider;\nconst Viewport = ToastViewport;\nconst Root = Toast;\nconst Title = ToastTitle;\nconst Description = ToastDescription;\nconst Action = ToastAction;\nconst Close = ToastClose;\n\nexport {\n  createToastScope,\n  //\n  ToastProvider,\n  ToastViewport,\n  Toast,\n  ToastTitle,\n  ToastDescription,\n  ToastAction,\n  ToastClose,\n  //\n  Provider,\n  Viewport,\n  Root,\n  Title,\n  Description,\n  Action,\n  Close,\n};\nexport type {\n  ToastProviderProps,\n  ToastViewportProps,\n  ToastProps,\n  ToastTitleProps,\n  ToastDescriptionProps,\n  ToastActionProps,\n  ToastCloseProps,\n};\n","import * as React from 'react';\n\ntype Direction = 'ltr' | 'rtl';\nconst DirectionContext = React.createContext<Direction | undefined>(undefined);\n\n/* -------------------------------------------------------------------------------------------------\n * Direction\n * -----------------------------------------------------------------------------------------------*/\n\ninterface DirectionProviderProps {\n  children?: React.ReactNode;\n  dir: Direction;\n}\nconst DirectionProvider: React.FC<DirectionProviderProps> = (props) => {\n  const { dir, children } = props;\n  return <DirectionContext.Provider value={dir}>{children}</DirectionContext.Provider>;\n};\n\n/* -----------------------------------------------------------------------------------------------*/\n\nfunction useDirection(localDir?: Direction) {\n  const globalDir = React.useContext(DirectionContext);\n  return localDir || globalDir || 'ltr';\n}\n\nconst Provider = DirectionProvider;\n\nexport {\n  useDirection,\n  //\n  Provider,\n  //\n  DirectionProvider,\n};\n","import * as React from 'react';\n\n/** Number of components which have requested interest to have focus guards */\nlet count = 0;\n\nfunction FocusGuards(props: any) {\n  useFocusGuards();\n  return props.children;\n}\n\n/**\n * Injects a pair of focus guards at the edges of the whole DOM tree\n * to ensure `focusin` & `focusout` events can be caught consistently.\n */\nfunction useFocusGuards() {\n  React.useEffect(() => {\n    const edgeGuards = document.querySelectorAll('[data-radix-focus-guard]');\n    document.body.insertAdjacentElement('afterbegin', edgeGuards[0] ?? createFocusGuard());\n    document.body.insertAdjacentElement('beforeend', edgeGuards[1] ?? createFocusGuard());\n    count++;\n\n    return () => {\n      if (count === 1) {\n        document.querySelectorAll('[data-radix-focus-guard]').forEach((node) => node.remove());\n      }\n      count--;\n    };\n  }, []);\n}\n\nfunction createFocusGuard() {\n  const element = document.createElement('span');\n  element.setAttribute('data-radix-focus-guard', '');\n  element.tabIndex = 0;\n  element.style.cssText = 'outline: none; opacity: 0; position: fixed; pointer-events: none';\n  return element;\n}\n\nconst Root = FocusGuards;\n\nexport {\n  FocusGuards,\n  //\n  Root,\n  //\n  useFocusGuards,\n};\n","import * as React from 'react';\nimport { useComposedRefs } from '@radix-ui/react-compose-refs';\nimport { Primitive } from '@radix-ui/react-primitive';\nimport { useCallbackRef } from '@radix-ui/react-use-callback-ref';\n\nimport type * as Radix from '@radix-ui/react-primitive';\n\nconst AUTOFOCUS_ON_MOUNT = 'focusScope.autoFocusOnMount';\nconst AUTOFOCUS_ON_UNMOUNT = 'focusScope.autoFocusOnUnmount';\nconst EVENT_OPTIONS = { bubbles: false, cancelable: true };\n\ntype FocusableTarget = HTMLElement | { focus(): void };\n\n/* -------------------------------------------------------------------------------------------------\n * FocusScope\n * -----------------------------------------------------------------------------------------------*/\n\nconst FOCUS_SCOPE_NAME = 'FocusScope';\n\ntype FocusScopeElement = React.ElementRef<typeof Primitive.div>;\ntype PrimitiveDivProps = Radix.ComponentPropsWithoutRef<typeof Primitive.div>;\ninterface FocusScopeProps extends PrimitiveDivProps {\n  /**\n   * When `true`, tabbing from last item will focus first tabbable\n   * and shift+tab from first item will focus last tababble.\n   * @defaultValue false\n   */\n  loop?: boolean;\n\n  /**\n   * When `true`, focus cannot escape the focus scope via keyboard,\n   * pointer, or a programmatic focus.\n   * @defaultValue false\n   */\n  trapped?: boolean;\n\n  /**\n   * Event handler called when auto-focusing on mount.\n   * Can be prevented.\n   */\n  onMountAutoFocus?: (event: Event) => void;\n\n  /**\n   * Event handler called when auto-focusing on unmount.\n   * Can be prevented.\n   */\n  onUnmountAutoFocus?: (event: Event) => void;\n}\n\nconst FocusScope = React.forwardRef<FocusScopeElement, FocusScopeProps>((props, forwardedRef) => {\n  const {\n    loop = false,\n    trapped = false,\n    onMountAutoFocus: onMountAutoFocusProp,\n    onUnmountAutoFocus: onUnmountAutoFocusProp,\n    ...scopeProps\n  } = props;\n  const [container, setContainer] = React.useState<HTMLElement | null>(null);\n  const onMountAutoFocus = useCallbackRef(onMountAutoFocusProp);\n  const onUnmountAutoFocus = useCallbackRef(onUnmountAutoFocusProp);\n  const lastFocusedElementRef = React.useRef<HTMLElement | null>(null);\n  const composedRefs = useComposedRefs(forwardedRef, (node) => setContainer(node));\n\n  const focusScope = React.useRef({\n    paused: false,\n    pause() {\n      this.paused = true;\n    },\n    resume() {\n      this.paused = false;\n    },\n  }).current;\n\n  // Takes care of trapping focus if focus is moved outside programmatically for example\n  React.useEffect(() => {\n    if (trapped) {\n      function handleFocusIn(event: FocusEvent) {\n        if (focusScope.paused || !container) return;\n        const target = event.target as HTMLElement | null;\n        if (container.contains(target)) {\n          lastFocusedElementRef.current = target;\n        } else {\n          focus(lastFocusedElementRef.current, { select: true });\n        }\n      }\n\n      function handleFocusOut(event: FocusEvent) {\n        if (focusScope.paused || !container) return;\n        if (!container.contains(event.relatedTarget as HTMLElement | null)) {\n          focus(lastFocusedElementRef.current, { select: true });\n        }\n      }\n\n      document.addEventListener('focusin', handleFocusIn);\n      document.addEventListener('focusout', handleFocusOut);\n      return () => {\n        document.removeEventListener('focusin', handleFocusIn);\n        document.removeEventListener('focusout', handleFocusOut);\n      };\n    }\n  }, [trapped, container, focusScope.paused]);\n\n  React.useEffect(() => {\n    if (container) {\n      focusScopesStack.add(focusScope);\n      const previouslyFocusedElement = document.activeElement as HTMLElement | null;\n      const hasFocusedCandidate = container.contains(previouslyFocusedElement);\n\n      if (!hasFocusedCandidate) {\n        const mountEvent = new CustomEvent(AUTOFOCUS_ON_MOUNT, EVENT_OPTIONS);\n        container.addEventListener(AUTOFOCUS_ON_MOUNT, onMountAutoFocus);\n        container.dispatchEvent(mountEvent);\n        if (!mountEvent.defaultPrevented) {\n          focusFirst(removeLinks(getTabbableCandidates(container)), { select: true });\n          if (document.activeElement === previouslyFocusedElement) {\n            focus(container);\n          }\n        }\n      }\n\n      return () => {\n        container.removeEventListener(AUTOFOCUS_ON_MOUNT, onMountAutoFocus);\n\n        // We hit a react bug (fixed in v17) with focusing in unmount.\n        // We need to delay the focus a little to get around it for now.\n        // See: https://github.com/facebook/react/issues/17894\n        setTimeout(() => {\n          const unmountEvent = new CustomEvent(AUTOFOCUS_ON_UNMOUNT, EVENT_OPTIONS);\n          container.addEventListener(AUTOFOCUS_ON_UNMOUNT, onUnmountAutoFocus);\n          container.dispatchEvent(unmountEvent);\n          if (!unmountEvent.defaultPrevented) {\n            focus(previouslyFocusedElement ?? document.body, { select: true });\n          }\n          // we need to remove the listener after we `dispatchEvent`\n          container.removeEventListener(AUTOFOCUS_ON_UNMOUNT, onUnmountAutoFocus);\n\n          focusScopesStack.remove(focusScope);\n        }, 0);\n      };\n    }\n  }, [container, onMountAutoFocus, onUnmountAutoFocus, focusScope]);\n\n  // Takes care of looping focus (when tabbing whilst at the edges)\n  const handleKeyDown = React.useCallback(\n    (event: React.KeyboardEvent) => {\n      if (!loop && !trapped) return;\n      if (focusScope.paused) return;\n\n      const isTabKey = event.key === 'Tab' && !event.altKey && !event.ctrlKey && !event.metaKey;\n      const focusedElement = document.activeElement as HTMLElement | null;\n\n      if (isTabKey && focusedElement) {\n        const container = event.currentTarget as HTMLElement;\n        const [first, last] = getTabbableEdges(container);\n        const hasTabbableElementsInside = first && last;\n\n        // we can only wrap focus if we have tabbable edges\n        if (!hasTabbableElementsInside) {\n          if (focusedElement === container) event.preventDefault();\n        } else {\n          if (!event.shiftKey && focusedElement === last) {\n            event.preventDefault();\n            if (loop) focus(first, { select: true });\n          } else if (event.shiftKey && focusedElement === first) {\n            event.preventDefault();\n            if (loop) focus(last, { select: true });\n          }\n        }\n      }\n    },\n    [loop, trapped, focusScope.paused]\n  );\n\n  return (\n    <Primitive.div tabIndex={-1} {...scopeProps} ref={composedRefs} onKeyDown={handleKeyDown} />\n  );\n});\n\nFocusScope.displayName = FOCUS_SCOPE_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * Utils\n * -----------------------------------------------------------------------------------------------*/\n\n/**\n * Attempts focusing the first element in a list of candidates.\n * Stops when focus has actually moved.\n */\nfunction focusFirst(candidates: HTMLElement[], { select = false } = {}) {\n  const previouslyFocusedElement = document.activeElement;\n  for (const candidate of candidates) {\n    focus(candidate, { select });\n    if (document.activeElement !== previouslyFocusedElement) return;\n  }\n}\n\n/**\n * Returns the first and last tabbable elements inside a container.\n */\nfunction getTabbableEdges(container: HTMLElement) {\n  const candidates = getTabbableCandidates(container);\n  const first = findVisible(candidates, container);\n  const last = findVisible(candidates.reverse(), container);\n  return [first, last] as const;\n}\n\n/**\n * Returns a list of potential tabbable candidates.\n *\n * NOTE: This is only a close approximation. For example it doesn't take into account cases like when\n * elements are not visible. This cannot be worked out easily by just reading a property, but rather\n * necessitate runtime knowledge (computed styles, etc). We deal with these cases separately.\n *\n * See: https://developer.mozilla.org/en-US/docs/Web/API/TreeWalker\n * Credit: https://github.com/discord/focus-layers/blob/master/src/util/wrapFocus.tsx#L1\n */\nfunction getTabbableCandidates(container: HTMLElement) {\n  const nodes: HTMLElement[] = [];\n  const walker = document.createTreeWalker(container, NodeFilter.SHOW_ELEMENT, {\n    acceptNode: (node: any) => {\n      const isHiddenInput = node.tagName === 'INPUT' && node.type === 'hidden';\n      if (node.disabled || node.hidden || isHiddenInput) return NodeFilter.FILTER_SKIP;\n      // `.tabIndex` is not the same as the `tabindex` attribute. It works on the\n      // runtime's understanding of tabbability, so this automatically accounts\n      // for any kind of element that could be tabbed to.\n      return node.tabIndex >= 0 ? NodeFilter.FILTER_ACCEPT : NodeFilter.FILTER_SKIP;\n    },\n  });\n  while (walker.nextNode()) nodes.push(walker.currentNode as HTMLElement);\n  // we do not take into account the order of nodes with positive `tabIndex` as it\n  // hinders accessibility to have tab order different from visual order.\n  return nodes;\n}\n\n/**\n * Returns the first visible element in a list.\n * NOTE: Only checks visibility up to the `container`.\n */\nfunction findVisible(elements: HTMLElement[], container: HTMLElement) {\n  for (const element of elements) {\n    // we stop checking if it's hidden at the `container` level (excluding)\n    if (!isHidden(element, { upTo: container })) return element;\n  }\n}\n\nfunction isHidden(node: HTMLElement, { upTo }: { upTo?: HTMLElement }) {\n  if (getComputedStyle(node).visibility === 'hidden') return true;\n  while (node) {\n    // we stop at `upTo` (excluding it)\n    if (upTo !== undefined && node === upTo) return false;\n    if (getComputedStyle(node).display === 'none') return true;\n    node = node.parentElement as HTMLElement;\n  }\n  return false;\n}\n\nfunction isSelectableInput(element: any): element is FocusableTarget & { select: () => void } {\n  return element instanceof HTMLInputElement && 'select' in element;\n}\n\nfunction focus(element?: FocusableTarget | null, { select = false } = {}) {\n  // only focus if that element is focusable\n  if (element && element.focus) {\n    const previouslyFocusedElement = document.activeElement;\n    // NOTE: we prevent scrolling on focus, to minimize jarring transitions for users\n    element.focus({ preventScroll: true });\n    // only select if its not the same element, it supports selection and we need to select\n    if (element !== previouslyFocusedElement && isSelectableInput(element) && select)\n      element.select();\n  }\n}\n\n/* -------------------------------------------------------------------------------------------------\n * FocusScope stack\n * -----------------------------------------------------------------------------------------------*/\n\ntype FocusScopeAPI = { paused: boolean; pause(): void; resume(): void };\nconst focusScopesStack = createFocusScopesStack();\n\nfunction createFocusScopesStack() {\n  /** A stack of focus scopes, with the active one at the top */\n  let stack: FocusScopeAPI[] = [];\n\n  return {\n    add(focusScope: FocusScopeAPI) {\n      // pause the currently active focus scope (at the top of the stack)\n      const activeFocusScope = stack[0];\n      if (focusScope !== activeFocusScope) {\n        activeFocusScope?.pause();\n      }\n      // remove in case it already exists (because we'll re-add it at the top of the stack)\n      stack = arrayRemove(stack, focusScope);\n      stack.unshift(focusScope);\n    },\n\n    remove(focusScope: FocusScopeAPI) {\n      stack = arrayRemove(stack, focusScope);\n      stack[0]?.resume();\n    },\n  };\n}\n\nfunction arrayRemove<T>(array: T[], item: T) {\n  const updatedArray = [...array];\n  const index = updatedArray.indexOf(item);\n  if (index !== -1) {\n    updatedArray.splice(index, 1);\n  }\n  return updatedArray;\n}\n\nfunction removeLinks(items: HTMLElement[]) {\n  return items.filter((item) => item.tagName !== 'A');\n}\n\nconst Root = FocusScope;\n\nexport {\n  FocusScope,\n  //\n  Root,\n};\nexport type { FocusScopeProps };\n","import * as React from 'react';\nimport { useLayoutEffect } from '@radix-ui/react-use-layout-effect';\n\n// We `toString()` to prevent bundlers from trying to `import { useId } from 'react';`\nconst useReactId = (React as any)['useId'.toString()] || (() => undefined);\nlet count = 0;\n\nfunction useId(deterministicId?: string): string {\n  const [id, setId] = React.useState<string | undefined>(useReactId());\n  // React versions older than 18 will have client-side ids only.\n  useLayoutEffect(() => {\n    if (!deterministicId) setId((reactId) => reactId ?? String(count++));\n  }, [deterministicId]);\n  return deterministicId || (id ? `radix-${id}` : '');\n}\n\nexport { useId };\n","function t(t){return t.split(\"-\")[0]}function e(t){return t.split(\"-\")[1]}function n(e){return[\"top\",\"bottom\"].includes(t(e))?\"x\":\"y\"}function r(t){return\"y\"===t?\"height\":\"width\"}function i(i,o,a){let{reference:l,floating:s}=i;const c=l.x+l.width/2-s.width/2,f=l.y+l.height/2-s.height/2,u=n(o),m=r(u),g=l[m]/2-s[m]/2,d=\"x\"===u;let p;switch(t(o)){case\"top\":p={x:c,y:l.y-s.height};break;case\"bottom\":p={x:c,y:l.y+l.height};break;case\"right\":p={x:l.x+l.width,y:f};break;case\"left\":p={x:l.x-s.width,y:f};break;default:p={x:l.x,y:l.y}}switch(e(o)){case\"start\":p[u]-=g*(a&&d?-1:1);break;case\"end\":p[u]+=g*(a&&d?-1:1)}return p}const o=async(t,e,n)=>{const{placement:r=\"bottom\",strategy:o=\"absolute\",middleware:a=[],platform:l}=n,s=await(null==l.isRTL?void 0:l.isRTL(e));let c=await l.getElementRects({reference:t,floating:e,strategy:o}),{x:f,y:u}=i(c,r,s),m=r,g={},d=0;for(let n=0;n<a.length;n++){const{name:p,fn:h}=a[n],{x:y,y:x,data:w,reset:v}=await h({x:f,y:u,initialPlacement:r,placement:m,strategy:o,middlewareData:g,rects:c,platform:l,elements:{reference:t,floating:e}});f=null!=y?y:f,u=null!=x?x:u,g={...g,[p]:{...g[p],...w}},v&&d<=50&&(d++,\"object\"==typeof v&&(v.placement&&(m=v.placement),v.rects&&(c=!0===v.rects?await l.getElementRects({reference:t,floating:e,strategy:o}):v.rects),({x:f,y:u}=i(c,m,s))),n=-1)}return{x:f,y:u,placement:m,strategy:o,middlewareData:g}};function a(t){return\"number\"!=typeof t?function(t){return{top:0,right:0,bottom:0,left:0,...t}}(t):{top:t,right:t,bottom:t,left:t}}function l(t){return{...t,top:t.y,left:t.x,right:t.x+t.width,bottom:t.y+t.height}}async function s(t,e){var n;void 0===e&&(e={});const{x:r,y:i,platform:o,rects:s,elements:c,strategy:f}=t,{boundary:u=\"clippingAncestors\",rootBoundary:m=\"viewport\",elementContext:g=\"floating\",altBoundary:d=!1,padding:p=0}=e,h=a(p),y=c[d?\"floating\"===g?\"reference\":\"floating\":g],x=l(await o.getClippingRect({element:null==(n=await(null==o.isElement?void 0:o.isElement(y)))||n?y:y.contextElement||await(null==o.getDocumentElement?void 0:o.getDocumentElement(c.floating)),boundary:u,rootBoundary:m,strategy:f})),w=l(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({rect:\"floating\"===g?{...s.floating,x:r,y:i}:s.reference,offsetParent:await(null==o.getOffsetParent?void 0:o.getOffsetParent(c.floating)),strategy:f}):s[g]);return{top:x.top-w.top+h.top,bottom:w.bottom-x.bottom+h.bottom,left:x.left-w.left+h.left,right:w.right-x.right+h.right}}const c=Math.min,f=Math.max;function u(t,e,n){return f(t,c(e,n))}const m=t=>({name:\"arrow\",options:t,async fn(i){const{element:o,padding:l=0}=null!=t?t:{},{x:s,y:c,placement:f,rects:m,platform:g}=i;if(null==o)return{};const d=a(l),p={x:s,y:c},h=n(f),y=e(f),x=r(h),w=await g.getDimensions(o),v=\"y\"===h?\"top\":\"left\",b=\"y\"===h?\"bottom\":\"right\",R=m.reference[x]+m.reference[h]-p[h]-m.floating[x],A=p[h]-m.reference[h],P=await(null==g.getOffsetParent?void 0:g.getOffsetParent(o));let T=P?\"y\"===h?P.clientHeight||0:P.clientWidth||0:0;0===T&&(T=m.floating[x]);const O=R/2-A/2,D=d[v],L=T-w[x]-d[b],k=T/2-w[x]/2+O,E=u(D,k,L),C=(\"start\"===y?d[v]:d[b])>0&&k!==E&&m.reference[x]<=m.floating[x];return{[h]:p[h]-(C?k<D?D-k:L-k:0),data:{[h]:E,centerOffset:k-E}}}}),g={left:\"right\",right:\"left\",bottom:\"top\",top:\"bottom\"};function d(t){return t.replace(/left|right|bottom|top/g,(t=>g[t]))}function p(t,i,o){void 0===o&&(o=!1);const a=e(t),l=n(t),s=r(l);let c=\"x\"===l?a===(o?\"end\":\"start\")?\"right\":\"left\":\"start\"===a?\"bottom\":\"top\";return i.reference[s]>i.floating[s]&&(c=d(c)),{main:c,cross:d(c)}}const h={start:\"end\",end:\"start\"};function y(t){return t.replace(/start|end/g,(t=>h[t]))}const x=[\"top\",\"right\",\"bottom\",\"left\"],w=x.reduce(((t,e)=>t.concat(e,e+\"-start\",e+\"-end\")),[]);const v=function(n){return void 0===n&&(n={}),{name:\"autoPlacement\",options:n,async fn(r){var i,o,a,l,c;const{x:f,y:u,rects:m,middlewareData:g,placement:d,platform:h,elements:x}=r,{alignment:v=null,allowedPlacements:b=w,autoAlignment:R=!0,...A}=n,P=function(n,r,i){return(n?[...i.filter((t=>e(t)===n)),...i.filter((t=>e(t)!==n))]:i.filter((e=>t(e)===e))).filter((t=>!n||e(t)===n||!!r&&y(t)!==t))}(v,R,b),T=await s(r,A),O=null!=(i=null==(o=g.autoPlacement)?void 0:o.index)?i:0,D=P[O];if(null==D)return{};const{main:L,cross:k}=p(D,m,await(null==h.isRTL?void 0:h.isRTL(x.floating)));if(d!==D)return{x:f,y:u,reset:{placement:P[0]}};const E=[T[t(D)],T[L],T[k]],C=[...null!=(a=null==(l=g.autoPlacement)?void 0:l.overflows)?a:[],{placement:D,overflows:E}],H=P[O+1];if(H)return{data:{index:O+1,overflows:C},reset:{placement:H}};const B=C.slice().sort(((t,e)=>t.overflows[0]-e.overflows[0])),V=null==(c=B.find((t=>{let{overflows:e}=t;return e.every((t=>t<=0))})))?void 0:c.placement,F=null!=V?V:B[0].placement;return F!==d?{data:{index:O+1,overflows:C},reset:{placement:F}}:{}}}};const b=function(e){return void 0===e&&(e={}),{name:\"flip\",options:e,async fn(n){var r;const{placement:i,middlewareData:o,rects:a,initialPlacement:l,platform:c,elements:f}=n,{mainAxis:u=!0,crossAxis:m=!0,fallbackPlacements:g,fallbackStrategy:h=\"bestFit\",flipAlignment:x=!0,...w}=e,v=t(i),b=g||(v===l||!x?[d(l)]:function(t){const e=d(t);return[y(t),e,y(e)]}(l)),R=[l,...b],A=await s(n,w),P=[];let T=(null==(r=o.flip)?void 0:r.overflows)||[];if(u&&P.push(A[v]),m){const{main:t,cross:e}=p(i,a,await(null==c.isRTL?void 0:c.isRTL(f.floating)));P.push(A[t],A[e])}if(T=[...T,{placement:i,overflows:P}],!P.every((t=>t<=0))){var O,D;const t=(null!=(O=null==(D=o.flip)?void 0:D.index)?O:0)+1,e=R[t];if(e)return{data:{index:t,overflows:T},reset:{placement:e}};let n=\"bottom\";switch(h){case\"bestFit\":{var L;const t=null==(L=T.map((t=>[t,t.overflows.filter((t=>t>0)).reduce(((t,e)=>t+e),0)])).sort(((t,e)=>t[1]-e[1]))[0])?void 0:L[0].placement;t&&(n=t);break}case\"initialPlacement\":n=l}if(i!==n)return{reset:{placement:n}}}return{}}}};function R(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function A(t){return x.some((e=>t[e]>=0))}const P=function(t){let{strategy:e=\"referenceHidden\",...n}=void 0===t?{}:t;return{name:\"hide\",async fn(t){const{rects:r}=t;switch(e){case\"referenceHidden\":{const e=R(await s(t,{...n,elementContext:\"reference\"}),r.reference);return{data:{referenceHiddenOffsets:e,referenceHidden:A(e)}}}case\"escaped\":{const e=R(await s(t,{...n,altBoundary:!0}),r.floating);return{data:{escapedOffsets:e,escaped:A(e)}}}default:return{}}}}};const T=function(r){return void 0===r&&(r=0),{name:\"offset\",options:r,async fn(i){const{x:o,y:a}=i,l=await async function(r,i){const{placement:o,platform:a,elements:l}=r,s=await(null==a.isRTL?void 0:a.isRTL(l.floating)),c=t(o),f=e(o),u=\"x\"===n(o),m=[\"left\",\"top\"].includes(c)?-1:1,g=s&&u?-1:1,d=\"function\"==typeof i?i(r):i;let{mainAxis:p,crossAxis:h,alignmentAxis:y}=\"number\"==typeof d?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...d};return f&&\"number\"==typeof y&&(h=\"end\"===f?-1*y:y),u?{x:h*g,y:p*m}:{x:p*m,y:h*g}}(i,r);return{x:o+l.x,y:a+l.y,data:l}}}};function O(t){return\"x\"===t?\"y\":\"x\"}const D=function(e){return void 0===e&&(e={}),{name:\"shift\",options:e,async fn(r){const{x:i,y:o,placement:a}=r,{mainAxis:l=!0,crossAxis:c=!1,limiter:f={fn:t=>{let{x:e,y:n}=t;return{x:e,y:n}}},...m}=e,g={x:i,y:o},d=await s(r,m),p=n(t(a)),h=O(p);let y=g[p],x=g[h];if(l){const t=\"y\"===p?\"bottom\":\"right\";y=u(y+d[\"y\"===p?\"top\":\"left\"],y,y-d[t])}if(c){const t=\"y\"===h?\"bottom\":\"right\";x=u(x+d[\"y\"===h?\"top\":\"left\"],x,x-d[t])}const w=f.fn({...r,[p]:y,[h]:x});return{...w,data:{x:w.x-i,y:w.y-o}}}}},L=function(e){return void 0===e&&(e={}),{options:e,fn(r){const{x:i,y:o,placement:a,rects:l,middlewareData:s}=r,{offset:c=0,mainAxis:f=!0,crossAxis:u=!0}=e,m={x:i,y:o},g=n(a),d=O(g);let p=m[g],h=m[d];const y=\"function\"==typeof c?c({...l,placement:a}):c,x=\"number\"==typeof y?{mainAxis:y,crossAxis:0}:{mainAxis:0,crossAxis:0,...y};if(f){const t=\"y\"===g?\"height\":\"width\",e=l.reference[g]-l.floating[t]+x.mainAxis,n=l.reference[g]+l.reference[t]-x.mainAxis;p<e?p=e:p>n&&(p=n)}if(u){var w,v,b,R;const e=\"y\"===g?\"width\":\"height\",n=[\"top\",\"left\"].includes(t(a)),r=l.reference[d]-l.floating[e]+(n&&null!=(w=null==(v=s.offset)?void 0:v[d])?w:0)+(n?0:x.crossAxis),i=l.reference[d]+l.reference[e]+(n?0:null!=(b=null==(R=s.offset)?void 0:R[d])?b:0)-(n?x.crossAxis:0);h<r?h=r:h>i&&(h=i)}return{[g]:p,[d]:h}}}},k=function(n){return void 0===n&&(n={}),{name:\"size\",options:n,async fn(r){const{placement:i,rects:o,platform:a,elements:l}=r,{apply:c,...u}=n,m=await s(r,u),g=t(i),d=e(i);let p,h;\"top\"===g||\"bottom\"===g?(p=g,h=d===(await(null==a.isRTL?void 0:a.isRTL(l.floating))?\"start\":\"end\")?\"left\":\"right\"):(h=g,p=\"end\"===d?\"top\":\"bottom\");const y=f(m.left,0),x=f(m.right,0),w=f(m.top,0),v=f(m.bottom,0),b={availableHeight:o.floating.height-([\"left\",\"right\"].includes(i)?2*(0!==w||0!==v?w+v:f(m.top,m.bottom)):m[p]),availableWidth:o.floating.width-([\"top\",\"bottom\"].includes(i)?2*(0!==y||0!==x?y+x:f(m.left,m.right)):m[h])},R=await a.getDimensions(l.floating);null==c||c({...r,...b});const A=await a.getDimensions(l.floating);return R.width!==A.width||R.height!==A.height?{reset:{rects:!0}}:{}}}},E=function(e){return void 0===e&&(e={}),{name:\"inline\",options:e,async fn(r){var i;const{placement:o,elements:s,rects:u,platform:m,strategy:g}=r,{padding:d=2,x:p,y:h}=e,y=l(m.convertOffsetParentRelativeRectToViewportRelativeRect?await m.convertOffsetParentRelativeRectToViewportRelativeRect({rect:u.reference,offsetParent:await(null==m.getOffsetParent?void 0:m.getOffsetParent(s.floating)),strategy:g}):u.reference),x=null!=(i=await(null==m.getClientRects?void 0:m.getClientRects(s.reference)))?i:[],w=a(d);const v=await m.getElementRects({reference:{getBoundingClientRect:function(){var e;if(2===x.length&&x[0].left>x[1].right&&null!=p&&null!=h)return null!=(e=x.find((t=>p>t.left-w.left&&p<t.right+w.right&&h>t.top-w.top&&h<t.bottom+w.bottom)))?e:y;if(x.length>=2){if(\"x\"===n(o)){const e=x[0],n=x[x.length-1],r=\"top\"===t(o),i=e.top,a=n.bottom,l=r?e.left:n.left,s=r?e.right:n.right;return{top:i,bottom:a,left:l,right:s,width:s-l,height:a-i,x:l,y:i}}const e=\"left\"===t(o),r=f(...x.map((t=>t.right))),i=c(...x.map((t=>t.left))),a=x.filter((t=>e?t.left===i:t.right===r)),l=a[0].top,s=a[a.length-1].bottom;return{top:l,bottom:s,left:i,right:r,width:r-i,height:s-l,x:i,y:l}}return y}},floating:s.floating,strategy:g});return u.reference.x!==v.reference.x||u.reference.y!==v.reference.y||u.reference.width!==v.reference.width||u.reference.height!==v.reference.height?{reset:{rects:v}}:{}}}};export{m as arrow,v as autoPlacement,o as computePosition,s as detectOverflow,b as flip,P as hide,E as inline,L as limitShift,T as offset,l as rectToClientRect,D as shift,k as size};\n","import{rectToClientRect as t,computePosition as e}from\"@floating-ui/core\";export{arrow,autoPlacement,detectOverflow,flip,hide,inline,limitShift,offset,shift,size}from\"@floating-ui/core\";function n(t){return t&&t.document&&t.location&&t.alert&&t.setInterval}function o(t){if(null==t)return window;if(!n(t)){const e=t.ownerDocument;return e&&e.defaultView||window}return t}function i(t){return o(t).getComputedStyle(t)}function r(t){return n(t)?\"\":t?(t.nodeName||\"\").toLowerCase():\"\"}function l(){const t=navigator.userAgentData;return null!=t&&t.brands?t.brands.map((t=>t.brand+\"/\"+t.version)).join(\" \"):navigator.userAgent}function c(t){return t instanceof o(t).HTMLElement}function f(t){return t instanceof o(t).Element}function s(t){if(\"undefined\"==typeof ShadowRoot)return!1;return t instanceof o(t).ShadowRoot||t instanceof ShadowRoot}function u(t){const{overflow:e,overflowX:n,overflowY:o}=i(t);return/auto|scroll|overlay|hidden/.test(e+o+n)}function d(t){return[\"table\",\"td\",\"th\"].includes(r(t))}function h(t){const e=/firefox/i.test(l()),n=i(t);return\"none\"!==n.transform||\"none\"!==n.perspective||\"paint\"===n.contain||[\"transform\",\"perspective\"].includes(n.willChange)||e&&\"filter\"===n.willChange||e&&!!n.filter&&\"none\"!==n.filter}function a(){return!/^((?!chrome|android).)*safari/i.test(l())}const g=Math.min,p=Math.max,m=Math.round;function w(t,e,n){var i,r,l,s;void 0===e&&(e=!1),void 0===n&&(n=!1);const u=t.getBoundingClientRect();let d=1,h=1;e&&c(t)&&(d=t.offsetWidth>0&&m(u.width)/t.offsetWidth||1,h=t.offsetHeight>0&&m(u.height)/t.offsetHeight||1);const g=f(t)?o(t):window,p=!a()&&n,w=(u.left+(p&&null!=(i=null==(r=g.visualViewport)?void 0:r.offsetLeft)?i:0))/d,v=(u.top+(p&&null!=(l=null==(s=g.visualViewport)?void 0:s.offsetTop)?l:0))/h,y=u.width/d,x=u.height/h;return{width:y,height:x,top:v,right:w+y,bottom:v+x,left:w,x:w,y:v}}function v(t){return(e=t,(e instanceof o(e).Node?t.ownerDocument:t.document)||window.document).documentElement;var e}function y(t){return f(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function x(t){return w(v(t)).left+y(t).scrollLeft}function b(t,e,n){const o=c(e),i=v(e),l=w(t,o&&function(t){const e=w(t);return m(e.width)!==t.offsetWidth||m(e.height)!==t.offsetHeight}(e),\"fixed\"===n);let f={scrollLeft:0,scrollTop:0};const s={x:0,y:0};if(o||!o&&\"fixed\"!==n)if((\"body\"!==r(e)||u(i))&&(f=y(e)),c(e)){const t=w(e,!0);s.x=t.x+e.clientLeft,s.y=t.y+e.clientTop}else i&&(s.x=x(i));return{x:l.left+f.scrollLeft-s.x,y:l.top+f.scrollTop-s.y,width:l.width,height:l.height}}function L(t){return\"html\"===r(t)?t:t.assignedSlot||t.parentNode||(s(t)?t.host:null)||v(t)}function R(t){return c(t)&&\"fixed\"!==getComputedStyle(t).position?t.offsetParent:null}function T(t){const e=o(t);let n=R(t);for(;n&&d(n)&&\"static\"===getComputedStyle(n).position;)n=R(n);return n&&(\"html\"===r(n)||\"body\"===r(n)&&\"static\"===getComputedStyle(n).position&&!h(n))?e:n||function(t){let e=L(t);for(s(e)&&(e=e.host);c(e)&&![\"html\",\"body\"].includes(r(e));){if(h(e))return e;e=e.parentNode}return null}(t)||e}function W(t){if(c(t))return{width:t.offsetWidth,height:t.offsetHeight};const e=w(t);return{width:e.width,height:e.height}}function E(t){const e=L(t);return[\"html\",\"body\",\"#document\"].includes(r(e))?t.ownerDocument.body:c(e)&&u(e)?e:E(e)}function H(t,e){var n;void 0===e&&(e=[]);const i=E(t),r=i===(null==(n=t.ownerDocument)?void 0:n.body),l=o(i),c=r?[l].concat(l.visualViewport||[],u(i)?i:[]):i,f=e.concat(c);return r?f:f.concat(H(c))}function C(e,n,r){return\"viewport\"===n?t(function(t,e){const n=o(t),i=v(t),r=n.visualViewport;let l=i.clientWidth,c=i.clientHeight,f=0,s=0;if(r){l=r.width,c=r.height;const t=a();(t||!t&&\"fixed\"===e)&&(f=r.offsetLeft,s=r.offsetTop)}return{width:l,height:c,x:f,y:s}}(e,r)):f(n)?function(t,e){const n=w(t,!1,\"fixed\"===e),o=n.top+t.clientTop,i=n.left+t.clientLeft;return{top:o,left:i,x:i,y:o,right:i+t.clientWidth,bottom:o+t.clientHeight,width:t.clientWidth,height:t.clientHeight}}(n,r):t(function(t){var e;const n=v(t),o=y(t),r=null==(e=t.ownerDocument)?void 0:e.body,l=p(n.scrollWidth,n.clientWidth,r?r.scrollWidth:0,r?r.clientWidth:0),c=p(n.scrollHeight,n.clientHeight,r?r.scrollHeight:0,r?r.clientHeight:0);let f=-o.scrollLeft+x(t);const s=-o.scrollTop;return\"rtl\"===i(r||n).direction&&(f+=p(n.clientWidth,r?r.clientWidth:0)-l),{width:l,height:c,x:f,y:s}}(v(e)))}function S(t){const e=H(t),n=[\"absolute\",\"fixed\"].includes(i(t).position)&&c(t)?T(t):t;return f(n)?e.filter((t=>f(t)&&function(t,e){const n=null==e.getRootNode?void 0:e.getRootNode();if(t.contains(e))return!0;if(n&&s(n)){let n=e;do{if(n&&t===n)return!0;n=n.parentNode||n.host}while(n)}return!1}(t,n)&&\"body\"!==r(t))):[]}const D={getClippingRect:function(t){let{element:e,boundary:n,rootBoundary:o,strategy:i}=t;const r=[...\"clippingAncestors\"===n?S(e):[].concat(n),o],l=r[0],c=r.reduce(((t,n)=>{const o=C(e,n,i);return t.top=p(o.top,t.top),t.right=g(o.right,t.right),t.bottom=g(o.bottom,t.bottom),t.left=p(o.left,t.left),t}),C(e,l,i));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}},convertOffsetParentRelativeRectToViewportRelativeRect:function(t){let{rect:e,offsetParent:n,strategy:o}=t;const i=c(n),l=v(n);if(n===l)return e;let f={scrollLeft:0,scrollTop:0};const s={x:0,y:0};if((i||!i&&\"fixed\"!==o)&&((\"body\"!==r(n)||u(l))&&(f=y(n)),c(n))){const t=w(n,!0);s.x=t.x+n.clientLeft,s.y=t.y+n.clientTop}return{...e,x:e.x-f.scrollLeft+s.x,y:e.y-f.scrollTop+s.y}},isElement:f,getDimensions:W,getOffsetParent:T,getDocumentElement:v,getElementRects:t=>{let{reference:e,floating:n,strategy:o}=t;return{reference:b(e,T(n),o),floating:{...W(n),x:0,y:0}}},getClientRects:t=>Array.from(t.getClientRects()),isRTL:t=>\"rtl\"===i(t).direction};function N(t,e,n,o){void 0===o&&(o={});const{ancestorScroll:i=!0,ancestorResize:r=!0,elementResize:l=!0,animationFrame:c=!1}=o,s=i&&!c,u=r&&!c,d=s||u?[...f(t)?H(t):[],...H(e)]:[];d.forEach((t=>{s&&t.addEventListener(\"scroll\",n,{passive:!0}),u&&t.addEventListener(\"resize\",n)}));let h,a=null;if(l){let o=!0;a=new ResizeObserver((()=>{o||n(),o=!1})),f(t)&&!c&&a.observe(t),a.observe(e)}let g=c?w(t):null;return c&&function e(){const o=w(t);!g||o.x===g.x&&o.y===g.y&&o.width===g.width&&o.height===g.height||n();g=o,h=requestAnimationFrame(e)}(),n(),()=>{var t;d.forEach((t=>{s&&t.removeEventListener(\"scroll\",n),u&&t.removeEventListener(\"resize\",n)})),null==(t=a)||t.disconnect(),a=null,c&&cancelAnimationFrame(h)}}const z=(t,n,o)=>e(t,n,{platform:D,...o});export{N as autoUpdate,z as computePosition,H as getOverflowAncestors};\n","import { computePosition, arrow as arrow$1 } from '@floating-ui/dom';\nexport * from '@floating-ui/dom';\nimport * as React from 'react';\nimport { useLayoutEffect, useEffect } from 'react';\nimport * as ReactDOM from 'react-dom';\n\nvar index = typeof document !== 'undefined' ? useLayoutEffect : useEffect;\n\n// Fork of `fast-deep-equal` that only does the comparisons we need and compares\n// functions\nfunction deepEqual(a, b) {\n  if (a === b) {\n    return true;\n  }\n\n  if (typeof a !== typeof b) {\n    return false;\n  }\n\n  if (typeof a === 'function' && a.toString() === b.toString()) {\n    return true;\n  }\n\n  let length, i, keys;\n\n  if (a && b && typeof a == 'object') {\n    if (Array.isArray(a)) {\n      length = a.length;\n      if (length != b.length) return false;\n\n      for (i = length; i-- !== 0;) {\n        if (!deepEqual(a[i], b[i])) {\n          return false;\n        }\n      }\n\n      return true;\n    }\n\n    keys = Object.keys(a);\n    length = keys.length;\n\n    if (length !== Object.keys(b).length) {\n      return false;\n    }\n\n    for (i = length; i-- !== 0;) {\n      if (!Object.prototype.hasOwnProperty.call(b, keys[i])) {\n        return false;\n      }\n    }\n\n    for (i = length; i-- !== 0;) {\n      const key = keys[i];\n\n      if (key === '_owner' && a.$$typeof) {\n        continue;\n      }\n\n      if (!deepEqual(a[key], b[key])) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  return a !== a && b !== b;\n}\n\nfunction useLatestRef(value) {\n  const ref = React.useRef(value);\n  index(() => {\n    ref.current = value;\n  });\n  return ref;\n}\n\nfunction useFloating(_temp) {\n  let {\n    middleware,\n    placement = 'bottom',\n    strategy = 'absolute',\n    whileElementsMounted\n  } = _temp === void 0 ? {} : _temp;\n  const reference = React.useRef(null);\n  const floating = React.useRef(null);\n  const whileElementsMountedRef = useLatestRef(whileElementsMounted);\n  const cleanupRef = React.useRef(null);\n  const [data, setData] = React.useState({\n    // Setting these to `null` will allow the consumer to determine if\n    // `computePosition()` has run yet\n    x: null,\n    y: null,\n    strategy,\n    placement,\n    middlewareData: {}\n  });\n  const [latestMiddleware, setLatestMiddleware] = React.useState(middleware);\n\n  if (!deepEqual(latestMiddleware == null ? void 0 : latestMiddleware.map(_ref => {\n    let {\n      options\n    } = _ref;\n    return options;\n  }), middleware == null ? void 0 : middleware.map(_ref2 => {\n    let {\n      options\n    } = _ref2;\n    return options;\n  }))) {\n    setLatestMiddleware(middleware);\n  }\n\n  const update = React.useCallback(() => {\n    if (!reference.current || !floating.current) {\n      return;\n    }\n\n    computePosition(reference.current, floating.current, {\n      middleware: latestMiddleware,\n      placement,\n      strategy\n    }).then(data => {\n      if (isMountedRef.current) {\n        ReactDOM.flushSync(() => {\n          setData(data);\n        });\n      }\n    });\n  }, [latestMiddleware, placement, strategy]);\n  index(() => {\n    // Skip first update\n    if (isMountedRef.current) {\n      update();\n    }\n  }, [update]);\n  const isMountedRef = React.useRef(false);\n  index(() => {\n    isMountedRef.current = true;\n    return () => {\n      isMountedRef.current = false;\n    };\n  }, []);\n  const runElementMountCallback = React.useCallback(() => {\n    if (typeof cleanupRef.current === 'function') {\n      cleanupRef.current();\n      cleanupRef.current = null;\n    }\n\n    if (reference.current && floating.current) {\n      if (whileElementsMountedRef.current) {\n        const cleanupFn = whileElementsMountedRef.current(reference.current, floating.current, update);\n        cleanupRef.current = cleanupFn;\n      } else {\n        update();\n      }\n    }\n  }, [update, whileElementsMountedRef]);\n  const setReference = React.useCallback(node => {\n    reference.current = node;\n    runElementMountCallback();\n  }, [runElementMountCallback]);\n  const setFloating = React.useCallback(node => {\n    floating.current = node;\n    runElementMountCallback();\n  }, [runElementMountCallback]);\n  const refs = React.useMemo(() => ({\n    reference,\n    floating\n  }), []);\n  return React.useMemo(() => ({ ...data,\n    update,\n    refs,\n    reference: setReference,\n    floating: setFloating\n  }), [data, update, refs, setReference, setFloating]);\n}\n\n/**\n * Positions an inner element of the floating element such that it is centered\n * to the reference element.\n * This wraps the core `arrow` middleware to allow React refs as the element.\n * @see https://floating-ui.com/docs/arrow\n */\n\nconst arrow = options => {\n  const {\n    element,\n    padding\n  } = options;\n\n  function isRef(value) {\n    return Object.prototype.hasOwnProperty.call(value, 'current');\n  }\n\n  return {\n    name: 'arrow',\n    options,\n\n    fn(args) {\n      if (isRef(element)) {\n        if (element.current != null) {\n          return arrow$1({\n            element: element.current,\n            padding\n          }).fn(args);\n        }\n\n        return {};\n      } else if (element) {\n        return arrow$1({\n          element,\n          padding\n        }).fn(args);\n      }\n\n      return {};\n    }\n\n  };\n};\n\nexport { arrow, useFloating };\n","/// <reference types=\"resize-observer-browser\" />\n\nimport * as React from 'react';\nimport { useLayoutEffect } from '@radix-ui/react-use-layout-effect';\n\nfunction useSize(element: HTMLElement | null) {\n  const [size, setSize] = React.useState<{ width: number; height: number } | undefined>(undefined);\n\n  useLayoutEffect(() => {\n    if (element) {\n      // provide size as early as possible\n      setSize({ width: element.offsetWidth, height: element.offsetHeight });\n\n      const resizeObserver = new ResizeObserver((entries) => {\n        if (!Array.isArray(entries)) {\n          return;\n        }\n\n        // Since we only observe the one element, we don't need to loop over the\n        // array\n        if (!entries.length) {\n          return;\n        }\n\n        const entry = entries[0];\n        let width: number;\n        let height: number;\n\n        if ('borderBoxSize' in entry) {\n          const borderSizeEntry = entry['borderBoxSize'];\n          // iron out differences between browsers\n          const borderSize = Array.isArray(borderSizeEntry) ? borderSizeEntry[0] : borderSizeEntry;\n          width = borderSize['inlineSize'];\n          height = borderSize['blockSize'];\n        } else {\n          // for browsers that don't support `borderBoxSize`\n          // we calculate it ourselves to get the correct border box.\n          width = element.offsetWidth;\n          height = element.offsetHeight;\n        }\n\n        setSize({ width, height });\n      });\n\n      resizeObserver.observe(element, { box: 'border-box' });\n\n      return () => resizeObserver.unobserve(element);\n    } else {\n      // We only want to reset to `undefined` when the element becomes `null`,\n      // not if it changes to another element.\n      setSize(undefined);\n    }\n  }, [element]);\n\n  return size;\n}\n\nexport { useSize };\n","import * as React from 'react';\nimport {\n  useFloating,\n  autoUpdate,\n  offset,\n  shift,\n  limitShift,\n  hide,\n  arrow as floatingUIarrow,\n  flip,\n  size,\n} from '@floating-ui/react-dom';\nimport * as ArrowPrimitive from '@radix-ui/react-arrow';\nimport { useComposedRefs } from '@radix-ui/react-compose-refs';\nimport { createContextScope } from '@radix-ui/react-context';\nimport { Primitive } from '@radix-ui/react-primitive';\nimport { useCallbackRef } from '@radix-ui/react-use-callback-ref';\nimport { useLayoutEffect } from '@radix-ui/react-use-layout-effect';\nimport { useSize } from '@radix-ui/react-use-size';\n\nimport type { Placement, Middleware } from '@floating-ui/react-dom';\nimport type * as Radix from '@radix-ui/react-primitive';\nimport type { Scope } from '@radix-ui/react-context';\nimport type { Measurable } from '@radix-ui/rect';\n\nconst SIDE_OPTIONS = ['top', 'right', 'bottom', 'left'] as const;\nconst ALIGN_OPTIONS = ['start', 'center', 'end'] as const;\n\ntype Side = typeof SIDE_OPTIONS[number];\ntype Align = typeof ALIGN_OPTIONS[number];\n\n/* -------------------------------------------------------------------------------------------------\n * Popper\n * -----------------------------------------------------------------------------------------------*/\n\nconst POPPER_NAME = 'Popper';\n\ntype ScopedProps<P> = P & { __scopePopper?: Scope };\nconst [createPopperContext, createPopperScope] = createContextScope(POPPER_NAME);\n\ntype PopperContextValue = {\n  anchor: Measurable | null;\n  onAnchorChange(anchor: Measurable | null): void;\n};\nconst [PopperProvider, usePopperContext] = createPopperContext<PopperContextValue>(POPPER_NAME);\n\ninterface PopperProps {\n  children?: React.ReactNode;\n}\nconst Popper: React.FC<PopperProps> = (props: ScopedProps<PopperProps>) => {\n  const { __scopePopper, children } = props;\n  const [anchor, setAnchor] = React.useState<Measurable | null>(null);\n  return (\n    <PopperProvider scope={__scopePopper} anchor={anchor} onAnchorChange={setAnchor}>\n      {children}\n    </PopperProvider>\n  );\n};\n\nPopper.displayName = POPPER_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * PopperAnchor\n * -----------------------------------------------------------------------------------------------*/\n\nconst ANCHOR_NAME = 'PopperAnchor';\n\ntype PopperAnchorElement = React.ElementRef<typeof Primitive.div>;\ntype PrimitiveDivProps = Radix.ComponentPropsWithoutRef<typeof Primitive.div>;\ninterface PopperAnchorProps extends PrimitiveDivProps {\n  virtualRef?: React.RefObject<Measurable>;\n}\n\nconst PopperAnchor = React.forwardRef<PopperAnchorElement, PopperAnchorProps>(\n  (props: ScopedProps<PopperAnchorProps>, forwardedRef) => {\n    const { __scopePopper, virtualRef, ...anchorProps } = props;\n    const context = usePopperContext(ANCHOR_NAME, __scopePopper);\n    const ref = React.useRef<PopperAnchorElement>(null);\n    const composedRefs = useComposedRefs(forwardedRef, ref);\n\n    React.useEffect(() => {\n      // Consumer can anchor the popper to something that isn't\n      // a DOM node e.g. pointer position, so we override the\n      // `anchorRef` with their virtual ref in this case.\n      context.onAnchorChange(virtualRef?.current || ref.current);\n    });\n\n    return virtualRef ? null : <Primitive.div {...anchorProps} ref={composedRefs} />;\n  }\n);\n\nPopperAnchor.displayName = ANCHOR_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * PopperContent\n * -----------------------------------------------------------------------------------------------*/\n\nconst CONTENT_NAME = 'PopperContent';\n\ntype PopperContentContextValue = {\n  placedSide: Side;\n  onArrowChange(arrow: HTMLSpanElement | null): void;\n  arrowX?: number;\n  arrowY?: number;\n  shouldHideArrow: boolean;\n};\n\nconst [PopperContentProvider, useContentContext] =\n  createPopperContext<PopperContentContextValue>(CONTENT_NAME);\n\nconst [PositionContextProvider, usePositionContext] = createPopperContext(CONTENT_NAME, {\n  hasParent: false,\n  positionUpdateFns: new Set<() => void>(),\n});\n\ntype Boundary = Element | null;\n\ntype PopperContentElement = React.ElementRef<typeof Primitive.div>;\ninterface PopperContentProps extends PrimitiveDivProps {\n  side?: Side;\n  sideOffset?: number;\n  align?: Align;\n  alignOffset?: number;\n  arrowPadding?: number;\n  collisionBoundary?: Boundary | Boundary[];\n  collisionPadding?: number | Partial<Record<Side, number>>;\n  sticky?: 'partial' | 'always';\n  hideWhenDetached?: boolean;\n  avoidCollisions?: boolean;\n  onPlaced?: () => void;\n}\n\nconst PopperContent = React.forwardRef<PopperContentElement, PopperContentProps>(\n  (props: ScopedProps<PopperContentProps>, forwardedRef) => {\n    const {\n      __scopePopper,\n      side = 'bottom',\n      sideOffset = 0,\n      align = 'center',\n      alignOffset = 0,\n      arrowPadding = 0,\n      collisionBoundary = [],\n      collisionPadding: collisionPaddingProp = 0,\n      sticky = 'partial',\n      hideWhenDetached = false,\n      avoidCollisions = true,\n      onPlaced,\n      ...contentProps\n    } = props;\n\n    const context = usePopperContext(CONTENT_NAME, __scopePopper);\n\n    const [content, setContent] = React.useState<HTMLDivElement | null>(null);\n    const composedRefs = useComposedRefs(forwardedRef, (node) => setContent(node));\n\n    const [arrow, setArrow] = React.useState<HTMLSpanElement | null>(null);\n    const arrowSize = useSize(arrow);\n    const arrowWidth = arrowSize?.width ?? 0;\n    const arrowHeight = arrowSize?.height ?? 0;\n\n    const desiredPlacement = (side + (align !== 'center' ? '-' + align : '')) as Placement;\n\n    const collisionPadding =\n      typeof collisionPaddingProp === 'number'\n        ? collisionPaddingProp\n        : { top: 0, right: 0, bottom: 0, left: 0, ...collisionPaddingProp };\n\n    const boundary = Array.isArray(collisionBoundary) ? collisionBoundary : [collisionBoundary];\n    const hasExplicitBoundaries = boundary.length > 0;\n\n    const detectOverflowOptions = {\n      padding: collisionPadding,\n      boundary: boundary.filter(isNotNull),\n      // with `strategy: 'fixed'`, this is the only way to get it to respect boundaries\n      altBoundary: hasExplicitBoundaries,\n    };\n\n    const { reference, floating, strategy, x, y, placement, middlewareData, update } = useFloating({\n      // default to `fixed` strategy so users don't have to pick and we also avoid focus scroll issues\n      strategy: 'fixed',\n      placement: desiredPlacement,\n      whileElementsMounted: autoUpdate,\n      middleware: [\n        anchorCssProperties(),\n        offset({ mainAxis: sideOffset + arrowHeight, alignmentAxis: alignOffset }),\n        avoidCollisions\n          ? shift({\n              mainAxis: true,\n              crossAxis: false,\n              limiter: sticky === 'partial' ? limitShift() : undefined,\n              ...detectOverflowOptions,\n            })\n          : undefined,\n        arrow ? floatingUIarrow({ element: arrow, padding: arrowPadding }) : undefined,\n        avoidCollisions ? flip({ ...detectOverflowOptions }) : undefined,\n        size({\n          ...detectOverflowOptions,\n          apply: ({ elements, availableWidth: width, availableHeight: height }) => {\n            elements.floating.style.setProperty('--radix-popper-available-width', `${width}px`);\n            elements.floating.style.setProperty('--radix-popper-available-height', `${height}px`);\n          },\n        }),\n        transformOrigin({ arrowWidth, arrowHeight }),\n        hideWhenDetached ? hide({ strategy: 'referenceHidden' }) : undefined,\n      ].filter(isDefined),\n    });\n\n    // assign the reference dynamically once `Content` has mounted so we can collocate the logic\n    useLayoutEffect(() => {\n      reference(context.anchor);\n    }, [reference, context.anchor]);\n\n    const isPlaced = x !== null && y !== null;\n    const [placedSide, placedAlign] = getSideAndAlignFromPlacement(placement);\n\n    const handlePlaced = useCallbackRef(onPlaced);\n    useLayoutEffect(() => {\n      if (isPlaced) {\n        handlePlaced?.();\n      }\n    }, [isPlaced, handlePlaced]);\n\n    const arrowX = middlewareData.arrow?.x;\n    const arrowY = middlewareData.arrow?.y;\n    const cannotCenterArrow = middlewareData.arrow?.centerOffset !== 0;\n\n    const [contentZIndex, setContentZIndex] = React.useState<string>();\n    useLayoutEffect(() => {\n      if (content) setContentZIndex(window.getComputedStyle(content).zIndex);\n    }, [content]);\n\n    const { hasParent, positionUpdateFns } = usePositionContext(CONTENT_NAME, __scopePopper);\n    const isRoot = !hasParent;\n\n    React.useLayoutEffect(() => {\n      if (!isRoot) {\n        positionUpdateFns.add(update);\n        return () => {\n          positionUpdateFns.delete(update);\n        };\n      }\n    }, [isRoot, positionUpdateFns, update]);\n\n    // when nested contents are rendered in portals, they are appended out of order causing\n    // children to be positioned incorrectly if initially open.\n    // we need to re-compute the positioning once the parent has finally been placed.\n    // https://github.com/floating-ui/floating-ui/issues/1531\n    useLayoutEffect(() => {\n      if (isRoot && isPlaced) {\n        Array.from(positionUpdateFns)\n          .reverse()\n          .forEach((fn) => requestAnimationFrame(fn));\n      }\n    }, [isRoot, isPlaced, positionUpdateFns]);\n\n    const commonProps = {\n      'data-side': placedSide,\n      'data-align': placedAlign,\n      ...contentProps,\n      ref: composedRefs,\n      style: {\n        ...contentProps.style,\n        // if the PopperContent hasn't been placed yet (not all measurements done)\n        // we prevent animations so that users's animation don't kick in too early referring wrong sides\n        animation: !isPlaced ? 'none' : undefined,\n        // hide the content if using the hide middleware and should be hidden\n        opacity: middlewareData.hide?.referenceHidden ? 0 : undefined,\n      },\n    };\n\n    return (\n      <div\n        ref={floating}\n        data-radix-popper-content-wrapper=\"\"\n        style={{\n          position: strategy,\n          left: 0,\n          top: 0,\n          transform: isPlaced\n            ? `translate3d(${Math.round(x)}px, ${Math.round(y)}px, 0)`\n            : 'translate3d(0, -200%, 0)', // keep off the page when measuring\n          minWidth: 'max-content',\n          zIndex: contentZIndex,\n          ['--radix-popper-transform-origin' as any]: [\n            middlewareData.transformOrigin?.x,\n            middlewareData.transformOrigin?.y,\n          ].join(' '),\n        }}\n        // Floating UI interally calculates logical alignment based the `dir` attribute on\n        // the reference/floating node, we must add this attribute here to ensure\n        // this is calculated when portalled as well as inline.\n        dir={props.dir}\n      >\n        <PopperContentProvider\n          scope={__scopePopper}\n          placedSide={placedSide}\n          onArrowChange={setArrow}\n          arrowX={arrowX}\n          arrowY={arrowY}\n          shouldHideArrow={cannotCenterArrow}\n        >\n          {isRoot ? (\n            <PositionContextProvider\n              scope={__scopePopper}\n              hasParent\n              positionUpdateFns={positionUpdateFns}\n            >\n              <Primitive.div {...commonProps} />\n            </PositionContextProvider>\n          ) : (\n            <Primitive.div {...commonProps} />\n          )}\n        </PopperContentProvider>\n      </div>\n    );\n  }\n);\n\nPopperContent.displayName = CONTENT_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * PopperArrow\n * -----------------------------------------------------------------------------------------------*/\n\nconst ARROW_NAME = 'PopperArrow';\n\nconst OPPOSITE_SIDE: Record<Side, Side> = {\n  top: 'bottom',\n  right: 'left',\n  bottom: 'top',\n  left: 'right',\n};\n\ntype PopperArrowElement = React.ElementRef<typeof ArrowPrimitive.Root>;\ntype ArrowProps = Radix.ComponentPropsWithoutRef<typeof ArrowPrimitive.Root>;\ninterface PopperArrowProps extends ArrowProps {}\n\nconst PopperArrow = React.forwardRef<PopperArrowElement, PopperArrowProps>(function PopperArrow(\n  props: ScopedProps<PopperArrowProps>,\n  forwardedRef\n) {\n  const { __scopePopper, ...arrowProps } = props;\n  const contentContext = useContentContext(ARROW_NAME, __scopePopper);\n  const baseSide = OPPOSITE_SIDE[contentContext.placedSide];\n\n  return (\n    // we have to use an extra wrapper because `ResizeObserver` (used by `useSize`)\n    // doesn't report size as we'd expect on SVG elements.\n    // it reports their bounding box which is effectively the largest path inside the SVG.\n    <span\n      ref={contentContext.onArrowChange}\n      style={{\n        position: 'absolute',\n        left: contentContext.arrowX,\n        top: contentContext.arrowY,\n        [baseSide]: 0,\n        transformOrigin: {\n          top: '',\n          right: '0 0',\n          bottom: 'center 0',\n          left: '100% 0',\n        }[contentContext.placedSide],\n        transform: {\n          top: 'translateY(100%)',\n          right: 'translateY(50%) rotate(90deg) translateX(-50%)',\n          bottom: `rotate(180deg)`,\n          left: 'translateY(50%) rotate(-90deg) translateX(50%)',\n        }[contentContext.placedSide],\n        visibility: contentContext.shouldHideArrow ? 'hidden' : undefined,\n      }}\n    >\n      <ArrowPrimitive.Root\n        {...arrowProps}\n        ref={forwardedRef}\n        style={{\n          ...arrowProps.style,\n          // ensures the element can be measured correctly (mostly for if SVG)\n          display: 'block',\n        }}\n      />\n    </span>\n  );\n});\n\nPopperArrow.displayName = ARROW_NAME;\n\n/* -----------------------------------------------------------------------------------------------*/\n\nfunction isDefined<T>(value: T | undefined): value is T {\n  return value !== undefined;\n}\n\nfunction isNotNull<T>(value: T | null): value is T {\n  return value !== null;\n}\n\nconst anchorCssProperties = (): Middleware => ({\n  name: 'anchorCssProperties',\n  fn(data) {\n    const { rects, elements } = data;\n    const { width, height } = rects.reference;\n    elements.floating.style.setProperty('--radix-popper-anchor-width', `${width}px`);\n    elements.floating.style.setProperty('--radix-popper-anchor-height', `${height}px`);\n    return {};\n  },\n});\n\nconst transformOrigin = (options: { arrowWidth: number; arrowHeight: number }): Middleware => ({\n  name: 'transformOrigin',\n  options,\n  fn(data) {\n    const { placement, rects, middlewareData } = data;\n\n    const cannotCenterArrow = middlewareData.arrow?.centerOffset !== 0;\n    const isArrowHidden = cannotCenterArrow;\n    const arrowWidth = isArrowHidden ? 0 : options.arrowWidth;\n    const arrowHeight = isArrowHidden ? 0 : options.arrowHeight;\n\n    const [placedSide, placedAlign] = getSideAndAlignFromPlacement(placement);\n    const noArrowAlign = { start: '0%', center: '50%', end: '100%' }[placedAlign];\n\n    const arrowXCenter = (middlewareData.arrow?.x ?? 0) + arrowWidth / 2;\n    const arrowYCenter = (middlewareData.arrow?.y ?? 0) + arrowHeight / 2;\n\n    let x = '';\n    let y = '';\n\n    if (placedSide === 'bottom') {\n      x = isArrowHidden ? noArrowAlign : `${arrowXCenter}px`;\n      y = `${-arrowHeight}px`;\n    } else if (placedSide === 'top') {\n      x = isArrowHidden ? noArrowAlign : `${arrowXCenter}px`;\n      y = `${rects.floating.height + arrowHeight}px`;\n    } else if (placedSide === 'right') {\n      x = `${-arrowHeight}px`;\n      y = isArrowHidden ? noArrowAlign : `${arrowYCenter}px`;\n    } else if (placedSide === 'left') {\n      x = `${rects.floating.width + arrowHeight}px`;\n      y = isArrowHidden ? noArrowAlign : `${arrowYCenter}px`;\n    }\n    return { data: { x, y } };\n  },\n});\n\nfunction getSideAndAlignFromPlacement(placement: Placement) {\n  const [side, align = 'center'] = placement.split('-');\n  return [side as Side, align as Align] as const;\n}\n\nconst Root = Popper;\nconst Anchor = PopperAnchor;\nconst Content = PopperContent;\nconst Arrow = PopperArrow;\n\nexport {\n  createPopperScope,\n  //\n  Popper,\n  PopperAnchor,\n  PopperContent,\n  PopperArrow,\n  //\n  Root,\n  Anchor,\n  Content,\n  Arrow,\n  //\n  SIDE_OPTIONS,\n  ALIGN_OPTIONS,\n};\nexport type { PopperProps, PopperAnchorProps, PopperContentProps, PopperArrowProps };\n","import * as React from 'react';\nimport { composeEventHandlers } from '@radix-ui/primitive';\nimport { createCollection } from '@radix-ui/react-collection';\nimport { useComposedRefs } from '@radix-ui/react-compose-refs';\nimport { createContextScope } from '@radix-ui/react-context';\nimport { useId } from '@radix-ui/react-id';\nimport { Primitive } from '@radix-ui/react-primitive';\nimport { useCallbackRef } from '@radix-ui/react-use-callback-ref';\nimport { useControllableState } from '@radix-ui/react-use-controllable-state';\nimport { useDirection } from '@radix-ui/react-direction';\n\nimport type * as Radix from '@radix-ui/react-primitive';\nimport type { Scope } from '@radix-ui/react-context';\n\nconst ENTRY_FOCUS = 'rovingFocusGroup.onEntryFocus';\nconst EVENT_OPTIONS = { bubbles: false, cancelable: true };\n\n/* -------------------------------------------------------------------------------------------------\n * RovingFocusGroup\n * -----------------------------------------------------------------------------------------------*/\n\nconst GROUP_NAME = 'RovingFocusGroup';\n\ntype ItemData = { id: string; focusable: boolean; active: boolean };\nconst [Collection, useCollection, createCollectionScope] = createCollection<\n  HTMLSpanElement,\n  ItemData\n>(GROUP_NAME);\n\ntype ScopedProps<P> = P & { __scopeRovingFocusGroup?: Scope };\nconst [createRovingFocusGroupContext, createRovingFocusGroupScope] = createContextScope(\n  GROUP_NAME,\n  [createCollectionScope]\n);\n\ntype Orientation = React.AriaAttributes['aria-orientation'];\ntype Direction = 'ltr' | 'rtl';\n\ninterface RovingFocusGroupOptions {\n  /**\n   * The orientation of the group.\n   * Mainly so arrow navigation is done accordingly (left & right vs. up & down)\n   */\n  orientation?: Orientation;\n  /**\n   * The direction of navigation between items.\n   */\n  dir?: Direction;\n  /**\n   * Whether keyboard navigation should loop around\n   * @defaultValue false\n   */\n  loop?: boolean;\n}\n\ntype RovingContextValue = RovingFocusGroupOptions & {\n  currentTabStopId: string | null;\n  onItemFocus(tabStopId: string): void;\n  onItemShiftTab(): void;\n  onFocusableItemAdd(): void;\n  onFocusableItemRemove(): void;\n};\n\nconst [RovingFocusProvider, useRovingFocusContext] =\n  createRovingFocusGroupContext<RovingContextValue>(GROUP_NAME);\n\ntype RovingFocusGroupElement = RovingFocusGroupImplElement;\ninterface RovingFocusGroupProps extends RovingFocusGroupImplProps {}\n\nconst RovingFocusGroup = React.forwardRef<RovingFocusGroupElement, RovingFocusGroupProps>(\n  (props: ScopedProps<RovingFocusGroupProps>, forwardedRef) => {\n    return (\n      <Collection.Provider scope={props.__scopeRovingFocusGroup}>\n        <Collection.Slot scope={props.__scopeRovingFocusGroup}>\n          <RovingFocusGroupImpl {...props} ref={forwardedRef} />\n        </Collection.Slot>\n      </Collection.Provider>\n    );\n  }\n);\n\nRovingFocusGroup.displayName = GROUP_NAME;\n\n/* -----------------------------------------------------------------------------------------------*/\n\ntype RovingFocusGroupImplElement = React.ElementRef<typeof Primitive.div>;\ntype PrimitiveDivProps = Radix.ComponentPropsWithoutRef<typeof Primitive.div>;\ninterface RovingFocusGroupImplProps\n  extends Omit<PrimitiveDivProps, 'dir'>,\n    RovingFocusGroupOptions {\n  currentTabStopId?: string | null;\n  defaultCurrentTabStopId?: string;\n  onCurrentTabStopIdChange?: (tabStopId: string | null) => void;\n  onEntryFocus?: (event: Event) => void;\n}\n\nconst RovingFocusGroupImpl = React.forwardRef<\n  RovingFocusGroupImplElement,\n  RovingFocusGroupImplProps\n>((props: ScopedProps<RovingFocusGroupImplProps>, forwardedRef) => {\n  const {\n    __scopeRovingFocusGroup,\n    orientation,\n    loop = false,\n    dir,\n    currentTabStopId: currentTabStopIdProp,\n    defaultCurrentTabStopId,\n    onCurrentTabStopIdChange,\n    onEntryFocus,\n    ...groupProps\n  } = props;\n  const ref = React.useRef<RovingFocusGroupImplElement>(null);\n  const composedRefs = useComposedRefs(forwardedRef, ref);\n  const direction = useDirection(dir);\n  const [currentTabStopId = null, setCurrentTabStopId] = useControllableState({\n    prop: currentTabStopIdProp,\n    defaultProp: defaultCurrentTabStopId,\n    onChange: onCurrentTabStopIdChange,\n  });\n  const [isTabbingBackOut, setIsTabbingBackOut] = React.useState(false);\n  const handleEntryFocus = useCallbackRef(onEntryFocus);\n  const getItems = useCollection(__scopeRovingFocusGroup);\n  const isClickFocusRef = React.useRef(false);\n  const [focusableItemsCount, setFocusableItemsCount] = React.useState(0);\n\n  React.useEffect(() => {\n    const node = ref.current;\n    if (node) {\n      node.addEventListener(ENTRY_FOCUS, handleEntryFocus);\n      return () => node.removeEventListener(ENTRY_FOCUS, handleEntryFocus);\n    }\n  }, [handleEntryFocus]);\n\n  return (\n    <RovingFocusProvider\n      scope={__scopeRovingFocusGroup}\n      orientation={orientation}\n      dir={direction}\n      loop={loop}\n      currentTabStopId={currentTabStopId}\n      onItemFocus={React.useCallback(\n        (tabStopId) => setCurrentTabStopId(tabStopId),\n        [setCurrentTabStopId]\n      )}\n      onItemShiftTab={React.useCallback(() => setIsTabbingBackOut(true), [])}\n      onFocusableItemAdd={React.useCallback(\n        () => setFocusableItemsCount((prevCount) => prevCount + 1),\n        []\n      )}\n      onFocusableItemRemove={React.useCallback(\n        () => setFocusableItemsCount((prevCount) => prevCount - 1),\n        []\n      )}\n    >\n      <Primitive.div\n        tabIndex={isTabbingBackOut || focusableItemsCount === 0 ? -1 : 0}\n        data-orientation={orientation}\n        {...groupProps}\n        ref={composedRefs}\n        style={{ outline: 'none', ...props.style }}\n        onMouseDown={composeEventHandlers(props.onMouseDown, () => {\n          isClickFocusRef.current = true;\n        })}\n        onFocus={composeEventHandlers(props.onFocus, (event) => {\n          // We normally wouldn't need this check, because we already check\n          // that the focus is on the current target and not bubbling to it.\n          // We do this because Safari doesn't focus buttons when clicked, and\n          // instead, the wrapper will get focused and not through a bubbling event.\n          const isKeyboardFocus = !isClickFocusRef.current;\n\n          if (event.target === event.currentTarget && isKeyboardFocus && !isTabbingBackOut) {\n            const entryFocusEvent = new CustomEvent(ENTRY_FOCUS, EVENT_OPTIONS);\n            event.currentTarget.dispatchEvent(entryFocusEvent);\n\n            if (!entryFocusEvent.defaultPrevented) {\n              const items = getItems().filter((item) => item.focusable);\n              const activeItem = items.find((item) => item.active);\n              const currentItem = items.find((item) => item.id === currentTabStopId);\n              const candidateItems = [activeItem, currentItem, ...items].filter(\n                Boolean\n              ) as typeof items;\n              const candidateNodes = candidateItems.map((item) => item.ref.current!);\n              focusFirst(candidateNodes);\n            }\n          }\n\n          isClickFocusRef.current = false;\n        })}\n        onBlur={composeEventHandlers(props.onBlur, () => setIsTabbingBackOut(false))}\n      />\n    </RovingFocusProvider>\n  );\n});\n\n/* -------------------------------------------------------------------------------------------------\n * RovingFocusGroupItem\n * -----------------------------------------------------------------------------------------------*/\n\nconst ITEM_NAME = 'RovingFocusGroupItem';\n\ntype RovingFocusItemElement = React.ElementRef<typeof Primitive.span>;\ntype PrimitiveSpanProps = Radix.ComponentPropsWithoutRef<typeof Primitive.span>;\ninterface RovingFocusItemProps extends PrimitiveSpanProps {\n  tabStopId?: string;\n  focusable?: boolean;\n  active?: boolean;\n}\n\nconst RovingFocusGroupItem = React.forwardRef<RovingFocusItemElement, RovingFocusItemProps>(\n  (props: ScopedProps<RovingFocusItemProps>, forwardedRef) => {\n    const {\n      __scopeRovingFocusGroup,\n      focusable = true,\n      active = false,\n      tabStopId,\n      ...itemProps\n    } = props;\n    const autoId = useId();\n    const id = tabStopId || autoId;\n    const context = useRovingFocusContext(ITEM_NAME, __scopeRovingFocusGroup);\n    const isCurrentTabStop = context.currentTabStopId === id;\n    const getItems = useCollection(__scopeRovingFocusGroup);\n\n    const { onFocusableItemAdd, onFocusableItemRemove } = context;\n\n    React.useEffect(() => {\n      if (focusable) {\n        onFocusableItemAdd();\n        return () => onFocusableItemRemove();\n      }\n    }, [focusable, onFocusableItemAdd, onFocusableItemRemove]);\n\n    return (\n      <Collection.ItemSlot\n        scope={__scopeRovingFocusGroup}\n        id={id}\n        focusable={focusable}\n        active={active}\n      >\n        <Primitive.span\n          tabIndex={isCurrentTabStop ? 0 : -1}\n          data-orientation={context.orientation}\n          {...itemProps}\n          ref={forwardedRef}\n          onMouseDown={composeEventHandlers(props.onMouseDown, (event) => {\n            // We prevent focusing non-focusable items on `mousedown`.\n            // Even though the item has tabIndex={-1}, that only means take it out of the tab order.\n            if (!focusable) event.preventDefault();\n            // Safari doesn't focus a button when clicked so we run our logic on mousedown also\n            else context.onItemFocus(id);\n          })}\n          onFocus={composeEventHandlers(props.onFocus, () => context.onItemFocus(id))}\n          onKeyDown={composeEventHandlers(props.onKeyDown, (event) => {\n            if (event.key === 'Tab' && event.shiftKey) {\n              context.onItemShiftTab();\n              return;\n            }\n\n            if (event.target !== event.currentTarget) return;\n\n            const focusIntent = getFocusIntent(event, context.orientation, context.dir);\n\n            if (focusIntent !== undefined) {\n              event.preventDefault();\n              const items = getItems().filter((item) => item.focusable);\n              let candidateNodes = items.map((item) => item.ref.current!);\n\n              if (focusIntent === 'last') candidateNodes.reverse();\n              else if (focusIntent === 'prev' || focusIntent === 'next') {\n                if (focusIntent === 'prev') candidateNodes.reverse();\n                const currentIndex = candidateNodes.indexOf(event.currentTarget);\n                candidateNodes = context.loop\n                  ? wrapArray(candidateNodes, currentIndex + 1)\n                  : candidateNodes.slice(currentIndex + 1);\n              }\n\n              /**\n               * Imperative focus during keydown is risky so we prevent React's batching updates\n               * to avoid potential bugs. See: https://github.com/facebook/react/issues/20332\n               */\n              setTimeout(() => focusFirst(candidateNodes));\n            }\n          })}\n        />\n      </Collection.ItemSlot>\n    );\n  }\n);\n\nRovingFocusGroupItem.displayName = ITEM_NAME;\n\n/* -----------------------------------------------------------------------------------------------*/\n\n// prettier-ignore\nconst MAP_KEY_TO_FOCUS_INTENT: Record<string, FocusIntent> = {\n  ArrowLeft: 'prev', ArrowUp: 'prev',\n  ArrowRight: 'next', ArrowDown: 'next',\n  PageUp: 'first', Home: 'first',\n  PageDown: 'last', End: 'last',\n};\n\nfunction getDirectionAwareKey(key: string, dir?: Direction) {\n  if (dir !== 'rtl') return key;\n  return key === 'ArrowLeft' ? 'ArrowRight' : key === 'ArrowRight' ? 'ArrowLeft' : key;\n}\n\ntype FocusIntent = 'first' | 'last' | 'prev' | 'next';\n\nfunction getFocusIntent(event: React.KeyboardEvent, orientation?: Orientation, dir?: Direction) {\n  const key = getDirectionAwareKey(event.key, dir);\n  if (orientation === 'vertical' && ['ArrowLeft', 'ArrowRight'].includes(key)) return undefined;\n  if (orientation === 'horizontal' && ['ArrowUp', 'ArrowDown'].includes(key)) return undefined;\n  return MAP_KEY_TO_FOCUS_INTENT[key];\n}\n\nfunction focusFirst(candidates: HTMLElement[]) {\n  const PREVIOUSLY_FOCUSED_ELEMENT = document.activeElement;\n  for (const candidate of candidates) {\n    // if focus is already where we want to go, we don't want to keep going through the candidates\n    if (candidate === PREVIOUSLY_FOCUSED_ELEMENT) return;\n    candidate.focus();\n    if (document.activeElement !== PREVIOUSLY_FOCUSED_ELEMENT) return;\n  }\n}\n\n/**\n * Wraps an array around itself at a given start index\n * Example: `wrapArray(['a', 'b', 'c', 'd'], 2) === ['c', 'd', 'a', 'b']`\n */\nfunction wrapArray<T>(array: T[], startIndex: number) {\n  return array.map((_, index) => array[(startIndex + index) % array.length]);\n}\n\nconst Root = RovingFocusGroup;\nconst Item = RovingFocusGroupItem;\n\nexport {\n  createRovingFocusGroupScope,\n  //\n  RovingFocusGroup,\n  RovingFocusGroupItem,\n  //\n  Root,\n  Item,\n};\nexport type { RovingFocusGroupProps, RovingFocusItemProps };\n","var getDefaultParent = function (originalTarget) {\n    if (typeof document === 'undefined') {\n        return null;\n    }\n    var sampleTarget = Array.isArray(originalTarget) ? originalTarget[0] : originalTarget;\n    return sampleTarget.ownerDocument.body;\n};\nvar counterMap = new WeakMap();\nvar uncontrolledNodes = new WeakMap();\nvar markerMap = {};\nvar lockCount = 0;\nvar unwrapHost = function (node) {\n    return node && (node.host || unwrapHost(node.parentNode));\n};\nvar correctTargets = function (parent, targets) {\n    return targets\n        .map(function (target) {\n        if (parent.contains(target)) {\n            return target;\n        }\n        var correctedTarget = unwrapHost(target);\n        if (correctedTarget && parent.contains(correctedTarget)) {\n            return correctedTarget;\n        }\n        console.error('aria-hidden', target, 'in not contained inside', parent, '. Doing nothing');\n        return null;\n    })\n        .filter(function (x) { return Boolean(x); });\n};\n/**\n * Marks everything except given node(or nodes) as aria-hidden\n * @param {Element | Element[]} originalTarget - elements to keep on the page\n * @param [parentNode] - top element, defaults to document.body\n * @param {String} [markerName] - a special attribute to mark every node\n * @param {String} [controlAttribute] - html Attribute to control\n * @return {Undo} undo command\n */\nvar applyAttributeToOthers = function (originalTarget, parentNode, markerName, controlAttribute) {\n    var targets = correctTargets(parentNode, Array.isArray(originalTarget) ? originalTarget : [originalTarget]);\n    if (!markerMap[markerName]) {\n        markerMap[markerName] = new WeakMap();\n    }\n    var markerCounter = markerMap[markerName];\n    var hiddenNodes = [];\n    var elementsToKeep = new Set();\n    var elementsToStop = new Set(targets);\n    var keep = function (el) {\n        if (!el || elementsToKeep.has(el)) {\n            return;\n        }\n        elementsToKeep.add(el);\n        keep(el.parentNode);\n    };\n    targets.forEach(keep);\n    var deep = function (parent) {\n        if (!parent || elementsToStop.has(parent)) {\n            return;\n        }\n        Array.prototype.forEach.call(parent.children, function (node) {\n            if (elementsToKeep.has(node)) {\n                deep(node);\n            }\n            else {\n                var attr = node.getAttribute(controlAttribute);\n                var alreadyHidden = attr !== null && attr !== 'false';\n                var counterValue = (counterMap.get(node) || 0) + 1;\n                var markerValue = (markerCounter.get(node) || 0) + 1;\n                counterMap.set(node, counterValue);\n                markerCounter.set(node, markerValue);\n                hiddenNodes.push(node);\n                if (counterValue === 1 && alreadyHidden) {\n                    uncontrolledNodes.set(node, true);\n                }\n                if (markerValue === 1) {\n                    node.setAttribute(markerName, 'true');\n                }\n                if (!alreadyHidden) {\n                    node.setAttribute(controlAttribute, 'true');\n                }\n            }\n        });\n    };\n    deep(parentNode);\n    elementsToKeep.clear();\n    lockCount++;\n    return function () {\n        hiddenNodes.forEach(function (node) {\n            var counterValue = counterMap.get(node) - 1;\n            var markerValue = markerCounter.get(node) - 1;\n            counterMap.set(node, counterValue);\n            markerCounter.set(node, markerValue);\n            if (!counterValue) {\n                if (!uncontrolledNodes.has(node)) {\n                    node.removeAttribute(controlAttribute);\n                }\n                uncontrolledNodes.delete(node);\n            }\n            if (!markerValue) {\n                node.removeAttribute(markerName);\n            }\n        });\n        lockCount--;\n        if (!lockCount) {\n            // clear\n            counterMap = new WeakMap();\n            counterMap = new WeakMap();\n            uncontrolledNodes = new WeakMap();\n            markerMap = {};\n        }\n    };\n};\n/**\n * Marks everything except given node(or nodes) as aria-hidden\n * @param {Element | Element[]} originalTarget - elements to keep on the page\n * @param [parentNode] - top element, defaults to document.body\n * @param {String} [markerName] - a special attribute to mark every node\n * @return {Undo} undo command\n */\nexport var hideOthers = function (originalTarget, parentNode, markerName) {\n    if (markerName === void 0) { markerName = 'data-aria-hidden'; }\n    var targets = Array.from(Array.isArray(originalTarget) ? originalTarget : [originalTarget]);\n    var activeParentNode = parentNode || getDefaultParent(originalTarget);\n    if (!activeParentNode) {\n        return function () { return null; };\n    }\n    // we should not hide ariaLive elements - https://github.com/theKashey/aria-hidden/issues/10\n    targets.push.apply(targets, Array.from(activeParentNode.querySelectorAll('[aria-live]')));\n    return applyAttributeToOthers(targets, activeParentNode, markerName, 'aria-hidden');\n};\n/**\n * Marks everything except given node(or nodes) as inert\n * @param {Element | Element[]} originalTarget - elements to keep on the page\n * @param [parentNode] - top element, defaults to document.body\n * @param {String} [markerName] - a special attribute to mark every node\n * @return {Undo} undo command\n */\nexport var inertOthers = function (originalTarget, parentNode, markerName) {\n    if (markerName === void 0) { markerName = 'data-inert-ed'; }\n    var activeParentNode = parentNode || getDefaultParent(originalTarget);\n    if (!activeParentNode) {\n        return function () { return null; };\n    }\n    return applyAttributeToOthers(originalTarget, activeParentNode, markerName, 'inert');\n};\n/**\n * @returns if current browser supports inert\n */\nexport var supportsInert = function () {\n    return typeof HTMLElement !== 'undefined' && HTMLElement.prototype.hasOwnProperty('inert');\n};\n/**\n * Automatic function to \"suppress\" DOM elements - _hide_ or _inert_ in the best possible way\n * @param {Element | Element[]} originalTarget - elements to keep on the page\n * @param [parentNode] - top element, defaults to document.body\n * @param {String} [markerName] - a special attribute to mark every node\n * @return {Undo} undo command\n */\nexport var suppressOthers = function (originalTarget, parentNode, markerName) {\n    if (markerName === void 0) { markerName = 'data-suppressed'; }\n    return (supportsInert() ? inertOthers : hideOthers)(originalTarget, parentNode, markerName);\n};\n","/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __esDecorate(ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\r\n    function accept(f) { if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\"); return f; }\r\n    var kind = contextIn.kind, key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\r\n    var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\r\n    var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\r\n    var _, done = false;\r\n    for (var i = decorators.length - 1; i >= 0; i--) {\r\n        var context = {};\r\n        for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\r\n        for (var p in contextIn.access) context.access[p] = contextIn.access[p];\r\n        context.addInitializer = function (f) { if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\"); extraInitializers.push(accept(f || null)); };\r\n        var result = (0, decorators[i])(kind === \"accessor\" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);\r\n        if (kind === \"accessor\") {\r\n            if (result === void 0) continue;\r\n            if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\r\n            if (_ = accept(result.get)) descriptor.get = _;\r\n            if (_ = accept(result.set)) descriptor.set = _;\r\n            if (_ = accept(result.init)) initializers.push(_);\r\n        }\r\n        else if (_ = accept(result)) {\r\n            if (kind === \"field\") initializers.push(_);\r\n            else descriptor[key] = _;\r\n        }\r\n    }\r\n    if (target) Object.defineProperty(target, contextIn.name, descriptor);\r\n    done = true;\r\n};\r\n\r\nexport function __runInitializers(thisArg, initializers, value) {\r\n    var useValue = arguments.length > 2;\r\n    for (var i = 0; i < initializers.length; i++) {\r\n        value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\r\n    }\r\n    return useValue ? value : void 0;\r\n};\r\n\r\nexport function __propKey(x) {\r\n    return typeof x === \"symbol\" ? x : \"\".concat(x);\r\n};\r\n\r\nexport function __setFunctionName(f, name, prefix) {\r\n    if (typeof name === \"symbol\") name = name.description ? \"[\".concat(name.description, \"]\") : \"\";\r\n    return Object.defineProperty(f, \"name\", { configurable: true, value: prefix ? \"\".concat(prefix, \" \", name) : name });\r\n};\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    var desc = Object.getOwnPropertyDescriptor(m, k);\r\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\r\n        desc = { enumerable: true, get: function() { return m[k]; } };\r\n    }\r\n    Object.defineProperty(o, k2, desc);\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: false } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n\r\nexport function __classPrivateFieldIn(state, receiver) {\r\n    if (receiver === null || (typeof receiver !== \"object\" && typeof receiver !== \"function\")) throw new TypeError(\"Cannot use 'in' operator on non-object\");\r\n    return typeof state === \"function\" ? receiver === state : state.has(receiver);\r\n}\r\n","export var zeroRightClassName = 'right-scroll-bar-position';\nexport var fullWidthClassName = 'width-before-scroll-bar';\nexport var noScrollbarsClassName = 'with-scroll-bars-hidden';\n/**\n * Name of a CSS variable containing the amount of \"hidden\" scrollbar\n * ! might be undefined ! use will fallback!\n */\nexport var removedBarSizeVariable = '--removed-body-scroll-bar-size';\n","import { assignRef } from './assignRef';\nimport { useCallbackRef } from './useRef';\n/**\n * Merges two or more refs together providing a single interface to set their value\n * @param {RefObject|Ref} refs\n * @returns {MutableRefObject} - a new ref, which translates all changes to {refs}\n *\n * @see {@link mergeRefs} a version without buit-in memoization\n * @see https://github.com/theKashey/use-callback-ref#usemergerefs\n * @example\n * const Component = React.forwardRef((props, ref) => {\n *   const ownRef = useRef();\n *   const domRef = useMergeRefs([ref, ownRef]); //  merge together\n *   return <div ref={domRef}>...</div>\n * }\n */\nexport function useMergeRefs(refs, defaultValue) {\n    return useCallbackRef(defaultValue || null, function (newValue) { return refs.forEach(function (ref) { return assignRef(ref, newValue); }); });\n}\n","import { useState } from 'react';\n/**\n * creates a MutableRef with ref change callback\n * @param initialValue - initial ref value\n * @param {Function} callback - a callback to run when value changes\n *\n * @example\n * const ref = useCallbackRef(0, (newValue, oldValue) => console.log(oldValue, '->', newValue);\n * ref.current = 1;\n * // prints 0 -> 1\n *\n * @see https://reactjs.org/docs/hooks-reference.html#useref\n * @see https://github.com/theKashey/use-callback-ref#usecallbackref---to-replace-reactuseref\n * @returns {MutableRefObject}\n */\nexport function useCallbackRef(initialValue, callback) {\n    var ref = useState(function () { return ({\n        // value\n        value: initialValue,\n        // last callback\n        callback: callback,\n        // \"memoized\" public interface\n        facade: {\n            get current() {\n                return ref.value;\n            },\n            set current(value) {\n                var last = ref.value;\n                if (last !== value) {\n                    ref.value = value;\n                    ref.callback(value, last);\n                }\n            },\n        },\n    }); })[0];\n    // update callback\n    ref.callback = callback;\n    return ref.facade;\n}\n","/**\n * Assigns a value for a given ref, no matter of the ref format\n * @param {RefObject} ref - a callback function or ref object\n * @param value - a new value\n *\n * @see https://github.com/theKashey/use-callback-ref#assignref\n * @example\n * const refObject = useRef();\n * const refFn = (ref) => {....}\n *\n * assignRef(refObject, \"refValue\");\n * assignRef(refFn, \"refValue\");\n */\nexport function assignRef(ref, value) {\n    if (typeof ref === 'function') {\n        ref(value);\n    }\n    else if (ref) {\n        ref.current = value;\n    }\n    return ref;\n}\n","import { __assign } from \"tslib\";\nfunction ItoI(a) {\n    return a;\n}\nfunction innerCreateMedium(defaults, middleware) {\n    if (middleware === void 0) { middleware = ItoI; }\n    var buffer = [];\n    var assigned = false;\n    var medium = {\n        read: function () {\n            if (assigned) {\n                throw new Error('Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.');\n            }\n            if (buffer.length) {\n                return buffer[buffer.length - 1];\n            }\n            return defaults;\n        },\n        useMedium: function (data) {\n            var item = middleware(data, assigned);\n            buffer.push(item);\n            return function () {\n                buffer = buffer.filter(function (x) { return x !== item; });\n            };\n        },\n        assignSyncMedium: function (cb) {\n            assigned = true;\n            while (buffer.length) {\n                var cbs = buffer;\n                buffer = [];\n                cbs.forEach(cb);\n            }\n            buffer = {\n                push: function (x) { return cb(x); },\n                filter: function () { return buffer; },\n            };\n        },\n        assignMedium: function (cb) {\n            assigned = true;\n            var pendingQueue = [];\n            if (buffer.length) {\n                var cbs = buffer;\n                buffer = [];\n                cbs.forEach(cb);\n                pendingQueue = buffer;\n            }\n            var executeQueue = function () {\n                var cbs = pendingQueue;\n                pendingQueue = [];\n                cbs.forEach(cb);\n            };\n            var cycle = function () { return Promise.resolve().then(executeQueue); };\n            cycle();\n            buffer = {\n                push: function (x) {\n                    pendingQueue.push(x);\n                    cycle();\n                },\n                filter: function (filter) {\n                    pendingQueue = pendingQueue.filter(filter);\n                    return buffer;\n                },\n            };\n        },\n    };\n    return medium;\n}\nexport function createMedium(defaults, middleware) {\n    if (middleware === void 0) { middleware = ItoI; }\n    return innerCreateMedium(defaults, middleware);\n}\n// eslint-disable-next-line @typescript-eslint/ban-types\nexport function createSidecarMedium(options) {\n    if (options === void 0) { options = {}; }\n    var medium = innerCreateMedium(null);\n    medium.options = __assign({ async: true, ssr: false }, options);\n    return medium;\n}\n","import { createSidecarMedium } from 'use-sidecar';\nexport var effectCar = createSidecarMedium();\n","import { __assign, __rest } from \"tslib\";\nimport * as React from 'react';\nimport { fullWidthClassName, zeroRightClassName } from 'react-remove-scroll-bar/constants';\nimport { useMergeRefs } from 'use-callback-ref';\nimport { effectCar } from './medium';\nvar nothing = function () {\n    return;\n};\n/**\n * Removes scrollbar from the page and contain the scroll within the Lock\n */\nvar RemoveScroll = React.forwardRef(function (props, parentRef) {\n    var ref = React.useRef(null);\n    var _a = React.useState({\n        onScrollCapture: nothing,\n        onWheelCapture: nothing,\n        onTouchMoveCapture: nothing,\n    }), callbacks = _a[0], setCallbacks = _a[1];\n    var forwardProps = props.forwardProps, children = props.children, className = props.className, removeScrollBar = props.removeScrollBar, enabled = props.enabled, shards = props.shards, sideCar = props.sideCar, noIsolation = props.noIsolation, inert = props.inert, allowPinchZoom = props.allowPinchZoom, _b = props.as, Container = _b === void 0 ? 'div' : _b, rest = __rest(props, [\"forwardProps\", \"children\", \"className\", \"removeScrollBar\", \"enabled\", \"shards\", \"sideCar\", \"noIsolation\", \"inert\", \"allowPinchZoom\", \"as\"]);\n    var SideCar = sideCar;\n    var containerRef = useMergeRefs([ref, parentRef]);\n    var containerProps = __assign(__assign({}, rest), callbacks);\n    return (React.createElement(React.Fragment, null,\n        enabled && (React.createElement(SideCar, { sideCar: effectCar, removeScrollBar: removeScrollBar, shards: shards, noIsolation: noIsolation, inert: inert, setCallbacks: setCallbacks, allowPinchZoom: !!allowPinchZoom, lockRef: ref })),\n        forwardProps ? (React.cloneElement(React.Children.only(children), __assign(__assign({}, containerProps), { ref: containerRef }))) : (React.createElement(Container, __assign({}, containerProps, { className: className, ref: containerRef }), children))));\n});\nRemoveScroll.defaultProps = {\n    enabled: true,\n    removeScrollBar: true,\n    inert: false,\n};\nRemoveScroll.classNames = {\n    fullWidth: fullWidthClassName,\n    zeroRight: zeroRightClassName,\n};\nexport { RemoveScroll };\n","import { __assign, __rest } from \"tslib\";\nimport * as React from 'react';\nvar SideCar = function (_a) {\n    var sideCar = _a.sideCar, rest = __rest(_a, [\"sideCar\"]);\n    if (!sideCar) {\n        throw new Error('Sidecar: please provide `sideCar` property to import the right car');\n    }\n    var Target = sideCar.read();\n    if (!Target) {\n        throw new Error('Sidecar medium not found');\n    }\n    return React.createElement(Target, __assign({}, rest));\n};\nSideCar.isSideCarExport = true;\nexport function exportSidecar(medium, exported) {\n    medium.useMedium(exported);\n    return SideCar;\n}\n","var currentNonce;\nexport var setNonce = function (nonce) {\n    currentNonce = nonce;\n};\nexport var getNonce = function () {\n    if (currentNonce) {\n        return currentNonce;\n    }\n    if (typeof __webpack_nonce__ !== 'undefined') {\n        return __webpack_nonce__;\n    }\n    return undefined;\n};\n","import { getNonce } from 'get-nonce';\nfunction makeStyleTag() {\n    if (!document)\n        return null;\n    var tag = document.createElement('style');\n    tag.type = 'text/css';\n    var nonce = getNonce();\n    if (nonce) {\n        tag.setAttribute('nonce', nonce);\n    }\n    return tag;\n}\nfunction injectStyles(tag, css) {\n    // @ts-ignore\n    if (tag.styleSheet) {\n        // @ts-ignore\n        tag.styleSheet.cssText = css;\n    }\n    else {\n        tag.appendChild(document.createTextNode(css));\n    }\n}\nfunction insertStyleTag(tag) {\n    var head = document.head || document.getElementsByTagName('head')[0];\n    head.appendChild(tag);\n}\nexport var stylesheetSingleton = function () {\n    var counter = 0;\n    var stylesheet = null;\n    return {\n        add: function (style) {\n            if (counter == 0) {\n                if ((stylesheet = makeStyleTag())) {\n                    injectStyles(stylesheet, style);\n                    insertStyleTag(stylesheet);\n                }\n            }\n            counter++;\n        },\n        remove: function () {\n            counter--;\n            if (!counter && stylesheet) {\n                stylesheet.parentNode && stylesheet.parentNode.removeChild(stylesheet);\n                stylesheet = null;\n            }\n        },\n    };\n};\n","import { styleHookSingleton } from './hook';\n/**\n * create a Component to add styles on demand\n * - styles are added when first instance is mounted\n * - styles are removed when the last instance is unmounted\n * - changing styles in runtime does nothing unless dynamic is set. But with multiple components that can lead to the undefined behavior\n */\nexport var styleSingleton = function () {\n    var useStyle = styleHookSingleton();\n    var Sheet = function (_a) {\n        var styles = _a.styles, dynamic = _a.dynamic;\n        useStyle(styles, dynamic);\n        return null;\n    };\n    return Sheet;\n};\n","import * as React from 'react';\nimport { stylesheetSingleton } from './singleton';\n/**\n * creates a hook to control style singleton\n * @see {@link styleSingleton} for a safer component version\n * @example\n * ```tsx\n * const useStyle = styleHookSingleton();\n * ///\n * useStyle('body { overflow: hidden}');\n */\nexport var styleHookSingleton = function () {\n    var sheet = stylesheetSingleton();\n    return function (styles, isDynamic) {\n        React.useEffect(function () {\n            sheet.add(styles);\n            return function () {\n                sheet.remove();\n            };\n        }, [styles && isDynamic]);\n    };\n};\n","export var zeroGap = {\n    left: 0,\n    top: 0,\n    right: 0,\n    gap: 0,\n};\nvar parse = function (x) { return parseInt(x || '', 10) || 0; };\nvar getOffset = function (gapMode) {\n    var cs = window.getComputedStyle(document.body);\n    var left = cs[gapMode === 'padding' ? 'paddingLeft' : 'marginLeft'];\n    var top = cs[gapMode === 'padding' ? 'paddingTop' : 'marginTop'];\n    var right = cs[gapMode === 'padding' ? 'paddingRight' : 'marginRight'];\n    return [parse(left), parse(top), parse(right)];\n};\nexport var getGapWidth = function (gapMode) {\n    if (gapMode === void 0) { gapMode = 'margin'; }\n    if (typeof window === 'undefined') {\n        return zeroGap;\n    }\n    var offsets = getOffset(gapMode);\n    var documentWidth = document.documentElement.clientWidth;\n    var windowWidth = window.innerWidth;\n    return {\n        left: offsets[0],\n        top: offsets[1],\n        right: offsets[2],\n        gap: Math.max(0, windowWidth - documentWidth + offsets[2] - offsets[0]),\n    };\n};\n","import * as React from 'react';\nimport { styleSingleton } from 'react-style-singleton';\nimport { fullWidthClassName, zeroRightClassName, noScrollbarsClassName, removedBarSizeVariable } from './constants';\nimport { getGapWidth } from './utils';\nvar Style = styleSingleton();\n// important tip - once we measure scrollBar width and remove them\n// we could not repeat this operation\n// thus we are using style-singleton - only the first \"yet correct\" style will be applied.\nvar getStyles = function (_a, allowRelative, gapMode, important) {\n    var left = _a.left, top = _a.top, right = _a.right, gap = _a.gap;\n    if (gapMode === void 0) { gapMode = 'margin'; }\n    return \"\\n  .\".concat(noScrollbarsClassName, \" {\\n   overflow: hidden \").concat(important, \";\\n   padding-right: \").concat(gap, \"px \").concat(important, \";\\n  }\\n  body {\\n    overflow: hidden \").concat(important, \";\\n    overscroll-behavior: contain;\\n    \").concat([\n        allowRelative && \"position: relative \".concat(important, \";\"),\n        gapMode === 'margin' &&\n            \"\\n    padding-left: \".concat(left, \"px;\\n    padding-top: \").concat(top, \"px;\\n    padding-right: \").concat(right, \"px;\\n    margin-left:0;\\n    margin-top:0;\\n    margin-right: \").concat(gap, \"px \").concat(important, \";\\n    \"),\n        gapMode === 'padding' && \"padding-right: \".concat(gap, \"px \").concat(important, \";\"),\n    ]\n        .filter(Boolean)\n        .join(''), \"\\n  }\\n  \\n  .\").concat(zeroRightClassName, \" {\\n    right: \").concat(gap, \"px \").concat(important, \";\\n  }\\n  \\n  .\").concat(fullWidthClassName, \" {\\n    margin-right: \").concat(gap, \"px \").concat(important, \";\\n  }\\n  \\n  .\").concat(zeroRightClassName, \" .\").concat(zeroRightClassName, \" {\\n    right: 0 \").concat(important, \";\\n  }\\n  \\n  .\").concat(fullWidthClassName, \" .\").concat(fullWidthClassName, \" {\\n    margin-right: 0 \").concat(important, \";\\n  }\\n  \\n  body {\\n    \").concat(removedBarSizeVariable, \": \").concat(gap, \"px;\\n  }\\n\");\n};\n/**\n * Removes page scrollbar and blocks page scroll when mounted\n */\nexport var RemoveScrollBar = function (props) {\n    var noRelative = props.noRelative, noImportant = props.noImportant, _a = props.gapMode, gapMode = _a === void 0 ? 'margin' : _a;\n    /*\n     gap will be measured on every component mount\n     however it will be used only by the \"first\" invocation\n     due to singleton nature of <Style\n     */\n    var gap = React.useMemo(function () { return getGapWidth(gapMode); }, [gapMode]);\n    return React.createElement(Style, { styles: getStyles(gap, !noRelative, gapMode, !noImportant ? '!important' : '') });\n};\n","var passiveSupported = false;\nif (typeof window !== 'undefined') {\n    try {\n        var options = Object.defineProperty({}, 'passive', {\n            get: function () {\n                passiveSupported = true;\n                return true;\n            },\n        });\n        // @ts-ignore\n        window.addEventListener('test', options, options);\n        // @ts-ignore\n        window.removeEventListener('test', options, options);\n    }\n    catch (err) {\n        passiveSupported = false;\n    }\n}\nexport var nonPassive = passiveSupported ? { passive: false } : false;\n","var alwaysContainsScroll = function (node) {\n    // textarea will always _contain_ scroll inside self. It only can be hidden\n    return node.tagName === 'TEXTAREA';\n};\nvar elementCanBeScrolled = function (node, overflow) {\n    var styles = window.getComputedStyle(node);\n    return (\n    // not-not-scrollable\n    styles[overflow] !== 'hidden' &&\n        // contains scroll inside self\n        !(styles.overflowY === styles.overflowX && !alwaysContainsScroll(node) && styles[overflow] === 'visible'));\n};\nvar elementCouldBeVScrolled = function (node) { return elementCanBeScrolled(node, 'overflowY'); };\nvar elementCouldBeHScrolled = function (node) { return elementCanBeScrolled(node, 'overflowX'); };\nexport var locationCouldBeScrolled = function (axis, node) {\n    var current = node;\n    do {\n        // Skip over shadow root\n        if (typeof ShadowRoot !== 'undefined' && current instanceof ShadowRoot) {\n            current = current.host;\n        }\n        var isScrollable = elementCouldBeScrolled(axis, current);\n        if (isScrollable) {\n            var _a = getScrollVariables(axis, current), s = _a[1], d = _a[2];\n            if (s > d) {\n                return true;\n            }\n        }\n        current = current.parentNode;\n    } while (current && current !== document.body);\n    return false;\n};\nvar getVScrollVariables = function (_a) {\n    var scrollTop = _a.scrollTop, scrollHeight = _a.scrollHeight, clientHeight = _a.clientHeight;\n    return [\n        scrollTop,\n        scrollHeight,\n        clientHeight,\n    ];\n};\nvar getHScrollVariables = function (_a) {\n    var scrollLeft = _a.scrollLeft, scrollWidth = _a.scrollWidth, clientWidth = _a.clientWidth;\n    return [\n        scrollLeft,\n        scrollWidth,\n        clientWidth,\n    ];\n};\nvar elementCouldBeScrolled = function (axis, node) {\n    return axis === 'v' ? elementCouldBeVScrolled(node) : elementCouldBeHScrolled(node);\n};\nvar getScrollVariables = function (axis, node) {\n    return axis === 'v' ? getVScrollVariables(node) : getHScrollVariables(node);\n};\nvar getDirectionFactor = function (axis, direction) {\n    /**\n     * If the element's direction is rtl (right-to-left), then scrollLeft is 0 when the scrollbar is at its rightmost position,\n     * and then increasingly negative as you scroll towards the end of the content.\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/Element/scrollLeft\n     */\n    return axis === 'h' && direction === 'rtl' ? -1 : 1;\n};\nexport var handleScroll = function (axis, endTarget, event, sourceDelta, noOverscroll) {\n    var directionFactor = getDirectionFactor(axis, window.getComputedStyle(endTarget).direction);\n    var delta = directionFactor * sourceDelta;\n    // find scrollable target\n    var target = event.target;\n    var targetInLock = endTarget.contains(target);\n    var shouldCancelScroll = false;\n    var isDeltaPositive = delta > 0;\n    var availableScroll = 0;\n    var availableScrollTop = 0;\n    do {\n        var _a = getScrollVariables(axis, target), position = _a[0], scroll_1 = _a[1], capacity = _a[2];\n        var elementScroll = scroll_1 - capacity - directionFactor * position;\n        if (position || elementScroll) {\n            if (elementCouldBeScrolled(axis, target)) {\n                availableScroll += elementScroll;\n                availableScrollTop += position;\n            }\n        }\n        target = target.parentNode;\n    } while (\n    // portaled content\n    (!targetInLock && target !== document.body) ||\n        // self content\n        (targetInLock && (endTarget.contains(target) || endTarget === target)));\n    if (isDeltaPositive && ((noOverscroll && availableScroll === 0) || (!noOverscroll && delta > availableScroll))) {\n        shouldCancelScroll = true;\n    }\n    else if (!isDeltaPositive &&\n        ((noOverscroll && availableScrollTop === 0) || (!noOverscroll && -delta > availableScrollTop))) {\n        shouldCancelScroll = true;\n    }\n    return shouldCancelScroll;\n};\n","import { __spreadArray } from \"tslib\";\nimport * as React from 'react';\nimport { RemoveScrollBar } from 'react-remove-scroll-bar';\nimport { styleSingleton } from 'react-style-singleton';\nimport { nonPassive } from './aggresiveCapture';\nimport { handleScroll, locationCouldBeScrolled } from './handleScroll';\nexport var getTouchXY = function (event) {\n    return 'changedTouches' in event ? [event.changedTouches[0].clientX, event.changedTouches[0].clientY] : [0, 0];\n};\nexport var getDeltaXY = function (event) { return [event.deltaX, event.deltaY]; };\nvar extractRef = function (ref) {\n    return ref && 'current' in ref ? ref.current : ref;\n};\nvar deltaCompare = function (x, y) { return x[0] === y[0] && x[1] === y[1]; };\nvar generateStyle = function (id) { return \"\\n  .block-interactivity-\".concat(id, \" {pointer-events: none;}\\n  .allow-interactivity-\").concat(id, \" {pointer-events: all;}\\n\"); };\nvar idCounter = 0;\nvar lockStack = [];\nexport function RemoveScrollSideCar(props) {\n    var shouldPreventQueue = React.useRef([]);\n    var touchStartRef = React.useRef([0, 0]);\n    var activeAxis = React.useRef();\n    var id = React.useState(idCounter++)[0];\n    var Style = React.useState(function () { return styleSingleton(); })[0];\n    var lastProps = React.useRef(props);\n    React.useEffect(function () {\n        lastProps.current = props;\n    }, [props]);\n    React.useEffect(function () {\n        if (props.inert) {\n            document.body.classList.add(\"block-interactivity-\".concat(id));\n            var allow_1 = __spreadArray([props.lockRef.current], (props.shards || []).map(extractRef), true).filter(Boolean);\n            allow_1.forEach(function (el) { return el.classList.add(\"allow-interactivity-\".concat(id)); });\n            return function () {\n                document.body.classList.remove(\"block-interactivity-\".concat(id));\n                allow_1.forEach(function (el) { return el.classList.remove(\"allow-interactivity-\".concat(id)); });\n            };\n        }\n        return;\n    }, [props.inert, props.lockRef.current, props.shards]);\n    var shouldCancelEvent = React.useCallback(function (event, parent) {\n        if ('touches' in event && event.touches.length === 2) {\n            return !lastProps.current.allowPinchZoom;\n        }\n        var touch = getTouchXY(event);\n        var touchStart = touchStartRef.current;\n        var deltaX = 'deltaX' in event ? event.deltaX : touchStart[0] - touch[0];\n        var deltaY = 'deltaY' in event ? event.deltaY : touchStart[1] - touch[1];\n        var currentAxis;\n        var target = event.target;\n        var moveDirection = Math.abs(deltaX) > Math.abs(deltaY) ? 'h' : 'v';\n        // allow horizontal touch move on Range inputs. They will not cause any scroll\n        if ('touches' in event && moveDirection === 'h' && target.type === 'range') {\n            return false;\n        }\n        var canBeScrolledInMainDirection = locationCouldBeScrolled(moveDirection, target);\n        if (!canBeScrolledInMainDirection) {\n            return true;\n        }\n        if (canBeScrolledInMainDirection) {\n            currentAxis = moveDirection;\n        }\n        else {\n            currentAxis = moveDirection === 'v' ? 'h' : 'v';\n            canBeScrolledInMainDirection = locationCouldBeScrolled(moveDirection, target);\n            // other axis might be not scrollable\n        }\n        if (!canBeScrolledInMainDirection) {\n            return false;\n        }\n        if (!activeAxis.current && 'changedTouches' in event && (deltaX || deltaY)) {\n            activeAxis.current = currentAxis;\n        }\n        if (!currentAxis) {\n            return true;\n        }\n        var cancelingAxis = activeAxis.current || currentAxis;\n        return handleScroll(cancelingAxis, parent, event, cancelingAxis === 'h' ? deltaX : deltaY, true);\n    }, []);\n    var shouldPrevent = React.useCallback(function (_event) {\n        var event = _event;\n        if (!lockStack.length || lockStack[lockStack.length - 1] !== Style) {\n            // not the last active\n            return;\n        }\n        var delta = 'deltaY' in event ? getDeltaXY(event) : getTouchXY(event);\n        var sourceEvent = shouldPreventQueue.current.filter(function (e) { return e.name === event.type && e.target === event.target && deltaCompare(e.delta, delta); })[0];\n        // self event, and should be canceled\n        if (sourceEvent && sourceEvent.should) {\n            if (event.cancelable) {\n                event.preventDefault();\n            }\n            return;\n        }\n        // outside or shard event\n        if (!sourceEvent) {\n            var shardNodes = (lastProps.current.shards || [])\n                .map(extractRef)\n                .filter(Boolean)\n                .filter(function (node) { return node.contains(event.target); });\n            var shouldStop = shardNodes.length > 0 ? shouldCancelEvent(event, shardNodes[0]) : !lastProps.current.noIsolation;\n            if (shouldStop) {\n                if (event.cancelable) {\n                    event.preventDefault();\n                }\n            }\n        }\n    }, []);\n    var shouldCancel = React.useCallback(function (name, delta, target, should) {\n        var event = { name: name, delta: delta, target: target, should: should };\n        shouldPreventQueue.current.push(event);\n        setTimeout(function () {\n            shouldPreventQueue.current = shouldPreventQueue.current.filter(function (e) { return e !== event; });\n        }, 1);\n    }, []);\n    var scrollTouchStart = React.useCallback(function (event) {\n        touchStartRef.current = getTouchXY(event);\n        activeAxis.current = undefined;\n    }, []);\n    var scrollWheel = React.useCallback(function (event) {\n        shouldCancel(event.type, getDeltaXY(event), event.target, shouldCancelEvent(event, props.lockRef.current));\n    }, []);\n    var scrollTouchMove = React.useCallback(function (event) {\n        shouldCancel(event.type, getTouchXY(event), event.target, shouldCancelEvent(event, props.lockRef.current));\n    }, []);\n    React.useEffect(function () {\n        lockStack.push(Style);\n        props.setCallbacks({\n            onScrollCapture: scrollWheel,\n            onWheelCapture: scrollWheel,\n            onTouchMoveCapture: scrollTouchMove,\n        });\n        document.addEventListener('wheel', shouldPrevent, nonPassive);\n        document.addEventListener('touchmove', shouldPrevent, nonPassive);\n        document.addEventListener('touchstart', scrollTouchStart, nonPassive);\n        return function () {\n            lockStack = lockStack.filter(function (inst) { return inst !== Style; });\n            document.removeEventListener('wheel', shouldPrevent, nonPassive);\n            document.removeEventListener('touchmove', shouldPrevent, nonPassive);\n            document.removeEventListener('touchstart', scrollTouchStart, nonPassive);\n        };\n    }, []);\n    var removeScrollBar = props.removeScrollBar, inert = props.inert;\n    return (React.createElement(React.Fragment, null,\n        inert ? React.createElement(Style, { styles: generateStyle(id) }) : null,\n        removeScrollBar ? React.createElement(RemoveScrollBar, { gapMode: \"margin\" }) : null));\n}\n","import { exportSidecar } from 'use-sidecar';\nimport { RemoveScrollSideCar } from './SideEffect';\nimport { effectCar } from './medium';\nexport default exportSidecar(effectCar, RemoveScrollSideCar);\n","import { __assign } from \"tslib\";\nimport * as React from 'react';\nimport { RemoveScroll } from './UI';\nimport SideCar from './sidecar';\nvar ReactRemoveScroll = React.forwardRef(function (props, ref) { return (React.createElement(RemoveScroll, __assign({}, props, { ref: ref, sideCar: SideCar }))); });\nReactRemoveScroll.classNames = RemoveScroll.classNames;\nexport default ReactRemoveScroll;\n","import * as React from 'react';\nimport { composeEventHandlers } from '@radix-ui/primitive';\nimport { createCollection } from '@radix-ui/react-collection';\nimport { useComposedRefs, composeRefs } from '@radix-ui/react-compose-refs';\nimport { createContextScope } from '@radix-ui/react-context';\nimport { useDirection } from '@radix-ui/react-direction';\nimport { DismissableLayer } from '@radix-ui/react-dismissable-layer';\nimport { useFocusGuards } from '@radix-ui/react-focus-guards';\nimport { FocusScope } from '@radix-ui/react-focus-scope';\nimport { useId } from '@radix-ui/react-id';\nimport * as PopperPrimitive from '@radix-ui/react-popper';\nimport { createPopperScope } from '@radix-ui/react-popper';\nimport { Portal as PortalPrimitive } from '@radix-ui/react-portal';\nimport { Presence } from '@radix-ui/react-presence';\nimport { Primitive, dispatchDiscreteCustomEvent } from '@radix-ui/react-primitive';\nimport * as RovingFocusGroup from '@radix-ui/react-roving-focus';\nimport { createRovingFocusGroupScope } from '@radix-ui/react-roving-focus';\nimport { Slot } from '@radix-ui/react-slot';\nimport { useCallbackRef } from '@radix-ui/react-use-callback-ref';\nimport { hideOthers } from 'aria-hidden';\nimport { RemoveScroll } from 'react-remove-scroll';\n\nimport type * as Radix from '@radix-ui/react-primitive';\nimport type { Scope } from '@radix-ui/react-context';\n\ntype Direction = 'ltr' | 'rtl';\n\nconst SELECTION_KEYS = ['Enter', ' '];\nconst FIRST_KEYS = ['ArrowDown', 'PageUp', 'Home'];\nconst LAST_KEYS = ['ArrowUp', 'PageDown', 'End'];\nconst FIRST_LAST_KEYS = [...FIRST_KEYS, ...LAST_KEYS];\nconst SUB_OPEN_KEYS: Record<Direction, string[]> = {\n  ltr: [...SELECTION_KEYS, 'ArrowRight'],\n  rtl: [...SELECTION_KEYS, 'ArrowLeft'],\n};\nconst SUB_CLOSE_KEYS: Record<Direction, string[]> = {\n  ltr: ['ArrowLeft'],\n  rtl: ['ArrowRight'],\n};\n\n/* -------------------------------------------------------------------------------------------------\n * Menu\n * -----------------------------------------------------------------------------------------------*/\n\nconst MENU_NAME = 'Menu';\n\ntype ItemData = { disabled: boolean; textValue: string };\nconst [Collection, useCollection, createCollectionScope] = createCollection<\n  MenuItemElement,\n  ItemData\n>(MENU_NAME);\n\ntype ScopedProps<P> = P & { __scopeMenu?: Scope };\nconst [createMenuContext, createMenuScope] = createContextScope(MENU_NAME, [\n  createCollectionScope,\n  createPopperScope,\n  createRovingFocusGroupScope,\n]);\nconst usePopperScope = createPopperScope();\nconst useRovingFocusGroupScope = createRovingFocusGroupScope();\n\ntype MenuContextValue = {\n  open: boolean;\n  onOpenChange(open: boolean): void;\n  content: MenuContentElement | null;\n  onContentChange(content: MenuContentElement | null): void;\n};\n\nconst [MenuProvider, useMenuContext] = createMenuContext<MenuContextValue>(MENU_NAME);\n\ntype MenuRootContextValue = {\n  onClose(): void;\n  isUsingKeyboardRef: React.RefObject<boolean>;\n  dir: Direction;\n  modal: boolean;\n};\n\nconst [MenuRootProvider, useMenuRootContext] = createMenuContext<MenuRootContextValue>(MENU_NAME);\n\ninterface MenuProps {\n  children?: React.ReactNode;\n  open?: boolean;\n  onOpenChange?(open: boolean): void;\n  dir?: Direction;\n  modal?: boolean;\n}\n\nconst Menu: React.FC<MenuProps> = (props: ScopedProps<MenuProps>) => {\n  const { __scopeMenu, open = false, children, dir, onOpenChange, modal = true } = props;\n  const popperScope = usePopperScope(__scopeMenu);\n  const [content, setContent] = React.useState<MenuContentElement | null>(null);\n  const isUsingKeyboardRef = React.useRef(false);\n  const handleOpenChange = useCallbackRef(onOpenChange);\n  const direction = useDirection(dir);\n\n  React.useEffect(() => {\n    // Capture phase ensures we set the boolean before any side effects execute\n    // in response to the key or pointer event as they might depend on this value.\n    const handleKeyDown = () => {\n      isUsingKeyboardRef.current = true;\n      document.addEventListener('pointerdown', handlePointer, { capture: true, once: true });\n      document.addEventListener('pointermove', handlePointer, { capture: true, once: true });\n    };\n    const handlePointer = () => (isUsingKeyboardRef.current = false);\n    document.addEventListener('keydown', handleKeyDown, { capture: true });\n    return () => {\n      document.removeEventListener('keydown', handleKeyDown, { capture: true });\n      document.removeEventListener('pointerdown', handlePointer, { capture: true });\n      document.removeEventListener('pointermove', handlePointer, { capture: true });\n    };\n  }, []);\n\n  return (\n    <PopperPrimitive.Root {...popperScope}>\n      <MenuProvider\n        scope={__scopeMenu}\n        open={open}\n        onOpenChange={handleOpenChange}\n        content={content}\n        onContentChange={setContent}\n      >\n        <MenuRootProvider\n          scope={__scopeMenu}\n          onClose={React.useCallback(() => handleOpenChange(false), [handleOpenChange])}\n          isUsingKeyboardRef={isUsingKeyboardRef}\n          dir={direction}\n          modal={modal}\n        >\n          {children}\n        </MenuRootProvider>\n      </MenuProvider>\n    </PopperPrimitive.Root>\n  );\n};\n\nMenu.displayName = MENU_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * MenuAnchor\n * -----------------------------------------------------------------------------------------------*/\n\nconst ANCHOR_NAME = 'MenuAnchor';\n\ntype MenuAnchorElement = React.ElementRef<typeof PopperPrimitive.Anchor>;\ntype PopperAnchorProps = Radix.ComponentPropsWithoutRef<typeof PopperPrimitive.Anchor>;\ninterface MenuAnchorProps extends PopperAnchorProps {}\n\nconst MenuAnchor = React.forwardRef<MenuAnchorElement, MenuAnchorProps>(\n  (props: ScopedProps<MenuAnchorProps>, forwardedRef) => {\n    const { __scopeMenu, ...anchorProps } = props;\n    const popperScope = usePopperScope(__scopeMenu);\n    return <PopperPrimitive.Anchor {...popperScope} {...anchorProps} ref={forwardedRef} />;\n  }\n);\n\nMenuAnchor.displayName = ANCHOR_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * MenuPortal\n * -----------------------------------------------------------------------------------------------*/\n\nconst PORTAL_NAME = 'MenuPortal';\n\ntype PortalContextValue = { forceMount?: true };\nconst [PortalProvider, usePortalContext] = createMenuContext<PortalContextValue>(PORTAL_NAME, {\n  forceMount: undefined,\n});\n\ntype PortalProps = React.ComponentPropsWithoutRef<typeof PortalPrimitive>;\ninterface MenuPortalProps extends Omit<PortalProps, 'asChild'> {\n  children?: React.ReactNode;\n  /**\n   * Used to force mounting when more control is needed. Useful when\n   * controlling animation with React animation libraries.\n   */\n  forceMount?: true;\n}\n\nconst MenuPortal: React.FC<MenuPortalProps> = (props: ScopedProps<MenuPortalProps>) => {\n  const { __scopeMenu, forceMount, children, container } = props;\n  const context = useMenuContext(PORTAL_NAME, __scopeMenu);\n  return (\n    <PortalProvider scope={__scopeMenu} forceMount={forceMount}>\n      <Presence present={forceMount || context.open}>\n        <PortalPrimitive asChild container={container}>\n          {children}\n        </PortalPrimitive>\n      </Presence>\n    </PortalProvider>\n  );\n};\n\nMenuPortal.displayName = PORTAL_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * MenuContent\n * -----------------------------------------------------------------------------------------------*/\n\nconst CONTENT_NAME = 'MenuContent';\n\ntype MenuContentContextValue = {\n  onItemEnter(event: React.PointerEvent): void;\n  onItemLeave(event: React.PointerEvent): void;\n  onTriggerLeave(event: React.PointerEvent): void;\n  searchRef: React.RefObject<string>;\n  pointerGraceTimerRef: React.MutableRefObject<number>;\n  onPointerGraceIntentChange(intent: GraceIntent | null): void;\n};\nconst [MenuContentProvider, useMenuContentContext] =\n  createMenuContext<MenuContentContextValue>(CONTENT_NAME);\n\ntype MenuContentElement = MenuRootContentTypeElement;\n/**\n * We purposefully don't union MenuRootContent and MenuSubContent props here because\n * they have conflicting prop types. We agreed that we would allow MenuSubContent to\n * accept props that it would just ignore.\n */\ninterface MenuContentProps extends MenuRootContentTypeProps {\n  /**\n   * Used to force mounting when more control is needed. Useful when\n   * controlling animation with React animation libraries.\n   */\n  forceMount?: true;\n}\n\nconst MenuContent = React.forwardRef<MenuContentElement, MenuContentProps>(\n  (props: ScopedProps<MenuContentProps>, forwardedRef) => {\n    const portalContext = usePortalContext(CONTENT_NAME, props.__scopeMenu);\n    const { forceMount = portalContext.forceMount, ...contentProps } = props;\n    const context = useMenuContext(CONTENT_NAME, props.__scopeMenu);\n    const rootContext = useMenuRootContext(CONTENT_NAME, props.__scopeMenu);\n\n    return (\n      <Collection.Provider scope={props.__scopeMenu}>\n        <Presence present={forceMount || context.open}>\n          <Collection.Slot scope={props.__scopeMenu}>\n            {rootContext.modal ? (\n              <MenuRootContentModal {...contentProps} ref={forwardedRef} />\n            ) : (\n              <MenuRootContentNonModal {...contentProps} ref={forwardedRef} />\n            )}\n          </Collection.Slot>\n        </Presence>\n      </Collection.Provider>\n    );\n  }\n);\n\n/* ---------------------------------------------------------------------------------------------- */\n\ntype MenuRootContentTypeElement = MenuContentImplElement;\ninterface MenuRootContentTypeProps\n  extends Omit<MenuContentImplProps, keyof MenuContentImplPrivateProps> {}\n\nconst MenuRootContentModal = React.forwardRef<MenuRootContentTypeElement, MenuRootContentTypeProps>(\n  (props: ScopedProps<MenuRootContentTypeProps>, forwardedRef) => {\n    const context = useMenuContext(CONTENT_NAME, props.__scopeMenu);\n    const ref = React.useRef<MenuRootContentTypeElement>(null);\n    const composedRefs = useComposedRefs(forwardedRef, ref);\n\n    // Hide everything from ARIA except the `MenuContent`\n    React.useEffect(() => {\n      const content = ref.current;\n      if (content) return hideOthers(content);\n    }, []);\n\n    return (\n      <MenuContentImpl\n        {...props}\n        ref={composedRefs}\n        // we make sure we're not trapping once it's been closed\n        // (closed !== unmounted when animating out)\n        trapFocus={context.open}\n        // make sure to only disable pointer events when open\n        // this avoids blocking interactions while animating out\n        disableOutsidePointerEvents={context.open}\n        disableOutsideScroll\n        // When focus is trapped, a `focusout` event may still happen.\n        // We make sure we don't trigger our `onDismiss` in such case.\n        onFocusOutside={composeEventHandlers(\n          props.onFocusOutside,\n          (event) => event.preventDefault(),\n          { checkForDefaultPrevented: false }\n        )}\n        onDismiss={() => context.onOpenChange(false)}\n      />\n    );\n  }\n);\n\nconst MenuRootContentNonModal = React.forwardRef<\n  MenuRootContentTypeElement,\n  MenuRootContentTypeProps\n>((props: ScopedProps<MenuRootContentTypeProps>, forwardedRef) => {\n  const context = useMenuContext(CONTENT_NAME, props.__scopeMenu);\n  return (\n    <MenuContentImpl\n      {...props}\n      ref={forwardedRef}\n      trapFocus={false}\n      disableOutsidePointerEvents={false}\n      disableOutsideScroll={false}\n      onDismiss={() => context.onOpenChange(false)}\n    />\n  );\n});\n\n/* ---------------------------------------------------------------------------------------------- */\n\ntype MenuContentImplElement = React.ElementRef<typeof PopperPrimitive.Content>;\ntype FocusScopeProps = Radix.ComponentPropsWithoutRef<typeof FocusScope>;\ntype DismissableLayerProps = Radix.ComponentPropsWithoutRef<typeof DismissableLayer>;\ntype RovingFocusGroupProps = Radix.ComponentPropsWithoutRef<typeof RovingFocusGroup.Root>;\ntype PopperContentProps = Radix.ComponentPropsWithoutRef<typeof PopperPrimitive.Content>;\ntype MenuContentImplPrivateProps = {\n  onOpenAutoFocus?: FocusScopeProps['onMountAutoFocus'];\n  onDismiss?: DismissableLayerProps['onDismiss'];\n  disableOutsidePointerEvents?: DismissableLayerProps['disableOutsidePointerEvents'];\n\n  /**\n   * Whether scrolling outside the `MenuContent` should be prevented\n   * (default: `false`)\n   */\n  disableOutsideScroll?: boolean;\n\n  /**\n   * Whether focus should be trapped within the `MenuContent`\n   * (default: false)\n   */\n  trapFocus?: FocusScopeProps['trapped'];\n};\ninterface MenuContentImplProps\n  extends MenuContentImplPrivateProps,\n    Omit<PopperContentProps, 'dir' | 'onPlaced'> {\n  /**\n   * Event handler called when auto-focusing on close.\n   * Can be prevented.\n   */\n  onCloseAutoFocus?: FocusScopeProps['onUnmountAutoFocus'];\n\n  /**\n   * Whether keyboard navigation should loop around\n   * @defaultValue false\n   */\n  loop?: RovingFocusGroupProps['loop'];\n\n  onEntryFocus?: RovingFocusGroupProps['onEntryFocus'];\n  onEscapeKeyDown?: DismissableLayerProps['onEscapeKeyDown'];\n  onPointerDownOutside?: DismissableLayerProps['onPointerDownOutside'];\n  onFocusOutside?: DismissableLayerProps['onFocusOutside'];\n  onInteractOutside?: DismissableLayerProps['onInteractOutside'];\n}\n\nconst MenuContentImpl = React.forwardRef<MenuContentImplElement, MenuContentImplProps>(\n  (props: ScopedProps<MenuContentImplProps>, forwardedRef) => {\n    const {\n      __scopeMenu,\n      loop = false,\n      trapFocus,\n      onOpenAutoFocus,\n      onCloseAutoFocus,\n      disableOutsidePointerEvents,\n      onEntryFocus,\n      onEscapeKeyDown,\n      onPointerDownOutside,\n      onFocusOutside,\n      onInteractOutside,\n      onDismiss,\n      disableOutsideScroll,\n      ...contentProps\n    } = props;\n    const context = useMenuContext(CONTENT_NAME, __scopeMenu);\n    const rootContext = useMenuRootContext(CONTENT_NAME, __scopeMenu);\n    const popperScope = usePopperScope(__scopeMenu);\n    const rovingFocusGroupScope = useRovingFocusGroupScope(__scopeMenu);\n    const getItems = useCollection(__scopeMenu);\n    const [currentItemId, setCurrentItemId] = React.useState<string | null>(null);\n    const contentRef = React.useRef<HTMLDivElement>(null);\n    const composedRefs = useComposedRefs(forwardedRef, contentRef, context.onContentChange);\n    const timerRef = React.useRef(0);\n    const searchRef = React.useRef('');\n    const pointerGraceTimerRef = React.useRef(0);\n    const pointerGraceIntentRef = React.useRef<GraceIntent | null>(null);\n    const pointerDirRef = React.useRef<Side>('right');\n    const lastPointerXRef = React.useRef(0);\n\n    const ScrollLockWrapper = disableOutsideScroll ? RemoveScroll : React.Fragment;\n    const scrollLockWrapperProps = disableOutsideScroll\n      ? { as: Slot, allowPinchZoom: true }\n      : undefined;\n\n    const handleTypeaheadSearch = (key: string) => {\n      const search = searchRef.current + key;\n      const items = getItems().filter((item) => !item.disabled);\n      const currentItem = document.activeElement;\n      const currentMatch = items.find((item) => item.ref.current === currentItem)?.textValue;\n      const values = items.map((item) => item.textValue);\n      const nextMatch = getNextMatch(values, search, currentMatch);\n      const newItem = items.find((item) => item.textValue === nextMatch)?.ref.current;\n\n      // Reset `searchRef` 1 second after it was last updated\n      (function updateSearch(value: string) {\n        searchRef.current = value;\n        window.clearTimeout(timerRef.current);\n        if (value !== '') timerRef.current = window.setTimeout(() => updateSearch(''), 1000);\n      })(search);\n\n      if (newItem) {\n        /**\n         * Imperative focus during keydown is risky so we prevent React's batching updates\n         * to avoid potential bugs. See: https://github.com/facebook/react/issues/20332\n         */\n        setTimeout(() => (newItem as HTMLElement).focus());\n      }\n    };\n\n    React.useEffect(() => {\n      return () => window.clearTimeout(timerRef.current);\n    }, []);\n\n    // Make sure the whole tree has focus guards as our `MenuContent` may be\n    // the last element in the DOM (beacuse of the `Portal`)\n    useFocusGuards();\n\n    const isPointerMovingToSubmenu = React.useCallback((event: React.PointerEvent) => {\n      const isMovingTowards = pointerDirRef.current === pointerGraceIntentRef.current?.side;\n      return isMovingTowards && isPointerInGraceArea(event, pointerGraceIntentRef.current?.area);\n    }, []);\n\n    return (\n      <MenuContentProvider\n        scope={__scopeMenu}\n        searchRef={searchRef}\n        onItemEnter={React.useCallback(\n          (event) => {\n            if (isPointerMovingToSubmenu(event)) event.preventDefault();\n          },\n          [isPointerMovingToSubmenu]\n        )}\n        onItemLeave={React.useCallback(\n          (event) => {\n            if (isPointerMovingToSubmenu(event)) return;\n            contentRef.current?.focus();\n            setCurrentItemId(null);\n          },\n          [isPointerMovingToSubmenu]\n        )}\n        onTriggerLeave={React.useCallback(\n          (event) => {\n            if (isPointerMovingToSubmenu(event)) event.preventDefault();\n          },\n          [isPointerMovingToSubmenu]\n        )}\n        pointerGraceTimerRef={pointerGraceTimerRef}\n        onPointerGraceIntentChange={React.useCallback((intent) => {\n          pointerGraceIntentRef.current = intent;\n        }, [])}\n      >\n        <ScrollLockWrapper {...scrollLockWrapperProps}>\n          <FocusScope\n            asChild\n            trapped={trapFocus}\n            onMountAutoFocus={composeEventHandlers(onOpenAutoFocus, (event) => {\n              // when opening, explicitly focus the content area only and leave\n              // `onEntryFocus` in  control of focusing first item\n              event.preventDefault();\n              contentRef.current?.focus();\n            })}\n            onUnmountAutoFocus={onCloseAutoFocus}\n          >\n            <DismissableLayer\n              asChild\n              disableOutsidePointerEvents={disableOutsidePointerEvents}\n              onEscapeKeyDown={onEscapeKeyDown}\n              onPointerDownOutside={onPointerDownOutside}\n              onFocusOutside={onFocusOutside}\n              onInteractOutside={onInteractOutside}\n              onDismiss={onDismiss}\n            >\n              <RovingFocusGroup.Root\n                asChild\n                {...rovingFocusGroupScope}\n                dir={rootContext.dir}\n                orientation=\"vertical\"\n                loop={loop}\n                currentTabStopId={currentItemId}\n                onCurrentTabStopIdChange={setCurrentItemId}\n                onEntryFocus={composeEventHandlers(onEntryFocus, (event) => {\n                  // only focus first item when using keyboard\n                  if (!rootContext.isUsingKeyboardRef.current) event.preventDefault();\n                })}\n              >\n                <PopperPrimitive.Content\n                  role=\"menu\"\n                  aria-orientation=\"vertical\"\n                  data-state={getOpenState(context.open)}\n                  data-radix-menu-content=\"\"\n                  dir={rootContext.dir}\n                  {...popperScope}\n                  {...contentProps}\n                  ref={composedRefs}\n                  style={{ outline: 'none', ...contentProps.style }}\n                  onKeyDown={composeEventHandlers(contentProps.onKeyDown, (event) => {\n                    // submenu key events bubble through portals. We only care about keys in this menu.\n                    const target = event.target as HTMLElement;\n                    const isKeyDownInside =\n                      target.closest('[data-radix-menu-content]') === event.currentTarget;\n                    const isModifierKey = event.ctrlKey || event.altKey || event.metaKey;\n                    const isCharacterKey = event.key.length === 1;\n                    if (isKeyDownInside) {\n                      // menus should not be navigated using tab key so we prevent it\n                      if (event.key === 'Tab') event.preventDefault();\n                      if (!isModifierKey && isCharacterKey) handleTypeaheadSearch(event.key);\n                    }\n                    // focus first/last item based on key pressed\n                    const content = contentRef.current;\n                    if (event.target !== content) return;\n                    if (!FIRST_LAST_KEYS.includes(event.key)) return;\n                    event.preventDefault();\n                    const items = getItems().filter((item) => !item.disabled);\n                    const candidateNodes = items.map((item) => item.ref.current!);\n                    if (LAST_KEYS.includes(event.key)) candidateNodes.reverse();\n                    focusFirst(candidateNodes);\n                  })}\n                  onBlur={composeEventHandlers(props.onBlur, (event) => {\n                    // clear search buffer when leaving the menu\n                    if (!event.currentTarget.contains(event.target)) {\n                      window.clearTimeout(timerRef.current);\n                      searchRef.current = '';\n                    }\n                  })}\n                  onPointerMove={composeEventHandlers(\n                    props.onPointerMove,\n                    whenMouse((event) => {\n                      const target = event.target as HTMLElement;\n                      const pointerXHasChanged = lastPointerXRef.current !== event.clientX;\n\n                      // We don't use `event.movementX` for this check because Safari will\n                      // always return `0` on a pointer event.\n                      if (event.currentTarget.contains(target) && pointerXHasChanged) {\n                        const newDir = event.clientX > lastPointerXRef.current ? 'right' : 'left';\n                        pointerDirRef.current = newDir;\n                        lastPointerXRef.current = event.clientX;\n                      }\n                    })\n                  )}\n                />\n              </RovingFocusGroup.Root>\n            </DismissableLayer>\n          </FocusScope>\n        </ScrollLockWrapper>\n      </MenuContentProvider>\n    );\n  }\n);\n\nMenuContent.displayName = CONTENT_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * MenuGroup\n * -----------------------------------------------------------------------------------------------*/\n\nconst GROUP_NAME = 'MenuGroup';\n\ntype MenuGroupElement = React.ElementRef<typeof Primitive.div>;\ntype PrimitiveDivProps = Radix.ComponentPropsWithoutRef<typeof Primitive.div>;\ninterface MenuGroupProps extends PrimitiveDivProps {}\n\nconst MenuGroup = React.forwardRef<MenuGroupElement, MenuGroupProps>(\n  (props: ScopedProps<MenuGroupProps>, forwardedRef) => {\n    const { __scopeMenu, ...groupProps } = props;\n    return <Primitive.div role=\"group\" {...groupProps} ref={forwardedRef} />;\n  }\n);\n\nMenuGroup.displayName = GROUP_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * MenuLabel\n * -----------------------------------------------------------------------------------------------*/\n\nconst LABEL_NAME = 'MenuLabel';\n\ntype MenuLabelElement = React.ElementRef<typeof Primitive.div>;\ninterface MenuLabelProps extends PrimitiveDivProps {}\n\nconst MenuLabel = React.forwardRef<MenuLabelElement, MenuLabelProps>(\n  (props: ScopedProps<MenuLabelProps>, forwardedRef) => {\n    const { __scopeMenu, ...labelProps } = props;\n    return <Primitive.div {...labelProps} ref={forwardedRef} />;\n  }\n);\n\nMenuLabel.displayName = LABEL_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * MenuItem\n * -----------------------------------------------------------------------------------------------*/\n\nconst ITEM_NAME = 'MenuItem';\nconst ITEM_SELECT = 'menu.itemSelect';\n\ntype MenuItemElement = MenuItemImplElement;\ninterface MenuItemProps extends Omit<MenuItemImplProps, 'onSelect'> {\n  onSelect?: (event: Event) => void;\n}\n\nconst MenuItem = React.forwardRef<MenuItemElement, MenuItemProps>(\n  (props: ScopedProps<MenuItemProps>, forwardedRef) => {\n    const { disabled = false, onSelect, ...itemProps } = props;\n    const ref = React.useRef<HTMLDivElement>(null);\n    const rootContext = useMenuRootContext(ITEM_NAME, props.__scopeMenu);\n    const contentContext = useMenuContentContext(ITEM_NAME, props.__scopeMenu);\n    const composedRefs = useComposedRefs(forwardedRef, ref);\n    const isPointerDownRef = React.useRef(false);\n\n    const handleSelect = () => {\n      const menuItem = ref.current;\n      if (!disabled && menuItem) {\n        const itemSelectEvent = new CustomEvent(ITEM_SELECT, { bubbles: true, cancelable: true });\n        menuItem.addEventListener(ITEM_SELECT, (event) => onSelect?.(event), { once: true });\n        dispatchDiscreteCustomEvent(menuItem, itemSelectEvent);\n        if (itemSelectEvent.defaultPrevented) {\n          isPointerDownRef.current = false;\n        } else {\n          rootContext.onClose();\n        }\n      }\n    };\n\n    return (\n      <MenuItemImpl\n        {...itemProps}\n        ref={composedRefs}\n        disabled={disabled}\n        onClick={composeEventHandlers(props.onClick, handleSelect)}\n        onPointerDown={(event) => {\n          props.onPointerDown?.(event);\n          isPointerDownRef.current = true;\n        }}\n        onPointerUp={composeEventHandlers(props.onPointerUp, (event) => {\n          // Pointer down can move to a different menu item which should activate it on pointer up.\n          // We dispatch a click for selection to allow composition with click based triggers and to\n          // prevent Firefox from getting stuck in text selection mode when the menu closes.\n          if (!isPointerDownRef.current) event.currentTarget?.click();\n        })}\n        onKeyDown={composeEventHandlers(props.onKeyDown, (event) => {\n          const isTypingAhead = contentContext.searchRef.current !== '';\n          if (disabled || (isTypingAhead && event.key === ' ')) return;\n          if (SELECTION_KEYS.includes(event.key)) {\n            event.currentTarget.click();\n            /**\n             * We prevent default browser behaviour for selection keys as they should trigger\n             * a selection only:\n             * - prevents space from scrolling the page.\n             * - if keydown causes focus to move, prevents keydown from firing on the new target.\n             */\n            event.preventDefault();\n          }\n        })}\n      />\n    );\n  }\n);\n\nMenuItem.displayName = ITEM_NAME;\n\n/* ---------------------------------------------------------------------------------------------- */\n\ntype MenuItemImplElement = React.ElementRef<typeof Primitive.div>;\ninterface MenuItemImplProps extends PrimitiveDivProps {\n  disabled?: boolean;\n  textValue?: string;\n}\n\nconst MenuItemImpl = React.forwardRef<MenuItemImplElement, MenuItemImplProps>(\n  (props: ScopedProps<MenuItemImplProps>, forwardedRef) => {\n    const { __scopeMenu, disabled = false, textValue, ...itemProps } = props;\n    const contentContext = useMenuContentContext(ITEM_NAME, __scopeMenu);\n    const rovingFocusGroupScope = useRovingFocusGroupScope(__scopeMenu);\n    const ref = React.useRef<HTMLDivElement>(null);\n    const composedRefs = useComposedRefs(forwardedRef, ref);\n    const [isFocused, setIsFocused] = React.useState(false);\n\n    // get the item's `.textContent` as default strategy for typeahead `textValue`\n    const [textContent, setTextContent] = React.useState('');\n    React.useEffect(() => {\n      const menuItem = ref.current;\n      if (menuItem) {\n        setTextContent((menuItem.textContent ?? '').trim());\n      }\n    }, [itemProps.children]);\n\n    return (\n      <Collection.ItemSlot\n        scope={__scopeMenu}\n        disabled={disabled}\n        textValue={textValue ?? textContent}\n      >\n        <RovingFocusGroup.Item asChild {...rovingFocusGroupScope} focusable={!disabled}>\n          <Primitive.div\n            role=\"menuitem\"\n            data-highlighted={isFocused ? '' : undefined}\n            aria-disabled={disabled || undefined}\n            data-disabled={disabled ? '' : undefined}\n            {...itemProps}\n            ref={composedRefs}\n            /**\n             * We focus items on `pointerMove` to achieve the following:\n             *\n             * - Mouse over an item (it focuses)\n             * - Leave mouse where it is and use keyboard to focus a different item\n             * - Wiggle mouse without it leaving previously focused item\n             * - Previously focused item should re-focus\n             *\n             * If we used `mouseOver`/`mouseEnter` it would not re-focus when the mouse\n             * wiggles. This is to match native menu implementation.\n             */\n            onPointerMove={composeEventHandlers(\n              props.onPointerMove,\n              whenMouse((event) => {\n                if (disabled) {\n                  contentContext.onItemLeave(event);\n                } else {\n                  contentContext.onItemEnter(event);\n                  if (!event.defaultPrevented) {\n                    const item = event.currentTarget;\n                    item.focus();\n                  }\n                }\n              })\n            )}\n            onPointerLeave={composeEventHandlers(\n              props.onPointerLeave,\n              whenMouse((event) => contentContext.onItemLeave(event))\n            )}\n            onFocus={composeEventHandlers(props.onFocus, () => setIsFocused(true))}\n            onBlur={composeEventHandlers(props.onBlur, () => setIsFocused(false))}\n          />\n        </RovingFocusGroup.Item>\n      </Collection.ItemSlot>\n    );\n  }\n);\n\n/* -------------------------------------------------------------------------------------------------\n * MenuCheckboxItem\n * -----------------------------------------------------------------------------------------------*/\n\nconst CHECKBOX_ITEM_NAME = 'MenuCheckboxItem';\n\ntype MenuCheckboxItemElement = MenuItemElement;\n\ntype CheckedState = boolean | 'indeterminate';\n\ninterface MenuCheckboxItemProps extends MenuItemProps {\n  checked?: CheckedState;\n  // `onCheckedChange` can never be called with `\"indeterminate\"` from the inside\n  onCheckedChange?: (checked: boolean) => void;\n}\n\nconst MenuCheckboxItem = React.forwardRef<MenuCheckboxItemElement, MenuCheckboxItemProps>(\n  (props: ScopedProps<MenuCheckboxItemProps>, forwardedRef) => {\n    const { checked = false, onCheckedChange, ...checkboxItemProps } = props;\n    return (\n      <ItemIndicatorProvider scope={props.__scopeMenu} checked={checked}>\n        <MenuItem\n          role=\"menuitemcheckbox\"\n          aria-checked={isIndeterminate(checked) ? 'mixed' : checked}\n          {...checkboxItemProps}\n          ref={forwardedRef}\n          data-state={getCheckedState(checked)}\n          onSelect={composeEventHandlers(\n            checkboxItemProps.onSelect,\n            () => onCheckedChange?.(isIndeterminate(checked) ? true : !checked),\n            { checkForDefaultPrevented: false }\n          )}\n        />\n      </ItemIndicatorProvider>\n    );\n  }\n);\n\nMenuCheckboxItem.displayName = CHECKBOX_ITEM_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * MenuRadioGroup\n * -----------------------------------------------------------------------------------------------*/\n\nconst RADIO_GROUP_NAME = 'MenuRadioGroup';\n\nconst [RadioGroupProvider, useRadioGroupContext] = createMenuContext<MenuRadioGroupProps>(\n  RADIO_GROUP_NAME,\n  { value: undefined, onValueChange: () => {} }\n);\n\ntype MenuRadioGroupElement = React.ElementRef<typeof MenuGroup>;\ninterface MenuRadioGroupProps extends MenuGroupProps {\n  value?: string;\n  onValueChange?: (value: string) => void;\n}\n\nconst MenuRadioGroup = React.forwardRef<MenuRadioGroupElement, MenuRadioGroupProps>(\n  (props: ScopedProps<MenuRadioGroupProps>, forwardedRef) => {\n    const { value, onValueChange, ...groupProps } = props;\n    const handleValueChange = useCallbackRef(onValueChange);\n    return (\n      <RadioGroupProvider scope={props.__scopeMenu} value={value} onValueChange={handleValueChange}>\n        <MenuGroup {...groupProps} ref={forwardedRef} />\n      </RadioGroupProvider>\n    );\n  }\n);\n\nMenuRadioGroup.displayName = RADIO_GROUP_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * MenuRadioItem\n * -----------------------------------------------------------------------------------------------*/\n\nconst RADIO_ITEM_NAME = 'MenuRadioItem';\n\ntype MenuRadioItemElement = React.ElementRef<typeof MenuItem>;\ninterface MenuRadioItemProps extends MenuItemProps {\n  value: string;\n}\n\nconst MenuRadioItem = React.forwardRef<MenuRadioItemElement, MenuRadioItemProps>(\n  (props: ScopedProps<MenuRadioItemProps>, forwardedRef) => {\n    const { value, ...radioItemProps } = props;\n    const context = useRadioGroupContext(RADIO_ITEM_NAME, props.__scopeMenu);\n    const checked = value === context.value;\n    return (\n      <ItemIndicatorProvider scope={props.__scopeMenu} checked={checked}>\n        <MenuItem\n          role=\"menuitemradio\"\n          aria-checked={checked}\n          {...radioItemProps}\n          ref={forwardedRef}\n          data-state={getCheckedState(checked)}\n          onSelect={composeEventHandlers(\n            radioItemProps.onSelect,\n            () => context.onValueChange?.(value),\n            { checkForDefaultPrevented: false }\n          )}\n        />\n      </ItemIndicatorProvider>\n    );\n  }\n);\n\nMenuRadioItem.displayName = RADIO_ITEM_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * MenuItemIndicator\n * -----------------------------------------------------------------------------------------------*/\n\nconst ITEM_INDICATOR_NAME = 'MenuItemIndicator';\n\ntype CheckboxContextValue = { checked: CheckedState };\n\nconst [ItemIndicatorProvider, useItemIndicatorContext] = createMenuContext<CheckboxContextValue>(\n  ITEM_INDICATOR_NAME,\n  { checked: false }\n);\n\ntype MenuItemIndicatorElement = React.ElementRef<typeof Primitive.span>;\ntype PrimitiveSpanProps = Radix.ComponentPropsWithoutRef<typeof Primitive.span>;\ninterface MenuItemIndicatorProps extends PrimitiveSpanProps {\n  /**\n   * Used to force mounting when more control is needed. Useful when\n   * controlling animation with React animation libraries.\n   */\n  forceMount?: true;\n}\n\nconst MenuItemIndicator = React.forwardRef<MenuItemIndicatorElement, MenuItemIndicatorProps>(\n  (props: ScopedProps<MenuItemIndicatorProps>, forwardedRef) => {\n    const { __scopeMenu, forceMount, ...itemIndicatorProps } = props;\n    const indicatorContext = useItemIndicatorContext(ITEM_INDICATOR_NAME, __scopeMenu);\n    return (\n      <Presence\n        present={\n          forceMount ||\n          isIndeterminate(indicatorContext.checked) ||\n          indicatorContext.checked === true\n        }\n      >\n        <Primitive.span\n          {...itemIndicatorProps}\n          ref={forwardedRef}\n          data-state={getCheckedState(indicatorContext.checked)}\n        />\n      </Presence>\n    );\n  }\n);\n\nMenuItemIndicator.displayName = ITEM_INDICATOR_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * MenuSeparator\n * -----------------------------------------------------------------------------------------------*/\n\nconst SEPARATOR_NAME = 'MenuSeparator';\n\ntype MenuSeparatorElement = React.ElementRef<typeof Primitive.div>;\ninterface MenuSeparatorProps extends PrimitiveDivProps {}\n\nconst MenuSeparator = React.forwardRef<MenuSeparatorElement, MenuSeparatorProps>(\n  (props: ScopedProps<MenuSeparatorProps>, forwardedRef) => {\n    const { __scopeMenu, ...separatorProps } = props;\n    return (\n      <Primitive.div\n        role=\"separator\"\n        aria-orientation=\"horizontal\"\n        {...separatorProps}\n        ref={forwardedRef}\n      />\n    );\n  }\n);\n\nMenuSeparator.displayName = SEPARATOR_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * MenuArrow\n * -----------------------------------------------------------------------------------------------*/\n\nconst ARROW_NAME = 'MenuArrow';\n\ntype MenuArrowElement = React.ElementRef<typeof PopperPrimitive.Arrow>;\ntype PopperArrowProps = Radix.ComponentPropsWithoutRef<typeof PopperPrimitive.Arrow>;\ninterface MenuArrowProps extends PopperArrowProps {}\n\nconst MenuArrow = React.forwardRef<MenuArrowElement, MenuArrowProps>(\n  (props: ScopedProps<MenuArrowProps>, forwardedRef) => {\n    const { __scopeMenu, ...arrowProps } = props;\n    const popperScope = usePopperScope(__scopeMenu);\n    return <PopperPrimitive.Arrow {...popperScope} {...arrowProps} ref={forwardedRef} />;\n  }\n);\n\nMenuArrow.displayName = ARROW_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * MenuSub\n * -----------------------------------------------------------------------------------------------*/\n\nconst SUB_NAME = 'MenuSub';\n\ntype MenuSubContextValue = {\n  contentId: string;\n  triggerId: string;\n  trigger: MenuSubTriggerElement | null;\n  onTriggerChange(trigger: MenuSubTriggerElement | null): void;\n};\n\nconst [MenuSubProvider, useMenuSubContext] = createMenuContext<MenuSubContextValue>(SUB_NAME);\n\ninterface MenuSubProps {\n  children?: React.ReactNode;\n  open?: boolean;\n  onOpenChange?(open: boolean): void;\n}\n\nconst MenuSub: React.FC<MenuSubProps> = (props: ScopedProps<MenuSubProps>) => {\n  const { __scopeMenu, children, open = false, onOpenChange } = props;\n  const parentMenuContext = useMenuContext(SUB_NAME, __scopeMenu);\n  const popperScope = usePopperScope(__scopeMenu);\n  const [trigger, setTrigger] = React.useState<MenuSubTriggerElement | null>(null);\n  const [content, setContent] = React.useState<MenuContentElement | null>(null);\n  const handleOpenChange = useCallbackRef(onOpenChange);\n\n  // Prevent the parent menu from reopening with open submenus.\n  React.useEffect(() => {\n    if (parentMenuContext.open === false) handleOpenChange(false);\n    return () => handleOpenChange(false);\n  }, [parentMenuContext.open, handleOpenChange]);\n\n  return (\n    <PopperPrimitive.Root {...popperScope}>\n      <MenuProvider\n        scope={__scopeMenu}\n        open={open}\n        onOpenChange={handleOpenChange}\n        content={content}\n        onContentChange={setContent}\n      >\n        <MenuSubProvider\n          scope={__scopeMenu}\n          contentId={useId()}\n          triggerId={useId()}\n          trigger={trigger}\n          onTriggerChange={setTrigger}\n        >\n          {children}\n        </MenuSubProvider>\n      </MenuProvider>\n    </PopperPrimitive.Root>\n  );\n};\n\nMenuSub.displayName = SUB_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * MenuSubTrigger\n * -----------------------------------------------------------------------------------------------*/\n\nconst SUB_TRIGGER_NAME = 'MenuSubTrigger';\n\ntype MenuSubTriggerElement = MenuItemImplElement;\ninterface MenuSubTriggerProps extends MenuItemImplProps {}\n\nconst MenuSubTrigger = React.forwardRef<MenuSubTriggerElement, MenuSubTriggerProps>(\n  (props: ScopedProps<MenuSubTriggerProps>, forwardedRef) => {\n    const context = useMenuContext(SUB_TRIGGER_NAME, props.__scopeMenu);\n    const rootContext = useMenuRootContext(SUB_TRIGGER_NAME, props.__scopeMenu);\n    const subContext = useMenuSubContext(SUB_TRIGGER_NAME, props.__scopeMenu);\n    const contentContext = useMenuContentContext(SUB_TRIGGER_NAME, props.__scopeMenu);\n    const openTimerRef = React.useRef<number | null>(null);\n    const { pointerGraceTimerRef, onPointerGraceIntentChange } = contentContext;\n    const scope = { __scopeMenu: props.__scopeMenu };\n\n    const clearOpenTimer = React.useCallback(() => {\n      if (openTimerRef.current) window.clearTimeout(openTimerRef.current);\n      openTimerRef.current = null;\n    }, []);\n\n    React.useEffect(() => clearOpenTimer, [clearOpenTimer]);\n\n    React.useEffect(() => {\n      const pointerGraceTimer = pointerGraceTimerRef.current;\n      return () => {\n        window.clearTimeout(pointerGraceTimer);\n        onPointerGraceIntentChange(null);\n      };\n    }, [pointerGraceTimerRef, onPointerGraceIntentChange]);\n\n    return (\n      <MenuAnchor asChild {...scope}>\n        <MenuItemImpl\n          id={subContext.triggerId}\n          aria-haspopup=\"menu\"\n          aria-expanded={context.open}\n          aria-controls={subContext.contentId}\n          data-state={getOpenState(context.open)}\n          {...props}\n          ref={composeRefs(forwardedRef, subContext.onTriggerChange)}\n          // This is redundant for mouse users but we cannot determine pointer type from\n          // click event and we cannot use pointerup event (see git history for reasons why)\n          onClick={(event) => {\n            props.onClick?.(event);\n            if (props.disabled || event.defaultPrevented) return;\n            /**\n             * We manually focus because iOS Safari doesn't always focus on click (e.g. buttons)\n             * and we rely heavily on `onFocusOutside` for submenus to close when switching\n             * between separate submenus.\n             */\n            event.currentTarget.focus();\n            if (!context.open) context.onOpenChange(true);\n          }}\n          onPointerMove={composeEventHandlers(\n            props.onPointerMove,\n            whenMouse((event) => {\n              contentContext.onItemEnter(event);\n              if (event.defaultPrevented) return;\n              if (!props.disabled && !context.open && !openTimerRef.current) {\n                contentContext.onPointerGraceIntentChange(null);\n                openTimerRef.current = window.setTimeout(() => {\n                  context.onOpenChange(true);\n                  clearOpenTimer();\n                }, 100);\n              }\n            })\n          )}\n          onPointerLeave={composeEventHandlers(\n            props.onPointerLeave,\n            whenMouse((event) => {\n              clearOpenTimer();\n\n              const contentRect = context.content?.getBoundingClientRect();\n              if (contentRect) {\n                // TODO: make sure to update this when we change positioning logic\n                const side = context.content?.dataset.side as Side;\n                const rightSide = side === 'right';\n                const bleed = rightSide ? -5 : +5;\n                const contentNearEdge = contentRect[rightSide ? 'left' : 'right'];\n                const contentFarEdge = contentRect[rightSide ? 'right' : 'left'];\n\n                contentContext.onPointerGraceIntentChange({\n                  area: [\n                    // Apply a bleed on clientX to ensure that our exit point is\n                    // consistently within polygon bounds\n                    { x: event.clientX + bleed, y: event.clientY },\n                    { x: contentNearEdge, y: contentRect.top },\n                    { x: contentFarEdge, y: contentRect.top },\n                    { x: contentFarEdge, y: contentRect.bottom },\n                    { x: contentNearEdge, y: contentRect.bottom },\n                  ],\n                  side,\n                });\n\n                window.clearTimeout(pointerGraceTimerRef.current);\n                pointerGraceTimerRef.current = window.setTimeout(\n                  () => contentContext.onPointerGraceIntentChange(null),\n                  300\n                );\n              } else {\n                contentContext.onTriggerLeave(event);\n                if (event.defaultPrevented) return;\n\n                // There's 100ms where the user may leave an item before the submenu was opened.\n                contentContext.onPointerGraceIntentChange(null);\n              }\n            })\n          )}\n          onKeyDown={composeEventHandlers(props.onKeyDown, (event) => {\n            const isTypingAhead = contentContext.searchRef.current !== '';\n            if (props.disabled || (isTypingAhead && event.key === ' ')) return;\n            if (SUB_OPEN_KEYS[rootContext.dir].includes(event.key)) {\n              context.onOpenChange(true);\n              // The trigger may hold focus if opened via pointer interaction\n              // so we ensure content is given focus again when switching to keyboard.\n              context.content?.focus();\n              // prevent window from scrolling\n              event.preventDefault();\n            }\n          })}\n        />\n      </MenuAnchor>\n    );\n  }\n);\n\nMenuSubTrigger.displayName = SUB_TRIGGER_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * MenuSubContent\n * -----------------------------------------------------------------------------------------------*/\n\nconst SUB_CONTENT_NAME = 'MenuSubContent';\n\ntype MenuSubContentElement = MenuContentImplElement;\ninterface MenuSubContentProps\n  extends Omit<\n    MenuContentImplProps,\n    keyof MenuContentImplPrivateProps | 'onCloseAutoFocus' | 'onEntryFocus' | 'side' | 'align'\n  > {\n  /**\n   * Used to force mounting when more control is needed. Useful when\n   * controlling animation with React animation libraries.\n   */\n  forceMount?: true;\n}\n\nconst MenuSubContent = React.forwardRef<MenuSubContentElement, MenuSubContentProps>(\n  (props: ScopedProps<MenuSubContentProps>, forwardedRef) => {\n    const portalContext = usePortalContext(CONTENT_NAME, props.__scopeMenu);\n    const { forceMount = portalContext.forceMount, ...subContentProps } = props;\n    const context = useMenuContext(CONTENT_NAME, props.__scopeMenu);\n    const rootContext = useMenuRootContext(CONTENT_NAME, props.__scopeMenu);\n    const subContext = useMenuSubContext(SUB_CONTENT_NAME, props.__scopeMenu);\n    const ref = React.useRef<MenuSubContentElement>(null);\n    const composedRefs = useComposedRefs(forwardedRef, ref);\n    return (\n      <Collection.Provider scope={props.__scopeMenu}>\n        <Presence present={forceMount || context.open}>\n          <Collection.Slot scope={props.__scopeMenu}>\n            <MenuContentImpl\n              id={subContext.contentId}\n              aria-labelledby={subContext.triggerId}\n              {...subContentProps}\n              ref={composedRefs}\n              align=\"start\"\n              side={rootContext.dir === 'rtl' ? 'left' : 'right'}\n              disableOutsidePointerEvents={false}\n              disableOutsideScroll={false}\n              trapFocus={false}\n              onOpenAutoFocus={(event) => {\n                // when opening a submenu, focus content for keyboard users only\n                if (rootContext.isUsingKeyboardRef.current) ref.current?.focus();\n                event.preventDefault();\n              }}\n              // The menu might close because of focusing another menu item in the parent menu. We\n              // don't want it to refocus the trigger in that case so we handle trigger focus ourselves.\n              onCloseAutoFocus={(event) => event.preventDefault()}\n              onFocusOutside={composeEventHandlers(props.onFocusOutside, (event) => {\n                // We prevent closing when the trigger is focused to avoid triggering a re-open animation\n                // on pointer interaction.\n                if (event.target !== subContext.trigger) context.onOpenChange(false);\n              })}\n              onEscapeKeyDown={composeEventHandlers(props.onEscapeKeyDown, (event) => {\n                rootContext.onClose();\n                // ensure pressing escape in submenu doesn't escape full screen mode\n                event.preventDefault();\n              })}\n              onKeyDown={composeEventHandlers(props.onKeyDown, (event) => {\n                // Submenu key events bubble through portals. We only care about keys in this menu.\n                const isKeyDownInside = event.currentTarget.contains(event.target as HTMLElement);\n                const isCloseKey = SUB_CLOSE_KEYS[rootContext.dir].includes(event.key);\n                if (isKeyDownInside && isCloseKey) {\n                  context.onOpenChange(false);\n                  // We focus manually because we prevented it in `onCloseAutoFocus`\n                  subContext.trigger?.focus();\n                  // prevent window from scrolling\n                  event.preventDefault();\n                }\n              })}\n            />\n          </Collection.Slot>\n        </Presence>\n      </Collection.Provider>\n    );\n  }\n);\n\nMenuSubContent.displayName = SUB_CONTENT_NAME;\n\n/* -----------------------------------------------------------------------------------------------*/\n\nfunction getOpenState(open: boolean) {\n  return open ? 'open' : 'closed';\n}\n\nfunction isIndeterminate(checked?: CheckedState): checked is 'indeterminate' {\n  return checked === 'indeterminate';\n}\n\nfunction getCheckedState(checked: CheckedState) {\n  return isIndeterminate(checked) ? 'indeterminate' : checked ? 'checked' : 'unchecked';\n}\n\nfunction focusFirst(candidates: HTMLElement[]) {\n  const PREVIOUSLY_FOCUSED_ELEMENT = document.activeElement;\n  for (const candidate of candidates) {\n    // if focus is already where we want to go, we don't want to keep going through the candidates\n    if (candidate === PREVIOUSLY_FOCUSED_ELEMENT) return;\n    candidate.focus();\n    if (document.activeElement !== PREVIOUSLY_FOCUSED_ELEMENT) return;\n  }\n}\n\n/**\n * Wraps an array around itself at a given start index\n * Example: `wrapArray(['a', 'b', 'c', 'd'], 2) === ['c', 'd', 'a', 'b']`\n */\nfunction wrapArray<T>(array: T[], startIndex: number) {\n  return array.map((_, index) => array[(startIndex + index) % array.length]);\n}\n\n/**\n * This is the \"meat\" of the typeahead matching logic. It takes in all the values,\n * the search and the current match, and returns the next match (or `undefined`).\n *\n * We normalize the search because if a user has repeatedly pressed a character,\n * we want the exact same behavior as if we only had that one character\n * (ie. cycle through options starting with that character)\n *\n * We also reorder the values by wrapping the array around the current match.\n * This is so we always look forward from the current match, and picking the first\n * match will always be the correct one.\n *\n * Finally, if the normalized search is exactly one character, we exclude the\n * current match from the values because otherwise it would be the first to match always\n * and focus would never move. This is as opposed to the regular case, where we\n * don't want focus to move if the current match still matches.\n */\nfunction getNextMatch(values: string[], search: string, currentMatch?: string) {\n  const isRepeated = search.length > 1 && Array.from(search).every((char) => char === search[0]);\n  const normalizedSearch = isRepeated ? search[0] : search;\n  const currentMatchIndex = currentMatch ? values.indexOf(currentMatch) : -1;\n  let wrappedValues = wrapArray(values, Math.max(currentMatchIndex, 0));\n  const excludeCurrentMatch = normalizedSearch.length === 1;\n  if (excludeCurrentMatch) wrappedValues = wrappedValues.filter((v) => v !== currentMatch);\n  const nextMatch = wrappedValues.find((value) =>\n    value.toLowerCase().startsWith(normalizedSearch.toLowerCase())\n  );\n  return nextMatch !== currentMatch ? nextMatch : undefined;\n}\n\ntype Point = { x: number; y: number };\ntype Polygon = Point[];\ntype Side = 'left' | 'right';\ntype GraceIntent = { area: Polygon; side: Side };\n\n// Determine if a point is inside of a polygon.\n// Based on https://github.com/substack/point-in-polygon\nfunction isPointInPolygon(point: Point, polygon: Polygon) {\n  const { x, y } = point;\n  let inside = false;\n  for (let i = 0, j = polygon.length - 1; i < polygon.length; j = i++) {\n    const xi = polygon[i].x;\n    const yi = polygon[i].y;\n    const xj = polygon[j].x;\n    const yj = polygon[j].y;\n\n    // prettier-ignore\n    const intersect = ((yi > y) !== (yj > y)) && (x < (xj - xi) * (y - yi) / (yj - yi) + xi);\n    if (intersect) inside = !inside;\n  }\n\n  return inside;\n}\n\nfunction isPointerInGraceArea(event: React.PointerEvent, area?: Polygon) {\n  if (!area) return false;\n  const cursorPos = { x: event.clientX, y: event.clientY };\n  return isPointInPolygon(cursorPos, area);\n}\n\nfunction whenMouse<E>(handler: React.PointerEventHandler<E>): React.PointerEventHandler<E> {\n  return (event) => (event.pointerType === 'mouse' ? handler(event) : undefined);\n}\n\nconst Root = Menu;\nconst Anchor = MenuAnchor;\nconst Portal = MenuPortal;\nconst Content = MenuContent;\nconst Group = MenuGroup;\nconst Label = MenuLabel;\nconst Item = MenuItem;\nconst CheckboxItem = MenuCheckboxItem;\nconst RadioGroup = MenuRadioGroup;\nconst RadioItem = MenuRadioItem;\nconst ItemIndicator = MenuItemIndicator;\nconst Separator = MenuSeparator;\nconst Arrow = MenuArrow;\nconst Sub = MenuSub;\nconst SubTrigger = MenuSubTrigger;\nconst SubContent = MenuSubContent;\n\nexport {\n  createMenuScope,\n  //\n  Menu,\n  MenuAnchor,\n  MenuPortal,\n  MenuContent,\n  MenuGroup,\n  MenuLabel,\n  MenuItem,\n  MenuCheckboxItem,\n  MenuRadioGroup,\n  MenuRadioItem,\n  MenuItemIndicator,\n  MenuSeparator,\n  MenuArrow,\n  MenuSub,\n  MenuSubTrigger,\n  MenuSubContent,\n  //\n  Root,\n  Anchor,\n  Portal,\n  Content,\n  Group,\n  Label,\n  Item,\n  CheckboxItem,\n  RadioGroup,\n  RadioItem,\n  ItemIndicator,\n  Separator,\n  Arrow,\n  Sub,\n  SubTrigger,\n  SubContent,\n};\nexport type {\n  MenuProps,\n  MenuAnchorProps,\n  MenuPortalProps,\n  MenuContentProps,\n  MenuGroupProps,\n  MenuLabelProps,\n  MenuItemProps,\n  MenuCheckboxItemProps,\n  MenuRadioGroupProps,\n  MenuRadioItemProps,\n  MenuItemIndicatorProps,\n  MenuSeparatorProps,\n  MenuArrowProps,\n  MenuSubProps,\n  MenuSubTriggerProps,\n  MenuSubContentProps,\n};\n","import * as React from 'react';\nimport { composeEventHandlers } from '@radix-ui/primitive';\nimport { createContextScope } from '@radix-ui/react-context';\nimport { Primitive } from '@radix-ui/react-primitive';\nimport * as MenuPrimitive from '@radix-ui/react-menu';\nimport { createMenuScope } from '@radix-ui/react-menu';\nimport { useCallbackRef } from '@radix-ui/react-use-callback-ref';\nimport { useControllableState } from '@radix-ui/react-use-controllable-state';\n\nimport type * as Radix from '@radix-ui/react-primitive';\nimport type { Scope } from '@radix-ui/react-context';\n\ntype Direction = 'ltr' | 'rtl';\ntype Point = { x: number; y: number };\n\n/* -------------------------------------------------------------------------------------------------\n * ContextMenu\n * -----------------------------------------------------------------------------------------------*/\n\nconst CONTEXT_MENU_NAME = 'ContextMenu';\n\ntype ScopedProps<P> = P & { __scopeContextMenu?: Scope };\nconst [createContextMenuContext, createContextMenuScope] = createContextScope(CONTEXT_MENU_NAME, [\n  createMenuScope,\n]);\nconst useMenuScope = createMenuScope();\n\ntype ContextMenuContextValue = {\n  open: boolean;\n  onOpenChange(open: boolean): void;\n  modal: boolean;\n};\n\nconst [ContextMenuProvider, useContextMenuContext] =\n  createContextMenuContext<ContextMenuContextValue>(CONTEXT_MENU_NAME);\n\ninterface ContextMenuProps {\n  children?: React.ReactNode;\n  onOpenChange?(open: boolean): void;\n  dir?: Direction;\n  modal?: boolean;\n}\n\nconst ContextMenu: React.FC<ContextMenuProps> = (props: ScopedProps<ContextMenuProps>) => {\n  const { __scopeContextMenu, children, onOpenChange, dir, modal = true } = props;\n  const [open, setOpen] = React.useState(false);\n  const menuScope = useMenuScope(__scopeContextMenu);\n  const handleOpenChangeProp = useCallbackRef(onOpenChange);\n\n  const handleOpenChange = React.useCallback(\n    (open: boolean) => {\n      setOpen(open);\n      handleOpenChangeProp(open);\n    },\n    [handleOpenChangeProp]\n  );\n\n  return (\n    <ContextMenuProvider\n      scope={__scopeContextMenu}\n      open={open}\n      onOpenChange={handleOpenChange}\n      modal={modal}\n    >\n      <MenuPrimitive.Root\n        {...menuScope}\n        dir={dir}\n        open={open}\n        onOpenChange={handleOpenChange}\n        modal={modal}\n      >\n        {children}\n      </MenuPrimitive.Root>\n    </ContextMenuProvider>\n  );\n};\n\nContextMenu.displayName = CONTEXT_MENU_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * ContextMenuTrigger\n * -----------------------------------------------------------------------------------------------*/\n\nconst TRIGGER_NAME = 'ContextMenuTrigger';\n\ntype ContextMenuTriggerElement = React.ElementRef<typeof Primitive.span>;\ntype PrimitiveSpanProps = Radix.ComponentPropsWithoutRef<typeof Primitive.span>;\ninterface ContextMenuTriggerProps extends PrimitiveSpanProps {\n  disabled?: boolean;\n}\n\nconst ContextMenuTrigger = React.forwardRef<ContextMenuTriggerElement, ContextMenuTriggerProps>(\n  (props: ScopedProps<ContextMenuTriggerProps>, forwardedRef) => {\n    const { __scopeContextMenu, disabled = false, ...triggerProps } = props;\n    const context = useContextMenuContext(TRIGGER_NAME, __scopeContextMenu);\n    const menuScope = useMenuScope(__scopeContextMenu);\n    const pointRef = React.useRef<Point>({ x: 0, y: 0 });\n    const virtualRef = React.useRef({\n      getBoundingClientRect: () => DOMRect.fromRect({ width: 0, height: 0, ...pointRef.current }),\n    });\n    const longPressTimerRef = React.useRef(0);\n    const clearLongPress = React.useCallback(\n      () => window.clearTimeout(longPressTimerRef.current),\n      []\n    );\n    const handleOpen = (event: React.MouseEvent | React.PointerEvent) => {\n      pointRef.current = { x: event.clientX, y: event.clientY };\n      context.onOpenChange(true);\n    };\n\n    React.useEffect(() => clearLongPress, [clearLongPress]);\n    React.useEffect(() => void (disabled && clearLongPress()), [disabled, clearLongPress]);\n\n    return (\n      <>\n        <MenuPrimitive.Anchor {...menuScope} virtualRef={virtualRef} />\n        <Primitive.span\n          data-state={context.open ? 'open' : 'closed'}\n          data-disabled={disabled ? '' : undefined}\n          {...triggerProps}\n          ref={forwardedRef}\n          // prevent iOS context menu from appearing\n          style={{ WebkitTouchCallout: 'none', ...props.style }}\n          // if trigger is disabled, enable the native Context Menu\n          onContextMenu={\n            disabled\n              ? props.onContextMenu\n              : composeEventHandlers(props.onContextMenu, (event) => {\n                  // clearing the long press here because some platforms already support\n                  // long press to trigger a `contextmenu` event\n                  clearLongPress();\n                  handleOpen(event);\n                  event.preventDefault();\n                })\n          }\n          onPointerDown={\n            disabled\n              ? props.onPointerDown\n              : composeEventHandlers(\n                  props.onPointerDown,\n                  whenTouchOrPen((event) => {\n                    // clear the long press here in case there's multiple touch points\n                    clearLongPress();\n                    longPressTimerRef.current = window.setTimeout(() => handleOpen(event), 700);\n                  })\n                )\n          }\n          onPointerMove={\n            disabled\n              ? props.onPointerMove\n              : composeEventHandlers(props.onPointerMove, whenTouchOrPen(clearLongPress))\n          }\n          onPointerCancel={\n            disabled\n              ? props.onPointerCancel\n              : composeEventHandlers(props.onPointerCancel, whenTouchOrPen(clearLongPress))\n          }\n          onPointerUp={\n            disabled\n              ? props.onPointerUp\n              : composeEventHandlers(props.onPointerUp, whenTouchOrPen(clearLongPress))\n          }\n        />\n      </>\n    );\n  }\n);\n\nContextMenuTrigger.displayName = TRIGGER_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * ContextMenuPortal\n * -----------------------------------------------------------------------------------------------*/\n\nconst PORTAL_NAME = 'ContextMenuPortal';\n\ntype MenuPortalProps = React.ComponentPropsWithoutRef<typeof MenuPrimitive.Portal>;\ninterface ContextMenuPortalProps extends MenuPortalProps {}\n\nconst ContextMenuPortal: React.FC<ContextMenuPortalProps> = (\n  props: ScopedProps<ContextMenuPortalProps>\n) => {\n  const { __scopeContextMenu, ...portalProps } = props;\n  const menuScope = useMenuScope(__scopeContextMenu);\n  return <MenuPrimitive.Portal {...menuScope} {...portalProps} />;\n};\n\nContextMenuPortal.displayName = PORTAL_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * ContextMenuContent\n * -----------------------------------------------------------------------------------------------*/\n\nconst CONTENT_NAME = 'ContextMenuContent';\n\ntype ContextMenuContentElement = React.ElementRef<typeof MenuPrimitive.Content>;\ntype MenuContentProps = Radix.ComponentPropsWithoutRef<typeof MenuPrimitive.Content>;\ninterface ContextMenuContentProps\n  extends Omit<MenuContentProps, 'onEntryFocus' | 'side' | 'sideOffset' | 'align'> {}\n\nconst ContextMenuContent = React.forwardRef<ContextMenuContentElement, ContextMenuContentProps>(\n  (props: ScopedProps<ContextMenuContentProps>, forwardedRef) => {\n    const { __scopeContextMenu, ...contentProps } = props;\n    const context = useContextMenuContext(CONTENT_NAME, __scopeContextMenu);\n    const menuScope = useMenuScope(__scopeContextMenu);\n    const hasInteractedOutsideRef = React.useRef(false);\n\n    return (\n      <MenuPrimitive.Content\n        {...menuScope}\n        {...contentProps}\n        ref={forwardedRef}\n        side=\"right\"\n        sideOffset={2}\n        align=\"start\"\n        onCloseAutoFocus={(event) => {\n          props.onCloseAutoFocus?.(event);\n\n          if (!event.defaultPrevented && hasInteractedOutsideRef.current) {\n            event.preventDefault();\n          }\n\n          hasInteractedOutsideRef.current = false;\n        }}\n        onInteractOutside={(event) => {\n          props.onInteractOutside?.(event);\n\n          if (!event.defaultPrevented && !context.modal) hasInteractedOutsideRef.current = true;\n        }}\n        style={{\n          ...props.style,\n          // re-namespace exposed content custom properties\n          ...{\n            '--radix-context-menu-content-transform-origin': 'var(--radix-popper-transform-origin)',\n            '--radix-context-menu-content-available-width': 'var(--radix-popper-available-width)',\n            '--radix-context-menu-content-available-height': 'var(--radix-popper-available-height)',\n            '--radix-context-menu-trigger-width': 'var(--radix-popper-anchor-width)',\n            '--radix-context-menu-trigger-height': 'var(--radix-popper-anchor-height)',\n          },\n        }}\n      />\n    );\n  }\n);\n\nContextMenuContent.displayName = CONTENT_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * ContextMenuGroup\n * -----------------------------------------------------------------------------------------------*/\n\nconst GROUP_NAME = 'ContextMenuGroup';\n\ntype ContextMenuGroupElement = React.ElementRef<typeof MenuPrimitive.Group>;\ntype MenuGroupProps = Radix.ComponentPropsWithoutRef<typeof MenuPrimitive.Group>;\ninterface ContextMenuGroupProps extends MenuGroupProps {}\n\nconst ContextMenuGroup = React.forwardRef<ContextMenuGroupElement, ContextMenuGroupProps>(\n  (props: ScopedProps<ContextMenuGroupProps>, forwardedRef) => {\n    const { __scopeContextMenu, ...groupProps } = props;\n    const menuScope = useMenuScope(__scopeContextMenu);\n    return <MenuPrimitive.Group {...menuScope} {...groupProps} ref={forwardedRef} />;\n  }\n);\n\nContextMenuGroup.displayName = GROUP_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * ContextMenuLabel\n * -----------------------------------------------------------------------------------------------*/\n\nconst LABEL_NAME = 'ContextMenuLabel';\n\ntype ContextMenuLabelElement = React.ElementRef<typeof MenuPrimitive.Label>;\ntype MenuLabelProps = Radix.ComponentPropsWithoutRef<typeof MenuPrimitive.Label>;\ninterface ContextMenuLabelProps extends MenuLabelProps {}\n\nconst ContextMenuLabel = React.forwardRef<ContextMenuLabelElement, ContextMenuLabelProps>(\n  (props: ScopedProps<ContextMenuLabelProps>, forwardedRef) => {\n    const { __scopeContextMenu, ...labelProps } = props;\n    const menuScope = useMenuScope(__scopeContextMenu);\n    return <MenuPrimitive.Label {...menuScope} {...labelProps} ref={forwardedRef} />;\n  }\n);\n\nContextMenuLabel.displayName = LABEL_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * ContextMenuItem\n * -----------------------------------------------------------------------------------------------*/\n\nconst ITEM_NAME = 'ContextMenuItem';\n\ntype ContextMenuItemElement = React.ElementRef<typeof MenuPrimitive.Item>;\ntype MenuItemProps = Radix.ComponentPropsWithoutRef<typeof MenuPrimitive.Item>;\ninterface ContextMenuItemProps extends MenuItemProps {}\n\nconst ContextMenuItem = React.forwardRef<ContextMenuItemElement, ContextMenuItemProps>(\n  (props: ScopedProps<ContextMenuItemProps>, forwardedRef) => {\n    const { __scopeContextMenu, ...itemProps } = props;\n    const menuScope = useMenuScope(__scopeContextMenu);\n    return <MenuPrimitive.Item {...menuScope} {...itemProps} ref={forwardedRef} />;\n  }\n);\n\nContextMenuItem.displayName = ITEM_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * ContextMenuCheckboxItem\n * -----------------------------------------------------------------------------------------------*/\n\nconst CHECKBOX_ITEM_NAME = 'ContextMenuCheckboxItem';\n\ntype ContextMenuCheckboxItemElement = React.ElementRef<typeof MenuPrimitive.CheckboxItem>;\ntype MenuCheckboxItemProps = Radix.ComponentPropsWithoutRef<typeof MenuPrimitive.CheckboxItem>;\ninterface ContextMenuCheckboxItemProps extends MenuCheckboxItemProps {}\n\nconst ContextMenuCheckboxItem = React.forwardRef<\n  ContextMenuCheckboxItemElement,\n  ContextMenuCheckboxItemProps\n>((props: ScopedProps<ContextMenuCheckboxItemProps>, forwardedRef) => {\n  const { __scopeContextMenu, ...checkboxItemProps } = props;\n  const menuScope = useMenuScope(__scopeContextMenu);\n  return <MenuPrimitive.CheckboxItem {...menuScope} {...checkboxItemProps} ref={forwardedRef} />;\n});\n\nContextMenuCheckboxItem.displayName = CHECKBOX_ITEM_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * ContextMenuRadioGroup\n * -----------------------------------------------------------------------------------------------*/\n\nconst RADIO_GROUP_NAME = 'ContextMenuRadioGroup';\n\ntype ContextMenuRadioGroupElement = React.ElementRef<typeof MenuPrimitive.RadioGroup>;\ntype MenuRadioGroupProps = Radix.ComponentPropsWithoutRef<typeof MenuPrimitive.RadioGroup>;\ninterface ContextMenuRadioGroupProps extends MenuRadioGroupProps {}\n\nconst ContextMenuRadioGroup = React.forwardRef<\n  ContextMenuRadioGroupElement,\n  ContextMenuRadioGroupProps\n>((props: ScopedProps<ContextMenuRadioGroupProps>, forwardedRef) => {\n  const { __scopeContextMenu, ...radioGroupProps } = props;\n  const menuScope = useMenuScope(__scopeContextMenu);\n  return <MenuPrimitive.RadioGroup {...menuScope} {...radioGroupProps} ref={forwardedRef} />;\n});\n\nContextMenuRadioGroup.displayName = RADIO_GROUP_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * ContextMenuRadioItem\n * -----------------------------------------------------------------------------------------------*/\n\nconst RADIO_ITEM_NAME = 'ContextMenuRadioItem';\n\ntype ContextMenuRadioItemElement = React.ElementRef<typeof MenuPrimitive.RadioItem>;\ntype MenuRadioItemProps = Radix.ComponentPropsWithoutRef<typeof MenuPrimitive.RadioItem>;\ninterface ContextMenuRadioItemProps extends MenuRadioItemProps {}\n\nconst ContextMenuRadioItem = React.forwardRef<\n  ContextMenuRadioItemElement,\n  ContextMenuRadioItemProps\n>((props: ScopedProps<ContextMenuRadioItemProps>, forwardedRef) => {\n  const { __scopeContextMenu, ...radioItemProps } = props;\n  const menuScope = useMenuScope(__scopeContextMenu);\n  return <MenuPrimitive.RadioItem {...menuScope} {...radioItemProps} ref={forwardedRef} />;\n});\n\nContextMenuRadioItem.displayName = RADIO_ITEM_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * ContextMenuItemIndicator\n * -----------------------------------------------------------------------------------------------*/\n\nconst INDICATOR_NAME = 'ContextMenuItemIndicator';\n\ntype ContextMenuItemIndicatorElement = React.ElementRef<typeof MenuPrimitive.ItemIndicator>;\ntype MenuItemIndicatorProps = Radix.ComponentPropsWithoutRef<typeof MenuPrimitive.ItemIndicator>;\ninterface ContextMenuItemIndicatorProps extends MenuItemIndicatorProps {}\n\nconst ContextMenuItemIndicator = React.forwardRef<\n  ContextMenuItemIndicatorElement,\n  ContextMenuItemIndicatorProps\n>((props: ScopedProps<ContextMenuItemIndicatorProps>, forwardedRef) => {\n  const { __scopeContextMenu, ...itemIndicatorProps } = props;\n  const menuScope = useMenuScope(__scopeContextMenu);\n  return <MenuPrimitive.ItemIndicator {...menuScope} {...itemIndicatorProps} ref={forwardedRef} />;\n});\n\nContextMenuItemIndicator.displayName = INDICATOR_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * ContextMenuSeparator\n * -----------------------------------------------------------------------------------------------*/\n\nconst SEPARATOR_NAME = 'ContextMenuSeparator';\n\ntype ContextMenuSeparatorElement = React.ElementRef<typeof MenuPrimitive.Separator>;\ntype MenuSeparatorProps = Radix.ComponentPropsWithoutRef<typeof MenuPrimitive.Separator>;\ninterface ContextMenuSeparatorProps extends MenuSeparatorProps {}\n\nconst ContextMenuSeparator = React.forwardRef<\n  ContextMenuSeparatorElement,\n  ContextMenuSeparatorProps\n>((props: ScopedProps<ContextMenuSeparatorProps>, forwardedRef) => {\n  const { __scopeContextMenu, ...separatorProps } = props;\n  const menuScope = useMenuScope(__scopeContextMenu);\n  return <MenuPrimitive.Separator {...menuScope} {...separatorProps} ref={forwardedRef} />;\n});\n\nContextMenuSeparator.displayName = SEPARATOR_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * ContextMenuArrow\n * -----------------------------------------------------------------------------------------------*/\n\nconst ARROW_NAME = 'ContextMenuArrow';\n\ntype ContextMenuArrowElement = React.ElementRef<typeof MenuPrimitive.Arrow>;\ntype MenuArrowProps = Radix.ComponentPropsWithoutRef<typeof MenuPrimitive.Arrow>;\ninterface ContextMenuArrowProps extends MenuArrowProps {}\n\nconst ContextMenuArrow = React.forwardRef<ContextMenuArrowElement, ContextMenuArrowProps>(\n  (props: ScopedProps<ContextMenuArrowProps>, forwardedRef) => {\n    const { __scopeContextMenu, ...arrowProps } = props;\n    const menuScope = useMenuScope(__scopeContextMenu);\n    return <MenuPrimitive.Arrow {...menuScope} {...arrowProps} ref={forwardedRef} />;\n  }\n);\n\nContextMenuArrow.displayName = ARROW_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * ContextMenuSub\n * -----------------------------------------------------------------------------------------------*/\n\nconst SUB_NAME = 'ContextMenuSub';\n\ninterface ContextMenuSubProps {\n  children?: React.ReactNode;\n  open?: boolean;\n  defaultOpen?: boolean;\n  onOpenChange?(open: boolean): void;\n}\n\nconst ContextMenuSub: React.FC<ContextMenuSubProps> = (props: ScopedProps<ContextMenuSubProps>) => {\n  const { __scopeContextMenu, children, onOpenChange, open: openProp, defaultOpen } = props;\n  const menuScope = useMenuScope(__scopeContextMenu);\n  const [open, setOpen] = useControllableState({\n    prop: openProp,\n    defaultProp: defaultOpen,\n    onChange: onOpenChange,\n  });\n\n  return (\n    <MenuPrimitive.Sub {...menuScope} open={open} onOpenChange={setOpen}>\n      {children}\n    </MenuPrimitive.Sub>\n  );\n};\n\nContextMenuSub.displayName = SUB_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * ContextMenuSubTrigger\n * -----------------------------------------------------------------------------------------------*/\n\nconst SUB_TRIGGER_NAME = 'ContextMenuSubTrigger';\n\ntype ContextMenuSubTriggerElement = React.ElementRef<typeof MenuPrimitive.SubTrigger>;\ntype MenuSubTriggerProps = Radix.ComponentPropsWithoutRef<typeof MenuPrimitive.SubTrigger>;\ninterface ContextMenuSubTriggerProps extends MenuSubTriggerProps {}\n\nconst ContextMenuSubTrigger = React.forwardRef<\n  ContextMenuSubTriggerElement,\n  ContextMenuSubTriggerProps\n>((props: ScopedProps<ContextMenuSubTriggerProps>, forwardedRef) => {\n  const { __scopeContextMenu, ...triggerItemProps } = props;\n  const menuScope = useMenuScope(__scopeContextMenu);\n  return <MenuPrimitive.SubTrigger {...menuScope} {...triggerItemProps} ref={forwardedRef} />;\n});\n\nContextMenuSubTrigger.displayName = SUB_TRIGGER_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * ContextMenuSubContent\n * -----------------------------------------------------------------------------------------------*/\n\nconst SUB_CONTENT_NAME = 'ContextMenuSubContent';\n\ntype ContextMenuSubContentElement = React.ElementRef<typeof MenuPrimitive.Content>;\ntype MenuSubContentProps = Radix.ComponentPropsWithoutRef<typeof MenuPrimitive.SubContent>;\ninterface ContextMenuSubContentProps extends MenuSubContentProps {}\n\nconst ContextMenuSubContent = React.forwardRef<\n  ContextMenuSubContentElement,\n  ContextMenuSubContentProps\n>((props: ScopedProps<ContextMenuSubContentProps>, forwardedRef) => {\n  const { __scopeContextMenu, ...subContentProps } = props;\n  const menuScope = useMenuScope(__scopeContextMenu);\n\n  return (\n    <MenuPrimitive.SubContent\n      {...menuScope}\n      {...subContentProps}\n      ref={forwardedRef}\n      style={{\n        ...props.style,\n        // re-namespace exposed content custom properties\n        ...{\n          '--radix-context-menu-content-transform-origin': 'var(--radix-popper-transform-origin)',\n          '--radix-context-menu-content-available-width': 'var(--radix-popper-available-width)',\n          '--radix-context-menu-content-available-height': 'var(--radix-popper-available-height)',\n          '--radix-context-menu-trigger-width': 'var(--radix-popper-anchor-width)',\n          '--radix-context-menu-trigger-height': 'var(--radix-popper-anchor-height)',\n        },\n      }}\n    />\n  );\n});\n\nContextMenuSubContent.displayName = SUB_CONTENT_NAME;\n\n/* -----------------------------------------------------------------------------------------------*/\n\nfunction whenTouchOrPen<E>(handler: React.PointerEventHandler<E>): React.PointerEventHandler<E> {\n  return (event) => (event.pointerType !== 'mouse' ? handler(event) : undefined);\n}\n\nconst Root = ContextMenu;\nconst Trigger = ContextMenuTrigger;\nconst Portal = ContextMenuPortal;\nconst Content = ContextMenuContent;\nconst Group = ContextMenuGroup;\nconst Label = ContextMenuLabel;\nconst Item = ContextMenuItem;\nconst CheckboxItem = ContextMenuCheckboxItem;\nconst RadioGroup = ContextMenuRadioGroup;\nconst RadioItem = ContextMenuRadioItem;\nconst ItemIndicator = ContextMenuItemIndicator;\nconst Separator = ContextMenuSeparator;\nconst Arrow = ContextMenuArrow;\nconst Sub = ContextMenuSub;\nconst SubTrigger = ContextMenuSubTrigger;\nconst SubContent = ContextMenuSubContent;\n\nexport {\n  createContextMenuScope,\n  //\n  ContextMenu,\n  ContextMenuTrigger,\n  ContextMenuPortal,\n  ContextMenuContent,\n  ContextMenuGroup,\n  ContextMenuLabel,\n  ContextMenuItem,\n  ContextMenuCheckboxItem,\n  ContextMenuRadioGroup,\n  ContextMenuRadioItem,\n  ContextMenuItemIndicator,\n  ContextMenuSeparator,\n  ContextMenuArrow,\n  ContextMenuSub,\n  ContextMenuSubTrigger,\n  ContextMenuSubContent,\n  //\n  Root,\n  Trigger,\n  Portal,\n  Content,\n  Group,\n  Label,\n  Item,\n  CheckboxItem,\n  RadioGroup,\n  RadioItem,\n  ItemIndicator,\n  Separator,\n  Arrow,\n  Sub,\n  SubTrigger,\n  SubContent,\n};\nexport type {\n  ContextMenuProps,\n  ContextMenuTriggerProps,\n  ContextMenuPortalProps,\n  ContextMenuContentProps,\n  ContextMenuGroupProps,\n  ContextMenuLabelProps,\n  ContextMenuItemProps,\n  ContextMenuCheckboxItemProps,\n  ContextMenuRadioGroupProps,\n  ContextMenuRadioItemProps,\n  ContextMenuItemIndicatorProps,\n  ContextMenuSeparatorProps,\n  ContextMenuArrowProps,\n  ContextMenuSubProps,\n  ContextMenuSubTriggerProps,\n  ContextMenuSubContentProps,\n};\n","import { App, TLArrowShapeDef, useApp } from '@tldraw/editor'\nimport { assert, exhaustiveSwitchError } from '@tldraw/utils'\nimport { useValue } from 'signia-react'\nimport { ActionItem } from './useActions'\nimport { ToolItem } from './useTools'\nimport { TLTranslationKey } from './useTranslation'\n\n/** @public */\nexport type MenuChild = MenuItem | SubMenu | MenuGroup | CustomMenuItem\n\n/** @public */\nexport type CustomMenuItem = {\n\tid: string\n\ttype: 'custom'\n\tdisabled: boolean\n\treadonlyOk: boolean\n}\n\n/** @public */\nexport type MenuItem = {\n\tid: string\n\ttype: 'item'\n\treadonlyOk: boolean\n\tactionItem: ActionItem\n\tdisabled: boolean\n\tchecked: boolean\n}\n\n/** @public */\nexport type MenuGroup = {\n\tid: string\n\ttype: 'group'\n\tcheckbox: boolean\n\tdisabled: boolean\n\treadonlyOk: boolean\n\tchildren: MenuChild[]\n}\n\n/** @public */\nexport type SubMenu = {\n\tid: string\n\ttype: 'submenu'\n\tlabel: TLTranslationKey\n\tdisabled: boolean\n\treadonlyOk: boolean\n\tchildren: MenuChild[]\n}\n\n/** @public */\nexport type MenuSchema = (MenuGroup | MenuItem | CustomMenuItem)[]\n\n/** @public */\nexport function compactMenuItems<T>(arr: T[]): Exclude<T, null | false | undefined>[] {\n\treturn arr.filter((i) => i !== undefined && i !== null && i !== false) as any\n}\n\n/** @public */\nexport function menuGroup(id: string, ...children: (MenuChild | null | false)[]): MenuGroup | null {\n\tconst childItems = compactMenuItems(children)\n\n\tif (childItems.length === 0) return null\n\n\treturn {\n\t\tid,\n\t\ttype: 'group',\n\t\tcheckbox: childItems.every((child) => child.type === 'item' && child.actionItem.checkbox),\n\t\tdisabled: childItems.every((child) => child.disabled),\n\t\treadonlyOk: childItems.some((child) => child.readonlyOk),\n\t\tchildren: childItems,\n\t}\n}\n\n/** @public */\nexport function menuSubmenu(\n\tid: string,\n\tlabel: TLTranslationKey,\n\t...children: (MenuChild | null | false)[]\n): SubMenu | null {\n\tconst childItems = compactMenuItems(children)\n\tif (childItems.length === 0) return null\n\n\treturn {\n\t\tid,\n\t\ttype: 'submenu',\n\t\tlabel,\n\t\tchildren: childItems,\n\t\tdisabled: childItems.every((child) => child.disabled),\n\t\treadonlyOk: childItems.some((child) => child.readonlyOk),\n\t}\n}\n\n/** @public */\nexport function menuCustom(\n\tid: string,\n\topts = {} as Partial<{ readonlyOk: boolean; disabled: boolean }>\n) {\n\tconst { readonlyOk = true, disabled = false } = opts\n\treturn {\n\t\tid,\n\t\ttype: 'custom' as const,\n\t\tdisabled,\n\t\treadonlyOk,\n\t}\n}\n\n/** @public */\nexport function menuItem(\n\tactionItem: ActionItem | ToolItem,\n\topts = {} as Partial<{ checked: boolean; disabled: boolean }>\n): MenuItem {\n\tif (!actionItem) {\n\t\tthrow Error('No action item provided to menuItem')\n\t}\n\n\tif (!actionItem.label) {\n\t\tthrow Error(\"Trying to create menu item for action item that doesn't have a label\")\n\t}\n\n\tconst { checked = false, disabled = false } = opts\n\n\treturn {\n\t\tid: actionItem.id,\n\t\ttype: 'item' as const,\n\t\tactionItem,\n\t\tdisabled,\n\t\tchecked,\n\t\treadonlyOk: actionItem.readonlyOk,\n\t}\n}\n\nfunction shapesWithUnboundArrows(app: App) {\n\tconst { selectedIds } = app\n\tconst selectedShapes = selectedIds.map((id) => {\n\t\treturn app.getShapeById(id)\n\t})\n\n\treturn selectedShapes.filter((shape) => {\n\t\tif (!shape) return false\n\t\tif (TLArrowShapeDef.is(shape) && shape.props.start.type === 'binding') {\n\t\t\treturn false\n\t\t}\n\t\tif (TLArrowShapeDef.is(shape) && shape.props.end.type === 'binding') {\n\t\t\treturn false\n\t\t}\n\t\treturn true\n\t})\n}\n\n/** @public */\nexport const useThreeStackableItems = () => {\n\tconst app = useApp()\n\treturn useValue('threeStackableItems', () => shapesWithUnboundArrows(app).length > 2, [app])\n}\n\n/** @public */\nexport const useAllowGroup = () => {\n\tconst app = useApp()\n\treturn useValue('allowGroup', () => shapesWithUnboundArrows(app).length > 1, [app])\n}\n\n/** @public */\nexport const useAllowUngroup = () => {\n\tconst app = useApp()\n\treturn useValue(\n\t\t'allowUngroup',\n\t\t() => app.selectedIds.some((id) => app.getShapeById(id)?.type === 'group'),\n\t\t[]\n\t)\n}\n\n/** @public */\nexport const showUiPaste =\n\ttypeof window !== 'undefined' &&\n\t'navigator' in window &&\n\tBoolean(navigator.clipboard) &&\n\tBoolean(navigator.clipboard.read)\n\n/** @public */\nexport const isActiveToolItem = (\n\titem: ToolItem,\n\tactiveToolId: string | undefined,\n\tgeoState: string | null | undefined\n) => {\n\treturn item.meta?.geo\n\t\t? activeToolId === 'geo' && geoState === item.meta?.geo\n\t\t: activeToolId === item.id\n}\n\n/** @public */\nexport function findMenuItem(menu: MenuSchema, path: string[]) {\n\tconst item = _findMenuItem(menu, path)\n\tassert(item, `Menu item ${path.join(' > ')} not found`)\n\treturn item\n}\nfunction _findMenuItem(menu: MenuSchema | MenuChild[], path: string[]): MenuChild | null {\n\tconst [next, ...rest] = path\n\tif (!next) return null\n\n\tconst item = menu.find((item) => item.id === next)\n\tif (!item) return null\n\n\tswitch (item.type) {\n\t\tcase 'group':\n\t\tcase 'submenu':\n\t\t\treturn rest.length === 0 ? item : _findMenuItem(item.children, rest)\n\t\tcase 'item':\n\t\tcase 'custom':\n\t\t\treturn rest.length === 0 ? item : null\n\t\tdefault:\n\t\t\texhaustiveSwitchError(item, 'type')\n\t}\n}\n","import * as React from 'react';\nimport { composeEventHandlers } from '@radix-ui/primitive';\nimport { useComposedRefs } from '@radix-ui/react-compose-refs';\nimport { createContext, createContextScope } from '@radix-ui/react-context';\nimport { useId } from '@radix-ui/react-id';\nimport { useControllableState } from '@radix-ui/react-use-controllable-state';\nimport { DismissableLayer } from '@radix-ui/react-dismissable-layer';\nimport { FocusScope } from '@radix-ui/react-focus-scope';\nimport { Portal as PortalPrimitive } from '@radix-ui/react-portal';\nimport { Presence } from '@radix-ui/react-presence';\nimport { Primitive } from '@radix-ui/react-primitive';\nimport { useFocusGuards } from '@radix-ui/react-focus-guards';\nimport { RemoveScroll } from 'react-remove-scroll';\nimport { hideOthers } from 'aria-hidden';\nimport { Slot } from '@radix-ui/react-slot';\n\nimport type * as Radix from '@radix-ui/react-primitive';\nimport type { Scope } from '@radix-ui/react-context';\n\n/* -------------------------------------------------------------------------------------------------\n * Dialog\n * -----------------------------------------------------------------------------------------------*/\n\nconst DIALOG_NAME = 'Dialog';\n\ntype ScopedProps<P> = P & { __scopeDialog?: Scope };\nconst [createDialogContext, createDialogScope] = createContextScope(DIALOG_NAME);\n\ntype DialogContextValue = {\n  triggerRef: React.RefObject<HTMLButtonElement>;\n  contentRef: React.RefObject<DialogContentElement>;\n  contentId: string;\n  titleId: string;\n  descriptionId: string;\n  open: boolean;\n  onOpenChange(open: boolean): void;\n  onOpenToggle(): void;\n  modal: boolean;\n};\n\nconst [DialogProvider, useDialogContext] = createDialogContext<DialogContextValue>(DIALOG_NAME);\n\ninterface DialogProps {\n  children?: React.ReactNode;\n  open?: boolean;\n  defaultOpen?: boolean;\n  onOpenChange?(open: boolean): void;\n  modal?: boolean;\n}\n\nconst Dialog: React.FC<DialogProps> = (props: ScopedProps<DialogProps>) => {\n  const {\n    __scopeDialog,\n    children,\n    open: openProp,\n    defaultOpen,\n    onOpenChange,\n    modal = true,\n  } = props;\n  const triggerRef = React.useRef<HTMLButtonElement>(null);\n  const contentRef = React.useRef<DialogContentElement>(null);\n  const [open = false, setOpen] = useControllableState({\n    prop: openProp,\n    defaultProp: defaultOpen,\n    onChange: onOpenChange,\n  });\n\n  return (\n    <DialogProvider\n      scope={__scopeDialog}\n      triggerRef={triggerRef}\n      contentRef={contentRef}\n      contentId={useId()}\n      titleId={useId()}\n      descriptionId={useId()}\n      open={open}\n      onOpenChange={setOpen}\n      onOpenToggle={React.useCallback(() => setOpen((prevOpen) => !prevOpen), [setOpen])}\n      modal={modal}\n    >\n      {children}\n    </DialogProvider>\n  );\n};\n\nDialog.displayName = DIALOG_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * DialogTrigger\n * -----------------------------------------------------------------------------------------------*/\n\nconst TRIGGER_NAME = 'DialogTrigger';\n\ntype DialogTriggerElement = React.ElementRef<typeof Primitive.button>;\ntype PrimitiveButtonProps = Radix.ComponentPropsWithoutRef<typeof Primitive.button>;\ninterface DialogTriggerProps extends PrimitiveButtonProps {}\n\nconst DialogTrigger = React.forwardRef<DialogTriggerElement, DialogTriggerProps>(\n  (props: ScopedProps<DialogTriggerProps>, forwardedRef) => {\n    const { __scopeDialog, ...triggerProps } = props;\n    const context = useDialogContext(TRIGGER_NAME, __scopeDialog);\n    const composedTriggerRef = useComposedRefs(forwardedRef, context.triggerRef);\n    return (\n      <Primitive.button\n        type=\"button\"\n        aria-haspopup=\"dialog\"\n        aria-expanded={context.open}\n        aria-controls={context.contentId}\n        data-state={getState(context.open)}\n        {...triggerProps}\n        ref={composedTriggerRef}\n        onClick={composeEventHandlers(props.onClick, context.onOpenToggle)}\n      />\n    );\n  }\n);\n\nDialogTrigger.displayName = TRIGGER_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * DialogPortal\n * -----------------------------------------------------------------------------------------------*/\n\nconst PORTAL_NAME = 'DialogPortal';\n\ntype PortalContextValue = { forceMount?: true };\nconst [PortalProvider, usePortalContext] = createDialogContext<PortalContextValue>(PORTAL_NAME, {\n  forceMount: undefined,\n});\n\ntype PortalProps = React.ComponentPropsWithoutRef<typeof PortalPrimitive>;\ninterface DialogPortalProps extends Omit<PortalProps, 'asChild'> {\n  children?: React.ReactNode;\n  /**\n   * Used to force mounting when more control is needed. Useful when\n   * controlling animation with React animation libraries.\n   */\n  forceMount?: true;\n}\n\nconst DialogPortal: React.FC<DialogPortalProps> = (props: ScopedProps<DialogPortalProps>) => {\n  const { __scopeDialog, forceMount, children, container } = props;\n  const context = useDialogContext(PORTAL_NAME, __scopeDialog);\n  return (\n    <PortalProvider scope={__scopeDialog} forceMount={forceMount}>\n      {React.Children.map(children, (child) => (\n        <Presence present={forceMount || context.open}>\n          <PortalPrimitive asChild container={container}>\n            {child}\n          </PortalPrimitive>\n        </Presence>\n      ))}\n    </PortalProvider>\n  );\n};\n\nDialogPortal.displayName = PORTAL_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * DialogOverlay\n * -----------------------------------------------------------------------------------------------*/\n\nconst OVERLAY_NAME = 'DialogOverlay';\n\ntype DialogOverlayElement = DialogOverlayImplElement;\ninterface DialogOverlayProps extends DialogOverlayImplProps {\n  /**\n   * Used to force mounting when more control is needed. Useful when\n   * controlling animation with React animation libraries.\n   */\n  forceMount?: true;\n}\n\nconst DialogOverlay = React.forwardRef<DialogOverlayElement, DialogOverlayProps>(\n  (props: ScopedProps<DialogOverlayProps>, forwardedRef) => {\n    const portalContext = usePortalContext(OVERLAY_NAME, props.__scopeDialog);\n    const { forceMount = portalContext.forceMount, ...overlayProps } = props;\n    const context = useDialogContext(OVERLAY_NAME, props.__scopeDialog);\n    return context.modal ? (\n      <Presence present={forceMount || context.open}>\n        <DialogOverlayImpl {...overlayProps} ref={forwardedRef} />\n      </Presence>\n    ) : null;\n  }\n);\n\nDialogOverlay.displayName = OVERLAY_NAME;\n\ntype DialogOverlayImplElement = React.ElementRef<typeof Primitive.div>;\ntype PrimitiveDivProps = Radix.ComponentPropsWithoutRef<typeof Primitive.div>;\ninterface DialogOverlayImplProps extends PrimitiveDivProps {}\n\nconst DialogOverlayImpl = React.forwardRef<DialogOverlayImplElement, DialogOverlayImplProps>(\n  (props: ScopedProps<DialogOverlayImplProps>, forwardedRef) => {\n    const { __scopeDialog, ...overlayProps } = props;\n    const context = useDialogContext(OVERLAY_NAME, __scopeDialog);\n    return (\n      // Make sure `Content` is scrollable even when it doesn't live inside `RemoveScroll`\n      // ie. when `Overlay` and `Content` are siblings\n      <RemoveScroll as={Slot} allowPinchZoom shards={[context.contentRef]}>\n        <Primitive.div\n          data-state={getState(context.open)}\n          {...overlayProps}\n          ref={forwardedRef}\n          // We re-enable pointer-events prevented by `Dialog.Content` to allow scrolling the overlay.\n          style={{ pointerEvents: 'auto', ...overlayProps.style }}\n        />\n      </RemoveScroll>\n    );\n  }\n);\n\n/* -------------------------------------------------------------------------------------------------\n * DialogContent\n * -----------------------------------------------------------------------------------------------*/\n\nconst CONTENT_NAME = 'DialogContent';\n\ntype DialogContentElement = DialogContentTypeElement;\ninterface DialogContentProps extends DialogContentTypeProps {\n  /**\n   * Used to force mounting when more control is needed. Useful when\n   * controlling animation with React animation libraries.\n   */\n  forceMount?: true;\n}\n\nconst DialogContent = React.forwardRef<DialogContentElement, DialogContentProps>(\n  (props: ScopedProps<DialogContentProps>, forwardedRef) => {\n    const portalContext = usePortalContext(CONTENT_NAME, props.__scopeDialog);\n    const { forceMount = portalContext.forceMount, ...contentProps } = props;\n    const context = useDialogContext(CONTENT_NAME, props.__scopeDialog);\n    return (\n      <Presence present={forceMount || context.open}>\n        {context.modal ? (\n          <DialogContentModal {...contentProps} ref={forwardedRef} />\n        ) : (\n          <DialogContentNonModal {...contentProps} ref={forwardedRef} />\n        )}\n      </Presence>\n    );\n  }\n);\n\nDialogContent.displayName = CONTENT_NAME;\n\n/* -----------------------------------------------------------------------------------------------*/\n\ntype DialogContentTypeElement = DialogContentImplElement;\ninterface DialogContentTypeProps\n  extends Omit<DialogContentImplProps, 'trapFocus' | 'disableOutsidePointerEvents'> {}\n\nconst DialogContentModal = React.forwardRef<DialogContentTypeElement, DialogContentTypeProps>(\n  (props: ScopedProps<DialogContentTypeProps>, forwardedRef) => {\n    const context = useDialogContext(CONTENT_NAME, props.__scopeDialog);\n    const contentRef = React.useRef<HTMLDivElement>(null);\n    const composedRefs = useComposedRefs(forwardedRef, context.contentRef, contentRef);\n\n    // aria-hide everything except the content (better supported equivalent to setting aria-modal)\n    React.useEffect(() => {\n      const content = contentRef.current;\n      if (content) return hideOthers(content);\n    }, []);\n\n    return (\n      <DialogContentImpl\n        {...props}\n        ref={composedRefs}\n        // we make sure focus isn't trapped once `DialogContent` has been closed\n        // (closed !== unmounted when animating out)\n        trapFocus={context.open}\n        disableOutsidePointerEvents\n        onCloseAutoFocus={composeEventHandlers(props.onCloseAutoFocus, (event) => {\n          event.preventDefault();\n          context.triggerRef.current?.focus();\n        })}\n        onPointerDownOutside={composeEventHandlers(props.onPointerDownOutside, (event) => {\n          const originalEvent = event.detail.originalEvent;\n          const ctrlLeftClick = originalEvent.button === 0 && originalEvent.ctrlKey === true;\n          const isRightClick = originalEvent.button === 2 || ctrlLeftClick;\n\n          // If the event is a right-click, we shouldn't close because\n          // it is effectively as if we right-clicked the `Overlay`.\n          if (isRightClick) event.preventDefault();\n        })}\n        // When focus is trapped, a `focusout` event may still happen.\n        // We make sure we don't trigger our `onDismiss` in such case.\n        onFocusOutside={composeEventHandlers(props.onFocusOutside, (event) =>\n          event.preventDefault()\n        )}\n      />\n    );\n  }\n);\n\n/* -----------------------------------------------------------------------------------------------*/\n\nconst DialogContentNonModal = React.forwardRef<DialogContentTypeElement, DialogContentTypeProps>(\n  (props: ScopedProps<DialogContentTypeProps>, forwardedRef) => {\n    const context = useDialogContext(CONTENT_NAME, props.__scopeDialog);\n    const hasInteractedOutsideRef = React.useRef(false);\n\n    return (\n      <DialogContentImpl\n        {...props}\n        ref={forwardedRef}\n        trapFocus={false}\n        disableOutsidePointerEvents={false}\n        onCloseAutoFocus={(event) => {\n          props.onCloseAutoFocus?.(event);\n\n          if (!event.defaultPrevented) {\n            if (!hasInteractedOutsideRef.current) context.triggerRef.current?.focus();\n            // Always prevent auto focus because we either focus manually or want user agent focus\n            event.preventDefault();\n          }\n\n          hasInteractedOutsideRef.current = false;\n        }}\n        onInteractOutside={(event) => {\n          props.onInteractOutside?.(event);\n\n          if (!event.defaultPrevented) hasInteractedOutsideRef.current = true;\n\n          // Prevent dismissing when clicking the trigger.\n          // As the trigger is already setup to close, without doing so would\n          // cause it to close and immediately open.\n          //\n          // We use `onInteractOutside` as some browsers also\n          // focus on pointer down, creating the same issue.\n          const target = event.target as HTMLElement;\n          const targetIsTrigger = context.triggerRef.current?.contains(target);\n          if (targetIsTrigger) event.preventDefault();\n        }}\n      />\n    );\n  }\n);\n\n/* -----------------------------------------------------------------------------------------------*/\n\ntype DialogContentImplElement = React.ElementRef<typeof DismissableLayer>;\ntype DismissableLayerProps = Radix.ComponentPropsWithoutRef<typeof DismissableLayer>;\ntype FocusScopeProps = Radix.ComponentPropsWithoutRef<typeof FocusScope>;\ninterface DialogContentImplProps extends Omit<DismissableLayerProps, 'onDismiss'> {\n  /**\n   * When `true`, focus cannot escape the `Content` via keyboard,\n   * pointer, or a programmatic focus.\n   * @defaultValue false\n   */\n  trapFocus?: FocusScopeProps['trapped'];\n\n  /**\n   * Event handler called when auto-focusing on open.\n   * Can be prevented.\n   */\n  onOpenAutoFocus?: FocusScopeProps['onMountAutoFocus'];\n\n  /**\n   * Event handler called when auto-focusing on close.\n   * Can be prevented.\n   */\n  onCloseAutoFocus?: FocusScopeProps['onUnmountAutoFocus'];\n}\n\nconst DialogContentImpl = React.forwardRef<DialogContentImplElement, DialogContentImplProps>(\n  (props: ScopedProps<DialogContentImplProps>, forwardedRef) => {\n    const { __scopeDialog, trapFocus, onOpenAutoFocus, onCloseAutoFocus, ...contentProps } = props;\n    const context = useDialogContext(CONTENT_NAME, __scopeDialog);\n    const contentRef = React.useRef<HTMLDivElement>(null);\n    const composedRefs = useComposedRefs(forwardedRef, contentRef);\n\n    // Make sure the whole tree has focus guards as our `Dialog` will be\n    // the last element in the DOM (beacuse of the `Portal`)\n    useFocusGuards();\n\n    return (\n      <>\n        <FocusScope\n          asChild\n          loop\n          trapped={trapFocus}\n          onMountAutoFocus={onOpenAutoFocus}\n          onUnmountAutoFocus={onCloseAutoFocus}\n        >\n          <DismissableLayer\n            role=\"dialog\"\n            id={context.contentId}\n            aria-describedby={context.descriptionId}\n            aria-labelledby={context.titleId}\n            data-state={getState(context.open)}\n            {...contentProps}\n            ref={composedRefs}\n            onDismiss={() => context.onOpenChange(false)}\n          />\n        </FocusScope>\n        {process.env.NODE_ENV !== 'production' && (\n          <>\n            <TitleWarning titleId={context.titleId} />\n            <DescriptionWarning contentRef={contentRef} descriptionId={context.descriptionId} />\n          </>\n        )}\n      </>\n    );\n  }\n);\n\n/* -------------------------------------------------------------------------------------------------\n * DialogTitle\n * -----------------------------------------------------------------------------------------------*/\n\nconst TITLE_NAME = 'DialogTitle';\n\ntype DialogTitleElement = React.ElementRef<typeof Primitive.h2>;\ntype PrimitiveHeading2Props = Radix.ComponentPropsWithoutRef<typeof Primitive.h2>;\ninterface DialogTitleProps extends PrimitiveHeading2Props {}\n\nconst DialogTitle = React.forwardRef<DialogTitleElement, DialogTitleProps>(\n  (props: ScopedProps<DialogTitleProps>, forwardedRef) => {\n    const { __scopeDialog, ...titleProps } = props;\n    const context = useDialogContext(TITLE_NAME, __scopeDialog);\n    return <Primitive.h2 id={context.titleId} {...titleProps} ref={forwardedRef} />;\n  }\n);\n\nDialogTitle.displayName = TITLE_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * DialogDescription\n * -----------------------------------------------------------------------------------------------*/\n\nconst DESCRIPTION_NAME = 'DialogDescription';\n\ntype DialogDescriptionElement = React.ElementRef<typeof Primitive.p>;\ntype PrimitiveParagraphProps = Radix.ComponentPropsWithoutRef<typeof Primitive.p>;\ninterface DialogDescriptionProps extends PrimitiveParagraphProps {}\n\nconst DialogDescription = React.forwardRef<DialogDescriptionElement, DialogDescriptionProps>(\n  (props: ScopedProps<DialogDescriptionProps>, forwardedRef) => {\n    const { __scopeDialog, ...descriptionProps } = props;\n    const context = useDialogContext(DESCRIPTION_NAME, __scopeDialog);\n    return <Primitive.p id={context.descriptionId} {...descriptionProps} ref={forwardedRef} />;\n  }\n);\n\nDialogDescription.displayName = DESCRIPTION_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * DialogClose\n * -----------------------------------------------------------------------------------------------*/\n\nconst CLOSE_NAME = 'DialogClose';\n\ntype DialogCloseElement = React.ElementRef<typeof Primitive.button>;\ninterface DialogCloseProps extends PrimitiveButtonProps {}\n\nconst DialogClose = React.forwardRef<DialogCloseElement, DialogCloseProps>(\n  (props: ScopedProps<DialogCloseProps>, forwardedRef) => {\n    const { __scopeDialog, ...closeProps } = props;\n    const context = useDialogContext(CLOSE_NAME, __scopeDialog);\n    return (\n      <Primitive.button\n        type=\"button\"\n        {...closeProps}\n        ref={forwardedRef}\n        onClick={composeEventHandlers(props.onClick, () => context.onOpenChange(false))}\n      />\n    );\n  }\n);\n\nDialogClose.displayName = CLOSE_NAME;\n\n/* -----------------------------------------------------------------------------------------------*/\n\nfunction getState(open: boolean) {\n  return open ? 'open' : 'closed';\n}\n\nconst TITLE_WARNING_NAME = 'DialogTitleWarning';\n\nconst [WarningProvider, useWarningContext] = createContext(TITLE_WARNING_NAME, {\n  contentName: CONTENT_NAME,\n  titleName: TITLE_NAME,\n  docsSlug: 'dialog',\n});\n\ntype TitleWarningProps = { titleId?: string };\n\nconst TitleWarning: React.FC<TitleWarningProps> = ({ titleId }) => {\n  const titleWarningContext = useWarningContext(TITLE_WARNING_NAME);\n\n  const MESSAGE = `\\`${titleWarningContext.contentName}\\` requires a \\`${titleWarningContext.titleName}\\` for the component to be accessible for screen reader users.\n\nIf you want to hide the \\`${titleWarningContext.titleName}\\`, you can wrap it with our VisuallyHidden component.\n\nFor more information, see https://radix-ui.com/primitives/docs/components/${titleWarningContext.docsSlug}`;\n\n  React.useEffect(() => {\n    if (titleId) {\n      const hasTitle = document.getElementById(titleId);\n      if (!hasTitle) throw new Error(MESSAGE);\n    }\n  }, [MESSAGE, titleId]);\n\n  return null;\n};\n\nconst DESCRIPTION_WARNING_NAME = 'DialogDescriptionWarning';\n\ntype DescriptionWarningProps = {\n  contentRef: React.RefObject<DialogContentElement>;\n  descriptionId?: string;\n};\n\nconst DescriptionWarning: React.FC<DescriptionWarningProps> = ({ contentRef, descriptionId }) => {\n  const descriptionWarningContext = useWarningContext(DESCRIPTION_WARNING_NAME);\n  const MESSAGE = `Warning: Missing \\`Description\\` or \\`aria-describedby={undefined}\\` for {${descriptionWarningContext.contentName}}.`;\n\n  React.useEffect(() => {\n    const describedById = contentRef.current?.getAttribute('aria-describedby');\n    // if we have an id and the user hasn't set aria-describedby={undefined}\n    if (descriptionId && describedById) {\n      const hasDescription = document.getElementById(descriptionId);\n      if (!hasDescription) console.warn(MESSAGE);\n    }\n  }, [MESSAGE, contentRef, descriptionId]);\n\n  return null;\n};\n\nconst Root = Dialog;\nconst Trigger = DialogTrigger;\nconst Portal = DialogPortal;\nconst Overlay = DialogOverlay;\nconst Content = DialogContent;\nconst Title = DialogTitle;\nconst Description = DialogDescription;\nconst Close = DialogClose;\n\nexport {\n  createDialogScope,\n  //\n  Dialog,\n  DialogTrigger,\n  DialogPortal,\n  DialogOverlay,\n  DialogContent,\n  DialogTitle,\n  DialogDescription,\n  DialogClose,\n  //\n  Root,\n  Trigger,\n  Portal,\n  Overlay,\n  Content,\n  Title,\n  Description,\n  Close,\n  //\n  WarningProvider,\n};\nexport type {\n  DialogProps,\n  DialogTriggerProps,\n  DialogPortalProps,\n  DialogOverlayProps,\n  DialogContentProps,\n  DialogTitleProps,\n  DialogDescriptionProps,\n  DialogCloseProps,\n};\n","import React from 'react'\n\nexport function Spinner(props: React.SVGProps<SVGSVGElement>) {\n\treturn (\n\t\t<svg width={16} height={16} viewBox=\"0 0 16 16\" {...props}>\n\t\t\t<g strokeWidth={2} fill=\"none\" fillRule=\"evenodd\">\n\t\t\t\t<circle strokeOpacity={0.25} cx={8} cy={8} r={7} stroke=\"currentColor\" />\n\t\t\t\t<path strokeLinecap=\"round\" d=\"M15 8c0-4.5-4.5-7-7-7\" stroke=\"currentColor\">\n\t\t\t\t\t<animateTransform\n\t\t\t\t\t\tattributeName=\"transform\"\n\t\t\t\t\t\ttype=\"rotate\"\n\t\t\t\t\t\tfrom=\"0 8 8\"\n\t\t\t\t\t\tto=\"360 8 8\"\n\t\t\t\t\t\tdur=\"1s\"\n\t\t\t\t\t\trepeatCount=\"indefinite\"\n\t\t\t\t\t/>\n\t\t\t\t</path>\n\t\t\t</g>\n\t\t</svg>\n\t)\n}\n","import classNames from 'classnames'\nimport { forwardRef } from 'react'\nimport { useAssetUrls } from '../../../hooks'\nimport { TLUiIconType } from '../../../icon-types'\n\n/** @public */\nexport interface IconProps extends React.HTMLProps<HTMLDivElement> {\n\ticon: TLUiIconType\n\tsmall?: boolean\n\tchildren?: undefined\n\tinvertIcon?: boolean\n\tcrossOrigin?: 'anonymous' | 'use-credentials'\n}\n\n/** @public */\nexport const Icon = forwardRef<HTMLDivElement, IconProps>(function Icon(\n\t{ small, invertIcon, icon, className, ...props },\n\tref\n) {\n\tconst assetUrls = useAssetUrls()\n\n\treturn (\n\t\t<div\n\t\t\tref={ref}\n\t\t\t{...props}\n\t\t\tclassName={classNames('tlui-icon', { 'tlui-icon__small': small }, className)}\n\t\t\tstyle={{\n\t\t\t\tmask: `url(${assetUrls.icons[icon]}) center 100% / 100% no-repeat`,\n\t\t\t\tWebkitMask: `url(${assetUrls.icons[icon]}) center 100% / 100% no-repeat`,\n\t\t\t\tbackgroundColor: 'currentcolor',\n\t\t\t\ttransform: invertIcon ? 'scale(-1, 1)' : undefined,\n\t\t\t}}\n\t\t/>\n\t)\n})\n","/** @public */\nexport function toStartCase(str: string) {\n\treturn str\n\t\t.split(' ')\n\t\t.map((s) => s.charAt(0).toUpperCase() + s.slice(1))\n\t\t.join(' ')\n}\n\nconst isDarwin =\n\ttypeof window === 'undefined'\n\t\t? false\n\t\t: window.navigator.userAgent.toLowerCase().indexOf('mac') > -1\nconst cmdKey = isDarwin ? '' : 'Ctrl'\nconst altKey = isDarwin ? '' : 'Alt'\n\n/** @public */\nexport function kbd(str: string) {\n\treturn str\n\t\t.split(',')[0]\n\t\t.split('')\n\t\t.map((sub) => {\n\t\t\tconst subStr = sub.replace(/\\$/g, cmdKey).replace(/\\?/g, altKey).replace(/!/g, '')\n\t\t\treturn subStr[0].toUpperCase() + subStr.slice(1)\n\t\t})\n}\n\n/** @public */\nexport function kbdStr(str: string) {\n\treturn (\n\t\t' ' +\n\t\tstr\n\t\t\t.split(',')[0]\n\t\t\t.split('')\n\t\t\t.map((sub) => {\n\t\t\t\tconst subStr = sub.replace(/\\$/g, cmdKey).replace(/\\?/g, altKey).replace(/!/g, '')\n\t\t\t\treturn subStr[0].toUpperCase() + subStr.slice(1)\n\t\t\t})\n\t\t\t.join('')\n\t)\n}\n\n/** @public */\nexport const getBaseUrl = () => {\n\tif (typeof process === 'undefined') {\n\t\treturn 'http://localhost:5420'\n\t}\n\n\tif (process.env.NODE_ENV === 'development') {\n\t\treturn 'http://localhost:3000'\n\t}\n\n\tif (process.env.NEXT_PUBLIC_VERCEL_ENV === 'production') {\n\t\treturn 'https://beta.tldraw.com'\n\t}\n\n\tif (process.env.NEXT_PUBLIC_VERCEL_ENV === 'preview') {\n\t\treturn `https://${process.env.NEXT_PUBLIC_VERCEL_URL}`\n\t}\n\n\treturn 'http://localhost:3000'\n}\n\n/** @public */\nexport const BASE_URL = getBaseUrl()\n","import { kbd } from '../shared'\n\n/** @public */\nexport interface KbdProps {\n\tchildren: string\n}\n\n/** @public */\nexport function Kbd({ children }: KbdProps) {\n\treturn (\n\t\t<kbd className=\"tlui-kbd\">\n\t\t\t{kbd(children).map((k, i) => (\n\t\t\t\t<span key={i}>{k}</span>\n\t\t\t))}\n\t\t</kbd>\n\t)\n}\n","import classnames from 'classnames'\nimport * as React from 'react'\nimport { TLTranslationKey, useTranslation } from '../../../hooks'\nimport { TLUiIconType } from '../../../icon-types'\nimport { Spinner } from '../../Spinner'\nimport { Icon } from '../Icon'\nimport { Kbd } from '../Kbd'\n\n/** @public */\nexport interface ButtonProps extends React.HTMLAttributes<HTMLButtonElement> {\n\tloading?: boolean // TODO: loading spinner\n\tdisabled?: boolean\n\tlabel?: TLTranslationKey\n\ticon?: TLUiIconType\n\tspinner?: boolean\n\ticonLeft?: TLUiIconType\n\tsmallIcon?: boolean\n\tkbd?: string\n\tisChecked?: boolean\n\tinvertIcon?: boolean\n\ttype?: 'primary' | 'danger' | 'normal'\n}\n\n/** @public */\nexport const Button = React.forwardRef<HTMLButtonElement, ButtonProps>(function Button(\n\t{\n\t\tlabel,\n\t\ticon,\n\t\tinvertIcon,\n\t\ticonLeft,\n\t\tsmallIcon,\n\t\tkbd,\n\t\tisChecked = false,\n\t\ttype = 'normal',\n\t\tchildren,\n\t\tspinner,\n\t\t...props\n\t},\n\tref\n) {\n\tconst msg = useTranslation()\n\tconst labelStr = label ? msg(label) : ''\n\n\treturn (\n\t\t<button\n\t\t\tref={ref}\n\t\t\tdraggable={false}\n\t\t\ttype=\"button\"\n\t\t\t{...props}\n\t\t\ttitle={props.title ?? labelStr}\n\t\t\tclassName={classnames('tlui-button', `tlui-button__${type}`, props.className)}\n\t\t>\n\t\t\t{iconLeft && <Icon icon={iconLeft} className=\"tlui-icon-left\" small />}\n\t\t\t{children}\n\t\t\t{label && (\n\t\t\t\t<span draggable={false}>\n\t\t\t\t\t{labelStr}\n\t\t\t\t\t{isChecked && <Icon icon=\"check\" />}\n\t\t\t\t</span>\n\t\t\t)}\n\t\t\t{kbd && <Kbd>{kbd}</Kbd>}\n\t\t\t{icon && !spinner && (\n\t\t\t\t<Icon icon={icon} small={!!label || smallIcon} invertIcon={invertIcon} />\n\t\t\t)}\n\t\t\t{spinner && <Spinner />}\n\t\t</button>\n\t)\n})\n","import * as _Dialog from '@radix-ui/react-dialog'\nimport classNames from 'classnames'\nimport { Button } from '../Button'\nimport { Icon } from '../Icon'\n\n/** @public */\nexport function Header({ className, children }: { className?: string; children: any }) {\n\treturn <div className={classNames('tlui-dialog__header', className)}>{children}</div>\n}\n\n/** @public */\nexport function Title({ className, children }: { className?: string; children: any }) {\n\treturn (\n\t\t<_Dialog.DialogTitle dir=\"ltr\" className={classNames('tlui-dialog__header__title', className)}>\n\t\t\t{children}\n\t\t</_Dialog.DialogTitle>\n\t)\n}\n\n/** @public */\nexport function CloseButton() {\n\treturn (\n\t\t<div className=\"tlui-dialog__header__close\">\n\t\t\t<_Dialog.DialogClose data-wd=\"dialog.close\" dir=\"ltr\" asChild>\n\t\t\t\t<Button aria-label=\"Close\" onTouchEnd={(e) => (e.target as HTMLButtonElement).click()}>\n\t\t\t\t\t<Icon small icon=\"cross-2\" />\n\t\t\t\t</Button>\n\t\t\t</_Dialog.DialogClose>\n\t\t</div>\n\t)\n}\n\n/** @public */\nexport function Body({\n\tclassName,\n\tchildren,\n\tstyle,\n}: {\n\tclassName?: string\n\tchildren: any\n\tstyle?: React.CSSProperties\n}) {\n\treturn (\n\t\t<div className={classNames('tlui-dialog__body', className)} style={style}>\n\t\t\t{children}\n\t\t</div>\n\t)\n}\n\n/** @public */\nexport function Footer({ className, children }: { className?: string; children: any }) {\n\treturn <div className={classNames('tlui-dialog__footer', className)}>{children}</div>\n}\n","import * as React from 'react';\nimport { composeEventHandlers } from '@radix-ui/primitive';\nimport { composeRefs } from '@radix-ui/react-compose-refs';\nimport { createContextScope } from '@radix-ui/react-context';\nimport { useControllableState } from '@radix-ui/react-use-controllable-state';\nimport { Primitive } from '@radix-ui/react-primitive';\nimport * as MenuPrimitive from '@radix-ui/react-menu';\nimport { createMenuScope } from '@radix-ui/react-menu';\nimport { useId } from '@radix-ui/react-id';\n\nimport type * as Radix from '@radix-ui/react-primitive';\nimport type { Scope } from '@radix-ui/react-context';\n\ntype Direction = 'ltr' | 'rtl';\n\n/* -------------------------------------------------------------------------------------------------\n * DropdownMenu\n * -----------------------------------------------------------------------------------------------*/\n\nconst DROPDOWN_MENU_NAME = 'DropdownMenu';\n\ntype ScopedProps<P> = P & { __scopeDropdownMenu?: Scope };\nconst [createDropdownMenuContext, createDropdownMenuScope] = createContextScope(\n  DROPDOWN_MENU_NAME,\n  [createMenuScope]\n);\nconst useMenuScope = createMenuScope();\n\ntype DropdownMenuContextValue = {\n  triggerId: string;\n  triggerRef: React.RefObject<HTMLButtonElement>;\n  contentId: string;\n  open: boolean;\n  onOpenChange(open: boolean): void;\n  onOpenToggle(): void;\n  modal: boolean;\n};\n\nconst [DropdownMenuProvider, useDropdownMenuContext] =\n  createDropdownMenuContext<DropdownMenuContextValue>(DROPDOWN_MENU_NAME);\n\ninterface DropdownMenuProps {\n  children?: React.ReactNode;\n  dir?: Direction;\n  open?: boolean;\n  defaultOpen?: boolean;\n  onOpenChange?(open: boolean): void;\n  modal?: boolean;\n}\n\nconst DropdownMenu: React.FC<DropdownMenuProps> = (props: ScopedProps<DropdownMenuProps>) => {\n  const {\n    __scopeDropdownMenu,\n    children,\n    dir,\n    open: openProp,\n    defaultOpen,\n    onOpenChange,\n    modal = true,\n  } = props;\n  const menuScope = useMenuScope(__scopeDropdownMenu);\n  const triggerRef = React.useRef<HTMLButtonElement>(null);\n  const [open = false, setOpen] = useControllableState({\n    prop: openProp,\n    defaultProp: defaultOpen,\n    onChange: onOpenChange,\n  });\n\n  return (\n    <DropdownMenuProvider\n      scope={__scopeDropdownMenu}\n      triggerId={useId()}\n      triggerRef={triggerRef}\n      contentId={useId()}\n      open={open}\n      onOpenChange={setOpen}\n      onOpenToggle={React.useCallback(() => setOpen((prevOpen) => !prevOpen), [setOpen])}\n      modal={modal}\n    >\n      <MenuPrimitive.Root {...menuScope} open={open} onOpenChange={setOpen} dir={dir} modal={modal}>\n        {children}\n      </MenuPrimitive.Root>\n    </DropdownMenuProvider>\n  );\n};\n\nDropdownMenu.displayName = DROPDOWN_MENU_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * DropdownMenuTrigger\n * -----------------------------------------------------------------------------------------------*/\n\nconst TRIGGER_NAME = 'DropdownMenuTrigger';\n\ntype DropdownMenuTriggerElement = React.ElementRef<typeof Primitive.button>;\ntype PrimitiveButtonProps = Radix.ComponentPropsWithoutRef<typeof Primitive.button>;\ninterface DropdownMenuTriggerProps extends PrimitiveButtonProps {}\n\nconst DropdownMenuTrigger = React.forwardRef<DropdownMenuTriggerElement, DropdownMenuTriggerProps>(\n  (props: ScopedProps<DropdownMenuTriggerProps>, forwardedRef) => {\n    const { __scopeDropdownMenu, disabled = false, ...triggerProps } = props;\n    const context = useDropdownMenuContext(TRIGGER_NAME, __scopeDropdownMenu);\n    const menuScope = useMenuScope(__scopeDropdownMenu);\n    return (\n      <MenuPrimitive.Anchor asChild {...menuScope}>\n        <Primitive.button\n          type=\"button\"\n          id={context.triggerId}\n          aria-haspopup=\"menu\"\n          aria-expanded={context.open}\n          aria-controls={context.open ? context.contentId : undefined}\n          data-state={context.open ? 'open' : 'closed'}\n          data-disabled={disabled ? '' : undefined}\n          disabled={disabled}\n          {...triggerProps}\n          ref={composeRefs(forwardedRef, context.triggerRef)}\n          onPointerDown={composeEventHandlers(props.onPointerDown, (event) => {\n            // only call handler if it's the left button (mousedown gets triggered by all mouse buttons)\n            // but not when the control key is pressed (avoiding MacOS right click)\n            if (!disabled && event.button === 0 && event.ctrlKey === false) {\n              context.onOpenToggle();\n              // prevent trigger focusing when opening\n              // this allows the content to be given focus without competition\n              if (!context.open) event.preventDefault();\n            }\n          })}\n          onKeyDown={composeEventHandlers(props.onKeyDown, (event) => {\n            if (disabled) return;\n            if (['Enter', ' '].includes(event.key)) context.onOpenToggle();\n            if (event.key === 'ArrowDown') context.onOpenChange(true);\n            // prevent keydown from scrolling window / first focused item to execute\n            // that keydown (inadvertently closing the menu)\n            if (['Enter', ' ', 'ArrowDown'].includes(event.key)) event.preventDefault();\n          })}\n        />\n      </MenuPrimitive.Anchor>\n    );\n  }\n);\n\nDropdownMenuTrigger.displayName = TRIGGER_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * DropdownMenuPortal\n * -----------------------------------------------------------------------------------------------*/\n\nconst PORTAL_NAME = 'DropdownMenuPortal';\n\ntype MenuPortalProps = React.ComponentPropsWithoutRef<typeof MenuPrimitive.Portal>;\ninterface DropdownMenuPortalProps extends MenuPortalProps {}\n\nconst DropdownMenuPortal: React.FC<DropdownMenuPortalProps> = (\n  props: ScopedProps<DropdownMenuPortalProps>\n) => {\n  const { __scopeDropdownMenu, ...portalProps } = props;\n  const menuScope = useMenuScope(__scopeDropdownMenu);\n  return <MenuPrimitive.Portal {...menuScope} {...portalProps} />;\n};\n\nDropdownMenuPortal.displayName = PORTAL_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * DropdownMenuContent\n * -----------------------------------------------------------------------------------------------*/\n\nconst CONTENT_NAME = 'DropdownMenuContent';\n\ntype DropdownMenuContentElement = React.ElementRef<typeof MenuPrimitive.Content>;\ntype MenuContentProps = Radix.ComponentPropsWithoutRef<typeof MenuPrimitive.Content>;\ninterface DropdownMenuContentProps extends Omit<MenuContentProps, 'onEntryFocus'> {}\n\nconst DropdownMenuContent = React.forwardRef<DropdownMenuContentElement, DropdownMenuContentProps>(\n  (props: ScopedProps<DropdownMenuContentProps>, forwardedRef) => {\n    const { __scopeDropdownMenu, ...contentProps } = props;\n    const context = useDropdownMenuContext(CONTENT_NAME, __scopeDropdownMenu);\n    const menuScope = useMenuScope(__scopeDropdownMenu);\n    const hasInteractedOutsideRef = React.useRef(false);\n\n    return (\n      <MenuPrimitive.Content\n        id={context.contentId}\n        aria-labelledby={context.triggerId}\n        {...menuScope}\n        {...contentProps}\n        ref={forwardedRef}\n        onCloseAutoFocus={composeEventHandlers(props.onCloseAutoFocus, (event) => {\n          if (!hasInteractedOutsideRef.current) context.triggerRef.current?.focus();\n          hasInteractedOutsideRef.current = false;\n          // Always prevent auto focus because we either focus manually or want user agent focus\n          event.preventDefault();\n        })}\n        onInteractOutside={composeEventHandlers(props.onInteractOutside, (event) => {\n          const originalEvent = event.detail.originalEvent as PointerEvent;\n          const ctrlLeftClick = originalEvent.button === 0 && originalEvent.ctrlKey === true;\n          const isRightClick = originalEvent.button === 2 || ctrlLeftClick;\n          if (!context.modal || isRightClick) hasInteractedOutsideRef.current = true;\n        })}\n        style={{\n          ...props.style,\n          // re-namespace exposed content custom properties\n          ...{\n            '--radix-dropdown-menu-content-transform-origin':\n              'var(--radix-popper-transform-origin)',\n            '--radix-dropdown-menu-content-available-width': 'var(--radix-popper-available-width)',\n            '--radix-dropdown-menu-content-available-height':\n              'var(--radix-popper-available-height)',\n            '--radix-dropdown-menu-trigger-width': 'var(--radix-popper-anchor-width)',\n            '--radix-dropdown-menu-trigger-height': 'var(--radix-popper-anchor-height)',\n          },\n        }}\n      />\n    );\n  }\n);\n\nDropdownMenuContent.displayName = CONTENT_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * DropdownMenuGroup\n * -----------------------------------------------------------------------------------------------*/\n\nconst GROUP_NAME = 'DropdownMenuGroup';\n\ntype DropdownMenuGroupElement = React.ElementRef<typeof MenuPrimitive.Group>;\ntype MenuGroupProps = Radix.ComponentPropsWithoutRef<typeof MenuPrimitive.Group>;\ninterface DropdownMenuGroupProps extends MenuGroupProps {}\n\nconst DropdownMenuGroup = React.forwardRef<DropdownMenuGroupElement, DropdownMenuGroupProps>(\n  (props: ScopedProps<DropdownMenuGroupProps>, forwardedRef) => {\n    const { __scopeDropdownMenu, ...groupProps } = props;\n    const menuScope = useMenuScope(__scopeDropdownMenu);\n    return <MenuPrimitive.Group {...menuScope} {...groupProps} ref={forwardedRef} />;\n  }\n);\n\nDropdownMenuGroup.displayName = GROUP_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * DropdownMenuLabel\n * -----------------------------------------------------------------------------------------------*/\n\nconst LABEL_NAME = 'DropdownMenuLabel';\n\ntype DropdownMenuLabelElement = React.ElementRef<typeof MenuPrimitive.Label>;\ntype MenuLabelProps = Radix.ComponentPropsWithoutRef<typeof MenuPrimitive.Label>;\ninterface DropdownMenuLabelProps extends MenuLabelProps {}\n\nconst DropdownMenuLabel = React.forwardRef<DropdownMenuLabelElement, DropdownMenuLabelProps>(\n  (props: ScopedProps<DropdownMenuLabelProps>, forwardedRef) => {\n    const { __scopeDropdownMenu, ...labelProps } = props;\n    const menuScope = useMenuScope(__scopeDropdownMenu);\n    return <MenuPrimitive.Label {...menuScope} {...labelProps} ref={forwardedRef} />;\n  }\n);\n\nDropdownMenuLabel.displayName = LABEL_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * DropdownMenuItem\n * -----------------------------------------------------------------------------------------------*/\n\nconst ITEM_NAME = 'DropdownMenuItem';\n\ntype DropdownMenuItemElement = React.ElementRef<typeof MenuPrimitive.Item>;\ntype MenuItemProps = Radix.ComponentPropsWithoutRef<typeof MenuPrimitive.Item>;\ninterface DropdownMenuItemProps extends MenuItemProps {}\n\nconst DropdownMenuItem = React.forwardRef<DropdownMenuItemElement, DropdownMenuItemProps>(\n  (props: ScopedProps<DropdownMenuItemProps>, forwardedRef) => {\n    const { __scopeDropdownMenu, ...itemProps } = props;\n    const menuScope = useMenuScope(__scopeDropdownMenu);\n    return <MenuPrimitive.Item {...menuScope} {...itemProps} ref={forwardedRef} />;\n  }\n);\n\nDropdownMenuItem.displayName = ITEM_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * DropdownMenuCheckboxItem\n * -----------------------------------------------------------------------------------------------*/\n\nconst CHECKBOX_ITEM_NAME = 'DropdownMenuCheckboxItem';\n\ntype DropdownMenuCheckboxItemElement = React.ElementRef<typeof MenuPrimitive.CheckboxItem>;\ntype MenuCheckboxItemProps = Radix.ComponentPropsWithoutRef<typeof MenuPrimitive.CheckboxItem>;\ninterface DropdownMenuCheckboxItemProps extends MenuCheckboxItemProps {}\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n  DropdownMenuCheckboxItemElement,\n  DropdownMenuCheckboxItemProps\n>((props: ScopedProps<DropdownMenuCheckboxItemProps>, forwardedRef) => {\n  const { __scopeDropdownMenu, ...checkboxItemProps } = props;\n  const menuScope = useMenuScope(__scopeDropdownMenu);\n  return <MenuPrimitive.CheckboxItem {...menuScope} {...checkboxItemProps} ref={forwardedRef} />;\n});\n\nDropdownMenuCheckboxItem.displayName = CHECKBOX_ITEM_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * DropdownMenuRadioGroup\n * -----------------------------------------------------------------------------------------------*/\n\nconst RADIO_GROUP_NAME = 'DropdownMenuRadioGroup';\n\ntype DropdownMenuRadioGroupElement = React.ElementRef<typeof MenuPrimitive.RadioGroup>;\ntype MenuRadioGroupProps = Radix.ComponentPropsWithoutRef<typeof MenuPrimitive.RadioGroup>;\ninterface DropdownMenuRadioGroupProps extends MenuRadioGroupProps {}\n\nconst DropdownMenuRadioGroup = React.forwardRef<\n  DropdownMenuRadioGroupElement,\n  DropdownMenuRadioGroupProps\n>((props: ScopedProps<DropdownMenuRadioGroupProps>, forwardedRef) => {\n  const { __scopeDropdownMenu, ...radioGroupProps } = props;\n  const menuScope = useMenuScope(__scopeDropdownMenu);\n  return <MenuPrimitive.RadioGroup {...menuScope} {...radioGroupProps} ref={forwardedRef} />;\n});\n\nDropdownMenuRadioGroup.displayName = RADIO_GROUP_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * DropdownMenuRadioItem\n * -----------------------------------------------------------------------------------------------*/\n\nconst RADIO_ITEM_NAME = 'DropdownMenuRadioItem';\n\ntype DropdownMenuRadioItemElement = React.ElementRef<typeof MenuPrimitive.RadioItem>;\ntype MenuRadioItemProps = Radix.ComponentPropsWithoutRef<typeof MenuPrimitive.RadioItem>;\ninterface DropdownMenuRadioItemProps extends MenuRadioItemProps {}\n\nconst DropdownMenuRadioItem = React.forwardRef<\n  DropdownMenuRadioItemElement,\n  DropdownMenuRadioItemProps\n>((props: ScopedProps<DropdownMenuRadioItemProps>, forwardedRef) => {\n  const { __scopeDropdownMenu, ...radioItemProps } = props;\n  const menuScope = useMenuScope(__scopeDropdownMenu);\n  return <MenuPrimitive.RadioItem {...menuScope} {...radioItemProps} ref={forwardedRef} />;\n});\n\nDropdownMenuRadioItem.displayName = RADIO_ITEM_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * DropdownMenuItemIndicator\n * -----------------------------------------------------------------------------------------------*/\n\nconst INDICATOR_NAME = 'DropdownMenuItemIndicator';\n\ntype DropdownMenuItemIndicatorElement = React.ElementRef<typeof MenuPrimitive.ItemIndicator>;\ntype MenuItemIndicatorProps = Radix.ComponentPropsWithoutRef<typeof MenuPrimitive.ItemIndicator>;\ninterface DropdownMenuItemIndicatorProps extends MenuItemIndicatorProps {}\n\nconst DropdownMenuItemIndicator = React.forwardRef<\n  DropdownMenuItemIndicatorElement,\n  DropdownMenuItemIndicatorProps\n>((props: ScopedProps<DropdownMenuItemIndicatorProps>, forwardedRef) => {\n  const { __scopeDropdownMenu, ...itemIndicatorProps } = props;\n  const menuScope = useMenuScope(__scopeDropdownMenu);\n  return <MenuPrimitive.ItemIndicator {...menuScope} {...itemIndicatorProps} ref={forwardedRef} />;\n});\n\nDropdownMenuItemIndicator.displayName = INDICATOR_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * DropdownMenuSeparator\n * -----------------------------------------------------------------------------------------------*/\n\nconst SEPARATOR_NAME = 'DropdownMenuSeparator';\n\ntype DropdownMenuSeparatorElement = React.ElementRef<typeof MenuPrimitive.Separator>;\ntype MenuSeparatorProps = Radix.ComponentPropsWithoutRef<typeof MenuPrimitive.Separator>;\ninterface DropdownMenuSeparatorProps extends MenuSeparatorProps {}\n\nconst DropdownMenuSeparator = React.forwardRef<\n  DropdownMenuSeparatorElement,\n  DropdownMenuSeparatorProps\n>((props: ScopedProps<DropdownMenuSeparatorProps>, forwardedRef) => {\n  const { __scopeDropdownMenu, ...separatorProps } = props;\n  const menuScope = useMenuScope(__scopeDropdownMenu);\n  return <MenuPrimitive.Separator {...menuScope} {...separatorProps} ref={forwardedRef} />;\n});\n\nDropdownMenuSeparator.displayName = SEPARATOR_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * DropdownMenuArrow\n * -----------------------------------------------------------------------------------------------*/\n\nconst ARROW_NAME = 'DropdownMenuArrow';\n\ntype DropdownMenuArrowElement = React.ElementRef<typeof MenuPrimitive.Arrow>;\ntype MenuArrowProps = Radix.ComponentPropsWithoutRef<typeof MenuPrimitive.Arrow>;\ninterface DropdownMenuArrowProps extends MenuArrowProps {}\n\nconst DropdownMenuArrow = React.forwardRef<DropdownMenuArrowElement, DropdownMenuArrowProps>(\n  (props: ScopedProps<DropdownMenuArrowProps>, forwardedRef) => {\n    const { __scopeDropdownMenu, ...arrowProps } = props;\n    const menuScope = useMenuScope(__scopeDropdownMenu);\n    return <MenuPrimitive.Arrow {...menuScope} {...arrowProps} ref={forwardedRef} />;\n  }\n);\n\nDropdownMenuArrow.displayName = ARROW_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * DropdownMenuSub\n * -----------------------------------------------------------------------------------------------*/\n\ninterface DropdownMenuSubProps {\n  children?: React.ReactNode;\n  open?: boolean;\n  defaultOpen?: boolean;\n  onOpenChange?(open: boolean): void;\n}\n\nconst DropdownMenuSub: React.FC<DropdownMenuSubProps> = (\n  props: ScopedProps<DropdownMenuSubProps>\n) => {\n  const { __scopeDropdownMenu, children, open: openProp, onOpenChange, defaultOpen } = props;\n  const menuScope = useMenuScope(__scopeDropdownMenu);\n  const [open = false, setOpen] = useControllableState({\n    prop: openProp,\n    defaultProp: defaultOpen,\n    onChange: onOpenChange,\n  });\n\n  return (\n    <MenuPrimitive.Sub {...menuScope} open={open} onOpenChange={setOpen}>\n      {children}\n    </MenuPrimitive.Sub>\n  );\n};\n\n/* -------------------------------------------------------------------------------------------------\n * DropdownMenuSubTrigger\n * -----------------------------------------------------------------------------------------------*/\n\nconst SUB_TRIGGER_NAME = 'DropdownMenuSubTrigger';\n\ntype DropdownMenuSubTriggerElement = React.ElementRef<typeof MenuPrimitive.SubTrigger>;\ntype MenuSubTriggerProps = Radix.ComponentPropsWithoutRef<typeof MenuPrimitive.SubTrigger>;\ninterface DropdownMenuSubTriggerProps extends MenuSubTriggerProps {}\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n  DropdownMenuSubTriggerElement,\n  DropdownMenuSubTriggerProps\n>((props: ScopedProps<DropdownMenuSubTriggerProps>, forwardedRef) => {\n  const { __scopeDropdownMenu, ...subTriggerProps } = props;\n  const menuScope = useMenuScope(__scopeDropdownMenu);\n  return <MenuPrimitive.SubTrigger {...menuScope} {...subTriggerProps} ref={forwardedRef} />;\n});\n\nDropdownMenuSubTrigger.displayName = SUB_TRIGGER_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * DropdownMenuSubContent\n * -----------------------------------------------------------------------------------------------*/\n\nconst SUB_CONTENT_NAME = 'DropdownMenuSubContent';\n\ntype DropdownMenuSubContentElement = React.ElementRef<typeof MenuPrimitive.Content>;\ntype MenuSubContentProps = Radix.ComponentPropsWithoutRef<typeof MenuPrimitive.SubContent>;\ninterface DropdownMenuSubContentProps extends MenuSubContentProps {}\n\nconst DropdownMenuSubContent = React.forwardRef<\n  DropdownMenuSubContentElement,\n  DropdownMenuSubContentProps\n>((props: ScopedProps<DropdownMenuSubContentProps>, forwardedRef) => {\n  const { __scopeDropdownMenu, ...subContentProps } = props;\n  const menuScope = useMenuScope(__scopeDropdownMenu);\n\n  return (\n    <MenuPrimitive.SubContent\n      {...menuScope}\n      {...subContentProps}\n      ref={forwardedRef}\n      style={{\n        ...props.style,\n        // re-namespace exposed content custom properties\n        ...{\n          '--radix-dropdown-menu-content-transform-origin': 'var(--radix-popper-transform-origin)',\n          '--radix-dropdown-menu-content-available-width': 'var(--radix-popper-available-width)',\n          '--radix-dropdown-menu-content-available-height': 'var(--radix-popper-available-height)',\n          '--radix-dropdown-menu-trigger-width': 'var(--radix-popper-anchor-width)',\n          '--radix-dropdown-menu-trigger-height': 'var(--radix-popper-anchor-height)',\n        },\n      }}\n    />\n  );\n});\n\nDropdownMenuSubContent.displayName = SUB_CONTENT_NAME;\n\n/* -----------------------------------------------------------------------------------------------*/\n\nconst Root = DropdownMenu;\nconst Trigger = DropdownMenuTrigger;\nconst Portal = DropdownMenuPortal;\nconst Content = DropdownMenuContent;\nconst Group = DropdownMenuGroup;\nconst Label = DropdownMenuLabel;\nconst Item = DropdownMenuItem;\nconst CheckboxItem = DropdownMenuCheckboxItem;\nconst RadioGroup = DropdownMenuRadioGroup;\nconst RadioItem = DropdownMenuRadioItem;\nconst ItemIndicator = DropdownMenuItemIndicator;\nconst Separator = DropdownMenuSeparator;\nconst Arrow = DropdownMenuArrow;\nconst Sub = DropdownMenuSub;\nconst SubTrigger = DropdownMenuSubTrigger;\nconst SubContent = DropdownMenuSubContent;\n\nexport {\n  createDropdownMenuScope,\n  //\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuPortal,\n  DropdownMenuContent,\n  DropdownMenuGroup,\n  DropdownMenuLabel,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioGroup,\n  DropdownMenuRadioItem,\n  DropdownMenuItemIndicator,\n  DropdownMenuSeparator,\n  DropdownMenuArrow,\n  DropdownMenuSub,\n  DropdownMenuSubTrigger,\n  DropdownMenuSubContent,\n  //\n  Root,\n  Trigger,\n  Portal,\n  Content,\n  Group,\n  Label,\n  Item,\n  CheckboxItem,\n  RadioGroup,\n  RadioItem,\n  ItemIndicator,\n  Separator,\n  Arrow,\n  Sub,\n  SubTrigger,\n  SubContent,\n};\nexport type {\n  DropdownMenuProps,\n  DropdownMenuTriggerProps,\n  DropdownMenuPortalProps,\n  DropdownMenuContentProps,\n  DropdownMenuGroupProps,\n  DropdownMenuLabelProps,\n  DropdownMenuItemProps,\n  DropdownMenuCheckboxItemProps,\n  DropdownMenuRadioGroupProps,\n  DropdownMenuRadioItemProps,\n  DropdownMenuItemIndicatorProps,\n  DropdownMenuSeparatorProps,\n  DropdownMenuArrowProps,\n  DropdownMenuSubProps,\n  DropdownMenuSubTriggerProps,\n  DropdownMenuSubContentProps,\n};\n","import * as DropdownMenu from '@radix-ui/react-dropdown-menu'\nimport { preventDefault, useContainer } from '@tldraw/editor'\nimport { TLTranslationKey, useMenuIsOpen } from '../../../hooks'\nimport { Button, ButtonProps } from '../Button'\nimport { Icon } from '../Icon'\n\n/** @public */\nexport function Root({\n\tid,\n\topen,\n\tchildren,\n\tmodal = false,\n}: {\n\tid: string\n\tchildren: any\n\topen?: boolean\n\tmodal?: boolean\n}) {\n\tconst onOpenChange = useMenuIsOpen(id)\n\n\treturn (\n\t\t<DropdownMenu.Root open={open} dir=\"ltr\" modal={modal} onOpenChange={onOpenChange}>\n\t\t\t{children}\n\t\t</DropdownMenu.Root>\n\t)\n}\n\n/** @public */\nexport function Trigger({ children, 'data-wd': dataWd }: { children: any; 'data-wd'?: string }) {\n\treturn (\n\t\t<DropdownMenu.Trigger dir=\"ltr\" data-wd={dataWd} asChild>\n\t\t\t{children}\n\t\t</DropdownMenu.Trigger>\n\t)\n}\n\n/** @public */\nexport function Content({\n\tside = 'bottom',\n\talign = 'start',\n\tsideOffset = 8,\n\talignOffset = 8,\n\tchildren,\n}: {\n\tchildren: any\n\talignOffset?: number\n\tsideOffset?: number\n\talign?: 'start' | 'center' | 'end'\n\tside?: 'bottom' | 'top' | 'right' | 'left'\n}) {\n\tconst container = useContainer()\n\n\treturn (\n\t\t<DropdownMenu.Portal dir=\"ltr\" container={container}>\n\t\t\t<DropdownMenu.Content\n\t\t\t\tclassName=\"tlui-menu\"\n\t\t\t\talign={align}\n\t\t\t\tsideOffset={sideOffset}\n\t\t\t\tside={side}\n\t\t\t\talignOffset={alignOffset}\n\t\t\t\tcollisionPadding={4}\n\t\t\t>\n\t\t\t\t{children}\n\t\t\t</DropdownMenu.Content>\n\t\t</DropdownMenu.Portal>\n\t)\n}\n\n/** @public */\nexport function Sub({ id, children, open }: { id: string; children: any; open?: boolean }) {\n\tconst onOpenChange = useMenuIsOpen(id)\n\n\treturn (\n\t\t<DropdownMenu.Sub open={open} onOpenChange={onOpenChange}>\n\t\t\t{children}\n\t\t</DropdownMenu.Sub>\n\t)\n}\n\n/** @public */\nexport function SubTrigger({\n\tlabel,\n\t'data-wd': dataWd,\n\t'data-direction': dataDirection,\n}: {\n\tlabel: TLTranslationKey\n\t'data-wd'?: string\n\t'data-direction'?: 'left' | 'right'\n}) {\n\treturn (\n\t\t<DropdownMenu.SubTrigger dir=\"ltr\" data-direction={dataDirection} data-wd={dataWd} asChild>\n\t\t\t<Button\n\t\t\t\tclassName=\"tlui-menu__button tlui-menu__submenu__trigger\"\n\t\t\t\tlabel={label}\n\t\t\t\ticon=\"chevron-right\"\n\t\t\t/>\n\t\t</DropdownMenu.SubTrigger>\n\t)\n}\n\n/** @public */\nexport function SubContent({\n\talignOffset = 0,\n\tsideOffset = 5,\n\tchildren,\n}: {\n\talignOffset?: number\n\tsideOffset?: number\n\tchildren: any\n}) {\n\tconst container = useContainer()\n\treturn (\n\t\t<DropdownMenu.Portal container={container} dir=\"ltr\">\n\t\t\t<DropdownMenu.SubContent\n\t\t\t\tclassName=\"tlui-menu tlui-menu__submenu__content\"\n\t\t\t\talignOffset={alignOffset}\n\t\t\t\tsideOffset={sideOffset}\n\t\t\t\tcollisionPadding={4}\n\t\t\t>\n\t\t\t\t{children}\n\t\t\t</DropdownMenu.SubContent>\n\t\t</DropdownMenu.Portal>\n\t)\n}\n\n/** @public */\nexport function Group({\n\tchildren,\n\tsize = 'medium',\n}: {\n\tchildren: any\n\tsize?: 'tiny' | 'small' | 'medium' | 'wide'\n}) {\n\treturn (\n\t\t<DropdownMenu.Group dir=\"ltr\" className=\"tlui-menu__group\" data-size={size}>\n\t\t\t{children}\n\t\t</DropdownMenu.Group>\n\t)\n}\n\n/** @public */\nexport function Indicator() {\n\treturn (\n\t\t<DropdownMenu.ItemIndicator dir=\"ltr\" asChild>\n\t\t\t<Icon icon=\"check\" />\n\t\t</DropdownMenu.ItemIndicator>\n\t)\n}\n\n/** @public */\nexport interface DropdownMenuItemProps extends ButtonProps {\n\tnoClose?: boolean\n}\n\n/** @public */\nexport function Item({ noClose, ...props }: DropdownMenuItemProps) {\n\treturn (\n\t\t<DropdownMenu.Item\n\t\t\tdir=\"ltr\"\n\t\t\tasChild\n\t\t\tonClick={noClose || props.isChecked !== undefined ? preventDefault : undefined}\n\t\t>\n\t\t\t<Button className=\"tlui-menu__button\" {...props} />\n\t\t</DropdownMenu.Item>\n\t)\n}\n\n/** @public */\nexport interface DropdownMenuCheckboxItemProps {\n\tchecked?: boolean\n\tonSelect?: (e: Event) => void\n\tdisabled?: boolean\n\ttitle: string\n\tchildren: any\n}\n\n/** @public */\nexport function CheckboxItem({ children, onSelect, ...rest }: DropdownMenuCheckboxItemProps) {\n\treturn (\n\t\t<DropdownMenu.CheckboxItem\n\t\t\tdir=\"ltr\"\n\t\t\tclassName=\"tlui-button tlui-menu__button tlui-menu__checkbox-item\"\n\t\t\tonSelect={(e) => {\n\t\t\t\tonSelect?.(e)\n\t\t\t\tpreventDefault(e)\n\t\t\t}}\n\t\t\t{...rest}\n\t\t>\n\t\t\t<div\n\t\t\t\tclassName=\"tlui-menu__checkbox-item__check\"\n\t\t\t\tstyle={{\n\t\t\t\t\ttransformOrigin: '75% center',\n\t\t\t\t\ttransform: `scale(${rest.checked ? 1 : 0.5})`,\n\t\t\t\t\topacity: rest.checked ? 1 : 0.5,\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<Icon small icon={rest.checked ? 'check' : 'checkbox-empty'} />\n\t\t\t</div>\n\t\t\t{children}\n\t\t</DropdownMenu.CheckboxItem>\n\t)\n}\n\n/** @public */\nexport function RadioItem({ children, onSelect, ...rest }: DropdownMenuCheckboxItemProps) {\n\treturn (\n\t\t<DropdownMenu.CheckboxItem\n\t\t\tdir=\"ltr\"\n\t\t\tclassName=\"tlui-button tlui-menu__button tlui-menu__checkbox-item\"\n\t\t\tonSelect={(e) => {\n\t\t\t\tonSelect?.(e)\n\t\t\t\tpreventDefault(e)\n\t\t\t}}\n\t\t\t{...rest}\n\t\t>\n\t\t\t<DropdownMenu.ItemIndicator dir=\"ltr\" className=\"tlui-menu__checkbox-item__check\">\n\t\t\t\t<Icon icon=\"check\" />\n\t\t\t</DropdownMenu.ItemIndicator>\n\t\t\t{children}\n\t\t</DropdownMenu.CheckboxItem>\n\t)\n}\n","import { TLStyleItem, TLStyleType, useApp } from '@tldraw/editor'\nimport classNames from 'classnames'\nimport * as React from 'react'\nimport { useRef } from 'react'\nimport { TLTranslationKey, useTranslation } from '../../../hooks'\nimport { TLUiIconType } from '../../../icon-types'\nimport { Button } from '../Button'\n\n/** @public */\nexport interface ButtonPickerProps<T extends TLStyleItem> {\n\ttitle: string\n\titems: T[]\n\tstyleType: TLStyleType\n\tvalue?: string | number | null\n\tcolumns?: 2 | 3 | 4\n\t'data-wd'?: string\n\tonValueChange: (item: T, squashing: boolean) => void\n}\n\nfunction _ButtonPicker<T extends TLStyleItem>(props: ButtonPickerProps<T>) {\n\tconst {\n\t\titems,\n\t\ttitle,\n\t\tstyleType,\n\t\tvalue = null,\n\t\tonValueChange,\n\t\tcolumns = items.length < 4 ? 2 : 4,\n\t} = props\n\tconst app = useApp()\n\tconst msg = useTranslation()\n\n\tconst rPointing = useRef(false)\n\n\tconst {\n\t\thandleButtonClick,\n\t\thandleButtonPointerDown,\n\t\thandleButtonPointerEnter,\n\t\thandleButtonPointerUp,\n\t} = React.useMemo(() => {\n\t\tconst handlePointerUp = () => {\n\t\t\trPointing.current = false\n\t\t\twindow.removeEventListener('pointerup', handlePointerUp)\n\t\t}\n\n\t\tconst handleButtonClick = (e: React.PointerEvent<HTMLButtonElement>) => {\n\t\t\tconst { id } = e.currentTarget.dataset\n\t\t\tif (value === id) return\n\n\t\t\tapp.mark('point picker item')\n\t\t\tonValueChange(items.find((i) => i.id === id)!, false)\n\t\t}\n\n\t\tconst handleButtonPointerDown = (e: React.PointerEvent<HTMLButtonElement>) => {\n\t\t\tconst { id } = e.currentTarget.dataset\n\n\t\t\tapp.mark('point picker item')\n\t\t\tonValueChange(items.find((i) => i.id === id)!, true)\n\n\t\t\trPointing.current = true\n\t\t\twindow.addEventListener('pointerup', handlePointerUp) // see TLD-658\n\t\t}\n\n\t\tconst handleButtonPointerEnter = (e: React.PointerEvent<HTMLButtonElement>) => {\n\t\t\tif (!rPointing.current) return\n\n\t\t\tconst { id } = e.currentTarget.dataset\n\t\t\tonValueChange(items.find((i) => i.id === id)!, true)\n\t\t}\n\n\t\tconst handleButtonPointerUp = (e: React.PointerEvent<HTMLButtonElement>) => {\n\t\t\tconst { id } = e.currentTarget.dataset\n\t\t\tonValueChange(items.find((i) => i.id === id)!, false)\n\t\t}\n\n\t\treturn {\n\t\t\thandleButtonClick,\n\t\t\thandleButtonPointerDown,\n\t\t\thandleButtonPointerEnter,\n\t\t\thandleButtonPointerUp,\n\t\t}\n\t}, [app, value, onValueChange, items])\n\n\treturn (\n\t\t<div\n\t\t\tclassName={classNames('tlui-button-grid', {\n\t\t\t\t'tlui-button-grid__two': columns === 2,\n\t\t\t\t'tlui-button-grid__three': columns === 3,\n\t\t\t\t'tlui-button-grid__four': columns === 4,\n\t\t\t})}\n\t\t>\n\t\t\t{items.map((item) => (\n\t\t\t\t<Button\n\t\t\t\t\tkey={item.id}\n\t\t\t\t\tdata-id={item.id}\n\t\t\t\t\tdata-wd={`${props['data-wd']}.${item.id}`}\n\t\t\t\t\taria-label={item.id}\n\t\t\t\t\tdata-state={value === item.id ? 'hinted' : undefined}\n\t\t\t\t\ttitle={title + '  ' + msg(`${styleType}-style.${item.id}` as TLTranslationKey)}\n\t\t\t\t\tclassName={classNames('tlui-button-grid__button')}\n\t\t\t\t\tstyle={item.type === 'color' ? { color: `var(--palette-${item.id})` } : undefined}\n\t\t\t\t\tonPointerEnter={handleButtonPointerEnter}\n\t\t\t\t\tonPointerDown={handleButtonPointerDown}\n\t\t\t\t\tonPointerUp={handleButtonPointerUp}\n\t\t\t\t\tonClick={handleButtonClick}\n\t\t\t\t\ticon={item.icon as TLUiIconType}\n\t\t\t\t/>\n\t\t\t))}\n\t\t</div>\n\t)\n}\n\n/** @public */\nexport const ButtonPicker = React.memo(_ButtonPicker)\n","import classNames from 'classnames'\nimport * as React from 'react'\nimport { TLTranslationKey, useTranslation } from '../../../hooks'\nimport { TLUiIconType } from '../../../icon-types'\nimport { Icon } from '../Icon'\n\n/** @public */\nexport interface InputProps {\n\tdisabled?: boolean\n\tlabel?: TLTranslationKey\n\ticon?: TLUiIconType\n\ticonLeft?: TLUiIconType\n\tautofocus?: boolean\n\tautoselect?: boolean\n\tchildren?: any\n\tdefaultValue?: string\n\tplaceholder?: string\n\tonComplete?: (value: string) => void\n\tonValueChange?: (value: string) => void\n\tonCancel?: (value: string) => void\n\tclassName?: string\n\t/**\n\t * Usually on iOS when you focus an input, the browser will adjust the\n\t * viewport to bring the input into view. Sometimes this doesn't work\n\t * properly though - for example, if the input is newly created, iOS seems\n\t * to have a hard time adjusting the viewport for it. This prop allows you\n\t * to opt-in to some extra code to manually bring the input into view when\n\t * the visual viewport of the browser changes, but we don't want to use it\n\t * everywhere because generally the native behavior looks nicer in scenarios\n\t * where it's sufficient.\n\t */\n\tshouldManuallyMaintainScrollPositionWhenFocused?: boolean\n}\n\n/** @public */\nexport const Input = React.forwardRef<HTMLInputElement, InputProps>(function Input(\n\t{\n\t\tclassName,\n\t\tlabel,\n\t\ticon,\n\t\ticonLeft,\n\t\tautoselect = false,\n\t\tautofocus = false,\n\t\tdefaultValue,\n\t\tplaceholder,\n\t\tonComplete,\n\t\tonValueChange,\n\t\tonCancel,\n\t\tshouldManuallyMaintainScrollPositionWhenFocused = false,\n\t\tchildren,\n\t},\n\tref\n) {\n\tconst rInputRef = React.useRef<HTMLInputElement>(null)\n\n\t// combine rInputRef and ref\n\tReact.useImperativeHandle(ref, () => rInputRef.current as HTMLInputElement)\n\n\tconst msg = useTranslation()\n\tconst rInitialValue = React.useRef<string>(defaultValue ?? '')\n\tconst rCurrentValue = React.useRef<string>(defaultValue ?? '')\n\n\tconst [isFocused, setIsFocused] = React.useState(false)\n\tconst handleFocus = React.useCallback(\n\t\t(e: React.FocusEvent<HTMLInputElement>) => {\n\t\t\tsetIsFocused(true)\n\t\t\tconst elm = e.currentTarget as HTMLInputElement\n\t\t\trCurrentValue.current = elm.value\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tif (autoselect) {\n\t\t\t\t\telm.select()\n\t\t\t\t}\n\t\t\t})\n\t\t},\n\t\t[autoselect]\n\t)\n\n\tconst handleChange = React.useCallback(\n\t\t(e: React.ChangeEvent<HTMLInputElement>) => {\n\t\t\tconst value = e.currentTarget.value\n\t\t\trCurrentValue.current = value\n\t\t\tonValueChange?.(value)\n\t\t},\n\t\t[onValueChange]\n\t)\n\n\tconst handleKeyUp = React.useCallback(\n\t\t(e: React.KeyboardEvent<HTMLInputElement>) => {\n\t\t\tswitch (e.key) {\n\t\t\t\tcase 'Enter': {\n\t\t\t\t\te.currentTarget.blur()\n\t\t\t\t\te.stopPropagation()\n\t\t\t\t\tonComplete?.(e.currentTarget.value)\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t\tcase 'Escape': {\n\t\t\t\t\te.currentTarget.value = rInitialValue.current\n\t\t\t\t\te.currentTarget.blur()\n\t\t\t\t\te.stopPropagation()\n\t\t\t\t\tonCancel?.(e.currentTarget.value)\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t[onComplete, onCancel]\n\t)\n\n\tconst handleBlur = React.useCallback(() => setIsFocused(false), [])\n\n\tReact.useEffect(() => {\n\t\tconst visualViewport = window.visualViewport\n\t\tif (isFocused && shouldManuallyMaintainScrollPositionWhenFocused && visualViewport) {\n\t\t\tconst onViewportChange = () => {\n\t\t\t\trInputRef.current?.scrollIntoView({ block: 'center' })\n\t\t\t}\n\t\t\tvisualViewport.addEventListener('resize', onViewportChange)\n\t\t\tvisualViewport.addEventListener('scroll', onViewportChange)\n\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\trInputRef.current?.scrollIntoView({ block: 'center' })\n\t\t\t})\n\n\t\t\treturn () => {\n\t\t\t\tvisualViewport.removeEventListener('resize', onViewportChange)\n\t\t\t\tvisualViewport.removeEventListener('scroll', onViewportChange)\n\t\t\t}\n\t\t}\n\t}, [isFocused, shouldManuallyMaintainScrollPositionWhenFocused])\n\n\treturn (\n\t\t<div draggable={false} className=\"tlui-input__wrapper\">\n\t\t\t{children}\n\t\t\t{label && <label>{msg(label)}</label>}\n\t\t\t{iconLeft && <Icon icon={iconLeft} className=\"tlui-icon-left\" small />}\n\t\t\t<input\n\t\t\t\tref={rInputRef}\n\t\t\t\tclassName={classNames('tlui-input', className)}\n\t\t\t\ttype=\"text\"\n\t\t\t\tdefaultValue={defaultValue}\n\t\t\t\tonKeyUp={handleKeyUp}\n\t\t\t\tonChange={handleChange}\n\t\t\t\tonFocus={handleFocus}\n\t\t\t\tonBlur={handleBlur}\n\t\t\t\tautoFocus={autofocus}\n\t\t\t\tplaceholder={placeholder}\n\t\t\t/>\n\t\t\t{icon && <Icon icon={icon} small={!!label} />}\n\t\t</div>\n\t)\n})\n","import * as React from 'react';\nimport { clamp } from '@radix-ui/number';\nimport { composeEventHandlers } from '@radix-ui/primitive';\nimport { useComposedRefs } from '@radix-ui/react-compose-refs';\nimport { createContextScope } from '@radix-ui/react-context';\nimport { useControllableState } from '@radix-ui/react-use-controllable-state';\nimport { useDirection } from '@radix-ui/react-direction';\nimport { usePrevious } from '@radix-ui/react-use-previous';\nimport { useSize } from '@radix-ui/react-use-size';\nimport { Primitive } from '@radix-ui/react-primitive';\nimport { createCollection } from '@radix-ui/react-collection';\n\nimport type * as Radix from '@radix-ui/react-primitive';\nimport type { Scope } from '@radix-ui/react-context';\n\ntype Direction = 'ltr' | 'rtl';\n\nconst PAGE_KEYS = ['PageUp', 'PageDown'];\nconst ARROW_KEYS = ['ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight'];\n\ntype SlideDirection = 'from-left' | 'from-right' | 'from-bottom' | 'from-top';\nconst BACK_KEYS: Record<SlideDirection, string[]> = {\n  'from-left': ['Home', 'PageDown', 'ArrowDown', 'ArrowLeft'],\n  'from-right': ['Home', 'PageDown', 'ArrowDown', 'ArrowRight'],\n  'from-bottom': ['Home', 'PageDown', 'ArrowDown', 'ArrowLeft'],\n  'from-top': ['Home', 'PageDown', 'ArrowUp', 'ArrowLeft'],\n};\n\n/* -------------------------------------------------------------------------------------------------\n * Slider\n * -----------------------------------------------------------------------------------------------*/\n\nconst SLIDER_NAME = 'Slider';\n\nconst [Collection, useCollection, createCollectionScope] =\n  createCollection<SliderThumbElement>(SLIDER_NAME);\n\ntype ScopedProps<P> = P & { __scopeSlider?: Scope };\nconst [createSliderContext, createSliderScope] = createContextScope(SLIDER_NAME, [\n  createCollectionScope,\n]);\n\ntype SliderContextValue = {\n  disabled?: boolean;\n  min: number;\n  max: number;\n  values: number[];\n  valueIndexToChangeRef: React.MutableRefObject<number>;\n  thumbs: Set<SliderThumbElement>;\n  orientation: SliderProps['orientation'];\n};\n\nconst [SliderProvider, useSliderContext] = createSliderContext<SliderContextValue>(SLIDER_NAME);\n\ntype SliderElement = SliderHorizontalElement | SliderVerticalElement;\ninterface SliderProps\n  extends Omit<\n    SliderHorizontalProps | SliderVerticalProps,\n    keyof SliderOrientationPrivateProps | 'defaultValue'\n  > {\n  name?: string;\n  disabled?: boolean;\n  orientation?: React.AriaAttributes['aria-orientation'];\n  dir?: Direction;\n  min?: number;\n  max?: number;\n  step?: number;\n  minStepsBetweenThumbs?: number;\n  value?: number[];\n  defaultValue?: number[];\n  onValueChange?(value: number[]): void;\n  onValueCommit?(value: number[]): void;\n  inverted?: boolean;\n}\n\nconst Slider = React.forwardRef<SliderElement, SliderProps>(\n  (props: ScopedProps<SliderProps>, forwardedRef) => {\n    const {\n      name,\n      min = 0,\n      max = 100,\n      step = 1,\n      orientation = 'horizontal',\n      disabled = false,\n      minStepsBetweenThumbs = 0,\n      defaultValue = [min],\n      value,\n      onValueChange = () => {},\n      onValueCommit = () => {},\n      inverted = false,\n      ...sliderProps\n    } = props;\n    const [slider, setSlider] = React.useState<HTMLSpanElement | null>(null);\n    const composedRefs = useComposedRefs(forwardedRef, (node) => setSlider(node));\n    const thumbRefs = React.useRef<SliderContextValue['thumbs']>(new Set());\n    const valueIndexToChangeRef = React.useRef<number>(0);\n    const isHorizontal = orientation === 'horizontal';\n    // We set this to true by default so that events bubble to forms without JS (SSR)\n    const isFormControl = slider ? Boolean(slider.closest('form')) : true;\n    const SliderOrientation = isHorizontal ? SliderHorizontal : SliderVertical;\n\n    const [values = [], setValues] = useControllableState({\n      prop: value,\n      defaultProp: defaultValue,\n      onChange: (value) => {\n        const thumbs = [...thumbRefs.current];\n        thumbs[valueIndexToChangeRef.current]?.focus();\n        onValueChange(value);\n      },\n    });\n    const valuesBeforeSlideStartRef = React.useRef(values);\n\n    function handleSlideStart(value: number) {\n      const closestIndex = getClosestValueIndex(values, value);\n      updateValues(value, closestIndex);\n    }\n\n    function handleSlideMove(value: number) {\n      updateValues(value, valueIndexToChangeRef.current);\n    }\n\n    function handleSlideEnd() {\n      const prevValue = valuesBeforeSlideStartRef.current[valueIndexToChangeRef.current];\n      const nextValue = values[valueIndexToChangeRef.current];\n      const hasChanged = nextValue !== prevValue;\n      if (hasChanged) onValueCommit(values);\n    }\n\n    function updateValues(value: number, atIndex: number, { commit } = { commit: false }) {\n      const decimalCount = getDecimalCount(step);\n      const snapToStep = roundValue(Math.round((value - min) / step) * step + min, decimalCount);\n      const nextValue = clamp(snapToStep, [min, max]);\n\n      setValues((prevValues = []) => {\n        const nextValues = getNextSortedValues(prevValues, nextValue, atIndex);\n        if (hasMinStepsBetweenValues(nextValues, minStepsBetweenThumbs * step)) {\n          valueIndexToChangeRef.current = nextValues.indexOf(nextValue);\n          const hasChanged = String(nextValues) !== String(prevValues);\n          if (hasChanged && commit) onValueCommit(nextValues);\n          return hasChanged ? nextValues : prevValues;\n        } else {\n          return prevValues;\n        }\n      });\n    }\n\n    return (\n      <SliderProvider\n        scope={props.__scopeSlider}\n        disabled={disabled}\n        min={min}\n        max={max}\n        valueIndexToChangeRef={valueIndexToChangeRef}\n        thumbs={thumbRefs.current}\n        values={values}\n        orientation={orientation}\n      >\n        <Collection.Provider scope={props.__scopeSlider}>\n          <Collection.Slot scope={props.__scopeSlider}>\n            <SliderOrientation\n              aria-disabled={disabled}\n              data-disabled={disabled ? '' : undefined}\n              {...sliderProps}\n              ref={composedRefs}\n              onPointerDown={composeEventHandlers(sliderProps.onPointerDown, () => {\n                if (!disabled) valuesBeforeSlideStartRef.current = values;\n              })}\n              min={min}\n              max={max}\n              inverted={inverted}\n              onSlideStart={disabled ? undefined : handleSlideStart}\n              onSlideMove={disabled ? undefined : handleSlideMove}\n              onSlideEnd={disabled ? undefined : handleSlideEnd}\n              onHomeKeyDown={() => !disabled && updateValues(min, 0, { commit: true })}\n              onEndKeyDown={() =>\n                !disabled && updateValues(max, values.length - 1, { commit: true })\n              }\n              onStepKeyDown={({ event, direction: stepDirection }) => {\n                if (!disabled) {\n                  const isPageKey = PAGE_KEYS.includes(event.key);\n                  const isSkipKey = isPageKey || (event.shiftKey && ARROW_KEYS.includes(event.key));\n                  const multiplier = isSkipKey ? 10 : 1;\n                  const atIndex = valueIndexToChangeRef.current;\n                  const value = values[atIndex];\n                  const stepInDirection = step * multiplier * stepDirection;\n                  updateValues(value + stepInDirection, atIndex, { commit: true });\n                }\n              }}\n            />\n          </Collection.Slot>\n        </Collection.Provider>\n        {isFormControl &&\n          values.map((value, index) => (\n            <BubbleInput\n              key={index}\n              name={name ? name + (values.length > 1 ? '[]' : '') : undefined}\n              value={value}\n            />\n          ))}\n      </SliderProvider>\n    );\n  }\n);\n\nSlider.displayName = SLIDER_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * SliderHorizontal\n * -----------------------------------------------------------------------------------------------*/\n\ntype Side = 'top' | 'right' | 'bottom' | 'left';\n\nconst [SliderOrientationProvider, useSliderOrientationContext] = createSliderContext<{\n  startEdge: Side;\n  endEdge: Side;\n  size: keyof NonNullable<ReturnType<typeof useSize>>;\n  direction: number;\n}>(SLIDER_NAME, {\n  startEdge: 'left',\n  endEdge: 'right',\n  size: 'width',\n  direction: 1,\n});\n\ntype SliderOrientationPrivateProps = {\n  min: number;\n  max: number;\n  inverted: boolean;\n  onSlideStart?(value: number): void;\n  onSlideMove?(value: number): void;\n  onSlideEnd?(): void;\n  onHomeKeyDown(event: React.KeyboardEvent): void;\n  onEndKeyDown(event: React.KeyboardEvent): void;\n  onStepKeyDown(step: { event: React.KeyboardEvent; direction: number }): void;\n};\ninterface SliderOrientationProps\n  extends Omit<SliderImplProps, keyof SliderImplPrivateProps>,\n    SliderOrientationPrivateProps {}\n\ntype SliderHorizontalElement = SliderImplElement;\ninterface SliderHorizontalProps extends SliderOrientationProps {\n  dir?: Direction;\n}\n\nconst SliderHorizontal = React.forwardRef<SliderHorizontalElement, SliderHorizontalProps>(\n  (props: ScopedProps<SliderHorizontalProps>, forwardedRef) => {\n    const {\n      min,\n      max,\n      dir,\n      inverted,\n      onSlideStart,\n      onSlideMove,\n      onSlideEnd,\n      onStepKeyDown,\n      ...sliderProps\n    } = props;\n    const [slider, setSlider] = React.useState<SliderImplElement | null>(null);\n    const composedRefs = useComposedRefs(forwardedRef, (node) => setSlider(node));\n    const rectRef = React.useRef<ClientRect>();\n    const direction = useDirection(dir);\n    const isDirectionLTR = direction === 'ltr';\n    const isSlidingFromLeft = (isDirectionLTR && !inverted) || (!isDirectionLTR && inverted);\n\n    function getValueFromPointer(pointerPosition: number) {\n      const rect = rectRef.current || slider!.getBoundingClientRect();\n      const input: [number, number] = [0, rect.width];\n      const output: [number, number] = isSlidingFromLeft ? [min, max] : [max, min];\n      const value = linearScale(input, output);\n\n      rectRef.current = rect;\n      return value(pointerPosition - rect.left);\n    }\n\n    return (\n      <SliderOrientationProvider\n        scope={props.__scopeSlider}\n        startEdge={isSlidingFromLeft ? 'left' : 'right'}\n        endEdge={isSlidingFromLeft ? 'right' : 'left'}\n        direction={isSlidingFromLeft ? 1 : -1}\n        size=\"width\"\n      >\n        <SliderImpl\n          dir={direction}\n          data-orientation=\"horizontal\"\n          {...sliderProps}\n          ref={composedRefs}\n          style={{\n            ...sliderProps.style,\n            ['--radix-slider-thumb-transform' as any]: 'translateX(-50%)',\n          }}\n          onSlideStart={(event) => {\n            const value = getValueFromPointer(event.clientX);\n            onSlideStart?.(value);\n          }}\n          onSlideMove={(event) => {\n            const value = getValueFromPointer(event.clientX);\n            onSlideMove?.(value);\n          }}\n          onSlideEnd={() => {\n            rectRef.current = undefined;\n            onSlideEnd?.();\n          }}\n          onStepKeyDown={(event) => {\n            const slideDirection = isSlidingFromLeft ? 'from-left' : 'from-right';\n            const isBackKey = BACK_KEYS[slideDirection].includes(event.key);\n            onStepKeyDown?.({ event, direction: isBackKey ? -1 : 1 });\n          }}\n        />\n      </SliderOrientationProvider>\n    );\n  }\n);\n\n/* -------------------------------------------------------------------------------------------------\n * SliderVertical\n * -----------------------------------------------------------------------------------------------*/\n\ntype SliderVerticalElement = SliderImplElement;\ninterface SliderVerticalProps extends SliderOrientationProps {}\n\nconst SliderVertical = React.forwardRef<SliderVerticalElement, SliderVerticalProps>(\n  (props: ScopedProps<SliderVerticalProps>, forwardedRef) => {\n    const {\n      min,\n      max,\n      inverted,\n      onSlideStart,\n      onSlideMove,\n      onSlideEnd,\n      onStepKeyDown,\n      ...sliderProps\n    } = props;\n    const sliderRef = React.useRef<SliderImplElement>(null);\n    const ref = useComposedRefs(forwardedRef, sliderRef);\n    const rectRef = React.useRef<ClientRect>();\n    const isSlidingFromBottom = !inverted;\n\n    function getValueFromPointer(pointerPosition: number) {\n      const rect = rectRef.current || sliderRef.current!.getBoundingClientRect();\n      const input: [number, number] = [0, rect.height];\n      const output: [number, number] = isSlidingFromBottom ? [max, min] : [min, max];\n      const value = linearScale(input, output);\n\n      rectRef.current = rect;\n      return value(pointerPosition - rect.top);\n    }\n\n    return (\n      <SliderOrientationProvider\n        scope={props.__scopeSlider}\n        startEdge={isSlidingFromBottom ? 'bottom' : 'top'}\n        endEdge={isSlidingFromBottom ? 'top' : 'bottom'}\n        size=\"height\"\n        direction={isSlidingFromBottom ? 1 : -1}\n      >\n        <SliderImpl\n          data-orientation=\"vertical\"\n          {...sliderProps}\n          ref={ref}\n          style={{\n            ...sliderProps.style,\n            ['--radix-slider-thumb-transform' as any]: 'translateY(50%)',\n          }}\n          onSlideStart={(event) => {\n            const value = getValueFromPointer(event.clientY);\n            onSlideStart?.(value);\n          }}\n          onSlideMove={(event) => {\n            const value = getValueFromPointer(event.clientY);\n            onSlideMove?.(value);\n          }}\n          onSlideEnd={() => {\n            rectRef.current = undefined;\n            onSlideEnd?.();\n          }}\n          onStepKeyDown={(event) => {\n            const slideDirection = isSlidingFromBottom ? 'from-bottom' : 'from-top';\n            const isBackKey = BACK_KEYS[slideDirection].includes(event.key);\n            onStepKeyDown?.({ event, direction: isBackKey ? -1 : 1 });\n          }}\n        />\n      </SliderOrientationProvider>\n    );\n  }\n);\n\n/* -------------------------------------------------------------------------------------------------\n * SliderImpl\n * -----------------------------------------------------------------------------------------------*/\n\ntype SliderImplElement = React.ElementRef<typeof Primitive.span>;\ntype PrimitiveDivProps = Radix.ComponentPropsWithoutRef<typeof Primitive.div>;\ntype SliderImplPrivateProps = {\n  onSlideStart(event: React.PointerEvent): void;\n  onSlideMove(event: React.PointerEvent): void;\n  onSlideEnd(event: React.PointerEvent): void;\n  onHomeKeyDown(event: React.KeyboardEvent): void;\n  onEndKeyDown(event: React.KeyboardEvent): void;\n  onStepKeyDown(event: React.KeyboardEvent): void;\n};\ninterface SliderImplProps extends PrimitiveDivProps, SliderImplPrivateProps {}\n\nconst SliderImpl = React.forwardRef<SliderImplElement, SliderImplProps>(\n  (props: ScopedProps<SliderImplProps>, forwardedRef) => {\n    const {\n      __scopeSlider,\n      onSlideStart,\n      onSlideMove,\n      onSlideEnd,\n      onHomeKeyDown,\n      onEndKeyDown,\n      onStepKeyDown,\n      ...sliderProps\n    } = props;\n    const context = useSliderContext(SLIDER_NAME, __scopeSlider);\n\n    return (\n      <Primitive.span\n        {...sliderProps}\n        ref={forwardedRef}\n        onKeyDown={composeEventHandlers(props.onKeyDown, (event) => {\n          if (event.key === 'Home') {\n            onHomeKeyDown(event);\n            // Prevent scrolling to page start\n            event.preventDefault();\n          } else if (event.key === 'End') {\n            onEndKeyDown(event);\n            // Prevent scrolling to page end\n            event.preventDefault();\n          } else if (PAGE_KEYS.concat(ARROW_KEYS).includes(event.key)) {\n            onStepKeyDown(event);\n            // Prevent scrolling for directional key presses\n            event.preventDefault();\n          }\n        })}\n        onPointerDown={composeEventHandlers(props.onPointerDown, (event) => {\n          const target = event.target as HTMLElement;\n          target.setPointerCapture(event.pointerId);\n          // Prevent browser focus behaviour because we focus a thumb manually when values change.\n          event.preventDefault();\n          // Touch devices have a delay before focusing so won't focus if touch immediately moves\n          // away from target (sliding). We want thumb to focus regardless.\n          if (context.thumbs.has(target)) {\n            target.focus();\n          } else {\n            onSlideStart(event);\n          }\n        })}\n        onPointerMove={composeEventHandlers(props.onPointerMove, (event) => {\n          const target = event.target as HTMLElement;\n          if (target.hasPointerCapture(event.pointerId)) onSlideMove(event);\n        })}\n        onPointerUp={composeEventHandlers(props.onPointerUp, (event) => {\n          const target = event.target as HTMLElement;\n          if (target.hasPointerCapture(event.pointerId)) {\n            target.releasePointerCapture(event.pointerId);\n            onSlideEnd(event);\n          }\n        })}\n      />\n    );\n  }\n);\n\n/* -------------------------------------------------------------------------------------------------\n * SliderTrack\n * -----------------------------------------------------------------------------------------------*/\n\nconst TRACK_NAME = 'SliderTrack';\n\ntype SliderTrackElement = React.ElementRef<typeof Primitive.span>;\ntype PrimitiveSpanProps = Radix.ComponentPropsWithoutRef<typeof Primitive.span>;\ninterface SliderTrackProps extends PrimitiveSpanProps {}\n\nconst SliderTrack = React.forwardRef<SliderTrackElement, SliderTrackProps>(\n  (props: ScopedProps<SliderTrackProps>, forwardedRef) => {\n    const { __scopeSlider, ...trackProps } = props;\n    const context = useSliderContext(TRACK_NAME, __scopeSlider);\n    return (\n      <Primitive.span\n        data-disabled={context.disabled ? '' : undefined}\n        data-orientation={context.orientation}\n        {...trackProps}\n        ref={forwardedRef}\n      />\n    );\n  }\n);\n\nSliderTrack.displayName = TRACK_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * SliderRange\n * -----------------------------------------------------------------------------------------------*/\n\nconst RANGE_NAME = 'SliderRange';\n\ntype SliderRangeElement = React.ElementRef<typeof Primitive.span>;\ninterface SliderRangeProps extends PrimitiveSpanProps {}\n\nconst SliderRange = React.forwardRef<SliderRangeElement, SliderRangeProps>(\n  (props: ScopedProps<SliderRangeProps>, forwardedRef) => {\n    const { __scopeSlider, ...rangeProps } = props;\n    const context = useSliderContext(RANGE_NAME, __scopeSlider);\n    const orientation = useSliderOrientationContext(RANGE_NAME, __scopeSlider);\n    const ref = React.useRef<HTMLSpanElement>(null);\n    const composedRefs = useComposedRefs(forwardedRef, ref);\n    const valuesCount = context.values.length;\n    const percentages = context.values.map((value) =>\n      convertValueToPercentage(value, context.min, context.max)\n    );\n    const offsetStart = valuesCount > 1 ? Math.min(...percentages) : 0;\n    const offsetEnd = 100 - Math.max(...percentages);\n\n    return (\n      <Primitive.span\n        data-orientation={context.orientation}\n        data-disabled={context.disabled ? '' : undefined}\n        {...rangeProps}\n        ref={composedRefs}\n        style={{\n          ...props.style,\n          [orientation.startEdge]: offsetStart + '%',\n          [orientation.endEdge]: offsetEnd + '%',\n        }}\n      />\n    );\n  }\n);\n\nSliderRange.displayName = RANGE_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * SliderThumb\n * -----------------------------------------------------------------------------------------------*/\n\nconst THUMB_NAME = 'SliderThumb';\n\ntype SliderThumbElement = SliderThumbImplElement;\ninterface SliderThumbProps extends Omit<SliderThumbImplProps, 'index'> {}\n\nconst SliderThumb = React.forwardRef<SliderThumbElement, SliderThumbProps>(\n  (props: ScopedProps<SliderThumbProps>, forwardedRef) => {\n    const getItems = useCollection(props.__scopeSlider);\n    const [thumb, setThumb] = React.useState<SliderThumbImplElement | null>(null);\n    const composedRefs = useComposedRefs(forwardedRef, (node) => setThumb(node));\n    const index = React.useMemo(\n      () => (thumb ? getItems().findIndex((item) => item.ref.current === thumb) : -1),\n      [getItems, thumb]\n    );\n    return <SliderThumbImpl {...props} ref={composedRefs} index={index} />;\n  }\n);\n\ntype SliderThumbImplElement = React.ElementRef<typeof Primitive.span>;\ninterface SliderThumbImplProps extends PrimitiveSpanProps {\n  index: number;\n}\n\nconst SliderThumbImpl = React.forwardRef<SliderThumbImplElement, SliderThumbImplProps>(\n  (props: ScopedProps<SliderThumbImplProps>, forwardedRef) => {\n    const { __scopeSlider, index, ...thumbProps } = props;\n    const context = useSliderContext(THUMB_NAME, __scopeSlider);\n    const orientation = useSliderOrientationContext(THUMB_NAME, __scopeSlider);\n    const [thumb, setThumb] = React.useState<HTMLSpanElement | null>(null);\n    const composedRefs = useComposedRefs(forwardedRef, (node) => setThumb(node));\n    const size = useSize(thumb);\n    // We cast because index could be `-1` which would return undefined\n    const value = context.values[index] as number | undefined;\n    const percent =\n      value === undefined ? 0 : convertValueToPercentage(value, context.min, context.max);\n    const label = getLabel(index, context.values.length);\n    const orientationSize = size?.[orientation.size];\n    const thumbInBoundsOffset = orientationSize\n      ? getThumbInBoundsOffset(orientationSize, percent, orientation.direction)\n      : 0;\n\n    React.useEffect(() => {\n      if (thumb) {\n        context.thumbs.add(thumb);\n        return () => {\n          context.thumbs.delete(thumb);\n        };\n      }\n    }, [thumb, context.thumbs]);\n\n    return (\n      <span\n        style={{\n          transform: 'var(--radix-slider-thumb-transform)',\n          position: 'absolute',\n          [orientation.startEdge]: `calc(${percent}% + ${thumbInBoundsOffset}px)`,\n        }}\n      >\n        <Collection.ItemSlot scope={props.__scopeSlider}>\n          <Primitive.span\n            role=\"slider\"\n            aria-label={props['aria-label'] || label}\n            aria-valuemin={context.min}\n            aria-valuenow={value}\n            aria-valuemax={context.max}\n            aria-orientation={context.orientation}\n            data-orientation={context.orientation}\n            data-disabled={context.disabled ? '' : undefined}\n            tabIndex={context.disabled ? undefined : 0}\n            {...thumbProps}\n            ref={composedRefs}\n            /**\n             * There will be no value on initial render while we work out the index so we hide thumbs\n             * without a value, otherwise SSR will render them in the wrong position before they\n             * snap into the correct position during hydration which would be visually jarring for\n             * slower connections.\n             */\n            style={value === undefined ? { display: 'none' } : props.style}\n            onFocus={composeEventHandlers(props.onFocus, () => {\n              context.valueIndexToChangeRef.current = index;\n            })}\n          />\n        </Collection.ItemSlot>\n      </span>\n    );\n  }\n);\n\nSliderThumb.displayName = THUMB_NAME;\n\n/* -----------------------------------------------------------------------------------------------*/\n\nconst BubbleInput = (props: Radix.ComponentPropsWithoutRef<'input'>) => {\n  const { value, ...inputProps } = props;\n  const ref = React.useRef<HTMLInputElement>(null);\n  const prevValue = usePrevious(value);\n\n  // Bubble value change to parents (e.g form change event)\n  React.useEffect(() => {\n    const input = ref.current!;\n    const inputProto = window.HTMLInputElement.prototype;\n    const descriptor = Object.getOwnPropertyDescriptor(inputProto, 'value') as PropertyDescriptor;\n    const setValue = descriptor.set;\n    if (prevValue !== value && setValue) {\n      const event = new Event('input', { bubbles: true });\n      setValue.call(input, value);\n      input.dispatchEvent(event);\n    }\n  }, [prevValue, value]);\n\n  /**\n   * We purposefully do not use `type=\"hidden\"` here otherwise forms that\n   * wrap it will not be able to access its value via the FormData API.\n   *\n   * We purposefully do not add the `value` attribute here to allow the value\n   * to be set programatically and bubble to any parent form `onChange` event.\n   * Adding the `value` will cause React to consider the programatic\n   * dispatch a duplicate and it will get swallowed.\n   */\n  return <input style={{ display: 'none' }} {...inputProps} ref={ref} defaultValue={value} />;\n};\n\nfunction getNextSortedValues(prevValues: number[] = [], nextValue: number, atIndex: number) {\n  const nextValues = [...prevValues];\n  nextValues[atIndex] = nextValue;\n  return nextValues.sort((a, b) => a - b);\n}\n\nfunction convertValueToPercentage(value: number, min: number, max: number) {\n  const maxSteps = max - min;\n  const percentPerStep = 100 / maxSteps;\n  return percentPerStep * (value - min);\n}\n\n/**\n * Returns a label for each thumb when there are two or more thumbs\n */\nfunction getLabel(index: number, totalValues: number) {\n  if (totalValues > 2) {\n    return `Value ${index + 1} of ${totalValues}`;\n  } else if (totalValues === 2) {\n    return ['Minimum', 'Maximum'][index];\n  } else {\n    return undefined;\n  }\n}\n\n/**\n * Given a `values` array and a `nextValue`, determine which value in\n * the array is closest to `nextValue` and return its index.\n *\n * @example\n * // returns 1\n * getClosestValueIndex([10, 30], 25);\n */\nfunction getClosestValueIndex(values: number[], nextValue: number) {\n  if (values.length === 1) return 0;\n  const distances = values.map((value) => Math.abs(value - nextValue));\n  const closestDistance = Math.min(...distances);\n  return distances.indexOf(closestDistance);\n}\n\n/**\n * Offsets the thumb centre point while sliding to ensure it remains\n * within the bounds of the slider when reaching the edges\n */\nfunction getThumbInBoundsOffset(width: number, left: number, direction: number) {\n  const halfWidth = width / 2;\n  const halfPercent = 50;\n  const offset = linearScale([0, halfPercent], [0, halfWidth]);\n  return (halfWidth - offset(left) * direction) * direction;\n}\n\n/**\n * Gets an array of steps between each value.\n *\n * @example\n * // returns [1, 9]\n * getStepsBetweenValues([10, 11, 20]);\n */\nfunction getStepsBetweenValues(values: number[]) {\n  return values.slice(0, -1).map((value, index) => values[index + 1] - value);\n}\n\n/**\n * Verifies the minimum steps between all values is greater than or equal\n * to the expected minimum steps.\n *\n * @example\n * // returns false\n * hasMinStepsBetweenValues([1,2,3], 2);\n *\n * @example\n * // returns true\n * hasMinStepsBetweenValues([1,2,3], 1);\n */\nfunction hasMinStepsBetweenValues(values: number[], minStepsBetweenValues: number) {\n  if (minStepsBetweenValues > 0) {\n    const stepsBetweenValues = getStepsBetweenValues(values);\n    const actualMinStepsBetweenValues = Math.min(...stepsBetweenValues);\n    return actualMinStepsBetweenValues >= minStepsBetweenValues;\n  }\n  return true;\n}\n\n// https://github.com/tmcw-up-for-adoption/simple-linear-scale/blob/master/index.js\nfunction linearScale(input: readonly [number, number], output: readonly [number, number]) {\n  return (value: number) => {\n    if (input[0] === input[1] || output[0] === output[1]) return output[0];\n    const ratio = (output[1] - output[0]) / (input[1] - input[0]);\n    return output[0] + ratio * (value - input[0]);\n  };\n}\n\nfunction getDecimalCount(value: number) {\n  return (String(value).split('.')[1] || '').length;\n}\n\nfunction roundValue(value: number, decimalCount: number) {\n  const rounder = Math.pow(10, decimalCount);\n  return Math.round(value * rounder) / rounder;\n}\n\nconst Root = Slider;\nconst Track = SliderTrack;\nconst Range = SliderRange;\nconst Thumb = SliderThumb;\n\nexport {\n  createSliderScope,\n  //\n  Slider,\n  SliderTrack,\n  SliderRange,\n  SliderThumb,\n  //\n  Root,\n  Track,\n  Range,\n  Thumb,\n};\nexport type { SliderProps, SliderTrackProps, SliderRangeProps, SliderThumbProps };\n","function clamp(value: number, [min, max]: [number, number]): number {\n  return Math.min(max, Math.max(min, value));\n}\n\nexport { clamp };\n","import * as React from 'react';\n\nfunction usePrevious<T>(value: T) {\n  const ref = React.useRef({ value, previous: value });\n\n  // We compare values before making an update to ensure that\n  // a change has been made. This ensures the previous value is\n  // persisted correctly between renders.\n  return React.useMemo(() => {\n    if (ref.current.value !== value) {\n      ref.current.previous = ref.current.value;\n      ref.current.value = value;\n    }\n    return ref.current.previous;\n  }, [value]);\n}\n\nexport { usePrevious };\n","import { Range, Root, Thumb, Track } from '@radix-ui/react-slider'\nimport { useApp } from '@tldraw/editor'\nimport { useCallback } from 'react'\nimport { TLTranslationKey, useTranslation } from '../../../hooks'\n\n/** @public */\nexport interface SliderProps {\n\tsteps: number\n\tvalue: number | null\n\tlabel: string\n\ttitle: string\n\tonValueChange: (value: number, emphemeral: boolean) => void\n\t'data-wd'?: string\n}\n\n/** @public */\nexport function Slider(props: SliderProps) {\n\tconst { title, steps, value, label, onValueChange } = props\n\tconst app = useApp()\n\tconst msg = useTranslation()\n\n\tconst handleValueChange = useCallback(\n\t\t(value: number[]) => {\n\t\t\tonValueChange(value[0], true)\n\t\t},\n\t\t[onValueChange]\n\t)\n\n\tconst handlePointerDown = useCallback(() => {\n\t\tapp.mark('click slider')\n\t}, [app])\n\n\tconst handlePointerUp = useCallback(() => {\n\t\tif (!value) return\n\t\tonValueChange(value, false)\n\t}, [value, onValueChange])\n\n\treturn (\n\t\t<div className=\"tlui-slider__container\">\n\t\t\t<Root\n\t\t\t\tdata-wd={props['data-wd']}\n\t\t\t\tclassName=\"tlui-slider\"\n\t\t\t\tarea-label=\"Opacity\"\n\t\t\t\tdir=\"ltr\"\n\t\t\t\tmin={0}\n\t\t\t\tmax={steps}\n\t\t\t\tstep={1}\n\t\t\t\tvalue={value ? [value] : undefined}\n\t\t\t\tonPointerDown={handlePointerDown}\n\t\t\t\tonValueChange={handleValueChange}\n\t\t\t\tonPointerUp={handlePointerUp}\n\t\t\t\ttitle={title + '  ' + msg(label as TLTranslationKey)}\n\t\t\t>\n\t\t\t\t<Track className=\"tlui-slider__track\" dir=\"ltr\">\n\t\t\t\t\t{value !== null && <Range className=\"tlui-slider__range\" dir=\"ltr\" />}\n\t\t\t\t</Track>\n\t\t\t\t{value !== null && <Thumb className=\"tlui-slider__thumb\" dir=\"ltr\" />}\n\t\t\t</Root>\n\t\t</div>\n\t)\n}\n","import { useApp } from '@tldraw/editor'\nimport { useCallback, useRef, useState } from 'react'\nimport { track } from 'signia-react'\nimport { DialogProps, useTranslation } from '../../hooks'\nimport { Button, Input } from '../primitives'\nimport * as Dialog from '../primitives/Dialog'\n\nconst validUrlRegex = new RegExp(\n\t/^(?:(?:(?:https?|ftp):)?\\/\\/)(?:\\S+(?::\\S*)?@)?(?:(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})))(?::\\d{2,5})?(?:[/?#]\\S*)?$/i\n)\n\n// A url can either be invalid, or valid with a protocol, or valid without a protocol.\n// For example, \"aol.com\" would be valid with a protocol ()\nfunction valiateUrl(url: string) {\n\tif (validUrlRegex.test(url)) return true\n\tif (validUrlRegex.test('https://' + url)) return 'needs protocol'\n\treturn false\n}\n\nexport const EditLinkDialog = track(function EditLink({ onClose }: DialogProps) {\n\tconst app = useApp()\n\tconst msg = useTranslation()\n\n\tconst selectedShape = app.onlySelectedShape\n\n\tconst [validState, setIsValid] = useState(valiateUrl(selectedShape?.props.url))\n\n\tconst rInitialValue = useRef(selectedShape?.props.url)\n\n\tconst rValue = useRef(selectedShape?.props.url)\n\n\tconst handleChange = useCallback((value: string) => {\n\t\tconst validStateUrl = valiateUrl(value.trim())\n\t\tsetIsValid((s) => (s === validStateUrl ? s : validStateUrl))\n\t\tif (validStateUrl) {\n\t\t\trValue.current = value\n\t\t}\n\t}, [])\n\n\tconst handleClear = useCallback(() => {\n\t\tapp.setProp('url', '', false)\n\t\tonClose()\n\t}, [app, onClose])\n\n\tconst handleComplete = useCallback(\n\t\t(value: string) => {\n\t\t\tvalue = value.trim()\n\t\t\tconst validState = valiateUrl(value)\n\n\t\t\tconst shape = app.selectedShapes[0]\n\n\t\t\tif (shape) {\n\t\t\t\tconst current = shape.props.url\n\t\t\t\tconst next = validState\n\t\t\t\t\t? validState === 'needs protocol'\n\t\t\t\t\t\t? 'https://' + value\n\t\t\t\t\t\t: value\n\t\t\t\t\t: shape.type === 'bookmark'\n\t\t\t\t\t? rInitialValue.current\n\t\t\t\t\t: ''\n\n\t\t\t\tif (current !== undefined && current !== next) {\n\t\t\t\t\tapp.setProp('url', next, false)\n\t\t\t\t}\n\t\t\t}\n\t\t\tonClose()\n\t\t},\n\t\t[app, onClose]\n\t)\n\n\tconst handleCancel = useCallback(() => {\n\t\tonClose()\n\t}, [onClose])\n\n\tif (!selectedShape) {\n\t\t// dismiss modal\n\t\tonClose()\n\t\treturn null\n\t}\n\n\t// Are we going from a valid state to an invalid state?\n\tconst isRemoving = rInitialValue.current && !validState\n\n\treturn (\n\t\t<>\n\t\t\t<Dialog.Header>\n\t\t\t\t<Dialog.Title>{msg('edit-link-dialog.title')}</Dialog.Title>\n\t\t\t\t<Dialog.CloseButton />\n\t\t\t</Dialog.Header>\n\t\t\t<Dialog.Body>\n\t\t\t\t<div className=\"tlui-edit-link-dialog\">\n\t\t\t\t\t<Input\n\t\t\t\t\t\tclassName=\"tlui-edit-link-dialog__input\"\n\t\t\t\t\t\tlabel=\"edit-link-dialog.url\"\n\t\t\t\t\t\tdefaultValue={\n\t\t\t\t\t\t\tvalidState\n\t\t\t\t\t\t\t\t? validState === 'needs protocol'\n\t\t\t\t\t\t\t\t\t? 'https://' + selectedShape.props.url\n\t\t\t\t\t\t\t\t\t: selectedShape.props.url\n\t\t\t\t\t\t\t\t: 'https://'\n\t\t\t\t\t\t}\n\t\t\t\t\t\tautofocus\n\t\t\t\t\t\tonValueChange={handleChange}\n\t\t\t\t\t\tonComplete={handleComplete}\n\t\t\t\t\t\tonCancel={handleCancel}\n\t\t\t\t\t/>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t{validState ? msg('edit-link-dialog.detail') : msg('edit-link-dialog.invalid-url')}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</Dialog.Body>\n\t\t\t<Dialog.Footer className=\"tlui-dialog__footer__actions\">\n\t\t\t\t<Button onClick={handleCancel} onTouchEnd={handleCancel}>\n\t\t\t\t\t{msg('edit-link-dialog.cancel')}\n\t\t\t\t</Button>\n\t\t\t\t{isRemoving ? (\n\t\t\t\t\t<Button type={'danger'} onTouchEnd={handleClear} onClick={handleClear}>\n\t\t\t\t\t\t{msg('edit-link-dialog.clear')}\n\t\t\t\t\t</Button>\n\t\t\t\t) : (\n\t\t\t\t\t<Button\n\t\t\t\t\t\ttype=\"primary\"\n\t\t\t\t\t\tdisabled={!validState}\n\t\t\t\t\t\tonTouchEnd={() => handleComplete(rValue.current)}\n\t\t\t\t\t\tonClick={() => handleComplete(rValue.current)}\n\t\t\t\t\t>\n\t\t\t\t\t\t{msg('edit-link-dialog.save')}\n\t\t\t\t\t</Button>\n\t\t\t\t)}\n\t\t\t</Dialog.Footer>\n\t\t</>\n\t)\n})\n","import {\n\tApp,\n\tcreateAssetShapeAtPoint,\n\tcreateBookmarkShapeAtPoint,\n\tcreateEmbedShapeAtPoint,\n\tcreateShapeId,\n\tcreateShapesFromFiles,\n\tFONT_FAMILIES,\n\tFONT_SIZES,\n\tgetEmbedInfo,\n\tgetIndexAbove,\n\tgetIndices,\n\tgetValidHttpURLList,\n\tisShapeId,\n\tisSvgText,\n\tisValidHttpURL,\n\tTEXT_PROPS,\n\tTLAlignType,\n\tTLArrowheadType,\n\tTLArrowShapeDef,\n\tTLAsset,\n\tTLAssetId,\n\tTLBookmarkShapeDef,\n\tTLClipboardModel,\n\tTLColorType,\n\tTLDashType,\n\tTLEmbedShapeDef,\n\tTLFillType,\n\tTLFontType,\n\tTLGeoShapeDef,\n\tTLOpacityType,\n\tTLShapeId,\n\tTLSizeType,\n\tTLTextShapeDef,\n\tuniqueId,\n\tuseApp,\n} from '@tldraw/editor'\nimport { Box2d, Vec2d, VecLike } from '@tldraw/primitives'\nimport { compact, isNonNull } from '@tldraw/utils'\nimport { compressToBase64, decompressFromBase64 } from 'lz-string'\nimport { useCallback, useEffect } from 'react'\n\n/** @public */\nexport type EmbedInfo = {\n\twidth: number\n\theight: number\n\tdoesResize: boolean\n\tisEmbedUrl: (url: string) => boolean\n\ttoEmbed: (url: string) => string\n}\n\nasync function blobAsString(blob: Blob) {\n\treturn new Promise<string>((resolve, reject) => {\n\t\tconst reader = new FileReader()\n\t\treader.addEventListener('loadend', () => {\n\t\t\tconst text = reader.result\n\t\t\tresolve(text as string)\n\t\t})\n\t\treader.addEventListener('error', () => {\n\t\t\treject(reader.error)\n\t\t})\n\t\treader.readAsText(blob)\n\t})\n}\n\nasync function dataTransferItemAsString(item: DataTransferItem) {\n\treturn new Promise<string>((resolve) => {\n\t\titem.getAsString((text) => {\n\t\t\tresolve(text)\n\t\t})\n\t})\n}\n\nconst INPUTS = ['input', 'select', 'textarea']\n\nfunction disallowClipboardEvents(app: App) {\n\tconst { activeElement } = document\n\treturn (\n\t\tapp.isMenuOpen ||\n\t\t(activeElement &&\n\t\t\t(activeElement.getAttribute('contenteditable') ||\n\t\t\t\tINPUTS.indexOf(activeElement.tagName.toLowerCase()) > -1))\n\t)\n}\n\nfunction stripHtml(html: string) {\n\t// See <https://github.com/developit/preact-markup/blob/4788b8d61b4e24f83688710746ee36e7464f7bbc/src/parse-markup.js#L60-L69>\n\tconst doc = document.implementation.createHTMLDocument('')\n\tdoc.documentElement.innerHTML = html\n\treturn doc.body.textContent || doc.body.innerText || ''\n}\n\n// Clear the clipboard when the user copies nothing\nconst clearPersistedClipboard = () => {\n\twindow.navigator.clipboard.writeText('')\n}\n\n/**\n * Write serialized data to the local storage.\n *\n * @internal\n * @param data - The string to write.\n * @param kind - The kind of data to write.\n */\nconst getStringifiedClipboard = (data: any, kind: 'text' | 'file' | 'content') => {\n\tconst s = compressToBase64(\n\t\tJSON.stringify({\n\t\t\ttype: 'application/tldraw',\n\t\t\tkind,\n\t\t\tdata,\n\t\t})\n\t)\n\n\treturn s\n}\n\n/**\n * When the clipboard has tldraw content, paste it into the scene.\n *\n * @internal\n * @param clipboard - The clipboard model.\n * @param point - The center point at which to paste the content.\n */\nconst pasteTldrawContent = async (app: App, clipboard: TLClipboardModel, point?: VecLike) => {\n\tconst p = point ?? (app.inputs.shiftKey ? app.inputs.currentPagePoint : undefined)\n\n\tapp.mark('paste')\n\tapp.putContent(clipboard, {\n\t\tpoint: p,\n\t\tselect: true,\n\t})\n}\n\n/**\n * When the clipboard has plain text, create a text shape and insert it into the scene\n *\n * @internal\n * @param text - The text to paste.\n * @param point - The point at which to paste the text.\n */\nconst pastePlainText = async (app: App, text: string, point?: VecLike) => {\n\tconst p = point ?? (app.inputs.shiftKey ? app.inputs.currentPagePoint : app.viewportPageCenter)\n\tconst defaultProps = app.getShapeUtilByDef(TLTextShapeDef).defaultProps()\n\n\t// Measure the text with default values\n\tconst { w, h } = app.textMeasure.measureText({\n\t\t...TEXT_PROPS,\n\t\ttext: stripHtml(text),\n\t\tfontFamily: FONT_FAMILIES[defaultProps.font],\n\t\tfontSize: FONT_SIZES[defaultProps.size],\n\t\twidth: 'fit-content',\n\t})\n\n\tapp.mark('paste')\n\tapp.createShapes([\n\t\t{\n\t\t\tid: createShapeId(),\n\t\t\ttype: 'text',\n\t\t\tx: p.x - w / 2,\n\t\t\ty: p.y - h / 2,\n\t\t\tprops: {\n\t\t\t\ttext: stripHtml(text),\n\t\t\t\tautoSize: true,\n\t\t\t},\n\t\t},\n\t])\n}\n\n/**\n * When the clipboard has plain text that is a valid URL, create a bookmark shape and insert it\n * into the scene\n *\n * @internal\n * @param url - The URL to paste.\n * @param point - The point at which to paste the file.\n */\nconst pasteUrl = async (app: App, url: string, point?: VecLike) => {\n\tconst p = point ?? (app.inputs.shiftKey ? app.inputs.currentPagePoint : app.viewportPageCenter)\n\n\t// Lets see if its an image and we have CORs\n\ttry {\n\t\tconst resp = await fetch(url)\n\t\tif (resp.headers.get('content-type')?.match(/^image\\//)) {\n\t\t\tapp.mark('paste')\n\t\t\tpasteFiles(app, [url])\n\t\t\treturn\n\t\t}\n\t} catch (err: any) {\n\t\tif (err.message !== 'Failed to fetch') {\n\t\t\tconsole.error(err)\n\t\t}\n\t}\n\n\tconst embedInfo = getEmbedInfo(url)\n\n\tif (embedInfo) {\n\t\tapp.mark('paste')\n\t\tcreateEmbedShapeAtPoint(app, embedInfo.url, p, embedInfo.definition)\n\t} else {\n\t\tapp.mark('paste')\n\t\tawait createBookmarkShapeAtPoint(app, url, p)\n\t}\n}\n\nconst pasteSvgText = (app: App, text: string, point?: VecLike) => {\n\tconst p = point ?? (app.inputs.shiftKey ? app.inputs.currentPagePoint : app.viewportPageCenter)\n\n\tapp.mark('paste')\n\tcreateAssetShapeAtPoint(app, text, p)\n}\n\n/**\n * When the clipboard has a file, create an image shape from the file and paste it into the scene\n *\n * @internal\n * @param url - The file's url.\n * @param point - The point at which to paste the file.\n */\nconst pasteFiles = async (app: App, urls: string[], point?: VecLike) => {\n\tconst p = point ?? (app.inputs.shiftKey ? app.inputs.currentPagePoint : app.viewportPageCenter)\n\n\tconst blobs = await Promise.all(urls.map(async (url) => await (await fetch(url)).blob()))\n\n\tconst files = blobs.map(\n\t\t(blob) =>\n\t\t\tnew File([blob], 'TLdrawFile', {\n\t\t\t\ttype: blob.type,\n\t\t\t})\n\t)\n\n\tapp.mark('paste')\n\tawait createShapesFromFiles(app, files, p, false)\n\n\turls.forEach((url) => URL.revokeObjectURL(url))\n}\n\n/**\n * When the user copies, write the contents to local storage and to the clipboard\n *\n * @param app - App\n * @public\n */\nconst handleMenuCopy = (app: App) => {\n\tconst content = app.getContent()\n\tif (!content) {\n\t\tclearPersistedClipboard()\n\t\treturn\n\t}\n\n\tconst stringifiedClipboard = getStringifiedClipboard(content, 'content')\n\n\tif (typeof window?.navigator !== 'undefined') {\n\t\t// Extract the text from the clipboard\n\t\tconst textItems = content.shapes\n\t\t\t.map((shape) => {\n\t\t\t\tif (TLTextShapeDef.is(shape) || TLGeoShapeDef.is(shape) || TLArrowShapeDef.is(shape)) {\n\t\t\t\t\treturn shape.props.text\n\t\t\t\t}\n\t\t\t\tif (TLBookmarkShapeDef.is(shape) || TLEmbedShapeDef.is(shape)) {\n\t\t\t\t\treturn shape.props.url\n\t\t\t\t}\n\t\t\t\treturn null\n\t\t\t})\n\t\t\t.filter(isNonNull)\n\n\t\tif (navigator.clipboard?.write) {\n\t\t\tconst htmlBlob = new Blob([`<tldraw>${stringifiedClipboard}</tldraw>`], {\n\t\t\t\ttype: 'text/html',\n\t\t\t})\n\n\t\t\tlet textContent = textItems.join(' ')\n\n\t\t\t// This is a bug in chrome android where it won't paste content if\n\t\t\t// the text/plain content is \"\" so we need to always add an empty\n\t\t\t// space \n\t\t\tif (textContent === '') {\n\t\t\t\ttextContent = ' '\n\t\t\t}\n\n\t\t\tnavigator.clipboard.write([\n\t\t\t\tnew ClipboardItem({\n\t\t\t\t\t'text/html': htmlBlob,\n\t\t\t\t\t'text/plain': new Blob([textContent], { type: 'text/plain' }),\n\t\t\t\t}),\n\t\t\t])\n\t\t} else if (navigator.clipboard.writeText) {\n\t\t\tnavigator.clipboard.writeText(`<tldraw>${stringifiedClipboard}</tldraw>`)\n\t\t}\n\t}\n}\n\nconst pasteText = (app: App, data: string, point?: VecLike) => {\n\tconst validUrlList = getValidHttpURLList(data)\n\tif (validUrlList) {\n\t\tfor (const url of validUrlList) {\n\t\t\tpasteUrl(app, url, point)\n\t\t}\n\t} else if (isValidHttpURL(data)) {\n\t\tpasteUrl(app, data, point)\n\t} else if (isSvgText(data)) {\n\t\tpasteSvgText(app, data, point)\n\t} else {\n\t\tpastePlainText(app, data, point)\n\t}\n}\n\nasync function pasteExcalidrawContent(app: App, clipboard: any, point?: VecLike) {\n\tconst { elements, files } = clipboard\n\n\tconst tldrawContent: TLClipboardModel = {\n\t\tshapes: [],\n\t\trootShapeIds: [],\n\t\tassets: [],\n\t\tschema: app.store.schema.serialize(),\n\t}\n\n\tconst groupShapeIdToChildren = new Map<string, TLShapeId[]>()\n\tconst rotatedElements = new Map<TLShapeId, number>()\n\n\tconst getOpacity = (opacity: number): TLOpacityType => {\n\t\tconst t = opacity / 100\n\t\tif (t < 0.2) {\n\t\t\treturn '0.1'\n\t\t} else if (t < 0.4) {\n\t\t\treturn '0.25'\n\t\t} else if (t < 0.6) {\n\t\t\treturn '0.5'\n\t\t} else if (t < 0.8) {\n\t\t\treturn '0.75'\n\t\t}\n\n\t\treturn '1'\n\t}\n\n\tconst strokeWidthsToSizes: Record<number, TLSizeType> = {\n\t\t1: 's',\n\t\t2: 'm',\n\t\t3: 'l',\n\t\t4: 'xl',\n\t}\n\n\tconst fontSizesToSizes: Record<number, TLSizeType> = {\n\t\t16: 's',\n\t\t20: 'm',\n\t\t28: 'l',\n\t\t36: 'xl',\n\t}\n\n\tfunction getFontSizeAndScale(fontSize: number): { size: TLSizeType; scale: number } {\n\t\tconst size = fontSizesToSizes[fontSize]\n\t\tif (size) {\n\t\t\treturn { size, scale: 1 }\n\t\t}\n\t\tif (fontSize < 16) {\n\t\t\treturn { size: 's', scale: fontSize / 16 }\n\t\t}\n\t\tif (fontSize > 36) {\n\t\t\treturn { size: 'xl', scale: fontSize / 36 }\n\t\t}\n\t\treturn { size: 'm', scale: 1 }\n\t}\n\n\tconst fontFamilyToFontType: Record<number, TLFontType> = {\n\t\t1: 'draw',\n\t\t2: 'sans',\n\t\t3: 'mono',\n\t}\n\n\tconst colorsToColors: Record<string, TLColorType> = {\n\t\t'#ffffff': 'grey',\n\t\t// Strokes\n\t\t'#000000': 'black',\n\t\t'#343a40': 'grey',\n\t\t'#495057': 'grey',\n\t\t'#c92a2a': 'red',\n\t\t'#a61e4d': 'light-red',\n\t\t'#862e9c': 'violet',\n\t\t'#5f3dc4': 'light-violet',\n\t\t'#364fc7': 'blue',\n\t\t'#1864ab': 'light-blue',\n\t\t'#0b7285': 'light-green',\n\t\t'#087f5b': 'light-green',\n\t\t'#2b8a3e': 'green',\n\t\t'#5c940d': 'light-green',\n\t\t'#e67700': 'yellow',\n\t\t'#d9480f': 'orange',\n\t\t// Backgrounds\n\t\t'#ced4da': 'grey',\n\t\t'#868e96': 'grey',\n\t\t'#fa5252': 'light-red',\n\t\t'#e64980': 'red',\n\t\t'#be4bdb': 'light-violet',\n\t\t'#7950f2': 'violet',\n\t\t'#4c6ef5': 'blue',\n\t\t'#228be6': 'light-blue',\n\t\t'#15aabf': 'light-green',\n\t\t'#12b886': 'green',\n\t\t'#40c057': 'green',\n\t\t'#82c91e': 'light-green',\n\t\t'#fab005': 'yellow',\n\t\t'#fd7e14': 'orange',\n\t\t'#212529': 'grey',\n\t}\n\n\tconst strokeStylesToStrokeTypes: Record<string, TLDashType> = {\n\t\tsolid: 'draw',\n\t\tdashed: 'dashed',\n\t\tdotted: 'dotted',\n\t}\n\n\tconst fillStylesToFillType: Record<string, TLFillType> = {\n\t\t'cross-hatch': 'pattern',\n\t\thachure: 'pattern',\n\t\tsolid: 'solid',\n\t}\n\n\tconst textAlignToAlignTypes: Record<string, TLAlignType> = {\n\t\tleft: 'start',\n\t\tcenter: 'middle',\n\t\tright: 'end',\n\t}\n\n\tconst arrowheadsToArrowheadTypes: Record<string, TLArrowheadType> = {\n\t\tarrow: 'arrow',\n\t\tdot: 'dot',\n\t\ttriangle: 'triangle',\n\t\tbar: 'pipe',\n\t}\n\n\tfunction getBend(element: any, startPoint: any, endPoint: any) {\n\t\tlet bend = 0\n\t\tif (element.points.length > 2) {\n\t\t\tconst start = new Vec2d(startPoint[0], startPoint[1])\n\t\t\tconst end = new Vec2d(endPoint[0], endPoint[1])\n\t\t\tconst handle = new Vec2d(element.points[1][0], element.points[1][1])\n\t\t\tconst delta = Vec2d.Sub(end, start)\n\t\t\tconst v = Vec2d.Per(delta)\n\n\t\t\tconst med = Vec2d.Med(end, start)\n\t\t\tconst A = Vec2d.Sub(med, v)\n\t\t\tconst B = Vec2d.Add(med, v)\n\n\t\t\tconst point = Vec2d.NearestPointOnLineSegment(A, B, handle, false)\n\t\t\tbend = Vec2d.Dist(point, med)\n\t\t\tif (Vec2d.Clockwise(point, end, med)) bend *= -1\n\t\t}\n\t\treturn bend\n\t}\n\n\tconst getDash = (element: any): TLDashType => {\n\t\tlet dash: TLDashType = strokeStylesToStrokeTypes[element.strokeStyle] ?? 'draw'\n\t\tif (dash === 'draw' && element.roughness === 0) {\n\t\t\tdash = 'solid'\n\t\t}\n\t\treturn dash\n\t}\n\n\tconst getFill = (element: any): TLFillType => {\n\t\tif (element.backgroundColor === 'transparent') {\n\t\t\treturn 'none'\n\t\t}\n\t\treturn fillStylesToFillType[element.fillStyle] ?? 'solid'\n\t}\n\n\tconst { currentPageId } = app\n\n\tlet index = 'a1'\n\n\tconst excElementIdsToTldrawShapeIds = new Map<string, TLShapeId>()\n\tconst rootShapeIds: TLShapeId[] = []\n\n\tconst skipIds = new Set<string>()\n\n\telements.forEach((element: any) => {\n\t\texcElementIdsToTldrawShapeIds.set(element.id, app.createShapeId())\n\n\t\tif (element.boundElements !== null) {\n\t\t\tfor (const boundElement of element.boundElements) {\n\t\t\t\tif (boundElement.type === 'text') {\n\t\t\t\t\tskipIds.add(boundElement.id)\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t})\n\n\tfor (const element of elements) {\n\t\tif (skipIds.has(element.id)) {\n\t\t\tcontinue\n\t\t}\n\n\t\tconst id = excElementIdsToTldrawShapeIds.get(element.id)!\n\n\t\tconst base = {\n\t\t\tid,\n\t\t\ttypeName: 'shape',\n\t\t\tparentId: currentPageId,\n\t\t\tindex,\n\t\t\tx: element.x,\n\t\t\ty: element.y,\n\t\t\trotation: 0,\n\t\t\tisLocked: element.locked,\n\t\t} as const\n\n\t\tif (element.angle !== 0) {\n\t\t\trotatedElements.set(id, element.angle)\n\t\t}\n\n\t\tif (element.groupIds && element.groupIds.length > 0) {\n\t\t\tif (groupShapeIdToChildren.has(element.groupIds[0])) {\n\t\t\t\tgroupShapeIdToChildren.get(element.groupIds[0])?.push(id)\n\t\t\t} else {\n\t\t\t\tgroupShapeIdToChildren.set(element.groupIds[0], [id])\n\t\t\t}\n\t\t} else {\n\t\t\trootShapeIds.push(id)\n\t\t}\n\n\t\tswitch (element.type) {\n\t\t\tcase 'rectangle':\n\t\t\tcase 'ellipse':\n\t\t\tcase 'diamond': {\n\t\t\t\tlet text = ''\n\t\t\t\tlet align: TLAlignType = 'middle'\n\n\t\t\t\tif (element.boundElements !== null) {\n\t\t\t\t\tfor (const boundElement of element.boundElements) {\n\t\t\t\t\t\tif (boundElement.type === 'text') {\n\t\t\t\t\t\t\tconst labelElement = elements.find((elm: any) => elm.id === boundElement.id)\n\t\t\t\t\t\t\tif (labelElement) {\n\t\t\t\t\t\t\t\ttext = labelElement.text\n\t\t\t\t\t\t\t\talign = textAlignToAlignTypes[labelElement.textAlign]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tconst colorToUse =\n\t\t\t\t\telement.backgroundColor === 'transparent' ? element.strokeColor : element.backgroundColor\n\n\t\t\t\ttldrawContent.shapes.push({\n\t\t\t\t\t...base,\n\t\t\t\t\ttype: 'geo',\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tgeo: element.type,\n\t\t\t\t\t\topacity: getOpacity(element.opacity),\n\t\t\t\t\t\turl: element.link ?? '',\n\t\t\t\t\t\tw: element.width,\n\t\t\t\t\t\th: element.height,\n\t\t\t\t\t\tsize: strokeWidthsToSizes[element.strokeWidth] ?? 'draw',\n\t\t\t\t\t\tcolor: colorsToColors[colorToUse] ?? 'black',\n\t\t\t\t\t\ttext,\n\t\t\t\t\t\talign,\n\t\t\t\t\t\tdash: getDash(element),\n\t\t\t\t\t\tfill: getFill(element),\n\t\t\t\t\t},\n\t\t\t\t})\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tcase 'freedraw': {\n\t\t\t\ttldrawContent.shapes.push({\n\t\t\t\t\t...base,\n\t\t\t\t\ttype: 'draw',\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tdash: getDash(element),\n\t\t\t\t\t\tsize: strokeWidthsToSizes[element.strokeWidth],\n\t\t\t\t\t\topacity: getOpacity(element.opacity),\n\t\t\t\t\t\tcolor: colorsToColors[element.strokeColor] ?? 'black',\n\t\t\t\t\t\tsegments: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttype: 'free',\n\t\t\t\t\t\t\t\tpoints: element.points.map(([x, y, z = 0.5]: number[]) => ({\n\t\t\t\t\t\t\t\t\tx,\n\t\t\t\t\t\t\t\t\ty,\n\t\t\t\t\t\t\t\t\tz,\n\t\t\t\t\t\t\t\t})),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t],\n\t\t\t\t\t},\n\t\t\t\t})\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tcase 'line': {\n\t\t\t\tconst start = element.points[0]\n\t\t\t\tconst end = element.points[element.points.length - 1]\n\t\t\t\tconst indices = getIndices(element.points.length)\n\n\t\t\t\ttldrawContent.shapes.push({\n\t\t\t\t\t...base,\n\t\t\t\t\ttype: 'line',\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tdash: getDash(element),\n\t\t\t\t\t\tsize: strokeWidthsToSizes[element.strokeWidth],\n\t\t\t\t\t\topacity: getOpacity(element.opacity),\n\t\t\t\t\t\tcolor: colorsToColors[element.strokeColor] ?? 'black',\n\t\t\t\t\t\tspline: element.roundness ? 'cubic' : 'line',\n\t\t\t\t\t\thandles: {\n\t\t\t\t\t\t\tstart: {\n\t\t\t\t\t\t\t\tid: 'start',\n\t\t\t\t\t\t\t\ttype: 'vertex',\n\t\t\t\t\t\t\t\tindex: indices[0],\n\t\t\t\t\t\t\t\tx: start[0],\n\t\t\t\t\t\t\t\ty: start[1],\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tend: {\n\t\t\t\t\t\t\t\tid: 'end',\n\t\t\t\t\t\t\t\ttype: 'vertex',\n\t\t\t\t\t\t\t\tindex: indices[indices.length - 1],\n\t\t\t\t\t\t\t\tx: end[0],\n\t\t\t\t\t\t\t\ty: end[1],\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t...Object.fromEntries(\n\t\t\t\t\t\t\t\telement.points.slice(1, -1).map(([x, y]: number[], i: number) => {\n\t\t\t\t\t\t\t\t\tconst id = uniqueId()\n\t\t\t\t\t\t\t\t\treturn [\n\t\t\t\t\t\t\t\t\t\tid,\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tid,\n\t\t\t\t\t\t\t\t\t\t\ttype: 'vertex',\n\t\t\t\t\t\t\t\t\t\t\tindex: indices[i + 1],\n\t\t\t\t\t\t\t\t\t\t\tx,\n\t\t\t\t\t\t\t\t\t\t\ty,\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t})\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tcase 'arrow': {\n\t\t\t\tlet text = ''\n\n\t\t\t\tif (element.boundElements !== null) {\n\t\t\t\t\tfor (const boundElement of element.boundElements) {\n\t\t\t\t\t\tif (boundElement.type === 'text') {\n\t\t\t\t\t\t\tconst labelElement = elements.find((elm: any) => elm.id === boundElement.id)\n\t\t\t\t\t\t\tif (labelElement) {\n\t\t\t\t\t\t\t\ttext = labelElement.text\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tconst start = element.points[0]\n\t\t\t\tconst end = element.points[element.points.length - 1]\n\n\t\t\t\tconst startTargetId = excElementIdsToTldrawShapeIds.get(element.startBinding?.elementId)\n\t\t\t\tconst endTargetId = excElementIdsToTldrawShapeIds.get(element.endBinding?.elementId)\n\n\t\t\t\ttldrawContent.shapes.push({\n\t\t\t\t\t...base,\n\t\t\t\t\ttype: 'arrow',\n\t\t\t\t\tprops: {\n\t\t\t\t\t\ttext,\n\t\t\t\t\t\tbend: getBend(element, start, end),\n\t\t\t\t\t\tdash: getDash(element),\n\t\t\t\t\t\topacity: getOpacity(element.opacity),\n\t\t\t\t\t\tsize: strokeWidthsToSizes[element.strokeWidth] ?? 'm',\n\t\t\t\t\t\tcolor: colorsToColors[element.strokeColor] ?? 'black',\n\t\t\t\t\t\tstart: startTargetId\n\t\t\t\t\t\t\t? {\n\t\t\t\t\t\t\t\t\ttype: 'binding',\n\t\t\t\t\t\t\t\t\tboundShapeId: startTargetId,\n\t\t\t\t\t\t\t\t\tnormalizedAnchor: { x: 0.5, y: 0.5 },\n\t\t\t\t\t\t\t\t\tisExact: false,\n\t\t\t\t\t\t\t  }\n\t\t\t\t\t\t\t: {\n\t\t\t\t\t\t\t\t\ttype: 'point',\n\t\t\t\t\t\t\t\t\tx: start[0],\n\t\t\t\t\t\t\t\t\ty: start[1],\n\t\t\t\t\t\t\t  },\n\t\t\t\t\t\tend: endTargetId\n\t\t\t\t\t\t\t? {\n\t\t\t\t\t\t\t\t\ttype: 'binding',\n\t\t\t\t\t\t\t\t\tboundShapeId: endTargetId,\n\t\t\t\t\t\t\t\t\tnormalizedAnchor: { x: 0.5, y: 0.5 },\n\t\t\t\t\t\t\t\t\tisExact: false,\n\t\t\t\t\t\t\t  }\n\t\t\t\t\t\t\t: {\n\t\t\t\t\t\t\t\t\ttype: 'point',\n\t\t\t\t\t\t\t\t\tx: end[0],\n\t\t\t\t\t\t\t\t\ty: end[1],\n\t\t\t\t\t\t\t  },\n\t\t\t\t\t\tarrowheadEnd: arrowheadsToArrowheadTypes[element.endArrowhead] ?? 'none',\n\t\t\t\t\t\tarrowheadStart: arrowheadsToArrowheadTypes[element.startArrowhead] ?? 'none',\n\t\t\t\t\t},\n\t\t\t\t})\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tcase 'text': {\n\t\t\t\tconst { size, scale } = getFontSizeAndScale(element.fontSize)\n\n\t\t\t\ttldrawContent.shapes.push({\n\t\t\t\t\t...base,\n\t\t\t\t\ttype: 'text',\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tsize,\n\t\t\t\t\t\tscale,\n\t\t\t\t\t\tfont: fontFamilyToFontType[element.fontFamily] ?? 'draw',\n\t\t\t\t\t\topacity: getOpacity(element.opacity),\n\t\t\t\t\t\tcolor: colorsToColors[element.strokeColor] ?? 'black',\n\t\t\t\t\t\ttext: element.text,\n\t\t\t\t\t\talign: textAlignToAlignTypes[element.textAlign],\n\t\t\t\t\t},\n\t\t\t\t})\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tcase 'image': {\n\t\t\t\tconst file = files[element.fileId]\n\t\t\t\tif (!file) break\n\n\t\t\t\tconst assetId: TLAssetId = TLAsset.createId()\n\t\t\t\ttldrawContent.assets.push({\n\t\t\t\t\tid: assetId,\n\t\t\t\t\ttypeName: 'asset',\n\t\t\t\t\ttype: 'image',\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tw: element.width,\n\t\t\t\t\t\th: element.height,\n\t\t\t\t\t\tname: element.id ?? 'Untitled',\n\t\t\t\t\t\tisAnimated: false,\n\t\t\t\t\t\tmimeType: file.mimeType,\n\t\t\t\t\t\tsrc: file.dataURL,\n\t\t\t\t\t},\n\t\t\t\t})\n\n\t\t\t\ttldrawContent.shapes.push({\n\t\t\t\t\t...base,\n\t\t\t\t\ttype: 'image',\n\t\t\t\t\tprops: {\n\t\t\t\t\t\topacity: getOpacity(element.opacity),\n\t\t\t\t\t\tw: element.width,\n\t\t\t\t\t\th: element.height,\n\t\t\t\t\t\tassetId,\n\t\t\t\t\t},\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\n\t\tindex = getIndexAbove(index)\n\t}\n\n\tconst p = point ?? (app.inputs.shiftKey ? app.inputs.currentPagePoint : undefined)\n\n\tapp.mark('paste')\n\n\tapp.putContent(tldrawContent, {\n\t\tpoint: p,\n\t\tselect: false,\n\t\tpreserveIds: true,\n\t})\n\tfor (const groupedShapeIds of groupShapeIdToChildren.values()) {\n\t\tif (groupedShapeIds.length > 1) {\n\t\t\tapp.groupShapes(groupedShapeIds)\n\t\t\tconst groupShape = app.getShapeById(groupedShapeIds[0])\n\t\t\tif (groupShape?.parentId && isShapeId(groupShape.parentId)) {\n\t\t\t\trootShapeIds.push(groupShape.parentId)\n\t\t\t}\n\t\t}\n\t}\n\n\tfor (const [id, angle] of rotatedElements) {\n\t\tapp.select(id)\n\t\tapp.rotateShapesBy([id], angle)\n\t}\n\n\tconst rootShapes = compact(rootShapeIds.map((id) => app.getShapeById(id)))\n\tconst bounds = Box2d.Common(rootShapes.map((s) => app.getPageBounds(s)!))\n\tconst viewPortCenter = app.viewportPageBounds.center\n\tapp.updateShapes(\n\t\trootShapes.map((s) => {\n\t\t\tconst delta = {\n\t\t\t\tx: (s.x ?? 0) - (bounds.x + bounds.w / 2),\n\t\t\t\ty: (s.y ?? 0) - (bounds.y + bounds.h / 2),\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tid: s.id,\n\t\t\t\ttype: s.type,\n\t\t\t\tx: viewPortCenter.x + delta.x,\n\t\t\t\ty: viewPortCenter.y + delta.y,\n\t\t\t}\n\t\t})\n\t)\n\tapp.setSelectedIds(rootShapeIds)\n}\n\nconst handleFilesBlob = async (app: App, blobs: Blob[], point?: VecLike) => {\n\tconst urls = blobs.map((blob) => URL.createObjectURL(blob))\n\n\tpasteFiles(app, urls, point)\n}\n\nconst handleHtmlString = async (app: App, html: string, point?: VecLike) => {\n\tconst s = html.match(/<tldraw[^>]*>(.*)<\\/tldraw>/)?.[1]\n\tif (s) {\n\t\ttry {\n\t\t\tconst json = JSON.parse(decompressFromBase64(s)!)\n\t\t\tif (json.type === 'application/tldraw') {\n\t\t\t\tpasteTldrawContent(app, json.data, point)\n\t\t\t} else {\n\t\t\t\tpasteText(app, s, point)\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tpasteText(app, s, point)\n\t\t}\n\t} else {\n\t\tconst rootNode = new DOMParser().parseFromString(html, 'text/html')\n\t\tconst bodyNode = rootNode.querySelector('body')\n\n\t\t// Edge on Windows 11 home appears to paste a link as a single <a/> in\n\t\t// the HTML document. If we're pasting a single like tag we'll just\n\t\t// assume the user meant to paste the URL.\n\t\tconst isHtmlSingleLink =\n\t\t\tbodyNode &&\n\t\t\tArray.from(bodyNode.children).filter((el) => el.nodeType === 1).length === 1 &&\n\t\t\tbodyNode.firstElementChild &&\n\t\t\tbodyNode.firstElementChild.tagName === 'A' &&\n\t\t\tbodyNode.firstElementChild.hasAttribute('href') &&\n\t\t\tbodyNode.firstElementChild.getAttribute('href') !== ''\n\n\t\tif (isHtmlSingleLink) {\n\t\t\tconst href = bodyNode.firstElementChild.getAttribute('href')!\n\t\t\tpasteText(app, href, point)\n\t\t} else {\n\t\t\tpasteText(app, html, point)\n\t\t}\n\t}\n}\n\nconst handleTextString = async (app: App, text: string, point?: VecLike) => {\n\tconst s = text.trim()\n\n\tconst tldrawContent = text.match(/<tldraw[^>]*>(.*)<\\/tldraw>/)?.[1]\n\tif (tldrawContent) {\n\t\thandleHtmlString(app, text)\n\t} else if (s) {\n\t\ttry {\n\t\t\tconst json = JSON.parse(s)\n\t\t\tif (json.type === 'application/tldraw') {\n\t\t\t\tpasteTldrawContent(app, json.data, point)\n\t\t\t} else if (json.type === 'excalidraw/clipboard') {\n\t\t\t\tpasteExcalidrawContent(app, json, point)\n\t\t\t} else {\n\t\t\t\tpasteText(app, s, point)\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tpasteText(app, s, point)\n\t\t}\n\t}\n}\n\nconst handleNativeDataTransferPaste = async (\n\tapp: App,\n\tclipboardData: DataTransfer,\n\tpoint?: VecLike\n) => {\n\t// Do not paste while in any editing state\n\tif (app.isIn('select.editing')) return\n\n\tif (clipboardData) {\n\t\tconst items = Object.values(clipboardData.items)\n\n\t\t// In some cases, the clipboard will contain both the name of a file and the file itself\n\t\t// we need to avoid writing a text shape for the name AND an image or video shape for the file\n\t\tconst writingFile = items.some((item) => item.kind === 'file')\n\n\t\t// If we're pasting in tldraw content (shapes, etc) then the clipboard may\n\t\t// contain both text content. We'll only paste the content.\n\t\tconst writingContent = items.some((item) => item.type === 'text/html')\n\n\t\t// We need to handle files separately because if we want them to\n\t\t// be placed next to each other, we need to create them all at once\n\n\t\tconst files: Blob[] = []\n\t\tconst text: DataTransferItem[] = []\n\n\t\titems.forEach((item) => {\n\t\t\tif (item.kind === 'file') {\n\t\t\t\tconst file = item.getAsFile()\n\t\t\t\tif (file) {\n\t\t\t\t\tfiles.push(file)\n\t\t\t\t}\n\t\t\t} else if (item.kind === 'string') {\n\t\t\t\ttext.push(item)\n\t\t\t}\n\t\t})\n\n\t\tif (files.length > 0) {\n\t\t\thandleFilesBlob(app, files, point)\n\t\t}\n\n\t\tfor (const item of text) {\n\t\t\tif (!writingFile && item.type === 'text/html') {\n\t\t\t\tawait handleHtmlString(app, await dataTransferItemAsString(item), point)\n\t\t\t} else if (item.type === 'text/plain') {\n\t\t\t\tif (!writingContent) {\n\t\t\t\t\tawait handleTextString(app, await dataTransferItemAsString(item), point)\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nconst handleNativeClipboardPaste = async (\n\tapp: App,\n\tclipboardItems: ClipboardItem[],\n\tpoint?: VecLike\n) => {\n\t// Do not paste while in any editing state\n\tif (app.isIn('select.editing')) return\n\n\tconst isFile = (item: ClipboardItem) => {\n\t\treturn item.types.find((i) => i.match(/^image\\//))\n\t}\n\n\t// In some cases, the clipboard will contain both the name of a file and the file itself\n\t// we need to avoid writing a text shape for the name AND an image or video shape for the file\n\tconst writingFile = clipboardItems.some((item) => isFile(item))\n\n\t// If we're pasting in tldraw content (shapes, etc) then the clipboard may\n\t// contain both text content. We'll only paste the content.\n\tconst writingContent = clipboardItems.some((item) => item.types.includes('text/html'))\n\n\t// We need to handle files separately because if we want them to\n\t// be placed next to each other, we need to create them all at once\n\n\tconst files: ClipboardItem[] = clipboardItems.filter((item) => {\n\t\tif (item.types.find((i) => i.match(/^image\\//))) {\n\t\t\treturn true\n\t\t}\n\n\t\treturn false\n\t})\n\n\tawait Promise.all(\n\t\tfiles.map(async (item) => {\n\t\t\tconst type = item.types.find((t) => t !== 'text/plain' && t !== 'text/html')\n\t\t\tif (type) {\n\t\t\t\tconst file = await item.getType(type)\n\t\t\t\tif (file) {\n\t\t\t\t\tawait handleFilesBlob(app, [file], point)\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\t)\n\n\tfor (const item of clipboardItems) {\n\t\tif (item.types.includes('text/html')) {\n\t\t\tif (writingFile) break\n\n\t\t\tconst blob = await item.getType('text/html')\n\t\t\tawait handleHtmlString(app, await blobAsString(blob), point)\n\t\t} else if (item.types.includes('text/uri-list')) {\n\t\t\tif (writingContent) break\n\n\t\t\tconst blob = await item.getType('text/uri-list')\n\t\t\tawait pasteUrl(app, await blobAsString(blob), point)\n\t\t} else if (item.types.includes('text/plain')) {\n\t\t\tif (writingContent) break\n\n\t\t\tconst blob = await item.getType('text/plain')\n\t\t\tawait handleTextString(app, await blobAsString(blob), point)\n\t\t}\n\t}\n}\n\n/** @public */\nexport function useMenuClipboardEvents() {\n\tconst app = useApp()\n\n\tconst copy = useCallback(\n\t\tfunction onCopy() {\n\t\t\tif (app.selectedIds.length === 0) return\n\t\t\thandleMenuCopy(app)\n\t\t},\n\t\t[app]\n\t)\n\n\tconst cut = useCallback(\n\t\tfunction onCut() {\n\t\t\tif (app.selectedIds.length === 0) return\n\t\t\thandleMenuCopy(app)\n\t\t\tapp.deleteShapes()\n\t\t},\n\t\t[app]\n\t)\n\n\tconst paste = useCallback(\n\t\tasync function onPaste(data: DataTransfer | ClipboardItem[], point?: VecLike) {\n\t\t\tif (Array.isArray(data) && data[0] instanceof ClipboardItem) {\n\t\t\t\thandleNativeClipboardPaste(app, data, point)\n\t\t\t} else {\n\t\t\t\tnavigator.clipboard.read().then((clipboardItems) => {\n\t\t\t\t\tpaste(clipboardItems, app.inputs.currentPagePoint)\n\t\t\t\t})\n\t\t\t}\n\n\t\t\t// else {\n\t\t\t// \thandleScenePaste(app, point)\n\t\t\t// }\n\t\t},\n\t\t[app]\n\t)\n\n\treturn {\n\t\tcopy,\n\t\tcut,\n\t\tpaste,\n\t}\n}\n\n/** @public */\nexport function useNativeClipboardEvents() {\n\tconst app = useApp()\n\n\tuseEffect(() => {\n\t\tconst copy = () => {\n\t\t\tif (app.selectedIds.length === 0 || app.editingId !== null || disallowClipboardEvents(app))\n\t\t\t\treturn\n\t\t\thandleMenuCopy(app)\n\t\t}\n\n\t\tfunction cut() {\n\t\t\tif (app.selectedIds.length === 0 || app.editingId !== null || disallowClipboardEvents(app))\n\t\t\t\treturn\n\t\t\thandleMenuCopy(app)\n\t\t\tapp.deleteShapes()\n\t\t}\n\n\t\tconst paste = (event: ClipboardEvent) => {\n\t\t\tif (app.editingId !== null || disallowClipboardEvents(app)) return\n\t\t\tif (event.clipboardData && !app.inputs.shiftKey) {\n\t\t\t\thandleNativeDataTransferPaste(app, event.clipboardData)\n\t\t\t} else {\n\t\t\t\tnavigator.clipboard.read().then((clipboardItems) => {\n\t\t\t\t\tif (Array.isArray(clipboardItems) && clipboardItems[0] instanceof ClipboardItem) {\n\t\t\t\t\t\thandleNativeClipboardPaste(app, clipboardItems, app.inputs.currentPagePoint)\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\n\t\tdocument.addEventListener('copy', copy)\n\t\tdocument.addEventListener('cut', cut)\n\t\tdocument.addEventListener('paste', paste)\n\n\t\treturn () => {\n\t\t\tdocument.removeEventListener('copy', copy)\n\t\t\tdocument.removeEventListener('cut', cut)\n\t\t\tdocument.removeEventListener('paste', paste)\n\t\t}\n\t}, [app])\n}\n","import { App, uniqueId } from '@tldraw/editor'\nimport { createContext, useCallback, useContext, useState } from 'react'\n\n/** @public */\nexport interface TLToast {\n\tid: string\n\ticon?: string\n\ttitle?: string\n\tdescription?: string\n\tactions?: TLToastAction[]\n\tkeepOpen?: boolean\n\tcloseLabel?: string\n}\n\n/** @public */\nexport interface TLToastAction {\n\ttype: 'primary' | 'secondary' | 'warn'\n\tlabel: string\n\tonClick: () => void\n}\n\n/** @public */\nexport type ToastsContextType = {\n\taddToast: (toast: Omit<TLToast, 'id'> & { id?: string }) => string\n\tremoveToast: (id: TLToast['id']) => string\n\tclearToasts: () => void\n\ttoasts: TLToast[]\n}\n\n/** @public */\nexport const ToastsContext = createContext({} as ToastsContextType)\n\n/** @public */\nexport type ToastsProviderProps = {\n\toverrides?: (app: App) => ToastsContextType\n\tchildren: any\n}\n\n/** @public */\nexport function ToastsProvider({ children }: ToastsProviderProps) {\n\tconst [toasts, setToasts] = useState<TLToast[]>([])\n\n\tconst addToast = useCallback((toast: Omit<TLToast, 'id'> & { id?: string }) => {\n\t\tconst id = toast.id ?? uniqueId()\n\t\tsetToasts((d) => [...d.filter((m) => m.id !== toast.id), { ...toast, id }])\n\t\treturn id\n\t}, [])\n\n\tconst removeToast = useCallback((id: string) => {\n\t\tsetToasts((d) => d.filter((m) => m.id !== id))\n\t\treturn id\n\t}, [])\n\n\tconst clearToasts = useCallback(() => {\n\t\tsetToasts(() => [])\n\t}, [])\n\n\treturn (\n\t\t<ToastsContext.Provider value={{ toasts, addToast, removeToast, clearToasts }}>\n\t\t\t{children}\n\t\t</ToastsContext.Provider>\n\t)\n}\n\n/** @public */\nexport function useToasts() {\n\tconst ctx = useContext(ToastsContext)\n\n\tif (!ctx) {\n\t\tthrow new Error('useToasts must be used within a ToastsProvider')\n\t}\n\n\treturn ctx\n}\n","// This file is automatically generated by scripts/refresh-assets.ts.\n// Do not edit manually.\n\n/** @internal */\nexport const DEFAULT_TRANSLATION = {\n\t'action.convert-to-bookmark': 'Convert to Bookmark',\n\t'action.convert-to-embed': 'Convert to Embed',\n\t'action.open-embed-link': 'Open link',\n\t'action.align-bottom': 'Align bottom',\n\t'action.align-center-horizontal': 'Align horizontally',\n\t'action.align-center-vertical': 'Align vertically',\n\t'action.align-center-horizontal.short': 'Align H',\n\t'action.align-center-vertical.short': 'Align V',\n\t'action.align-left': 'Align left',\n\t'action.align-right': 'Align right',\n\t'action.align-top': 'Align top',\n\t'action.back-to-content': 'Back to content',\n\t'action.bring-forward': 'Bring forward',\n\t'action.bring-to-front': 'Bring to front',\n\t'action.copy-as-json.short': 'JSON',\n\t'action.copy-as-json': 'Copy as JSON',\n\t'action.copy-as-png.short': 'PNG',\n\t'action.copy-as-png': 'Copy as PNG',\n\t'action.copy-as-svg.short': 'SVG',\n\t'action.copy-as-svg': 'Copy as SVG',\n\t'action.copy': 'Copy',\n\t'action.cut': 'Cut',\n\t'action.delete': 'Delete',\n\t'action.distribute-horizontal': 'Distribute horizontally',\n\t'action.distribute-vertical': 'Distribute vertically',\n\t'action.distribute-horizontal.short': 'Distribute H',\n\t'action.distribute-vertical.short': 'Distribute V',\n\t'action.duplicate': 'Duplicate',\n\t'action.edit-link': 'Edit link',\n\t'action.exit-pen-mode': 'Exit pen mode',\n\t'action.export-as-json.short': 'JSON',\n\t'action.export-as-json': 'Export as JSON',\n\t'action.export-as-png.short': 'PNG',\n\t'action.export-as-png': 'Export as PNG',\n\t'action.export-as-svg.short': 'SVG',\n\t'action.export-as-svg': 'Export as SVG',\n\t'action.flip-horizontal': 'Flip horizontally',\n\t'action.flip-vertical': 'Flip vertically',\n\t'action.flip-horizontal.short': 'Flip H',\n\t'action.flip-vertical.short': 'Flip V',\n\t'action.group': 'Group',\n\t'action.insert-media': 'Upload media',\n\t'action.new-shared-project': 'New shared project',\n\t'action.nudge-down': 'Nudge down',\n\t'action.nudge-left': 'Nudge left',\n\t'action.nudge-right': 'Nudge right',\n\t'action.nudge-up': 'Nudge up',\n\t'action.open-file': 'Open file',\n\t'action.pack': 'Pack',\n\t'action.paste': 'Paste',\n\t'action.print': 'Print',\n\t'action.redo': 'Redo',\n\t'action.rotate-ccw': 'Rotate counterclockwise',\n\t'action.rotate-cw': 'Rotate clockwise',\n\t'action.save-copy': 'Save a copy',\n\t'action.select-all': 'Select all',\n\t'action.select-none': 'Select none',\n\t'action.send-backward': 'Send backward',\n\t'action.send-to-back': 'Send to back',\n\t'action.share-project': 'Share this project',\n\t'action.stack-horizontal': 'Stack horizontally',\n\t'action.stack-vertical': 'Stack vertically',\n\t'action.stack-horizontal.short': 'Stack H',\n\t'action.stack-vertical.short': 'Stack V',\n\t'action.stretch-horizontal': 'Stretch horizontally',\n\t'action.stretch-vertical': 'Stretch vertically',\n\t'action.stretch-horizontal.short': 'Stretch H',\n\t'action.stretch-vertical.short': 'Stretch V',\n\t'action.toggle-auto-size': 'Toggle auto size',\n\t'action.toggle-dark-mode.menu': 'Dark mode',\n\t'action.toggle-dark-mode': 'Toggle dark mode',\n\t'action.toggle-debug-mode.menu': 'Debug mode',\n\t'action.toggle-debug-mode': 'Toggle debug mode',\n\t'action.toggle-focus-mode.menu': 'Focus mode',\n\t'action.toggle-focus-mode': 'Toggle focus mode',\n\t'action.toggle-grid.menu': 'Show grid',\n\t'action.toggle-grid': 'Toggle grid',\n\t'action.toggle-snap-mode.menu': 'Always snap',\n\t'action.toggle-snap-mode': 'Toggle always snap',\n\t'action.toggle-tool-lock.menu': 'Tool lock',\n\t'action.toggle-tool-lock': 'Toggle tool lock',\n\t'action.toggle-transparent.context-menu': 'Transparent',\n\t'action.toggle-transparent.menu': 'Transparent',\n\t'action.toggle-transparent': 'Toggle transparent background',\n\t'action.undo': 'Undo',\n\t'action.ungroup': 'Ungroup',\n\t'action.zoom-in': 'Zoom in',\n\t'action.zoom-out': 'Zoom out',\n\t'action.zoom-to-100': 'Zoom to 100%',\n\t'action.zoom-to-fit': 'Zoom to fit',\n\t'action.zoom-to-selection': 'Zoom to selection',\n\t'color-style.black': 'Black',\n\t'color-style.blue': 'Blue',\n\t'color-style.green': 'Green',\n\t'color-style.grey': 'Grey',\n\t'color-style.light-blue': 'Light blue',\n\t'color-style.light-green': 'Light green',\n\t'color-style.light-red': 'Light red',\n\t'color-style.light-violet': 'Light violet',\n\t'color-style.orange': 'Orange',\n\t'color-style.red': 'Red',\n\t'color-style.violet': 'Violet',\n\t'color-style.yellow': 'Yellow',\n\t'fill-style.none': 'None',\n\t'fill-style.semi': 'Semi',\n\t'fill-style.solid': 'Solid',\n\t'fill-style.pattern': 'Pattern',\n\t'dash-style.dashed': 'Dashed',\n\t'dash-style.dotted': 'Dotted',\n\t'dash-style.draw': 'Draw',\n\t'dash-style.solid': 'Solid',\n\t'size-style.s': 'Small',\n\t'size-style.m': 'Medium',\n\t'size-style.l': 'Large',\n\t'size-style.xl': 'Extra large',\n\t'opacity-style.0.1': '10%',\n\t'opacity-style.0.25': '25%',\n\t'opacity-style.0.5': '50%',\n\t'opacity-style.0.75': '75%',\n\t'opacity-style.1': '100%',\n\t'font-style.draw': 'Draw',\n\t'font-style.sans': 'Sans',\n\t'font-style.serif': 'Serif',\n\t'font-style.mono': 'Mono',\n\t'align-style.start': 'Start',\n\t'align-style.middle': 'Middle',\n\t'align-style.end': 'End',\n\t'align-style.justify': 'Justify',\n\t'geo-style.arrow-down': 'Arrow down',\n\t'geo-style.arrow-left': 'Arrow left',\n\t'geo-style.arrow-right': 'Arrow right',\n\t'geo-style.arrow-up': 'Arrow up',\n\t'geo-style.diamond': 'Diamond',\n\t'geo-style.ellipse': 'Ellipse',\n\t'geo-style.hexagon': 'Hexagon',\n\t'geo-style.octagon': 'Octagon',\n\t'geo-style.oval': 'Oval',\n\t'geo-style.pentagon': 'Pentagon',\n\t'geo-style.rectangle': 'Rectangle',\n\t'geo-style.rhombus-2': 'Rhombus 2',\n\t'geo-style.rhombus': 'Rhombus',\n\t'geo-style.star': 'Star',\n\t'geo-style.trapezoid': 'Trapezoid',\n\t'geo-style.triangle': 'Triangle',\n\t'geo-style.x-box': 'X Box',\n\t'arrowheadStart-style.none': 'None',\n\t'arrowheadStart-style.arrow': 'Arrow',\n\t'arrowheadStart-style.bar': 'Bar',\n\t'arrowheadStart-style.diamond': 'Diamond',\n\t'arrowheadStart-style.dot': 'Dot',\n\t'arrowheadStart-style.inverted': 'Inverted',\n\t'arrowheadStart-style.pipe': 'Pipe',\n\t'arrowheadStart-style.square': 'Square',\n\t'arrowheadStart-style.triangle': 'Triangle',\n\t'arrowheadEnd-style.none': 'None',\n\t'arrowheadEnd-style.arrow': 'Arrow',\n\t'arrowheadEnd-style.bar': 'Bar',\n\t'arrowheadEnd-style.diamond': 'Diamond',\n\t'arrowheadEnd-style.dot': 'Dot',\n\t'arrowheadEnd-style.inverted': 'Inverted',\n\t'arrowheadEnd-style.pipe': 'Pipe',\n\t'arrowheadEnd-style.square': 'Square',\n\t'arrowheadEnd-style.triangle': 'Triangle',\n\t'spline-style.line': 'Line',\n\t'spline-style.cubic': 'Cubic',\n\t'tool.select': 'Select',\n\t'tool.hand': 'Hand',\n\t'tool.draw': 'Draw',\n\t'tool.eraser': 'Eraser',\n\t'tool.arrow-down': 'Arrow down',\n\t'tool.arrow-left': 'Arrow left',\n\t'tool.arrow-right': 'Arrow right',\n\t'tool.arrow-up': 'Arrow up',\n\t'tool.arrow': 'Arrow',\n\t'tool.diamond': 'Diamond',\n\t'tool.ellipse': 'Ellipse',\n\t'tool.hexagon': 'Hexagon',\n\t'tool.line': 'Line',\n\t'tool.octagon': 'Octagon',\n\t'tool.oval': 'Oval',\n\t'tool.pentagon': 'Pentagon',\n\t'tool.rectangle': 'Rectangle',\n\t'tool.rhombus': 'Rhombus',\n\t'tool.star': 'Star',\n\t'tool.trapezoid': 'Trapezoid',\n\t'tool.triangle': 'Triangle',\n\t'tool.x-box': 'X box',\n\t'tool.asset': 'Asset',\n\t'tool.frame': 'Frame',\n\t'tool.note': 'Note',\n\t'tool.embed': 'Embed',\n\t'tool.text': 'Text',\n\t'menu.title': 'Menu',\n\t'menu.copy-as': 'Copy as',\n\t'menu.edit': 'Edit',\n\t'menu.export-as': 'Export as',\n\t'menu.file': 'File',\n\t'menu.language': 'Language',\n\t'menu.preferences': 'Preferences',\n\t'menu.view': 'View',\n\t'context-menu.arrange': 'Arrange',\n\t'context-menu.copy-as': 'Copy as',\n\t'context-menu.export-as': 'Export as',\n\t'context-menu.move-to-page': 'Move to page',\n\t'context-menu.reorder': 'Reorder',\n\t'page-menu.title': 'Pages',\n\t'page-menu.create-new-page': 'Create new page',\n\t'page-menu.edit-pages': 'Edit pages',\n\t'page-menu.max-page-count-reached': 'Max pages reached',\n\t'page-menu.new-page-initial-name': 'Page 1',\n\t'page-menu.page': 'Page',\n\t'page-menu.edit-start': 'Edit',\n\t'page-menu.edit-done': 'Done',\n\t'page-menu.submenu.rename': 'Rename',\n\t'page-menu.submenu.duplicate-page': 'Duplicate',\n\t'page-menu.submenu.go-to-page': 'Go to page',\n\t'page-menu.submenu.title': 'Menu',\n\t'page-menu.submenu.move-down': 'Move down',\n\t'page-menu.submenu.move-up': 'Move up',\n\t'page-menu.submenu.delete': 'Delete',\n\t'share-menu.title': 'Share',\n\t'share-menu.share-project': 'Share this project',\n\t'share-menu.create-project': 'New shared project',\n\t'share-menu.copy-link': 'Copy link',\n\t'share-menu.readonly-link': 'Read-only',\n\t'share-menu.copy-readonly-link': 'Copy read-only link',\n\t'share-menu.offline-note':\n\t\t'Sharing this project will create a hosted live copy at a new URL. You can share the URL with up to thirty other people to view and edit the project together.',\n\t'share-menu.copy-link-note': 'Anyone with the link will be able to view and edit this project.',\n\t'share-menu.copy-readonly-link-note':\n\t\t'Anyone with the link will be able to view (but not edit) this project.',\n\t'share-menu.project-too-large':\n\t\t\"Sorry, this project can't be shared because it's too large. We're working on it!\",\n\t'people-menu.title': 'People',\n\t'people-menu.change-name': 'Change name',\n\t'people-menu.change-color': 'Change color',\n\t'people-menu.user': '(You)',\n\t'people-menu.invite': 'Invite others',\n\t'debug-menu.hard-reset': 'Hard reset',\n\t'debug-menu.create-shapes': 'Create 100 shapes',\n\t'help-menu.title': 'Help and resources',\n\t'help-menu.about': 'About',\n\t'help-menu.discord': 'Discord',\n\t'help-menu.github': 'GitHub',\n\t'help-menu.keyboard-shortcuts': 'Keyboard shortcuts',\n\t'help-menu.twitter': 'Twitter',\n\t'links-menu.about': 'About',\n\t'links-menu.discord': 'Discord',\n\t'links-menu.github': 'GitHub',\n\t'links-menu.twitter': 'Twitter',\n\t'actions-menu.title': 'Actions',\n\t'edit-link-dialog.title': 'Edit link',\n\t'edit-link-dialog.invalid-url': 'A link must be a valid URL.',\n\t'edit-link-dialog.detail': 'Links will open in a new tab.',\n\t'edit-link-dialog.url': 'URL',\n\t'edit-link-dialog.clear': 'Clear',\n\t'edit-link-dialog.save': 'Continue',\n\t'edit-link-dialog.cancel': 'Cancel',\n\t'embed-dialog.title': 'Create embed',\n\t'embed-dialog.url-title': 'Create %s embed',\n\t'embed-dialog.url-label': 'Paste URL',\n\t'embed-dialog.back': 'Back',\n\t'embed-dialog.create': 'Create',\n\t'embed-dialog.cancel': 'Cancel',\n\t'embed-dialog.url': 'URL',\n\t'embed-dialog.instruction': \"Paste in the site's URL to create the embed.\",\n\t'embed-dialog.invalid-url': 'We could not create an embed from that URL.',\n\t'edit-pages-dialog.title': 'Edit pages',\n\t'edit-pages-dialog.create-new-page': 'Create new page',\n\t'edit-pages-dialog.delete': 'Delete',\n\t'edit-pages-dialog.duplicate-page': 'Duplicate',\n\t'edit-pages-dialog.go-to-page': 'Go to page',\n\t'edit-pages-dialog.max-page-count-reached': 'Max pages reached',\n\t'edit-pages-dialog.more-menu': 'Menu',\n\t'edit-pages-dialog.move-down': 'Move down',\n\t'edit-pages-dialog.move-up': 'Move up',\n\t'edit-pages-dialog.new-page-initial-name': 'Page 1',\n\t'reload-file-dialog.title': 'Continue editing file',\n\t'reload-file-dialog.description':\n\t\t'You were just editing a file. Would you like to continue editing it?',\n\t'reload-file-dialog.failure': 'Failed to reload file. Try again?',\n\t'reload-file-dialog.reload': 'Continue editing',\n\t'reload-file-dialog.revert': 'No thanks',\n\t'shortcuts-dialog.title': 'Keyboard shortcuts',\n\t'shortcuts-dialog.edit': 'Edit',\n\t'shortcuts-dialog.file': 'File',\n\t'shortcuts-dialog.preferences': 'Preferences',\n\t'shortcuts-dialog.tools': 'Tools',\n\t'shortcuts-dialog.transform': 'Transform',\n\t'shortcuts-dialog.view': 'View',\n\t'shortcuts-dialog.save': 'Continue',\n\t'style-panel.title': 'Styles',\n\t'style-panel.align': 'Align',\n\t'style-panel.arrowheads': 'Arrowheads',\n\t'style-panel.arrowhead-start': 'Start',\n\t'style-panel.arrowhead-end': 'End',\n\t'style-panel.color': 'Color',\n\t'style-panel.dash': 'Dash',\n\t'style-panel.fill': 'Fill',\n\t'style-panel.font': 'Font',\n\t'style-panel.geo': 'Shape',\n\t'style-panel.label': 'Label',\n\t'style-panel.mixed': 'Mixed',\n\t'style-panel.opacity': 'Opacity',\n\t'style-panel.size': 'Size',\n\t'style-panel.spline': 'Spline',\n\t'style-panel.text': 'Text',\n\t'tool-panel.drawing': 'Drawing',\n\t'tool-panel.geo': 'Shape',\n\t'tool-panel.shapes': 'Shapes',\n\t'tool-panel.things': 'Things',\n\t'tool-panel.tools': 'Tools',\n\t'save-changes-prompt.title': 'You have unsaved changes',\n\t'save-changes-prompt.description': 'Would you like to save changes to your current file?',\n\t'save-changes-prompt.go-back': 'Go back',\n\t'save-changes-prompt.continue': 'Continue',\n\t'navigation-zone.toggle-minimap': 'Toggle minimap',\n\t'navigation-zone.zoom': 'Zoom',\n\t'focus-mode.toggle-focus-mode': 'Toggle focus mode',\n\t'toast.close': 'Close',\n\t'file-system.file-open-error.title': 'Could not open file',\n\t'file-system.file-open-error.not-a-tldraw-file':\n\t\t\"The file you tried to open doesn't look like a tldraw file.\",\n\t'file-system.file-open-error.file-format-version-too-new':\n\t\t'The file you tried to open is from a newer version of tldraw. Please reload the page and try again.',\n\t'file-system.file-open-error.generic-corrupted-file': 'The file you tried to open is corrupted.',\n\t'file-system.confirm-open.title': 'Overwrite current project?',\n\t'file-system.confirm-open.description':\n\t\t'Opening a file will replace your current project and any unsaved changes will be lost. Are you sure you want to continue?',\n\t'file-system.confirm-open.cancel': 'Cancel',\n\t'file-system.confirm-open.open': 'Open file',\n\t'file-system.confirm-open.dont-show-again': \"Don't ask again\",\n\t'file-system.shared-document-file-open-error.title': 'Could not open file',\n\t'file-system.shared-document-file-open-error.description':\n\t\t'Opening files from shared projects is not supported.',\n\t'toast.error.export-fail.title': 'Failed export',\n\t'toast.error.export-fail.desc': 'Failed to export image',\n\t'toast.error.copy-fail.title': 'Failed copy',\n\t'toast.error.copy-fail.desc': 'Failed to copy image',\n\t'context.pages.new-page': 'New page',\n\t'vscode.file-open.desc':\n\t\t\"We've updated this document to work with the current version of tldraw. If you'd like to keep the original version (which will work on old.tldraw.com), click below to create a backup.\",\n\t'vscode.file-open.open': 'Continue',\n\t'vscode.file-open.backup': 'Backup',\n\t'vscode.file-open.backup-saved': 'Backup saved',\n\t'vscode.file-open.backup-failed': 'Backup failed: this is not a .tldr file.',\n\t'vscode.file-open.dont-show-again': \"Don't ask again\",\n}\n","// This file is automatically generated by scripts/refresh-assets.ts.\n// Do not edit manually.\n\n/** @public */\nexport const LANGUAGES = [\n\t{ locale: 'ar', label: '' },\n\t{ locale: 'ca', label: 'Catal' },\n\t{ locale: 'da', label: 'Danish' },\n\t{ locale: 'de', label: 'Deutsch' },\n\t{ locale: 'en', label: 'English' },\n\t{ locale: 'es', label: 'Espaol' },\n\t{ locale: 'fa', label: '' },\n\t{ locale: 'fi', label: 'Suomi' },\n\t{ locale: 'fr', label: 'Franais' },\n\t{ locale: 'gl', label: 'Galego' },\n\t{ locale: 'he', label: '' },\n\t{ locale: 'it', label: 'Italiano' },\n\t{ locale: 'ja', label: '' },\n\t{ locale: 'ko-kr', label: '' },\n\t{ locale: 'ku', label: '' },\n\t{ locale: 'hi-in', label: '' },\n\t{ locale: 'hu', label: 'Magyar' },\n\t{ locale: 'my', label: '' },\n\t{ locale: 'ne', label: '' },\n\t{ locale: 'no', label: 'Norwegian' },\n\t{ locale: 'pl', label: 'Polski' },\n\t{ locale: 'pt-br', label: 'Portugus - Brasil' },\n\t{ locale: 'pt-pt', label: 'Portugus - Europeu' },\n\t{ locale: 'ro', label: 'Romn' },\n\t{ locale: 'ru', label: 'Russian' },\n\t{ locale: 'sv', label: 'Svenska' },\n\t{ locale: 'te', label: '' },\n\t{ locale: 'th', label: '' },\n\t{ locale: 'tr', label: 'Trke' },\n\t{ locale: 'uk', label: 'Ukrainian' },\n\t{ locale: 'vi', label: 'Ting Vit' },\n\t{ locale: 'zh-cn', label: 'Chinese - Simplified' },\n\t{ locale: 'zh-tw', label: ' ()' },\n] as const\n","import { UiAssetUrls } from '../../assetUrls'\nimport { DEFAULT_TRANSLATION } from './defaultTranslation'\nimport { LANGUAGES } from './languages'\nimport { TLTranslationKey } from './TLTranslationKey'\n\n// The default language (english) must have a value for every message.\n// Other languages may have missing messages. If the application finds\n// a missing message for the current language, it will use the english\n// translation instead.\n\n/* ----------------- (do not change) ---------------- */\n\n/** @public */\nexport type TLListedTranslation = {\n\treadonly locale: string\n\treadonly label: string\n}\n\n/** @public */\nexport type TLListedTranslations = readonly TLListedTranslation[]\n\n/** @public */\nexport type TLTranslationMessages = Record<TLTranslationKey, string>\n\n/** @public */\nexport type TLTranslation = {\n\treadonly locale: string\n\treadonly label: string\n\treadonly messages: TLTranslationMessages\n}\n\n/** @public */\nexport type TLTranslations = TLTranslation[]\n\n/** @public */\nexport type TLTranslationLocale = TLTranslations[number]['locale']\n\n/** @public */\nexport const EN_TRANSLATION: TLTranslation = {\n\tlocale: 'en',\n\tlabel: 'English',\n\tmessages: DEFAULT_TRANSLATION as TLTranslationMessages,\n}\n\n/** @public */\nexport async function fetchTranslation(\n\tlocale: TLTranslationLocale,\n\tassetUrls: UiAssetUrls\n): Promise<TLTranslation> {\n\tconst mainRes = await fetch(assetUrls.translations.en)\n\n\tif (!mainRes.ok) {\n\t\tconsole.warn(`No main translations found.`)\n\t\treturn EN_TRANSLATION\n\t}\n\n\tif (locale === 'en') {\n\t\treturn EN_TRANSLATION\n\t}\n\n\tconst language = LANGUAGES.find((t) => t.locale === locale)\n\n\tif (!language) {\n\t\tconsole.warn(`No translation found for locale ${locale}`)\n\t\treturn EN_TRANSLATION\n\t}\n\n\tconst res = await fetch(assetUrls.translations[language.locale])\n\tconst messages: TLTranslationMessages = await res.json()\n\n\tif (!messages) {\n\t\tconsole.warn(`No messages found for locale ${locale}`)\n\t\treturn EN_TRANSLATION\n\t}\n\n\tconst missing: string[] = []\n\n\tfor (const key in EN_TRANSLATION) {\n\t\tif (!messages[key as TLTranslationKey]) {\n\t\t\tmissing.push(key)\n\t\t}\n\t}\n\n\tif (missing.length > 0 && process.env.NODE_ENV === 'development') {\n\t\tconsole.warn(`Language ${locale}: missing messages for keys:\\n${missing.join('\\n')}`)\n\t}\n\n\treturn { ...EN_TRANSLATION, messages: { ...EN_TRANSLATION.messages, ...messages } }\n}\n\n/** @public */\nexport async function getTranslation(\n\tlocale: TLTranslationLocale,\n\tassetUrls: UiAssetUrls\n): Promise<TLTranslation> {\n\treturn await fetchTranslation(locale, assetUrls)\n}\n","import { useApp } from '@tldraw/editor'\nimport { LANGUAGES } from './languages'\n\n/** @public */\nexport function useLanguages() {\n\tconst app = useApp()\n\treturn { languages: LANGUAGES, currentLanguage: app.user.locale }\n}\n","import { createContext, useContext } from 'react'\nimport { UiAssetUrls } from '../assetUrls'\n\nconst AssetUrlsContext = createContext<UiAssetUrls | null>(null)\n\n/** @public */\nexport function AssetUrlsProvider({\n\tassetUrls,\n\tchildren,\n}: {\n\tassetUrls: UiAssetUrls\n\tchildren: React.ReactNode\n}) {\n\treturn <AssetUrlsContext.Provider value={assetUrls}>{children}</AssetUrlsContext.Provider>\n}\n\n/** @public */\nexport function useAssetUrls() {\n\tconst assetUrls = useContext(AssetUrlsContext)\n\tif (!assetUrls) {\n\t\tthrow new Error('useAssetUrls must be used within an AssetUrlsProvider')\n\t}\n\n\treturn assetUrls\n}\n","import { useApp } from '@tldraw/editor'\nimport * as React from 'react'\nimport { track } from 'signia-react'\nimport { useAssetUrls } from '../useAssetUrls'\nimport { TLTranslationKey } from './TLTranslationKey'\nimport { DEFAULT_TRANSLATION } from './defaultTranslation'\nimport { TLTranslation, getTranslation } from './translations'\n\n/** @public */\nexport interface TranslationProviderProps {\n\tchildren: any\n\t/** (optional) A collection of overrides different locales.\n\t * @example\n\t * ```ts\n\t * <TranslationProvider overrides={{ en: { \"style-panel.styles\": \"Properties\" }}}/>\n\t * ```\n\t */\n\toverrides?: Record<string, Record<string, string>>\n}\n\nconst TranslationsContext = React.createContext<TLTranslation>({} as TLTranslation)\n\nconst useCurrentTranslation = () => React.useContext(TranslationsContext)\n\n/**\n * Provides a translation context to the app.\n *\n * @public\n */\nexport const TranslationProvider = track(function TranslationProvider({\n\toverrides,\n\tchildren,\n}: TranslationProviderProps) {\n\tconst app = useApp()\n\tconst locale = app.userSettings.locale\n\tconst getAssetUrl = useAssetUrls()\n\n\tconst [currentTranslation, setCurrentTranslation] = React.useState<TLTranslation>(() => {\n\t\tif (overrides && overrides['en']) {\n\t\t\treturn {\n\t\t\t\tlocale: 'en',\n\t\t\t\tlabel: 'English',\n\t\t\t\tmessages: { ...DEFAULT_TRANSLATION, ...overrides['en'] },\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\tlocale: 'en',\n\t\t\tlabel: 'English',\n\t\t\tmessages: DEFAULT_TRANSLATION,\n\t\t}\n\t})\n\n\tReact.useEffect(() => {\n\t\tlet isCancelled = false\n\n\t\tasync function loadTranslation() {\n\t\t\tconst localeString = locale ?? navigator.language.split(/[-_]/)[0]\n\t\t\tconst translation = await getTranslation(localeString, getAssetUrl)\n\n\t\t\tif (translation && !isCancelled) {\n\t\t\t\tif (overrides && overrides[localeString]) {\n\t\t\t\t\tsetCurrentTranslation({\n\t\t\t\t\t\t...translation,\n\t\t\t\t\t\tmessages: { ...translation.messages, ...overrides[localeString] },\n\t\t\t\t\t})\n\t\t\t\t} else {\n\t\t\t\t\tsetCurrentTranslation(translation)\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tloadTranslation()\n\n\t\treturn () => {\n\t\t\tisCancelled = true\n\t\t}\n\t}, [getAssetUrl, locale, overrides])\n\n\treturn (\n\t\t<TranslationsContext.Provider value={currentTranslation}>\n\t\t\t{children}\n\t\t</TranslationsContext.Provider>\n\t)\n})\n\n/**\n * Returns a function to translate a translation key into a string based on the current translation.\n *\n * @example\n * ```ts\n * \tconst msg = useTranslation()\n * \tconst label = msg(\"style-panel.styles\")\n * ```\n *\n * @public\n */\nexport function useTranslation() {\n\tconst translation = useCurrentTranslation()\n\treturn React.useCallback(\n\t\tfunction msg(id: TLTranslationKey) {\n\t\t\treturn translation.messages[id] ?? id\n\t\t},\n\t\t[translation]\n\t)\n}\n","import { App, getSvgAsImage, getSvgAsString, TLCopyType, TLShapeId, useApp } from '@tldraw/editor'\nimport { useCallback } from 'react'\nimport { useToasts } from './useToastsProvider'\nimport { useTranslation } from './useTranslation'\n\n/** @public */\nexport function useCopyAs() {\n\tconst app = useApp()\n\tconst { addToast } = useToasts()\n\tconst msg = useTranslation()\n\n\treturn useCallback(\n\t\t// it's important that this function itself isn't async - we need to\n\t\t// create the relevant `ClipboardItem`s synchronously to make sure\n\t\t// safari knows that the user _wants_ to copy:\n\t\t// https://bugs.webkit.org/show_bug.cgi?id=222262\n\t\t//\n\t\t// this is fine for navigator.clipboard.write, but for fallbacks it's a\n\t\t// little awkward.\n\t\tfunction copyAs(ids: TLShapeId[] = app.selectedIds, format: TLCopyType = 'svg') {\n\t\t\tif (ids.length === 0) {\n\t\t\t\tids = [...app.shapeIds]\n\t\t\t}\n\n\t\t\tif (ids.length === 0) {\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tswitch (format) {\n\t\t\t\tcase 'svg': {\n\t\t\t\t\tif (window.navigator.clipboard) {\n\t\t\t\t\t\tif (window.navigator.clipboard.write) {\n\t\t\t\t\t\t\twindow.navigator.clipboard.write([\n\t\t\t\t\t\t\t\tnew ClipboardItem({\n\t\t\t\t\t\t\t\t\t'text/plain': getExportedSvgBlob(app, ids),\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t])\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tfallbackWriteTextAsync(async () =>\n\t\t\t\t\t\t\t\tgetSvgAsString(await getExportSvgElement(app, ids, format))\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbreak\n\t\t\t\t}\n\n\t\t\t\tcase 'jpeg':\n\t\t\t\tcase 'png': {\n\t\t\t\t\tconst mimeType = format === 'jpeg' ? 'image/jpeg' : 'image/png'\n\n\t\t\t\t\twindow.navigator.clipboard.write([\n\t\t\t\t\t\tnew ClipboardItem({\n\t\t\t\t\t\t\t// Note: This needs to use the promise based approach for safari/ios to not bail on a permissions error.\n\t\t\t\t\t\t\t[mimeType]: getExportedImageBlob(app, ids, format).then((blob) => {\n\t\t\t\t\t\t\t\tif (blob) {\n\t\t\t\t\t\t\t\t\tif (window.navigator.clipboard) {\n\t\t\t\t\t\t\t\t\t\treturn blob\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tthrow new Error('Copy not supported')\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\taddToast({\n\t\t\t\t\t\t\t\t\t\tid: 'copy-fail',\n\t\t\t\t\t\t\t\t\t\ticon: 'warning-triangle',\n\t\t\t\t\t\t\t\t\t\ttitle: msg('toast.error.copy-fail.title'),\n\t\t\t\t\t\t\t\t\t\tdescription: msg('toast.error.copy-fail.desc'),\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\tthrow new Error('Copy not possible')\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t}),\n\t\t\t\t\t])\n\n\t\t\t\t\tbreak\n\t\t\t\t}\n\n\t\t\t\tcase 'json': {\n\t\t\t\t\tconst data = app.getContent(ids)\n\n\t\t\t\t\tif (window.navigator.clipboard) {\n\t\t\t\t\t\tconst jsonStr = JSON.stringify(data)\n\n\t\t\t\t\t\tif (window.navigator.clipboard.write) {\n\t\t\t\t\t\t\twindow.navigator.clipboard.write([\n\t\t\t\t\t\t\t\tnew ClipboardItem({\n\t\t\t\t\t\t\t\t\t'text/plain': new Blob([jsonStr], { type: 'text/plain' }),\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t])\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tfallbackWriteTextAsync(async () => jsonStr)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbreak\n\t\t\t\t}\n\n\t\t\t\tdefault:\n\t\t\t\t\tthrow new Error(`Copy type ${format} not supported.`)\n\t\t\t}\n\t\t},\n\t\t[app, addToast, msg]\n\t)\n}\n\nasync function getExportSvgElement(app: App, ids: TLShapeId[], format: TLCopyType) {\n\tconst svg = await app.getSvg(ids, {\n\t\tscale: format === 'svg' ? 1 : 2,\n\t\tbackground: app.instanceState.exportBackground,\n\t})\n\n\tif (!svg) throw new Error('Could not construct SVG.')\n\n\treturn svg\n}\n\nasync function getExportedSvgBlob(app: App, ids: TLShapeId[]) {\n\treturn new Blob([getSvgAsString(await getExportSvgElement(app, ids, 'svg'))], {\n\t\ttype: 'text/plain',\n\t})\n}\n\nasync function getExportedImageBlob(app: App, ids: TLShapeId[], format: 'png' | 'jpeg') {\n\treturn await getSvgAsImage(await getExportSvgElement(app, ids, format), {\n\t\ttype: format,\n\t\tquality: 1,\n\t\tscale: 1,\n\t})\n}\n\nasync function fallbackWriteTextAsync(getText: () => Promise<string>) {\n\tnavigator.clipboard.writeText(await getText())\n}\n","import { App, uniqueId, useApp } from '@tldraw/editor'\nimport { createContext, useCallback, useContext, useState } from 'react'\n\n/** @public */\nexport interface DialogProps {\n\tonClose: () => void\n}\n\n/** @public */\nexport interface TLDialog {\n\tid: string\n\tonClose?: () => void\n\tcomponent: (props: DialogProps) => any\n}\n\n/** @public */\nexport type DialogsContextType = {\n\taddDialog: (dialog: Omit<TLDialog, 'id'> & { id?: string }) => string\n\tremoveDialog: (id: string) => string\n\tupdateDialog: (id: string, newDialogData: Partial<TLDialog>) => string\n\tclearDialogs: () => void\n\tdialogs: TLDialog[]\n}\n\n/** @public */\nexport const DialogsContext = createContext({} as DialogsContextType)\n\n/** @public */\nexport type DialogsProviderProps = {\n\toverrides?: (app: App) => DialogsContextType\n\tchildren: any\n}\n\n/** @public */\nexport function DialogsProvider({ children }: DialogsProviderProps) {\n\tconst app = useApp()\n\n\tconst [dialogs, setDialogs] = useState<TLDialog[]>([])\n\n\tconst addDialog = useCallback(\n\t\t(dialog: Omit<TLDialog, 'id'> & { id?: string }) => {\n\t\t\tconst id = dialog.id ?? uniqueId()\n\t\t\tsetDialogs((d) => {\n\t\t\t\treturn [...d.filter((m) => m.id !== dialog.id), { ...dialog, id }]\n\t\t\t})\n\n\t\t\tapp.openMenus.add(id)\n\n\t\t\treturn id\n\t\t},\n\t\t[app]\n\t)\n\n\tconst updateDialog = useCallback(\n\t\t(id: string, newDialogData: Partial<TLDialog>) => {\n\t\t\tsetDialogs((d) =>\n\t\t\t\td.map((m) => {\n\t\t\t\t\tif (m.id === id) {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t...m,\n\t\t\t\t\t\t\t...newDialogData,\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn m\n\t\t\t\t})\n\t\t\t)\n\n\t\t\tapp.openMenus.add(id)\n\n\t\t\treturn id\n\t\t},\n\t\t[app]\n\t)\n\n\tconst removeDialog = useCallback(\n\t\t(id: string) => {\n\t\t\tsetDialogs((d) =>\n\t\t\t\td.filter((m) => {\n\t\t\t\t\tif (m.id === id) {\n\t\t\t\t\t\tm.onClose?.()\n\t\t\t\t\t\treturn false\n\t\t\t\t\t}\n\t\t\t\t\treturn true\n\t\t\t\t})\n\t\t\t)\n\n\t\t\tapp.openMenus.delete(id)\n\n\t\t\treturn id\n\t\t},\n\t\t[app]\n\t)\n\n\tconst clearDialogs = useCallback(() => {\n\t\tsetDialogs((d) => {\n\t\t\td.forEach((m) => {\n\t\t\t\tm.onClose?.()\n\t\t\t\tapp.openMenus.delete(m.id)\n\t\t\t})\n\t\t\treturn []\n\t\t})\n\t}, [app])\n\n\treturn (\n\t\t<DialogsContext.Provider\n\t\t\tvalue={{ dialogs, addDialog, removeDialog, clearDialogs, updateDialog }}\n\t\t>\n\t\t\t{children}\n\t\t</DialogsContext.Provider>\n\t)\n}\n\n/** @public */\nexport function useDialogs() {\n\tconst ctx = useContext(DialogsContext)\n\n\tif (!ctx) {\n\t\tthrow new Error('useDialogs must be used within a DialogsProvider')\n\t}\n\n\treturn ctx\n}\n","import { ACCEPTED_ASSET_TYPE, createShapesFromFiles, useApp } from '@tldraw/editor'\nimport { useCallback, useEffect, useRef } from 'react'\n\nexport function useInsertMedia() {\n\tconst app = useApp()\n\tconst inputRef = useRef<HTMLInputElement>()\n\n\tuseEffect(() => {\n\t\tconst input = window.document.createElement('input')\n\t\tinput.type = 'file'\n\t\tinput.accept = ACCEPTED_ASSET_TYPE\n\t\tinput.multiple = true\n\t\tinputRef.current = input\n\t\tasync function onchange(e: Event) {\n\t\t\tconst fileList = (e.target as HTMLInputElement).files\n\t\t\tif (!fileList || fileList.length === 0) return\n\t\t\tawait createShapesFromFiles(app, Array.from(fileList), app.viewportPageBounds.center, false)\n\t\t\tinput.value = ''\n\t\t}\n\t\tinput.addEventListener('change', onchange)\n\t\treturn () => {\n\t\t\tinputRef.current = undefined\n\t\t\tinput.removeEventListener('change', onchange)\n\t\t}\n\t}, [app])\n\n\treturn useCallback(() => {\n\t\tinputRef.current?.click()\n\t}, [inputRef])\n}\n","import {\n\tANIMATION_MEDIUM_MS,\n\tApp,\n\tDEFAULT_BOOKMARK_HEIGHT,\n\tDEFAULT_BOOKMARK_WIDTH,\n\tgetEmbedInfo,\n\topenWindow,\n\tTLBookmarkShapeDef,\n\tTLEmbedShapeDef,\n\tTLShapeId,\n\tTLShapePartial,\n\tTLTextShape,\n\tuseApp,\n} from '@tldraw/editor'\nimport { approximately, Box2d, TAU, Vec2d } from '@tldraw/primitives'\nimport { compact } from '@tldraw/utils'\nimport * as React from 'react'\nimport { EditLinkDialog } from '../components/EditLinkDialog'\nimport { TLUiIconType } from '../icon-types'\nimport { useMenuClipboardEvents } from './useClipboardEvents'\nimport { useCopyAs } from './useCopyAs'\nimport { useDialogs } from './useDialogsProvider'\nimport { useExportAs } from './useExportAs'\nimport { useInsertMedia } from './useInsertMedia'\nimport { usePrint } from './usePrint'\nimport { useToasts } from './useToastsProvider'\nimport { TLTranslationKey } from './useTranslation'\n\n/** @public */\nexport interface ActionItem {\n\ticon?: TLUiIconType\n\tid: string\n\tkbd?: string\n\ttitle?: string\n\tlabel?: TLTranslationKey\n\tmenuLabel?: TLTranslationKey\n\tshortcutsLabel?: TLTranslationKey\n\tcontextMenuLabel?: TLTranslationKey\n\treadonlyOk: boolean\n\tcheckbox?: boolean\n\tonSelect: () => Promise<void> | void\n}\n\n/** @public */\nexport type ActionsContextType = Record<string, ActionItem>\n\n/** @public */\nexport const ActionsContext = React.createContext<ActionsContextType>({})\n\n/** @public */\nexport type ActionsProviderProps = {\n\toverrides?: (app: App, actions: ActionsContextType, helpers: undefined) => ActionsContextType\n\tchildren: any\n}\n\nfunction makeActions(actions: ActionItem[]) {\n\treturn Object.fromEntries(actions.map((action) => [action.id, action])) as ActionsContextType\n}\n\n/** @public */\nexport function ActionsProvider({ overrides, children }: ActionsProviderProps) {\n\tconst app = useApp()\n\n\t// const saveFile = useSaveFile()\n\t// const saveFileAs = useSaveFileAs()\n\t// const newFile = useNewFile()\n\t// const openFile = useOpenFile()\n\n\tconst { addDialog, clearDialogs } = useDialogs()\n\tconst { clearToasts } = useToasts()\n\n\tconst insertMedia = useInsertMedia()\n\tconst printSelectionOrPages = usePrint()\n\tconst { cut, copy } = useMenuClipboardEvents()\n\tconst copyAs = useCopyAs()\n\tconst exportAs = useExportAs()\n\n\t// should this be a useMemo? looks like it doesn't actually deref any reactive values\n\tconst actions = React.useMemo<ActionsContextType>(() => {\n\t\tconst actions = makeActions([\n\t\t\t// 'new-project': {\n\t\t\t// \tid: 'file.new',\n\t\t\t// \tlabel: 'file.new',\n\t\t\t// \tonSelect() {\n\t\t\t// \t\tnewFile()\n\t\t\t// \t},\n\t\t\t// },\n\t\t\t// 'open-project': {\n\t\t\t// \tid: 'file.open',\n\t\t\t// \tlabel: 'file.open',\n\t\t\t// \tkbd: '$o',\n\t\t\t// \tonSelect() {\n\t\t\t// \t\topenFile()\n\t\t\t// \t},\n\t\t\t// },\n\t\t\t// 'save-project': {\n\t\t\t// \tid: 'file.save',\n\t\t\t// \tlabel: 'file.save',\n\t\t\t// \tkbd: '$s',\n\t\t\t// \tonSelect() {\n\t\t\t// \t\tsaveFile()\n\t\t\t// \t},\n\t\t\t// },\n\t\t\t// 'save-project-as': {\n\t\t\t// \tid: 'file.save-as',\n\t\t\t// \tlabel: 'file.save-as',\n\t\t\t// \tkbd: '$!s',\n\t\t\t// \tonSelect() {\n\t\t\t// \t\tsaveFileAs()\n\t\t\t// \t},\n\t\t\t// },\n\t\t\t{\n\t\t\t\tid: 'edit-link',\n\t\t\t\tlabel: 'action.edit-link',\n\t\t\t\ticon: 'link',\n\t\t\t\treadonlyOk: false,\n\t\t\t\tonSelect() {\n\t\t\t\t\tapp.mark('edit-link')\n\t\t\t\t\taddDialog({ component: EditLinkDialog })\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'insert-media',\n\t\t\t\tlabel: 'action.insert-media',\n\t\t\t\tkbd: '$u',\n\t\t\t\treadonlyOk: false,\n\t\t\t\tonSelect() {\n\t\t\t\t\tinsertMedia()\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'undo',\n\t\t\t\tlabel: 'action.undo',\n\t\t\t\ticon: 'undo',\n\t\t\t\tkbd: '$z',\n\t\t\t\treadonlyOk: false,\n\t\t\t\tonSelect() {\n\t\t\t\t\tapp.undo()\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'redo',\n\t\t\t\tlabel: 'action.redo',\n\t\t\t\ticon: 'redo',\n\t\t\t\tkbd: '$!z',\n\t\t\t\treadonlyOk: false,\n\t\t\t\tonSelect() {\n\t\t\t\t\tapp.redo()\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'export-as-svg',\n\t\t\t\tlabel: 'action.export-as-svg',\n\t\t\t\tmenuLabel: 'action.export-as-svg.short',\n\t\t\t\tcontextMenuLabel: 'action.export-as-svg.short',\n\t\t\t\treadonlyOk: true,\n\t\t\t\tonSelect() {\n\t\t\t\t\texportAs(app.selectedIds, 'svg')\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'export-as-png',\n\t\t\t\tlabel: 'action.export-as-png',\n\t\t\t\tmenuLabel: 'action.export-as-png.short',\n\t\t\t\tcontextMenuLabel: 'action.export-as-png.short',\n\t\t\t\treadonlyOk: true,\n\t\t\t\tonSelect() {\n\t\t\t\t\texportAs(app.selectedIds, 'png')\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'export-as-json',\n\t\t\t\tlabel: 'action.export-as-json',\n\t\t\t\tmenuLabel: 'action.export-as-json.short',\n\t\t\t\tcontextMenuLabel: 'action.export-as-json.short',\n\t\t\t\treadonlyOk: true,\n\t\t\t\tonSelect() {\n\t\t\t\t\texportAs(app.selectedIds, 'json')\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'copy-as-svg',\n\t\t\t\tlabel: 'action.copy-as-svg',\n\t\t\t\tmenuLabel: 'action.copy-as-svg.short',\n\t\t\t\tcontextMenuLabel: 'action.copy-as-svg.short',\n\t\t\t\tkbd: '$!c',\n\t\t\t\treadonlyOk: true,\n\t\t\t\tonSelect() {\n\t\t\t\t\tcopyAs(app.selectedIds, 'svg')\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'copy-as-png',\n\t\t\t\tlabel: 'action.copy-as-png',\n\t\t\t\tmenuLabel: 'action.copy-as-png.short',\n\t\t\t\tcontextMenuLabel: 'action.copy-as-png.short',\n\t\t\t\treadonlyOk: true,\n\t\t\t\tonSelect() {\n\t\t\t\t\tcopyAs(app.selectedIds, 'png')\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'copy-as-json',\n\t\t\t\tlabel: 'action.copy-as-json',\n\t\t\t\tmenuLabel: 'action.copy-as-json.short',\n\t\t\t\tcontextMenuLabel: 'action.copy-as-json.short',\n\t\t\t\treadonlyOk: true,\n\t\t\t\tonSelect() {\n\t\t\t\t\tcopyAs(app.selectedIds, 'json')\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'toggle-auto-size',\n\t\t\t\tlabel: 'action.toggle-auto-size',\n\t\t\t\treadonlyOk: false,\n\t\t\t\tonSelect() {\n\t\t\t\t\tapp.mark()\n\t\t\t\t\tapp.updateShapes(\n\t\t\t\t\t\tapp.selectedShapes\n\t\t\t\t\t\t\t.filter((shape) => shape && shape.type === 'text' && shape.props.autoSize === false)\n\t\t\t\t\t\t\t.map((shape: TLTextShape) => {\n\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\tid: shape.id,\n\t\t\t\t\t\t\t\t\ttype: shape.type,\n\t\t\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\t\t\t...shape.props,\n\t\t\t\t\t\t\t\t\t\tw: 8,\n\t\t\t\t\t\t\t\t\t\tautoSize: true,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t} as TLTextShape\n\t\t\t\t\t\t\t})\n\t\t\t\t\t)\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'open-embed-link',\n\t\t\t\tlabel: 'action.open-embed-link',\n\t\t\t\treadonlyOk: true,\n\t\t\t\tonSelect() {\n\t\t\t\t\tconst ids = app.selectedIds\n\t\t\t\t\tconst warnMsg = 'No embed shapes selected'\n\t\t\t\t\tif (ids.length !== 1) {\n\t\t\t\t\t\tconsole.error(warnMsg)\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\t\t\t\t\tconst shape = app.getShapeById(ids[0])\n\t\t\t\t\tif (!shape || !TLEmbedShapeDef.is(shape)) {\n\t\t\t\t\t\tconsole.error(warnMsg)\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\n\t\t\t\t\topenWindow(shape.props.url, '_blank')\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'convert-to-bookmark',\n\t\t\t\tlabel: 'action.convert-to-bookmark',\n\t\t\t\treadonlyOk: false,\n\t\t\t\tonSelect() {\n\t\t\t\t\tconst ids = app.selectedIds\n\t\t\t\t\tconst shapes = ids.map((id) => app.getShapeById(id))\n\n\t\t\t\t\tconst createList: TLShapePartial[] = []\n\t\t\t\t\tconst deleteList: TLShapeId[] = []\n\t\t\t\t\tfor (const shape of shapes) {\n\t\t\t\t\t\tif (!shape || !TLEmbedShapeDef.is(shape) || !shape.props.url) continue\n\n\t\t\t\t\t\tconst newPos = new Vec2d(shape.x, shape.y)\n\t\t\t\t\t\tnewPos.rot(-shape.rotation)\n\t\t\t\t\t\tnewPos.add(\n\t\t\t\t\t\t\tnew Vec2d(\n\t\t\t\t\t\t\t\tshape.props.w / 2 - DEFAULT_BOOKMARK_WIDTH / 2,\n\t\t\t\t\t\t\t\tshape.props.h / 2 - DEFAULT_BOOKMARK_HEIGHT / 2\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t)\n\t\t\t\t\t\tnewPos.rot(shape.rotation)\n\n\t\t\t\t\t\tcreateList.push({\n\t\t\t\t\t\t\tid: app.createShapeId(),\n\t\t\t\t\t\t\ttype: 'bookmark',\n\t\t\t\t\t\t\trotation: shape.rotation,\n\t\t\t\t\t\t\tx: newPos.x,\n\t\t\t\t\t\t\ty: newPos.y,\n\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\turl: shape.props.url,\n\t\t\t\t\t\t\t\topacity: '1',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t})\n\t\t\t\t\t\tdeleteList.push(shape.id)\n\t\t\t\t\t}\n\n\t\t\t\t\tapp.mark('convert shapes to bookmark')\n\t\t\t\t\tapp.deleteShapes(deleteList)\n\t\t\t\t\tapp.createShapes(createList)\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'convert-to-embed',\n\t\t\t\tlabel: 'action.convert-to-embed',\n\t\t\t\treadonlyOk: false,\n\t\t\t\tonSelect() {\n\t\t\t\t\tconst ids = app.selectedIds\n\t\t\t\t\tconst shapes = compact(ids.map((id) => app.getShapeById(id)))\n\n\t\t\t\t\tconst createList: TLShapePartial[] = []\n\t\t\t\t\tconst deleteList: TLShapeId[] = []\n\t\t\t\t\tfor (const shape of shapes) {\n\t\t\t\t\t\tif (!TLBookmarkShapeDef.is(shape)) continue\n\n\t\t\t\t\t\tconst { url } = shape.props\n\n\t\t\t\t\t\tconst embedInfo = getEmbedInfo(shape.props.url)\n\n\t\t\t\t\t\tif (!embedInfo) continue\n\t\t\t\t\t\tif (!embedInfo.definition) continue\n\n\t\t\t\t\t\tconst { width, height, doesResize } = embedInfo.definition\n\n\t\t\t\t\t\tconst newPos = new Vec2d(shape.x, shape.y)\n\t\t\t\t\t\tnewPos.rot(-shape.rotation)\n\t\t\t\t\t\tnewPos.add(new Vec2d(shape.props.w / 2 - width / 2, shape.props.h / 2 - height / 2))\n\t\t\t\t\t\tnewPos.rot(shape.rotation)\n\n\t\t\t\t\t\tcreateList.push({\n\t\t\t\t\t\t\tid: app.createShapeId(),\n\t\t\t\t\t\t\ttype: 'embed',\n\t\t\t\t\t\t\tx: newPos.x,\n\t\t\t\t\t\t\ty: newPos.y,\n\t\t\t\t\t\t\trotation: shape.rotation,\n\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\turl: url,\n\t\t\t\t\t\t\t\tw: width,\n\t\t\t\t\t\t\t\th: height,\n\t\t\t\t\t\t\t\tdoesResize,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t})\n\t\t\t\t\t\tdeleteList.push(shape.id)\n\t\t\t\t\t}\n\n\t\t\t\t\tapp.mark('convert shapes to embed')\n\t\t\t\t\tapp.deleteShapes(deleteList)\n\t\t\t\t\tapp.createShapes(createList)\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'duplicate',\n\t\t\t\tkbd: '$d',\n\t\t\t\tlabel: 'action.duplicate',\n\t\t\t\ticon: 'duplicate',\n\t\t\t\treadonlyOk: false,\n\t\t\t\tonSelect() {\n\t\t\t\t\tif (app.currentToolId !== 'select') return\n\t\t\t\t\tconst ids = app.selectedIds\n\t\t\t\t\tconst commonBounds = Box2d.Common(compact(ids.map((id) => app.getPageBoundsById(id))))\n\t\t\t\t\tconst offset = app.canMoveCamera\n\t\t\t\t\t\t? {\n\t\t\t\t\t\t\t\tx: commonBounds.width + 10,\n\t\t\t\t\t\t\t\ty: 0,\n\t\t\t\t\t\t  }\n\t\t\t\t\t\t: {\n\t\t\t\t\t\t\t\tx: 16 / app.camera.z,\n\t\t\t\t\t\t\t\ty: 16 / app.camera.z,\n\t\t\t\t\t\t  }\n\t\t\t\t\tapp.mark('duplicate shapes')\n\t\t\t\t\tapp.duplicateShapes(ids, offset)\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'ungroup',\n\t\t\t\tlabel: 'action.ungroup',\n\t\t\t\tkbd: '$!g',\n\t\t\t\ticon: 'ungroup',\n\t\t\t\treadonlyOk: false,\n\t\t\t\tonSelect() {\n\t\t\t\t\tapp.mark('ungroup')\n\t\t\t\t\tapp.ungroupShapes(app.selectedIds)\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'group',\n\t\t\t\tlabel: 'action.group',\n\t\t\t\tkbd: '$g',\n\t\t\t\ticon: 'group',\n\t\t\t\treadonlyOk: false,\n\t\t\t\tonSelect() {\n\t\t\t\t\tif (app.selectedShapes.length === 1 && app.selectedShapes[0].type === 'group') {\n\t\t\t\t\t\tapp.mark('ungroup')\n\t\t\t\t\t\tapp.ungroupShapes(app.selectedIds)\n\t\t\t\t\t} else {\n\t\t\t\t\t\tapp.mark('group')\n\t\t\t\t\t\tapp.groupShapes(app.selectedIds)\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'align-left',\n\t\t\t\tlabel: 'action.align-left',\n\t\t\t\tkbd: '?A',\n\t\t\t\ticon: 'align-left',\n\t\t\t\treadonlyOk: false,\n\t\t\t\tonSelect() {\n\t\t\t\t\tapp.mark('align left')\n\t\t\t\t\tapp.alignShapes('left', app.selectedIds)\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'align-center-horizontal',\n\t\t\t\tlabel: 'action.align-center-horizontal',\n\t\t\t\tcontextMenuLabel: 'action.align-center-horizontal.short',\n\t\t\t\tkbd: '?H',\n\t\t\t\ticon: 'align-center-horizontal',\n\t\t\t\treadonlyOk: false,\n\t\t\t\tonSelect() {\n\t\t\t\t\tapp.mark('align center horizontal')\n\t\t\t\t\tapp.alignShapes('center-horizontal', app.selectedIds)\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'align-right',\n\t\t\t\tlabel: 'action.align-right',\n\t\t\t\tkbd: '?D',\n\t\t\t\ticon: 'align-right',\n\t\t\t\treadonlyOk: false,\n\t\t\t\tonSelect() {\n\t\t\t\t\tapp.mark('align right')\n\t\t\t\t\tapp.alignShapes('right', app.selectedIds)\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'align-center-vertical',\n\t\t\t\tlabel: 'action.align-center-vertical',\n\t\t\t\tcontextMenuLabel: 'action.align-center-vertical.short',\n\t\t\t\tkbd: '?V',\n\t\t\t\ticon: 'align-center-vertical',\n\t\t\t\treadonlyOk: false,\n\t\t\t\tonSelect() {\n\t\t\t\t\tapp.mark('align center vertical')\n\t\t\t\t\tapp.alignShapes('center-vertical', app.selectedIds)\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'align-top',\n\t\t\t\tlabel: 'action.align-top',\n\t\t\t\ticon: 'align-top',\n\t\t\t\tkbd: '?W',\n\t\t\t\treadonlyOk: false,\n\t\t\t\tonSelect() {\n\t\t\t\t\tapp.mark('align top')\n\t\t\t\t\tapp.alignShapes('top', app.selectedIds)\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'align-bottom',\n\t\t\t\tlabel: 'action.align-bottom',\n\t\t\t\ticon: 'align-bottom',\n\t\t\t\tkbd: '?S',\n\t\t\t\treadonlyOk: false,\n\t\t\t\tonSelect() {\n\t\t\t\t\tapp.mark('align bottom')\n\t\t\t\t\tapp.alignShapes('bottom', app.selectedIds)\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'distribute-horizontal',\n\t\t\t\tlabel: 'action.distribute-horizontal',\n\t\t\t\tcontextMenuLabel: 'action.distribute-horizontal.short',\n\t\t\t\ticon: 'distribute-horizontal',\n\t\t\t\treadonlyOk: false,\n\t\t\t\tonSelect() {\n\t\t\t\t\tapp.mark('distribute horizontal')\n\t\t\t\t\tapp.distributeShapes('horizontal', app.selectedIds)\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'distribute-vertical',\n\t\t\t\tlabel: 'action.distribute-vertical',\n\t\t\t\tcontextMenuLabel: 'action.distribute-vertical.short',\n\t\t\t\ticon: 'distribute-vertical',\n\t\t\t\treadonlyOk: false,\n\t\t\t\tonSelect() {\n\t\t\t\t\tapp.mark('distribute vertical')\n\t\t\t\t\tapp.distributeShapes('vertical', app.selectedIds)\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'stretch-horizontal',\n\t\t\t\tlabel: 'action.stretch-horizontal',\n\t\t\t\tcontextMenuLabel: 'action.stretch-horizontal.short',\n\t\t\t\ticon: 'stretch-horizontal',\n\t\t\t\treadonlyOk: false,\n\t\t\t\tonSelect() {\n\t\t\t\t\tapp.mark('stretch horizontal')\n\t\t\t\t\tapp.stretchShapes('horizontal', app.selectedIds)\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'stretch-vertical',\n\t\t\t\tlabel: 'action.stretch-vertical',\n\t\t\t\tcontextMenuLabel: 'action.stretch-vertical.short',\n\t\t\t\ticon: 'stretch-vertical',\n\t\t\t\treadonlyOk: false,\n\t\t\t\tonSelect() {\n\t\t\t\t\tapp.mark('stretch vertical')\n\t\t\t\t\tapp.stretchShapes('vertical', app.selectedIds)\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'flip-horizontal',\n\t\t\t\tlabel: 'action.flip-horizontal',\n\t\t\t\tcontextMenuLabel: 'action.flip-horizontal.short',\n\t\t\t\tkbd: '!h',\n\t\t\t\treadonlyOk: false,\n\t\t\t\tonSelect() {\n\t\t\t\t\tapp.mark('flip horizontal')\n\t\t\t\t\tapp.flipShapes('horizontal', app.selectedIds)\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'flip-vertical',\n\t\t\t\tlabel: 'action.flip-vertical',\n\t\t\t\tcontextMenuLabel: 'action.flip-vertical.short',\n\t\t\t\tkbd: '!v',\n\t\t\t\treadonlyOk: false,\n\t\t\t\tonSelect() {\n\t\t\t\t\tapp.mark('flip vertical')\n\t\t\t\t\tapp.flipShapes('vertical', app.selectedIds)\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'pack',\n\t\t\t\tlabel: 'action.pack',\n\t\t\t\ticon: 'pack',\n\t\t\t\treadonlyOk: false,\n\t\t\t\tonSelect() {\n\t\t\t\t\tapp.mark('pack')\n\t\t\t\t\tapp.packShapes(app.selectedIds)\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'stack-vertical',\n\t\t\t\tlabel: 'action.stack-vertical',\n\t\t\t\tcontextMenuLabel: 'action.stack-vertical.short',\n\t\t\t\ticon: 'stack-vertical',\n\t\t\t\treadonlyOk: false,\n\t\t\t\tonSelect() {\n\t\t\t\t\tapp.mark('stack-vertical')\n\t\t\t\t\tapp.stackShapes('vertical', app.selectedIds)\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'stack-horizontal',\n\t\t\t\tlabel: 'action.stack-horizontal',\n\t\t\t\tcontextMenuLabel: 'action.stack-horizontal.short',\n\t\t\t\ticon: 'stack-horizontal',\n\t\t\t\treadonlyOk: false,\n\t\t\t\tonSelect() {\n\t\t\t\t\tapp.mark('stack-horizontal')\n\t\t\t\t\tapp.stackShapes('horizontal', app.selectedIds)\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'bring-to-front',\n\t\t\t\tlabel: 'action.bring-to-front',\n\t\t\t\tkbd: ']',\n\t\t\t\ticon: 'bring-to-front',\n\t\t\t\treadonlyOk: false,\n\t\t\t\tonSelect() {\n\t\t\t\t\tapp.mark('bring to front')\n\t\t\t\t\tapp.bringToFront()\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'bring-forward',\n\t\t\t\tlabel: 'action.bring-forward',\n\t\t\t\ticon: 'bring-forward',\n\t\t\t\tkbd: '?]',\n\t\t\t\treadonlyOk: false,\n\t\t\t\tonSelect() {\n\t\t\t\t\tapp.mark('bring forward')\n\t\t\t\t\tapp.bringForward()\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'send-backward',\n\t\t\t\tlabel: 'action.send-backward',\n\t\t\t\ticon: 'send-backward',\n\t\t\t\tkbd: '?[',\n\t\t\t\treadonlyOk: false,\n\t\t\t\tonSelect() {\n\t\t\t\t\tapp.mark('send backward')\n\t\t\t\t\tapp.sendBackward()\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'send-to-back',\n\t\t\t\tlabel: 'action.send-to-back',\n\t\t\t\ticon: 'send-to-back',\n\t\t\t\tkbd: '[',\n\t\t\t\treadonlyOk: false,\n\t\t\t\tonSelect() {\n\t\t\t\t\tapp.mark('send to back')\n\t\t\t\t\tapp.sendToBack()\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'cut',\n\t\t\t\tlabel: 'action.cut',\n\t\t\t\tkbd: '$x',\n\t\t\t\treadonlyOk: false,\n\t\t\t\tonSelect() {\n\t\t\t\t\tapp.mark('cut')\n\t\t\t\t\tcut()\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'copy',\n\t\t\t\tlabel: 'action.copy',\n\t\t\t\tkbd: '$c',\n\t\t\t\treadonlyOk: true,\n\t\t\t\tonSelect() {\n\t\t\t\t\tcopy()\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'paste',\n\t\t\t\tlabel: 'action.paste',\n\t\t\t\tkbd: '$v',\n\t\t\t\treadonlyOk: false,\n\t\t\t\tonSelect() {\n\t\t\t\t\t// must be inlined with a custom menu item\n\t\t\t\t\t// the kbd listed here should have no effect\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'select-all',\n\t\t\t\tlabel: 'action.select-all',\n\t\t\t\tkbd: '$a',\n\t\t\t\treadonlyOk: true,\n\t\t\t\tonSelect() {\n\t\t\t\t\tif (app.currentToolId !== 'select') {\n\t\t\t\t\t\tapp.cancel()\n\t\t\t\t\t\tapp.setSelectedTool('select')\n\t\t\t\t\t}\n\n\t\t\t\t\tapp.mark('select all kbd')\n\t\t\t\t\tapp.selectAll()\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'select-none',\n\t\t\t\tlabel: 'action.select-none',\n\t\t\t\treadonlyOk: true,\n\t\t\t\tonSelect() {\n\t\t\t\t\tapp.mark('select none')\n\t\t\t\t\tapp.selectNone()\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'delete',\n\t\t\t\tlabel: 'action.delete',\n\t\t\t\tkbd: '',\n\t\t\t\ticon: 'trash',\n\t\t\t\treadonlyOk: false,\n\t\t\t\tonSelect() {\n\t\t\t\t\tif (app.currentToolId !== 'select') return\n\t\t\t\t\tapp.mark('delete')\n\t\t\t\t\tapp.deleteShapes()\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'rotate-cw',\n\t\t\t\tlabel: 'action.rotate-cw',\n\t\t\t\ticon: 'rotate-cw',\n\t\t\t\treadonlyOk: false,\n\t\t\t\tonSelect() {\n\t\t\t\t\tif (app.selectedIds.length === 0) return\n\t\t\t\t\tapp.mark('rotate-cw')\n\t\t\t\t\tconst offset = app.selectionRotation % (TAU / 2)\n\t\t\t\t\tconst dontUseOffset = approximately(offset, 0) || approximately(offset, TAU / 2)\n\t\t\t\t\tapp.rotateShapesBy(app.selectedIds, TAU / 2 - (dontUseOffset ? 0 : offset))\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'rotate-ccw',\n\t\t\t\tlabel: 'action.rotate-ccw',\n\t\t\t\ticon: 'rotate-ccw',\n\t\t\t\treadonlyOk: false,\n\t\t\t\tonSelect() {\n\t\t\t\t\tif (app.selectedIds.length === 0) return\n\t\t\t\t\tapp.mark('rotate-ccw')\n\t\t\t\t\tconst offset = app.selectionRotation % (TAU / 2)\n\t\t\t\t\tconst offsetCloseToZero = approximately(offset, 0)\n\t\t\t\t\tapp.rotateShapesBy(app.selectedIds, offsetCloseToZero ? -(TAU / 2) : -offset)\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'zoom-in',\n\t\t\t\tlabel: 'action.zoom-in',\n\t\t\t\tkbd: '$=',\n\t\t\t\treadonlyOk: true,\n\t\t\t\tonSelect() {\n\t\t\t\t\tapp.zoomIn(app.viewportScreenCenter, { duration: ANIMATION_MEDIUM_MS })\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'zoom-out',\n\t\t\t\tlabel: 'action.zoom-out',\n\t\t\t\tkbd: '$-',\n\t\t\t\treadonlyOk: true,\n\t\t\t\tonSelect() {\n\t\t\t\t\tapp.zoomOut(app.viewportScreenCenter, { duration: ANIMATION_MEDIUM_MS })\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'zoom-to-100',\n\t\t\t\tlabel: 'action.zoom-to-100',\n\t\t\t\ticon: 'reset-zoom',\n\t\t\t\tkbd: '!0',\n\t\t\t\treadonlyOk: true,\n\t\t\t\tonSelect() {\n\t\t\t\t\tapp.resetZoom(app.viewportScreenCenter, { duration: ANIMATION_MEDIUM_MS })\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'zoom-to-fit',\n\t\t\t\tlabel: 'action.zoom-to-fit',\n\t\t\t\tkbd: '!1',\n\t\t\t\treadonlyOk: true,\n\t\t\t\tonSelect() {\n\t\t\t\t\tapp.zoomToFit({ duration: ANIMATION_MEDIUM_MS })\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'zoom-to-selection',\n\t\t\t\tlabel: 'action.zoom-to-selection',\n\t\t\t\tkbd: '!2',\n\t\t\t\treadonlyOk: true,\n\t\t\t\tonSelect() {\n\t\t\t\t\tapp.zoomToSelection({ duration: ANIMATION_MEDIUM_MS })\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'toggle-snap-mode',\n\t\t\t\tlabel: 'action.toggle-snap-mode',\n\t\t\t\tmenuLabel: 'action.toggle-snap-mode.menu',\n\t\t\t\treadonlyOk: false,\n\t\t\t\tonSelect() {\n\t\t\t\t\tapp.updateUserDocumentSettings(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tisSnapMode: !app.userDocumentSettings.isSnapMode,\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttrue\n\t\t\t\t\t)\n\t\t\t\t},\n\t\t\t\tcheckbox: true,\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'toggle-dark-mode',\n\t\t\t\tlabel: 'action.toggle-dark-mode',\n\t\t\t\tmenuLabel: 'action.toggle-dark-mode.menu',\n\t\t\t\tkbd: '$/',\n\t\t\t\treadonlyOk: true,\n\t\t\t\tonSelect() {\n\t\t\t\t\tapp.updateUserDocumentSettings(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tisDarkMode: !app.userDocumentSettings.isDarkMode,\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttrue\n\t\t\t\t\t)\n\t\t\t\t},\n\t\t\t\tcheckbox: true,\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'toggle-transparent',\n\t\t\t\tlabel: 'action.toggle-transparent',\n\t\t\t\tmenuLabel: 'action.toggle-transparent.menu',\n\t\t\t\tcontextMenuLabel: 'action.toggle-transparent.context-menu',\n\t\t\t\treadonlyOk: true,\n\t\t\t\tonSelect() {\n\t\t\t\t\tapp.updateInstanceState(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\texportBackground: !app.instanceState.exportBackground,\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttrue\n\t\t\t\t\t)\n\t\t\t\t},\n\t\t\t\tcheckbox: true,\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'toggle-tool-lock',\n\t\t\t\tlabel: 'action.toggle-tool-lock',\n\t\t\t\tmenuLabel: 'action.toggle-tool-lock.menu',\n\t\t\t\treadonlyOk: false,\n\t\t\t\tkbd: 'q',\n\t\t\t\tonSelect() {\n\t\t\t\t\tapp.updateInstanceState(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tisToolLocked: !app.instanceState.isToolLocked,\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttrue\n\t\t\t\t\t)\n\t\t\t\t},\n\t\t\t\tcheckbox: true,\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'toggle-focus-mode',\n\t\t\t\tlabel: 'action.toggle-focus-mode',\n\t\t\t\tmenuLabel: 'action.toggle-focus-mode.menu',\n\t\t\t\treadonlyOk: true,\n\t\t\t\tkbd: '$.',\n\t\t\t\tcheckbox: true,\n\t\t\t\tonSelect() {\n\t\t\t\t\t// this needs to be deferred because it causes the menu\n\t\t\t\t\t// UI to unmount which puts us in a dodgy state\n\t\t\t\t\trequestAnimationFrame(() => {\n\t\t\t\t\t\tapp.batch(() => {\n\t\t\t\t\t\t\tclearDialogs()\n\t\t\t\t\t\t\tclearToasts()\n\t\t\t\t\t\t\tapp.updateInstanceState(\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tisFocusMode: !app.instanceState.isFocusMode,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\ttrue\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t})\n\t\t\t\t\t})\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'toggle-grid',\n\t\t\t\tlabel: 'action.toggle-grid',\n\t\t\t\tmenuLabel: 'action.toggle-grid.menu',\n\t\t\t\treadonlyOk: true,\n\t\t\t\tkbd: \"$'\",\n\t\t\t\tonSelect() {\n\t\t\t\t\tapp.updateUserDocumentSettings(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tisGridMode: !app.userDocumentSettings.isGridMode,\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttrue\n\t\t\t\t\t)\n\t\t\t\t},\n\t\t\t\tcheckbox: true,\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'toggle-debug-mode',\n\t\t\t\tlabel: 'action.toggle-debug-mode',\n\t\t\t\tmenuLabel: 'action.toggle-debug-mode.menu',\n\t\t\t\treadonlyOk: true,\n\t\t\t\tonSelect() {\n\t\t\t\t\tapp.updateInstanceState(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tisDebugMode: !app.instanceState.isDebugMode,\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttrue\n\t\t\t\t\t)\n\t\t\t\t},\n\t\t\t\tcheckbox: true,\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'print',\n\t\t\t\tlabel: 'action.print',\n\t\t\t\tkbd: '$p',\n\t\t\t\treadonlyOk: true,\n\t\t\t\tonSelect() {\n\t\t\t\t\tprintSelectionOrPages()\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'nudge-left',\n\t\t\t\tkbd: 'left,shift+left',\n\t\t\t\tlabel: 'action.nudge-left',\n\t\t\t\treadonlyOk: false,\n\t\t\t\tonSelect() {\n\t\t\t\t\tapp.mark('nudge left')\n\t\t\t\t\tapp.nudgeShapes(app.selectedIds, 'left', app.inputs.shiftKey)\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'nudge-up',\n\t\t\t\tkbd: 'up,shift+up',\n\t\t\t\tlabel: 'action.nudge-up',\n\t\t\t\treadonlyOk: false,\n\t\t\t\tonSelect() {\n\t\t\t\t\tapp.mark('nudge up')\n\t\t\t\t\tapp.nudgeShapes(app.selectedIds, 'up', app.inputs.shiftKey)\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'nudge-right',\n\t\t\t\tkbd: 'right,shift+right',\n\t\t\t\tlabel: 'action.nudge-right',\n\t\t\t\treadonlyOk: false,\n\t\t\t\tonSelect() {\n\t\t\t\t\tapp.mark('nudge right')\n\t\t\t\t\tapp.nudgeShapes(app.selectedIds, 'right', app.inputs.shiftKey)\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'nudge-down',\n\t\t\t\tkbd: 'down,shift+down',\n\t\t\t\tlabel: 'action.nudge-down',\n\t\t\t\treadonlyOk: false,\n\t\t\t\tonSelect() {\n\t\t\t\t\tapp.mark('nudge down')\n\t\t\t\t\tapp.nudgeShapes(app.selectedIds, 'down', app.inputs.shiftKey)\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'exit-pen-mode',\n\t\t\t\tlabel: 'action.exit-pen-mode',\n\t\t\t\ticon: 'cross-2',\n\t\t\t\treadonlyOk: true,\n\t\t\t\tonSelect() {\n\t\t\t\t\tapp.setPenMode(false)\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'back-to-content',\n\t\t\t\tlabel: 'action.back-to-content',\n\t\t\t\ticon: 'arrow-left',\n\t\t\t\treadonlyOk: true,\n\t\t\t\tonSelect() {\n\t\t\t\t\tconst bounds = app.selectedPageBounds ?? app.allShapesCommonBounds\n\n\t\t\t\t\tif (bounds) {\n\t\t\t\t\t\tapp.zoomToBounds(\n\t\t\t\t\t\t\tbounds.minX,\n\t\t\t\t\t\t\tbounds.minY,\n\t\t\t\t\t\t\tbounds.width,\n\t\t\t\t\t\t\tbounds.height,\n\t\t\t\t\t\t\tMath.min(1, app.camera.z),\n\t\t\t\t\t\t\t{ duration: 220 }\n\t\t\t\t\t\t)\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t},\n\t\t])\n\n\t\tif (overrides) {\n\t\t\treturn overrides(app, actions, undefined)\n\t\t}\n\n\t\treturn actions\n\t}, [\n\t\toverrides,\n\t\tapp,\n\t\taddDialog,\n\t\tinsertMedia,\n\t\texportAs,\n\t\tcopyAs,\n\t\tcut,\n\t\tcopy,\n\t\tclearDialogs,\n\t\tclearToasts,\n\t\tprintSelectionOrPages,\n\t])\n\n\treturn <ActionsContext.Provider value={asActions(actions)}>{children}</ActionsContext.Provider>\n}\n\n/** @public */\nexport function useActions() {\n\tconst ctx = React.useContext(ActionsContext)\n\n\tif (!ctx) {\n\t\tthrow new Error('useTools must be used within a ToolProvider')\n\t}\n\n\treturn ctx\n}\n\nfunction asActions<T extends Record<string, ActionItem>>(actions: T) {\n\treturn actions as Record<keyof typeof actions, ActionItem>\n}\n","import { uniqueId, useApp } from '@tldraw/editor'\nimport { useCallback, useRef } from 'react'\n\n/** @public */\nexport function usePrint() {\n\tconst app = useApp()\n\tconst prevPrintEl = useRef<HTMLDivElement | null>(null)\n\tconst prevStyleEl = useRef<HTMLStyleElement | null>(null)\n\n\treturn useCallback(\n\t\tasync function printSelectionOrPages() {\n\t\t\tconst el = document.createElement('div')\n\t\t\tconst style = document.createElement('style')\n\n\t\t\tconst clearElements = (printEl: HTMLDivElement | null, styleEl: HTMLStyleElement | null) => {\n\t\t\t\tif (printEl) printEl.innerHTML = ''\n\t\t\t\tif (styleEl && document.head.contains(styleEl)) document.head.removeChild(styleEl)\n\t\t\t\tif (printEl && document.body.contains(printEl)) {\n\t\t\t\t\tdocument.body.removeChild(printEl)\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Always make sure we have a clean root element.\n\t\t\tclearElements(prevPrintEl.current, prevStyleEl.current)\n\t\t\tprevPrintEl.current = el\n\t\t\tprevStyleEl.current = style\n\n\t\t\t// Random because this isn't for end users\n\t\t\tconst className = `rs-print-surface-${uniqueId()}`\n\n\t\t\tel.className = className\n\t\t\t// NOTE: Works in most envs except safari, needs further review\n\t\t\tconst enableMargins = false\n\t\t\t// NOTE: Currently buggy needs further investigation\n\t\t\tconst allowAllPages = false\n\t\t\tstyle.innerHTML = `\n\t\t\t.${className} {\n\t\t\t\tdisplay: none;\n\t\t\t}\n\n\t\t\t.${className} svg {\n\t\t\t\tmax-width: 100%;\n\t\t\t\theight: 100%;\n\t\t\t\tdisplay: block;\n\t\t\t}\n\n\t\t\t@media print {\t\t\t\t  \n\t\t\t\thtml, body {\n\t\t\t\t\tmin-height: 100%;\n\t\t\t\t\theight: 100%;\n\t\t\t\t\tmargin: 0;\n\t\t\t\t}\n\n\t\t\t\tbody {\n\t\t\t\t\tposition: relative;\n\t\t\t\t}\n\n\t\t\t\tbody > * {\n\t\t\t\t\tdisplay: none;\n\t\t\t\t}\n\n\t\t\t\t.${className} {\n\t\t\t\t\tdisplay: block !important;\n\t\t\t\t\tbackground: white;\n\t\t\t\t\tmin-height: 100%;\n\t\t\t\t\theight: 100%;\n\t\t\t\t\tmax-width: 100%;\n\t\t\t\t}\n\n\t\t\t\t.${className}__item {\n\t\t\t\t\tpadding: 10mm;\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\tmin-height: 100%;\n\t\t\t\t\tflex-direction: column;\n\t\t\t\t\tpage-break-after: always;\n\t\t\t\t\tposition: relative;\n\t\t\t\t\toverflow: hidden;\n\t\t\t\t\theight: 100%;\n\t\t\t\t}\n\n\t\t\t\t.${className}__item__main {\n\t\t\t\t\tflex: 1;\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\talign-items: center;\n\t\t\t\t\tjustify-content: center;\n\t\t\t\t\tmax-height: 100%;\n\t\t\t\t}\n\n\t\t\t\t.${className}__item__header {\n\t\t\t\t\tdisplay: none;\n\t\t\t\t}\n\n\t\t\t\t.${className}__item__footer {\n\t\t\t\t\tdisplay: none;\n\t\t\t\t\ttext-align: right;\n\t\t\t\t}\n\n\t\t\t\t.${className}__item__footer__hide {\n\t\t\t\t\tdisplay: none;\n\t\t\t\t}\n\n\t\t\t\t${\n\t\t\t\t\t!enableMargins\n\t\t\t\t\t\t? ''\n\t\t\t\t\t\t: `\n\t\t\t\t\t/**\n\t\t\t\t\t * Note: Safari doesn't support removing the page margins to remove them all!\n\t\t\t\t\t */\n\t\t\t\t\t@page {\n\t\t\t\t\t\tmargin:0;\n\t\t\t\t\t}\n\n\t\t\t\t\t.${className} .${className}__item__header {\n\t\t\t\t\t\tdisplay: block;\n\t\t\t\t\t}\n\n\t\t\t\t\t.${className} .${className}__item__footer {\n\t\t\t\t\t\tdisplay: block;\n\t\t\t\t\t}\n\t\t\t\t`\n\t\t\t\t}\n\t\t\t}\n\n\t\t`\n\n\t\t\tconst beforePrintHandler = () => {\n\t\t\t\tdocument.head.appendChild(style)\n\t\t\t\tdocument.body.appendChild(el)\n\t\t\t}\n\n\t\t\tconst afterPrintHandler = () => {\n\t\t\t\t// TODO: This is kind of lazy at the moment. I guess we need an event for 'something-happens-on-canvas'\n\t\t\t\tapp.once('change-camera', () => {\n\t\t\t\t\tclearElements(el, style)\n\t\t\t\t})\n\t\t\t}\n\n\t\t\twindow.addEventListener('beforeprint', beforePrintHandler)\n\t\t\twindow.addEventListener('afterprint', afterPrintHandler)\n\n\t\t\tfunction addPageToPrint(title: string, footer: string | null, svg: SVGElement) {\n\t\t\t\ttry {\n\t\t\t\t\tel.innerHTML += `<div class=\"${className}__item\">\n        <div class=\"${className}__item__header\">\n          ${title.replace(/</g, '&lt;').replace(/>/g, '&gt;')}\n        </div>\n        <div class=\"${className}__item__main\">\n          ${svg.outerHTML}\n        </div>\n        <div class=\"${className}__item__footer ${className}__item__footer__${footer ? '' : 'hide'}\">\n          ${footer ?? ''}\n        </div>\n      </div>`\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.error(e)\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction triggerPrint() {\n\t\t\t\tif (app.isSafari) {\n\t\t\t\t\tbeforePrintHandler()\n\t\t\t\t\tdocument.execCommand('print', false)\n\t\t\t\t} else {\n\t\t\t\t\twindow.print()\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst { pages, currentPageId, selectedIds } = app\n\n\t\t\tconst preserveAspectRatio = 'xMidYMid meet'\n\n\t\t\tconst svgOpts = {\n\t\t\t\tscale: 1,\n\t\t\t\tbackground: false,\n\t\t\t\tdarkMode: false,\n\t\t\t\tpreserveAspectRatio,\n\t\t\t}\n\n\t\t\tif (app.selectedIds.length > 0) {\n\t\t\t\t// Print the selected ids from the current page\n\t\t\t\tconst svg = await app.getSvg(selectedIds, svgOpts)\n\n\t\t\t\tif (svg) {\n\t\t\t\t\tconst page = pages.find((p) => p.id === currentPageId)\n\t\t\t\t\taddPageToPrint(`tldraw  ${page?.name}`, null, svg)\n\t\t\t\t\ttriggerPrint()\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (allowAllPages) {\n\t\t\t\t\t// Print all pages\n\t\t\t\t\tfor (let i = 0; i < pages.length; i++) {\n\t\t\t\t\t\tconst page = pages[i]\n\t\t\t\t\t\tconst svg = await app.getSvg(app.getSortedChildIds(page.id), svgOpts)\n\t\t\t\t\t\tif (svg) {\n\t\t\t\t\t\t\taddPageToPrint(`tldraw  ${page.name}`, `${i}/${pages.length}`, svg)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\ttriggerPrint()\n\t\t\t\t} else {\n\t\t\t\t\tconst page = app.currentPage\n\t\t\t\t\tconst svg = await app.getSvg(app.getSortedChildIds(page.id), svgOpts)\n\t\t\t\t\tif (svg) {\n\t\t\t\t\t\taddPageToPrint(`tldraw  ${page.name}`, null, svg)\n\t\t\t\t\t\ttriggerPrint()\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\twindow.removeEventListener('beforeprint', beforePrintHandler)\n\t\t\twindow.removeEventListener('afterprint', afterPrintHandler)\n\t\t},\n\t\t[app]\n\t)\n}\n","import {\n\tdownloadDataURLAsFile,\n\tgetSvgAsDataUrl,\n\tgetSvgAsImage,\n\tTLExportType,\n\tTLShapeId,\n\tuseApp,\n} from '@tldraw/editor'\nimport { useCallback } from 'react'\nimport { useToasts } from './useToastsProvider'\nimport { useTranslation } from './useTranslation'\n\n/** @public */\nexport function useExportAs() {\n\tconst app = useApp()\n\tconst { addToast } = useToasts()\n\tconst msg = useTranslation()\n\n\treturn useCallback(\n\t\tasync function exportAs(ids: TLShapeId[] = app.selectedIds, format: TLExportType = 'png') {\n\t\t\tif (ids.length === 0) {\n\t\t\t\tids = [...app.shapeIds]\n\t\t\t}\n\n\t\t\tif (ids.length === 0) {\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tconst svg = await app.getSvg(ids, {\n\t\t\t\tscale: format === 'svg' ? 1 : 2,\n\t\t\t\tbackground: app.instanceState.exportBackground,\n\t\t\t})\n\n\t\t\tif (!svg) throw new Error('Could not construct SVG.')\n\n\t\t\tconst name = ids.length === 1 ? app.getShapeById(ids[0])?.id.replace(/:/, '_') : 'shapes'\n\n\t\t\tswitch (format) {\n\t\t\t\tcase 'svg': {\n\t\t\t\t\tconst dataURL = await getSvgAsDataUrl(svg)\n\t\t\t\t\tdownloadDataURLAsFile(dataURL, `${name || 'shapes'}.svg`)\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\tcase 'webp':\n\t\t\t\tcase 'png': {\n\t\t\t\t\tconst image = await getSvgAsImage(svg, {\n\t\t\t\t\t\ttype: format,\n\t\t\t\t\t\tquality: 1,\n\t\t\t\t\t\tscale: 1,\n\t\t\t\t\t})\n\n\t\t\t\t\tif (!image) {\n\t\t\t\t\t\taddToast({\n\t\t\t\t\t\t\tid: 'export-fail',\n\t\t\t\t\t\t\t// icon: 'error',\n\t\t\t\t\t\t\ttitle: msg('toast.error.export-fail.title'),\n\t\t\t\t\t\t\tdescription: msg('toast.error.export-fail.desc'),\n\t\t\t\t\t\t})\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\n\t\t\t\t\tconst dataURL = URL.createObjectURL(image)\n\n\t\t\t\t\tdownloadDataURLAsFile(dataURL, `${name || 'shapes'}.${format}`)\n\t\t\t\t\tURL.revokeObjectURL(dataURL)\n\t\t\t\t\treturn\n\t\t\t\t}\n\n\t\t\t\tcase 'json': {\n\t\t\t\t\tconst data = app.getContent(ids)\n\t\t\t\t\tconst dataURL = URL.createObjectURL(\n\t\t\t\t\t\tnew Blob([JSON.stringify(data, null, 4)], { type: 'application/json' })\n\t\t\t\t\t)\n\n\t\t\t\t\tdownloadDataURLAsFile(dataURL, `${name || 'shapes'}.json`)\n\t\t\t\t\tURL.revokeObjectURL(dataURL)\n\t\t\t\t\treturn\n\t\t\t\t}\n\n\t\t\t\tdefault:\n\t\t\t\t\tthrow new Error(`Export type ${format} not supported.`)\n\t\t\t}\n\t\t},\n\t\t[app, addToast, msg]\n\t)\n}\n","import { runtime } from './runtime'\n\n/** @public */\nexport function openWindow(url: string, target = '_blank') {\n\truntime.openWindow(url, target)\n}\n","// Breakpoints for portrait\nexport const PORTRAIT_BREAKPOINTS = [0, 380, 420, 460, 580, 640, 840, 1023]\n","import { useApp } from '@tldraw/editor'\nimport React, { useContext } from 'react'\nimport { useValue } from 'signia-react'\nimport { PORTRAIT_BREAKPOINTS } from '../constants'\n\nconst BreakpointContext = React.createContext(0)\n\n/** @public */\nexport function BreakPointProvider({ children }: { children: any }) {\n\tconst app = useApp()\n\n\tconst breakpoint = useValue(\n\t\t'breakpoint',\n\t\t() => {\n\t\t\tconst { width } = app.viewportScreenBounds\n\t\t\tconst breakpoints = PORTRAIT_BREAKPOINTS\n\n\t\t\tfor (let i = 0; i < breakpoints.length - 1; i++) {\n\t\t\t\tif (width > breakpoints[i] && width <= breakpoints[i + 1]) {\n\t\t\t\t\treturn i\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn breakpoints.length\n\t\t},\n\t\t[app]\n\t)\n\n\treturn <BreakpointContext.Provider value={breakpoint}>{children}</BreakpointContext.Provider>\n}\n\n/** @public */\nexport function useBreakpoint() {\n\tlet breakpoint = useContext(BreakpointContext)\n\tconst layoutQuery = new URL(window.location.href).searchParams.get('layout')\n\n\tif (layoutQuery === 'desktop') {\n\t\tbreakpoint = 7\n\t} else if (layoutQuery === 'mobile') {\n\t\tbreakpoint = 1\n\t}\n\n\treturn breakpoint\n}\n","import { useApp } from '@tldraw/editor'\nimport { useValue } from 'signia-react'\n\nexport function useHasLinkShapeSelected() {\n\tconst app = useApp()\n\treturn useValue(\n\t\t'hasLinkShapeSelected',\n\t\t() => {\n\t\t\tconst { selectedShapes } = app\n\t\t\treturn (\n\t\t\t\tselectedShapes.length === 1 &&\n\t\t\t\t'url' in selectedShapes[0].props &&\n\t\t\t\tselectedShapes[0].type !== 'embed'\n\t\t\t)\n\t\t},\n\t\t[app]\n\t)\n}\n","import { App, useApp } from '@tldraw/editor'\nimport React, { useMemo } from 'react'\nimport { track } from 'signia-react'\nimport {\n\tMenuSchema,\n\tmenuItem,\n\tuseAllowGroup,\n\tuseAllowUngroup,\n\tuseThreeStackableItems,\n} from './menuHelpers'\nimport { useActions } from './useActions'\nimport { useBreakpoint } from './useBreakpoint'\nimport { useHasLinkShapeSelected } from './useHasLinkShapeSelected'\n\n/** @public */\nexport type ActionsMenuSchemaContextType = MenuSchema\n\n/** @public */\nexport const ActionsMenuSchemaContext = React.createContext({} as ActionsMenuSchemaContextType)\n\n/** @public */\nexport type ActionsMenuSchemaProviderProps = {\n\toverrides?: (\n\t\tapp: App,\n\t\tschema: ActionsMenuSchemaContextType,\n\t\thelpers: {\n\t\t\tactions: ReturnType<typeof useActions>\n\t\t\toneSelected: boolean\n\t\t\ttwoSelected: boolean\n\t\t\tthreeSelected: boolean\n\t\t}\n\t) => ActionsMenuSchemaContextType\n\tchildren: any\n}\n\n/** @public */\nexport const ActionsMenuSchemaProvider = track(function ActionsMenuSchemaProvider({\n\toverrides,\n\tchildren,\n}: ActionsMenuSchemaProviderProps) {\n\tconst app = useApp()\n\tconst actions = useActions()\n\n\tconst selectedCount = app.selectedIds.length\n\n\tconst oneSelected = selectedCount > 0\n\tconst twoSelected = selectedCount > 1\n\tconst threeSelected = selectedCount > 2\n\tconst threeStackableItems = useThreeStackableItems()\n\tconst allowGroup = useAllowGroup()\n\tconst allowUngroup = useAllowUngroup()\n\tconst showEditLink = useHasLinkShapeSelected()\n\tconst breakpoint = useBreakpoint()\n\tconst isZoomedTo100 = app.camera.z === 1\n\n\tconst actionMenuSchema = useMemo<MenuSchema>(() => {\n\t\tconst results = [\n\t\t\tmenuItem(actions['align-left'], { disabled: !twoSelected }),\n\t\t\tmenuItem(actions['align-center-horizontal'], { disabled: !twoSelected }),\n\t\t\tmenuItem(actions['align-right'], { disabled: !twoSelected }),\n\t\t\tmenuItem(actions['stretch-horizontal'], { disabled: !twoSelected }),\n\t\t\tmenuItem(actions['align-top'], { disabled: !twoSelected }),\n\t\t\tmenuItem(actions['align-center-vertical'], { disabled: !twoSelected }),\n\t\t\tmenuItem(actions['align-bottom'], { disabled: !twoSelected }),\n\t\t\tmenuItem(actions['stretch-vertical'], { disabled: !twoSelected }),\n\t\t\tmenuItem(actions['distribute-horizontal'], { disabled: !threeSelected }),\n\t\t\tmenuItem(actions['distribute-vertical'], { disabled: !threeSelected }),\n\t\t\tmenuItem(actions['stack-horizontal'], { disabled: !threeStackableItems }),\n\t\t\tmenuItem(actions['stack-vertical'], { disabled: !threeStackableItems }),\n\t\t\tmenuItem(actions['send-to-back'], { disabled: !oneSelected }),\n\t\t\tmenuItem(actions['send-backward'], { disabled: !oneSelected }),\n\t\t\tmenuItem(actions['bring-forward'], { disabled: !oneSelected }),\n\t\t\tmenuItem(actions['bring-to-front'], { disabled: !oneSelected }),\n\t\t\tbreakpoint < 5\n\t\t\t\t? menuItem(actions['zoom-to-100'], { disabled: !!isZoomedTo100 })\n\t\t\t\t: menuItem(actions['rotate-ccw'], { disabled: !oneSelected }),\n\t\t\tmenuItem(actions['rotate-cw'], { disabled: !oneSelected }),\n\t\t\tmenuItem(actions['edit-link'], { disabled: !showEditLink }),\n\t\t\tallowGroup\n\t\t\t\t? menuItem(actions['group'], { disabled: !twoSelected })\n\t\t\t\t: allowUngroup\n\t\t\t\t? menuItem(actions['ungroup'])\n\t\t\t\t: menuItem(actions['group'], { disabled: !twoSelected }),\n\t\t]\n\n\t\tif (overrides) {\n\t\t\treturn overrides(app, results, { actions, oneSelected, twoSelected, threeSelected })\n\t\t}\n\n\t\treturn results\n\t}, [\n\t\tapp,\n\t\tisZoomedTo100,\n\t\tallowGroup,\n\t\toverrides,\n\t\tactions,\n\t\toneSelected,\n\t\ttwoSelected,\n\t\tthreeSelected,\n\t\tthreeStackableItems,\n\t\tallowUngroup,\n\t\tshowEditLink,\n\t\tbreakpoint,\n\t])\n\n\treturn (\n\t\t<ActionsMenuSchemaContext.Provider value={actionMenuSchema}>\n\t\t\t{children}\n\t\t</ActionsMenuSchemaContext.Provider>\n\t)\n})\n\n/** @public */\nexport function useActionsMenuSchema(): MenuSchema {\n\tconst ctx = React.useContext(ActionsMenuSchemaContext)\n\n\tif (!ctx) {\n\t\tthrow new Error('useActionsMenuSchema must be used inside of a ActionsMenuSchemaProvider.')\n\t}\n\n\treturn ctx\n}\n","import { useApp } from '@tldraw/editor'\nimport { useValue } from 'signia-react'\n\n/** @public */\nexport function useCanRedo() {\n\tconst app = useApp()\n\treturn useValue('useCanRedo', () => app.canRedo, [app])\n}\n","import { useApp } from '@tldraw/editor'\nimport { useValue } from 'signia-react'\n\n/** @public */\nexport function useCanUndo() {\n\tconst app = useApp()\n\treturn useValue('useCanUndo', () => app.canUndo, [app])\n}\n","import { useApp } from '@tldraw/editor'\nimport { useValue } from 'signia-react'\n\nexport function useShowAutoSizeToggle() {\n\tconst app = useApp()\n\treturn useValue(\n\t\t'showAutoSizeToggle',\n\t\t() => {\n\t\t\tconst { selectedShapes } = app\n\t\t\treturn (\n\t\t\t\tselectedShapes.length === 1 &&\n\t\t\t\tselectedShapes[0].type === 'text' &&\n\t\t\t\tselectedShapes[0].props.autoSize === false\n\t\t\t)\n\t\t},\n\t\t[app]\n\t)\n}\n","import { App, getEmbedInfo, TLBookmarkShapeDef, TLEmbedShapeDef, useApp } from '@tldraw/editor'\nimport React, { useMemo } from 'react'\nimport { track, useValue } from 'signia-react'\nimport {\n\tcompactMenuItems,\n\tmenuCustom,\n\tmenuGroup,\n\tmenuItem,\n\tMenuSchema,\n\tmenuSubmenu,\n\tuseAllowGroup,\n\tuseAllowUngroup,\n\tuseThreeStackableItems,\n} from './menuHelpers'\nimport { useActions } from './useActions'\nimport { useHasLinkShapeSelected } from './useHasLinkShapeSelected'\nimport { useOnlyFlippableShape } from './useOnlyFlippableShape'\nimport { useShowAutoSizeToggle } from './useShowAutoSizeToggle'\n\n/** @public */\nexport type ContextMenuSchemaContextType = MenuSchema\n\n/** @public */\nexport const ContextMenuSchemaContext = React.createContext({} as ContextMenuSchemaContextType)\n\n/** @public */\nexport type ContextMenuSchemaProviderProps = {\n\toverrides?: (\n\t\tapp: App,\n\t\tschema: ContextMenuSchemaContextType,\n\t\thelpers: {\n\t\t\tactions: ReturnType<typeof useActions>\n\t\t\toneSelected: boolean\n\t\t\ttwoSelected: boolean\n\t\t\tthreeSelected: boolean\n\t\t\tshowAutoSizeToggle: boolean\n\t\t\tshowUngroup: boolean\n\t\t\tonlyFlippableShapeSelected: boolean\n\t\t}\n\t) => ContextMenuSchemaContextType\n\tchildren: any\n}\n\nconst showUiPaste =\n\ttypeof window !== 'undefined' &&\n\t'navigator' in window &&\n\tBoolean(navigator.clipboard) &&\n\tBoolean(navigator.clipboard.read)\n\n/** @public */\nexport const ContextMenuSchemaProvider = track(function ContextMenuSchemaProvider({\n\toverrides,\n\tchildren,\n}: ContextMenuSchemaProviderProps) {\n\tconst app = useApp()\n\tconst actions = useActions()\n\n\tconst showAutoSizeToggle = useShowAutoSizeToggle()\n\n\tconst onlyFlippableShapeSelected = useOnlyFlippableShape()\n\n\tconst selectedCount = app.selectedIds.length\n\n\tconst oneSelected = selectedCount > 0\n\tconst oneEmbedSelected = useValue(\n\t\t'oneEmbedSelected',\n\t\t() => {\n\t\t\tif (app.selectedIds.length !== 1) return false\n\t\t\treturn app.selectedIds.some((selectedId) => {\n\t\t\t\tconst shape = app.getShapeById(selectedId)\n\t\t\t\treturn shape && TLEmbedShapeDef.is(shape) && shape.props.url\n\t\t\t})\n\t\t},\n\t\t[]\n\t)\n\tconst oneEmbeddableBookmarkSelected = useValue(\n\t\t'oneEmbeddableBookmarkSelected',\n\t\t() => {\n\t\t\tif (app.selectedIds.length !== 1) return false\n\t\t\treturn app.selectedIds.some((selectedId) => {\n\t\t\t\tconst shape = app.getShapeById(selectedId)\n\t\t\t\treturn shape && TLBookmarkShapeDef.is(shape) && getEmbedInfo(shape.props.url)\n\t\t\t})\n\t\t},\n\t\t[]\n\t)\n\n\tconst twoSelected = selectedCount > 1\n\tconst threeSelected = selectedCount > 2\n\tconst threeStackableItems = useThreeStackableItems()\n\tconst atLeastOneShapeOnPage = useValue('atLeastOneShapeOnPage', () => app.shapeIds.size > 0, [])\n\tconst isTransparentBg = useValue('isTransparentBg', () => app.instanceState.exportBackground, [])\n\tconst allowGroup = useAllowGroup()\n\tconst allowUngroup = useAllowUngroup()\n\tconst hasClipboardWrite = Boolean(window.navigator.clipboard?.write)\n\tconst showEditLink = useHasLinkShapeSelected()\n\n\tconst contextMenuSchema = useMemo<MenuSchema>(() => {\n\t\tlet contextMenuSchema: ContextMenuSchemaContextType = compactMenuItems([\n\t\t\tmenuGroup(\n\t\t\t\t'selection',\n\t\t\t\toneEmbedSelected && menuItem(actions['open-embed-link']),\n\t\t\t\toneEmbedSelected && menuItem(actions['convert-to-bookmark']),\n\t\t\t\toneEmbeddableBookmarkSelected && menuItem(actions['convert-to-embed']),\n\t\t\t\tshowAutoSizeToggle && menuItem(actions['toggle-auto-size']),\n\t\t\t\tshowEditLink && menuItem(actions['edit-link']),\n\t\t\t\toneSelected && menuItem(actions['duplicate']),\n\t\t\t\tallowGroup && menuItem(actions['group']),\n\t\t\t\tallowUngroup && menuItem(actions['ungroup'])\n\t\t\t),\n\t\t\tmenuGroup(\n\t\t\t\t'modify',\n\t\t\t\t(twoSelected || onlyFlippableShapeSelected) &&\n\t\t\t\t\tmenuSubmenu(\n\t\t\t\t\t\t'arrange',\n\t\t\t\t\t\t'context-menu.arrange',\n\t\t\t\t\t\ttwoSelected &&\n\t\t\t\t\t\t\tmenuGroup(\n\t\t\t\t\t\t\t\t'align',\n\t\t\t\t\t\t\t\tmenuItem(actions['align-left']),\n\t\t\t\t\t\t\t\tmenuItem(actions['align-center-horizontal']),\n\t\t\t\t\t\t\t\tmenuItem(actions['align-right']),\n\t\t\t\t\t\t\t\tmenuItem(actions['align-top']),\n\t\t\t\t\t\t\t\tmenuItem(actions['align-center-vertical']),\n\t\t\t\t\t\t\t\tmenuItem(actions['align-bottom'])\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\tthreeSelected &&\n\t\t\t\t\t\t\tmenuGroup(\n\t\t\t\t\t\t\t\t'distribute',\n\t\t\t\t\t\t\t\tmenuItem(actions['distribute-horizontal']),\n\t\t\t\t\t\t\t\tmenuItem(actions['distribute-vertical'])\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\ttwoSelected &&\n\t\t\t\t\t\t\tmenuGroup(\n\t\t\t\t\t\t\t\t'stretch',\n\t\t\t\t\t\t\t\tmenuItem(actions['stretch-horizontal']),\n\t\t\t\t\t\t\t\tmenuItem(actions['stretch-vertical'])\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\tonlyFlippableShapeSelected &&\n\t\t\t\t\t\t\tmenuGroup(\n\t\t\t\t\t\t\t\t'flip',\n\t\t\t\t\t\t\t\tmenuItem(actions['flip-horizontal']),\n\t\t\t\t\t\t\t\tmenuItem(actions['flip-vertical'])\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\ttwoSelected &&\n\t\t\t\t\t\t\tmenuGroup(\n\t\t\t\t\t\t\t\t'order',\n\t\t\t\t\t\t\t\tmenuItem(actions['pack'], { disabled: !twoSelected }),\n\t\t\t\t\t\t\t\tthreeStackableItems && menuItem(actions['stack-vertical']),\n\t\t\t\t\t\t\t\tthreeStackableItems && menuItem(actions['stack-horizontal'])\n\t\t\t\t\t\t\t)\n\t\t\t\t\t),\n\t\t\t\toneSelected &&\n\t\t\t\t\tmenuSubmenu(\n\t\t\t\t\t\t'reorder',\n\t\t\t\t\t\t'context-menu.reorder',\n\t\t\t\t\t\tmenuGroup(\n\t\t\t\t\t\t\t'reorder',\n\t\t\t\t\t\t\tmenuItem(actions['bring-to-front']),\n\t\t\t\t\t\t\tmenuItem(actions['bring-forward']),\n\t\t\t\t\t\t\tmenuItem(actions['send-backward']),\n\t\t\t\t\t\t\tmenuItem(actions['send-to-back'])\n\t\t\t\t\t\t)\n\t\t\t\t\t),\n\t\t\t\toneSelected && menuCustom('MOVE_TO_PAGE_MENU', { readonlyOk: false })\n\t\t\t),\n\t\t\tmenuGroup(\n\t\t\t\t'clipboard-group',\n\t\t\t\toneSelected && menuItem(actions['cut']),\n\t\t\t\toneSelected && menuItem(actions['copy']),\n\t\t\t\tshowUiPaste && menuCustom('MENU_PASTE', { readonlyOk: false })\n\t\t\t),\n\t\t\tatLeastOneShapeOnPage &&\n\t\t\t\tmenuGroup(\n\t\t\t\t\t'conversions',\n\t\t\t\t\tmenuSubmenu(\n\t\t\t\t\t\t'copy-as',\n\t\t\t\t\t\t'context-menu.copy-as',\n\t\t\t\t\t\tmenuGroup(\n\t\t\t\t\t\t\t'copy-as-group',\n\t\t\t\t\t\t\tmenuItem(actions['copy-as-svg']),\n\t\t\t\t\t\t\thasClipboardWrite && menuItem(actions['copy-as-png']),\n\t\t\t\t\t\t\tmenuItem(actions['copy-as-json'])\n\t\t\t\t\t\t),\n\t\t\t\t\t\tmenuGroup(\n\t\t\t\t\t\t\t'export-bg',\n\t\t\t\t\t\t\tmenuItem(actions['toggle-transparent'], { checked: !isTransparentBg })\n\t\t\t\t\t\t)\n\t\t\t\t\t),\n\t\t\t\t\tmenuSubmenu(\n\t\t\t\t\t\t'export-as',\n\t\t\t\t\t\t'context-menu.export-as',\n\t\t\t\t\t\tmenuGroup(\n\t\t\t\t\t\t\t'export-as-group',\n\t\t\t\t\t\t\tmenuItem(actions['export-as-svg']),\n\t\t\t\t\t\t\tmenuItem(actions['export-as-png']),\n\t\t\t\t\t\t\tmenuItem(actions['export-as-json'])\n\t\t\t\t\t\t),\n\t\t\t\t\t\tmenuGroup(\n\t\t\t\t\t\t\t'export-bg,',\n\t\t\t\t\t\t\tmenuItem(actions['toggle-transparent'], { checked: !isTransparentBg })\n\t\t\t\t\t\t)\n\t\t\t\t\t)\n\t\t\t\t),\n\t\t\tatLeastOneShapeOnPage &&\n\t\t\t\tmenuGroup(\n\t\t\t\t\t'set-selection-group',\n\t\t\t\t\tmenuItem(actions['select-all']),\n\t\t\t\t\toneSelected && menuItem(actions['select-none'])\n\t\t\t\t),\n\t\t\toneSelected && menuGroup('delete-group', menuItem(actions['delete'])),\n\t\t])\n\n\t\tif (overrides) {\n\t\t\tcontextMenuSchema = overrides(app, contextMenuSchema, {\n\t\t\t\tactions,\n\t\t\t\toneSelected,\n\t\t\t\ttwoSelected,\n\t\t\t\tthreeSelected,\n\t\t\t\tshowAutoSizeToggle,\n\t\t\t\tshowUngroup: allowUngroup,\n\t\t\t\tonlyFlippableShapeSelected,\n\t\t\t})\n\t\t}\n\n\t\treturn contextMenuSchema\n\t}, [\n\t\tapp,\n\t\toverrides,\n\t\tactions,\n\t\toneSelected,\n\t\ttwoSelected,\n\t\tthreeSelected,\n\t\tshowAutoSizeToggle,\n\t\tonlyFlippableShapeSelected,\n\t\tatLeastOneShapeOnPage,\n\t\tthreeStackableItems,\n\t\tallowGroup,\n\t\tallowUngroup,\n\t\thasClipboardWrite,\n\t\tshowEditLink,\n\t\toneEmbedSelected,\n\t\toneEmbeddableBookmarkSelected,\n\t\tisTransparentBg,\n\t])\n\n\treturn (\n\t\t<ContextMenuSchemaContext.Provider value={contextMenuSchema}>\n\t\t\t{children}\n\t\t</ContextMenuSchemaContext.Provider>\n\t)\n})\n\n/** @public */\nexport function useContextMenuSchema(): MenuSchema {\n\tconst ctx = React.useContext(ContextMenuSchemaContext)\n\n\tif (!ctx) {\n\t\tthrow new Error('useContextMenuSchema must be used inside of a ContextMenuSchemaProvider.')\n\t}\n\n\treturn ctx\n}\n","import { isShapeWithHandles, useApp } from '@tldraw/editor'\nimport { useValue } from 'signia-react'\n\nexport function useOnlyFlippableShape() {\n\tconst app = useApp()\n\treturn useValue(\n\t\t'onlyFlippableShape',\n\t\t() => {\n\t\t\tconst { selectedShapes } = app\n\t\t\treturn (\n\t\t\t\tselectedShapes.length === 1 &&\n\t\t\t\tselectedShapes.every((shape) => shape.type === 'group' || isShapeWithHandles(shape))\n\t\t\t)\n\t\t},\n\t\t[app]\n\t)\n}\n","import {\n\tMenuChild,\n\tTLTranslationKey,\n\tuseKeyboardShortcutsSchema,\n\tuseReadonly,\n\tuseTranslation,\n} from '../../hooks'\nimport { Kbd } from '../primitives'\nimport * as Dialog from '../primitives/Dialog'\n\nexport const KeyboardShortcutsDialog = () => {\n\tconst msg = useTranslation()\n\tconst isReadonly = useReadonly()\n\tconst shortcutsItems = useKeyboardShortcutsSchema()\n\n\tfunction getKeyboardShortcutItem(item: MenuChild) {\n\t\tif (isReadonly && !item.readonlyOk) return null\n\n\t\tswitch (item.type) {\n\t\t\tcase 'group': {\n\t\t\t\treturn (\n\t\t\t\t\t<div className=\"tlui-shortcuts-dialog__group\" key={item.id}>\n\t\t\t\t\t\t<h2 className=\"tlui-shortcuts-dialog__group__title\">\n\t\t\t\t\t\t\t{msg(item.id as TLTranslationKey)}\n\t\t\t\t\t\t</h2>\n\t\t\t\t\t\t<div className=\"tlui-shortcuts-dialog__group__content\">\n\t\t\t\t\t\t\t{item.children\n\t\t\t\t\t\t\t\t.filter((item) => item.type === 'item' && item.actionItem.kbd)\n\t\t\t\t\t\t\t\t.map(getKeyboardShortcutItem)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t)\n\t\t\t}\n\t\t\tcase 'item': {\n\t\t\t\tconst { id, label, shortcutsLabel, kbd } = item.actionItem\n\n\t\t\t\treturn (\n\t\t\t\t\t<div className=\"tlui-shortcuts-dialog__key-pair\" key={id}>\n\t\t\t\t\t\t<div className=\"tlui-shortcuts-dialog__key-pair__key\">\n\t\t\t\t\t\t\t{msg((shortcutsLabel ?? label)!)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"tlui-shortcuts-dialog__key-pair__value\">\n\t\t\t\t\t\t\t<Kbd>{kbd!}</Kbd>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t)\n\t\t\t}\n\t\t}\n\t}\n\n\treturn (\n\t\t<>\n\t\t\t<Dialog.Header className=\"tlui-shortcuts-dialog__header\">\n\t\t\t\t<Dialog.Title>{msg('shortcuts-dialog.title')}</Dialog.Title>\n\t\t\t\t<Dialog.CloseButton />\n\t\t\t</Dialog.Header>\n\t\t\t<Dialog.Body className=\"tlui-shortcuts-dialog__body\">\n\t\t\t\t{shortcutsItems.map(getKeyboardShortcutItem)}\n\t\t\t</Dialog.Body>\n\t\t\t<div className=\"tlui-dialog__scrim\" />\n\t\t</>\n\t)\n}\n","import { App, useApp } from '@tldraw/editor'\nimport { compact } from '@tldraw/utils'\nimport React, { useMemo } from 'react'\nimport { track } from 'signia-react'\nimport { MenuSchema, menuGroup, menuItem } from './menuHelpers'\nimport { ActionsContextType, useActions } from './useActions'\nimport { ToolsContextType, useTools } from './useTools'\n\n/** @public */\nexport type KeyboardShortcutsSchemaContextType = MenuSchema\n\n/** @public */\nexport const KeyboardShortcutsSchemaContext = React.createContext(\n\t{} as KeyboardShortcutsSchemaContextType\n)\n\n/** @public */\nexport type KeyboardShortcutsSchemaProviderProps = {\n\toverrides?: (\n\t\tapp: App,\n\t\tschema: KeyboardShortcutsSchemaContextType,\n\t\tmore: { tools: ToolsContextType; actions: ActionsContextType }\n\t) => KeyboardShortcutsSchemaContextType\n\tchildren: any\n}\n\n/** @public */\nexport const KeyboardShortcutsSchemaProvider = track(function KeyboardShortcutsSchemaProvider({\n\toverrides,\n\tchildren,\n}: KeyboardShortcutsSchemaProviderProps) {\n\tconst app = useApp()\n\tconst tools = useTools()\n\tconst actions = useActions()\n\n\tconst keyboardShortcutsSchema = useMemo<MenuSchema>(() => {\n\t\tconst keyboardShortcutsSchema = compact([\n\t\t\tmenuGroup(\n\t\t\t\t'shortcuts-dialog.tools',\n\t\t\t\tmenuItem(actions['toggle-tool-lock']),\n\t\t\t\tmenuItem(tools['select']),\n\t\t\t\tmenuItem(tools['draw']),\n\t\t\t\tmenuItem(tools['eraser']),\n\t\t\t\tmenuItem(tools['hand']),\n\t\t\t\tmenuItem(tools['rectangle']),\n\t\t\t\tmenuItem(tools['ellipse']),\n\t\t\t\tmenuItem(tools['arrow']),\n\t\t\t\tmenuItem(tools['line']),\n\t\t\t\tmenuItem(tools['text']),\n\t\t\t\tmenuItem(tools['frame']),\n\t\t\t\tmenuItem(tools['note'])\n\t\t\t),\n\t\t\tmenuGroup(\n\t\t\t\t'shortcuts-dialog.file',\n\t\t\t\tmenuItem(actions['insert-media']),\n\t\t\t\tmenuItem(actions['print'])\n\t\t\t),\n\t\t\tmenuGroup(\n\t\t\t\t'shortcuts-dialog.preferences',\n\t\t\t\tmenuItem(actions['toggle-dark-mode']),\n\t\t\t\tmenuItem(actions['toggle-focus-mode']),\n\t\t\t\tmenuItem(actions['toggle-grid'])\n\t\t\t),\n\t\t\tmenuGroup(\n\t\t\t\t'shortcuts-dialog.edit',\n\t\t\t\tmenuItem(actions['undo']),\n\t\t\t\tmenuItem(actions['redo']),\n\t\t\t\tmenuItem(actions['cut']),\n\t\t\t\tmenuItem(actions['copy']),\n\t\t\t\tmenuItem(actions['paste']),\n\t\t\t\tmenuItem(actions['select-all']),\n\t\t\t\tmenuItem(actions['delete']),\n\t\t\t\tmenuItem(actions['duplicate']),\n\t\t\t\tmenuItem(actions['export-as-svg']),\n\t\t\t\tmenuItem(actions['export-as-png'])\n\t\t\t),\n\n\t\t\tmenuGroup(\n\t\t\t\t'shortcuts-dialog.view',\n\t\t\t\tmenuItem(actions['zoom-in']),\n\t\t\t\tmenuItem(actions['zoom-out']),\n\t\t\t\tmenuItem(actions['zoom-to-100']),\n\t\t\t\tmenuItem(actions['zoom-to-fit']),\n\t\t\t\tmenuItem(actions['zoom-to-selection'])\n\t\t\t),\n\t\t\tmenuGroup(\n\t\t\t\t'shortcuts-dialog.transform',\n\t\t\t\tmenuItem(actions['bring-to-front']),\n\t\t\t\tmenuItem(actions['bring-forward']),\n\t\t\t\tmenuItem(actions['send-backward']),\n\t\t\t\tmenuItem(actions['send-to-back']),\n\t\t\t\tmenuItem(actions['group']),\n\t\t\t\tmenuItem(actions['ungroup']),\n\t\t\t\tmenuItem(actions['flip-horizontal']),\n\t\t\t\tmenuItem(actions['flip-vertical']),\n\t\t\t\tmenuItem(actions['align-top']),\n\t\t\t\tmenuItem(actions['align-center-vertical']),\n\t\t\t\tmenuItem(actions['align-bottom']),\n\t\t\t\tmenuItem(actions['align-left']),\n\t\t\t\tmenuItem(actions['align-center-horizontal']),\n\t\t\t\tmenuItem(actions['align-right'])\n\t\t\t),\n\t\t])\n\n\t\tif (overrides) {\n\t\t\treturn overrides(app, keyboardShortcutsSchema, { tools, actions })\n\t\t}\n\n\t\treturn keyboardShortcutsSchema\n\t}, [app, overrides, actions, tools])\n\n\treturn (\n\t\t<KeyboardShortcutsSchemaContext.Provider value={keyboardShortcutsSchema}>\n\t\t\t{children}\n\t\t</KeyboardShortcutsSchemaContext.Provider>\n\t)\n})\n\n/** @public */\nexport function useKeyboardShortcutsSchema(): KeyboardShortcutsSchemaContextType {\n\tconst ctx = React.useContext(KeyboardShortcutsSchemaContext)\n\n\tif (!ctx) {\n\t\tthrow new Error('Shortcuts must be used inside of a ShortcutsProvider.')\n\t}\n\n\treturn ctx\n}\n","import { App, useApp } from '@tldraw/editor'\nimport { compact } from '@tldraw/utils'\nimport React, { useMemo } from 'react'\nimport { track } from 'signia-react'\nimport { KeyboardShortcutsDialog } from '../components/KeyboardShortcutsDialog'\nimport { MenuSchema, menuCustom, menuGroup, menuItem } from './menuHelpers'\nimport { useActions } from './useActions'\nimport { useDialogs } from './useDialogsProvider'\nimport { TLListedTranslations, useLanguages } from './useTranslation'\n\n/** @public */\nexport type HelpMenuSchemaProviderType = MenuSchema\n\n/** @internal */\nexport const HelpMenuSchemaContext = React.createContext({} as HelpMenuSchemaProviderType)\n\n/** @public */\nexport type HelpMenuSchemaProviderProps = {\n\toverrides?: (\n\t\tapp: App,\n\t\tschema: HelpMenuSchemaProviderType,\n\t\thelpers: {\n\t\t\tactions: ReturnType<typeof useActions>\n\t\t\tlanguages: TLListedTranslations\n\t\t\tcurrentLanguage: string\n\t\t\toneSelected: boolean\n\t\t\ttwoSelected: boolean\n\t\t\tthreeSelected: boolean\n\t\t}\n\t) => HelpMenuSchemaProviderType\n\tchildren: any\n}\n\n/** @public */\nexport const HelpMenuSchemaProvider = track(function HelpMenuSchemaProvider({\n\toverrides,\n\tchildren,\n}: HelpMenuSchemaProviderProps) {\n\tconst app = useApp()\n\tconst actions = useActions()\n\n\tconst selectedCount = app.selectedIds.length\n\n\tconst oneSelected = selectedCount > 0\n\tconst twoSelected = selectedCount > 1\n\tconst threeSelected = selectedCount > 2\n\n\tconst { languages, currentLanguage } = useLanguages()\n\tconst { addDialog } = useDialogs()\n\n\tconst helpMenuSchema = useMemo<MenuSchema>(() => {\n\t\tconst helpMenuSchema = compact([\n\t\t\tmenuGroup(\n\t\t\t\t'top',\n\t\t\t\tmenuCustom('LANGUAGE_MENU', { readonlyOk: true }),\n\t\t\t\tmenuItem({\n\t\t\t\t\tid: 'keyboard-shortcuts',\n\t\t\t\t\tlabel: 'help-menu.keyboard-shortcuts',\n\t\t\t\t\treadonlyOk: true,\n\t\t\t\t\tonSelect() {\n\t\t\t\t\t\taddDialog({ component: KeyboardShortcutsDialog })\n\t\t\t\t\t},\n\t\t\t\t})\n\t\t\t),\n\t\t])\n\n\t\tif (overrides) {\n\t\t\treturn overrides(app, helpMenuSchema, {\n\t\t\t\tactions,\n\t\t\t\tcurrentLanguage,\n\t\t\t\tlanguages,\n\t\t\t\toneSelected,\n\t\t\t\ttwoSelected,\n\t\t\t\tthreeSelected,\n\t\t\t})\n\t\t}\n\n\t\treturn helpMenuSchema\n\t}, [\n\t\tapp,\n\t\toverrides,\n\t\tlanguages,\n\t\tactions,\n\t\toneSelected,\n\t\ttwoSelected,\n\t\tthreeSelected,\n\t\tcurrentLanguage,\n\t\taddDialog,\n\t])\n\n\treturn (\n\t\t<HelpMenuSchemaContext.Provider value={helpMenuSchema}>\n\t\t\t{children}\n\t\t</HelpMenuSchemaContext.Provider>\n\t)\n})\n\n/** @public */\nexport function useHelpMenuSchema(): MenuSchema {\n\tconst ctx = React.useContext(HelpMenuSchemaContext)\n\n\tif (!ctx) {\n\t\tthrow new Error('useHelpMenuSchema must be used inside of a helpMenuSchemaProvider.')\n\t}\n\n\treturn ctx\n}\n","/**! \n * hotkeys-js v3.10.2 \n * A simple micro-library for defining and dispatching keyboard shortcuts. It has no dependencies. \n * \n * Copyright (c) 2023 kenny wong <wowohoo@qq.com> \n * http://jaywcjlove.github.io/hotkeys \n * Licensed under the MIT license \n */\n\nvar isff = typeof navigator !== 'undefined' ? navigator.userAgent.toLowerCase().indexOf('firefox') > 0 : false; // \n\nfunction addEvent(object, event, method, useCapture) {\n  if (object.addEventListener) {\n    object.addEventListener(event, method, useCapture);\n  } else if (object.attachEvent) {\n    object.attachEvent(\"on\".concat(event), function () {\n      method(window.event);\n    });\n  }\n} // \n\n\nfunction getMods(modifier, key) {\n  var mods = key.slice(0, key.length - 1);\n\n  for (var i = 0; i < mods.length; i++) {\n    mods[i] = modifier[mods[i].toLowerCase()];\n  }\n\n  return mods;\n} // key\n\n\nfunction getKeys(key) {\n  if (typeof key !== 'string') key = '';\n  key = key.replace(/\\s/g, ''); // ,\n\n  var keys = key.split(','); // ','\n\n  var index = keys.lastIndexOf(''); // ','\n\n  for (; index >= 0;) {\n    keys[index - 1] += ',';\n    keys.splice(index, 1);\n    index = keys.lastIndexOf('');\n  }\n\n  return keys;\n} // \n\n\nfunction compareArray(a1, a2) {\n  var arr1 = a1.length >= a2.length ? a1 : a2;\n  var arr2 = a1.length >= a2.length ? a2 : a1;\n  var isIndex = true;\n\n  for (var i = 0; i < arr1.length; i++) {\n    if (arr2.indexOf(arr1[i]) === -1) isIndex = false;\n  }\n\n  return isIndex;\n}\n\nvar _keyMap = {\n  backspace: 8,\n  '': 8,\n  tab: 9,\n  clear: 12,\n  enter: 13,\n  '': 13,\n  return: 13,\n  esc: 27,\n  escape: 27,\n  space: 32,\n  left: 37,\n  up: 38,\n  right: 39,\n  down: 40,\n  del: 46,\n  delete: 46,\n  ins: 45,\n  insert: 45,\n  home: 36,\n  end: 35,\n  pageup: 33,\n  pagedown: 34,\n  capslock: 20,\n  num_0: 96,\n  num_1: 97,\n  num_2: 98,\n  num_3: 99,\n  num_4: 100,\n  num_5: 101,\n  num_6: 102,\n  num_7: 103,\n  num_8: 104,\n  num_9: 105,\n  num_multiply: 106,\n  num_add: 107,\n  num_enter: 108,\n  num_subtract: 109,\n  num_decimal: 110,\n  num_divide: 111,\n  '': 20,\n  ',': 188,\n  '.': 190,\n  '/': 191,\n  '`': 192,\n  '-': isff ? 173 : 189,\n  '=': isff ? 61 : 187,\n  ';': isff ? 59 : 186,\n  '\\'': 222,\n  '[': 219,\n  ']': 221,\n  '\\\\': 220\n}; // Modifier Keys\n\nvar _modifier = {\n  // shiftKey\n  '': 16,\n  shift: 16,\n  // altKey\n  '': 18,\n  alt: 18,\n  option: 18,\n  // ctrlKey\n  '': 17,\n  ctrl: 17,\n  control: 17,\n  // metaKey\n  '': 91,\n  cmd: 91,\n  command: 91\n};\nvar modifierMap = {\n  16: 'shiftKey',\n  18: 'altKey',\n  17: 'ctrlKey',\n  91: 'metaKey',\n  shiftKey: 16,\n  ctrlKey: 17,\n  altKey: 18,\n  metaKey: 91\n};\nvar _mods = {\n  16: false,\n  18: false,\n  17: false,\n  91: false\n};\nvar _handlers = {}; // F1~F12 special key\n\nfor (var k = 1; k < 20; k++) {\n  _keyMap[\"f\".concat(k)] = 111 + k;\n}\n\nvar _downKeys = []; // \n\nvar winListendFocus = false; // windowfocus\n\nvar _scope = 'all'; // \n\nvar elementHasBindEvent = []; // \n// \n\nvar code = function code(x) {\n  return _keyMap[x.toLowerCase()] || _modifier[x.toLowerCase()] || x.toUpperCase().charCodeAt(0);\n};\n\nvar getKey = function getKey(x) {\n  return Object.keys(_keyMap).find(function (k) {\n    return _keyMap[k] === x;\n  });\n};\n\nvar getModifier = function getModifier(x) {\n  return Object.keys(_modifier).find(function (k) {\n    return _modifier[k] === x;\n  });\n}; // ''\n\n\nfunction setScope(scope) {\n  _scope = scope || 'all';\n} // \n\n\nfunction getScope() {\n  return _scope || 'all';\n} // \n\n\nfunction getPressedKeyCodes() {\n  return _downKeys.slice(0);\n}\n\nfunction getPressedKeyString() {\n  return _downKeys.map(function (c) {\n    return getKey(c) || getModifier(c) || String.fromCharCode(c);\n  });\n} //   Boolean\n// hotkey is effective only when filter return true\n\n\nfunction filter(event) {\n  var target = event.target || event.srcElement;\n  var tagName = target.tagName;\n  var flag = true; // ignore: isContentEditable === 'true', <input> and <textarea> when readOnly state is false, <select>\n\n  if (target.isContentEditable || (tagName === 'INPUT' || tagName === 'TEXTAREA' || tagName === 'SELECT') && !target.readOnly) {\n    flag = false;\n  }\n\n  return flag;\n} // truefalse\n\n\nfunction isPressed(keyCode) {\n  if (typeof keyCode === 'string') {\n    keyCode = code(keyCode); // \n  }\n\n  return _downKeys.indexOf(keyCode) !== -1;\n} // handlers scope()\n\n\nfunction deleteScope(scope, newScope) {\n  var handlers;\n  var i; // scopescope\n\n  if (!scope) scope = getScope();\n\n  for (var key in _handlers) {\n    if (Object.prototype.hasOwnProperty.call(_handlers, key)) {\n      handlers = _handlers[key];\n\n      for (i = 0; i < handlers.length;) {\n        if (handlers[i].scope === scope) handlers.splice(i, 1);else i++;\n      }\n    }\n  } // scopescopeall\n\n\n  if (getScope() === scope) setScope(newScope || 'all');\n} // \n\n\nfunction clearModifier(event) {\n  var key = event.keyCode || event.which || event.charCode;\n\n  var i = _downKeys.indexOf(key); // \n\n\n  if (i >= 0) {\n    _downKeys.splice(i, 1);\n  } //  cmmand  cmmand  keyup \n\n\n  if (event.key && event.key.toLowerCase() === 'meta') {\n    _downKeys.splice(0, _downKeys.length);\n  } //  shiftKey altKey ctrlKey (command||metaKey) \n\n\n  if (key === 93 || key === 224) key = 91;\n\n  if (key in _mods) {\n    _mods[key] = false; // false\n\n    for (var k in _modifier) {\n      if (_modifier[k] === key) hotkeys[k] = false;\n    }\n  }\n}\n\nfunction unbind(keysInfo) {\n  // unbind(), unbind all keys\n  if (typeof keysInfo === 'undefined') {\n    Object.keys(_handlers).forEach(function (key) {\n      return delete _handlers[key];\n    });\n  } else if (Array.isArray(keysInfo)) {\n    // support like : unbind([{key: 'ctrl+a', scope: 's1'}, {key: 'ctrl-a', scope: 's2', splitKey: '-'}])\n    keysInfo.forEach(function (info) {\n      if (info.key) eachUnbind(info);\n    });\n  } else if (typeof keysInfo === 'object') {\n    // support like unbind({key: 'ctrl+a, ctrl+b', scope:'abc'})\n    if (keysInfo.key) eachUnbind(keysInfo);\n  } else if (typeof keysInfo === 'string') {\n    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      args[_key - 1] = arguments[_key];\n    }\n\n    // support old method\n    // eslint-disable-line\n    var scope = args[0],\n        method = args[1];\n\n    if (typeof scope === 'function') {\n      method = scope;\n      scope = '';\n    }\n\n    eachUnbind({\n      key: keysInfo,\n      scope: scope,\n      method: method,\n      splitKey: '+'\n    });\n  }\n} // \n\n\nvar eachUnbind = function eachUnbind(_ref) {\n  var key = _ref.key,\n      scope = _ref.scope,\n      method = _ref.method,\n      _ref$splitKey = _ref.splitKey,\n      splitKey = _ref$splitKey === void 0 ? '+' : _ref$splitKey;\n  var multipleKeys = getKeys(key);\n  multipleKeys.forEach(function (originKey) {\n    var unbindKeys = originKey.split(splitKey);\n    var len = unbindKeys.length;\n    var lastKey = unbindKeys[len - 1];\n    var keyCode = lastKey === '*' ? '*' : code(lastKey);\n    if (!_handlers[keyCode]) return; // \n\n    if (!scope) scope = getScope();\n    var mods = len > 1 ? getMods(_modifier, unbindKeys) : [];\n    _handlers[keyCode] = _handlers[keyCode].filter(function (record) {\n      // \n      var isMatchingMethod = method ? record.method === method : true;\n      return !(isMatchingMethod && record.scope === scope && compareArray(record.mods, mods));\n    });\n  });\n}; // \n\n\nfunction eventHandler(event, handler, scope, element) {\n  if (handler.element !== element) {\n    return;\n  }\n\n  var modifiersMatch; // \n\n  if (handler.scope === scope || handler.scope === 'all') {\n    // true\n    modifiersMatch = handler.mods.length > 0;\n\n    for (var y in _mods) {\n      if (Object.prototype.hasOwnProperty.call(_mods, y)) {\n        if (!_mods[y] && handler.mods.indexOf(+y) > -1 || _mods[y] && handler.mods.indexOf(+y) === -1) {\n          modifiersMatch = false;\n        }\n      }\n    } // \n\n\n    if (handler.mods.length === 0 && !_mods[16] && !_mods[18] && !_mods[17] && !_mods[91] || modifiersMatch || handler.shortcut === '*') {\n      if (handler.method(event, handler) === false) {\n        if (event.preventDefault) event.preventDefault();else event.returnValue = false;\n        if (event.stopPropagation) event.stopPropagation();\n        if (event.cancelBubble) event.cancelBubble = true;\n      }\n    }\n  }\n} // keydown\n\n\nfunction dispatch(event, element) {\n  var asterisk = _handlers['*'];\n  var key = event.keyCode || event.which || event.charCode; //  \n\n  if (!hotkeys.filter.call(this, event)) return; // Gecko(Firefox)command224Webkit(Chrome)\n  // Webkit command \n\n  if (key === 93 || key === 224) key = 91;\n  /**\n   * Collect bound keys\n   * If an Input Method Editor is processing key input and the event is keydown, return 229.\n   * https://stackoverflow.com/questions/25043934/is-it-ok-to-ignore-keydown-events-with-keycode-229\n   * http://lists.w3.org/Archives/Public/www-dom/2010JulSep/att-0182/keyCode-spec.html\n   */\n\n  if (_downKeys.indexOf(key) === -1 && key !== 229) _downKeys.push(key);\n  /**\n   * Jest test cases are required.\n   * ===============================\n   */\n\n  ['ctrlKey', 'altKey', 'shiftKey', 'metaKey'].forEach(function (keyName) {\n    var keyNum = modifierMap[keyName];\n\n    if (event[keyName] && _downKeys.indexOf(keyNum) === -1) {\n      _downKeys.push(keyNum);\n    } else if (!event[keyName] && _downKeys.indexOf(keyNum) > -1) {\n      _downKeys.splice(_downKeys.indexOf(keyNum), 1);\n    } else if (keyName === 'metaKey' && event[keyName] && _downKeys.length === 3) {\n      /**\n       * Fix if Command is pressed:\n       * ===============================\n       */\n      if (!(event.ctrlKey || event.shiftKey || event.altKey)) {\n        _downKeys = _downKeys.slice(_downKeys.indexOf(keyNum));\n      }\n    }\n  });\n  /**\n   * -------------------------------\n   */\n\n  if (key in _mods) {\n    _mods[key] = true; // key hotkeys \n\n    for (var k in _modifier) {\n      if (_modifier[k] === key) hotkeys[k] = true;\n    }\n\n    if (!asterisk) return;\n  } //  modifierMap  event \n\n\n  for (var e in _mods) {\n    if (Object.prototype.hasOwnProperty.call(_mods, e)) {\n      _mods[e] = event[modifierMap[e]];\n    }\n  }\n  /**\n   * https://github.com/jaywcjlove/hotkeys/pull/129\n   * This solves the issue in Firefox on Windows where hotkeys corresponding to special characters would not trigger.\n   * An example of this is ctrl+alt+m on a Swedish keyboard which is used to type .\n   * Browser support: https://caniuse.com/#feat=keyboardevent-getmodifierstate\n   */\n\n\n  if (event.getModifierState && !(event.altKey && !event.ctrlKey) && event.getModifierState('AltGraph')) {\n    if (_downKeys.indexOf(17) === -1) {\n      _downKeys.push(17);\n    }\n\n    if (_downKeys.indexOf(18) === -1) {\n      _downKeys.push(18);\n    }\n\n    _mods[17] = true;\n    _mods[18] = true;\n  } //   `all`\n\n\n  var scope = getScope(); // \n\n  if (asterisk) {\n    for (var i = 0; i < asterisk.length; i++) {\n      if (asterisk[i].scope === scope && (event.type === 'keydown' && asterisk[i].keydown || event.type === 'keyup' && asterisk[i].keyup)) {\n        eventHandler(event, asterisk[i], scope, element);\n      }\n    }\n  } // key  _handlers \n\n\n  if (!(key in _handlers)) return;\n\n  for (var _i = 0; _i < _handlers[key].length; _i++) {\n    if (event.type === 'keydown' && _handlers[key][_i].keydown || event.type === 'keyup' && _handlers[key][_i].keyup) {\n      if (_handlers[key][_i].key) {\n        var record = _handlers[key][_i];\n        var splitKey = record.splitKey;\n        var keyShortcut = record.key.split(splitKey);\n        var _downKeysCurrent = []; // \n\n        for (var a = 0; a < keyShortcut.length; a++) {\n          _downKeysCurrent.push(code(keyShortcut[a]));\n        }\n\n        if (_downKeysCurrent.sort().join('') === _downKeys.sort().join('')) {\n          // \n          eventHandler(event, record, scope, element);\n        }\n      }\n    }\n  }\n} //  element \n\n\nfunction isElementBind(element) {\n  return elementHasBindEvent.indexOf(element) > -1;\n}\n\nfunction hotkeys(key, option, method) {\n  _downKeys = [];\n  var keys = getKeys(key); // \n\n  var mods = [];\n  var scope = 'all'; // scopeall\n\n  var element = document; // \n\n  var i = 0;\n  var keyup = false;\n  var keydown = true;\n  var splitKey = '+';\n  var capture = false; // \n\n  if (method === undefined && typeof option === 'function') {\n    method = option;\n  }\n\n  if (Object.prototype.toString.call(option) === '[object Object]') {\n    if (option.scope) scope = option.scope; // eslint-disable-line\n\n    if (option.element) element = option.element; // eslint-disable-line\n\n    if (option.keyup) keyup = option.keyup; // eslint-disable-line\n\n    if (option.keydown !== undefined) keydown = option.keydown; // eslint-disable-line\n\n    if (option.capture !== undefined) capture = option.capture; // eslint-disable-line\n\n    if (typeof option.splitKey === 'string') splitKey = option.splitKey; // eslint-disable-line\n  }\n\n  if (typeof option === 'string') scope = option; // \n\n  for (; i < keys.length; i++) {\n    key = keys[i].split(splitKey); // \n\n    mods = []; // \n\n    if (key.length > 1) mods = getMods(_modifier, key); // \n\n    key = key[key.length - 1];\n    key = key === '*' ? '*' : code(key); // *\n    // key_handlers\n\n    if (!(key in _handlers)) _handlers[key] = [];\n\n    _handlers[key].push({\n      keyup: keyup,\n      keydown: keydown,\n      scope: scope,\n      mods: mods,\n      shortcut: keys[i],\n      method: method,\n      key: keys[i],\n      splitKey: splitKey,\n      element: element\n    });\n  } // document\n\n\n  if (typeof element !== 'undefined' && !isElementBind(element) && window) {\n    elementHasBindEvent.push(element);\n    addEvent(element, 'keydown', function (e) {\n      dispatch(e, element);\n    }, capture);\n\n    if (!winListendFocus) {\n      winListendFocus = true;\n      addEvent(window, 'focus', function () {\n        _downKeys = [];\n      }, capture);\n    }\n\n    addEvent(element, 'keyup', function (e) {\n      dispatch(e, element);\n      clearModifier(e);\n    }, capture);\n  }\n}\n\nfunction trigger(shortcut) {\n  var scope = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'all';\n  Object.keys(_handlers).forEach(function (key) {\n    var dataList = _handlers[key].filter(function (item) {\n      return item.scope === scope && item.shortcut === shortcut;\n    });\n\n    dataList.forEach(function (data) {\n      if (data && data.method) {\n        data.method();\n      }\n    });\n  });\n}\n\nvar _api = {\n  getPressedKeyString: getPressedKeyString,\n  setScope: setScope,\n  getScope: getScope,\n  deleteScope: deleteScope,\n  getPressedKeyCodes: getPressedKeyCodes,\n  isPressed: isPressed,\n  filter: filter,\n  trigger: trigger,\n  unbind: unbind,\n  keyMap: _keyMap,\n  modifier: _modifier,\n  modifierMap: modifierMap\n};\n\nfor (var a in _api) {\n  if (Object.prototype.hasOwnProperty.call(_api, a)) {\n    hotkeys[a] = _api[a];\n  }\n}\n\nif (typeof window !== 'undefined') {\n  var _hotkeys = window.hotkeys;\n\n  hotkeys.noConflict = function (deep) {\n    if (deep && window.hotkeys === hotkeys) {\n      window.hotkeys = _hotkeys;\n    }\n\n    return hotkeys;\n  };\n\n  window.hotkeys = hotkeys;\n}\n\nexport { hotkeys as default };\n","import { useApp } from '@tldraw/editor'\nimport { useValue } from 'signia-react'\n\n/** @public */\nexport function useReadonly() {\n\tconst app = useApp()\n\treturn useValue('isReadOnlyMode', () => app.isReadOnly, [app])\n}\n","import { createEmbedShapeAtPoint, EmbedResult, getEmbedInfo, useApp } from '@tldraw/editor'\nimport { EMBED_DEFINITIONS, EmbedDefinition } from '@tldraw/tlschema'\nimport { useRef, useState } from 'react'\nimport { track } from 'signia-react'\nimport { DialogProps, useAssetUrls, useTranslation } from '../../hooks'\nimport { Button, Icon, Input } from '../primitives'\nimport * as Dialog from '../primitives/Dialog'\n\nexport const EmbedDialog = track(function EmbedDialog({ onClose }: DialogProps) {\n\tconst app = useApp()\n\tconst msg = useTranslation()\n\tconst assetUrls = useAssetUrls()\n\n\t// The embed definition for the user's selected embed (set by the user clicking on an embed in stage 1)\n\tconst [embedDefinition, setEmbedDefinition] = useState<null | EmbedDefinition>(null)\n\n\t// The URL that the user has typed into (in stage 2)\n\tconst [url, setUrl] = useState<string>('')\n\n\t// The embed info for the user's selected embed (based on the URL they've entered in stage 2)\n\tconst [embedInfoForUrl, setEmbedInfoForUrl] = useState<null | EmbedResult>(null)\n\n\t// Should we show the \"invalid URL\" error message?\n\tconst [showError, setShowError] = useState(false)\n\tconst rShowErrorTimeout = useRef<any>(-1)\n\n\treturn (\n\t\t<>\n\t\t\t<Dialog.Header>\n\t\t\t\t<Dialog.Title>\n\t\t\t\t\t{embedDefinition\n\t\t\t\t\t\t? `${msg('embed-dialog.title')}  ${embedDefinition.title}`\n\t\t\t\t\t\t: msg('embed-dialog.title')}\n\t\t\t\t</Dialog.Title>\n\t\t\t\t<Dialog.CloseButton />\n\t\t\t</Dialog.Header>\n\t\t\t{embedDefinition ? (\n\t\t\t\t<>\n\t\t\t\t\t<Dialog.Body className=\"tlui-embed-dialog__enter\">\n\t\t\t\t\t\t<div className=\"tlui-embed-dialog\">\n\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\tclassName=\"tlui-embed-dialog__input\"\n\t\t\t\t\t\t\t\tlabel=\"embed-dialog.url\"\n\t\t\t\t\t\t\t\tplaceholder=\"http://example.com\"\n\t\t\t\t\t\t\t\tautofocus\n\t\t\t\t\t\t\t\tonValueChange={(value) => {\n\t\t\t\t\t\t\t\t\t// Set the url that the user has typed into the input\n\t\t\t\t\t\t\t\t\tsetUrl(value)\n\n\t\t\t\t\t\t\t\t\t// Set the embed info to either the embed info for the URL (if\n\t\t\t\t\t\t\t\t\t// that embed info can be found and of a type that matches the\n\t\t\t\t\t\t\t\t\t// user's selected definition type)\n\t\t\t\t\t\t\t\t\tconst embedInfo = getEmbedInfo(value)\n\t\t\t\t\t\t\t\t\tsetEmbedInfoForUrl(\n\t\t\t\t\t\t\t\t\t\tembedInfo && embedInfo.definition.type === embedDefinition.type\n\t\t\t\t\t\t\t\t\t\t\t? embedInfo\n\t\t\t\t\t\t\t\t\t\t\t: null\n\t\t\t\t\t\t\t\t\t)\n\n\t\t\t\t\t\t\t\t\t// We want to hide the error when the user enters text,\n\t\t\t\t\t\t\t\t\t// and then show an error after a short delay if the user\n\t\t\t\t\t\t\t\t\t// has not yet entered a valid URL.\n\t\t\t\t\t\t\t\t\tsetShowError(false)\n\t\t\t\t\t\t\t\t\tclearTimeout(rShowErrorTimeout.current)\n\t\t\t\t\t\t\t\t\trShowErrorTimeout.current = setTimeout(() => setShowError(!embedInfo), 320)\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t{url === '' ? (\n\t\t\t\t\t\t\t\t<div className=\"tlui-embed-dialog__instruction\">\n\t\t\t\t\t\t\t\t\t<span>{msg('embed-dialog.instruction')}</span>{' '}\n\t\t\t\t\t\t\t\t\t{embedDefinition.instructionLink && (\n\t\t\t\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t\t\t\t\t\t\t\trel=\"noopener noreferrer\"\n\t\t\t\t\t\t\t\t\t\t\thref={embedDefinition.instructionLink}\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"tlui-embed-dialog__instruction__link\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\tLearn more.\n\t\t\t\t\t\t\t\t\t\t\t<Icon icon=\"external-link\" small />\n\t\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t<div className=\"tlui-embed-dialog__warning\">\n\t\t\t\t\t\t\t\t\t{showError ? msg('embed-dialog.invalid-url') : '\\xa0'}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</Dialog.Body>\n\t\t\t\t\t<Dialog.Footer className=\"tlui-dialog__footer__actions\">\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\tsetEmbedDefinition(null)\n\t\t\t\t\t\t\t\tsetEmbedInfoForUrl(null)\n\t\t\t\t\t\t\t\tsetUrl('')\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tlabel=\"embed-dialog.back\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<div className=\"tlui-spacer\" />\n\t\t\t\t\t\t<Button label=\"embed-dialog.cancel\" onClick={onClose} />\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\ttype=\"primary\"\n\t\t\t\t\t\t\tdisabled={!embedInfoForUrl}\n\t\t\t\t\t\t\tlabel=\"embed-dialog.create\"\n\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\tif (!embedInfoForUrl) return\n\n\t\t\t\t\t\t\t\tcreateEmbedShapeAtPoint(app, url, app.viewportPageCenter, {\n\t\t\t\t\t\t\t\t\twidth: embedInfoForUrl.definition.width,\n\t\t\t\t\t\t\t\t\theight: embedInfoForUrl.definition.height,\n\t\t\t\t\t\t\t\t\tdoesResize: embedInfoForUrl.definition.doesResize,\n\t\t\t\t\t\t\t\t})\n\n\t\t\t\t\t\t\t\tonClose()\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Dialog.Footer>\n\t\t\t\t</>\n\t\t\t) : (\n\t\t\t\t<>\n\t\t\t\t\t<Dialog.Body className=\"tlui-embed-dialog__list\">\n\t\t\t\t\t\t{EMBED_DEFINITIONS.map((def) => {\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\tkey={def.type}\n\t\t\t\t\t\t\t\t\tclassName=\"tlui-embed-dialog__item\"\n\t\t\t\t\t\t\t\t\tonClick={() => setEmbedDefinition(def)}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<div className=\"tlui-embed-dialog__item__image\">\n\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"tlui-embed-dialog__item__image__img\"\n\t\t\t\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\t\t\t\tbackgroundImage: `url(${assetUrls.embedIcons[def.type]})`,\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div className=\"tlui-embed-dialog__item__title\">{def.title}</div>\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t})}\n\t\t\t\t\t</Dialog.Body>\n\t\t\t\t\t<div className=\"tlui-dialog__scrim\" />\n\t\t\t\t</>\n\t\t\t)}\n\t\t</>\n\t)\n})\n","import { App, TL_GEO_TYPES, useApp } from '@tldraw/editor'\nimport * as React from 'react'\nimport { EmbedDialog } from '../components/EmbedDialog'\nimport { TLUiIconType } from '../icon-types'\nimport { useDialogs } from './useDialogsProvider'\nimport { useInsertMedia } from './useInsertMedia'\nimport { TLTranslationKey } from './useTranslation'\n\n/** @public */\nexport interface ToolItem {\n\tid: string\n\tlabel: TLTranslationKey\n\tshortcutsLabel?: TLTranslationKey\n\ticon: TLUiIconType\n\tonSelect: () => void\n\tkbd?: string\n\treadonlyOk: boolean\n\tmeta?: {\n\t\t[key: string]: any\n\t}\n}\n\n/** @public */\nexport type ToolsContextType = Record<string, ToolItem>\n\n/** @public */\nexport const ToolsContext = React.createContext({} as ToolsContextType)\n\n/** @public */\nexport type ToolsProviderProps = {\n\toverrides?: (\n\t\tapp: App,\n\t\ttools: ToolsContextType,\n\t\thelpers: { insertMedia: () => void }\n\t) => ToolsContextType\n\tchildren: any\n}\n\n/** @public */\nexport function ToolsProvider({ overrides, children }: ToolsProviderProps) {\n\tconst app = useApp()\n\n\tconst { addDialog } = useDialogs()\n\tconst insertMedia = useInsertMedia()\n\n\tconst tools = React.useMemo<ToolsContextType>(() => {\n\t\tconst tools = makeTools([\n\t\t\t{\n\t\t\t\tid: 'select',\n\t\t\t\tlabel: 'tool.select',\n\t\t\t\ticon: 'tool-pointer',\n\t\t\t\tkbd: 'v',\n\t\t\t\treadonlyOk: true,\n\t\t\t\tonSelect() {\n\t\t\t\t\tapp.setSelectedTool('select')\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'hand',\n\t\t\t\tlabel: 'tool.hand',\n\t\t\t\ticon: 'tool-hand',\n\t\t\t\tkbd: 'h',\n\t\t\t\treadonlyOk: true,\n\t\t\t\tonSelect() {\n\t\t\t\t\tapp.setSelectedTool('hand')\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'eraser',\n\t\t\t\tlabel: 'tool.eraser',\n\t\t\t\ticon: 'tool-eraser',\n\t\t\t\tkbd: 'e',\n\t\t\t\treadonlyOk: true,\n\t\t\t\tonSelect() {\n\t\t\t\t\tapp.setSelectedTool('eraser')\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'draw',\n\t\t\t\tlabel: 'tool.draw',\n\t\t\t\treadonlyOk: true,\n\t\t\t\ticon: 'tool-pencil',\n\t\t\t\tkbd: 'd,b,x',\n\t\t\t\tonSelect() {\n\t\t\t\t\tapp.setSelectedTool('draw')\n\t\t\t\t},\n\t\t\t},\n\t\t\t...[...TL_GEO_TYPES].map((id) => ({\n\t\t\t\tid,\n\t\t\t\tlabel: `tool.${id}` as TLTranslationKey,\n\t\t\t\treadonlyOk: true,\n\t\t\t\tmeta: {\n\t\t\t\t\tgeo: id,\n\t\t\t\t},\n\t\t\t\tkbd: id === 'rectangle' ? 'r' : id === 'ellipse' ? 'o' : undefined,\n\t\t\t\ticon: ('geo-' + id) as TLUiIconType,\n\t\t\t\tonSelect() {\n\t\t\t\t\tapp.batch(() => {\n\t\t\t\t\t\tapp.updateInstanceState(\n\t\t\t\t\t\t\t{ propsForNextShape: { ...app.instanceState.propsForNextShape, geo: id } },\n\t\t\t\t\t\t\ttrue\n\t\t\t\t\t\t)\n\t\t\t\t\t\tapp.setSelectedTool('geo')\n\t\t\t\t\t})\n\t\t\t\t},\n\t\t\t})),\n\t\t\t{\n\t\t\t\tid: 'arrow',\n\t\t\t\tlabel: 'tool.arrow',\n\t\t\t\treadonlyOk: true,\n\t\t\t\ticon: 'tool-arrow',\n\t\t\t\tkbd: 'a',\n\t\t\t\tonSelect() {\n\t\t\t\t\tapp.setSelectedTool('arrow')\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'line',\n\t\t\t\tlabel: 'tool.line',\n\t\t\t\treadonlyOk: true,\n\t\t\t\ticon: 'tool-line',\n\t\t\t\tkbd: 'l',\n\t\t\t\tonSelect() {\n\t\t\t\t\tapp.setSelectedTool('line')\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'frame',\n\t\t\t\tlabel: 'tool.frame',\n\t\t\t\treadonlyOk: true,\n\t\t\t\ticon: 'tool-frame',\n\t\t\t\tkbd: 'f',\n\t\t\t\tonSelect() {\n\t\t\t\t\tapp.setSelectedTool('frame')\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'text',\n\t\t\t\tlabel: 'tool.text',\n\t\t\t\treadonlyOk: true,\n\t\t\t\ticon: 'tool-text',\n\t\t\t\tkbd: 't',\n\t\t\t\tonSelect() {\n\t\t\t\t\tapp.setSelectedTool('text')\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'asset',\n\t\t\t\tlabel: 'tool.asset',\n\t\t\t\treadonlyOk: true,\n\t\t\t\ticon: 'tool-media',\n\t\t\t\tkbd: '$u',\n\t\t\t\tonSelect() {\n\t\t\t\t\tinsertMedia()\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'note',\n\t\t\t\tlabel: 'tool.note',\n\t\t\t\treadonlyOk: true,\n\t\t\t\ticon: 'tool-note',\n\t\t\t\tkbd: 'n',\n\t\t\t\tonSelect() {\n\t\t\t\t\tapp.setSelectedTool('note')\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'embed',\n\t\t\t\tlabel: 'tool.embed',\n\t\t\t\treadonlyOk: true,\n\t\t\t\ticon: 'tool-embed',\n\t\t\t\tonSelect() {\n\t\t\t\t\taddDialog({ component: EmbedDialog })\n\t\t\t\t},\n\t\t\t},\n\t\t])\n\n\t\tif (overrides) {\n\t\t\treturn overrides(app, tools, { insertMedia })\n\t\t}\n\n\t\treturn tools\n\t}, [app, overrides, insertMedia, addDialog])\n\n\treturn <ToolsContext.Provider value={tools}>{children}</ToolsContext.Provider>\n}\n\nfunction makeTools(tools: ToolItem[]) {\n\treturn Object.fromEntries(tools.map((t) => [t.id, t]))\n}\n\n/** @public */\nexport function useTools() {\n\tconst ctx = React.useContext(ToolsContext)\n\n\tif (!ctx) {\n\t\tthrow new Error('useTools must be used within a ToolProvider')\n\t}\n\n\treturn ctx\n}\n","import { preventDefault, useApp } from '@tldraw/editor'\nimport hotkeys from 'hotkeys-js'\nimport { useEffect } from 'react'\nimport { useActions } from './useActions'\nimport { useReadonly } from './useReadonly'\nimport { useTools } from './useTools'\n\nconst SKIP_KBDS = [\n\t// we set these in useNativeClipboardEvents instead\n\t'copy',\n\t'cut',\n\t'paste',\n\t// There's also an upload asset action, so we don't want to set the kbd twice\n\t'asset',\n]\n\n/** @public */\nexport function useKeyboardShortcuts() {\n\tconst app = useApp()\n\n\tconst isReadonly = useReadonly()\n\tconst actions = useActions()\n\tconst tools = useTools()\n\n\tuseEffect(() => {\n\t\t// Add hotkeys for actions and tools.\n\t\t// Except those that in SKIP_KBDS!\n\t\tconst areShortcutsDisabled = () => app.isMenuOpen || app.editingId !== null || app.crashingError\n\n\t\tfor (const action of Object.values(actions)) {\n\t\t\tif (!action.kbd) continue\n\t\t\tif (isReadonly && !action.readonlyOk) continue\n\t\t\tif (SKIP_KBDS.includes(action.id)) continue\n\n\t\t\thotkeys(getHotkeysStringFromKbd(action.kbd), (event) => {\n\t\t\t\tif (areShortcutsDisabled()) return\n\t\t\t\tpreventDefault(event)\n\t\t\t\taction.onSelect()\n\t\t\t})\n\t\t}\n\n\t\tfor (const tool of Object.values(tools)) {\n\t\t\tif (!tool.kbd) continue\n\n\t\t\tif (SKIP_KBDS.includes(tool.id)) continue\n\n\t\t\thotkeys(getHotkeysStringFromKbd(tool.kbd), (event) => {\n\t\t\t\tif (areShortcutsDisabled()) return\n\t\t\t\tpreventDefault(event)\n\t\t\t\ttool.onSelect()\n\t\t\t})\n\t\t}\n\n\t\t// Manually add in a few shortcuts that have \"extra\" kbds\n\t\t// todo: move these into the actions themselves and make the UI only display the first one\n\n\t\thotkeys('g', () => {\n\t\t\tif (areShortcutsDisabled()) return\n\t\t\tapp.setSelectedTool('geo')\n\t\t})\n\n\t\thotkeys('backspace,del', () => {\n\t\t\tif (areShortcutsDisabled()) return\n\t\t\tactions['delete'].onSelect()\n\t\t})\n\n\t\thotkeys('=', () => {\n\t\t\tif (areShortcutsDisabled()) return\n\t\t\tactions['zoom-in'].onSelect()\n\t\t})\n\n\t\thotkeys('-', () => {\n\t\t\tif (areShortcutsDisabled()) return\n\t\t\tactions['zoom-out'].onSelect()\n\t\t})\n\n\t\treturn () => {\n\t\t\thotkeys.unbind()\n\t\t}\n\t}, [actions, tools, isReadonly, app])\n}\n\nfunction getHotkeysStringFromKbd(kbd: string) {\n\tlet str = ''\n\n\tconst chars = kbd.split('')\n\n\tif (chars.length === 1) {\n\t\tstr = chars[0]\n\t} else {\n\t\tif (chars[0] === '!') {\n\t\t\tstr = `shift+${chars[1]}`\n\t\t} else if (chars[0] === '?') {\n\t\t\tstr = `alt+${chars[1]}`\n\t\t} else if (chars[0] === '$') {\n\t\t\tif (chars[1] === '!') {\n\t\t\t\tstr = `cmd+shift+${chars[2]},ctrl+shift+${chars[2]}`\n\t\t\t} else if (chars[1] === '?') {\n\t\t\t\tstr = `cmd++${chars[2]},ctrl+alt+${chars[2]}`\n\t\t\t} else {\n\t\t\t\tstr = `cmd+${chars[1]},ctrl+${chars[1]}`\n\t\t\t}\n\t\t} else {\n\t\t\tstr = kbd\n\t\t}\n\t}\n\n\treturn str\n}\n","import { useApp } from '@tldraw/editor'\nimport { useCallback, useEffect, useRef } from 'react'\n\n/** @public */\nexport function useMenuIsOpen(id: string, cb?: (isOpen: boolean) => void) {\n\tconst app = useApp()\n\tconst rIsOpen = useRef(false)\n\n\tconst onOpenChange = useCallback(\n\t\t(isOpen: boolean) => {\n\t\t\trIsOpen.current = isOpen\n\t\t\tif (isOpen) {\n\t\t\t\tapp.complete()\n\t\t\t\tapp.openMenus.add(id)\n\t\t\t} else {\n\t\t\t\tapp.openMenus.delete(id)\n\t\t\t\tapp.openMenus.forEach((menuId) => {\n\t\t\t\t\tif (menuId.startsWith(id)) {\n\t\t\t\t\t\tapp.openMenus.delete(menuId)\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\n\t\t\tcb?.(isOpen)\n\t\t},\n\t\t[app, id, cb]\n\t)\n\n\tuseEffect(() => {\n\t\t// When the effect runs, if the menu is open then\n\t\t// add it to the open menus list.\n\n\t\t// This is necessary for cases where the user closes\n\t\t// the parent of a submenu before closing the submenu.\n\t\t// There is some duplication between this and `onOpenChange`\n\t\t// hook but it's necessary to handle the case where the\n\t\t// this effect runs twice or re-runs.\n\t\tif (rIsOpen.current) {\n\t\t\tapp.openMenus.add(id)\n\t\t}\n\n\t\treturn () => {\n\t\t\tif (rIsOpen.current) {\n\t\t\t\t// Close menu on unmount\n\t\t\t\tapp.openMenus.delete(id)\n\n\t\t\t\t// Close menu and all submenus when the parent is closed\n\t\t\t\tapp.openMenus.forEach((menuId) => {\n\t\t\t\t\tif (menuId.startsWith(id)) {\n\t\t\t\t\t\tapp.openMenus.delete(menuId)\n\t\t\t\t\t}\n\t\t\t\t})\n\n\t\t\t\trIsOpen.current = false\n\t\t\t}\n\t\t}\n\t}, [app, id])\n\n\treturn onOpenChange\n}\n","import { App, useApp } from '@tldraw/editor'\nimport { compact } from '@tldraw/utils'\nimport React, { useMemo } from 'react'\nimport { useValue } from 'signia-react'\nimport {\n\tMenuSchema,\n\tmenuCustom,\n\tmenuGroup,\n\tmenuItem,\n\tmenuSubmenu,\n\tshowUiPaste,\n\tuseAllowGroup,\n\tuseAllowUngroup,\n} from './menuHelpers'\nimport { useActions } from './useActions'\nimport { useBreakpoint } from './useBreakpoint'\nimport { useCanRedo } from './useCanRedo'\nimport { useCanUndo } from './useCanUndo'\nimport { useHasLinkShapeSelected } from './useHasLinkShapeSelected'\nimport { useShowAutoSizeToggle } from './useShowAutoSizeToggle'\n\n/** @public */\nexport type MenuSchemaContextType = MenuSchema\n\n/** @public */\nexport const MenuSchemaContext = React.createContext({} as MenuSchemaContextType)\n\n/** @public */\nexport type MenuSchemaProviderProps = {\n\toverrides?: (\n\t\tapp: App,\n\t\tschema: MenuSchemaContextType,\n\t\thelpers: {\n\t\t\tactions: ReturnType<typeof useActions>\n\t\t\tnoneSelected: boolean\n\t\t\toneSelected: boolean\n\t\t\ttwoSelected: boolean\n\t\t\tthreeSelected: boolean\n\t\t}\n\t) => MenuSchemaContextType\n\tchildren: any\n}\n\n/** @public */\nexport function MenuSchemaProvider({ overrides, children }: MenuSchemaProviderProps) {\n\tconst app = useApp()\n\tconst actions = useActions()\n\n\tconst breakpoint = useBreakpoint()\n\tconst isMobile = breakpoint < 5\n\n\tconst isDarkMode = useValue('isDarkMode', () => app.userDocumentSettings.isDarkMode, [app])\n\tconst isGridMode = useValue('isGridMode', () => app.userDocumentSettings.isGridMode, [app])\n\tconst isSnapMode = useValue('isSnapMode', () => app.userDocumentSettings.isSnapMode, [app])\n\tconst isToolLock = useValue('isToolLock', () => app.instanceState.isToolLocked, [app])\n\tconst isFocusMode = useValue('isFocusMode', () => app.instanceState.isFocusMode, [app])\n\tconst isDebugMode = useValue('isDebugMode', () => app.instanceState.isDebugMode, [app])\n\tconst exportBackground = useValue('exportBackground', () => app.instanceState.exportBackground, [\n\t\tapp,\n\t])\n\n\tconst emptyPage = useValue('emptyPage', () => app.shapeIds.size === 0, [app])\n\n\tconst selectedCount = useValue('selectedCount', () => app.selectedIds.length, [app])\n\tconst noneSelected = selectedCount === 0\n\tconst oneSelected = selectedCount > 0\n\tconst twoSelected = selectedCount > 1\n\tconst threeSelected = selectedCount > 2\n\n\tconst hasClipboardWrite = Boolean(window.navigator.clipboard?.write)\n\tconst showEditLink = useHasLinkShapeSelected()\n\tconst showAutoSizeToggle = useShowAutoSizeToggle()\n\tconst allowGroup = useAllowGroup()\n\tconst allowUngroup = useAllowUngroup()\n\tconst canUndo = useCanUndo()\n\tconst canRedo = useCanRedo()\n\tconst isZoomedTo100 = useValue('isZoomedTo100', () => app.camera.z === 1, [app])\n\n\tconst menuSchema = useMemo<MenuSchema>(() => {\n\t\tconst menuSchema = compact([\n\t\t\tmenuGroup(\n\t\t\t\t'menu',\n\t\t\t\tmenuSubmenu(\n\t\t\t\t\t'file',\n\t\t\t\t\t'menu.file',\n\t\t\t\t\tmenuGroup('print', menuItem(actions['print'], { disabled: emptyPage }))\n\t\t\t\t),\n\t\t\t\tmenuSubmenu(\n\t\t\t\t\t'edit',\n\t\t\t\t\t'menu.edit',\n\t\t\t\t\tmenuGroup(\n\t\t\t\t\t\t'undo-actions',\n\t\t\t\t\t\tmenuItem(actions['undo'], { disabled: !canUndo }),\n\t\t\t\t\t\tmenuItem(actions['redo'], { disabled: !canRedo })\n\t\t\t\t\t),\n\t\t\t\t\tmenuGroup(\n\t\t\t\t\t\t'clipboard-actions',\n\t\t\t\t\t\tmenuItem(actions['cut'], { disabled: noneSelected }),\n\t\t\t\t\t\tmenuItem(actions['copy'], { disabled: noneSelected }),\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: 'MENU_PASTE',\n\t\t\t\t\t\t\ttype: 'custom',\n\t\t\t\t\t\t\tdisabled: !showUiPaste,\n\t\t\t\t\t\t\treadonlyOk: false,\n\t\t\t\t\t\t}\n\t\t\t\t\t),\n\t\t\t\t\tmenuGroup(\n\t\t\t\t\t\t'conversions',\n\t\t\t\t\t\tmenuSubmenu(\n\t\t\t\t\t\t\t'copy-as',\n\t\t\t\t\t\t\t'menu.copy-as',\n\t\t\t\t\t\t\tmenuGroup(\n\t\t\t\t\t\t\t\t'copy-as-group',\n\t\t\t\t\t\t\t\tmenuItem(actions['copy-as-svg'], { disabled: emptyPage }),\n\t\t\t\t\t\t\t\tmenuItem(actions['copy-as-png'], { disabled: emptyPage || !hasClipboardWrite }),\n\t\t\t\t\t\t\t\tmenuItem(actions['copy-as-json'], { disabled: emptyPage })\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\tmenuGroup(\n\t\t\t\t\t\t\t\t'export-bg',\n\t\t\t\t\t\t\t\tmenuItem(actions['toggle-transparent'], { checked: !exportBackground })\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t),\n\t\t\t\t\t\tmenuSubmenu(\n\t\t\t\t\t\t\t'export-as',\n\t\t\t\t\t\t\t'menu.export-as',\n\t\t\t\t\t\t\tmenuGroup(\n\t\t\t\t\t\t\t\t'export-as-group',\n\t\t\t\t\t\t\t\tmenuItem(actions['export-as-svg'], { disabled: emptyPage }),\n\t\t\t\t\t\t\t\tmenuItem(actions['export-as-png'], { disabled: emptyPage }),\n\t\t\t\t\t\t\t\tmenuItem(actions['export-as-json'], { disabled: emptyPage })\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\tmenuGroup(\n\t\t\t\t\t\t\t\t'export-bg',\n\t\t\t\t\t\t\t\tmenuItem(actions['toggle-transparent'], { checked: !exportBackground })\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t)\n\t\t\t\t\t),\n\t\t\t\t\tmenuGroup(\n\t\t\t\t\t\t'set-selection-group',\n\t\t\t\t\t\tmenuItem(actions['select-all'], { disabled: emptyPage }),\n\t\t\t\t\t\tmenuItem(actions['select-none'], { disabled: !oneSelected })\n\t\t\t\t\t),\n\t\t\t\t\tmenuGroup(\n\t\t\t\t\t\t'selection',\n\t\t\t\t\t\tshowAutoSizeToggle && menuItem(actions['toggle-auto-size']),\n\t\t\t\t\t\tshowEditLink && menuItem(actions['edit-link']),\n\t\t\t\t\t\tmenuItem(actions['duplicate'], { disabled: !oneSelected }),\n\t\t\t\t\t\tallowGroup && menuItem(actions['group']),\n\t\t\t\t\t\tallowUngroup && menuItem(actions['ungroup'])\n\t\t\t\t\t),\n\t\t\t\t\tmenuGroup('delete-group', menuItem(actions['delete'], { disabled: !oneSelected }))\n\t\t\t\t),\n\t\t\t\tmenuSubmenu(\n\t\t\t\t\t'view',\n\t\t\t\t\t'menu.view',\n\t\t\t\t\tmenuGroup(\n\t\t\t\t\t\t'view-actions',\n\t\t\t\t\t\tmenuItem(actions['zoom-in']),\n\t\t\t\t\t\tmenuItem(actions['zoom-out']),\n\t\t\t\t\t\tmenuItem(actions['zoom-to-100'], { disabled: isZoomedTo100 }),\n\t\t\t\t\t\tmenuItem(actions['zoom-to-fit'], { disabled: emptyPage }),\n\t\t\t\t\t\tmenuItem(actions['zoom-to-selection'], { disabled: emptyPage || !oneSelected })\n\t\t\t\t\t)\n\t\t\t\t),\n\t\t\t\tmenuItem(actions['insert-media'])\n\t\t\t),\n\t\t\tmenuGroup(\n\t\t\t\t'preferences',\n\t\t\t\tmenuSubmenu(\n\t\t\t\t\t'preferences',\n\t\t\t\t\t'menu.preferences',\n\t\t\t\t\tmenuGroup(\n\t\t\t\t\t\t'preferences-actions',\n\t\t\t\t\t\tmenuItem(actions['toggle-snap-mode'], { checked: isSnapMode }),\n\t\t\t\t\t\tmenuItem(actions['toggle-tool-lock'], { checked: isToolLock }),\n\t\t\t\t\t\tmenuItem(actions['toggle-grid'], { checked: isGridMode }),\n\t\t\t\t\t\tmenuItem(actions['toggle-dark-mode'], { checked: isDarkMode }),\n\t\t\t\t\t\tmenuItem(actions['toggle-focus-mode'], { checked: isFocusMode }),\n\t\t\t\t\t\tmenuItem(actions['toggle-debug-mode'], { checked: isDebugMode })\n\t\t\t\t\t)\n\t\t\t\t),\n\t\t\t\tisMobile && menuCustom('LANGUAGE_MENU', { readonlyOk: true })\n\t\t\t),\n\t\t])\n\n\t\tif (overrides) {\n\t\t\treturn overrides(app, menuSchema, {\n\t\t\t\tactions,\n\t\t\t\tnoneSelected,\n\t\t\t\toneSelected,\n\t\t\t\ttwoSelected,\n\t\t\t\tthreeSelected,\n\t\t\t})\n\t\t}\n\n\t\treturn menuSchema\n\t}, [\n\t\tapp,\n\t\toverrides,\n\t\tactions,\n\t\toneSelected,\n\t\ttwoSelected,\n\t\tthreeSelected,\n\t\temptyPage,\n\t\tisMobile,\n\t\tallowGroup,\n\t\tallowUngroup,\n\t\tshowEditLink,\n\t\thasClipboardWrite,\n\t\tshowAutoSizeToggle,\n\t\tnoneSelected,\n\t\tcanUndo,\n\t\tcanRedo,\n\t\tisDarkMode,\n\t\tisGridMode,\n\t\tisSnapMode,\n\t\tisToolLock,\n\t\tisFocusMode,\n\t\texportBackground,\n\t\tisDebugMode,\n\t\tisZoomedTo100,\n\t])\n\n\treturn <MenuSchemaContext.Provider value={menuSchema}>{children}</MenuSchemaContext.Provider>\n}\n\n/** @public */\nexport function useMenuSchema(): MenuSchema {\n\tconst ctx = React.useContext(MenuSchemaContext)\n\n\tif (!ctx) {\n\t\tthrow new Error('useMenuSchema must be used inside of a MenuSchemaProvider.')\n\t}\n\n\treturn ctx\n}\n","import { App, useApp } from '@tldraw/editor'\nimport React from 'react'\nimport { ToolItem, ToolsContextType, useTools } from './useTools'\n\n/** @public */\nexport type ToolbarItem = {\n\tid: string\n\ttype: 'item'\n\treadonlyOk: boolean\n\ttoolItem: ToolItem\n}\n\n/** @public */\nexport function toolbarItem(toolItem: ToolItem): ToolbarItem {\n\treturn {\n\t\tid: toolItem.id,\n\t\ttype: 'item',\n\t\treadonlyOk: toolItem.readonlyOk,\n\t\ttoolItem,\n\t}\n}\n\n/** @public */\nexport type ToolbarSchemaContextType = ToolbarItem[]\n\n/** @public */\nexport const ToolbarSchemaContext = React.createContext([] as ToolbarSchemaContextType)\n\n/** @public */\nexport type ToolbarSchemaProviderProps = {\n\toverrides?: (\n\t\tapp: App,\n\t\tschema: ToolbarSchemaContextType,\n\t\tmore: { tools: ToolsContextType }\n\t) => ToolbarSchemaContextType\n\tchildren: any\n}\n\n/** @public */\nexport function ToolbarSchemaProvider({ overrides, children }: ToolbarSchemaProviderProps) {\n\tconst app = useApp()\n\n\tconst tools = useTools()\n\n\tconst toolbarSchema = React.useMemo<ToolbarSchemaContextType>(() => {\n\t\tconst schema: ToolbarSchemaContextType = [\n\t\t\ttoolbarItem(tools.select),\n\t\t\ttoolbarItem(tools.hand),\n\t\t\ttoolbarItem(tools.draw),\n\t\t\ttoolbarItem(tools.eraser),\n\t\t\ttoolbarItem(tools.arrow),\n\t\t\ttoolbarItem(tools.text),\n\t\t\ttoolbarItem(tools.note),\n\t\t\ttoolbarItem(tools.asset),\n\t\t\ttoolbarItem(tools['rectangle']),\n\t\t\ttoolbarItem(tools['ellipse']),\n\t\t\ttoolbarItem(tools['diamond']),\n\t\t\ttoolbarItem(tools['triangle']),\n\t\t\ttoolbarItem(tools['trapezoid']),\n\t\t\ttoolbarItem(tools['rhombus']),\n\t\t\ttoolbarItem(tools['pentagon']),\n\t\t\ttoolbarItem(tools['hexagon']),\n\t\t\ttoolbarItem(tools['octagon']),\n\t\t\ttoolbarItem(tools['star']),\n\t\t\ttoolbarItem(tools['oval']),\n\t\t\ttoolbarItem(tools['x-box']),\n\t\t\ttoolbarItem(tools['arrow-right']),\n\t\t\ttoolbarItem(tools['arrow-left']),\n\t\t\ttoolbarItem(tools['arrow-up']),\n\t\t\ttoolbarItem(tools['arrow-down']),\n\t\t\ttoolbarItem(tools.line),\n\t\t\ttoolbarItem(tools.frame),\n\t\t\ttoolbarItem(tools.embed),\n\t\t]\n\n\t\tif (overrides) {\n\t\t\treturn overrides(app, schema, { tools })\n\t\t}\n\n\t\treturn schema\n\t}, [app, overrides, tools])\n\n\treturn (\n\t\t<ToolbarSchemaContext.Provider value={toolbarSchema}>{children}</ToolbarSchemaContext.Provider>\n\t)\n}\n\n/** @public */\nexport function useToolbarSchema() {\n\tconst ctx = React.useContext(ToolbarSchemaContext)\n\n\tif (!ctx) {\n\t\tthrow new Error('useToolbarSchema must be used within a ToolbarSchemaProvider')\n\t}\n\n\treturn ctx\n}\n","import * as _ContextMenu from '@radix-ui/react-context-menu'\nimport { TLPage, TLPageId, useApp, useContainer } from '@tldraw/editor'\nimport { track } from 'signia-react'\nimport { useTranslation } from '../../hooks'\nimport { Button } from '../primitives'\n\nexport const MoveToPageMenu = track(function MoveToPageMenu() {\n\tconst app = useApp()\n\tconst container = useContainer()\n\tconst pages = app.pages\n\tconst currentPageId = app.currentPageId\n\tconst msg = useTranslation()\n\n\treturn (\n\t\t<_ContextMenu.Sub>\n\t\t\t<_ContextMenu.SubTrigger dir=\"ltr\" asChild>\n\t\t\t\t<Button\n\t\t\t\t\tclassName=\"tlui-menu__button\"\n\t\t\t\t\tlabel=\"context-menu.move-to-page\"\n\t\t\t\t\tdata-wd=\"menu-item.move-to-page\"\n\t\t\t\t\ticon=\"chevron-right\"\n\t\t\t\t/>\n\t\t\t</_ContextMenu.SubTrigger>\n\t\t\t<_ContextMenu.Portal container={container} dir=\"ltr\">\n\t\t\t\t<_ContextMenu.SubContent className=\"tlui-menu\" sideOffset={-4} collisionPadding={4}>\n\t\t\t\t\t<_ContextMenu.Group\n\t\t\t\t\t\tdir=\"ltr\"\n\t\t\t\t\t\tclassName={'tlui-menu__group'}\n\t\t\t\t\t\tdata-wd={`menu-item.pages`}\n\t\t\t\t\t\tkey=\"pages\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{pages.map((page) => (\n\t\t\t\t\t\t\t<_ContextMenu.Item\n\t\t\t\t\t\t\t\tkey={page.id}\n\t\t\t\t\t\t\t\tdisabled={currentPageId === page.id}\n\t\t\t\t\t\t\t\tonSelect={() => {\n\t\t\t\t\t\t\t\t\tapp.mark('move_shapes_to_page')\n\t\t\t\t\t\t\t\t\tapp.moveShapesToPage(app.selectedIds, page.id as TLPageId)\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\tasChild\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\ttitle={page.name}\n\t\t\t\t\t\t\t\t\tclassName=\"tlui-menu__button tlui-context-menu__move-to-page__name\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<span>{page.name}</span>\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t</_ContextMenu.Item>\n\t\t\t\t\t\t))}\n\t\t\t\t\t</_ContextMenu.Group>\n\t\t\t\t\t<_ContextMenu.Group\n\t\t\t\t\t\tdir=\"ltr\"\n\t\t\t\t\t\tclassName={'tlui-menu__group'}\n\t\t\t\t\t\tdata-wd={`menu-item.new-page`}\n\t\t\t\t\t\tkey=\"new-page\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<_ContextMenu.Item\n\t\t\t\t\t\t\tkey=\"new-page\"\n\t\t\t\t\t\t\tonSelect={() => {\n\t\t\t\t\t\t\t\tapp.mark('move_shapes_to_page')\n\t\t\t\t\t\t\t\tconst newPageId = TLPage.createId()\n\t\t\t\t\t\t\t\tconst ids = app.selectedIds\n\t\t\t\t\t\t\t\tconst oldPageId = app.currentPageId\n\t\t\t\t\t\t\t\tapp.batch(() => {\n\t\t\t\t\t\t\t\t\tapp.createPage('Page 1', newPageId)\n\t\t\t\t\t\t\t\t\tapp.setCurrentPageId(oldPageId)\n\t\t\t\t\t\t\t\t\tapp.moveShapesToPage(ids, newPageId)\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tasChild\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\ttitle={msg('context.pages.new-page')}\n\t\t\t\t\t\t\t\tclassName=\"tlui-menu__button tlui-context-menu__move-to-page__name\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{msg('context.pages.new-page')}\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</_ContextMenu.Item>\n\t\t\t\t\t</_ContextMenu.Group>\n\t\t\t\t</_ContextMenu.SubContent>\n\t\t\t</_ContextMenu.Portal>\n\t\t</_ContextMenu.Sub>\n\t)\n})\n","import * as _ContextMenu from '@radix-ui/react-context-menu'\nimport { App, preventDefault, useApp, useContainer } from '@tldraw/editor'\nimport classNames from 'classnames'\nimport * as React from 'react'\nimport { useValue } from 'signia-react'\nimport {\n\tMenuChild,\n\tuseBreakpoint,\n\tuseContextMenuSchema,\n\tuseMenuClipboardEvents,\n\tuseTranslation,\n} from '../../hooks'\nimport { useMenuIsOpen } from '../../hooks/useMenuIsOpen'\nimport { useReadonly } from '../../hooks/useReadonly'\nimport { Button, Icon, Kbd } from '../primitives'\nimport { MoveToPageMenu } from './MoveToPageMenu'\n\n/** @public */\nexport interface ContextMenuProps {\n\tchildren: any\n}\n\n/** @public */\nexport const ContextMenu = function ContextMenu({ children }: { children: any }) {\n\tconst app = useApp()\n\n\tconst contextMenuSchema = useContextMenuSchema()\n\tconst handleOpenChange = useMenuIsOpen('context menu')\n\n\t// If every item in the menu is readonly, then we don't want to show the menu\n\tconst isReadonly = useReadonly()\n\n\tconst noItemsToShow =\n\t\tcontextMenuSchema.length === 0 ||\n\t\t(isReadonly && contextMenuSchema.every((item) => !item.readonlyOk))\n\n\tconst selectToolActive = useValue('isSelectToolActive', () => app.currentToolId === 'select', [\n\t\tapp,\n\t])\n\n\tconst disabled = !selectToolActive || noItemsToShow\n\n\treturn (\n\t\t<_ContextMenu.Root dir=\"ltr\" onOpenChange={handleOpenChange}>\n\t\t\t<_ContextMenu.Trigger\n\t\t\t\tonContextMenu={disabled ? preventDefault : undefined}\n\t\t\t\tdir=\"ltr\"\n\t\t\t\tdisabled={disabled}\n\t\t\t>\n\t\t\t\t{children}\n\t\t\t</_ContextMenu.Trigger>\n\t\t\t<ContextMenuContent />\n\t\t</_ContextMenu.Root>\n\t)\n}\n\nfunction ContextMenuContent() {\n\tconst app = useApp()\n\tconst msg = useTranslation()\n\tconst menuSchema = useContextMenuSchema()\n\tconst handleSubOpenChange = useMenuIsOpen('context menu sub')\n\n\tconst isReadonly = useReadonly()\n\tconst { paste } = useMenuClipboardEvents()\n\tconst breakpoint = useBreakpoint()\n\tconst container = useContainer()\n\n\tconst [disableClicks, setDisableClicks] = React.useState(false)\n\n\tfunction getContextMenuItem(app: App, item: MenuChild, parent: MenuChild | null, depth: number) {\n\t\tif (isReadonly && !item.readonlyOk) return null\n\n\t\tswitch (item.type) {\n\t\t\tcase 'custom': {\n\t\t\t\tswitch (item.id) {\n\t\t\t\t\tcase 'MENU_PASTE': {\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<_ContextMenu.Item key={item.id}>\n\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\tclassName=\"tlui-menu__button\"\n\t\t\t\t\t\t\t\t\tdata-wd={`menu-item.${item.id}`}\n\t\t\t\t\t\t\t\t\tkbd=\"$v\"\n\t\t\t\t\t\t\t\t\tlabel=\"action.paste\"\n\t\t\t\t\t\t\t\t\tdisabled={item.disabled}\n\t\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\t\tif (!app.isSafari || (app.isSafari && app.isIos)) {\n\t\t\t\t\t\t\t\t\t\t\tnavigator.clipboard.read().then((clipboardItems) => {\n\t\t\t\t\t\t\t\t\t\t\t\tpaste(clipboardItems, app.inputs.currentPagePoint)\n\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\tonMouseDown={() => {\n\t\t\t\t\t\t\t\t\t\tif (app.isSafari && !app.isIos) {\n\t\t\t\t\t\t\t\t\t\t\t// NOTE: This must be a onMouseDown for Safari/desktop, onClick doesn't work at the time of writing... \n\t\t\t\t\t\t\t\t\t\t\tnavigator.clipboard.read().then((clipboardItems) => {\n\t\t\t\t\t\t\t\t\t\t\t\tpaste(clipboardItems, app.inputs.currentPagePoint)\n\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t// onPointerUp={() => {\n\t\t\t\t\t\t\t\t\t// \tif (app.isSafari && app.isIos) {\n\t\t\t\t\t\t\t\t\t// \t\t// NOTE: This must be a onPointerUp for Safari/mobile, onClick doesn't work at the time of writing... \n\t\t\t\t\t\t\t\t\t// \t\tnavigator.clipboard.read().then((clipboardItems) => {\n\t\t\t\t\t\t\t\t\t// \t\t\tpaste(clipboardItems, app.inputs.currentPagePoint)\n\t\t\t\t\t\t\t\t\t// \t\t})\n\t\t\t\t\t\t\t\t\t// \t}\n\t\t\t\t\t\t\t\t\t// }}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</_ContextMenu.Item>\n\t\t\t\t\t\t)\n\t\t\t\t\t}\n\t\t\t\t\tcase 'MOVE_TO_PAGE_MENU': {\n\t\t\t\t\t\treturn <MoveToPageMenu key={item.id} />\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tcase 'group': {\n\t\t\t\treturn (\n\t\t\t\t\t<_ContextMenu.Group\n\t\t\t\t\t\tdir=\"ltr\"\n\t\t\t\t\t\tclassName={classNames('tlui-menu__group', {\n\t\t\t\t\t\t\t'tlui-menu__group__small': parent?.type === 'submenu',\n\t\t\t\t\t\t})}\n\t\t\t\t\t\tdata-wd={`menu-item.${item.id}`}\n\t\t\t\t\t\tkey={item.id}\n\t\t\t\t\t>\n\t\t\t\t\t\t{item.children.map((child) => getContextMenuItem(app, child, item, depth + 1))}\n\t\t\t\t\t</_ContextMenu.Group>\n\t\t\t\t)\n\t\t\t}\n\t\t\tcase 'submenu': {\n\t\t\t\treturn (\n\t\t\t\t\t<_ContextMenu.Sub key={item.id} onOpenChange={handleSubOpenChange}>\n\t\t\t\t\t\t<_ContextMenu.SubTrigger dir=\"ltr\" disabled={item.disabled} asChild>\n\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\tclassName=\"tlui-menu__button\"\n\t\t\t\t\t\t\t\tlabel={item.label}\n\t\t\t\t\t\t\t\tdata-wd={`menu-item.${item.id}`}\n\t\t\t\t\t\t\t\ticon=\"chevron-right\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</_ContextMenu.SubTrigger>\n\t\t\t\t\t\t<_ContextMenu.Portal container={container} dir=\"ltr\">\n\t\t\t\t\t\t\t<_ContextMenu.SubContent className=\"tlui-menu\" sideOffset={-4} collisionPadding={4}>\n\t\t\t\t\t\t\t\t{item.children.map((child) => getContextMenuItem(app, child, item, depth + 1))}\n\t\t\t\t\t\t\t</_ContextMenu.SubContent>\n\t\t\t\t\t\t</_ContextMenu.Portal>\n\t\t\t\t\t</_ContextMenu.Sub>\n\t\t\t\t)\n\t\t\t}\n\t\t\tcase 'item': {\n\t\t\t\tif (isReadonly && !item.readonlyOk) return null\n\n\t\t\t\tconst { id, checkbox, contextMenuLabel, label, onSelect, kbd, icon } = item.actionItem\n\t\t\t\tconst labelToUse = contextMenuLabel ?? label\n\t\t\t\tconst labelStr = labelToUse ? msg(labelToUse) : undefined\n\n\t\t\t\tif (checkbox) {\n\t\t\t\t\t// Item is in a checkbox group\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<_ContextMenu.CheckboxItem\n\t\t\t\t\t\t\tkey={id}\n\t\t\t\t\t\t\tclassName=\"tlui-button tlui-menu__button tlui-menu__checkbox-item\"\n\t\t\t\t\t\t\tdir=\"ltr\"\n\t\t\t\t\t\t\tdisabled={item.disabled}\n\t\t\t\t\t\t\tonSelect={(e) => {\n\t\t\t\t\t\t\t\tonSelect()\n\t\t\t\t\t\t\t\tpreventDefault(e)\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\ttitle={labelStr ? labelStr : undefined}\n\t\t\t\t\t\t\tchecked={item.checked}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclassName=\"tlui-menu__checkbox-item__check\"\n\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\ttransformOrigin: '75% center',\n\t\t\t\t\t\t\t\t\ttransform: `scale(${item.checked ? 1 : 0.5})`,\n\t\t\t\t\t\t\t\t\topacity: item.checked ? 1 : 0.5,\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<Icon small icon={item.checked ? 'check' : 'checkbox-empty'} />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t{labelStr && <span>{labelStr}</span>}\n\t\t\t\t\t\t\t{kbd && <Kbd>{kbd}</Kbd>}\n\t\t\t\t\t\t</_ContextMenu.CheckboxItem>\n\t\t\t\t\t)\n\t\t\t\t}\n\n\t\t\t\treturn (\n\t\t\t\t\t<_ContextMenu.Item key={id} dir=\"ltr\" asChild>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tclassName=\"tlui-menu__button\"\n\t\t\t\t\t\t\tdata-wd={`menu-item.${id}`}\n\t\t\t\t\t\t\tkbd={kbd}\n\t\t\t\t\t\t\tlabel={labelToUse}\n\t\t\t\t\t\t\tdisabled={item.disabled}\n\t\t\t\t\t\t\ticonLeft={breakpoint < 3 && depth > 2 ? icon : undefined}\n\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\tif (disableClicks) {\n\t\t\t\t\t\t\t\t\tsetDisableClicks(false)\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tonSelect()\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</_ContextMenu.Item>\n\t\t\t\t)\n\t\t\t}\n\t\t}\n\t}\n\n\treturn (\n\t\t<_ContextMenu.Portal dir=\"ltr\" container={container}>\n\t\t\t<_ContextMenu.Content\n\t\t\t\tclassName=\"tlui-menu scrollable\"\n\t\t\t\talignOffset={-4}\n\t\t\t\tcollisionPadding={4}\n\t\t\t\tonContextMenu={preventDefault}\n\t\t\t>\n\t\t\t\t{menuSchema.map((item) => getContextMenuItem(app, item, null, 0))}\n\t\t\t</_ContextMenu.Content>\n\t\t</_ContextMenu.Portal>\n\t)\n}\n","import { App, debugFlags, TLShapePartial, uniqueId, useApp } from '@tldraw/editor'\nimport * as React from 'react'\nimport { track } from 'signia-react'\nimport { useDialogs, useToasts } from '../../hooks'\nimport { Button, Dialog } from '../primitives'\nimport * as DropdownMenu from '../primitives/DropdownMenu'\n\nlet t = 0\n\nfunction createNShapes(app: App, n: number) {\n\tconst shapesToCreate: TLShapePartial[] = Array(n)\n\tconst cols = Math.floor(Math.sqrt(n))\n\n\tfor (let i = 0; i < n; i++) {\n\t\tt++\n\t\tshapesToCreate[i] = {\n\t\t\tid: app.createShapeId('box' + t),\n\t\t\ttype: 'geo',\n\t\t\tx: (i % cols) * 132,\n\t\t\ty: Math.floor(i / cols) * 132,\n\t\t}\n\t}\n\n\tapp.batch(() => {\n\t\tapp.createShapes(shapesToCreate).setSelectedIds(shapesToCreate.map((s) => s.id))\n\t})\n}\n\n/** @public */\nexport const DebugPanel = React.memo(function DebugPanel({\n\trenderDebugMenuItems,\n}: {\n\trenderDebugMenuItems: (() => React.ReactNode) | null\n}) {\n\treturn (\n\t\t<div className=\"tlui-debug-panel\">\n\t\t\t<CurrentState />\n\t\t\t<ShapeCount />\n\t\t\t<DropdownMenu.Root id=\"debug\">\n\t\t\t\t<DropdownMenu.Trigger>\n\t\t\t\t\t<Button icon=\"dots-horizontal\" />\n\t\t\t\t</DropdownMenu.Trigger>\n\t\t\t\t<DropdownMenu.Content side=\"top\" align=\"end\" alignOffset={0}>\n\t\t\t\t\t<DebugMenuContent renderDebugMenuItems={renderDebugMenuItems} />\n\t\t\t\t</DropdownMenu.Content>\n\t\t\t</DropdownMenu.Root>\n\t\t</div>\n\t)\n})\n\nconst CurrentState = track(function CurrentState() {\n\tconst app = useApp()\n\treturn <div className=\"tlui-debug-panel__current-state\">{app.root.path.value}</div>\n})\n\nconst ShapeCount = track(function ShapeCount() {\n\tconst app = useApp()\n\n\treturn <div>{app.renderingShapes.length} Shapes</div>\n})\n\nfunction DebugMenuContent({\n\trenderDebugMenuItems,\n}: {\n\trenderDebugMenuItems: (() => React.ReactNode) | null\n}) {\n\tconst app = useApp()\n\tconst { addToast } = useToasts()\n\tconst { addDialog } = useDialogs()\n\n\tconst [error, setError] = React.useState<boolean>(false)\n\n\treturn (\n\t\t<DropdownMenu.Group>\n\t\t\t{(() => {\n\t\t\t\tif (error) throw Error('oh no!')\n\t\t\t})()}\n\t\t\t<DropdownMenu.Item\n\t\t\t\tonClick={() => {\n\t\t\t\t\tsetError(true)\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<span>Throw Error</span>\n\t\t\t</DropdownMenu.Item>\n\t\t\t<DropdownMenu.Item\n\t\t\t\tonClick={() => {\n\t\t\t\t\taddToast({\n\t\t\t\t\t\tid: uniqueId(),\n\t\t\t\t\t\ttitle: 'Something happened',\n\t\t\t\t\t\tdescription: 'Hey, attend to this thing over here. It might be important!',\n\t\t\t\t\t\t// icon?: string\n\t\t\t\t\t\t// title?: string\n\t\t\t\t\t\t// description?: string\n\t\t\t\t\t\t// actions?: TLToastAction[]\n\t\t\t\t\t})\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<span>Show Toast</span>\n\t\t\t</DropdownMenu.Item>\n\n\t\t\t<DropdownMenu.Item\n\t\t\t\tonClick={() => {\n\t\t\t\t\taddDialog({\n\t\t\t\t\t\tcomponent: ({ onClose }) => (\n\t\t\t\t\t\t\t<ExampleDialog\n\t\t\t\t\t\t\t\tonCancel={() => {\n\t\t\t\t\t\t\t\t\tonClose()\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\tonContinue={() => {\n\t\t\t\t\t\t\t\t\tonClose()\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t),\n\t\t\t\t\t\tonClose: () => {\n\t\t\t\t\t\t\tvoid null\n\t\t\t\t\t\t},\n\t\t\t\t\t})\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\tShow Dialog\n\t\t\t</DropdownMenu.Item>\n\n\t\t\t<DropdownMenu.Item\n\t\t\t\tonClick={() => {\n\t\t\t\t\tapp.updateUserDocumentSettings({ isReadOnly: !app.isReadOnly })\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<span>Toggle Read Only</span>\n\t\t\t</DropdownMenu.Item>\n\t\t\t<DropdownMenu.Item\n\t\t\t\tonClick={() => {\n\t\t\t\t\tdebugFlags.peopleMenu.set(!debugFlags.peopleMenu.value)\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<span>Toggle People Menu</span>\n\t\t\t</DropdownMenu.Item>\n\t\t\t<DropdownMenu.Item\n\t\t\t\tlabel=\"debug-menu.hard-reset\"\n\t\t\t\tonClick={() => {\n\t\t\t\t\t;(window as any).__tldraw__hardReset()\n\t\t\t\t}}\n\t\t\t/>\n\t\t\t<DropdownMenu.Item label=\"debug-menu.create-shapes\" onClick={() => createNShapes(app, 100)} />\n\t\t\t<DropdownMenu.Item\n\t\t\t\tonClick={() => {\n\t\t\t\t\tfunction countDescendants({ children }: HTMLElement) {\n\t\t\t\t\t\tlet count = 0\n\t\t\t\t\t\tif (!children.length) return 0\n\t\t\t\t\t\tfor (const el of [...(children as any)]) {\n\t\t\t\t\t\t\tcount++\n\t\t\t\t\t\t\tcount += countDescendants(el)\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn count\n\t\t\t\t\t}\n\n\t\t\t\t\tconst { selectedShapes } = app\n\n\t\t\t\t\tconst shapes = selectedShapes.length === 0 ? app.renderingShapes : selectedShapes\n\n\t\t\t\t\tconst elms = shapes.map(\n\t\t\t\t\t\t(shape) => (document.getElementById(shape.id) as HTMLElement)!.parentElement!\n\t\t\t\t\t)\n\n\t\t\t\t\tlet descendants = elms.length\n\n\t\t\t\t\tfor (const elm of elms) {\n\t\t\t\t\t\tdescendants += countDescendants(elm)\n\t\t\t\t\t}\n\n\t\t\t\t\twindow.alert(`Shapes ${shapes.length}, DOM nodes:${descendants}`)\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<span>Count Shapes and Nodes</span>\n\t\t\t</DropdownMenu.Item>\n\t\t\t{renderDebugMenuItems?.()}\n\t\t</DropdownMenu.Group>\n\t)\n}\n\nfunction ExampleDialog({ onCancel, onContinue }: { onCancel: () => void; onContinue: () => void }) {\n\tconst [dontShowAgain, setDontShowAgain] = React.useState(false)\n\n\treturn (\n\t\t<>\n\t\t\t<Dialog.Header>\n\t\t\t\t<Dialog.Title>Hello</Dialog.Title>\n\t\t\t\t<Dialog.CloseButton />\n\t\t\t</Dialog.Header>\n\t\t\t<Dialog.Body style={{ maxWidth: 350 }}>Hello Hello Hello</Dialog.Body>\n\t\t\t<Dialog.Footer className=\"tlui-dialog__footer__actions\">\n\t\t\t\t<Button\n\t\t\t\t\tonClick={() => setDontShowAgain(!dontShowAgain)}\n\t\t\t\t\ticonLeft={dontShowAgain ? 'checkbox-checked' : 'checkbox-empty'}\n\t\t\t\t\tstyle={{ marginRight: 'auto' }}\n\t\t\t\t>\n\t\t\t\t\t{`Don't show again`}\n\t\t\t\t</Button>\n\t\t\t\t<Button onClick={onCancel}>Cancel</Button>\n\t\t\t\t<Button\n\t\t\t\t\ttype=\"primary\"\n\t\t\t\t\tonClick={async () => {\n\t\t\t\t\t\tonContinue()\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\tContinue\n\t\t\t\t</Button>\n\t\t\t</Dialog.Footer>\n\t\t</>\n\t)\n}\n","import { useApp } from '@tldraw/editor'\nimport * as React from 'react'\nimport { track } from 'signia-react'\n\n/** @public */\nexport const HTMLCanvas = track(function HTMLCanvas() {\n\tconst app = useApp()\n\tconst rCanvas = React.useRef<HTMLCanvasElement>(null)\n\n\tconst camera = app.camera\n\tconst shapes = app.shapesArray\n\tif (rCanvas.current) {\n\t\tconst cvs = rCanvas.current\n\t\tconst ctx = cvs.getContext('2d')!\n\t\tctx.resetTransform()\n\t\tctx.clearRect(0, 0, cvs.width, cvs.height)\n\n\t\tconst path = new Path2D()\n\n\t\tctx.translate(camera.x, camera.y)\n\n\t\tfor (const shape of shapes) {\n\t\t\tconst bounds = app.getPageBounds(shape)!\n\t\t\tpath.rect(bounds.minX, bounds.minY, bounds.width, bounds.height)\n\t\t}\n\n\t\tctx.fillStyle = '#cccccc'\n\t\tctx.fill(path)\n\n\t\tfor (const shape of shapes) {\n\t\t\tctx.save()\n\t\t\tconst corners = app.getPageCorners(shape)\n\t\t\tcorners.forEach((corner) => dot(ctx, corner.x, corner.y, 'red'))\n\t\t\tctx.restore()\n\t\t}\n\t}\n\n\treturn (\n\t\t<canvas\n\t\t\tref={rCanvas}\n\t\t\twidth={app.viewportScreenBounds.width}\n\t\t\theight={app.viewportScreenBounds.height}\n\t\t\tstyle={{ width: '100%', height: '100%' }}\n\t\t/>\n\t)\n})\n\nfunction dot(ctx: CanvasRenderingContext2D, x: number, y: number, color = '#000') {\n\tctx.save()\n\tctx.beginPath()\n\tctx.ellipse(x, y, 4, 4, 0, 0, Math.PI * 2)\n\tctx.fillStyle = color\n\tctx.fill()\n\tctx.restore()\n}\n","import { useApp } from '@tldraw/editor'\nimport { useCallback } from 'react'\nimport { TLTranslationLocale, useLanguages } from '../../hooks'\nimport * as D from '../primitives/DropdownMenu'\n\nexport function LanguageMenu() {\n\tconst app = useApp()\n\tconst { languages, currentLanguage } = useLanguages()\n\n\tconst handleLanguageSelect = useCallback(\n\t\t(locale: TLTranslationLocale) => {\n\t\t\tapp.updateUser({ locale })\n\t\t},\n\t\t[app]\n\t)\n\n\treturn (\n\t\t<D.Sub id=\"help menu language\">\n\t\t\t<D.SubTrigger label=\"menu.language\" data-direction=\"left\" />\n\t\t\t<D.SubContent sideOffset={-4}>\n\t\t\t\t<D.Group>\n\t\t\t\t\t{languages.map(({ locale, label }) => (\n\t\t\t\t\t\t<D.RadioItem\n\t\t\t\t\t\t\tkey={locale}\n\t\t\t\t\t\t\ttitle={locale}\n\t\t\t\t\t\t\tchecked={locale === currentLanguage}\n\t\t\t\t\t\t\tonSelect={() => handleLanguageSelect(locale)}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<span>{label}</span>\n\t\t\t\t\t\t</D.RadioItem>\n\t\t\t\t\t))}\n\t\t\t\t</D.Group>\n\t\t\t\t{/* <DropdownMenu.Group>\n\t\t\t\t\t<Button label=\"translation-link\" icon=\"external\" />\n\t\t\t\t</DropdownMenu.Group> */}\n\t\t\t</D.SubContent>\n\t\t</D.Sub>\n\t)\n}\n","import { Content, Portal, Root, Trigger } from '@radix-ui/react-dropdown-menu'\nimport { useContainer } from '@tldraw/editor'\nimport * as React from 'react'\nimport {\n\tMenuChild,\n\tTLTranslationKey,\n\tuseHelpMenuSchema,\n\tuseMenuIsOpen,\n\tuseReadonly,\n\tuseTranslation,\n} from '../../hooks'\nimport { TLUiIconType } from '../../icon-types'\nimport { LanguageMenu } from '../LanguageMenu'\nimport { Icon } from '../primitives'\nimport * as M from '../primitives/DropdownMenu'\n\ninterface HelpMenuLink {\n\tlabel: TLTranslationKey\n\ticon: TLUiIconType\n\turl: string\n}\n\n/** @public */\nexport interface HelpMenuProps {\n\tlinks?: HelpMenuLink[]\n}\n\n/** @public */\nexport const HelpMenu = React.memo(function HelpMenu() {\n\tconst container = useContainer()\n\tconst msg = useTranslation()\n\tconst onOpenChange = useMenuIsOpen('help menu')\n\n\treturn (\n\t\t<div className=\"tlui-help-menu\">\n\t\t\t<Root dir=\"ltr\" onOpenChange={onOpenChange} modal={false}>\n\t\t\t\t<Trigger\n\t\t\t\t\tclassName=\"tlui-button tlui-help-menu__button\"\n\t\t\t\t\tdir=\"ltr\"\n\t\t\t\t\ttitle={msg('help-menu.title')}\n\t\t\t\t>\n\t\t\t\t\t<Icon icon=\"question-mark\" />\n\t\t\t\t</Trigger>\n\t\t\t\t<Portal container={container} dir=\"ltr\">\n\t\t\t\t\t<Content\n\t\t\t\t\t\tclassName=\"tlui-menu\"\n\t\t\t\t\t\tside=\"top\"\n\t\t\t\t\t\tsideOffset={8}\n\t\t\t\t\t\talign=\"end\"\n\t\t\t\t\t\talignOffset={0}\n\t\t\t\t\t\tcollisionPadding={4}\n\t\t\t\t\t>\n\t\t\t\t\t\t<HelpMenuContent />\n\t\t\t\t\t</Content>\n\t\t\t\t</Portal>\n\t\t\t</Root>\n\t\t</div>\n\t)\n})\n\nfunction HelpMenuContent() {\n\tconst menuSchema = useHelpMenuSchema()\n\n\tconst isReadonly = useReadonly()\n\n\tfunction getHelpMenuItem(item: MenuChild) {\n\t\tif (isReadonly && !item.readonlyOk) return null\n\n\t\tswitch (item.type) {\n\t\t\tcase 'custom': {\n\t\t\t\tif (item.id === 'LANGUAGE_MENU') {\n\t\t\t\t\treturn <LanguageMenu key=\"item\" />\n\t\t\t\t}\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tcase 'group': {\n\t\t\t\treturn (\n\t\t\t\t\t<M.Group size=\"small\" key={item.id}>\n\t\t\t\t\t\t{item.children.map(getHelpMenuItem)}\n\t\t\t\t\t</M.Group>\n\t\t\t\t)\n\t\t\t}\n\t\t\tcase 'submenu': {\n\t\t\t\treturn (\n\t\t\t\t\t<M.Sub id={`help menu ${item.id}`} key={item.id}>\n\t\t\t\t\t\t<M.SubTrigger label={item.label} />\n\t\t\t\t\t\t<M.SubContent>{item.children.map(getHelpMenuItem)}</M.SubContent>\n\t\t\t\t\t</M.Sub>\n\t\t\t\t)\n\t\t\t}\n\t\t\tcase 'item': {\n\t\t\t\tconst { id, kbd, label, onSelect, icon } = item.actionItem\n\t\t\t\treturn <M.Item key={id} kbd={kbd} label={label} onClick={onSelect} iconLeft={icon} />\n\t\t\t}\n\t\t}\n\t}\n\n\treturn <>{menuSchema.map(getHelpMenuItem)}</>\n}\n","import { App, TLShapeId, TLUserPresence, uniqueId } from '@tldraw/editor'\nimport { Box2d, PI2, Vec2d, clamp } from '@tldraw/primitives'\n\nexport class MinimapManager {\n\tconstructor(public app: App, private dpr: number) {}\n\n\tcolors = {\n\t\tshapeFill: 'rgba(144, 144, 144, .1)',\n\t\tselectFill: '#2f80ed',\n\t\tviewportFill: 'rgba(144, 144, 144, .1)',\n\t}\n\n\tid = uniqueId()\n\tcvs: HTMLCanvasElement | null = null\n\tpageBounds: (Box2d & { id: TLShapeId })[] = []\n\tcollaborators: TLUserPresence[] = []\n\n\tcanvasScreenBounds = new Box2d()\n\tcanvasPageBounds = new Box2d()\n\n\tcontentPageBounds = new Box2d()\n\tcontentScreenBounds = new Box2d()\n\n\toriginPagePoint = new Vec2d()\n\toriginPageCenter = new Vec2d()\n\n\tisInViewport = false\n\n\tdebug = false\n\n\tsetDpr(dpr: number) {\n\t\tthis.dpr = +dpr.toFixed(2)\n\t}\n\n\tupdateContentScreenBounds = () => {\n\t\tconst { contentScreenBounds, contentPageBounds: content, canvasScreenBounds: canvas } = this\n\n\t\tlet { x, y, w, h } = contentScreenBounds\n\n\t\tif (content.w > content.h) {\n\t\t\tconst sh = canvas.w / (content.w / content.h)\n\t\t\tif (sh > canvas.h) {\n\t\t\t\tx = (canvas.w - canvas.w * (canvas.h / sh)) / 2\n\t\t\t\ty = 0\n\t\t\t\tw = canvas.w * (canvas.h / sh)\n\t\t\t\th = canvas.h\n\t\t\t} else {\n\t\t\t\tx = 0\n\t\t\t\ty = (canvas.h - sh) / 2\n\t\t\t\tw = canvas.w\n\t\t\t\th = sh\n\t\t\t}\n\t\t} else if (content.w < content.h) {\n\t\t\tconst sw = canvas.h / (content.h / content.w)\n\t\t\tx = (canvas.w - sw) / 2\n\t\t\ty = 0\n\t\t\tw = sw\n\t\t\th = canvas.h\n\t\t} else {\n\t\t\tx = canvas.h / 2\n\t\t\ty = 0\n\t\t\tw = canvas.h\n\t\t\th = canvas.h\n\t\t}\n\n\t\tcontentScreenBounds.set(x, y, w, h)\n\t}\n\n\t/**\n\t * Get the canvas's true bounds converted to page bounds.\n\t */\n\tupdateCanvasPageBounds = () => {\n\t\tconst { canvasPageBounds, canvasScreenBounds, contentPageBounds, contentScreenBounds } = this\n\n\t\tcanvasPageBounds.set(\n\t\t\t0,\n\t\t\t0,\n\t\t\tcontentPageBounds.width / (contentScreenBounds.width / canvasScreenBounds.width),\n\t\t\tcontentPageBounds.height / (contentScreenBounds.height / canvasScreenBounds.height)\n\t\t)\n\n\t\tcanvasPageBounds.center = contentPageBounds.center\n\t}\n\n\tgetScreenPoint = (x: number, y: number) => {\n\t\tconst { canvasScreenBounds } = this\n\n\t\tconst screenX = (x - canvasScreenBounds.minX) * this.dpr\n\t\tconst screenY = (y - canvasScreenBounds.minY) * this.dpr\n\n\t\treturn { x: screenX, y: screenY }\n\t}\n\n\tgetPagePoint = (x: number, y: number) => {\n\t\tconst { contentPageBounds, contentScreenBounds, canvasPageBounds } = this\n\n\t\tconst { x: screenX, y: screenY } = this.getScreenPoint(x, y)\n\n\t\treturn {\n\t\t\tx: canvasPageBounds.minX + (screenX * contentPageBounds.width) / contentScreenBounds.width,\n\t\t\ty: canvasPageBounds.minY + (screenY * contentPageBounds.height) / contentScreenBounds.height,\n\t\t\tz: 1,\n\t\t}\n\t}\n\n\tminimapScreenPointToPagePoint = (\n\t\tx: number,\n\t\ty: number,\n\t\tshiftKey = false,\n\t\tclampToBounds = false\n\t) => {\n\t\tconst { app } = this\n\t\tconst { viewportPageBounds } = app\n\n\t\tlet { x: px, y: py } = this.getPagePoint(x, y)\n\n\t\tif (clampToBounds) {\n\t\t\tconst shapesPageBounds = this.app.allShapesCommonBounds\n\t\t\tconst vpPageBounds = viewportPageBounds\n\n\t\t\tconst minX = (shapesPageBounds?.minX ?? 0) - vpPageBounds.width / 2\n\t\t\tconst maxX = (shapesPageBounds?.maxX ?? 0) + vpPageBounds.width / 2\n\t\t\tconst minY = (shapesPageBounds?.minY ?? 0) - vpPageBounds.height / 2\n\t\t\tconst maxY = (shapesPageBounds?.maxY ?? 0) + vpPageBounds.height / 2\n\n\t\t\tconst lx = Math.max(0, minX + vpPageBounds.width - px)\n\t\t\tconst rx = Math.max(0, -(maxX - vpPageBounds.width - px))\n\t\t\tconst ly = Math.max(0, minY + vpPageBounds.height - py)\n\t\t\tconst ry = Math.max(0, -(maxY - vpPageBounds.height - py))\n\n\t\t\tconst ql = Math.max(0, lx - rx)\n\t\t\tconst qr = Math.max(0, rx - lx)\n\t\t\tconst qt = Math.max(0, ly - ry)\n\t\t\tconst qb = Math.max(0, ry - ly)\n\n\t\t\tif (ql && ql > qr) {\n\t\t\t\tpx += ql / 2\n\t\t\t} else if (qr) {\n\t\t\t\tpx -= qr / 2\n\t\t\t}\n\n\t\t\tif (qt && qt > qb) {\n\t\t\t\tpy += qt / 2\n\t\t\t} else if (qb) {\n\t\t\t\tpy -= qb / 2\n\t\t\t}\n\n\t\t\tpx = clamp(px, minX, maxX)\n\t\t\tpy = clamp(py, minY, maxY)\n\t\t}\n\n\t\tif (shiftKey) {\n\t\t\tconst { originPagePoint } = this\n\t\t\tconst dx = Math.abs(px - originPagePoint.x)\n\t\t\tconst dy = Math.abs(py - originPagePoint.y)\n\t\t\tif (dx > dy) {\n\t\t\t\tpy = originPagePoint.y\n\t\t\t} else {\n\t\t\t\tpx = originPagePoint.x\n\t\t\t}\n\t\t}\n\n\t\treturn { x: px, y: py }\n\t}\n\n\trender = () => {\n\t\tconst { cvs, pageBounds } = this\n\t\tthis.updateCanvasPageBounds()\n\n\t\tconst { app, canvasScreenBounds, canvasPageBounds, contentPageBounds, contentScreenBounds } =\n\t\t\tthis\n\t\tconst { width: cw, height: ch } = canvasScreenBounds\n\t\tconst { viewportPageBounds, selectedIds } = app\n\n\t\tif (!cvs || !pageBounds) {\n\t\t\treturn\n\t\t}\n\n\t\tconst ctx = cvs.getContext('2d')!\n\n\t\tif (!ctx) {\n\t\t\tthrow new Error('Minimap (shapes): Could not get context')\n\t\t}\n\n\t\tctx.resetTransform()\n\t\tctx.globalAlpha = 1\n\t\tctx.clearRect(0, 0, cw, ch)\n\n\t\t// Transform canvas\n\n\t\tconst sx = contentScreenBounds.width / contentPageBounds.width\n\t\tconst sy = contentScreenBounds.height / contentPageBounds.height\n\n\t\tctx.translate((cw - contentScreenBounds.width) / 2, (ch - contentScreenBounds.height) / 2)\n\t\tctx.scale(sx, sy)\n\t\tctx.translate(-contentPageBounds.minX, -contentPageBounds.minY)\n\n\t\t// Default radius for rounded rects\n\t\tconst rx = 8 / sx\n\t\tconst ry = 8 / sx\n\t\t// Min radius\n\t\tconst ax = 1 / sx\n\t\tconst ay = 1 / sx\n\t\t// Max radius factor\n\t\tconst bx = rx / 4\n\t\tconst by = ry / 4\n\n\t\t// shapes\n\n\t\tconst shapesPath = new Path2D()\n\t\tconst selectedPath = new Path2D()\n\n\t\tconst { shapeFill, selectFill, viewportFill } = this.colors\n\n\t\t// When there are many shapes, don't draw rounded rectangles;\n\t\t// consider using the shape's size instead.\n\n\t\tlet pb: Box2d & { id: TLShapeId }\n\t\tfor (let i = 0, n = pageBounds.length; i < n; i++) {\n\t\t\tpb = pageBounds[i]\n\t\t\tMinimapManager.roundedRect(\n\t\t\t\tselectedIds.includes(pb.id) ? selectedPath : shapesPath,\n\t\t\t\tpb.minX,\n\t\t\t\tpb.minY,\n\t\t\t\tpb.width,\n\t\t\t\tpb.height,\n\t\t\t\tclamp(rx, ax, pb.width / bx),\n\t\t\t\tclamp(ry, ay, pb.height / by)\n\t\t\t)\n\t\t}\n\t\t// Fill the shapes paths\n\t\tctx.fillStyle = shapeFill\n\t\tctx.fill(shapesPath)\n\n\t\t// Fill the selected paths\n\t\tctx.fillStyle = selectFill\n\t\tctx.fill(selectedPath)\n\n\t\tif (this.debug) {\n\t\t\t// Page bounds\n\t\t\tconst commonBounds = Box2d.Common(pageBounds)\n\t\t\tconst { minX, minY, width, height } = commonBounds\n\t\t\tctx.strokeStyle = 'green'\n\t\t\tctx.lineWidth = 2 / sx\n\t\t\tctx.strokeRect(minX + 1 / sx, minY + 1 / sy, width - 2 / sx, height - 2 / sy)\n\t\t}\n\n\t\t// Brush\n\t\t{\n\t\t\tconst { brush } = app\n\t\t\tif (brush) {\n\t\t\t\tconst { x, y, w, h } = brush\n\t\t\t\tctx.beginPath()\n\t\t\t\tMinimapManager.sharpRect(ctx, x, y, w, h)\n\t\t\t\tctx.closePath()\n\t\t\t\tctx.fillStyle = viewportFill\n\t\t\t\tctx.fill()\n\t\t\t}\n\t\t}\n\n\t\t// Viewport\n\t\t{\n\t\t\tconst { minX, minY, width, height } = viewportPageBounds\n\n\t\t\tctx.beginPath()\n\n\t\t\tconst rx = 12 / sx\n\t\t\tconst ry = 12 / sx\n\t\t\tMinimapManager.roundedRect(\n\t\t\t\tctx,\n\t\t\t\tminX,\n\t\t\t\tminY,\n\t\t\t\twidth,\n\t\t\t\theight,\n\t\t\t\tMath.min(width / 4, rx),\n\t\t\t\tMath.min(height / 4, ry)\n\t\t\t)\n\t\t\tctx.closePath()\n\t\t\tctx.fillStyle = viewportFill\n\t\t\tctx.fill()\n\n\t\t\tif (this.debug) {\n\t\t\t\tctx.strokeStyle = 'orange'\n\t\t\t\tctx.strokeRect(minX + 1 / sx, minY + 1 / sy, width - 2 / sx, height - 2 / sy)\n\t\t\t}\n\t\t}\n\n\t\t// Show collaborator cursors\n\n\t\t// Padding for canvas bounds edges\n\t\tconst px = 2.5 / sx\n\t\tconst py = 2.5 / sy\n\n\t\tconst { currentPageId } = app\n\n\t\tlet collaborator: TLUserPresence\n\t\tfor (let i = 0; i < this.collaborators.length; i++) {\n\t\t\tcollaborator = this.collaborators[i]\n\t\t\tconst instance = collaborator.lastUsedInstanceId\n\t\t\t\t? app.store.get(collaborator.lastUsedInstanceId)\n\t\t\t\t: null\n\t\t\tif (instance?.currentPageId !== currentPageId) {\n\t\t\t\tcontinue\n\t\t\t}\n\n\t\t\tctx.beginPath()\n\t\t\tctx.ellipse(\n\t\t\t\tclamp(collaborator.cursor.x, canvasPageBounds.minX + px, canvasPageBounds.maxX - px),\n\t\t\t\tclamp(collaborator.cursor.y, canvasPageBounds.minY + py, canvasPageBounds.maxY - py),\n\t\t\t\t5 / sx,\n\t\t\t\t5 / sy,\n\t\t\t\t0,\n\t\t\t\t0,\n\t\t\t\tPI2\n\t\t\t)\n\t\t\tctx.fillStyle = collaborator.color\n\t\t\tctx.fill()\n\t\t}\n\n\t\tif (this.debug) {\n\t\t\tctx.lineWidth = 2 / sx\n\n\t\t\t{\n\t\t\t\t// Minimap Bounds\n\t\t\t\tconst { minX, minY, width, height } = contentPageBounds\n\t\t\t\tctx.strokeStyle = 'red'\n\t\t\t\tctx.strokeRect(minX + 1 / sx, minY + 1 / sy, width - 2 / sx, height - 2 / sy)\n\t\t\t}\n\n\t\t\t{\n\t\t\t\t// Canvas Bounds\n\t\t\t\tconst { minX, minY, width, height } = canvasPageBounds\n\t\t\t\tctx.strokeStyle = 'blue'\n\t\t\t\tctx.strokeRect(minX + 1 / sx, minY + 1 / sy, width - 2 / sx, height - 2 / sy)\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic roundedRect(\n\t\tctx: CanvasRenderingContext2D | Path2D,\n\t\tx: number,\n\t\ty: number,\n\t\twidth: number,\n\t\theight: number,\n\t\trx: number,\n\t\try: number\n\t) {\n\t\tif (rx < 1 && ry < 1) {\n\t\t\tctx.rect(x, y, width, height)\n\t\t\treturn\n\t\t}\n\n\t\tctx.moveTo(x + rx, y)\n\t\tctx.lineTo(x + width - rx, y)\n\t\tctx.quadraticCurveTo(x + width, y, x + width, y + ry)\n\t\tctx.lineTo(x + width, y + height - ry)\n\t\tctx.quadraticCurveTo(x + width, y + height, x + width - rx, y + height)\n\t\tctx.lineTo(x + rx, y + height)\n\t\tctx.quadraticCurveTo(x, y + height, x, y + height - ry)\n\t\tctx.lineTo(x, y + ry)\n\t\tctx.quadraticCurveTo(x, y, x + rx, y)\n\t}\n\n\tstatic sharpRect(\n\t\tctx: CanvasRenderingContext2D | Path2D,\n\t\tx: number,\n\t\ty: number,\n\t\twidth: number,\n\t\theight: number,\n\t\t_rx?: number,\n\t\t_ry?: number\n\t) {\n\t\tctx.rect(x, y, width, height)\n\t}\n}\n","import {\n\tANIMATION_MEDIUM_MS,\n\tnormalizeWheel,\n\tTLPointerEventInfo,\n\tTLShapeId,\n\tuseApp,\n\tuseContainer,\n\tuseQuickReactor,\n} from '@tldraw/editor'\nimport { Box2d, intersectPolygonPolygon, Vec2d } from '@tldraw/primitives'\nimport * as React from 'react'\nimport { track, useAtom } from 'signia-react'\nimport { MinimapManager } from './MinimapManager'\n\nexport interface MinimapProps {\n\tshapeFill: string\n\tselectFill: string\n\tviewportFill: string\n}\n\nconst COLLABORATOR_INACTIVITY_TIMEOUT = 10000\n\nexport const useActivePresences = () => {\n\tconst app = useApp()\n\tconst time = useAtom('time', Date.now())\n\n\tReact.useEffect(() => {\n\t\tconst interval = setInterval(() => time.set(Date.now()), 1000 * 5)\n\t\treturn () => clearInterval(interval)\n\t}, [time])\n\treturn React.useMemo(\n\t\t() =>\n\t\t\tapp.store.query.records('user_presence', () => ({\n\t\t\t\tlastActivityTimestamp: { gt: time.value - COLLABORATOR_INACTIVITY_TIMEOUT },\n\t\t\t\tuserId: { neq: app.userId },\n\t\t\t})),\n\t\t[app, time]\n\t)\n}\n\nexport const Minimap = track(function Minimap({\n\tshapeFill,\n\tselectFill,\n\tviewportFill,\n}: MinimapProps) {\n\tconst app = useApp()\n\n\tconst rCanvas = React.useRef<HTMLCanvasElement>(null!)\n\n\tconst container = useContainer()\n\n\tconst rPointing = React.useRef(false)\n\n\tconst minimap = React.useMemo(() => new MinimapManager(app, app.devicePixelRatio), [app])\n\n\tconst isDarkMode = app.userDocumentSettings.isDarkMode\n\n\tReact.useEffect(() => {\n\t\t// Must check after render\n\t\tconst raf = requestAnimationFrame(() => {\n\t\t\tconst style = getComputedStyle(container)\n\n\t\t\tminimap.colors = {\n\t\t\t\tshapeFill: style.getPropertyValue(shapeFill).trim(),\n\t\t\t\tselectFill: style.getPropertyValue(selectFill).trim(),\n\t\t\t\tviewportFill: style.getPropertyValue(viewportFill).trim(),\n\t\t\t}\n\n\t\t\tminimap.render()\n\t\t})\n\t\treturn () => {\n\t\t\tcancelAnimationFrame(raf)\n\t\t}\n\t}, [container, selectFill, shapeFill, viewportFill, minimap, isDarkMode])\n\n\tconst onDoubleClick = React.useCallback(\n\t\t(e: React.MouseEvent<HTMLCanvasElement>) => {\n\t\t\tif (!app.shapeIds.size) return\n\n\t\t\tconst { x, y } = minimap.minimapScreenPointToPagePoint(e.clientX, e.clientY, false, false)\n\n\t\t\tconst clampedPoint = minimap.minimapScreenPointToPagePoint(e.clientX, e.clientY, false, true)\n\n\t\t\tminimap.originPagePoint.setTo(clampedPoint)\n\t\t\tminimap.originPageCenter.setTo(app.viewportPageBounds.center)\n\n\t\t\tapp.centerOnPoint(x, y, { duration: ANIMATION_MEDIUM_MS })\n\t\t},\n\t\t[app, minimap]\n\t)\n\n\tconst onPointerDown = React.useCallback(\n\t\t(e: React.PointerEvent<HTMLCanvasElement>) => {\n\t\t\te.currentTarget.setPointerCapture(e.pointerId)\n\t\t\tif (!app.shapeIds.size) return\n\n\t\t\trPointing.current = true\n\n\t\t\tminimap.isInViewport = false\n\n\t\t\tconst { x, y } = minimap.minimapScreenPointToPagePoint(e.clientX, e.clientY, false, false)\n\n\t\t\tconst clampedPoint = minimap.minimapScreenPointToPagePoint(e.clientX, e.clientY, false, true)\n\n\t\t\tconst _vpPageBounds = app.viewportPageBounds\n\n\t\t\tminimap.originPagePoint.setTo(clampedPoint)\n\t\t\tminimap.originPageCenter.setTo(_vpPageBounds.center)\n\n\t\t\tminimap.isInViewport = _vpPageBounds.containsPoint(clampedPoint)\n\n\t\t\tif (!minimap.isInViewport) {\n\t\t\t\tapp.centerOnPoint(x, y, { duration: ANIMATION_MEDIUM_MS })\n\t\t\t}\n\t\t},\n\t\t[app, minimap]\n\t)\n\n\tconst onPointerMove = React.useCallback(\n\t\t(e: React.PointerEvent<HTMLCanvasElement>) => {\n\t\t\tif (rPointing.current) {\n\t\t\t\tconst { x, y } = minimap.minimapScreenPointToPagePoint(\n\t\t\t\t\te.clientX,\n\t\t\t\t\te.clientY,\n\t\t\t\t\te.shiftKey,\n\t\t\t\t\ttrue\n\t\t\t\t)\n\n\t\t\t\tif (minimap.isInViewport) {\n\t\t\t\t\tconst delta = Vec2d.Sub({ x, y }, minimap.originPagePoint)\n\t\t\t\t\tconst center = Vec2d.Add(minimap.originPageCenter, delta)\n\t\t\t\t\tapp.centerOnPoint(center.x, center.y)\n\t\t\t\t\treturn\n\t\t\t\t}\n\n\t\t\t\tapp.centerOnPoint(x, y)\n\t\t\t}\n\n\t\t\tconst pagePoint = minimap.getPagePoint(e.clientX, e.clientY)\n\n\t\t\tconst screenPoint = app.pageToScreen(pagePoint.x, pagePoint.y)\n\n\t\t\tconst info: TLPointerEventInfo = {\n\t\t\t\ttype: 'pointer',\n\t\t\t\ttarget: 'canvas',\n\t\t\t\tname: 'pointer_move',\n\t\t\t\t...getPointerInfo(e),\n\t\t\t\tpoint: screenPoint,\n\t\t\t\tisPen: app.isPenMode,\n\t\t\t}\n\n\t\t\tapp.dispatch(info)\n\t\t},\n\t\t[app, minimap]\n\t)\n\n\tconst onPointerUp = React.useCallback((_e: React.PointerEvent<HTMLCanvasElement>) => {\n\t\trPointing.current = false\n\t}, [])\n\n\tconst onWheel = React.useCallback(\n\t\t(e: React.WheelEvent<HTMLCanvasElement>) => {\n\t\t\tconst offset = normalizeWheel(e)\n\n\t\t\tapp.dispatch({\n\t\t\t\ttype: 'wheel',\n\t\t\t\tname: 'wheel',\n\t\t\t\tdelta: offset,\n\t\t\t\tshiftKey: e.shiftKey,\n\t\t\t\taltKey: e.altKey,\n\t\t\t\tctrlKey: e.metaKey || e.ctrlKey,\n\t\t\t})\n\t\t},\n\t\t[app]\n\t)\n\n\t// Update the minimap's dpr when the dpr changes\n\tuseQuickReactor(\n\t\t'update dpr',\n\t\t() => {\n\t\t\tconst { devicePixelRatio } = app\n\t\t\tminimap.setDpr(devicePixelRatio)\n\n\t\t\tconst canvas = rCanvas.current as HTMLCanvasElement\n\t\t\tconst rect = canvas.getBoundingClientRect()\n\t\t\tconst width = rect.width * devicePixelRatio\n\t\t\tconst height = rect.height * devicePixelRatio\n\n\t\t\t// These must happen in order\n\t\t\tcanvas.width = width\n\t\t\tcanvas.height = height\n\t\t\tminimap.canvasScreenBounds.set(rect.x, rect.y, width, height)\n\n\t\t\tminimap.cvs = rCanvas.current\n\t\t},\n\t\t[app, minimap]\n\t)\n\n\tconst presences = useActivePresences()\n\n\tuseQuickReactor(\n\t\t'minimap render when pagebounds or collaborators changes',\n\t\t() => {\n\t\t\tconst { devicePixelRatio, viewportPageBounds, allShapesCommonBounds } = app\n\n\t\t\tdevicePixelRatio // dereference dpr so that it renders then, too\n\n\t\t\tminimap.contentPageBounds = allShapesCommonBounds\n\t\t\t\t? Box2d.Expand(allShapesCommonBounds, viewportPageBounds)\n\t\t\t\t: viewportPageBounds\n\n\t\t\tminimap.updateContentScreenBounds()\n\n\t\t\t// All shape bounds\n\n\t\t\tconst allShapeBounds = [] as (Box2d & { id: TLShapeId })[]\n\n\t\t\tapp.shapeIds.forEach((id) => {\n\t\t\t\tlet pageBounds = app.getPageBoundsById(id)! as Box2d & { id: TLShapeId }\n\n\t\t\t\tconst pageMask = app.getPageMaskById(id)\n\n\t\t\t\tif (pageMask) {\n\t\t\t\t\tconst intersection = intersectPolygonPolygon(pageMask, pageBounds.corners)\n\t\t\t\t\tif (!intersection) {\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\t\t\t\t\tpageBounds = Box2d.FromPoints(intersection) as Box2d & { id: TLShapeId }\n\t\t\t\t}\n\n\t\t\t\tif (pageBounds) {\n\t\t\t\t\tpageBounds.id = id // kinda dirty but we want to include the id here\n\t\t\t\t\tallShapeBounds.push(pageBounds)\n\t\t\t\t}\n\t\t\t})\n\n\t\t\tminimap.pageBounds = allShapeBounds\n\n\t\t\t// Collaborators\n\n\t\t\tminimap.collaborators = presences.value\n\n\t\t\tminimap.render()\n\t\t},\n\t\t[app, minimap]\n\t)\n\n\treturn (\n\t\t<div className=\"tlui-minimap\">\n\t\t\t<canvas\n\t\t\t\tref={rCanvas}\n\t\t\t\tclassName=\"tlui-minimap__canvas\"\n\t\t\t\tonDoubleClick={onDoubleClick}\n\t\t\t\tonPointerMove={onPointerMove}\n\t\t\t\tonPointerDown={onPointerDown}\n\t\t\t\tonPointerUp={onPointerUp}\n\t\t\t\tonWheel={onWheel}\n\t\t\t/>\n\t\t</div>\n\t)\n})\n\nfunction getPointerInfo(e: React.PointerEvent | PointerEvent) {\n\t;(e as any).isKilled = true\n\n\treturn {\n\t\tpoint: {\n\t\t\tx: e.clientX,\n\t\t\ty: e.clientY,\n\t\t\tz: e.pressure,\n\t\t},\n\t\tshiftKey: e.shiftKey,\n\t\taltKey: e.altKey,\n\t\tctrlKey: e.metaKey || e.ctrlKey,\n\t\tpointerId: e.pointerId,\n\t\tbutton: e.button,\n\t\tisPen: e.pointerType === 'pen',\n\t}\n}\n","import { ANIMATION_MEDIUM_MS, useApp } from '@tldraw/editor'\nimport * as React from 'react'\nimport { track } from 'signia-react'\nimport { useActions, useBreakpoint, useTranslation } from '../../../hooks'\nimport { Button } from '../../primitives'\nimport * as M from '../../primitives/DropdownMenu'\n\nexport const ZoomMenu = track(function ZoomMenu() {\n\tconst app = useApp()\n\tconst msg = useTranslation()\n\tconst breakpoint = useBreakpoint()\n\n\tconst zoom = app.zoomLevel\n\tconst hasShapes = app.shapeIds.size > 0\n\tconst hasSelected = app.selectedIds.length > 0\n\tconst isZoomedTo100 = app.camera.z === 1\n\n\tconst handleDoubleClick = React.useCallback(() => {\n\t\tapp.resetZoom(app.viewportScreenCenter, { duration: ANIMATION_MEDIUM_MS })\n\t}, [app])\n\n\treturn (\n\t\t<M.Root id=\"zoom\">\n\t\t\t<M.Trigger>\n\t\t\t\t<Button\n\t\t\t\t\ttitle={`${msg('navigation-zone.zoom')}`}\n\t\t\t\t\tdata-wd=\"minimap.zoom-menu\"\n\t\t\t\t\tclassName={breakpoint < 5 ? 'tlui-zoom-menu__button' : 'tlui-zoom-menu__button__pct'}\n\t\t\t\t\tonDoubleClick={handleDoubleClick}\n\t\t\t\t\ticon={breakpoint < 4 ? 'zoom-in' : undefined}\n\t\t\t\t>\n\t\t\t\t\t{breakpoint < 4 ? null : (\n\t\t\t\t\t\t<span style={{ flexGrow: 0, textAlign: 'center' }}>{Math.floor(zoom * 100)}%</span>\n\t\t\t\t\t)}\n\t\t\t\t</Button>\n\t\t\t</M.Trigger>\n\t\t\t<M.Content side=\"top\" align=\"start\" alignOffset={0}>\n\t\t\t\t<M.Group>\n\t\t\t\t\t<ZoomMenuItem action=\"zoom-in\" data-wd=\"minimap.zoom-menu.zoom-in\" noClose />\n\t\t\t\t\t<ZoomMenuItem action=\"zoom-out\" data-wd=\"minimap.zoom-menu.zoom-out\" noClose />\n\t\t\t\t\t<ZoomMenuItem\n\t\t\t\t\t\taction=\"zoom-to-100\"\n\t\t\t\t\t\tdata-wd=\"minimap.zoom-menu.zoom-to-100\"\n\t\t\t\t\t\tnoClose\n\t\t\t\t\t\tdisabled={isZoomedTo100}\n\t\t\t\t\t/>\n\t\t\t\t\t<ZoomMenuItem\n\t\t\t\t\t\taction=\"zoom-to-fit\"\n\t\t\t\t\t\tdisabled={!hasShapes}\n\t\t\t\t\t\tdata-wd=\"minimap.zoom-menu.zoom-to-fit\"\n\t\t\t\t\t\tnoClose\n\t\t\t\t\t/>\n\t\t\t\t\t<ZoomMenuItem\n\t\t\t\t\t\taction=\"zoom-to-selection\"\n\t\t\t\t\t\tdisabled={!hasSelected}\n\t\t\t\t\t\tdata-wd=\"minimap.zoom-menu.zoom-to-selection\"\n\t\t\t\t\t\tnoClose\n\t\t\t\t\t/>\n\t\t\t\t</M.Group>\n\t\t\t</M.Content>\n\t\t</M.Root>\n\t)\n})\n\nfunction ZoomMenuItem(props: {\n\taction: string\n\tdisabled?: boolean\n\tnoClose?: boolean\n\t'data-wd'?: string\n}) {\n\tconst { action, disabled = false, noClose = false } = props\n\tconst actions = useActions()\n\n\treturn (\n\t\t<M.Item\n\t\t\tlabel={actions[action].label}\n\t\t\tkbd={actions[action].kbd}\n\t\t\tdata-wd={props['data-wd']}\n\t\t\tonClick={actions[action].onSelect}\n\t\t\tnoClose={noClose}\n\t\t\tdisabled={disabled}\n\t\t/>\n\t)\n}\n","import { memo, useCallback } from 'react'\nimport { useActions, useBreakpoint, useLocalStorageState, useTranslation } from '../../hooks'\nimport { Minimap } from '../NavigationZone/Minimap'\nimport { Button, kbdStr } from '../primitives'\nimport { ZoomMenu } from './ZoomMenu'\n\n/** @public */\nexport const NavigationZone = memo(function NavigationZone() {\n\tconst actions = useActions()\n\tconst msg = useTranslation()\n\tconst breakpoint = useBreakpoint()\n\n\tconst [collapsed, setCollapsed] = useLocalStorageState('minimap', true)\n\n\tconst toggleMinimap = useCallback(() => {\n\t\tsetCollapsed((s) => !s)\n\t}, [setCollapsed])\n\n\tif (breakpoint < 4) {\n\t\treturn null\n\t}\n\n\treturn (\n\t\t<div className=\"tlui-navigation-zone\">\n\t\t\t<div className=\"tlui-navigation-zone__controls\">\n\t\t\t\t{breakpoint < 6 ? (\n\t\t\t\t\t<ZoomMenu />\n\t\t\t\t) : collapsed ? (\n\t\t\t\t\t<>\n\t\t\t\t\t\t<ZoomMenu />\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\ttitle={msg('navigation-zone.toggle-minimap')}\n\t\t\t\t\t\t\tclassName=\"tlui-navigation-zone__toggle\"\n\t\t\t\t\t\t\tdata-wd=\"minimap.toggle\"\n\t\t\t\t\t\t\tonClick={toggleMinimap}\n\t\t\t\t\t\t\ticon={collapsed ? 'chevrons-ne' : 'chevrons-sw'}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</>\n\t\t\t\t) : (\n\t\t\t\t\t<>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\ticon=\"minus\"\n\t\t\t\t\t\t\tdata-wd=\"minimap.zoom-out\"\n\t\t\t\t\t\t\ttitle={`${msg(actions['zoom-out'].label!)} ${kbdStr(actions['zoom-out'].kbd!)}`}\n\t\t\t\t\t\t\tonClick={actions['zoom-out'].onSelect}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<ZoomMenu />\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\ticon=\"plus\"\n\t\t\t\t\t\t\tdata-wd=\"minimap.zoom-in\"\n\t\t\t\t\t\t\ttitle={`${msg(actions['zoom-in'].label!)} ${kbdStr(actions['zoom-in'].kbd!)}`}\n\t\t\t\t\t\t\tonClick={actions['zoom-in'].onSelect}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\ttitle={msg('navigation-zone.toggle-minimap')}\n\t\t\t\t\t\t\tclassName=\"tlui-navigation-zone__toggle\"\n\t\t\t\t\t\t\tonClick={toggleMinimap}\n\t\t\t\t\t\t\ticon={collapsed ? 'chevrons-ne' : 'chevrons-sw'}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</>\n\t\t\t\t)}\n\t\t\t</div>\n\t\t\t{breakpoint >= 6 && !collapsed && (\n\t\t\t\t<Minimap\n\t\t\t\t\tviewportFill=\"--color-muted-1\"\n\t\t\t\t\tselectFill=\"--color-selected\"\n\t\t\t\t\tshapeFill=\"--color-text-3\"\n\t\t\t\t/>\n\t\t\t)}\n\t\t</div>\n\t)\n})\n","import React from 'react'\n\n/** @public */\nexport function useLocalStorageState<T = any>(key: string, defaultValue: T) {\n\tconst [state, setState] = React.useState(defaultValue)\n\n\tReact.useLayoutEffect(() => {\n\t\tconst value = localStorage.getItem(key)\n\t\tif (value) {\n\t\t\ttry {\n\t\t\t\tsetState(JSON.parse(value))\n\t\t\t} catch (e) {\n\t\t\t\tconsole.error(`Could not restore value ${key} from local storage.`)\n\t\t\t}\n\t\t}\n\t}, [key])\n\n\tconst updateValue = React.useCallback(\n\t\t(setter: T | ((value: T) => T)) => {\n\t\t\tsetState((s) => {\n\t\t\t\tconst value = typeof setter === 'function' ? (setter as any)(s) : setter\n\t\t\t\tlocalStorage.setItem(key, JSON.stringify(value))\n\t\t\t\treturn value\n\t\t\t})\n\t\t},\n\t\t[key]\n\t)\n\n\treturn [state, updateValue] as const\n}\n","import { Trigger } from '@radix-ui/react-dropdown-menu'\nimport { App, TLStyleItem, TLStyleType } from '@tldraw/editor'\nimport classNames from 'classnames'\nimport * as React from 'react'\nimport { TLTranslationKey, useTranslation } from '../../../hooks'\nimport { TLUiIconType } from '../../../icon-types'\nimport { Button } from '../../primitives'\nimport * as DropdownMenu from '../../primitives/DropdownMenu'\n\ntype AllStyles = typeof App.styles\n\ninterface DoubleDropdownPickerProps<T extends AllStyles[keyof AllStyles][number]> {\n\tlabel: TLTranslationKey\n\tlabelA: TLTranslationKey\n\tlabelB: TLTranslationKey\n\titemsA: T[]\n\titemsB: T[]\n\tstyleTypeA: TLStyleType\n\tstyleTypeB: TLStyleType\n\tvalueA: T['id'] | null | undefined\n\tvalueB: T['id'] | null | undefined\n\tonValueChange: (value: TLStyleItem, squashing: boolean) => void\n\t'data-wd'?: string\n}\n\nexport const DoubleDropdownPicker = React.memo(function DoubleDropdownPicker<\n\tT extends AllStyles[keyof AllStyles][number]\n>({\n\t'data-wd': dataWd,\n\tlabel,\n\tlabelA,\n\tlabelB,\n\titemsA,\n\titemsB,\n\tstyleTypeA,\n\tstyleTypeB,\n\tvalueA,\n\tvalueB,\n\tonValueChange,\n}: DoubleDropdownPickerProps<T>) {\n\tconst msg = useTranslation()\n\n\tconst iconA = React.useMemo(\n\t\t() => itemsA.find((item) => item.id === valueA)?.icon ?? 'mixed',\n\t\t[itemsA, valueA]\n\t)\n\tconst iconB = React.useMemo(\n\t\t() => itemsB.find((item) => item.id === valueB)?.icon ?? 'mixed',\n\t\t[itemsB, valueB]\n\t)\n\n\tif (valueA === undefined && valueB === undefined) return null\n\n\tconst startWdPrefix = `${dataWd}.start`\n\tconst endWdPrefix = `${dataWd}.end`\n\n\treturn (\n\t\t<div className=\"tlui-style-panel__double-select-picker\">\n\t\t\t<div title={msg(label)} className=\"tlui-style-panel__double-select-picker-label\">\n\t\t\t\t{msg(label)}\n\t\t\t</div>\n\t\t\t<DropdownMenu.Root id={`style panel ${styleTypeA}`}>\n\t\t\t\t<Trigger asChild>\n\t\t\t\t\t<Button\n\t\t\t\t\t\tdata-wd={startWdPrefix}\n\t\t\t\t\t\ttitle={\n\t\t\t\t\t\t\tmsg(labelA) +\n\t\t\t\t\t\t\t'  ' +\n\t\t\t\t\t\t\t(valueA === null\n\t\t\t\t\t\t\t\t? msg('style-panel.mixed')\n\t\t\t\t\t\t\t\t: msg(`${styleTypeA}-style.${valueA}` as TLTranslationKey))\n\t\t\t\t\t\t}\n\t\t\t\t\t\ticon={iconA as any}\n\t\t\t\t\t\tinvertIcon\n\t\t\t\t\t\tsmallIcon\n\t\t\t\t\t/>\n\t\t\t\t</Trigger>\n\t\t\t\t<DropdownMenu.Content side=\"bottom\" align=\"end\" sideOffset={0} alignOffset={-2}>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclassName={classNames('tlui-button-grid', {\n\t\t\t\t\t\t\t'tlui-button-grid__two': itemsA.length < 4,\n\t\t\t\t\t\t\t'tlui-button-grid__four': itemsA.length >= 4,\n\t\t\t\t\t\t})}\n\t\t\t\t\t>\n\t\t\t\t\t\t{itemsA.map((item) => {\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t<DropdownMenu.Item\n\t\t\t\t\t\t\t\t\tclassName=\"tlui-button-grid__button\"\n\t\t\t\t\t\t\t\t\ttitle={\n\t\t\t\t\t\t\t\t\t\tmsg(labelA) + '  ' + msg(`${styleTypeA}-style.${item.id}` as TLTranslationKey)\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tdata-wd={`${startWdPrefix}.${item.id}`}\n\t\t\t\t\t\t\t\t\tkey={item.id}\n\t\t\t\t\t\t\t\t\ticon={item.icon as TLUiIconType}\n\t\t\t\t\t\t\t\t\tonClick={() => onValueChange(item as TLStyleItem, false)}\n\t\t\t\t\t\t\t\t\tinvertIcon\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t})}\n\t\t\t\t\t</div>\n\t\t\t\t</DropdownMenu.Content>\n\t\t\t</DropdownMenu.Root>\n\t\t\t<DropdownMenu.Root id={`style panel ${styleTypeB}`}>\n\t\t\t\t<Trigger asChild>\n\t\t\t\t\t<Button\n\t\t\t\t\t\tdata-wd={endWdPrefix}\n\t\t\t\t\t\ttitle={\n\t\t\t\t\t\t\tmsg(labelB) +\n\t\t\t\t\t\t\t'  ' +\n\t\t\t\t\t\t\t(valueB === null\n\t\t\t\t\t\t\t\t? msg('style-panel.mixed')\n\t\t\t\t\t\t\t\t: msg(`${styleTypeB}-style.${valueB}` as TLTranslationKey))\n\t\t\t\t\t\t}\n\t\t\t\t\t\ticon={iconB as any}\n\t\t\t\t\t\tsmallIcon\n\t\t\t\t\t/>\n\t\t\t\t</Trigger>\n\t\t\t\t<DropdownMenu.Content side=\"bottom\" align=\"end\" sideOffset={0} alignOffset={-2}>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclassName={classNames('tlui-button-grid', {\n\t\t\t\t\t\t\t'tlui-button-grid__two': itemsA.length < 4,\n\t\t\t\t\t\t\t'tlui-button-grid__four': itemsA.length >= 4,\n\t\t\t\t\t\t})}\n\t\t\t\t\t>\n\t\t\t\t\t\t{itemsB.map((item) => {\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t<DropdownMenu.Item\n\t\t\t\t\t\t\t\t\tclassName=\"tlui-button-grid__button\"\n\t\t\t\t\t\t\t\t\ttitle={\n\t\t\t\t\t\t\t\t\t\tmsg(labelB) + '  ' + msg(`${styleTypeB}-style.${item.id}` as TLTranslationKey)\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tdata-wd={`${endWdPrefix}.${item.id}`}\n\t\t\t\t\t\t\t\t\tkey={item.id}\n\t\t\t\t\t\t\t\t\ticon={item.icon as TLUiIconType}\n\t\t\t\t\t\t\t\t\tonClick={() => onValueChange(item as TLStyleItem, false)}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t})}\n\t\t\t\t\t</div>\n\t\t\t\t</DropdownMenu.Content>\n\t\t\t</DropdownMenu.Root>\n\t\t</div>\n\t)\n})\n","import { Trigger } from '@radix-ui/react-dropdown-menu'\nimport { App, TLStyleItem, TLStyleType } from '@tldraw/editor'\nimport classNames from 'classnames'\nimport * as React from 'react'\nimport { TLTranslationKey, useTranslation } from '../../../hooks'\nimport { TLUiIconType } from '../../../icon-types'\nimport { Button } from '../../primitives'\nimport * as DropdownMenu from '../../primitives/DropdownMenu'\n\ntype AllStyles = typeof App.styles\n\ninterface DropdownPickerProps<T extends AllStyles[keyof AllStyles][number]> {\n\tid: string\n\tlabel: TLTranslationKey\n\titems: T[]\n\tstyleType: TLStyleType\n\tvalue: T['id'] | null\n\t'data-wd'?: string\n\tonValueChange: (value: TLStyleItem, squashing: boolean) => void\n}\n\nexport const DropdownPicker = React.memo(function DropdownPicker<\n\tT extends AllStyles[keyof AllStyles][number]\n>({\n\tid,\n\titems,\n\tstyleType,\n\tlabel,\n\tvalue,\n\tonValueChange,\n\t'data-wd': dataWd,\n}: DropdownPickerProps<T>) {\n\tconst msg = useTranslation()\n\n\tconst icon = React.useMemo(() => items.find((item) => item.id === value)?.icon, [items, value])\n\n\treturn (\n\t\t<DropdownMenu.Root id={`style panel ${id}`}>\n\t\t\t<Trigger asChild>\n\t\t\t\t<Button\n\t\t\t\t\tdata-wd={dataWd}\n\t\t\t\t\ttitle={\n\t\t\t\t\t\tvalue === null\n\t\t\t\t\t\t\t? msg('style-panel.mixed')\n\t\t\t\t\t\t\t: msg(`${styleType}-style.${value}` as TLTranslationKey)\n\t\t\t\t\t}\n\t\t\t\t\tlabel={label}\n\t\t\t\t\ticon={(icon as TLUiIconType) ?? 'mixed'}\n\t\t\t\t/>\n\t\t\t</Trigger>\n\t\t\t<DropdownMenu.Content side=\"left\" align=\"center\" alignOffset={0}>\n\t\t\t\t<div\n\t\t\t\t\tclassName={classNames('tlui-button-grid', {\n\t\t\t\t\t\t'tlui-button-grid__two': items.length < 4,\n\t\t\t\t\t\t'tlui-button-grid__four': items.length >= 4,\n\t\t\t\t\t})}\n\t\t\t\t>\n\t\t\t\t\t{items.map((item) => {\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<DropdownMenu.Item\n\t\t\t\t\t\t\t\tclassName=\"tlui-button-grid__button\"\n\t\t\t\t\t\t\t\tdata-wd={`${dataWd}.${item.id}`}\n\t\t\t\t\t\t\t\ttitle={msg(`${styleType}-style.${item.id}` as TLTranslationKey)}\n\t\t\t\t\t\t\t\tkey={item.id}\n\t\t\t\t\t\t\t\ticon={item.icon as TLUiIconType}\n\t\t\t\t\t\t\t\tonClick={() => onValueChange(item as TLStyleItem, false)}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t)\n\t\t\t\t\t})}\n\t\t\t\t</div>\n\t\t\t</DropdownMenu.Content>\n\t\t</DropdownMenu.Root>\n\t)\n})\n","import { App, TLNullableShapeProps, TLStyleItem, useApp } from '@tldraw/editor'\nimport React, { useCallback } from 'react'\nimport { track } from 'signia-react'\nimport { useTranslation } from '../../hooks'\nimport { ButtonPicker, Slider } from '../primitives'\nimport { DoubleDropdownPicker } from './DoubleDropdownPicker'\nimport { DropdownPicker } from './DropdownPicker'\n\ninterface StylePanelProps {\n\tisMobile?: boolean\n}\n\n/** @public */\nexport const StylePanel = track(function StylePanel({ isMobile }: StylePanelProps) {\n\tconst app = useApp()\n\tconst props = app.props\n\n\tconst handlePointerOut = useCallback(() => {\n\t\tif (!isMobile) {\n\t\t\tapp.isChangingStyle = false\n\t\t}\n\t}, [app, isMobile])\n\n\tif (!props) return null\n\n\tconst { geo, arrowheadEnd, arrowheadStart, spline, font } = props\n\n\tconst hideGeo = geo === undefined\n\tconst hideArrowHeads = arrowheadEnd === undefined && arrowheadStart === undefined\n\tconst hideSpline = spline === undefined\n\tconst hideText = font === undefined\n\n\treturn (\n\t\t<div className=\"tlui-style-panel\" data-ismobile={isMobile} onPointerLeave={handlePointerOut}>\n\t\t\t<CommonStylePickerSet props={props} />\n\t\t\t{!hideText && <TextStylePickerSet props={props} />}\n\t\t\t{!(hideGeo && hideArrowHeads && hideSpline) && (\n\t\t\t\t<div className=\"tlui-style-panel__section\" aria-label=\"style panel styles\">\n\t\t\t\t\t<GeoStylePickerSet props={props} />\n\t\t\t\t\t<ArrowheadStylePickerSet props={props} />\n\t\t\t\t\t<SplineStylePickerSet props={props} />\n\t\t\t\t</div>\n\t\t\t)}\n\t\t</div>\n\t)\n})\n\nconst { styles } = App\n\nfunction useStyleChangeCallback() {\n\tconst app = useApp()\n\n\treturn React.useCallback(\n\t\t(item: TLStyleItem, squashing: boolean) => {\n\t\t\tapp.batch(() => {\n\t\t\t\tapp.setProp(item.type, item.id, false, squashing)\n\t\t\t\tapp.isChangingStyle = true\n\t\t\t})\n\t\t},\n\t\t[app]\n\t)\n}\n\nfunction CommonStylePickerSet({ props }: { props: TLNullableShapeProps }) {\n\tconst app = useApp()\n\tconst msg = useTranslation()\n\n\tconst handleValueChange = useStyleChangeCallback()\n\n\tconst handleOpacityValueChange = React.useCallback(\n\t\t(value: number, ephemeral: boolean) => {\n\t\t\tconst item = styles.opacity[value]\n\t\t\tapp.setProp(item.type, item.id, ephemeral)\n\t\t\tapp.isChangingStyle = true\n\t\t},\n\t\t[app]\n\t)\n\n\tconst { color, fill, dash, size, opacity } = props\n\n\tif (\n\t\tcolor === undefined &&\n\t\tfill === undefined &&\n\t\tdash === undefined &&\n\t\tsize === undefined &&\n\t\topacity === undefined\n\t) {\n\t\treturn null\n\t}\n\n\tconst showPickers = fill || dash || size\n\n\tconst opacityIndex = styles.opacity.findIndex((s) => s.id === opacity)\n\n\treturn (\n\t\t<>\n\t\t\t<div className=\"tlui-style-panel__section__common\" aria-label=\"style panel styles\">\n\t\t\t\t{color === undefined ? null : (\n\t\t\t\t\t<ButtonPicker\n\t\t\t\t\t\ttitle={msg('style-panel.color')}\n\t\t\t\t\t\tstyleType=\"color\"\n\t\t\t\t\t\tdata-wd=\"style.color\"\n\t\t\t\t\t\titems={styles.color}\n\t\t\t\t\t\tvalue={color}\n\t\t\t\t\t\tonValueChange={handleValueChange}\n\t\t\t\t\t/>\n\t\t\t\t)}\n\t\t\t\t{opacity === undefined ? null : (\n\t\t\t\t\t<Slider\n\t\t\t\t\t\tdata-wd=\"style.opacity\"\n\t\t\t\t\t\tvalue={opacityIndex >= 0 ? opacityIndex : styles.opacity.length - 1}\n\t\t\t\t\t\tlabel={opacity ? `opacity-style.${opacity}` : 'style-panel.mixed'}\n\t\t\t\t\t\tonValueChange={handleOpacityValueChange}\n\t\t\t\t\t\tsteps={styles.opacity.length - 1}\n\t\t\t\t\t\ttitle={msg('style-panel.opacity')}\n\t\t\t\t\t/>\n\t\t\t\t)}\n\t\t\t</div>\n\t\t\t{showPickers && (\n\t\t\t\t<div className=\"tlui-style-panel__section\" aria-label=\"style panel styles\">\n\t\t\t\t\t{fill === undefined ? null : (\n\t\t\t\t\t\t<ButtonPicker\n\t\t\t\t\t\t\ttitle={msg('style-panel.fill')}\n\t\t\t\t\t\t\tstyleType=\"fill\"\n\t\t\t\t\t\t\tdata-wd=\"style.fill\"\n\t\t\t\t\t\t\titems={styles.fill}\n\t\t\t\t\t\t\tvalue={fill}\n\t\t\t\t\t\t\tonValueChange={handleValueChange}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t\t{dash === undefined ? null : (\n\t\t\t\t\t\t<ButtonPicker\n\t\t\t\t\t\t\ttitle={msg('style-panel.dash')}\n\t\t\t\t\t\t\tstyleType=\"dash\"\n\t\t\t\t\t\t\tdata-wd=\"style.dash\"\n\t\t\t\t\t\t\titems={styles.dash}\n\t\t\t\t\t\t\tvalue={dash}\n\t\t\t\t\t\t\tonValueChange={handleValueChange}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t\t{size === undefined ? null : (\n\t\t\t\t\t\t<ButtonPicker\n\t\t\t\t\t\t\ttitle={msg('style-panel.size')}\n\t\t\t\t\t\t\tstyleType=\"size\"\n\t\t\t\t\t\t\tdata-wd=\"style.size\"\n\t\t\t\t\t\t\titems={styles.size}\n\t\t\t\t\t\t\tvalue={size}\n\t\t\t\t\t\t\tonValueChange={handleValueChange}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t)}\n\t\t</>\n\t)\n}\n\nfunction TextStylePickerSet({ props }: { props: TLNullableShapeProps }) {\n\tconst msg = useTranslation()\n\tconst handleValueChange = useStyleChangeCallback()\n\n\tconst { font, align } = props\n\tif (font === undefined && align === undefined) {\n\t\treturn null\n\t}\n\n\treturn (\n\t\t<div className=\"tlui-style-panel__section\" aria-label=\"style panel text\">\n\t\t\t{font === undefined ? null : (\n\t\t\t\t<ButtonPicker\n\t\t\t\t\ttitle={msg('style-panel.font')}\n\t\t\t\t\tstyleType=\"font\"\n\t\t\t\t\tdata-wd=\"font\"\n\t\t\t\t\titems={styles.font}\n\t\t\t\t\tvalue={font}\n\t\t\t\t\tonValueChange={handleValueChange}\n\t\t\t\t/>\n\t\t\t)}\n\t\t\t{align === undefined ? null : (\n\t\t\t\t<ButtonPicker\n\t\t\t\t\ttitle={msg('style-panel.align')}\n\t\t\t\t\tstyleType=\"align\"\n\t\t\t\t\tdata-wd=\"align\"\n\t\t\t\t\titems={styles.align}\n\t\t\t\t\tvalue={align}\n\t\t\t\t\tonValueChange={handleValueChange}\n\t\t\t\t/>\n\t\t\t)}\n\t\t</div>\n\t)\n}\n\nfunction GeoStylePickerSet({ props }: { props: TLNullableShapeProps }) {\n\tconst handleValueChange = useStyleChangeCallback()\n\n\tconst { geo } = props\n\tif (geo === undefined) {\n\t\treturn null\n\t}\n\n\treturn (\n\t\t<DropdownPicker\n\t\t\tid=\"geo\"\n\t\t\tlabel={'style-panel.geo'}\n\t\t\tstyleType=\"geo\"\n\t\t\tdata-wd=\"style-panel.geo\"\n\t\t\titems={styles.geo}\n\t\t\tvalue={geo}\n\t\t\tonValueChange={handleValueChange}\n\t\t/>\n\t)\n}\n\nfunction SplineStylePickerSet({ props }: { props: TLNullableShapeProps }) {\n\tconst handleValueChange = useStyleChangeCallback()\n\n\tconst { spline } = props\n\tif (spline === undefined) {\n\t\treturn null\n\t}\n\n\treturn (\n\t\t<DropdownPicker\n\t\t\tid=\"spline\"\n\t\t\tlabel={'style-panel.spline'}\n\t\t\tstyleType=\"spline\"\n\t\t\tdata-wd=\"style.spline\"\n\t\t\titems={styles.spline}\n\t\t\tvalue={spline}\n\t\t\tonValueChange={handleValueChange}\n\t\t/>\n\t)\n}\n\nfunction ArrowheadStylePickerSet({ props }: { props: TLNullableShapeProps }) {\n\tconst handleValueChange = useStyleChangeCallback()\n\n\tconst { arrowheadEnd, arrowheadStart } = props\n\tif (arrowheadEnd === undefined && arrowheadStart === undefined) {\n\t\treturn null\n\t}\n\n\treturn (\n\t\t<DoubleDropdownPicker\n\t\t\tlabel={'style-panel.arrowheads'}\n\t\t\tstyleTypeA=\"arrowheadStart\"\n\t\t\tdata-wd=\"style.arrowheads\"\n\t\t\titemsA={styles.arrowheadStart}\n\t\t\tvalueA={arrowheadStart}\n\t\t\tstyleTypeB=\"arrowheadEnd\"\n\t\t\titemsB={styles.arrowheadEnd}\n\t\t\tvalueB={arrowheadEnd}\n\t\t\tonValueChange={handleValueChange}\n\t\t\tlabelA=\"style-panel.arrowhead-start\"\n\t\t\tlabelB=\"style-panel.arrowhead-end\"\n\t\t/>\n\t)\n}\n","import { useApp } from '@tldraw/editor'\nimport { useEffect, useState } from 'react'\nimport { useActions } from '../../hooks'\nimport { Button } from '../primitives'\n\nexport function BackToContent() {\n\tconst app = useApp()\n\n\tconst actions = useActions()\n\tconst action = actions['back-to-content']\n\n\tconst [showBackToContent, setShowBackToContent] = useState(false)\n\n\tuseEffect(() => {\n\t\tlet showBackToContentPrev = false\n\n\t\tconst interval = setInterval(() => {\n\t\t\tconst { renderingShapes } = app\n\n\t\t\t// renderingShapes will also include shapes that have the canUnmount flag\n\t\t\t// set to true. These shapes will be on the canvas but may not be in the\n\t\t\t// viewport... so we also need to narrow down the list to only shapes that\n\t\t\t// are ALSO in the viewport.\n\t\t\tconst visibleShapes = renderingShapes.filter((s) => s.isInViewport)\n\t\t\tconst showBackToContentNow = visibleShapes.length === 0 && app.shapesArray.length > 0\n\n\t\t\tif (showBackToContentPrev !== showBackToContentNow) {\n\t\t\t\tsetShowBackToContent(showBackToContentNow)\n\t\t\t\tshowBackToContentPrev = showBackToContentNow\n\t\t\t}\n\t\t}, 1000)\n\n\t\treturn () => {\n\t\t\tclearInterval(interval)\n\t\t}\n\t}, [app])\n\n\tif (!showBackToContent) return null\n\n\treturn (\n\t\t<Button\n\t\t\ticonLeft={action.icon}\n\t\t\tlabel={action.label}\n\t\t\tonClick={() => {\n\t\t\t\taction.onSelect()\n\t\t\t\tsetShowBackToContent(false)\n\t\t\t}}\n\t\t/>\n\t)\n}\n","import * as _Dialog from '@radix-ui/react-dialog'\nimport { useContainer } from '@tldraw/editor'\nimport React, { useCallback } from 'react'\nimport { TLDialog, useDialogs } from '../../hooks/useDialogsProvider'\n\nconst Dialog = ({ id, component: ModalContent, onClose }: TLDialog) => {\n\tconst { removeDialog } = useDialogs()\n\n\tconst container = useContainer()\n\n\tconst handleOpenChange = useCallback(\n\t\t(isOpen: boolean) => {\n\t\t\tif (!isOpen) {\n\t\t\t\tif (onClose) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tonClose()\n\t\t\t\t\t} catch (err: any) {\n\t\t\t\t\t\tconsole.warn(err)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tremoveDialog(id)\n\t\t\t}\n\t\t},\n\t\t[id, onClose, removeDialog]\n\t)\n\n\treturn (\n\t\t<_Dialog.Root onOpenChange={handleOpenChange} defaultOpen>\n\t\t\t<_Dialog.Portal container={container}>\n\t\t\t\t<_Dialog.Overlay dir=\"ltr\" className=\"tlui-dialog__overlay\">\n\t\t\t\t\t<_Dialog.Content dir=\"ltr\" className=\"tlui-dialog__content\">\n\t\t\t\t\t\t<ModalContent onClose={() => handleOpenChange(false)} />\n\t\t\t\t\t</_Dialog.Content>\n\t\t\t\t</_Dialog.Overlay>\n\t\t\t</_Dialog.Portal>\n\t\t</_Dialog.Root>\n\t)\n}\n\nfunction _Dialogs() {\n\tconst { dialogs } = useDialogs()\n\n\treturn (\n\t\t<>\n\t\t\t{dialogs.map((dialog: TLDialog) => (\n\t\t\t\t<Dialog key={dialog.id} {...dialog} />\n\t\t\t))}\n\t\t</>\n\t)\n}\n\nexport const Dialogs = React.memo(_Dialogs)\n","import { useApp } from '@tldraw/editor'\nimport { track } from 'signia-react'\nimport { useActions } from '../../hooks'\nimport { Button } from '../primitives'\n\nexport const ExitPenMode = track(function ExitPenMode() {\n\tconst app = useApp()\n\n\tconst isPenMode = app.isPenMode\n\n\tconst actions = useActions()\n\n\tif (!isPenMode) return null\n\n\tconst action = actions['exit-pen-mode']\n\n\treturn <Button label={action.label} iconLeft={action.icon} onClick={action.onSelect} />\n})\n","import * as React from 'react';\nimport { composeEventHandlers } from '@radix-ui/primitive';\nimport { useComposedRefs } from '@radix-ui/react-compose-refs';\nimport { createContextScope } from '@radix-ui/react-context';\nimport { DismissableLayer } from '@radix-ui/react-dismissable-layer';\nimport { useFocusGuards } from '@radix-ui/react-focus-guards';\nimport { FocusScope } from '@radix-ui/react-focus-scope';\nimport { useId } from '@radix-ui/react-id';\nimport * as PopperPrimitive from '@radix-ui/react-popper';\nimport { createPopperScope } from '@radix-ui/react-popper';\nimport { Portal as PortalPrimitive } from '@radix-ui/react-portal';\nimport { Presence } from '@radix-ui/react-presence';\nimport { Primitive } from '@radix-ui/react-primitive';\nimport { Slot } from '@radix-ui/react-slot';\nimport { useControllableState } from '@radix-ui/react-use-controllable-state';\nimport { hideOthers } from 'aria-hidden';\nimport { RemoveScroll } from 'react-remove-scroll';\n\nimport type * as Radix from '@radix-ui/react-primitive';\nimport type { Scope } from '@radix-ui/react-context';\n\n/* -------------------------------------------------------------------------------------------------\n * Popover\n * -----------------------------------------------------------------------------------------------*/\n\nconst POPOVER_NAME = 'Popover';\n\ntype ScopedProps<P> = P & { __scopePopover?: Scope };\nconst [createPopoverContext, createPopoverScope] = createContextScope(POPOVER_NAME, [\n  createPopperScope,\n]);\nconst usePopperScope = createPopperScope();\n\ntype PopoverContextValue = {\n  triggerRef: React.RefObject<HTMLButtonElement>;\n  contentId: string;\n  open: boolean;\n  onOpenChange(open: boolean): void;\n  onOpenToggle(): void;\n  hasCustomAnchor: boolean;\n  onCustomAnchorAdd(): void;\n  onCustomAnchorRemove(): void;\n  modal: boolean;\n};\n\nconst [PopoverProvider, usePopoverContext] =\n  createPopoverContext<PopoverContextValue>(POPOVER_NAME);\n\ninterface PopoverProps {\n  children?: React.ReactNode;\n  open?: boolean;\n  defaultOpen?: boolean;\n  onOpenChange?: (open: boolean) => void;\n  modal?: boolean;\n}\n\nconst Popover: React.FC<PopoverProps> = (props: ScopedProps<PopoverProps>) => {\n  const {\n    __scopePopover,\n    children,\n    open: openProp,\n    defaultOpen,\n    onOpenChange,\n    modal = false,\n  } = props;\n  const popperScope = usePopperScope(__scopePopover);\n  const triggerRef = React.useRef<HTMLButtonElement>(null);\n  const [hasCustomAnchor, setHasCustomAnchor] = React.useState(false);\n  const [open = false, setOpen] = useControllableState({\n    prop: openProp,\n    defaultProp: defaultOpen,\n    onChange: onOpenChange,\n  });\n\n  return (\n    <PopperPrimitive.Root {...popperScope}>\n      <PopoverProvider\n        scope={__scopePopover}\n        contentId={useId()}\n        triggerRef={triggerRef}\n        open={open}\n        onOpenChange={setOpen}\n        onOpenToggle={React.useCallback(() => setOpen((prevOpen) => !prevOpen), [setOpen])}\n        hasCustomAnchor={hasCustomAnchor}\n        onCustomAnchorAdd={React.useCallback(() => setHasCustomAnchor(true), [])}\n        onCustomAnchorRemove={React.useCallback(() => setHasCustomAnchor(false), [])}\n        modal={modal}\n      >\n        {children}\n      </PopoverProvider>\n    </PopperPrimitive.Root>\n  );\n};\n\nPopover.displayName = POPOVER_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * PopoverAnchor\n * -----------------------------------------------------------------------------------------------*/\n\nconst ANCHOR_NAME = 'PopoverAnchor';\n\ntype PopoverAnchorElement = React.ElementRef<typeof PopperPrimitive.Anchor>;\ntype PopperAnchorProps = Radix.ComponentPropsWithoutRef<typeof PopperPrimitive.Anchor>;\ninterface PopoverAnchorProps extends PopperAnchorProps {}\n\nconst PopoverAnchor = React.forwardRef<PopoverAnchorElement, PopoverAnchorProps>(\n  (props: ScopedProps<PopoverAnchorProps>, forwardedRef) => {\n    const { __scopePopover, ...anchorProps } = props;\n    const context = usePopoverContext(ANCHOR_NAME, __scopePopover);\n    const popperScope = usePopperScope(__scopePopover);\n    const { onCustomAnchorAdd, onCustomAnchorRemove } = context;\n\n    React.useEffect(() => {\n      onCustomAnchorAdd();\n      return () => onCustomAnchorRemove();\n    }, [onCustomAnchorAdd, onCustomAnchorRemove]);\n\n    return <PopperPrimitive.Anchor {...popperScope} {...anchorProps} ref={forwardedRef} />;\n  }\n);\n\nPopoverAnchor.displayName = ANCHOR_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * PopoverTrigger\n * -----------------------------------------------------------------------------------------------*/\n\nconst TRIGGER_NAME = 'PopoverTrigger';\n\ntype PopoverTriggerElement = React.ElementRef<typeof Primitive.button>;\ntype PrimitiveButtonProps = Radix.ComponentPropsWithoutRef<typeof Primitive.button>;\ninterface PopoverTriggerProps extends PrimitiveButtonProps {}\n\nconst PopoverTrigger = React.forwardRef<PopoverTriggerElement, PopoverTriggerProps>(\n  (props: ScopedProps<PopoverTriggerProps>, forwardedRef) => {\n    const { __scopePopover, ...triggerProps } = props;\n    const context = usePopoverContext(TRIGGER_NAME, __scopePopover);\n    const popperScope = usePopperScope(__scopePopover);\n    const composedTriggerRef = useComposedRefs(forwardedRef, context.triggerRef);\n\n    const trigger = (\n      <Primitive.button\n        type=\"button\"\n        aria-haspopup=\"dialog\"\n        aria-expanded={context.open}\n        aria-controls={context.contentId}\n        data-state={getState(context.open)}\n        {...triggerProps}\n        ref={composedTriggerRef}\n        onClick={composeEventHandlers(props.onClick, context.onOpenToggle)}\n      />\n    );\n\n    return context.hasCustomAnchor ? (\n      trigger\n    ) : (\n      <PopperPrimitive.Anchor asChild {...popperScope}>\n        {trigger}\n      </PopperPrimitive.Anchor>\n    );\n  }\n);\n\nPopoverTrigger.displayName = TRIGGER_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * PopoverPortal\n * -----------------------------------------------------------------------------------------------*/\n\nconst PORTAL_NAME = 'PopoverPortal';\n\ntype PortalContextValue = { forceMount?: true };\nconst [PortalProvider, usePortalContext] = createPopoverContext<PortalContextValue>(PORTAL_NAME, {\n  forceMount: undefined,\n});\n\ntype PortalProps = React.ComponentPropsWithoutRef<typeof PortalPrimitive>;\ninterface PopoverPortalProps extends Omit<PortalProps, 'asChild'> {\n  children?: React.ReactNode;\n  /**\n   * Used to force mounting when more control is needed. Useful when\n   * controlling animation with React animation libraries.\n   */\n  forceMount?: true;\n}\n\nconst PopoverPortal: React.FC<PopoverPortalProps> = (props: ScopedProps<PopoverPortalProps>) => {\n  const { __scopePopover, forceMount, children, container } = props;\n  const context = usePopoverContext(PORTAL_NAME, __scopePopover);\n  return (\n    <PortalProvider scope={__scopePopover} forceMount={forceMount}>\n      <Presence present={forceMount || context.open}>\n        <PortalPrimitive asChild container={container}>\n          {children}\n        </PortalPrimitive>\n      </Presence>\n    </PortalProvider>\n  );\n};\n\nPopoverPortal.displayName = PORTAL_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * PopoverContent\n * -----------------------------------------------------------------------------------------------*/\n\nconst CONTENT_NAME = 'PopoverContent';\n\ninterface PopoverContentProps extends PopoverContentTypeProps {\n  /**\n   * Used to force mounting when more control is needed. Useful when\n   * controlling animation with React animation libraries.\n   */\n  forceMount?: true;\n}\n\nconst PopoverContent = React.forwardRef<PopoverContentTypeElement, PopoverContentProps>(\n  (props: ScopedProps<PopoverContentProps>, forwardedRef) => {\n    const portalContext = usePortalContext(CONTENT_NAME, props.__scopePopover);\n    const { forceMount = portalContext.forceMount, ...contentProps } = props;\n    const context = usePopoverContext(CONTENT_NAME, props.__scopePopover);\n    return (\n      <Presence present={forceMount || context.open}>\n        {context.modal ? (\n          <PopoverContentModal {...contentProps} ref={forwardedRef} />\n        ) : (\n          <PopoverContentNonModal {...contentProps} ref={forwardedRef} />\n        )}\n      </Presence>\n    );\n  }\n);\n\nPopoverContent.displayName = CONTENT_NAME;\n\n/* -----------------------------------------------------------------------------------------------*/\n\ntype PopoverContentTypeElement = PopoverContentImplElement;\ninterface PopoverContentTypeProps\n  extends Omit<PopoverContentImplProps, 'trapFocus' | 'disableOutsidePointerEvents'> {}\n\nconst PopoverContentModal = React.forwardRef<PopoverContentTypeElement, PopoverContentTypeProps>(\n  (props: ScopedProps<PopoverContentTypeProps>, forwardedRef) => {\n    const context = usePopoverContext(CONTENT_NAME, props.__scopePopover);\n    const contentRef = React.useRef<HTMLDivElement>(null);\n    const composedRefs = useComposedRefs(forwardedRef, contentRef);\n    const isRightClickOutsideRef = React.useRef(false);\n\n    // aria-hide everything except the content (better supported equivalent to setting aria-modal)\n    React.useEffect(() => {\n      const content = contentRef.current;\n      if (content) return hideOthers(content);\n    }, []);\n\n    return (\n      <RemoveScroll as={Slot} allowPinchZoom>\n        <PopoverContentImpl\n          {...props}\n          ref={composedRefs}\n          // we make sure we're not trapping once it's been closed\n          // (closed !== unmounted when animating out)\n          trapFocus={context.open}\n          disableOutsidePointerEvents\n          onCloseAutoFocus={composeEventHandlers(props.onCloseAutoFocus, (event) => {\n            event.preventDefault();\n            if (!isRightClickOutsideRef.current) context.triggerRef.current?.focus();\n          })}\n          onPointerDownOutside={composeEventHandlers(\n            props.onPointerDownOutside,\n            (event) => {\n              const originalEvent = event.detail.originalEvent;\n              const ctrlLeftClick = originalEvent.button === 0 && originalEvent.ctrlKey === true;\n              const isRightClick = originalEvent.button === 2 || ctrlLeftClick;\n\n              isRightClickOutsideRef.current = isRightClick;\n            },\n            { checkForDefaultPrevented: false }\n          )}\n          // When focus is trapped, a `focusout` event may still happen.\n          // We make sure we don't trigger our `onDismiss` in such case.\n          onFocusOutside={composeEventHandlers(\n            props.onFocusOutside,\n            (event) => event.preventDefault(),\n            { checkForDefaultPrevented: false }\n          )}\n        />\n      </RemoveScroll>\n    );\n  }\n);\n\nconst PopoverContentNonModal = React.forwardRef<PopoverContentTypeElement, PopoverContentTypeProps>(\n  (props: ScopedProps<PopoverContentTypeProps>, forwardedRef) => {\n    const context = usePopoverContext(CONTENT_NAME, props.__scopePopover);\n    const hasInteractedOutsideRef = React.useRef(false);\n\n    return (\n      <PopoverContentImpl\n        {...props}\n        ref={forwardedRef}\n        trapFocus={false}\n        disableOutsidePointerEvents={false}\n        onCloseAutoFocus={(event) => {\n          props.onCloseAutoFocus?.(event);\n\n          if (!event.defaultPrevented) {\n            if (!hasInteractedOutsideRef.current) context.triggerRef.current?.focus();\n            // Always prevent auto focus because we either focus manually or want user agent focus\n            event.preventDefault();\n          }\n\n          hasInteractedOutsideRef.current = false;\n        }}\n        onInteractOutside={(event) => {\n          props.onInteractOutside?.(event);\n\n          if (!event.defaultPrevented) hasInteractedOutsideRef.current = true;\n\n          // Prevent dismissing when clicking the trigger.\n          // As the trigger is already setup to close, without doing so would\n          // cause it to close and immediately open.\n          //\n          // We use `onInteractOutside` as some browsers also\n          // focus on pointer down, creating the same issue.\n          const target = event.target as HTMLElement;\n          const targetIsTrigger = context.triggerRef.current?.contains(target);\n          if (targetIsTrigger) event.preventDefault();\n        }}\n      />\n    );\n  }\n);\n\n/* -----------------------------------------------------------------------------------------------*/\n\ntype PopoverContentImplElement = React.ElementRef<typeof PopperPrimitive.Content>;\ntype FocusScopeProps = Radix.ComponentPropsWithoutRef<typeof FocusScope>;\ntype DismissableLayerProps = Radix.ComponentPropsWithoutRef<typeof DismissableLayer>;\ntype PopperContentProps = Radix.ComponentPropsWithoutRef<typeof PopperPrimitive.Content>;\ninterface PopoverContentImplProps\n  extends Omit<PopperContentProps, 'onPlaced'>,\n    Omit<DismissableLayerProps, 'onDismiss'> {\n  /**\n   * Whether focus should be trapped within the `Popover`\n   * (default: false)\n   */\n  trapFocus?: FocusScopeProps['trapped'];\n\n  /**\n   * Event handler called when auto-focusing on open.\n   * Can be prevented.\n   */\n  onOpenAutoFocus?: FocusScopeProps['onMountAutoFocus'];\n\n  /**\n   * Event handler called when auto-focusing on close.\n   * Can be prevented.\n   */\n  onCloseAutoFocus?: FocusScopeProps['onUnmountAutoFocus'];\n}\n\nconst PopoverContentImpl = React.forwardRef<PopoverContentImplElement, PopoverContentImplProps>(\n  (props: ScopedProps<PopoverContentImplProps>, forwardedRef) => {\n    const {\n      __scopePopover,\n      trapFocus,\n      onOpenAutoFocus,\n      onCloseAutoFocus,\n      disableOutsidePointerEvents,\n      onEscapeKeyDown,\n      onPointerDownOutside,\n      onFocusOutside,\n      onInteractOutside,\n      ...contentProps\n    } = props;\n    const context = usePopoverContext(CONTENT_NAME, __scopePopover);\n    const popperScope = usePopperScope(__scopePopover);\n\n    // Make sure the whole tree has focus guards as our `Popover` may be\n    // the last element in the DOM (beacuse of the `Portal`)\n    useFocusGuards();\n\n    return (\n      <FocusScope\n        asChild\n        loop\n        trapped={trapFocus}\n        onMountAutoFocus={onOpenAutoFocus}\n        onUnmountAutoFocus={onCloseAutoFocus}\n      >\n        <DismissableLayer\n          asChild\n          disableOutsidePointerEvents={disableOutsidePointerEvents}\n          onInteractOutside={onInteractOutside}\n          onEscapeKeyDown={onEscapeKeyDown}\n          onPointerDownOutside={onPointerDownOutside}\n          onFocusOutside={onFocusOutside}\n          onDismiss={() => context.onOpenChange(false)}\n        >\n          <PopperPrimitive.Content\n            data-state={getState(context.open)}\n            role=\"dialog\"\n            id={context.contentId}\n            {...popperScope}\n            {...contentProps}\n            ref={forwardedRef}\n            style={{\n              ...contentProps.style,\n              // re-namespace exposed content custom properties\n              ...{\n                '--radix-popover-content-transform-origin': 'var(--radix-popper-transform-origin)',\n                '--radix-popover-content-available-width': 'var(--radix-popper-available-width)',\n                '--radix-popover-content-available-height': 'var(--radix-popper-available-height)',\n                '--radix-popover-trigger-width': 'var(--radix-popper-anchor-width)',\n                '--radix-popover-trigger-height': 'var(--radix-popper-anchor-height)',\n              },\n            }}\n          />\n        </DismissableLayer>\n      </FocusScope>\n    );\n  }\n);\n\n/* -------------------------------------------------------------------------------------------------\n * PopoverClose\n * -----------------------------------------------------------------------------------------------*/\n\nconst CLOSE_NAME = 'PopoverClose';\n\ntype PopoverCloseElement = React.ElementRef<typeof Primitive.button>;\ninterface PopoverCloseProps extends PrimitiveButtonProps {}\n\nconst PopoverClose = React.forwardRef<PopoverCloseElement, PopoverCloseProps>(\n  (props: ScopedProps<PopoverCloseProps>, forwardedRef) => {\n    const { __scopePopover, ...closeProps } = props;\n    const context = usePopoverContext(CLOSE_NAME, __scopePopover);\n    return (\n      <Primitive.button\n        type=\"button\"\n        {...closeProps}\n        ref={forwardedRef}\n        onClick={composeEventHandlers(props.onClick, () => context.onOpenChange(false))}\n      />\n    );\n  }\n);\n\nPopoverClose.displayName = CLOSE_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * PopoverArrow\n * -----------------------------------------------------------------------------------------------*/\n\nconst ARROW_NAME = 'PopoverArrow';\n\ntype PopoverArrowElement = React.ElementRef<typeof PopperPrimitive.Arrow>;\ntype PopperArrowProps = Radix.ComponentPropsWithoutRef<typeof PopperPrimitive.Arrow>;\ninterface PopoverArrowProps extends PopperArrowProps {}\n\nconst PopoverArrow = React.forwardRef<PopoverArrowElement, PopoverArrowProps>(\n  (props: ScopedProps<PopoverArrowProps>, forwardedRef) => {\n    const { __scopePopover, ...arrowProps } = props;\n    const popperScope = usePopperScope(__scopePopover);\n    return <PopperPrimitive.Arrow {...popperScope} {...arrowProps} ref={forwardedRef} />;\n  }\n);\n\nPopoverArrow.displayName = ARROW_NAME;\n\n/* -----------------------------------------------------------------------------------------------*/\n\nfunction getState(open: boolean) {\n  return open ? 'open' : 'closed';\n}\n\nconst Root = Popover;\nconst Anchor = PopoverAnchor;\nconst Trigger = PopoverTrigger;\nconst Portal = PopoverPortal;\nconst Content = PopoverContent;\nconst Close = PopoverClose;\nconst Arrow = PopoverArrow;\n\nexport {\n  createPopoverScope,\n  //\n  Popover,\n  PopoverAnchor,\n  PopoverTrigger,\n  PopoverPortal,\n  PopoverContent,\n  PopoverClose,\n  PopoverArrow,\n  //\n  Root,\n  Anchor,\n  Trigger,\n  Portal,\n  Content,\n  Close,\n  Arrow,\n};\nexport type {\n  PopoverProps,\n  PopoverAnchorProps,\n  PopoverTriggerProps,\n  PopoverPortalProps,\n  PopoverContentProps,\n  PopoverCloseProps,\n  PopoverArrowProps,\n};\n","import * as PopoverPrimitive from '@radix-ui/react-popover'\nimport { useContainer } from '@tldraw/editor'\nimport React, { FC } from 'react'\nimport { useMenuIsOpen } from '../../../hooks'\n\ntype PopoverProps = {\n\tid: string\n\topen?: boolean\n\tchildren: React.ReactNode\n\tonOpenChange?: (isOpen: boolean) => void\n}\n\nexport const Popover: FC<PopoverProps> = ({ id, open, children, onOpenChange }) => {\n\tconst handleOpenChange = useMenuIsOpen(id, onOpenChange)\n\n\treturn (\n\t\t<PopoverPrimitive.Root onOpenChange={handleOpenChange} open={open}>\n\t\t\t<div className=\"tlui-popover\">{children}</div>\n\t\t</PopoverPrimitive.Root>\n\t)\n}\n\nexport const PopoverTrigger: FC<{\n\tchildren: React.ReactNode\n\tdisabled?: boolean\n\tclassName?: string\n\t'data-wd'?: string\n}> = ({ children, disabled, 'data-wd': dataWd }) => {\n\treturn (\n\t\t<PopoverPrimitive.Trigger data-wd={dataWd} disabled={disabled} asChild dir=\"ltr\">\n\t\t\t{children}\n\t\t</PopoverPrimitive.Trigger>\n\t)\n}\nexport const PopoverContent: FC<{\n\tchildren: React.ReactNode\n\tside: 'top' | 'bottom' | 'left' | 'right'\n\talign?: 'start' | 'center' | 'end'\n\talignOffset?: number\n\tsideOffset?: number\n}> = ({ side, children, align = 'center', sideOffset = 8, alignOffset = 0 }) => {\n\tconst container = useContainer()\n\treturn (\n\t\t<PopoverPrimitive.Portal dir=\"ltr\" container={container}>\n\t\t\t<PopoverPrimitive.Content\n\t\t\t\tclassName=\"tlui-popover__content\"\n\t\t\t\tside={side}\n\t\t\t\tsideOffset={sideOffset}\n\t\t\t\talign={align}\n\t\t\t\talignOffset={alignOffset}\n\t\t\t\tdir=\"ltr\"\n\t\t\t>\n\t\t\t\t{children}\n\t\t\t\t{/* <StyledArrow /> */}\n\t\t\t</PopoverPrimitive.Content>\n\t\t</PopoverPrimitive.Portal>\n\t)\n}\n","import * as PopoverPrimitive from '@radix-ui/react-popover'\nimport { useContainer } from '@tldraw/editor'\nimport { memo } from 'react'\nimport { MenuChild, useActionsMenuSchema, useReadonly, useTranslation } from '../../hooks'\nimport { Button, kbdStr } from '../primitives'\nimport { Popover, PopoverTrigger } from '../primitives/Popover'\n\nexport const ActionsMenu = memo(function ActionsMenu() {\n\tconst msg = useTranslation()\n\tconst container = useContainer()\n\tconst menuSchema = useActionsMenuSchema()\n\tconst isReadonly = useReadonly()\n\n\tfunction getActionMenuItem(item: MenuChild) {\n\t\tif (isReadonly && !item.readonlyOk) return null\n\n\t\tswitch (item.type) {\n\t\t\tcase 'item': {\n\t\t\t\tconst { id, icon, label, kbd, onSelect } = item.actionItem\n\n\t\t\t\treturn (\n\t\t\t\t\t<Button\n\t\t\t\t\t\tkey={id}\n\t\t\t\t\t\tclassName=\"tlui-button-grid__button\"\n\t\t\t\t\t\tdata-wd={`menu-item.${item.id}`}\n\t\t\t\t\t\ticon={icon}\n\t\t\t\t\t\ttitle={\n\t\t\t\t\t\t\tlabel\n\t\t\t\t\t\t\t\t? kbd\n\t\t\t\t\t\t\t\t\t? `${msg(label)} ${kbdStr(kbd)}`\n\t\t\t\t\t\t\t\t\t: `${msg(label)}`\n\t\t\t\t\t\t\t\t: kbd\n\t\t\t\t\t\t\t\t? `${kbdStr(kbd)}`\n\t\t\t\t\t\t\t\t: ''\n\t\t\t\t\t\t}\n\t\t\t\t\t\tonClick={onSelect}\n\t\t\t\t\t\tdisabled={item.disabled}\n\t\t\t\t\t/>\n\t\t\t\t)\n\t\t\t}\n\t\t}\n\t}\n\n\treturn (\n\t\t<Popover id=\"actions menu\">\n\t\t\t<PopoverTrigger>\n\t\t\t\t<Button\n\t\t\t\t\tclassName=\"tlui-menu__trigger\"\n\t\t\t\t\tdata-wd=\"main.action-menu\"\n\t\t\t\t\ticon=\"dots-vertical\"\n\t\t\t\t\ttitle={msg('actions-menu.title')}\n\t\t\t\t\tsmallIcon\n\t\t\t\t/>\n\t\t\t</PopoverTrigger>\n\t\t\t<PopoverPrimitive.Portal dir=\"ltr\" container={container}>\n\t\t\t\t<PopoverPrimitive.Content\n\t\t\t\t\tclassName=\"tlui-popover__content\"\n\t\t\t\t\tside=\"bottom\"\n\t\t\t\t\tdir=\"ltr\"\n\t\t\t\t\tsideOffset={6}\n\t\t\t\t>\n\t\t\t\t\t<div className=\"tlui-actions-menu tlui-button-grid__four\">\n\t\t\t\t\t\t{menuSchema.map(getActionMenuItem)}\n\t\t\t\t\t</div>\n\t\t\t\t</PopoverPrimitive.Content>\n\t\t\t</PopoverPrimitive.Portal>\n\t\t</Popover>\n\t)\n})\n","import { useApp } from '@tldraw/editor'\nimport { track } from 'signia-react'\nimport { useActions, useTranslation } from '../../hooks'\nimport { Button, kbdStr } from '../primitives'\n\nexport const DuplicateButton = track(function DuplicateButton() {\n\tconst app = useApp()\n\tconst actions = useActions()\n\tconst msg = useTranslation()\n\tconst action = actions['duplicate']\n\n\tconst noSelected = app.selectedIds.length <= 0\n\n\treturn (\n\t\t<Button\n\t\t\ticon={action.icon}\n\t\t\tonClick={action.onSelect}\n\t\t\tdisabled={noSelected}\n\t\t\ttitle={`${msg(action.label!)} ${kbdStr(action.kbd!)}`}\n\t\t\tsmallIcon\n\t\t/>\n\t)\n})\n","import { App, preventDefault, useApp } from '@tldraw/editor'\nimport * as React from 'react'\nimport {\n\tMenuChild,\n\tuseBreakpoint,\n\tuseMenuClipboardEvents,\n\tuseMenuSchema,\n\tuseTranslation,\n} from '../../hooks'\nimport { useReadonly } from '../../hooks/useReadonly'\nimport { LanguageMenu } from '../LanguageMenu'\nimport { Button, Kbd } from '../primitives'\nimport * as M from '../primitives/DropdownMenu'\n\nexport const Menu = React.memo(function Menu() {\n\tconst msg = useTranslation()\n\n\treturn (\n\t\t<M.Root id=\"main menu\">\n\t\t\t<M.Trigger>\n\t\t\t\t<Button\n\t\t\t\t\tclassName=\"tlui-menu__trigger\"\n\t\t\t\t\tdata-wd=\"main.menu\"\n\t\t\t\t\ttitle={msg('menu.title')}\n\t\t\t\t\ticon=\"menu\"\n\t\t\t\t/>\n\t\t\t</M.Trigger>\n\t\t\t<M.Content alignOffset={0} sideOffset={6}>\n\t\t\t\t<MenuContent />\n\t\t\t</M.Content>\n\t\t</M.Root>\n\t)\n})\n\nfunction MenuContent() {\n\tconst app = useApp()\n\tconst msg = useTranslation()\n\tconst menuSchema = useMenuSchema()\n\tconst breakpoint = useBreakpoint()\n\tconst isReadonly = useReadonly()\n\tconst { paste } = useMenuClipboardEvents()\n\n\tfunction getMenuItem(app: App, item: MenuChild, parent: MenuChild | null, depth: number) {\n\t\tswitch (item.type) {\n\t\t\tcase 'custom': {\n\t\t\t\tif (isReadonly && !item.readonlyOk) return null\n\n\t\t\t\tif (item.id === 'LANGUAGE_MENU') {\n\t\t\t\t\treturn <LanguageMenu key=\"item\" />\n\t\t\t\t}\n\n\t\t\t\tif (item.id === 'MENU_PASTE') {\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<M.Item\n\t\t\t\t\t\t\tkey={item.id}\n\t\t\t\t\t\t\tdata-wd={`menu-item.${item.id}`}\n\t\t\t\t\t\t\tkbd=\"$v\"\n\t\t\t\t\t\t\tlabel=\"action.paste\"\n\t\t\t\t\t\t\tdisabled={item.disabled}\n\t\t\t\t\t\t\tonMouseDown={() => {\n\t\t\t\t\t\t\t\tif (app.isSafari && navigator.clipboard?.read) {\n\t\t\t\t\t\t\t\t\t// NOTE: This must be a onMouseDown for Safari/desktop, onClick doesn't work at the time of writing...\n\t\t\t\t\t\t\t\t\tnavigator.clipboard.read().then((clipboardItems) => {\n\t\t\t\t\t\t\t\t\t\tpaste(clipboardItems)\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\tif (app.isSafari) {\n\t\t\t\t\t\t\t\t\t// noop\n\t\t\t\t\t\t\t\t} else if (navigator.clipboard?.read) {\n\t\t\t\t\t\t\t\t\tnavigator.clipboard.read().then((clipboardItems) => {\n\t\t\t\t\t\t\t\t\t\tpaste(clipboardItems)\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tonPointerUp={preventDefault}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)\n\t\t\t\t}\n\t\t\t\treturn null\n\t\t\t}\n\t\t\tcase 'group': {\n\t\t\t\tif (isReadonly && !item.readonlyOk) return null\n\n\t\t\t\treturn (\n\t\t\t\t\t<M.Group\n\t\t\t\t\t\tsize={\n\t\t\t\t\t\t\tdepth <= 1\n\t\t\t\t\t\t\t\t? 'medium'\n\t\t\t\t\t\t\t\t: breakpoint < 3 || (parent?.type === 'submenu' && depth > 2)\n\t\t\t\t\t\t\t\t? 'tiny'\n\t\t\t\t\t\t\t\t: 'medium'\n\t\t\t\t\t\t}\n\t\t\t\t\t\tkey={item.id}\n\t\t\t\t\t>\n\t\t\t\t\t\t{item.children.map((child) => getMenuItem(app, child, item, depth + 1))}\n\t\t\t\t\t</M.Group>\n\t\t\t\t)\n\t\t\t}\n\t\t\tcase 'submenu': {\n\t\t\t\tif (isReadonly && !item.readonlyOk) return null\n\n\t\t\t\treturn (\n\t\t\t\t\t<M.Sub id={`main menu ${parent ? parent.id + ' ' : ''}${item.id}`} key={item.id}>\n\t\t\t\t\t\t<M.SubTrigger label={item.label} data-wd={`menu-item.${item.id}`} />\n\t\t\t\t\t\t<M.SubContent sideOffset={-4} alignOffset={-1}>\n\t\t\t\t\t\t\t{item.children.map((child) => getMenuItem(app, child, item, depth + 1))}\n\t\t\t\t\t\t</M.SubContent>\n\t\t\t\t\t</M.Sub>\n\t\t\t\t)\n\t\t\t}\n\t\t\tcase 'item': {\n\t\t\t\tif (isReadonly && !item.readonlyOk) return null\n\n\t\t\t\tconst { id, checkbox, menuLabel, label, onSelect, kbd } = item.actionItem\n\t\t\t\tconst labelToUse = menuLabel ?? label\n\t\t\t\tconst labelStr = labelToUse ? msg(labelToUse) : undefined\n\n\t\t\t\tif (checkbox) {\n\t\t\t\t\t// Item is in a checkbox group\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<M.CheckboxItem\n\t\t\t\t\t\t\tkey={id}\n\t\t\t\t\t\t\tonSelect={onSelect}\n\t\t\t\t\t\t\ttitle={labelStr ? labelStr : ''}\n\t\t\t\t\t\t\tchecked={item.checked}\n\t\t\t\t\t\t\tdisabled={item.disabled}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{labelStr && <span>{labelStr}</span>}\n\t\t\t\t\t\t\t{kbd && <Kbd>{kbd}</Kbd>}\n\t\t\t\t\t\t</M.CheckboxItem>\n\t\t\t\t\t)\n\t\t\t\t}\n\n\t\t\t\t// Item is a button\n\t\t\t\treturn (\n\t\t\t\t\t<M.Item\n\t\t\t\t\t\tkey={id}\n\t\t\t\t\t\tdata-wd={`menu-item.${item.id}`}\n\t\t\t\t\t\tkbd={kbd}\n\t\t\t\t\t\tlabel={labelToUse}\n\t\t\t\t\t\tonClick={onSelect}\n\t\t\t\t\t\tdisabled={item.disabled}\n\t\t\t\t\t/>\n\t\t\t\t)\n\t\t\t}\n\t\t}\n\t}\n\n\treturn <>{menuSchema.map((item) => getMenuItem(app, item, null, 0))}</>\n}\n","import { TLPageId, useApp } from '@tldraw/editor'\nimport { useCallback, useRef } from 'react'\nimport { Input } from '../primitives'\n\nexport const PageItemInput = function PageItemInput({\n\tname,\n\tid,\n\tisCurrentPage,\n}: {\n\tname: string\n\tid: TLPageId\n\tisCurrentPage: boolean\n}) {\n\tconst app = useApp()\n\n\tconst rInput = useRef<HTMLInputElement | null>(null)\n\n\tconst handleChange = useCallback(\n\t\t(value: string) => {\n\t\t\tapp.renamePage(id, value ? value : 'New Page', true)\n\t\t},\n\t\t[app, id]\n\t)\n\n\tconst handleComplete = useCallback(\n\t\t(value: string) => {\n\t\t\tapp.mark('rename page')\n\t\t\tapp.renamePage(id, value || 'New Page', false)\n\t\t},\n\t\t[app, id]\n\t)\n\n\treturn (\n\t\t<Input\n\t\t\tclassName=\"tlui-page-menu__item__input\"\n\t\t\tref={(el) => (rInput.current = el)}\n\t\t\tdefaultValue={name}\n\t\t\tonValueChange={handleChange}\n\t\t\tonComplete={handleComplete}\n\t\t\tonCancel={handleComplete}\n\t\t\tshouldManuallyMaintainScrollPositionWhenFocused\n\t\t\tautofocus={isCurrentPage}\n\t\t\tautoselect\n\t\t/>\n\t)\n}\n","import { App, getIndexAbove, getIndexBelow, getIndexBetween, TLPageId } from '@tldraw/editor'\n\nexport const onMovePage = (app: App, id: TLPageId, from: number, to: number) => {\n\tlet index: string\n\n\tconst pages = app.pages\n\n\tconst below = from > to ? pages[to - 1] : pages[to]\n\tconst above = from > to ? pages[to] : pages[to + 1]\n\n\tif (below && !above) {\n\t\tindex = getIndexAbove(below.index)\n\t} else if (!below && above) {\n\t\tindex = getIndexBelow(pages[0].index)\n\t} else {\n\t\tindex = getIndexBetween(below.index, above.index)\n\t}\n\n\tif (index !== pages[from].index) {\n\t\tapp.mark('moving page')\n\t\tapp.updatePage({\n\t\t\tid: id as TLPageId,\n\t\t\tindex,\n\t\t})\n\t}\n}\n","import * as DropdownMenu from '@radix-ui/react-dropdown-menu'\nimport { MAX_PAGES, TLPage, TLPageId, useApp } from '@tldraw/editor'\nimport { useCallback } from 'react'\nimport { track } from 'signia-react'\nimport { useTranslation } from '../../hooks'\nimport { Button } from '../primitives'\nimport * as M from '../primitives/DropdownMenu'\nimport { onMovePage } from './edit-pages-shared'\n\nexport interface PageItemSubmenuProps {\n\tindex: number\n\titem: { id: string; name: string }\n\tlistSize: number\n\tonRename?: () => void\n}\n\nexport const PageItemSubmenu = track(function PageItemSubmenu({\n\tindex,\n\tlistSize,\n\titem,\n\tonRename,\n}: PageItemSubmenuProps) {\n\tconst app = useApp()\n\tconst msg = useTranslation()\n\tconst pages = app.pages\n\n\tconst onDuplicate = useCallback(() => {\n\t\tapp.mark('creating page')\n\t\tconst newId = TLPage.createId()\n\t\tapp.duplicatePage(item.id as TLPageId, newId)\n\t}, [app, item])\n\n\tconst onMoveUp = useCallback(() => {\n\t\tonMovePage(app, item.id as TLPageId, index, index - 1)\n\t}, [app, item, index])\n\n\tconst onMoveDown = useCallback(() => {\n\t\tonMovePage(app, item.id as TLPageId, index, index + 1)\n\t}, [app, item, index])\n\n\tconst onDelete = useCallback(() => {\n\t\tapp.mark('deleting page')\n\t\tapp.deletePage(item.id as TLPageId)\n\t}, [app, item])\n\n\treturn (\n\t\t<M.Root id=\"page item submenu\">\n\t\t\t<M.Trigger>\n\t\t\t\t<Button title={msg('page-menu.submenu.title')} icon=\"dots-vertical\" />\n\t\t\t</M.Trigger>\n\t\t\t<M.Content alignOffset={0}>\n\t\t\t\t<M.Group>\n\t\t\t\t\t{onRename && (\n\t\t\t\t\t\t<DropdownMenu.Item dir=\"ltr\" onSelect={onRename} asChild>\n\t\t\t\t\t\t\t<Button className=\"tlui-menu__button\" label=\"page-menu.submenu.rename\" />\n\t\t\t\t\t\t</DropdownMenu.Item>\n\t\t\t\t\t)}\n\t\t\t\t\t<DropdownMenu.Item\n\t\t\t\t\t\tdir=\"ltr\"\n\t\t\t\t\t\tonSelect={onDuplicate}\n\t\t\t\t\t\tdisabled={pages.length >= MAX_PAGES}\n\t\t\t\t\t\tasChild\n\t\t\t\t\t>\n\t\t\t\t\t\t<Button className=\"tlui-menu__button\" label=\"page-menu.submenu.duplicate-page\" />\n\t\t\t\t\t</DropdownMenu.Item>\n\t\t\t\t\t{index > 0 && (\n\t\t\t\t\t\t<DropdownMenu.Item dir=\"ltr\" onSelect={onMoveUp} asChild>\n\t\t\t\t\t\t\t<Button className=\"tlui-menu__button\" label=\"page-menu.submenu.move-up\" />\n\t\t\t\t\t\t</DropdownMenu.Item>\n\t\t\t\t\t)}\n\t\t\t\t\t{index < listSize - 1 && (\n\t\t\t\t\t\t<DropdownMenu.Item dir=\"ltr\" onSelect={onMoveDown} asChild>\n\t\t\t\t\t\t\t<Button className=\"tlui-menu__button\" label=\"page-menu.submenu.move-down\" />\n\t\t\t\t\t\t</DropdownMenu.Item>\n\t\t\t\t\t)}\n\t\t\t\t</M.Group>\n\t\t\t\t{listSize > 1 && (\n\t\t\t\t\t<M.Group>\n\t\t\t\t\t\t<DropdownMenu.Item dir=\"ltr\" onSelect={onDelete} asChild>\n\t\t\t\t\t\t\t<Button className=\"tlui-menu__button\" label=\"page-menu.submenu.delete\" />\n\t\t\t\t\t\t</DropdownMenu.Item>\n\t\t\t\t\t</M.Group>\n\t\t\t\t)}\n\t\t\t</M.Content>\n\t\t</M.Root>\n\t)\n})\n","import { MAX_PAGES, useApp } from '@tldraw/editor'\nimport { TLPage, TLPageId } from '@tldraw/tlschema'\nimport { useCallback, useEffect, useLayoutEffect, useRef, useState } from 'react'\nimport { track } from 'signia-react'\nimport { useBreakpoint, useTranslation } from '../../hooks'\nimport { Button, Icon } from '../primitives'\nimport { Popover, PopoverContent, PopoverTrigger } from '../primitives/Popover'\nimport { PageItemInput } from './PageItemInput'\nimport { PageItemSubmenu } from './PageItemSubmenu'\nimport { onMovePage } from './edit-pages-shared'\n\nexport const PageMenu = track(function PageMenu() {\n\tconst app = useApp()\n\tconst msg = useTranslation()\n\tconst breakpoint = useBreakpoint()\n\n\tconst ITEM_HEIGHT = breakpoint < 5 ? 36 : 40\n\n\tconst rSortableContainer = useRef<HTMLDivElement>(null)\n\n\tconst { pages, currentPage } = app\n\n\t// When in readonly mode, we don't allow a user to edit the pages\n\tconst isReadonlyMode = app.isReadOnly\n\n\t// If the user has reached the max page count, we disable the \"add page\" button\n\tconst maxPageCountReached = app.pages.length >= MAX_PAGES\n\n\t// The component has an \"editing state\" that may be toggled to expose additional controls\n\tconst [isEditing, setIsEditing] = useState(false)\n\n\tconst toggleEditing = useCallback(() => {\n\t\tif (isReadonlyMode) return\n\t\tsetIsEditing((s) => !s)\n\t}, [isReadonlyMode])\n\n\tconst [isOpen, setIsOpen] = useState(false)\n\n\tconst handleOpenChange = useCallback((isOpen: boolean) => {\n\t\tsetIsOpen(isOpen)\n\t\tsetIsEditing(false)\n\t}, [])\n\n\tconst rMutables = useRef({\n\t\tisPointing: false,\n\t\tstatus: 'idle' as 'idle' | 'pointing' | 'dragging',\n\t\tpointing: null as { id: string; index: number } | null,\n\t\tstartY: 0,\n\t\tstartIndex: 0,\n\t\tdragIndex: 0,\n\t})\n\n\tconst [sortablePositionItems, setSortablePositionItems] = useState(\n\t\tObject.fromEntries(\n\t\t\tpages.map((page, i) => [page.id, { y: i * ITEM_HEIGHT, offsetY: 0, isSelected: false }])\n\t\t)\n\t)\n\n\t// Update the sortable position items when the pages change\n\tuseLayoutEffect(() => {\n\t\tsetSortablePositionItems(\n\t\t\tObject.fromEntries(\n\t\t\t\tpages.map((page, i) => [page.id, { y: i * ITEM_HEIGHT, offsetY: 0, isSelected: false }])\n\t\t\t)\n\t\t)\n\t}, [ITEM_HEIGHT, pages])\n\n\t// Scroll the current page into view when the menu opens / when current page changes\n\tuseEffect(() => {\n\t\tif (!isOpen) return\n\t\trequestAnimationFrame(() => {\n\t\t\tconst elm = document.querySelector(\n\t\t\t\t`[data-wd=\"page-menu-item-${currentPage.id}\"]`\n\t\t\t) as HTMLDivElement\n\n\t\t\tif (elm) {\n\t\t\t\tconst container = rSortableContainer.current\n\t\t\t\tif (!container) return\n\t\t\t\t// Scroll into view is slightly borked on iOS Safari\n\n\t\t\t\t// if top of less than top cuttoff, scroll into view at top\n\t\t\t\tconst elmTopPosition = elm.offsetTop\n\t\t\t\tconst containerScrollTopPosition = container.scrollTop\n\t\t\t\tif (elmTopPosition < containerScrollTopPosition) {\n\t\t\t\t\tcontainer.scrollTo({ top: elmTopPosition })\n\t\t\t\t}\n\t\t\t\t// if bottom position is greater than bottom cutoff, scroll into view at bottom\n\t\t\t\tconst elmBottomPosition = elmTopPosition + ITEM_HEIGHT\n\t\t\t\tconst containerScrollBottomPosition = container.scrollTop + container.offsetHeight\n\t\t\t\tif (elmBottomPosition > containerScrollBottomPosition) {\n\t\t\t\t\tcontainer.scrollTo({ top: elmBottomPosition - container.offsetHeight })\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\t}, [ITEM_HEIGHT, currentPage, isOpen])\n\n\tconst handlePointerDown = useCallback(\n\t\t(e: React.PointerEvent<HTMLButtonElement>) => {\n\t\t\tconst { clientY, currentTarget } = e\n\t\t\tconst {\n\t\t\t\tdataset: { id, index },\n\t\t\t} = currentTarget\n\n\t\t\tif (!id || !index) return\n\n\t\t\tconst mut = rMutables.current\n\n\t\t\te.currentTarget.setPointerCapture(e.pointerId)\n\n\t\t\tmut.status = 'pointing'\n\t\t\tmut.pointing = { id, index: +index! }\n\t\t\tconst current = sortablePositionItems[id]\n\t\t\tconst dragY = current.y\n\n\t\t\tmut.startY = clientY\n\t\t\tmut.startIndex = Math.max(0, Math.min(Math.round(dragY / ITEM_HEIGHT), pages.length - 1))\n\t\t},\n\t\t[ITEM_HEIGHT, pages.length, sortablePositionItems]\n\t)\n\n\tconst handlePointerMove = useCallback(\n\t\t(e: React.PointerEvent<HTMLButtonElement>) => {\n\t\t\tconst mut = rMutables.current\n\t\t\tif (mut.status === 'pointing') {\n\t\t\t\tconst { clientY } = e\n\t\t\t\tconst offset = clientY - mut.startY\n\t\t\t\tif (Math.abs(offset) > 5) {\n\t\t\t\t\tmut.status = 'dragging'\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (mut.status === 'dragging') {\n\t\t\t\tconst { clientY } = e\n\t\t\t\tconst offsetY = clientY - mut.startY\n\t\t\t\tconst current = sortablePositionItems[mut.pointing!.id]\n\n\t\t\t\tconst { startIndex, pointing } = mut\n\t\t\t\tconst dragY = current.y + offsetY\n\t\t\t\tconst dragIndex = Math.max(0, Math.min(Math.round(dragY / ITEM_HEIGHT), pages.length - 1))\n\n\t\t\t\tconst next = { ...sortablePositionItems }\n\t\t\t\tnext[pointing!.id] = {\n\t\t\t\t\ty: current.y,\n\t\t\t\t\toffsetY,\n\t\t\t\t\tisSelected: true,\n\t\t\t\t}\n\n\t\t\t\tif (dragIndex !== mut.dragIndex) {\n\t\t\t\t\tmut.dragIndex = dragIndex\n\n\t\t\t\t\tfor (let i = 0; i < pages.length; i++) {\n\t\t\t\t\t\tconst item = pages[i]\n\t\t\t\t\t\tif (item.id === mut.pointing!.id) {\n\t\t\t\t\t\t\tcontinue\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tlet { y } = next[item.id]\n\n\t\t\t\t\t\tif (dragIndex === startIndex) {\n\t\t\t\t\t\t\ty = i * ITEM_HEIGHT\n\t\t\t\t\t\t} else if (dragIndex < startIndex) {\n\t\t\t\t\t\t\tif (dragIndex <= i && i < startIndex) {\n\t\t\t\t\t\t\t\ty = (i + 1) * ITEM_HEIGHT\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\ty = i * ITEM_HEIGHT\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else if (dragIndex > startIndex) {\n\t\t\t\t\t\t\tif (dragIndex >= i && i > startIndex) {\n\t\t\t\t\t\t\t\ty = (i - 1) * ITEM_HEIGHT\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\ty = i * ITEM_HEIGHT\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (y !== next[item.id].y) {\n\t\t\t\t\t\t\tnext[item.id] = { y, offsetY: 0, isSelected: true }\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tsetSortablePositionItems(next)\n\t\t\t}\n\t\t},\n\t\t[ITEM_HEIGHT, pages, sortablePositionItems]\n\t)\n\n\tconst handlePointerUp = useCallback(\n\t\t(e: React.PointerEvent<HTMLButtonElement>) => {\n\t\t\tconst mut = rMutables.current\n\n\t\t\tif (mut.status === 'dragging') {\n\t\t\t\tconst { id, index } = mut.pointing!\n\t\t\t\tonMovePage(app, id as TLPageId, index, mut.dragIndex)\n\t\t\t}\n\n\t\t\te.currentTarget.releasePointerCapture(e.pointerId)\n\t\t\tmut.status = 'idle'\n\t\t},\n\t\t[app]\n\t)\n\n\tconst handleKeyDown = useCallback(\n\t\t(e: React.KeyboardEvent<HTMLButtonElement>) => {\n\t\t\tconst mut = rMutables.current\n\t\t\t// bail on escape\n\t\t\tif (e.key === 'Escape') {\n\t\t\t\tif (mut.status === 'dragging') {\n\t\t\t\t\tsetSortablePositionItems(\n\t\t\t\t\t\tObject.fromEntries(\n\t\t\t\t\t\t\tpages.map((page, i) => [\n\t\t\t\t\t\t\t\tpage.id,\n\t\t\t\t\t\t\t\t{ y: i * ITEM_HEIGHT, offsetY: 0, isSelected: false },\n\t\t\t\t\t\t\t])\n\t\t\t\t\t\t)\n\t\t\t\t\t)\n\t\t\t\t}\n\n\t\t\t\tmut.status = 'idle'\n\t\t\t}\n\t\t},\n\t\t[ITEM_HEIGHT, pages]\n\t)\n\n\tconst handleCreatePageClick = useCallback(() => {\n\t\tif (isReadonlyMode) return\n\n\t\tapp.mark('creating page')\n\t\tconst newPageId = TLPage.createId()\n\t\tapp.createPage(msg('page-menu.new-page-initial-name'), newPageId)\n\t\tsetIsEditing(true)\n\t}, [app, msg, isReadonlyMode])\n\n\treturn (\n\t\t<Popover id=\"page menu\" onOpenChange={handleOpenChange} open={isOpen}>\n\t\t\t<PopoverTrigger>\n\t\t\t\t<Button\n\t\t\t\t\tclassName=\"tlui-page-menu__trigger tlui-menu__trigger\"\n\t\t\t\t\tdata-wd=\"main.page-menu\"\n\t\t\t\t\ticon=\"chevron-down\"\n\t\t\t\t\ttitle={currentPage.name}\n\t\t\t\t>\n\t\t\t\t\t<div className=\"tlui-page-menu__name\">{currentPage.name}</div>\n\t\t\t\t</Button>\n\t\t\t</PopoverTrigger>\n\t\t\t<PopoverContent side=\"bottom\" align=\"start\" sideOffset={6}>\n\t\t\t\t<div className=\"tlui-page-menu__wrapper\">\n\t\t\t\t\t<div className=\"tlui-page-menu__header\">\n\t\t\t\t\t\t<div className=\"tlui-page-menu__header__title\">{msg('page-menu.title')}</div>\n\t\t\t\t\t\t{!isReadonlyMode && (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\tdata-wd=\"page-menu.edit\"\n\t\t\t\t\t\t\t\t\ttitle={msg(isEditing ? 'page-menu.edit-done' : 'page-menu.edit-start')}\n\t\t\t\t\t\t\t\t\ticon={isEditing ? 'check' : 'edit'}\n\t\t\t\t\t\t\t\t\tonClick={toggleEditing}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\tdata-wd=\"page-menu.create\"\n\t\t\t\t\t\t\t\t\ticon=\"plus\"\n\t\t\t\t\t\t\t\t\ttitle={msg(\n\t\t\t\t\t\t\t\t\t\tmaxPageCountReached\n\t\t\t\t\t\t\t\t\t\t\t? 'page-menu.max-page-count-reached'\n\t\t\t\t\t\t\t\t\t\t\t: 'page-menu.create-new-page'\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\tdisabled={maxPageCountReached}\n\t\t\t\t\t\t\t\t\tonClick={handleCreatePageClick}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclassName=\"tlui-page-menu__list tlui-menu__group\"\n\t\t\t\t\t\tstyle={{ height: ITEM_HEIGHT * pages.length + 4 }}\n\t\t\t\t\t\tref={rSortableContainer}\n\t\t\t\t\t>\n\t\t\t\t\t\t{pages.map((page, index) => {\n\t\t\t\t\t\t\tconst position = sortablePositionItems[page.id] ?? {\n\t\t\t\t\t\t\t\tposition: index * 40,\n\t\t\t\t\t\t\t\toffsetY: 0,\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\treturn isEditing ? (\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tkey={page.id + '_editing'}\n\t\t\t\t\t\t\t\t\tdata-wd={`page-menu-item-${page.id}`}\n\t\t\t\t\t\t\t\t\tclassName=\"tlui-page_menu__item__sortable\"\n\t\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\t\tzIndex: page.id === currentPage.id ? 888 : index,\n\t\t\t\t\t\t\t\t\t\ttransform: `translate(0px, ${position.y + position.offsetY}px)`,\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\ttabIndex={-1}\n\t\t\t\t\t\t\t\t\t\tclassName=\"tlui-page_menu__item__sortable__handle\"\n\t\t\t\t\t\t\t\t\t\ticon=\"drag-handle-dots\"\n\t\t\t\t\t\t\t\t\t\tonPointerDown={handlePointerDown}\n\t\t\t\t\t\t\t\t\t\tonPointerUp={handlePointerUp}\n\t\t\t\t\t\t\t\t\t\tonPointerMove={handlePointerMove}\n\t\t\t\t\t\t\t\t\t\tonKeyDown={handleKeyDown}\n\t\t\t\t\t\t\t\t\t\tdata-id={page.id}\n\t\t\t\t\t\t\t\t\t\tdata-index={index}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t{breakpoint < 5 && app.isCoarsePointer ? (\n\t\t\t\t\t\t\t\t\t\t// sigh, this is a workaround for iOS Safari\n\t\t\t\t\t\t\t\t\t\t// because the device and the radix popover seem\n\t\t\t\t\t\t\t\t\t\t// to be fighting over scroll position. Nothing\n\t\t\t\t\t\t\t\t\t\t// else seems to work!\n\t\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"tlui-page-menu__item__button\"\n\t\t\t\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\t\t\t\tconst name = window.prompt('Rename page', page.name)\n\t\t\t\t\t\t\t\t\t\t\t\tif (name && name !== page.name) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tapp.renamePage(page.id, name)\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\tonDoubleClick={toggleEditing}\n\t\t\t\t\t\t\t\t\t\t\tisChecked={page.id === currentPage.id}\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t<span>{page.name}</span>\n\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\tid={`page-menu-item-${page.id}`}\n\t\t\t\t\t\t\t\t\t\t\tdata-wd={`page-menu-item-${page.id}`}\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"tlui-page_menu__item__sortable__title\"\n\t\t\t\t\t\t\t\t\t\t\tstyle={{ height: ITEM_HEIGHT }}\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t<PageItemInput\n\t\t\t\t\t\t\t\t\t\t\t\tid={page.id}\n\t\t\t\t\t\t\t\t\t\t\t\tname={page.name}\n\t\t\t\t\t\t\t\t\t\t\t\tisCurrentPage={page.id === currentPage.id}\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t{!isReadonlyMode && (\n\t\t\t\t\t\t\t\t\t\t<div className=\"tlui-page_menu__item__submenu\" data-isediting={isEditing}>\n\t\t\t\t\t\t\t\t\t\t\t<PageItemSubmenu index={index} item={page} listSize={pages.length} />\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tkey={page.id}\n\t\t\t\t\t\t\t\t\tdata-wd={`page-menu-item-${page.id}`}\n\t\t\t\t\t\t\t\t\tclassName=\"tlui-page-menu__item\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\tclassName=\"tlui-page-menu__item__button tlui-page-menu__item__button__checkbox\"\n\t\t\t\t\t\t\t\t\t\tonClick={() => app.setCurrentPageId(page.id)}\n\t\t\t\t\t\t\t\t\t\tonDoubleClick={toggleEditing}\n\t\t\t\t\t\t\t\t\t\tisChecked={page.id === currentPage.id}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<div className=\"tlui-page-menu__item__button__check\">\n\t\t\t\t\t\t\t\t\t\t\t{page.id === currentPage.id && <Icon icon=\"check\" />}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<span>{page.name}</span>\n\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t{!isReadonlyMode && (\n\t\t\t\t\t\t\t\t\t\t<div className=\"tlui-page_menu__item__submenu\">\n\t\t\t\t\t\t\t\t\t\t\t<PageItemSubmenu\n\t\t\t\t\t\t\t\t\t\t\t\tindex={index}\n\t\t\t\t\t\t\t\t\t\t\t\titem={page}\n\t\t\t\t\t\t\t\t\t\t\t\tlistSize={pages.length}\n\t\t\t\t\t\t\t\t\t\t\t\tonRename={() => {\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (app.isIos) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst name = window.prompt('Rename page', page.name)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (name && name !== page.name) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tapp.renamePage(page.id, name)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetIsEditing(true)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tapp.setCurrentPageId(page.id)\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t})}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</PopoverContent>\n\t\t</Popover>\n\t)\n})\n","import { memo } from 'react'\nimport { useActions, useCanRedo, useTranslation } from '../../hooks'\nimport { Button, kbdStr } from '../primitives'\n\nexport const RedoButton = memo(function RedoButton() {\n\tconst msg = useTranslation()\n\tconst canRedo = useCanRedo()\n\tconst actions = useActions()\n\n\tconst redo = actions['redo']\n\n\treturn (\n\t\t<Button\n\t\t\tdata-wd=\"main.redo\"\n\t\t\ticon={redo.icon}\n\t\t\ttitle={`${msg(redo.label!)} ${kbdStr(redo.kbd!)}`}\n\t\t\tdisabled={!canRedo}\n\t\t\tonClick={redo.onSelect}\n\t\t\tsmallIcon\n\t\t/>\n\t)\n})\n","import { useApp } from '@tldraw/editor'\nimport { track } from 'signia-react'\nimport { useActions, useReadonly, useTranslation } from '../../hooks'\nimport { Button, kbdStr } from '../primitives'\n\nexport const TrashButton = track(function TrashButton() {\n\tconst app = useApp()\n\tconst actions = useActions()\n\tconst msg = useTranslation()\n\tconst action = actions['delete']\n\n\tconst isReadonly = useReadonly()\n\tif (isReadonly) return null\n\n\tconst noSelected = app.selectedIds.length <= 0\n\n\treturn (\n\t\t<Button\n\t\t\ticon={action.icon}\n\t\t\tonClick={action.onSelect}\n\t\t\tdisabled={noSelected}\n\t\t\ttitle={`${msg(action.label!)} ${kbdStr(action.kbd!)}`}\n\t\t\tsmallIcon\n\t\t/>\n\t)\n})\n","import { memo } from 'react'\nimport { useActions, useCanUndo, useTranslation } from '../../hooks'\nimport { Button, kbdStr } from '../primitives'\n\nexport const UndoButton = memo(function UndoButton() {\n\tconst msg = useTranslation()\n\tconst canUndo = useCanUndo()\n\tconst actions = useActions()\n\n\tconst undo = actions['undo']\n\n\treturn (\n\t\t<Button\n\t\t\tdata-wd=\"main.undo\"\n\t\t\ticon={undo.icon}\n\t\t\ttitle={`${msg(undo.label!)} ${kbdStr(undo.kbd!)}`}\n\t\t\tdisabled={!canUndo}\n\t\t\tonClick={undo.onSelect}\n\t\t\tsmallIcon\n\t\t/>\n\t)\n})\n","import { track } from 'signia-react'\nimport { useBreakpoint, useReadonly } from '../../hooks'\nimport { ActionsMenu } from '../ActionsMenu'\nimport { DuplicateButton } from '../DuplicateButton'\nimport { Menu } from '../Menu'\nimport { PageMenu } from '../PageMenu'\nimport { RedoButton } from '../RedoButton'\nimport { TrashButton } from '../TrashButton'\nimport { UndoButton } from '../UndoButton'\n\nexport const MenuZone = track(function MenuZone() {\n\tconst breakpoint = useBreakpoint()\n\tconst isReadonly = useReadonly()\n\n\treturn (\n\t\t<div className=\"tlui-menu-zone\">\n\t\t\t<div className=\"tlui-menu-zone__controls\">\n\t\t\t\t<Menu />\n\t\t\t\t<div className=\"tlui-menu-zone__divider\" />\n\t\t\t\t<PageMenu />\n\t\t\t\t{breakpoint >= 5 && !isReadonly && (\n\t\t\t\t\t<>\n\t\t\t\t\t\t<div className=\"tlui-menu-zone__divider\" />\n\t\t\t\t\t\t<UndoButton />\n\t\t\t\t\t\t<RedoButton />\n\t\t\t\t\t\t<TrashButton />\n\t\t\t\t\t\t<DuplicateButton />\n\t\t\t\t\t\t<ActionsMenu />\n\t\t\t\t\t</>\n\t\t\t\t)}\n\t\t\t</div>\n\t\t</div>\n\t)\n})\n","import * as T from '@radix-ui/react-toast'\nimport * as React from 'react'\nimport { TLToast, useToasts, useTranslation } from '../../hooks'\nimport { TLUiIconType } from '../../icon-types'\nimport { Button, Icon } from '../primitives'\n\nfunction Toast({ toast }: { toast: TLToast }) {\n\tconst { removeToast } = useToasts()\n\tconst msg = useTranslation()\n\n\tconst onOpenChange = (isOpen: boolean) => {\n\t\tif (!isOpen) {\n\t\t\tremoveToast(toast.id)\n\t\t}\n\t}\n\n\tconst hasActions = toast.actions && toast.actions.length > 0\n\n\treturn (\n\t\t<T.Root\n\t\t\tonOpenChange={onOpenChange}\n\t\t\tclassName=\"tlui-toast__container\"\n\t\t\tduration={toast.keepOpen ? Infinity : 5000}\n\t\t>\n\t\t\t{toast.icon && (\n\t\t\t\t<div className=\"tlui-toast__icon\">\n\t\t\t\t\t<Icon icon={toast.icon as TLUiIconType} />\n\t\t\t\t</div>\n\t\t\t)}\n\t\t\t<div className=\"tlui-toast__main\">\n\t\t\t\t<div className=\"tlui-toast__content\">\n\t\t\t\t\t<T.Title className=\"tlui-toast__title\">{toast.title}</T.Title>\n\t\t\t\t\t<T.Description className=\"tlui-toast__description\">{toast.description}</T.Description>\n\t\t\t\t</div>\n\t\t\t\t{toast.actions && (\n\t\t\t\t\t<div className=\"tlui-toast__actions\">\n\t\t\t\t\t\t{toast.actions.map((action, i) => (\n\t\t\t\t\t\t\t<T.Action key={i} altText={action.label} asChild onClick={action.onClick}>\n\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\tclassName={\n\t\t\t\t\t\t\t\t\t\taction.type === 'warn' ? 'tlui-button__warning' : 'tlui-button__primary'\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{action.label}\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t</T.Action>\n\t\t\t\t\t\t))}\n\t\t\t\t\t\t{hasActions && (\n\t\t\t\t\t\t\t<T.Close asChild>\n\t\t\t\t\t\t\t\t<Button className=\"tlui-toast__close\" style={{ marginLeft: 'auto' }}>\n\t\t\t\t\t\t\t\t\t{toast.closeLabel ?? msg('toast.close')}\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t</T.Close>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t</div>\n\t\t\t{!hasActions && (\n\t\t\t\t<T.Close asChild>\n\t\t\t\t\t<Button className=\"tlui-toast__close\">{toast.closeLabel ?? msg('toast.close')}</Button>\n\t\t\t\t</T.Close>\n\t\t\t)}\n\t\t</T.Root>\n\t)\n}\n\nfunction _Toasts() {\n\tconst { toasts } = useToasts()\n\n\treturn (\n\t\t<>\n\t\t\t{toasts.map((toast) => (\n\t\t\t\t<Toast key={toast.id} toast={toast} />\n\t\t\t))}\n\t\t</>\n\t)\n}\n\nexport const Toasts = React.memo(_Toasts)\n\nexport function ToastViewport() {\n\tconst { toasts } = useToasts()\n\n\tconst [hasToasts, setHasToasts] = React.useState(false)\n\n\tReact.useEffect(() => {\n\t\tlet cancelled = false\n\t\tif (toasts.length) {\n\t\t\tsetHasToasts(true)\n\t\t} else {\n\t\t\tsetTimeout(() => {\n\t\t\t\tif (!cancelled) {\n\t\t\t\t\tsetHasToasts(false)\n\t\t\t\t}\n\t\t\t}, 1000)\n\t\t}\n\n\t\treturn () => {\n\t\t\tcancelled = true\n\t\t}\n\t}, [toasts.length, setHasToasts])\n\n\tif (!hasToasts) return null\n\n\treturn <T.ToastViewport className=\"tlui-toast__viewport\" />\n}\n","import { useApp } from '@tldraw/editor'\nimport { useCallback } from 'react'\nimport { useValue } from 'signia-react'\nimport { StylePanel } from '../StylePanel'\nimport { Button, Icon } from '../primitives'\nimport { Popover, PopoverContent, PopoverTrigger } from '../primitives/Popover'\n\nexport function MobileStylePanel() {\n\tconst app = useApp()\n\n\tconst currentColor = useValue(\n\t\t'current color',\n\t\t() => {\n\t\t\tconst { props } = app\n\t\t\treturn props ? (props.color ? app.getCssColor(props.color) : null) : 'var(--color-muted-1)'\n\t\t},\n\t\t[app]\n\t)\n\n\tconst disableStylePanel = useValue(\n\t\t'isHandOrEraserToolActive',\n\t\t() => app.currentToolId === 'hand' || app.currentToolId === 'eraser',\n\t\t[app]\n\t)\n\n\tconst handleStylesOpenChange = useCallback(\n\t\t(isOpen: boolean) => {\n\t\t\tif (!isOpen) {\n\t\t\t\tapp.isChangingStyle = false\n\t\t\t}\n\t\t},\n\t\t[app]\n\t)\n\n\treturn (\n\t\t<Popover id=\"style menu\" onOpenChange={handleStylesOpenChange}>\n\t\t\t<PopoverTrigger disabled={disableStylePanel}>\n\t\t\t\t<Button\n\t\t\t\t\tclassName=\"tlui-toolbar__tools__button tlui-toolbar__styles__button tlui-popover__trigger\"\n\t\t\t\t\tdata-wd=\"mobile.styles\"\n\t\t\t\t\tstyle={{ color: currentColor ?? 'var(--color-text)' }}\n\t\t\t\t>\n\t\t\t\t\t<Icon icon={currentColor ? 'blob' : 'mixed'} />\n\t\t\t\t</Button>\n\t\t\t</PopoverTrigger>\n\t\t\t<PopoverContent side=\"top\" align=\"end\">\n\t\t\t\t<StylePanel isMobile />\n\t\t\t</PopoverContent>\n\t\t</Popover>\n\t)\n}\n","import { useApp } from '@tldraw/editor'\nimport classNames from 'classnames'\nimport { track } from 'signia-react'\nimport { useBreakpoint, useTranslation } from '../../hooks'\nimport { Button } from '../primitives'\n\ninterface ToggleToolLockedButtonProps {\n\tactiveToolId?: string\n}\n\nexport const ToggleToolLockedButton = track(function ToolLockButton({\n\tactiveToolId,\n}: ToggleToolLockedButtonProps) {\n\tconst app = useApp()\n\tconst breakpoint = useBreakpoint()\n\tconst msg = useTranslation()\n\tconst {\n\t\tinstanceState: { isToolLocked },\n\t} = app\n\n\tconst isLockable = !(\n\t\tactiveToolId === 'select' ||\n\t\tactiveToolId === 'hand' ||\n\t\tactiveToolId === 'draw' ||\n\t\tactiveToolId === 'eraser' ||\n\t\tactiveToolId === 'text'\n\t)\n\n\tif (!isLockable) return null\n\n\treturn (\n\t\t<Button\n\t\t\ttitle={msg('action.toggle-tool-lock')}\n\t\t\tclassName={classNames('tlui-toolbar__lock-button', {\n\t\t\t\t'tlui-toolbar__lock-button__mobile': breakpoint < 5,\n\t\t\t})}\n\t\t\ticon={app.instanceState.isToolLocked ? 'lock' : 'unlock'}\n\t\t\tonClick={() => app.updateInstanceState({ isToolLocked: !isToolLocked })}\n\t\t\tsmallIcon\n\t\t/>\n\t)\n})\n","import { useApp } from '@tldraw/editor'\nimport classNames from 'classnames'\nimport React from 'react'\nimport { track } from 'signia-react'\nimport {\n\tisActiveToolItem,\n\tToolbarItem,\n\tToolItem,\n\tuseBreakpoint,\n\tuseToolbarSchema,\n\tuseTranslation,\n} from '../../hooks'\nimport { ActionsMenu } from '../ActionsMenu'\nimport { DuplicateButton } from '../DuplicateButton'\nimport { MobileStylePanel } from '../MobileStylePanel'\nimport { Button, kbdStr } from '../primitives'\nimport * as M from '../primitives/DropdownMenu'\nimport { RedoButton } from '../RedoButton/RedoButton'\nimport { TrashButton } from '../TrashButton'\nimport { UndoButton } from '../UndoButton'\nimport { ToggleToolLockedButton } from './ToggleToolLockedButton'\n\n/** @public */\nexport const Toolbar = track(function Toolbar() {\n\tconst app = useApp()\n\tconst msg = useTranslation()\n\tconst breakpoint = useBreakpoint()\n\n\tconst rMostRecentlyActiveDropdownItem = React.useRef<ToolbarItem | undefined>(undefined)\n\n\tconst isReadonlyMode = app.isReadOnly\n\tconst toolbarItems = useToolbarSchema()\n\n\tconst activeToolId = app.currentToolId\n\tconst geoState = app.props ? app.props.geo : undefined\n\n\tconst getTitle = (item: ToolItem) =>\n\t\titem.label ? `${msg(item.label)} ${item.kbd ? kbdStr(item.kbd) : ''}` : ''\n\n\tconst activeToolbarItem = toolbarItems.find((item) => {\n\t\treturn isActiveToolItem(item.toolItem, activeToolId, geoState)\n\t})\n\n\tconst { itemsInPanel, itemsInDropdown, dropdownFirstItem } = React.useMemo(() => {\n\t\tconst itemsInPanel: ToolbarItem[] = []\n\t\tconst itemsInDropdown: ToolbarItem[] = []\n\t\tlet dropdownFirstItem: ToolbarItem | undefined\n\n\t\tconst overflowIndex = Math.min(8, 5 + breakpoint)\n\n\t\tfor (let i = 4; i < toolbarItems.length; i++) {\n\t\t\tconst item = toolbarItems[i]\n\t\t\tif (i < overflowIndex) {\n\t\t\t\t// Items below the overflow index will always be in the panel\n\t\t\t\titemsInPanel.push(item)\n\t\t\t} else {\n\t\t\t\t// Items above will be in the dropdown menu unless the item\n\t\t\t\t// is active (or was the most recently selected active item)\n\t\t\t\tif (item === activeToolbarItem) {\n\t\t\t\t\t// If the dropdown item is active, make it the dropdownFirstItem\n\t\t\t\t\tdropdownFirstItem = item\n\t\t\t\t}\n\t\t\t\t// Otherwise, add it to the items in dropdown menu\n\t\t\t\titemsInDropdown.push(item)\n\t\t\t}\n\t\t}\n\n\t\tif (dropdownFirstItem) {\n\t\t\t// noop\n\t\t} else {\n\t\t\t// If we don't have a currently active dropdown item, use the most\n\t\t\t// recently active dropdown item as the current dropdown first item.\n\n\t\t\t// If haven't ever had a most recently active dropdown item, then\n\t\t\t// make the first item in the dropdown menu the most recently\n\t\t\t// active dropdown item.\n\t\t\tif (!rMostRecentlyActiveDropdownItem.current) {\n\t\t\t\trMostRecentlyActiveDropdownItem.current = itemsInDropdown[0]\n\t\t\t}\n\n\t\t\tdropdownFirstItem = rMostRecentlyActiveDropdownItem.current\n\n\t\t\t// If the most recently active dropdown item is no longer in the\n\t\t\t// dropdown (because the breakpoint has changed) then make the\n\t\t\t// first item in the dropdown menu the most recently active\n\t\t\t// dropdown item.\n\t\t\tif (!itemsInDropdown.includes(dropdownFirstItem)) {\n\t\t\t\tdropdownFirstItem = itemsInDropdown[0]\n\t\t\t}\n\t\t}\n\n\t\t// We want this ref set to remember which item from the current\n\t\t// set of dropdown items was most recently active\n\t\trMostRecentlyActiveDropdownItem.current = dropdownFirstItem\n\n\t\tif (itemsInDropdown.length <= 2) {\n\t\t\titemsInPanel.push(...itemsInDropdown)\n\t\t\titemsInDropdown.length = 0\n\t\t}\n\n\t\treturn { itemsInPanel, itemsInDropdown, dropdownFirstItem }\n\t}, [toolbarItems, activeToolbarItem, breakpoint])\n\n\treturn (\n\t\t<div className=\"tlui-toolbar\">\n\t\t\t<div className=\"tlui-toolbar__inner\">\n\t\t\t\t<div className=\"tlui-toolbar__left\">\n\t\t\t\t\t{!isReadonlyMode && (\n\t\t\t\t\t\t<div className=\"tlui-toolbar__extras\">\n\t\t\t\t\t\t\t{breakpoint < 5 && (\n\t\t\t\t\t\t\t\t<div className=\"tlui-toolbar__extras__controls\">\n\t\t\t\t\t\t\t\t\t<UndoButton />\n\t\t\t\t\t\t\t\t\t<RedoButton />\n\t\t\t\t\t\t\t\t\t<TrashButton />\n\t\t\t\t\t\t\t\t\t<DuplicateButton />\n\t\t\t\t\t\t\t\t\t<ActionsMenu />\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t<ToggleToolLockedButton activeToolId={activeToolId} />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\t\t\t\t\t<div\n\t\t\t\t\t\tclassName={classNames('tlui-toolbar__tools', {\n\t\t\t\t\t\t\t'tlui-toolbar__tools__mobile': breakpoint < 5,\n\t\t\t\t\t\t})}\n\t\t\t\t\t>\n\t\t\t\t\t\t{/* Select / Hand */}\n\t\t\t\t\t\t{toolbarItems.slice(0, 2).map(({ toolItem }) => (\n\t\t\t\t\t\t\t<ToolbarButton\n\t\t\t\t\t\t\t\tkey={toolItem.id}\n\t\t\t\t\t\t\t\titem={toolItem}\n\t\t\t\t\t\t\t\ttitle={getTitle(toolItem)}\n\t\t\t\t\t\t\t\tisSelected={isActiveToolItem(toolItem, activeToolId, geoState)}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t))}\n\t\t\t\t\t\t{!isReadonlyMode && (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t{/* Draw / Eraser */}\n\t\t\t\t\t\t\t\t<div className=\"tlui-toolbar__divider\" />\n\t\t\t\t\t\t\t\t{toolbarItems.slice(2, 4).map(({ toolItem }) => (\n\t\t\t\t\t\t\t\t\t<ToolbarButton\n\t\t\t\t\t\t\t\t\t\tkey={toolItem.id}\n\t\t\t\t\t\t\t\t\t\titem={toolItem}\n\t\t\t\t\t\t\t\t\t\ttitle={getTitle(toolItem)}\n\t\t\t\t\t\t\t\t\t\tisSelected={isActiveToolItem(toolItem, activeToolId, geoState)}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t{/* Everything Else */}\n\t\t\t\t\t\t\t\t<div className=\"tlui-toolbar__divider\" />\n\t\t\t\t\t\t\t\t{itemsInPanel.map(({ toolItem }) => (\n\t\t\t\t\t\t\t\t\t<ToolbarButton\n\t\t\t\t\t\t\t\t\t\tkey={toolItem.id}\n\t\t\t\t\t\t\t\t\t\titem={toolItem}\n\t\t\t\t\t\t\t\t\t\ttitle={getTitle(toolItem)}\n\t\t\t\t\t\t\t\t\t\tisSelected={isActiveToolItem(toolItem, activeToolId, geoState)}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t{/* Overflowing Shapes */}\n\t\t\t\t\t\t\t\t{itemsInDropdown.length ? (\n\t\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t\t{/* Last selected (or first) item from the overflow */}\n\t\t\t\t\t\t\t\t\t\t<ToolbarButton\n\t\t\t\t\t\t\t\t\t\t\tkey={dropdownFirstItem.toolItem.id}\n\t\t\t\t\t\t\t\t\t\t\titem={dropdownFirstItem.toolItem}\n\t\t\t\t\t\t\t\t\t\t\ttitle={getTitle(dropdownFirstItem.toolItem)}\n\t\t\t\t\t\t\t\t\t\t\tisSelected={isActiveToolItem(\n\t\t\t\t\t\t\t\t\t\t\t\tdropdownFirstItem.toolItem,\n\t\t\t\t\t\t\t\t\t\t\t\tactiveToolId,\n\t\t\t\t\t\t\t\t\t\t\t\tgeoState\n\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t{/* The dropdown to select everything else */}\n\t\t\t\t\t\t\t\t\t\t<M.Root id=\"toolbar overflow\" modal={false}>\n\t\t\t\t\t\t\t\t\t\t\t<M.Trigger>\n\t\t\t\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"tlui-toolbar__tools__button tlui-toolbar__overflow\"\n\t\t\t\t\t\t\t\t\t\t\t\t\ticon=\"chevron-up\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tdata-wd=\"tools.more\"\n\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t</M.Trigger>\n\t\t\t\t\t\t\t\t\t\t\t<M.Content side=\"top\" align=\"center\">\n\t\t\t\t\t\t\t\t\t\t\t\t<OverflowToolsContent toolbarItems={itemsInDropdown} />\n\t\t\t\t\t\t\t\t\t\t\t</M.Content>\n\t\t\t\t\t\t\t\t\t\t</M.Root>\n\t\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t\t) : null}\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t{breakpoint < 5 && !isReadonlyMode && (\n\t\t\t\t\t<div className=\"tlui-toolbar__tools\">\n\t\t\t\t\t\t<MobileStylePanel />\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t</div>\n\t\t</div>\n\t)\n})\n\nconst OverflowToolsContent = track(function OverflowToolsContent({\n\ttoolbarItems,\n}: {\n\ttoolbarItems: ToolbarItem[]\n}) {\n\tconst msg = useTranslation()\n\treturn (\n\t\t<div className=\"tlui-button-grid__four tlui-button-grid__reverse\">\n\t\t\t{toolbarItems.map(({ toolItem: { id, meta, kbd, label, onSelect, icon } }) => {\n\t\t\t\treturn (\n\t\t\t\t\t<M.Item\n\t\t\t\t\t\tkey={id}\n\t\t\t\t\t\tclassName=\"tlui-button-grid__button\"\n\t\t\t\t\t\tdata-wd={`tools.${id}`}\n\t\t\t\t\t\tdata-tool={id}\n\t\t\t\t\t\tdata-geo={meta?.geo ?? ''}\n\t\t\t\t\t\taria-label={label}\n\t\t\t\t\t\tonClick={onSelect}\n\t\t\t\t\t\ttitle={label ? `${msg(label)} ${kbd ? kbdStr(kbd) : ''}` : ''}\n\t\t\t\t\t\ticon={icon}\n\t\t\t\t\t/>\n\t\t\t\t)\n\t\t\t})}\n\t\t</div>\n\t)\n})\n\nfunction ToolbarButton({\n\titem,\n\ttitle,\n\tisSelected,\n}: {\n\titem: ToolItem\n\ttitle: string\n\tisSelected: boolean\n}) {\n\treturn (\n\t\t<Button\n\t\t\tkey={item.id}\n\t\t\tclassName=\"tlui-toolbar__tools__button\"\n\t\t\tdata-wd={`tools.${item.id}`}\n\t\t\tdata-tool={item.id}\n\t\t\tdata-geo={item.meta?.geo ?? ''}\n\t\t\taria-label={item.label}\n\t\t\ttitle={title}\n\t\t\ticon={item.icon}\n\t\t\tdata-state={isSelected ? 'selected' : undefined}\n\t\t\tonClick={item.onSelect}\n\t\t\tonTouchStart={(e) => {\n\t\t\t\te.preventDefault()\n\t\t\t\titem.onSelect()\n\t\t\t}}\n\t\t/>\n\t)\n}\n","// This file is automatically generated by scripts/refresh-assets.ts.\n// Do not edit manually.\n\n/** @public */\nexport type TLUiIconType =\n\t| 'align-bottom'\n\t| 'align-center-horizontal'\n\t| 'align-center-vertical'\n\t| 'align-left'\n\t| 'align-right'\n\t| 'align-top'\n\t| 'arrow-left'\n\t| 'arrowhead-arrow'\n\t| 'arrowhead-bar'\n\t| 'arrowhead-diamond'\n\t| 'arrowhead-dot'\n\t| 'arrowhead-none'\n\t| 'arrowhead-square'\n\t| 'arrowhead-triangle-inverted'\n\t| 'arrowhead-triangle'\n\t| 'aspect-ratio'\n\t| 'avatar'\n\t| 'blob'\n\t| 'bring-forward'\n\t| 'bring-to-front'\n\t| 'check'\n\t| 'checkbox-checked'\n\t| 'checkbox-empty'\n\t| 'chevron-down'\n\t| 'chevron-left'\n\t| 'chevron-right'\n\t| 'chevron-up'\n\t| 'chevrons-ne'\n\t| 'chevrons-sw'\n\t| 'clipboard-copy'\n\t| 'code'\n\t| 'collab'\n\t| 'color'\n\t| 'comment'\n\t| 'cross-2'\n\t| 'cross'\n\t| 'dash-dashed'\n\t| 'dash-dotted'\n\t| 'dash-draw'\n\t| 'dash-solid'\n\t| 'discord'\n\t| 'distribute-horizontal'\n\t| 'distribute-vertical'\n\t| 'dot'\n\t| 'dots-horizontal'\n\t| 'dots-vertical'\n\t| 'drag-handle-dots'\n\t| 'duplicate'\n\t| 'edit'\n\t| 'external-link'\n\t| 'file'\n\t| 'fill-none'\n\t| 'fill-pattern'\n\t| 'fill-semi'\n\t| 'fill-solid'\n\t| 'font-draw'\n\t| 'font-mono'\n\t| 'font-sans'\n\t| 'font-serif'\n\t| 'geo-arrow-down'\n\t| 'geo-arrow-left'\n\t| 'geo-arrow-right'\n\t| 'geo-arrow-up'\n\t| 'geo-diamond'\n\t| 'geo-ellipse'\n\t| 'geo-hexagon'\n\t| 'geo-octagon'\n\t| 'geo-oval'\n\t| 'geo-pentagon'\n\t| 'geo-rectangle'\n\t| 'geo-rhombus-2'\n\t| 'geo-rhombus'\n\t| 'geo-star'\n\t| 'geo-trapezoid'\n\t| 'geo-triangle'\n\t| 'geo-x-box'\n\t| 'github'\n\t| 'group'\n\t| 'hidden'\n\t| 'image'\n\t| 'info-circle'\n\t| 'link'\n\t| 'lock-small'\n\t| 'lock'\n\t| 'menu'\n\t| 'minus'\n\t| 'mixed'\n\t| 'pack'\n\t| 'page'\n\t| 'plus'\n\t| 'question-mark-circle'\n\t| 'question-mark'\n\t| 'redo'\n\t| 'reset-zoom'\n\t| 'rotate-ccw'\n\t| 'rotate-cw'\n\t| 'ruler'\n\t| 'search'\n\t| 'send-backward'\n\t| 'send-to-back'\n\t| 'settings-horizontal'\n\t| 'settings-vertical-1'\n\t| 'settings-vertical'\n\t| 'share-1'\n\t| 'share-2'\n\t| 'size-extra-large'\n\t| 'size-large'\n\t| 'size-medium'\n\t| 'size-small'\n\t| 'spline-cubic'\n\t| 'spline-line'\n\t| 'stack-horizontal'\n\t| 'stack-vertical'\n\t| 'stretch-horizontal'\n\t| 'stretch-vertical'\n\t| 'text-align-center'\n\t| 'text-align-justify'\n\t| 'text-align-left'\n\t| 'text-align-right'\n\t| 'tool-arrow'\n\t| 'tool-embed'\n\t| 'tool-eraser'\n\t| 'tool-frame'\n\t| 'tool-hand'\n\t| 'tool-highlighter'\n\t| 'tool-line'\n\t| 'tool-media'\n\t| 'tool-note'\n\t| 'tool-pencil'\n\t| 'tool-pointer'\n\t| 'tool-text'\n\t| 'trash'\n\t| 'triangle-down'\n\t| 'triangle-up'\n\t| 'twitter'\n\t| 'undo'\n\t| 'ungroup'\n\t| 'unlock-small'\n\t| 'unlock'\n\t| 'visible'\n\t| 'warning-triangle'\n\t| 'zoom-in'\n\t| 'zoom-out'\n\n/** @public */\nexport const TLUiIconTypes = [\n\t'align-bottom',\n\t'align-center-horizontal',\n\t'align-center-vertical',\n\t'align-left',\n\t'align-right',\n\t'align-top',\n\t'arrow-left',\n\t'arrowhead-arrow',\n\t'arrowhead-bar',\n\t'arrowhead-diamond',\n\t'arrowhead-dot',\n\t'arrowhead-none',\n\t'arrowhead-square',\n\t'arrowhead-triangle-inverted',\n\t'arrowhead-triangle',\n\t'aspect-ratio',\n\t'avatar',\n\t'blob',\n\t'bring-forward',\n\t'bring-to-front',\n\t'check',\n\t'checkbox-checked',\n\t'checkbox-empty',\n\t'chevron-down',\n\t'chevron-left',\n\t'chevron-right',\n\t'chevron-up',\n\t'chevrons-ne',\n\t'chevrons-sw',\n\t'clipboard-copy',\n\t'code',\n\t'collab',\n\t'color',\n\t'comment',\n\t'cross-2',\n\t'cross',\n\t'dash-dashed',\n\t'dash-dotted',\n\t'dash-draw',\n\t'dash-solid',\n\t'discord',\n\t'distribute-horizontal',\n\t'distribute-vertical',\n\t'dot',\n\t'dots-horizontal',\n\t'dots-vertical',\n\t'drag-handle-dots',\n\t'duplicate',\n\t'edit',\n\t'external-link',\n\t'file',\n\t'fill-none',\n\t'fill-pattern',\n\t'fill-semi',\n\t'fill-solid',\n\t'font-draw',\n\t'font-mono',\n\t'font-sans',\n\t'font-serif',\n\t'geo-arrow-down',\n\t'geo-arrow-left',\n\t'geo-arrow-right',\n\t'geo-arrow-up',\n\t'geo-diamond',\n\t'geo-ellipse',\n\t'geo-hexagon',\n\t'geo-octagon',\n\t'geo-oval',\n\t'geo-pentagon',\n\t'geo-rectangle',\n\t'geo-rhombus-2',\n\t'geo-rhombus',\n\t'geo-star',\n\t'geo-trapezoid',\n\t'geo-triangle',\n\t'geo-x-box',\n\t'github',\n\t'group',\n\t'hidden',\n\t'image',\n\t'info-circle',\n\t'link',\n\t'lock-small',\n\t'lock',\n\t'menu',\n\t'minus',\n\t'mixed',\n\t'pack',\n\t'page',\n\t'plus',\n\t'question-mark-circle',\n\t'question-mark',\n\t'redo',\n\t'reset-zoom',\n\t'rotate-ccw',\n\t'rotate-cw',\n\t'ruler',\n\t'search',\n\t'send-backward',\n\t'send-to-back',\n\t'settings-horizontal',\n\t'settings-vertical-1',\n\t'settings-vertical',\n\t'share-1',\n\t'share-2',\n\t'size-extra-large',\n\t'size-large',\n\t'size-medium',\n\t'size-small',\n\t'spline-cubic',\n\t'spline-line',\n\t'stack-horizontal',\n\t'stack-vertical',\n\t'stretch-horizontal',\n\t'stretch-vertical',\n\t'text-align-center',\n\t'text-align-justify',\n\t'text-align-left',\n\t'text-align-right',\n\t'tool-arrow',\n\t'tool-embed',\n\t'tool-eraser',\n\t'tool-frame',\n\t'tool-hand',\n\t'tool-highlighter',\n\t'tool-line',\n\t'tool-media',\n\t'tool-note',\n\t'tool-pencil',\n\t'tool-pointer',\n\t'tool-text',\n\t'trash',\n\t'triangle-down',\n\t'triangle-up',\n\t'twitter',\n\t'undo',\n\t'ungroup',\n\t'unlock-small',\n\t'unlock',\n\t'visible',\n\t'warning-triangle',\n\t'zoom-in',\n\t'zoom-out',\n] as const\n","import { defaultEditorAssetUrls, EditorAssetUrls, EMBED_DEFINITIONS } from '@tldraw/editor'\nimport { LANGUAGES } from './hooks/useTranslation/languages'\nimport { TLUiIconType, TLUiIconTypes } from './icon-types'\n\nexport type UiAssetUrls = EditorAssetUrls & {\n\ticons: Record<TLUiIconType, string>\n\ttranslations: Record<(typeof LANGUAGES)[number]['locale'], string>\n\tembedIcons: Record<(typeof EMBED_DEFINITIONS)[number]['type'], string>\n}\n\nexport const defaultUiAssetUrls: UiAssetUrls = {\n\t...defaultEditorAssetUrls,\n\ticons: Object.fromEntries(\n\t\tTLUiIconTypes.map((name) => [name, `/icons/icon/${name}.svg`])\n\t) as Record<TLUiIconType, string>,\n\ttranslations: Object.fromEntries(\n\t\tLANGUAGES.map((lang) => [lang.locale, `/translations/${lang.locale}.json`])\n\t) as Record<(typeof LANGUAGES)[number]['locale'], string>,\n\tembedIcons: Object.fromEntries(\n\t\tEMBED_DEFINITIONS.map((def) => [def.type, `/embed-icons/${def.type}.png`])\n\t) as Record<(typeof EMBED_DEFINITIONS)[number]['type'], string>,\n}\n","import { App } from '@tldraw/editor'\nimport { objectMapEntries } from '@tldraw/utils'\nimport { useMemo } from 'react'\nimport {\n\tActionsMenuSchemaProviderProps,\n\tActionsProviderProps,\n\tContextMenuSchemaProviderProps,\n\tHelpMenuSchemaProviderProps,\n\tKeyboardShortcutsSchemaProviderProps,\n\tMenuSchemaProviderProps,\n\tToolbarSchemaProviderProps,\n\tToolsProviderProps,\n\tTranslationProviderProps,\n\tuseBreakpoint,\n\tuseDialogs,\n\tuseToasts,\n\tuseTranslation,\n} from './hooks'\n\n/** @public */\nexport function useDefaultHelpers() {\n\tconst { addToast, removeToast, clearToasts } = useToasts()\n\tconst { addDialog, clearDialogs, removeDialog, updateDialog } = useDialogs()\n\tconst breakpoint = useBreakpoint()\n\tconst isMobile = breakpoint < 5\n\tconst msg = useTranslation()\n\treturn useMemo(\n\t\t() => ({\n\t\t\taddToast,\n\t\t\tremoveToast,\n\t\t\tclearToasts,\n\t\t\taddDialog,\n\t\t\tclearDialogs,\n\t\t\tremoveDialog,\n\t\t\tupdateDialog,\n\t\t\tmsg,\n\t\t\tisMobile,\n\t\t}),\n\t\t[\n\t\t\taddDialog,\n\t\t\taddToast,\n\t\t\tclearDialogs,\n\t\t\tclearToasts,\n\t\t\tmsg,\n\t\t\tremoveDialog,\n\t\t\tremoveToast,\n\t\t\tupdateDialog,\n\t\t\tisMobile,\n\t\t]\n\t)\n}\n\ntype DefaultHelpers = ReturnType<typeof useDefaultHelpers>\n\nexport type TldrawUiOverride<Type, Helpers> = (app: App, schema: Type, helpers: Helpers) => Type\n\ntype WithDefaultHelpers<T extends TldrawUiOverride<any, any>> = T extends TldrawUiOverride<\n\tinfer Type,\n\tinfer Helpers\n>\n\t? TldrawUiOverride<Type, Helpers extends undefined ? DefaultHelpers : Helpers & DefaultHelpers>\n\t: never\n\n/** @public */\nexport interface TldrawUiOverrides {\n\tactionsMenu?: WithDefaultHelpers<NonNullable<ActionsMenuSchemaProviderProps['overrides']>>\n\tactions?: WithDefaultHelpers<NonNullable<ActionsProviderProps['overrides']>>\n\tcontextMenu?: WithDefaultHelpers<NonNullable<ContextMenuSchemaProviderProps['overrides']>>\n\thelpMenu?: WithDefaultHelpers<NonNullable<HelpMenuSchemaProviderProps['overrides']>>\n\tmenu?: WithDefaultHelpers<NonNullable<MenuSchemaProviderProps['overrides']>>\n\ttoolbar?: WithDefaultHelpers<NonNullable<ToolbarSchemaProviderProps['overrides']>>\n\tkeyboardShortcutsMenu?: WithDefaultHelpers<\n\t\tNonNullable<KeyboardShortcutsSchemaProviderProps['overrides']>\n\t>\n\ttools?: WithDefaultHelpers<NonNullable<ToolsProviderProps['overrides']>>\n\ttranslations?: TranslationProviderProps['overrides']\n}\n\nexport interface TldrawUiOverridesWithoutDefaults {\n\tactionsMenu?: ActionsMenuSchemaProviderProps['overrides']\n\tactions?: ActionsProviderProps['overrides']\n\tcontextMenu?: ContextMenuSchemaProviderProps['overrides']\n\thelpMenu?: HelpMenuSchemaProviderProps['overrides']\n\tmenu?: MenuSchemaProviderProps['overrides']\n\ttoolbar?: ToolbarSchemaProviderProps['overrides']\n\tkeyboardShortcutsMenu?: KeyboardShortcutsSchemaProviderProps['overrides']\n\ttools?: ToolsProviderProps['overrides']\n\ttranslations?: TranslationProviderProps['overrides']\n}\n\nexport function mergeOverrides(\n\toverrides: TldrawUiOverrides[],\n\tdefaultHelpers: DefaultHelpers\n): TldrawUiOverridesWithoutDefaults {\n\tconst mergedTranslations: TranslationProviderProps['overrides'] = {}\n\tfor (const override of overrides) {\n\t\tif (override.translations) {\n\t\t\tfor (const [key, value] of objectMapEntries(override.translations)) {\n\t\t\t\tlet strings = mergedTranslations[key]\n\t\t\t\tif (!strings) {\n\t\t\t\t\tstrings = mergedTranslations[key] = {}\n\t\t\t\t}\n\t\t\t\tObject.assign(strings, value)\n\t\t\t}\n\t\t}\n\t}\n\treturn {\n\t\tactionsMenu: (app, schema, helpers) => {\n\t\t\tfor (const override of overrides) {\n\t\t\t\tif (override.actionsMenu) {\n\t\t\t\t\tschema = override.actionsMenu(app, schema, { ...defaultHelpers, ...helpers })\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn schema\n\t\t},\n\t\tactions: (app, schema) => {\n\t\t\tfor (const override of overrides) {\n\t\t\t\tif (override.actions) {\n\t\t\t\t\tschema = override.actions(app, schema, defaultHelpers)\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn schema\n\t\t},\n\t\tcontextMenu: (app, schema, helpers) => {\n\t\t\tfor (const override of overrides) {\n\t\t\t\tif (override.contextMenu) {\n\t\t\t\t\tschema = override.contextMenu(app, schema, { ...defaultHelpers, ...helpers })\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn schema\n\t\t},\n\t\thelpMenu: (app, schema, helpers) => {\n\t\t\tfor (const override of overrides) {\n\t\t\t\tif (override.helpMenu) {\n\t\t\t\t\tschema = override.helpMenu(app, schema, { ...defaultHelpers, ...helpers })\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn schema\n\t\t},\n\t\tmenu: (app, schema, helpers) => {\n\t\t\tfor (const override of overrides) {\n\t\t\t\tif (override.menu) {\n\t\t\t\t\tschema = override.menu(app, schema, { ...defaultHelpers, ...helpers })\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn schema\n\t\t},\n\t\ttoolbar: (app, schema, helpers) => {\n\t\t\tfor (const override of overrides) {\n\t\t\t\tif (override.toolbar) {\n\t\t\t\t\tschema = override.toolbar(app, schema, { ...defaultHelpers, ...helpers })\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn schema\n\t\t},\n\t\tkeyboardShortcutsMenu: (app, schema, helpers) => {\n\t\t\tfor (const override of overrides) {\n\t\t\t\tif (override.keyboardShortcutsMenu) {\n\t\t\t\t\tschema = override.keyboardShortcutsMenu(app, schema, { ...defaultHelpers, ...helpers })\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn schema\n\t\t},\n\t\ttools: (app, schema, helpers) => {\n\t\t\tfor (const override of overrides) {\n\t\t\t\tif (override.tools) {\n\t\t\t\t\tschema = override.tools(app, schema, { ...defaultHelpers, ...helpers })\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn schema\n\t\t},\n\t\ttranslations: mergedTranslations,\n\t}\n}\n\nfunction useShallowArrayEquality<T extends unknown[]>(array: T): T {\n\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\treturn useMemo(() => array, array)\n}\n\nexport function useMergedTranslationOverrides(\n\toverrides?: TldrawUiOverrides[] | TldrawUiOverrides\n): NonNullable<TranslationProviderProps['overrides']> {\n\tconst overridesArray = useShallowArrayEquality(\n\t\toverrides == null ? [] : Array.isArray(overrides) ? overrides : [overrides]\n\t)\n\treturn useMemo(() => {\n\t\tconst mergedTranslations: TranslationProviderProps['overrides'] = {}\n\t\tfor (const override of overridesArray) {\n\t\t\tif (override.translations) {\n\t\t\t\tfor (const [key, value] of objectMapEntries(override.translations)) {\n\t\t\t\t\tlet strings = mergedTranslations[key]\n\t\t\t\t\tif (!strings) {\n\t\t\t\t\t\tstrings = mergedTranslations[key] = {}\n\t\t\t\t\t}\n\t\t\t\t\tObject.assign(strings, value)\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn mergedTranslations\n\t}, [overridesArray])\n}\n\nexport function useMergedOverrides(\n\toverrides?: TldrawUiOverrides[] | TldrawUiOverrides\n): TldrawUiOverridesWithoutDefaults {\n\tconst defaultHelpers = useDefaultHelpers()\n\tconst overridesArray = useShallowArrayEquality(\n\t\toverrides == null ? [] : Array.isArray(overrides) ? overrides : [overrides]\n\t)\n\treturn useMemo(\n\t\t() => mergeOverrides(overridesArray, defaultHelpers),\n\t\t[overridesArray, defaultHelpers]\n\t)\n}\n","import { defaultUiAssetUrls, UiAssetUrls } from '../assetUrls'\nimport {\n\tActionsMenuSchemaProvider,\n\tActionsProvider,\n\tAssetUrlsProvider,\n\tBreakPointProvider,\n\tContextMenuSchemaProvider,\n\tKeyboardShortcutsSchemaProvider,\n\tMenuSchemaProvider,\n\tToolbarSchemaProvider,\n\tToolsProvider,\n\tTranslationProvider,\n} from '../hooks'\nimport { DialogsProvider } from '../hooks/useDialogsProvider'\nimport { HelpMenuSchemaProvider } from '../hooks/useHelpMenuSchema'\nimport { ToastsProvider } from '../hooks/useToastsProvider'\nimport { TldrawUiOverrides, useMergedOverrides, useMergedTranslationOverrides } from '../overrides'\n\n/** @public */\nexport interface TldrawUiContextProviderProps {\n\tassetUrls?: UiAssetUrls\n\toverrides?: TldrawUiOverrides | TldrawUiOverrides[]\n\tchildren?: any\n}\n\n/** @public */\nexport function TldrawUiContextProvider({\n\toverrides,\n\tassetUrls,\n\tchildren,\n}: TldrawUiContextProviderProps) {\n\treturn (\n\t\t<AssetUrlsProvider assetUrls={assetUrls ?? defaultUiAssetUrls}>\n\t\t\t<TranslationProvider overrides={useMergedTranslationOverrides(overrides)}>\n\t\t\t\t<ToastsProvider>\n\t\t\t\t\t<DialogsProvider>\n\t\t\t\t\t\t<BreakPointProvider>\n\t\t\t\t\t\t\t<InternalProviders overrides={overrides}>{children}</InternalProviders>\n\t\t\t\t\t\t</BreakPointProvider>\n\t\t\t\t\t</DialogsProvider>\n\t\t\t\t</ToastsProvider>\n\t\t\t</TranslationProvider>\n\t\t</AssetUrlsProvider>\n\t)\n}\nfunction InternalProviders({\n\toverrides,\n\tchildren,\n}: Omit<TldrawUiContextProviderProps, 'assetBaseUrl'>) {\n\tconst mergedOverrides = useMergedOverrides(overrides)\n\treturn (\n\t\t<ActionsProvider overrides={mergedOverrides.actions}>\n\t\t\t<ToolsProvider overrides={mergedOverrides.tools}>\n\t\t\t\t<ToolbarSchemaProvider overrides={mergedOverrides.toolbar}>\n\t\t\t\t\t<ActionsMenuSchemaProvider overrides={mergedOverrides.actionsMenu}>\n\t\t\t\t\t\t<KeyboardShortcutsSchemaProvider overrides={mergedOverrides.keyboardShortcutsMenu}>\n\t\t\t\t\t\t\t<ContextMenuSchemaProvider overrides={mergedOverrides.contextMenu}>\n\t\t\t\t\t\t\t\t<HelpMenuSchemaProvider overrides={mergedOverrides.helpMenu}>\n\t\t\t\t\t\t\t\t\t<MenuSchemaProvider overrides={mergedOverrides.menu}>\n\t\t\t\t\t\t\t\t\t\t{children}\n\t\t\t\t\t\t\t\t\t</MenuSchemaProvider>\n\t\t\t\t\t\t\t\t</HelpMenuSchemaProvider>\n\t\t\t\t\t\t\t</ContextMenuSchemaProvider>\n\t\t\t\t\t\t</KeyboardShortcutsSchemaProvider>\n\t\t\t\t\t</ActionsMenuSchemaProvider>\n\t\t\t\t</ToolbarSchemaProvider>\n\t\t\t</ToolsProvider>\n\t\t</ActionsProvider>\n\t)\n}\n","import { ToastProvider } from '@radix-ui/react-toast'\nimport { LoadingScreen, useApp } from '@tldraw/editor'\nimport classNames from 'classnames'\nimport React, { ReactNode } from 'react'\nimport { useValue } from 'signia-react'\nimport { DebugPanel, HelpMenu, NavigationZone, StylePanel } from '../components'\nimport { BackToContent } from '../components/BackToContent'\nimport { Dialogs } from '../components/Dialogs'\nimport { ExitPenMode } from '../components/ExitPenMode'\nimport { MenuZone } from '../components/MenuZone'\nimport { ToastViewport, Toasts } from '../components/Toasts'\nimport { Toolbar } from '../components/Toolbar'\nimport { Button } from '../components/primitives'\nimport {\n\tuseActions,\n\tuseAppEvents,\n\tuseBreakpoint,\n\tuseKeyboardShortcuts,\n\tuseTranslation,\n} from '../hooks'\nimport { useNativeClipboardEvents } from '../hooks/useClipboardEvents'\nimport { usePreloadIcons } from '../hooks/usePreloadIcons'\nimport { TldrawUiContextProvider, TldrawUiContextProviderProps } from './TldrawUiContextProvider'\n\n/** @public */\nexport const TldrawUi = React.memo(function TldrawUi({\n\tshareZone,\n\trenderDebugMenuItems,\n\tchildren,\n\t...rest\n}: {\n\tshareZone?: ReactNode\n\trenderDebugMenuItems?: () => React.ReactNode\n\tchildren?: ReactNode\n} & TldrawUiContextProviderProps) {\n\treturn (\n\t\t<TldrawUiContextProvider {...rest}>\n\t\t\t<TldrawUiInner shareZone={shareZone} renderDebugMenuItems={renderDebugMenuItems}>\n\t\t\t\t{children}\n\t\t\t</TldrawUiInner>\n\t\t</TldrawUiContextProvider>\n\t)\n})\n\ntype TldrawUiContentProps = {\n\tshareZone?: ReactNode\n\trenderDebugMenuItems?: () => React.ReactNode\n}\n\nconst TldrawUiInner = React.memo(function TldrawUiInner({\n\tchildren,\n\t...props\n}: TldrawUiContentProps & { children: ReactNode }) {\n\tconst isLoaded = usePreloadIcons()\n\n\tif (!isLoaded) {\n\t\treturn <LoadingScreen>Loading assets...</LoadingScreen>\n\t}\n\n\treturn (\n\t\t<>\n\t\t\t{children}\n\t\t\t<TldrawUiContent {...props} />\n\t\t</>\n\t)\n})\n\n/** @public */\nexport const TldrawUiContent = React.memo(function TldrawUI({\n\tshareZone,\n\trenderDebugMenuItems,\n}: TldrawUiContentProps) {\n\tconst app = useApp()\n\tconst msg = useTranslation()\n\tconst breakpoint = useBreakpoint()\n\tconst isReadonlyMode = useValue('isReadOnlyMode', () => app.isReadOnly, [])\n\tconst isFocusMode = useValue('isFocusMode', () => app.instanceState.isFocusMode, [])\n\tconst isDebugMode = useValue('isDebugMode', () => app.instanceState.isDebugMode, [])\n\n\tuseKeyboardShortcuts()\n\tuseNativeClipboardEvents()\n\tuseAppEvents()\n\n\tconst { 'toggle-focus-mode': toggleFocus } = useActions()\n\n\treturn (\n\t\t<ToastProvider>\n\t\t\t<main\n\t\t\t\tdata-wd=\"desktop-ui\"\n\t\t\t\tclassName={classNames('tlui-layout', { 'tlui-layout__mobile': breakpoint < 5 })}\n\t\t\t>\n\t\t\t\t{isFocusMode ? (\n\t\t\t\t\t<div className=\"tlui-layout__top\">\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tclassName=\"tlui-focus-button\"\n\t\t\t\t\t\t\ttitle={`${msg('focus-mode.toggle-focus-mode')}`}\n\t\t\t\t\t\t\ticon=\"dot\"\n\t\t\t\t\t\t\tonClick={toggleFocus.onSelect}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t) : (\n\t\t\t\t\t<>\n\t\t\t\t\t\t<div className=\"tlui-layout__top\">\n\t\t\t\t\t\t\t<MenuZone />\n\t\t\t\t\t\t\t<div className=\"tlui-spacer\" />\n\t\t\t\t\t\t\t<div className=\"tlui-share-zone\" draggable={false}>\n\t\t\t\t\t\t\t\t{shareZone}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclassName=\"tlui-layout__middle\"\n\t\t\t\t\t\t\tdata-wd=\"active-area\"\n\t\t\t\t\t\t\tdata-tldraw-area=\"active-drawing\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div className=\"tlui-helper-buttons\">\n\t\t\t\t\t\t\t\t<ExitPenMode />\n\t\t\t\t\t\t\t\t<BackToContent />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t{breakpoint >= 5 && !isReadonlyMode && (\n\t\t\t\t\t\t\t\t<div className=\"tlui-style-panel__wrapper\">\n\t\t\t\t\t\t\t\t\t<StylePanel />\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"tlui-layout__bottom\">\n\t\t\t\t\t\t\t<div className=\"tlui-layout__bottom__main\">\n\t\t\t\t\t\t\t\t<NavigationZone />\n\t\t\t\t\t\t\t\t<Toolbar />\n\t\t\t\t\t\t\t\t{breakpoint >= 4 && <HelpMenu />}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t{isDebugMode && <DebugPanel renderDebugMenuItems={renderDebugMenuItems ?? null} />}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<Toasts />\n\t\t\t\t\t\t<Dialogs />\n\t\t\t\t\t\t<ToastViewport />\n\t\t\t\t\t</>\n\t\t\t\t)}\n\t\t\t</main>\n\t\t</ToastProvider>\n\t)\n})\n","import { useEffect, useState } from 'react'\nimport { TLUiIconTypes } from '../icon-types'\nimport { useAssetUrls } from './useAssetUrls'\n\n/** @internal */\nexport function usePreloadIcons(): boolean {\n\tconst [isLoaded, setIsLoaded] = useState<boolean>(false)\n\tconst assetUrls = useAssetUrls()\n\n\tuseEffect(() => {\n\t\tlet cancelled = false\n\t\tasync function loadImages() {\n\t\t\t// Run through all of the icons and load them. It doesn't matter\n\t\t\t// if any of the images don't load; though we expect that they would.\n\t\t\t// Instead, we just want to make sure that the browser has cached\n\t\t\t// all of the icons it can so that they're available when we need them.\n\n\t\t\tawait Promise.allSettled(\n\t\t\t\tTLUiIconTypes.map((icon) => {\n\t\t\t\t\tconst image = new Image()\n\t\t\t\t\timage.src = assetUrls.icons[icon]\n\t\t\t\t\treturn image.decode()\n\t\t\t\t})\n\t\t\t)\n\n\t\t\tif (cancelled) return\n\t\t\tsetIsLoaded(true)\n\t\t}\n\n\t\tloadImages()\n\n\t\treturn () => {\n\t\t\tcancelled = true\n\t\t}\n\t}, [isLoaded, assetUrls])\n\n\treturn isLoaded\n}\n","import { TLPageId, useApp } from '@tldraw/editor'\nimport { useEffect } from 'react'\nimport { useToasts } from './useToastsProvider'\n\n/** @public */\nexport function useAppEvents() {\n\tconst app = useApp()\n\tconst { addToast } = useToasts()\n\n\tuseEffect(() => {\n\t\tfunction handleMaxShapes({ name, count }: { name: string; pageId: string; count: number }) {\n\t\t\taddToast({\n\t\t\t\ttitle: 'Maximum Shapes Reached',\n\t\t\t\tdescription: `You've reached the maximum number of shapes allowed on ${name} (${count}). Please delete some shapes or move to a different page to continue.`,\n\t\t\t})\n\t\t}\n\n\t\tfunction handleMoveToPage({ name, fromId }: { name: string; fromId: TLPageId }) {\n\t\t\taddToast({\n\t\t\t\ttitle: 'Changed Page',\n\t\t\t\tdescription: `Moved to ${name}.`,\n\t\t\t\tactions: [\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'Go Back',\n\t\t\t\t\t\ttype: 'primary',\n\t\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\t\tapp.mark('change-page')\n\t\t\t\t\t\t\tapp.setCurrentPageId(fromId)\n\t\t\t\t\t\t},\n\t\t\t\t\t}, // prev page\n\t\t\t\t],\n\t\t\t})\n\t\t}\n\n\t\tapp.addListener('max-shapes', handleMaxShapes)\n\t\tapp.addListener('moved-to-page', handleMoveToPage)\n\t\treturn () => {\n\t\t\tapp.removeListener('max-shapes', handleMaxShapes)\n\t\t\tapp.removeListener('moved-to-page', handleMoveToPage)\n\t\t}\n\t}, [app, addToast])\n}\n","import { Canvas, TldrawEditor, TldrawEditorProps } from '@tldraw/editor'\nimport {\n\tDEFAULT_DOCUMENT_NAME,\n\tTAB_ID,\n\tgetUserData,\n\tuseLocalSyncClient,\n} from '@tldraw/tlsync-client'\nimport { ContextMenu, TldrawUi, TldrawUiContextProviderProps } from '@tldraw/ui'\n\n/** @public */\nexport function Tldraw(\n\tprops: Omit<TldrawEditorProps, 'store'> &\n\t\tTldrawUiContextProviderProps & { persistenceKey?: string }\n) {\n\tconst { children, persistenceKey = DEFAULT_DOCUMENT_NAME, instanceId = TAB_ID, ...rest } = props\n\n\tconst userData = getUserData()\n\n\tconst syncedStore = useLocalSyncClient({\n\t\tinstanceId,\n\t\tuserId: userData.id,\n\t\tuniversalPersistenceKey: persistenceKey,\n\t\tconfig: props.config,\n\t})\n\n\treturn (\n\t\t<TldrawEditor {...rest} instanceId={instanceId} userId={userData.id} store={syncedStore}>\n\t\t\t<TldrawUi {...rest}>\n\t\t\t\t<ContextMenu>\n\t\t\t\t\t<Canvas />\n\t\t\t\t</ContextMenu>\n\t\t\t\t{children}\n\t\t\t</TldrawUi>\n\t\t</TldrawEditor>\n\t)\n}\n","import React, { Component } from 'react';\r\nimport './App.css';\r\nimport { Tldraw } from '@tldraw/tldraw'\r\nimport '@tldraw/tldraw/editor.css'\r\nimport '@tldraw/tldraw/ui.css'\r\n\r\nclass App extends Component {\r\n  render() {\r\n    return (\r\n      <div className=\"App\">\r\n        <p className=\"App-intro\">\r\n          Welcome to TLDraw 4 Salesforce\r\n        </p>\r\n        <div className=\"tldraw__editor\">\r\n\t\t\t<Tldraw autoFocus />\r\n\t\t</div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default App;","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport App from './App';\r\nimport './index.css';\r\n\r\nReactDOM.render(\r\n  <App />,\r\n  document.getElementById('root')\r\n);"],"names":["hasOwn","hasOwnProperty","classNames","classes","i","arguments","length","arg","argType","push","Array","isArray","inner","apply","toString","Object","prototype","includes","key","call","join","module","exports","default","isCallable","require","tryToString","$TypeError","TypeError","argument","wellKnownSymbol","create","defineProperty","UNSCOPABLES","ArrayPrototype","undefined","configurable","value","charAt","S","index","unicode","isObject","$String","String","toIndexedObject","toAbsoluteIndex","lengthOfArrayLike","createMethod","IS_INCLUDES","$this","el","fromIndex","O","indexOf","isConstructor","SPECIES","$Array","originalArray","C","constructor","arraySpeciesConstructor","uncurryThis","stringSlice","slice","it","TO_STRING_TAG_SUPPORT","classofRaw","TO_STRING_TAG","$Object","CORRECT_ARGUMENTS","tag","result","error","tryGet","callee","ownKeys","getOwnPropertyDescriptorModule","definePropertyModule","target","source","exceptions","keys","f","getOwnPropertyDescriptor","DESCRIPTORS","createPropertyDescriptor","object","bitmap","enumerable","writable","makeBuiltIn","defineGlobalProperty","options","simple","name","global","unsafe","nonConfigurable","nonWritable","fails","get","documentAll","document","all","IS_HTMLDDA","EXISTS","createElement","navigator","userAgent","match","version","process","Deno","versions","v8","split","createNonEnumerableProperty","defineBuiltIn","copyConstructorProperties","isForced","targetProperty","sourceProperty","descriptor","TARGET","GLOBAL","STATIC","stat","dontCallGetSet","forced","sham","exec","regexpExec","RegExpPrototype","RegExp","KEY","FORCED","SHAM","SYMBOL","DELEGATES_TO_SYMBOL","DELEGATES_TO_EXEC","execCalled","re","flags","uncurriedNativeRegExpMethod","methods","nativeMethod","regexp","str","arg2","forceStringMethod","uncurriedNativeMethod","$exec","done","doesNotExceedSafeInteger","bind","flattenIntoArray","original","sourceLen","start","depth","mapper","thisArg","element","targetIndex","sourceIndex","mapFn","NATIVE_BIND","FunctionPrototype","Function","Reflect","aCallable","fn","that","test","getDescriptor","PROPER","CONFIGURABLE","uncurryThisWithBind","namespace","method","isNullOrUndefined","V","P","func","toObject","floor","Math","replace","SUBSTITUTION_SYMBOLS","SUBSTITUTION_SYMBOLS_NO_NAMED","matched","position","captures","namedCaptures","replacement","tailPos","m","symbols","ch","capture","n","check","globalThis","window","self","this","getBuiltIn","a","classof","propertyIsEnumerable","store","functionToString","inspectSource","set","has","NATIVE_WEAK_MAP","shared","sharedKey","hiddenKeys","OBJECT_ALREADY_INITIALIZED","WeakMap","state","metadata","facade","STATE","enforce","getterFor","TYPE","type","$documentAll","noop","empty","construct","constructorRegExp","INCORRECT_TO_STRING","isConstructorModern","isConstructorLegacy","called","feature","detection","data","normalize","POLYFILL","NATIVE","string","toLowerCase","isPrototypeOf","USE_SYMBOL_AS_UID","$Symbol","toLength","obj","CONFIGURABLE_FUNCTION_NAME","InternalStateModule","enforceInternalState","getInternalState","CONFIGURABLE_LENGTH","TEMPLATE","getter","setter","arity","ceil","trunc","x","activeXDocument","anObject","definePropertiesModule","enumBugKeys","html","documentCreateElement","PROTOTYPE","SCRIPT","IE_PROTO","EmptyConstructor","scriptTag","content","LT","NullProtoObjectViaActiveX","write","close","temp","parentWindow","NullProtoObject","ActiveXObject","domain","iframeDocument","iframe","JS","style","display","appendChild","src","contentWindow","open","F","NullProtoObjectViaIFrame","Properties","V8_PROTOTYPE_DEFINE_BUG","objectKeys","defineProperties","props","IE8_DOM_DEFINE","toPropertyKey","$defineProperty","$getOwnPropertyDescriptor","ENUMERABLE","WRITABLE","Attributes","current","propertyIsEnumerableModule","internalObjectKeys","concat","getOwnPropertyNames","getOwnPropertySymbols","names","$propertyIsEnumerable","NASHORN_BUG","input","pref","val","valueOf","getOwnPropertyNamesModule","getOwnPropertySymbolsModule","R","regexpFlags","stickyHelpers","UNSUPPORTED_DOT_ALL","UNSUPPORTED_NCG","nativeReplace","nativeExec","patchedExec","UPDATES_LAST_INDEX_WRONG","re1","re2","lastIndex","UNSUPPORTED_Y","BROKEN_CARET","NPCG_INCLUDED","reCopy","group","raw","groups","sticky","charsAdded","strCopy","multiline","hasIndices","ignoreCase","dotAll","unicodeSets","$RegExp","MISSED_STICKY","uid","SHARED","IS_PURE","mode","copyright","license","toIntegerOrInfinity","requireObjectCoercible","charCodeAt","CONVERT_TO_STRING","pos","first","second","size","codeAt","V8_VERSION","symbol","Symbol","max","min","integer","IndexedObject","number","isSymbol","getMethod","ordinaryToPrimitive","TO_PRIMITIVE","exoticToPrim","toPrimitive","id","postfix","random","NATIVE_SYMBOL","iterator","WellKnownSymbolsStore","createWellKnownSymbol","withoutSetter","$","arraySpeciesCreate","proto","flatMap","callbackfn","A","flat","depthArg","addToUnscopables","fixRegExpWellKnownSymbolLogic","advanceStringIndex","getSubstitution","regExpExec","REPLACE","stringIndexOf","REPLACE_KEEPS_$0","REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE","_","maybeCallNative","UNSAFE_SUBSTITUTE","searchValue","replaceValue","replacer","rx","res","functionalReplace","fullUnicode","results","accumulatedResult","nextSourcePosition","j","replacerArgs","prefix","Events","EE","context","once","addListener","emitter","event","listener","evt","_events","_eventsCount","clearEvent","EventEmitter","__proto__","eventNames","events","listeners","handlers","l","ee","listenerCount","emit","a1","a2","a3","a4","a5","args","len","removeListener","on","removeAllListeners","off","prefixed","HASH_UNDEFINED","COMPARE_PARTIAL_FLAG","COMPARE_UNORDERED_FLAG","MAX_SAFE_INTEGER","argsTag","arrayTag","asyncTag","boolTag","dateTag","errorTag","funcTag","genTag","mapTag","numberTag","nullTag","objectTag","promiseTag","proxyTag","regexpTag","setTag","stringTag","symbolTag","undefinedTag","weakMapTag","arrayBufferTag","dataViewTag","reIsHostCtor","reIsUint","typedArrayTags","freeGlobal","freeSelf","root","freeExports","nodeType","freeModule","moduleExports","freeProcess","nodeUtil","binding","e","nodeIsTypedArray","isTypedArray","arraySome","array","predicate","mapToArray","map","forEach","setToArray","transform","arrayProto","funcProto","objectProto","coreJsData","funcToString","maskSrcKey","nativeObjectToString","reIsNative","Buffer","Uint8Array","splice","symToStringTag","toStringTag","nativeGetSymbols","nativeIsBuffer","isBuffer","nativeKeys","DataView","getNative","Map","Promise","Set","nativeCreate","dataViewCtorString","toSource","mapCtorString","promiseCtorString","setCtorString","weakMapCtorString","symbolProto","symbolValueOf","Hash","entries","clear","entry","ListCache","MapCache","SetCache","values","__data__","add","Stack","arrayLikeKeys","inherited","isArr","isArg","isArguments","isBuff","isType","skipIndexes","iteratee","baseTimes","isIndex","assocIndexOf","eq","baseGetTag","isOwn","unmasked","getRawTag","objectToString","baseIsArguments","isObjectLike","baseIsEqual","other","bitmask","customizer","stack","equalFunc","objIsArr","othIsArr","objTag","getTag","othTag","objIsObj","othIsObj","isSameTag","equalArrays","byteLength","byteOffset","buffer","message","convert","isPartial","stacked","equalByTag","objIsWrapped","othIsWrapped","objUnwrapped","othUnwrapped","objProps","getAllKeys","objLength","othProps","othLength","skipCtor","objValue","othValue","compared","objCtor","othCtor","equalObjects","baseIsEqualDeep","baseIsNative","isMasked","isFunction","baseKeys","Ctor","isPrototype","arrLength","seen","arrValue","othIndex","keysFunc","symbolsFunc","offset","arrayPush","baseGetAllKeys","getSymbols","getMapData","isKeyable","getValue","pop","pairs","LARGE_ARRAY_SIZE","resIndex","arrayFilter","ArrayBuffer","resolve","ctorString","isLength","baseUnary","FUNC_ERROR_TEXT","NAN","reTrim","reIsBadHex","reIsBinary","reIsOctal","freeParseInt","parseInt","nativeMax","nativeMin","now","Date","debounce","wait","lastArgs","lastThis","maxWait","timerId","lastCallTime","lastInvokeTime","leading","maxing","trailing","invokeFunc","time","shouldInvoke","timeSinceLastCall","timerExpired","trailingEdge","setTimeout","remainingWait","debounced","isInvoking","leadingEdge","toNumber","cancel","clearTimeout","flush","isBinary","arrayIncludes","fromRight","baseFindIndex","baseIsNaN","baseIndexOf","arrayIncludesWith","comparator","cacheHas","cache","pattern","isHostObject","createSet","isCommon","outer","computed","seenIndex","baseUniq","LZString","fromCharCode","keyStrBase64","keyStrUriSafe","baseReverseDic","getBaseValue","alphabet","character","compressToBase64","_compress","decompressFromBase64","_decompress","compressToUTF16","decompressFromUTF16","compressed","compressToUint8Array","uncompressed","compress","buf","TotalLen","current_value","decompressFromUint8Array","decompress","c","compressToEncodedURIComponent","decompressFromEncodedURIComponent","bitsPerChar","getCharFromInt","ii","context_dictionary","context_dictionaryToCreate","context_c","context_wc","context_w","context_enlargeIn","context_dictSize","context_numBits","context_data","context_data_val","context_data_position","pow","resetValue","getNextValue","w","bits","resb","maxpower","power","dictionary","enlargeIn","dictSize","numBits","define","aa","ca","p","b","encodeURIComponent","da","ea","fa","ha","ia","ja","ka","la","ma","v","d","g","acceptsBooleans","attributeName","attributeNamespace","mustUseProperty","propertyName","sanitizeURL","removeEmptyString","z","ra","sa","toUpperCase","ta","pa","isNaN","qa","oa","removeAttribute","setAttribute","setAttributeNS","xlinkHref","ua","__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED","va","for","wa","ya","za","Aa","Ba","Ca","Da","Ea","Fa","Ga","Ha","Ia","Ja","Ka","La","assign","Ma","Error","trim","Na","Oa","prepareStackTrace","h","k","displayName","Pa","render","Qa","$$typeof","_context","_payload","_init","Ra","Sa","Ta","nodeName","Va","_valueTracker","setValue","stopTracking","Ua","Wa","checked","Xa","activeElement","body","Ya","defaultChecked","defaultValue","_wrapperState","initialChecked","Za","initialValue","controlled","ab","bb","cb","db","ownerDocument","eb","fb","selected","defaultSelected","disabled","gb","dangerouslySetInnerHTML","children","hb","ib","jb","textContent","kb","lb","mb","nb","namespaceURI","innerHTML","firstChild","removeChild","MSApp","execUnsafeLocalFunction","ob","lastChild","nodeValue","pb","animationIterationCount","aspectRatio","borderImageOutset","borderImageSlice","borderImageWidth","boxFlex","boxFlexGroup","boxOrdinalGroup","columnCount","columns","flex","flexGrow","flexPositive","flexShrink","flexNegative","flexOrder","gridArea","gridRow","gridRowEnd","gridRowSpan","gridRowStart","gridColumn","gridColumnEnd","gridColumnSpan","gridColumnStart","fontWeight","lineClamp","lineHeight","opacity","order","orphans","tabSize","widows","zIndex","zoom","fillOpacity","floodOpacity","stopOpacity","strokeDasharray","strokeDashoffset","strokeMiterlimit","strokeOpacity","strokeWidth","qb","rb","sb","setProperty","substring","tb","menuitem","area","base","br","col","embed","hr","img","keygen","link","meta","param","track","wbr","ub","vb","is","wb","xb","srcElement","correspondingUseElement","parentNode","yb","zb","Ab","Bb","Cb","stateNode","Db","Eb","Fb","Gb","Hb","Ib","Jb","Kb","Lb","Mb","addEventListener","removeEventListener","Nb","onError","Ob","Pb","Qb","Rb","Sb","Tb","Vb","alternate","return","Wb","memoizedState","dehydrated","Xb","Zb","child","sibling","Yb","$b","ac","unstable_scheduleCallback","bc","unstable_cancelCallback","cc","unstable_shouldYield","dc","unstable_requestPaint","B","unstable_now","ec","unstable_getCurrentPriorityLevel","fc","unstable_ImmediatePriority","gc","unstable_UserBlockingPriority","hc","unstable_NormalPriority","ic","unstable_LowPriority","jc","unstable_IdlePriority","kc","lc","oc","clz32","pc","qc","log","LN2","rc","sc","tc","uc","pendingLanes","suspendedLanes","pingedLanes","entangledLanes","entanglements","vc","xc","yc","zc","Ac","eventTimes","Cc","Dc","Ec","Fc","Gc","Hc","Ic","Jc","Kc","Lc","Mc","Nc","Oc","Pc","Qc","Rc","Sc","delete","pointerId","Tc","nativeEvent","blockedOn","domEventName","eventSystemFlags","targetContainers","Vc","Wc","priority","isDehydrated","containerInfo","Xc","Yc","dispatchEvent","shift","Zc","$c","ad","bd","cd","ReactCurrentBatchConfig","dd","ed","transition","fd","gd","hd","Uc","stopPropagation","jd","kd","ld","md","nd","od","keyCode","charCode","pd","qd","rd","_reactName","_targetInst","currentTarget","isDefaultPrevented","defaultPrevented","returnValue","isPropagationStopped","preventDefault","cancelBubble","persist","isPersistent","wd","xd","yd","sd","eventPhase","bubbles","cancelable","timeStamp","isTrusted","td","ud","view","detail","vd","Ad","screenX","screenY","clientX","clientY","pageX","pageY","ctrlKey","shiftKey","altKey","metaKey","getModifierState","zd","button","buttons","relatedTarget","fromElement","toElement","movementX","movementY","Bd","Dd","dataTransfer","Fd","Hd","animationName","elapsedTime","pseudoElement","Id","clipboardData","Jd","Ld","Md","Esc","Spacebar","Left","Up","Right","Down","Del","Win","Menu","Apps","Scroll","MozPrintableKey","Nd","Od","Alt","Control","Meta","Shift","Pd","Qd","code","location","repeat","locale","which","Rd","Td","width","height","pressure","tangentialPressure","tiltX","tiltY","twist","pointerType","isPrimary","Vd","touches","targetTouches","changedTouches","Xd","Yd","deltaX","wheelDeltaX","deltaY","wheelDeltaY","wheelDelta","deltaZ","deltaMode","Zd","$d","ae","be","documentMode","ce","de","fe","ge","he","ie","le","color","date","datetime","email","month","password","range","search","tel","text","url","week","me","ne","oe","pe","qe","se","te","ue","ve","we","xe","ye","ze","oninput","Ae","detachEvent","Be","Ce","attachEvent","De","Ee","Fe","He","Ie","Je","Ke","node","nextSibling","Le","contains","compareDocumentPosition","Me","HTMLIFrameElement","href","Ne","contentEditable","Oe","focusedElem","selectionRange","documentElement","end","selectionStart","selectionEnd","defaultView","getSelection","extend","rangeCount","anchorNode","anchorOffset","focusNode","focusOffset","createRange","setStart","removeAllRanges","addRange","setEnd","left","scrollLeft","top","scrollTop","focus","Pe","Qe","Re","Se","Te","Ue","Ve","We","animationend","animationiteration","animationstart","transitionend","Xe","Ye","Ze","animation","$e","af","bf","cf","df","ef","ff","gf","hf","lf","mf","nf","Ub","instance","D","of","pf","qf","rf","sf","passive","t","J","u","tf","uf","vf","wf","na","xa","$a","ba","je","char","ke","unshift","xf","yf","zf","Af","Bf","Cf","Df","Ef","__html","Ff","Gf","Hf","Jf","queueMicrotask","then","catch","If","Kf","Lf","Mf","previousSibling","Nf","Of","Pf","Qf","Rf","Sf","Tf","Uf","E","G","Vf","H","Wf","Xf","Yf","contextTypes","__reactInternalMemoizedUnmaskedChildContext","__reactInternalMemoizedMaskedChildContext","Zf","childContextTypes","$f","ag","bg","getChildContext","cg","__reactInternalMemoizedMergedChildContext","dg","eg","fg","gg","hg","jg","kg","lg","mg","ng","og","pg","qg","rg","sg","tg","ug","vg","wg","xg","yg","I","zg","Ag","Bg","elementType","deletions","Cg","pendingProps","overflow","treeContext","retryLane","Dg","Eg","Fg","Gg","memoizedProps","Hg","Ig","Jg","Kg","Lg","defaultProps","Mg","Ng","Og","Pg","Qg","Rg","_currentValue","Sg","childLanes","Tg","dependencies","firstContext","lanes","Ug","Vg","memoizedValue","next","Wg","Xg","Yg","interleaved","Zg","$g","ah","updateQueue","baseState","firstBaseUpdate","lastBaseUpdate","pending","effects","bh","eventTime","lane","payload","callback","dh","K","eh","fh","gh","q","r","y","hh","ih","jh","Component","refs","kh","nh","isMounted","_reactInternals","enqueueSetState","L","lh","mh","enqueueReplaceState","enqueueForceUpdate","oh","shouldComponentUpdate","isPureReactComponent","ph","contextType","updater","qh","componentWillReceiveProps","UNSAFE_componentWillReceiveProps","rh","getDerivedStateFromProps","getSnapshotBeforeUpdate","UNSAFE_componentWillMount","componentWillMount","componentDidMount","sh","ref","_owner","_stringRef","th","uh","vh","wh","xh","yh","implementation","zh","Ah","Bh","Ch","Dh","Eh","Fh","Gh","Hh","Ih","tagName","Jh","Kh","Lh","M","Mh","revealOrder","Nh","Oh","_workInProgressVersionPrimary","Ph","ReactCurrentDispatcher","Qh","Rh","N","Sh","Th","Uh","Vh","Q","Wh","Xh","Yh","Zh","$h","ai","bi","ci","baseQueue","queue","di","ei","fi","lastRenderedReducer","action","hasEagerState","eagerState","lastRenderedState","dispatch","gi","hi","ji","ki","getSnapshot","li","mi","ni","lastEffect","stores","oi","pi","qi","ri","destroy","deps","si","ti","ui","vi","wi","xi","yi","zi","Ai","Bi","Ci","Di","Ei","Fi","Gi","Hi","Ii","Ji","readContext","useCallback","useContext","useEffect","useImperativeHandle","useInsertionEffect","useLayoutEffect","useMemo","useReducer","useRef","useState","useDebugValue","useDeferredValue","useTransition","useMutableSource","useSyncExternalStore","useId","unstable_isNewReconciler","identifierPrefix","Ki","digest","Li","Mi","console","Ni","Oi","Pi","Qi","Ri","getDerivedStateFromError","componentDidCatch","Si","componentStack","Ti","pingCache","Ui","Vi","Wi","Xi","ReactCurrentOwner","Yi","Zi","$i","aj","bj","compare","cj","dj","ej","baseLanes","cachePool","transitions","fj","gj","hj","ij","jj","UNSAFE_componentWillUpdate","componentWillUpdate","componentDidUpdate","kj","lj","pendingContext","mj","Aj","Bj","Cj","Dj","nj","oj","pj","fallback","qj","rj","tj","dataset","dgst","uj","vj","_reactRetry","sj","subtreeFlags","wj","xj","isBackwards","rendering","renderingStartTime","last","tail","tailMode","yj","Ej","Fj","Gj","wasMultiple","multiple","suppressHydrationWarning","onClick","onclick","createElementNS","autoFocus","createTextNode","T","Hj","Ij","Jj","Kj","U","Lj","WeakSet","Mj","W","Nj","Oj","Qj","Rj","Sj","Tj","Uj","Vj","Wj","insertBefore","_reactRootContainer","Xj","X","Yj","Zj","ak","onCommitFiberUnmount","componentWillUnmount","bk","ck","dk","ek","fk","isHidden","gk","hk","ik","jk","kk","lk","__reactInternalSnapshotBeforeUpdate","Wk","mk","nk","ok","pk","Y","Z","qk","rk","sk","tk","uk","Infinity","vk","wk","xk","yk","zk","Ak","Bk","Ck","Dk","Ek","callbackNode","expirationTimes","expiredLanes","wc","callbackPriority","ig","Fk","Gk","Hk","Ik","Jk","Kk","Lk","Mk","Nk","Ok","Pk","finishedWork","finishedLanes","Qk","timeoutHandle","Rk","Sk","Tk","Uk","Vk","mutableReadLanes","Bc","Pj","onCommitFiberRoot","mc","onRecoverableError","Xk","onPostCommitFiberRoot","Yk","Zk","al","isReactComponent","pendingChildren","bl","mutableSourceEagerHydrationData","cl","pendingSuspenseBoundaries","fl","gl","hl","il","jl","zj","$k","ll","reportError","ml","_internalRoot","nl","ol","pl","ql","sl","rl","unmount","unstable_scheduleHydration","querySelectorAll","JSON","stringify","form","tl","usingClientEntryPoint","ul","findFiberByHostInstance","bundleType","rendererPackageName","vl","rendererConfig","overrideHookState","overrideHookStateDeletePath","overrideHookStateRenamePath","overrideProps","overridePropsDeletePath","overridePropsRenamePath","setErrorHandler","setSuspenseHandler","scheduleUpdate","currentDispatcherRef","findHostInstanceByFiber","findHostInstancesForRefresh","scheduleRefresh","scheduleRoot","setRefreshHandler","getCurrentFiber","reconcilerVersion","__REACT_DEVTOOLS_GLOBAL_HOOK__","wl","isDisabled","supportsFiber","inject","createPortal","dl","createRoot","unstable_strictMode","findDOMNode","flushSync","hydrate","hydrateRoot","hydratedSources","_getVersion","_source","unmountComponentAtNode","unstable_batchedUpdates","unstable_renderSubtreeIntoContainer","checkDCE","err","__self","__source","Fragment","jsx","jsxs","setState","forceUpdate","escape","_status","_result","Children","count","toArray","only","Profiler","PureComponent","StrictMode","Suspense","cloneElement","createContext","_currentValue2","_threadCount","Provider","Consumer","_defaultValue","_globalName","createFactory","createRef","forwardRef","isValidElement","lazy","memo","startTransition","unstable_act","sortIndex","performance","setImmediate","startTime","expirationTime","priorityLevel","scheduling","isInputPending","MessageChannel","port2","port1","onmessage","postMessage","unstable_Profiling","unstable_continueExecution","unstable_forceFrameRate","unstable_getFirstCallbackNode","unstable_next","unstable_pauseExecution","unstable_runWithPriority","delay","unstable_wrapCallback","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","loaded","__webpack_modules__","leafPrototypes","getProto","getPrototypeOf","__esModule","ns","def","definition","o","prop","nmd","paths","nc","_classCallCheck","Constructor","_typeof","_toPropertyKey","hint","prim","Number","_defineProperties","_createClass","protoProps","staticProps","_setPrototypeOf","setPrototypeOf","_inherits","subClass","superClass","_getPrototypeOf","_isNativeReflectConstruct","Proxy","Boolean","_assertThisInitialized","ReferenceError","_createSuper","Derived","hasNativeReflectConstruct","Super","NewTarget","_arrayLikeToArray","arr","arr2","_unsupportedIterableToArray","minLen","from","allowArrayLike","s","_e","normalCompletion","didErr","step","_e2","enumerableOnly","filter","sym","_objectSpread2","getOwnPropertyDescriptors","dedupe","equals","_step","_iterator","_createForOfIteratorHelper","mainLoop","_step2","item","_iterator2","existing","compact","omitFromStackTrace","wrappedFn","captureStackTrace","assert","assertExists","_iterableToArray","iter","promise","reject","timeout","_len","_key","latestArgs","_toConsumableArray","annotationsByError","annotateError","annotations","currentAnnotations","tags","extras","_objectSpread","getHashForString","hash","_arrayWithHoles","_nonIterableRest","_i","_s","_x","_r","_arr","_n","_d","rng","seed","modulate","rangeA","rangeB","clamp","_rangeA","_slicedToArray","fromLow","fromHigh","_rangeB","v0","v1","getOwnProperty","deepCopy","newObject","objectMapValues","objectMapEntries","isNonNull","isNonNullish","structuredClone","parse","IncrementalSetConstructor","previousValue","_defineProperty","_this$diff$removed$si","_this$diff","_this$diff$removed","_this$diff$added$size","_this$diff2","_this$diff2$added","numRemoved","diff","removed","numAdded","added","nextValue","wasAlreadyPresent","_this$nextValue","_this$diff3","_this$diff$removed2","_this$diff4","_this$diff4$added","_this$nextValue2","_this$diff5","_this$diff5$removed","_add","_this$nextValue3","_this$diff6","_this$diff7","_this$diff7$removed","_this$diff$added","_this$diff9","_this$diff9$removed","_this$diff8","_this$diff8$added","_remove","nanoid","crypto","getRandomValues","reduce","byte","RecordType","typeName","config","_config$validator","_this","record","createDefaultProperties","migrations","validator","validate","properties","createId","_Object$entries","_Object$entries$_i","createRecordType","_config$migrations","currentVersion","firstVersion","migrators","ArraySet","arraySize","elem","idx","visitor","isChild","haveParentsChanged","parents","__unsafe__getWithoutCapture","lastChangedEpoch","parentEpochs","detach","parent","remove","isEmpty","attach","EMPTY_ARRAY","freeze","signiaKey","CaptureStackFrame","below","unsafe__withoutCapture","oldStack","startCapturingParents","stopCapturingParents","_stack","frame","numNewParents","maybeRemoved","maybeRemovedParent","maybeCaptureParent","isActivelyListening","whyAmIRunning","_stack2","changedParents","changedParent","RESET_VALUE","HistoryBuffer","capacity","lastComputedEpoch","currentEpoch","fill","sinceEpoch","_elem","fromEpoch","toEpoch","GLOBAL_START_EPOCH","globalEpoch","globalIsReacting","Transaction","isRoot","atoms","initialAtomValues","flushChanges","atom","_atom$historyBuffer","historyBuffer","commit","reactors","traverse","lastTraversedEpoch","visit","maybeScheduleEffect","currentTransaction","transaction","txn","rollback","abort","transact","_Atom","_options$isEqual","isEqual","historyLength","computeDiff","_this$isEqual","_this$isEqual2","_ref","_this$computeDiff","pushEntry","oldValue","atomDidChange","epoch","_this$historyBuffer$g","_this$historyBuffer","getChangesSince","isAtom","UNINITIALIZED","isUninitialized","WithDiff","withDiff","_Computed","derive","isNew","lastCheckedEpoch","newState","computedAnnotation","originalMethod","derivationKey","getComputedInstance","inst","EffectScheduler","runEffect","_isActivelyListening","execute","_scheduleEffect","scheduleEffect","_scheduleCount","lastReactedEpoch","maybeExecute","react","scheduler","reactor","options2","_options2$force","force","stop","isSignal","Cache","items","objectMatchesQuery","query","matcher","neq","gt","executeQuery","matchIds","fromEntries","_i2","_Object$entries2","_Object$entries2$_i","ids","_step2$value","_step3","_iterator3","_step4","_iterator4","_step4$value","_step5","_iterator5","sets","rest","_loop","every","intersectSets","StoreQueries","history","historyCache","filtered","lastValue","getDiffSince","updated","numUpdated","changes","_Object$values","_Object$values2","_Object$values2$_i","to","_i3","_Object$values3","property","cacheKey","indexCache","__uncached_createIndex","_this2","typeHistory","filterHistory","fromScratch","_i4","_Object$values4","prevValue","setConstructors","_prevValue$get","setConstructor","_prevValue$get2","_i5","_Object$values5","_i6","_Object$values6","_Object$values6$_i","prev","_i7","_Object$values7","nextDiff","_step3$value","_this3","queryCreator","_this3$atoms$value$id","_this4","_this5","fromScratchWithDiff","_result$added","_result$removed","diffSets","cachedQuery","_i8","_Object$values8","_i9","_Object$values9","_Object$values9$_i","_i10","_Object$values10","Store","HistoryAccumulator","records","phaseOverride","updates","additions","currentMap","didChange","_map","recordAtom","schema","validateRecord","finalValue","updateHistory","onAfterCreate","onAfterChange","_runCallbacks","record2","_ref2","onBeforeDelete","atom2","update","onAfterDelete","_this$atoms$value$id","_this$atoms$value$id2","snapshot","put","_flushHistory","historyReactor","isMergingRemoteChanges","selector","initialData","_ref3","_ref4","requestAnimationFrame","historyAccumulator","hasChanges","phase","allRecords","dispose","intercepting","squashRecordDiffs","runCallbacks","prevRunCallbacks","toPut","_ref5","_ref6","toRemove","ensureStoreIsUsable","_isPossiblyCorrupted","diffs","_Object$entries3","_Object$entries3$_i","_Object$entries3$_i$","_Object$entries4","_Object$entries4$_i","_inteceptors","_history","interceptor","squashHistoryEntries","excluded","sourceKeys","sourceSymbolKeys","defineMigrations","subTypeKey","subTypeMigrations","MigrationFailureReason","MigrationFailureReason2","migrateRecord","fromVersion","toVersion","isRecord","recordWithoutMeta","_objectWithoutProperties","_excluded","nextVersion","migrator","reason","up","down","StoreSchema","types","_this$options$snapsho","_this$options$snapsho2","snapshotMigrations","recordBefore","recordType","onValidationFailure","persistedSchema","_ourType$migrations$s","direction","ourType","persistedType","recordVersions","UnknownType","ourVersion","persistedVersion","result2","ourSubTypeMigrations","persistedSubTypeVersion","subTypeVersions","UnrecognizedSubtype","IncompatibleSubtype","storeSnapshot","_persistedSchema$stor","ourStoreVersion","persistedStoreVersion","storeVersion","TargetVersionTooOld","migrate","migratePersistedRecord","_this$options$ensureS","_this$options","_this$options$snapsho3","_this$options$snapsho4","schemaVersion","_this$options$snapsho5","_this$options$snapsho6","compareSchemas","_Object$keys","aRecordVersion","bRecordVersion","_Object$keys2","subType","aSubTypeVersion","bSubTypeVersion","_construct","Parent","Class","_wrapNativeSuper","_cache","Wrapper","ValidationError","_Error","_super","rawMessage","path","formattedPath","startsWith","endsWith","formatPath","indentedMessage","line","prefixError","typeToString","debugValue","exhaustiveSwitchError","Validator","validationFn","otherValidationFn","nameOrCheckFn","checkFn","refine","ArrayOfValidator","_Validator","_super2","itemValidator","ObjectValidator","_Validator2","_super3","_this6","shouldAllowUnknownProperties","object2","_loop2","extension","UnionValidator","_Validator3","_super4","unknownValueValidation","_this7","variant","matchingSchema","DictValidator","_Validator4","_super5","keyValidator","valueValidator","_this8","_loop3","typeofValidator","number2","isFinite","positiveNumber","nonZeroNumber","isInteger","boolean","literal","expectedValue","actualValue","arrayOf","dict","union","unknownValue","unknownVariant","key2","model","setEnum","valuesString","value2","point","optional","boxModel","TL_STYLE_TYPES","TL_COLOR_TYPES","TL_DASH_TYPES","TL_FILL_TYPES","TL_SIZE_TYPES","TL_OPACITY_TYPES","TL_FONT_TYPES","TL_ALIGN_TYPES","TL_GEO_TYPES","TL_ARROWHEAD_TYPES","TL_SPLINE_TYPES","TL_ICON_TYPES","idValidator","userIdValidator","assetIdValidator","pageIdValidator","shapeIdValidator","instanceIdValidator","parentIdValidator","colorValidator","dashValidator","fillValidator","geoValidator","sizeValidator","fontValidator","alignValidator","arrowheadValidator","opacityValidator","iconValidator","splineValidator","cameraTypeValidator","Versions","TLCamera","withDefaultProperties","documentTypeValidator","gridSize","TLDocument","TLDOCUMENT_ID","createCustomId","uiColorTypeValidator","cursorValidator","rotation","TL_SCRIBBLE_STATES","scribbleTypeValidator","points","handleTypeValidator","canBind","instanceTypeValidator","userId","currentPageId","brush","propsForNextShape","labelColor","dash","font","align","icon","geo","arrowheadStart","arrowheadEnd","spline","cursor","scribble","nullable","isFocusMode","isDebugMode","isToolLocked","exportBackground","screenBounds","instanceTypeMigrations","_migrators","dialog","_excluded2","_excluded3","_excluded4","_ref7","_excluded5","_instance$propsForNex","_excluded6","TLInstance","instancePageStateTypeValidator","instanceId","pageId","cameraId","selectedIds","hintingIds","erasingIds","hoveredId","editingId","focusLayerId","TLInstancePageState","pageTypeValidator","TLPage","LANGUAGES","label","userTypeValidator","TLUser","_lang","lang","availLocales","languages","find","lang2","userDocumentTypeValidator","isReadOnly","isPenMode","isGridMode","isDarkMode","isMobileMode","isSnapMode","lastUpdatedPageId","lastUsedTabId","userDocumentTypeMigrations","userDocument","_userDocument$isMobil","TLUserDocument","userPresenceTypeValidator","lastUsedInstanceId","lastActivityTimestamp","TLUserPresence","sortByIndex","USER_COLORS","redactRecordForErrorReporting","origin","storePhase","isExistingValidationIssue","recordAfter","_store$props","tabId","userDocumentSettings","isInstance","pages","sort","instanceState","_store$get","_userDocumentSettings","currentPageId2","userPresences","page","instancePageStates","tps","ips","camera2","_ret","createAssetValidator","bookmarkAssetTypeValidator","title","description","image","bookmarkAssetMigrations","imageAssetTypeValidator","isAnimated","mimeType","imageAssetMigrations","asset","_asset$props","_asset$props2","others","_asset$props3","videoAssetTypeValidator","videoAssetMigrations","fixupRecord","oldRecord","issues","playing","normalizedAnchor","boundShapeId","isExact","assetId","segments","assetTypeValidator","video","bookmark","TLAsset","rootShapeTypeMigrations","isLocked","isShape","isShapeId","createShapeId","storeMigrations","createShapeValidator","parentId","arrowTerminalTypeValidator","arrowShapeTypeValidator","bend","arrowShapeMigrations","_record$props","bookmarkShapeTypeValidator","bookmarkShapeMigrations","shape","_shape$props","drawShapeTypeValidator","isComplete","isClosed","isPen","drawShapeMigrations","propsWithOutIsPen","tlEmbedShapePermissionDefaults","embedShapeTypeValidator","tmpOldUrl","doesResize","overridePermissions","TLDRAW_APP_RE","safeParseUrl","URL","EMBED_DEFINITIONS","hostnames","minWidth","minHeight","toEmbedUrl","urlObj","pathname","fromEmbedUrl","matches","_matches","user","_matches2","_matches3","_matches4","isAspectRatioLocked","hostname","videoId","searchParams","outUrl","_match","lat","lng","host","NEXT_PUBLIC_GC_API_KEY","_urlObj$searchParams$2","lon","instructionLink","cidQs","_keys","srcQs","_keys2","_keys3","_keys4","overrideOutlineRadius","backgroundColor","pathName","embedShapeMigrations","_originalUrl","originalUrl","_EMBED_DEFINITIONS","localEmbedDef","warn","_newUrl","newUrl","_EMBED_DEFINITIONS2","frameShapeTypeValidator","frameShapeMigrations","geoShapeTypeValidator","growY","geoShapeMigrations","groupShapeTypeValidator","groupShapeMigrations","scale","imageShapeTypeValidator","imageShapeMigrations","lineShapeTypeValidator","handles","lineShapeMigrations","noteShapeTypeValidator","noteShapeMigrations","textShapeTypeValidator","autoSize","textShapeMigrations","videoShapeTypeValidator","videoShapeMigrations","Op","desc","iteratorSymbol","asyncIteratorSymbol","asyncIterator","toStringTagSymbol","wrap","innerFn","outerFn","tryLocsList","protoGenerator","Generator","generator","Context","makeInvokeMethod","tryCatch","ContinueSentinel","GeneratorFunction","GeneratorFunctionPrototype","IteratorPrototype","NativeIteratorPrototype","Gp","defineIteratorMethods","_invoke","AsyncIterator","PromiseImpl","invoke","__await","unwrapped","previousPromise","callInvokeWithMethodAndArg","doneResult","delegate","delegateResult","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","methodName","info","resultName","nextLoc","pushTryEntry","locs","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","resetTryEntry","completion","reset","iterable","iteratorMethod","isGeneratorFunction","genFun","ctor","mark","awrap","async","reverse","skipTempReset","rootRecord","rval","exception","handle","loc","caught","hasCatch","hasFinally","finallyEntry","complete","finish","thrown","delegateYield","asyncGeneratorStep","gen","_next","_throw","EASINGS","linear","easeInQuad","easeOutQuad","easeInOutQuad","easeInCubic","easeOutCubic","easeInOutCubic","easeInQuart","easeOutQuart","easeInOutQuart","easeInQuint","easeOutQuint","easeInOutQuint","easeInSine","cos","PI","easeOutSine","sin","easeInOutSine","easeInExpo","easeOutExpo","easeInOutExpo","Vec2d","_ref$x","_ref$y","_ref$z","abs","distance","tan","Tan","mul","Dpr","Cpr","Len2","Len","Pry","Uni","Dist","DistanceToLineSegment","Slope","round","Angle","ToAngle","Equals","EqualsXY","ToFixed","ToString","ToJson","ToArray","Sub","len2","hypot","sqrt","Div","_ref2$z","Mul","pry","Add","Cast","NearestPointOnLineThroughPoint","NearestPointOnLineSegment","From","NaN","atan2","toFixed","avg","div","steps","Lrp","ease","TAU","PI2","EPSILON","SIN","toPrecision","precision","approximately","perimeterOfEllipse","ry","canolicalizeRotation","shortAngleDist","a0","lerpAngles","angleDelta","clampRadians","snapAngle","seg","ang","areAnglesCompatible","radiansToDegrees","getArcLength","sweep","getSweep","getPointOnCircle","cx","cy","getPolygonVertices","sides","pointsOnPerimeter","rangesOverlap","b0","b1","rangeIntersection","cross","pointInPolygon","windingNumber","toDomPrecision","Box2d","midX","midY","minX","minY","maxX","maxY","center","corners","delta","Collides","Contains","Includes","ContainsPoint","dx","dy","a0x","a0y","a1x","a1y","b0x","b0y","b1x","b1y","box","scaleX","scaleY","flipX","flipY","bw","tw","isTall","final","boxes","BaseSegment2d","_values","_computed","lut","curr","dist","bounds","pt","getPoint","midPoint","getPath","per","uni","getNormal","closestT","closestPoint","closestDistance","_Symbol$iterator","CubicSegment2d","_BaseSegment2d","_regeneratorRuntime","_callee","_this$values","head","_this$values2","_this$values3","_this$values4","_this$values5","BaseSpline2d","acc","segment","getSegmentsFromPoints","remaining","segmentLength","getPointAtLength","getNormalAtLength","getClosestPointTo","CubicSpline2d","_BaseSpline2d","p0","p1","p2","p3","LineSegment2d","_this$values6","Matrix2d","m2","multiply","Rotate","translate","Translate","Scale","denom","applyToPoint","applyToPoints","Decompose","toCssString","Identity","cosAngle","sinAngle","rotationMatrix2d","Compose","m1","matrix","hypotAc","acos","hypotBd","scaleMatrix2d","Polyline2d","FIXED_PI","getStrokeOutlinePoints","strokePoints","_options$size","_options$smoothing","smoothing","_options$start","_options$end","_options$last","_start$cap","cap","capStart","_end$cap","capEnd","strokePoint","firstStrokePoint","lastStrokePoint","totalLength","runningLength","taperStart","taper","taperEnd","minDistance","leftPts","rightPts","prevVector","vector","pr","tr","isPrevPointSharpCorner","_strokePoints$i","prevDpr","dpr","nextVector","nextDpr","isNextPointSharpCorner","radius","offset2","clone","cpr","start2","firstPoint","lastPoint","dotPts","startCap","cornersVector","offsetA","offsetB","endCap","neg","MIN_START_PRESSURE","MIN_END_PRESSURE","getStrokePoints","rawInputPoints","_strokePoints$","_options$streamline","streamline","_options$simulatePres","simulatePressure","pts","pointsRemovedFromNearEnd","pt2","last2","lrp","maxPressureAmongPoints","RATE_OF_PRESSURE_CHANGE","setStrokePointRadii","firstRadius","_options$thinning","thinning","_options$easing","easing","_start$easing","taperStartEase","_end$easing","taperEndEase","prevPressure","max2","sp","rp","ts","getStroke","intersectLineSegmentLineSegment","b2","ABx","ABy","BVx","BVy","AVx","AVy","ua_t","ub_t","u_b","intersectLineSegmentCircle","deter","u1","u2","intersectLineSegmentPolyline","segmentIntersection","intersectLineSegmentPolygon","intersectCirclePolygon","int","intersectCirclePolyline","ccw","linesIntersect","intersectPolygonPolygon","polygonA","polygonB","intersection","orderClockwise","SVGContainer","_ref$className","className","defineShape","getShapeUtil","_ref$migrations","createShapeUtils","app","MAX_SHAPES_PER_PAGE","ANIMATION_MEDIUM_MS","ZOOMS","MIN_ZOOM","MAX_ASSET_WIDTH","MAX_ASSET_HEIGHT","DIRECTION_DELTAS","right","upLeft","upRight","downLeft","downRight","HASH_PATERN_ZOOM_NAMES","DEFAULT_ANIMATION_OPTIONS","duration","HAND_TOOL_FRICTION","MIN_ARROW_LENGTH","BOUND_ARROW_OFFSET","DEFAULT_BOOKMARK_WIDTH","DEFAULT_BOOKMARK_HEIGHT","ROTATING_SHADOWS","offsetX","offsetY","blur","spread","GRID_STEPS","mid","TEXT_PROPS","fontVariant","fontStyle","padding","maxWidth","FONT_SIZES","xl","LABEL_FONT_SIZES","ARROW_LABEL_FONT_SIZES","FONT_FAMILIES","draw","sans","serif","mono","STYLES","useStateTracking","renderRef","React","_React$useMemo2","scheduler2","_renderRef$current","_scheduleUpdate","scheduleCount","subscribe","ProxyHandlers","argumentsList","_Component$displayNam","ReactMemoSymbol","ReactForwardRefSymbol","baseComponent","useAtom","valueOrInitialiser","useValue","isInRender","$val","_unused","_useMemo","listen","AppContext","useApp","WeakMapCache","debugFlags","preventDefaultLogging","createDebugValue","pointerCaptureLogging","pointerCaptureTracking","pointerCaptureTrackingObject","elementRemovalLogging","debugSvg","throwToBlob","peopleMenu","Element","nativeElementRemoveChild","shouldStore","storedValue","_window$sessionStorag","sessionStorage","getItem","getStoredInitialValue","currentValue","removeItem","setItem","newValue","getSvgAsString","svg","cloneNode","getAttribute","XMLSerializer","serializeToString","replaceAll","getSvgAsImage","_x2","_getSvgAsImage","_asyncToGenerator","_callee2","quality","dataUrl","canvas","blob","_context2","getSvgAsDataUrl","Image","crossOrigin","onload","canvas2","ctx","resolve2","getContext","imageSmoothingEnabled","imageSmoothingQuality","drawImage","revokeObjectURL","onerror","toBlob","blob2","_x3","_getSvgAsDataUrl","_callee3","fileReader","imgs","_imgs","_context4","FileReader","base64","_context3","fetch","readAsDataURL","getSvgAsDataUrlSync","svgStr","base64SVG","btoa","unescape","downloadDataURLAsFile","filename","download","click","getDataBlocksLength","hasColorTable","colorTableSize","imagesCount","TextDecoder","decode","isGIF","ACCEPTED_IMG_TYPE","ACCEPTED_VID_TYPE","ACCEPTED_ASSET_TYPE","isImage","ext","getVideoSizeFromSrc","_getVideoSizeFromSrc","onloadeddata","videoWidth","videoHeight","getImageSizeFromSrc","_getImageSizeFromSrc","dataURL","getResizedImageDataUrl","_x4","_x5","_getResizedImageDataUrl","dataURLForImage","newDataURL","toDataURL","getMediaAssetFromFile","_x6","_getMediaAssetFromFile","_callee5","file","_context5","reader","_callee4","isImageType","sizeFn","originalSize","containBoxSize","getFileMetaData","_x7","_getFileMetaData","_callee6","_context6","readAsArrayBuffer","containBoxSize2","overByXScale","overByYScale","createShapesFromFiles","_x8","_x9","_x10","_createShapesFromFiles","_callee9","files","pagePoint","newAssetsForFiles","shapePartials","prevModel","shapeUpdates","filteredUpdates","viewportPageBounds","pageBounds","_args9","_context9","_callee7","shapePartial","_context7","onCreateAssetFromFile","t0","_x14","_x15","_callee8","_context8","getAssetById","getAssetBySrc","_x16","_x17","createAssets","createShapes","setSelectedIds","getPageBoundsById","zoomToSelection","createEmbedShapeAtPoint","createBookmarkShapeAtPoint","_x11","_x12","_x13","_createBookmarkShapeAtPoint","_callee11","_context11","batch","_callee10","shapeId","_context10","onCreateBookmarkFromUrl","updateShapes","dataUrlToFile","arrayBuffer","File","_v1ColorsToV2Colors","_v1FontsToV2Fonts","_v1AlignsToV2Aligns","_v1TextSizesToV2TextS","_v1SizesToV2Sizes","_v1DashesToV2Dashes","uniqueId","loopToHtmlElement","elm","HTMLElement","parentElement","setPointerCapture","_trackingObj$get","trackingObj","releasePointerCapture","hasPointerCapture","rotateBoxShadow","shadows","cssStrings","shadow","_vec$rot","rot","usePrefersReducedMotion","_useState2","prefersReducedMotion","setPrefersReducedMotion","mql","matchMedia","handler","truncateStringWithEllipsis","maxLength","globlikeRegExp","escapeStringRegexp","checkHostnames","targetHostname","getEmbedInfoUnsafely","inputUrl","_matchUrl","embedUrl","matchUrl","matchEmbedUrl","getEmbedInfo","setPropsForNextShape","previousProps","newProps","_nextProps","nextProps","DIGITS","INTEGER_ZERO","SMALLEST_INTEGER","getIntegerLength","validateInteger","isNotUndefined","incrementInteger","_x$split2","_toArray","digs","carry","midpoint","digitA","digitB","midDigit","getIntegerPart","integerPartLength","validateOrder","generateKeyBetween","ib2","fb2","ibl","_x$split4","borrow","decrementInteger","ia2","fa2","i2","generateNKeysBetween","c2","getIndicesBetween","above","getIndicesAbove","getIndexBetween","getIndexAbove","getIndices","sortById","getRotationSnapshot","selectionRotation","selectionPageCenter","originPagePoint","inputs","selectedShapes","initialCursorAngle","angle","initialSelectionRotation","shapeSnapshots","initialPagePoint","getPagePointById","applyRotationToSnapshotShapes","stage","parentTransform","getPageTransformById","newPagePoint","newLocalPoint","Inverse","newRotation","_util$onRotate","getShapeById","util","_util$onRotateStart","changeStart","onRotateStart","changeUpdate","onRotate","_util$onRotateEnd","changeEnd","onRotateEnd","runtime","openWindow","defaultEmptyAs","dflt","getPointerInfo","container","isKilled","_container$getBoundin","getBoundingClientRect","precise","average","getSvgPathFromStroke","closed","getSvgPathFromStrokePoints","ContainerContext","ContainerProvider","useContainer","useQuickReactor","reactFn","CORNER_SVG","EDGE_SVG","ROTATE_CORNER_SVG","getCursorCss","CURSORS","none","pointer","move","grab","grabbing","rotate","getCursor","INPUTS","isFocusingInput","IGNORED_TAGS","_get","receiver","v2","rubberband","dimension","constant","rubberbandIfOutOfBounds","_toPrimitive","EVENT_TYPE_MAP","change","mouse","touch","gesture","capitalize","actionsWithoutCaptureSupported","toHandlerProp","device","deviceProps","actionKey","hasCapture","pointerCaptureEvents","parseProp","eventKey","captureKey","isTouch","getPointerType","distanceAngle","P1","P2","touchIds","_event$currentTarget","_event$currentTarget$","getCurrentTargetTouchList","identifier","touchDistanceAngle","_Array$from$filter2","wheelValues","chain","_len2","fns","_key2","_fns","assignDefault","Engine","ctrl","computeValues","computeInitial","init","gestureEventStores","gestureTimeoutStores","ingKey","_active","active","_blocked","_force","intentional","_movement","_distance","_direction","_delta","_bounds","axis","timeDelta","_movementBound","velocity","movement","lastOffset","_initial","initial","dt","pointerIds","locked","pointerLockElement","getEventDetails","pressed","_absoluteDelta","axisIntent","_state$_movement","_m0","_m1","_config$threshold","threshold","t1","hasCustomTransform","sign","_values2","restrictToAxis","previousOffset","gestureIsActive","setup","computeOffset","_state$offset","ox","oy","_state$_bounds","_state$_bounds$","x0","x1","_state$_bounds$2","y0","y1","Vx","Vy","Rx","Ry","_bounds$","X0","X1","_bounds$2","Y0","Y1","computeRubberband","computeMovement","absoluteDelta","clean","triggerAllEvents","_defineProperty2","aliasKey","eventStore","timeoutStore","CoordinatesEngine","_Engine","_len3","_key3","axisThreshold","absDx","absDy","selectAxis","lockDirection","identity","commonConfigResolver","enabled","eventOptions","_k","coordinatesConfigResolver","_v","_value$left","_value$right","_value$top","_value$bottom","bottom","isBrowser","isTouchScreen","maxTouchPoints","SUPPORT","GestureEvent","supportsGestureEvents","touchscreen","pointerLock","DEFAULT_DRAG_AXIS_THRESHOLD","pen","_ref6$pointer","_ref6$pointer2","_ref6$pointer2$touch","_ref6$pointer2$lock","lock","_ref6$pointer2$mouse","preventScrollAxis","preventScroll","preventScrollDelay","pointerCapture","_ref8","_ref8$pointer","_ref8$pointer2","_ref8$pointer2$captur","_ref8$pointer2$button","_ref8$pointer2$keys","pointerButtons","_ref9","_ref9$filterTaps","filterTaps","_ref9$tapsThreshold","tapsThreshold","_ref9$axis","swipe","_ref10","_ref10$velocity","_ref10$distance","_ref10$duration","keyboardDisplacement","clampStateInternalMovementToBounds","_state$overflow","_state$_delta2","_state$_direction","dirx","diry","PinchEngine","_Engine2","_len5","_key5","_pointerEvents","_touchIds","canceled","turns","_this$state","_this$state2","_state$_movement3","axisMovementDifference","compute","setEventIds","ctrlTouchIds","pinchStart","ctrlPointerIds","pinchMove","prev_a","delta_a","delta_turns","some","_previousMovement","modifierKey","wheelChange","wheelStart","wheelEnd","bindFunction","pinchOnWheel","wheel","pinchConfigResolver","_ref11","_ref11$pointer","_ref11$pointer2$touch","_ref12","_ref12$scaleBounds","scaleBounds","_ref12$angleBounds","angleBounds","_scaleBounds","_angleBounds","WheelEngine","mouseOnly","_CoordinatesEngine4","_super6","_this10","_len8","_key8","wheelConfigResolver","EngineMap","ConfigResolverMap","registerAction","engine","resolver","pinchAction","wheelAction","_objectWithoutPropertiesLoose","sharedConfigResolver","_window","_ref2$passive","_ref2$capture","resolveWith","resolvers","EventStore","gestureKey","_ctrl","_gestureKey","_listeners","toDomEventType","TimeoutStore","_window2","ms","_timeouts","Controller","internalHandlers","drag","setupGesture","scroll","pinch","hover","resolveGestures","nativeHandlers","newConfig","_config","_targetEventStore","gestures","sharedConfig","gestureConfig","bindToProps","nativeBindFunction","handlerProp","_parseProp","withPassiveOption","_options$capture","_options$passive","isNative","RE_NOT_NATIVE","registerGesture","actions","handlerKey","startKey","endKey","parseMergedHandlers","mergedHandlers","mergedConfig","_sortHandlers","_handlers","native","lastMatch","sortHandlers","_sortHandlers2","useRecognizers","applyHandlers","applyConfig","effect","createUseGesture","_parseMergedHandlers","MAX_ZOOM_STEP","IS_DARWIN","platform","normalizeWheel","signY","useGesture","lastWheelTime","useGestureEvents","prevOrigin","onWheel","canScroll","containsPoint","currentPagePoint","onPinchStart","WheelEvent","camera","onPinchEnd","onPinch","currentZoom","getHandle","handleId","useIsEditing","generateImage","darkMode","canvasEl","fillStyle","fillRect","globalCompositeOperation","lineCap","lineWidth","t2","beginPath","moveTo","lineTo","stroke","canvasBlob","usePattern","devicePixelRatio","isReady","setIsReady","defaultPatterns","whitePixelBlob","blackPixelBlob","getDefaultPatterns","_useState4","backgroundUrls","setBackgroundUrls","promises","createObjectURL","isCancelled","urls","patternUnits","exportPatternSvgDefs","divEl","pointerEventHandler","pageState","getContainer","ShapeFill","PatternFill","intZoom","zoomLevel","teenyTiny","getShapeFillSvg","colors","gEl","path1El","background","path2El","solid","semi","getSvgWithShapeFill","foregroundPath","backgroundPath","getPerfectDashProps","opts","_opts$closed","_opts$snap","snap","_opts$start","_opts$end","_opts$lengthRatio","lengthRatio","_opts$style","dashLength","dashCount","ratio","gapLength","stopEventPropagation","getTextSvgElement","_opts$padding","textElm","fontSize","fontFamily","lines","tspans","innerHeight","tspan","_str","out","textAlign","textMeasure","measureText","transforms","TLShapeUtil","_shape","_otherShape","createComputedCache","getHandles","_this$handlesCache$ge","handlesCache","getBounds","_this$boundsCache$get","boundsCache","shape2","getOutline","_this$outlineCache$ge","outlineCache","snapPoints","getCenter","shapes","outline","getArrowPoints","side","P0","PT","PB","compareLength","isStraight","bodyArc","ints","c1","r1","r2","intersectCircleCircle","handleArc","sweepFlag","getArrowheadPathForType","arrowhead","PL","PR","getBarHead","PL1","PR1","PL2","PR2","getSquareHead","PQ","getDiamondHead","getDotHead","getInvertedTriangleHead","getArrowhead","getTriangleHead","getBoundShapeInfoForTerminal","terminal","getPageTransform","didIntersect","getArrowTerminalInArrowSpace","arrowPageTransform","boundShape","_app$getBounds","shapePoint","getArrowTerminalsInArrowSpace","getStraightArrowInfo","terminalsInArrowSpace","uAB","startShapeInfo","endShapeInfo","updateArrowheadPointWithBoundShape","minDist","isSelfIntersection","setTo","didFlip","getStrokeWidth","nudge","middle","isValid","opposite","targetShapeInfo","targetInt","_intersection$sort$","pageFrom","pageTo","targetFrom","targetTo","pageInt","arrowInt","getStraightArrowHandlePath","getArrowPath","getSolidStraightArrowPath","getCurvedArrowHandlePath","_info$handleArc","largeArcFlag","getSolidCurvedArrowPath","_info$bodyArc","getArcInfo","theta","__decorateClass","TextHelpers","field","setRangeText","InputEvent","inputType","isComposing","initialFocus","execCommand","insertTextFirefox","select","insert","wrapEnd","selection","drift","matchStart","matchLength","currentEnd","lastLineStart","lastIndexOf","_exec","selectedContrast","lineBreakCount","firstLineStart","newSelection","indentedText","INDENT","replacementsCount","setSelectionRange","minimumSelectionEnd","findLineEnd","firstLineIndentation","difference","newSelectionStart","_getCaretIndex","_getCaretIndex2","_exec2","innerText","getCaretIndex","setBaseAndExtent","selection2","_getCaretIndex3","_getCaretIndex4","fixNewLines","getRangeAt","preCaretRange","cloneRange","selectNodeContents","endContainer","endOffset","useEditableText","rInput","isEditing","rSkipSelectOnFocus","rSelectionRanges","isEditableFromHover","isIn","editingShape","canEdit","handleFocus","handleBlur","ranges","_window$getSelection","handleKeyDown","unindent","indent","handleChange","text2","normalizeText","updateSelection2","_window$getSelection2","_selection$getRangeAt","ArrowTextLabel","_useEditableText","normalizeTextForDom","tabIndex","autoComplete","autoCapitalize","autoCorrect","autoSave","placeholder","spellCheck","dir","datatype","onFocus","onChange","onKeyDown","onBlur","onContextMenu","globalRenderIndex","TLArrowUtil","_TLShapeUtil","isPrecise2","isPrecise","pageTransform","pointInPageSpace","getShapesAtPoint","hitShape","hitTestPoint","getPointInShapeSpace","targetBounds","pointInTargetSpace","prevHandle","startBindingId","endBindingId","pointerVelocity","_getArrowTerminalsInA","med","startBinding","endBinding","isWithinSelection","_getArrowTerminalsInA2","terminals","sx","sy","ex","ey","mx","my","_this$getLabelBounds","getLabelBounds","getOutlineWithoutLabel","getArrowInfo","pointsToPush","startAngle","endAngle","outlineWithoutLabel","labelBounds","sideIndexes","prevPoint","didAddLabel","nextPoint","nearestIntersectingSideIndex","minVal","minBy","sideIndex","intersectingPoint","getIsArrowStraight","extraBend","startInPageSpace","endInPageSpace","centerInPageSpace","inverseTransform","startInStartShapeLocalSpace","endInStartShapeLocalSpace","centerInStartShapeLocalSpace","intersections","_intersections$","comparisonAngle","_intersections$2","startInEndShapeLocalSpace","endInEndShapeLocalSpace","centerInEndShapeLocalSpace","arcLength","_handleArc$center","midAngle","getCurvedArrowInfo","infoCache","_labelSize$w","onlySelectedShape","shouldDisplayHandles","isInAny","labelSize","changeIndex","isSafari","as","handlePath","_getPerfectDashProps","strokeDasharray2","strokeDashoffset2","markerStart","markerEnd","_getPerfectDashProps2","maskStartArrowhead","maskEndArrowhead","includeMask","maskId","strokeLinejoin","strokeLinecap","pointerEvents","mask","getCssColor","_getArrowTerminalsInA3","_shape$props2","_this4$app$textMeasur","_this4$app$textMeasur2","_this4$app$textMeasur3","labelBoundsCache","defs","rect","getArrowheadSvgMask","labelMask","g2","rect2","getArrowSvgPath","_getPerfectDashProps3","getArrowheadSvgPath","getTextLines","parseFloat","shapeFill","TLArrowShapeDef","HTMLContainer","LINK_ICON","HyperlinkButton","rel","onPointerDown","onPointerUp","draggable","WebkitMask","resizeBox","newPoint","_opts$minWidth","_opts$maxWidth","_opts$minHeight","_opts$maxHeight","maxHeight","_offset$rot$add","TLBoxUtil","TLBookmarkUtil","_TLBoxUtil","updateBookmarkAsset","pageRotation","getPageRotation","address","getHumanReadableAddress","boxShadow","alt","TLBookmarkShapeDef","PEN_EASING","solidSettings","getFreehandOptions","forceComplete","forceSolid","realPressureSettings","simulatePressureSettings","getPointsFromSegments","pointsToInterpolate","getDrawShapeStrokeDashArray","dotted","dashed","TLDrawUtil","getIsDot","newSegments","offsetDist","_last","allPointsFromSegments","showAsComplete","sw","solidStrokePath","getDot","strokeOutlinePoints","_last2","_font","_last3","fillPath","TLDrawShapeDef","Spinner","viewBox","fillRule","dur","repeatCount","TLEmbedUtil","_result$definition","canResize","_embedInfo$definition","embedInfo","_embedInfo$definition2","_embedInfo$definition3","_embedInfo$definition4","_embedInfo$definition5","isHoveringWhileEditingSameShape","_this2$app$pageState","isInteractive","idFromGistUrl","Gist","permissions","sandbox","frameBorder","referrerPolicy","border","borderRadius","_embedInfo$definition6","_embedInfo$definition7","rIframe","fileArg","gistLink","scrolling","seamless","srcDoc","TLEmbedShapeDef","FrameLabelInput","setEditingId","name2","FrameHeading","getPageRotationById","labelTranslate","scaledRotation","labelSide","TLFrameUtil","_type","_shapes","shouldHint","reparentShapesById","getPageBounds","shapesToReparent","getSortedChildIds","childId","childBounds","black","textBg","TLFrameShapeDef","TextLabel","DashStyleEllipse","perimeter","getOvalSolidPath","getOvalPerimeter","DashStyleOval","DashStyleOvalSvg","strokeElement","DashStylePolygon","bgOutline","innerPath","x2","y2","DrawStyleEllipse","getEllipseIndicatorPath","outerPath","getEllipsePath","getEllipseStrokeOptions","getEllipseStrokePoints","getRandom","DrawStylePolygon","getPolygonDrawPoints","getPolygonStrokeOptions","At","Bt","lastSegPoints","getPolygonIndicatorPath","SolidStyleEllipse","SolidStyleOval","getOvalIndicatorPath","SolidStylePolygon","MIN_SIZE_WITH_LABEL","TLGeoUtil","initialBounds","overShrinkX","overShrinkY","newW","newH","getLabelSize","nextW","nextH","prevHeight","nextHeight","prevText","nextText","prevWidth","nextSize","nextWidth","getXBoxOutline","rightMostIndex","leftMostIndex","bottomMostIndex","diffX","diffY","cx2","cy2","ix","iy","getShape","polygonPoints","svgElm","DrawStyleEllipseSvg","SolidStyleEllipseSvg","DashStyleEllipseSvg","SolidStyleOvalSvg","DrawStylePolygonSvg","strokeElementPathData","SolidStylePolygonSvg","fillElement","DashStylePolygonSvg","groupEl","textBgEl","append","minSize","LABEL_PADDING","TLGeoShapeDef","TLGroupUtil","popFocusLayer","deleteShapes","allChildPoints","getOutlineById","getTransform","_this$app","erasingIdsSet","_this$app$pageState","isErasing","isHintingOtherGroup","_this3$app$getShapeBy","GroupOutlineBox","TLGroupShapeDef","loadImage","getStateFrame","getDataURIFromURL","_getDataURIFromURL","response","onloadend","TLImageUtil","_asset$props$mimeType","_asset$props$mimeType2","staticFrameSrc","setStaticFrameSrc","cancelled","run","newStaticFrame","reduceMotion","backgroundImage","_toSvg","TLImageShapeDef","getLinePoints","allPoints","getLineDrawFreehandOptions","getLineStrokePoints","getLineDrawPath","getLineDrawStrokeOutlinePoints","getLineSvg","pfPath","getDrawLineShapeSvg","getSolidLineShapeSvg","getDashedLineShapeSvg","splinesCache","TLLineUtil","getSplineForLineShape","sortedHandles","pointNearToPolyline","splinePath","getLineIndicatorPath","_color","TLLineShapeDef","_shape$props3","handlePoints","NOTE_SIZE","TLNoteUtil","getGrowY","getHeight","adjustedColor","rect1","PADDING","TLNoteShapeDef","prevGrowY","sizeCache","TLTextUtil","initialShape","scaleDelta","_Vec2d$Add","resizeScaled","getMinDimensions","trimmedText","styleDidChange","textDidChange","boundsA","boundsB","getTextSize","wA","hA","wB","hB","_this$getMinDimension","_this$getMinDimension2","transformOrigin","onTouchEnd","_shape$props$scale","_shape$props$scale2","TLTextShapeDef","cw","TLVideoUtil","TLVideoUtilComponent","videoUtil","splitId","querySelector","serializeVideo","TLVideoShapeDef","showControls","rVideo","handlePlay","currentTime","handlePause","handleSetCurrentTime","_React$useState2","isLoaded","setIsLoaded","handleLoadedData","pause","playsInline","autoPlay","muted","loop","disableRemotePlayback","disablePictureInPicture","controls","onPlay","onPause","onTimeUpdate","onLoadedData","hidden","TldrawEditorConfig","_ref$shapes","_ref$tools","tools","_ref$allowUnknownShap","allowUnknownShapes","allShapeDefs","typeSet","shapeDef","shapeTypeMigrations","shapeValidator","validateUnknownVariants","shapeRecord","TLShape","storeSchema","instance_page_state","user_document","user_presence","_config$userId","_config$instanceId","persistedStore","CLIENT_FIXUP_SCRIPT","documentId","isShapeInPage","DEFAULT_OFFSETS","getActiveAreaScreenSpace","containerEl","cBbbox","bbox","viewportScreenBounds","ActiveAreaManager","offsets","getActiveAreaPageSpace","updateOffsets","disposables","CameraManager","elapsed","timeoutRemaining","decay","updateCullingBounds","ClickManager","_clickId","_clickTimeout","_clickState","lastPointerInfo","_clickScreenPoint","_previousScreenPoint","_getClickTimeout","currentScreenPoint","cancelDoubleClickTimeout","DprManager","rebind","_this$_currentMM","_currentMM","updateDevicePixelRatio","_this$_currentMM2","getMedia","DragAndDropManager","movingShapes","droppingNodeTimer","_this$app$getDropping","_this$app$getDropping2","currDroppingShapeId","getDroppingShape","setDragTimer","LAG_DURATION","clearInterval","handleDrag","_this$app$getDropping3","_this$app$getDropping4","prevDroppingShapeId","_this$app$getShapeUti","_this$app$getShapeUti2","prevDroppingShape","nextDroppingShape","onDragShapesOut","_this$app$getShapeUti3","_this$app$getShapeUti4","onDragShapesOver","setHintingIds","_this$app$getShapeUti5","_this$app$getShapeUti6","onDropShapesOver","EMPTY_STACK_ITEM","EmptyStackItem","StackItem","_Symbol$iterator2","stack2","HistoryManager","onBatchComplete","_commands","_batchDepth","ephemeral","squashing","preservesRedoStack","ignoringUpdates","undos","redos","do","_undos","squash","_redos","_this$_undos$value$he","_this$_undos$value$he2","mostRecentActionId","_transact","pushToRedoStack","_ref$toMark","toMark","_undos$head","command","onUndo","undo","_undo","_redos$head","onRedo","redo","mostRecent","ScribbleManager","timeoutMs","updateScribble","onComplete","_opts$size","_opts$color","_opts$opacity","onUpdate","resume","getScribble","findAdjacentGaps","gaps","gap","startNode","endNode","breadthIntersection","nextNodes","SnapManager","_this$_snapLines$valu","_snapLines","pageTransfrorm","_Matrix2d$applyToPoin","commonFrameAncestor","findCommonAncestor","processParent","isShapeInViewport","visibleShapesNotInSelection","snapPointsCache","horizontal","vertical","sortedShapesHorizontal","startEdge","endEdge","sortedShapesVertical","_nearestSnapsX$0$nudg","_nearestSnapsX$","_nearestSnapsY$0$nudg","_nearestSnapsY$","lockedAxis","initialSelectionPageBounds","initialSelectionSnapPoints","dragDelta","isXLocked","isYLocked","selectionPageBounds","selectionSnapPoints","otherNodeSnapPoints","visibleSnapPointsNotInSelection","nearestSnapsX","nearestSnapsY","minOffset","snapThreshold","findPointSnaps","findGapSnaps","pointSnaps","getPointSnapLines","gapSnaps","getGapSnapLines","lineId","handlePoint","getShapeUtilByDef","handleNumber","findIndex","segmentNumber","pageHeadSegments","pageTailSegments","snapHandleTranslate","additionalOutlines","_ref4$additionalOutli","pageOutlines","visibleShape","nearestPoint","snapLines","_nearestSnapsX$0$nudg2","_nearestSnapsX$2","_nearestSnapsY$0$nudg2","_nearestSnapsY$2","originalHandle","isResizingFromCenter","_Box2d$Resize","unsnappedResizedPageBounds","flipSelectionHandleX","flipSelectionHandleY","getResizeSnapPointsForHandle","primaryNudgeAxis","snappedDelta","snappedResizedPageBounds","snappedSelectionPoints","_step6","thisSnapPoint","_iterator6","otherSnapPoint","thisPoint","otherPoint","_step7","_iterator7","visibleGaps","centerNudge","otherCenterSnap","gapBreadthsOverlap","duplicationLeftNudge","protrusionDirection","duplicationRightNudge","_step8","_iterator8","duplicationTopNudge","duplicationBottomNudge","snapGroupsX","snapGroupsY","_step9","_iterator9","_step10","_iterator10","_step11","_iterator11","_step11$value","snapGroup","selectionSides","_step12","_iterator12","newGapsLength","gapBreadthIntersection","_step13","_iterator13","snaps","otherSnap","otherGap","dedupeGapSnaps","wordSeparator","fromCodePoint","textAlignmentsForLtr","justify","TextManager","getTextElement","classList","words","word","splits","finalWords","currentLine","offsetHeight","prevTextContent","wordWithSpace","afterTextContent","chars","currentSubLine","subLines","i3","newHeight2","joinedSubLines","TickManager","isPaused","cancelAnimationFrame","raf","tick","updatePointerVelocity","_this$app$inputs","EVENT_NAME_MAP","pointer_enter","pointer_leave","pointer_down","pointer_move","pointer_up","right_click","middle_click","key_down","key_up","interrupt","double_click","triple_click","quadruple_click","StateNode","_this$constructor","currState","_currState$children","id2","prevChildState","nextChildState","exit","enter","isActive","_this$cbName","cbName","handleEvent","_this$onEnter","onEnter","_this$onExit","_this$current$value","onExit","Idle","_StateNode","setCursor","setSelectedTool","Pointing","_util$handles","didTimeout","shapeType","_util$onHandleChange","onHandleChange","_change$props","startTerminal","startPreciseTimeout","clearPreciseTimeout","isDragging","_util$handles2","bailToMark","util2","handles2","_util2$onHandleChange","_this$app$getPointInS","isCreating","onInteractionEnd","preciseTimeout","TLArrowTool","Drawing","canDraw","isMenuOpen","lastRecordedPoint","startShape","mergeNextPoint","segmentMode","pagePointWhereNextSegmentChanged","pagePointWhereCurrentSegmentChanged","bail","lastSegment","didJustShiftClickToExtendPreviousShapeLine","prevSegment","pressure2","newSegment","prevPointPageSpace","getIsClosed","_this$app$getPointInS2","prevLastPoint","toJson","newFreeSegment","_this$app$inputs2","shouldSnapToAngle","newPoint2","didSnap","snapSegment","nearestPointOnSegment","snappedPoint","setLines","currentAngle","angleDiff","newPoints","z2","newShapeId","TLDrawTool","Erasing","markId","excludedShapeIds","shapesArray","isPointInShape","startScribble","onScribbleUpdate","onScribbleComplete","_this$app$inputs$curr","addPoint","setScribble","previousPagePoint","pushPointToScribble","erasing","pageMask","getPageMaskById","hitTestLineSegment","getOutermostSelectableShape","setErasingIds","initialSize","sortedShapesArray","TLEraserTool","wasFocusedOnEnter","creationCursorOffset","getDeltaInParentSpace","TLBoxTool","TLFrameTool","_TLBoxTool","getStarBounds","TLGeoTool","Dragging","previousScreenPoint","pan","slideCamera","speed","friction","stopCameraAnimation","TLHandTool","zoomIn","zoomOut","zoomToFit","resetZoom","markPointId","shapeExists","nextEndHandleIndex","nextEndHandleId","nextEndHandle","vertexHandles","endHandle","shapePagePoint","getParentTransform","nextHandles","TLLineTool","createShape","editAfterComplete","TLNoteTool","Translating","_info$isCreating","_info$editAfterComple","handleEnter","updateParent","dragAndDropManager","updateDroppingNode","updateParentTransforms","selectionSnapshot","isCloning","startCloning","stopCloning","_assertThisInitialize2","shapeSnapshot","duplicateShapes","getTranslatingSnapshot","handleStart","dropShapes","handleEnd","onlySelected","_util$onTranslateStar","onTranslateStart","_util$onTranslateEnd","onTranslateEnd","_util$onTranslate","onTranslate","snapshots","averagePagePoint","flatten","snapTranslate","averageSnappedPoint","snapToGrid","averageSnap","moveShapesToPoint","initialPageBounds","initialSnapPoints","pagePoints","selectedPageBounds","Brushing","initialSelectedIds","initialStartShape","onPointerMove","setBrush","hitTestShapes","localCorners","testAllShapes","handleHit","collides","hitTestBrushEdges","selectedShape","polygonsIntersect","DraggingHandle","initialHandle","initialPageTransform","initialPageRotation","initialAdjacentHandle","handle2","initialTerminal","isPreciseId","resetExactTimeout","exactTimeout","clearExactTimeout","pointingId","angleDifference","snapLineHandleTranslate","shapeSpaceNudge","getDeltaInShapeSpace","bindingAfter","EditingShape","hoveringShape","setHoveredId","_util$onEditEnd","onEditEnd","_this$parent$current$","_this$parent$current$2","_util$canEdit","createTextShapeAtPoint","_util$onDoubleClickEd","onDoubleClickEdge","startEditingShape","onDoubleClick","_util$onDoubleClick","_util2$onDoubleClickH","onDoubleClickHandle","selectNone","targetShape","isSelected","_this$app$getShapeByI","PointingCanvas","groupShape","clickPoint","_clickWasInsideFocusedGroup","setFocusLayer","PointingHandle","CursorTypeMap","bottom_left","bottom_right","top_left","top_right","bottom_left_rotate","bottom_right_rotate","top_left_rotate","top_right_rotate","mobile_rotate","PointingResizeHandle","updateCursor","cursorType","PointingRotateHandle","PointingSelection","PointingShape","_this$app$selectionBo","eventTargetShape","selectingShape","isBehindSelectionBounds","selectionBounds","didSelectOnEnter","getParentShape","cancelDoubleClick","_util$onClick","ancestors","getAncestors","Resizing","_info$creationCursorO","_createSnapshot","handleResizeStart","dragHandlePoint","getHandlePoint","cursorHandleOffset","_createShapeSnapshot","visitDescendants","descendantId","descendent","canShapesDeform","handleResizeEnd","_util$onResizeStart","onResizeStart","_util$onResizeEnd","onResizeEnd","_this$snapshot","sub","dragHandle","scaleOriginHandle","rotateSelectionHandle","snapResize","scaleOriginPage","distanceFromScaleOriginNow","distanceFromScaleOriginAtStart","isFlippedX","isFlippedY","resizeShape","scaleOrigin","scaleAxisRotation","nextCursor","ORDERED_SELECTION_HANDLES","numSteps","currentIndex","Rotating","newSelectionRotation","_getRotationFromPointerPosition","snapToNearestDegree","isCoarsePointer","snappedToRightAngle","angleToRightAngle","degreesToRadians","ScribbleBrushing","newlySelectedIds","hits","updateBrushSelection","outermostShape","TLSelectTool","_this$app$root$curren","TLTextTool","RootState","_App","_class","_EventEmitter","_ref$config","_complete","willCrashApp","crash","sharedProps","_extractSharedProps","createCommand","canUndo","originScreenPoint","isPointing","isPinching","isPanning","crashingError","_prevCursor","_shiftKeyTimeout","_setShiftKeyTimeout","_altKeyTimeout","_setAltKeyTimeout","_ctrlKeyTimeout","_setCtrlKeyTimeout","canMoveCamera","_updateInputsFromEvent","_pinchStart","_selectedIdsAtPointerDown","_didPinch","_info$point","_info$point$z","_info$delta","_assertThisInitialize4","cz","setCamera","_assertThisInitialize7","_this$viewportScreenC","viewportScreenCenter","animateCamera","_viewportAnimation","_this$isPenMode","_info$delta$z","_this$inputs$currentS","_this$camera","pageToScreen","_touchEventsRemainingBeforeExitingPenMode","setPenMode","_restoreToolId","currentToolId","_this$inputs","currentScreenPoint2","otherEvent","_clickManager","transformPointerDownEvent","transformPointerUpEvent","handleMove","partials","_assertThisInitialize8","shapeIds","prevSelectedIds","maxShapesReached","alertMaxShapes","partialsToCreate","partial","_partial$x","_partial$y","getParentIdForNewShapeAtPoint","_partial$x2","_partial$y2","_partial$rotation","parentIndices","shapeRecordsTocreate","_partial$parentId2","_this$getShapeUtil$on","_this$getShapeUtil","_partial$parentId","getHighestIndexForParent","initialProps","shapeRecordToCreate","onBeforeCreate","_partials","_newRecord","newRecord","_this$getShapeUtil$on2","_this$getShapeUtil2","onBeforeUpdate","prevData","nextData","allIds","deletedIds","arrowBindings","_arrowBindingsIndex","bindings","arrowId","postSelectedIds","_ref13","_ref14","_ref15","getPageById","_ref16","_ref17","_ref18","_pageInfo","_pageInfo2","belowPageIndex","pageInfo","topIndex","bottomIndex","prevPageState","prevInstanceState","getIncrementedName","newPage","newCamera","prevTabState","newTabPageState","_ref19","_ref20","deletedPage","deletedPageStates","_pageStates","_pages","setCurrentPageId","_ref21","_ref22","_partial$id","_ref23","_ref24","_ref25","presence","_currentUserPresence","prevSet","_ref26","_ref27","assets","_ref28","_ref29","_ref30","_ref31","_ref32","_ref33","_ref34","getPageStateByPageId","_ref35","_ref36","_ref37","_ref38","_ref39","_ref40","_ref41","shapeUtils","isIos","styles","_shapeWillBeDeleted","_pageWillBeDeleted","_updateDepth","_shapeDidChange","_tabStateDidChange","_arrowDidUpdate","_shapeIds","getCurrentPageId","shapesIndex","lastPageId","builder","shapeIdsInCurrentPage","_parentIdsToChildIds","_newValue","ensureNewArray","toSort","parentsToChildrenWithIndexes","_tickManager","_canMoveCamera","canMove","_ref42","defaultAnnotations","createErrorAnnotations","markAsPossiblyCorrupted","activeStateNode","_crashingError","_dprManager","openMenus","_isCoarsePointer","_isChangingStyle","_isChangingStyleTimeout","isChangingStyle","_pageTransformCache","frameAncestors","getAncestorsById","_intersectPolygonPoly","_pageMaskCache","localMask","_clipPathCache","numUndos","numRedos","withIndices","_childIdsCache","_ref43","childIds","clipboard","read","_selectionSharedProps","currentState","_prevProps","_this$userDocumentSet","_invalidParents","_util$onChildrenChang","onChildrenChange","updateUserPresence","shapeHistory","arrowQuery","bindings2Arrows","arrow","_arrow$props","arrows","_lastValue","_nextValue","removingBinding","addBinding","newShape","_newShape$props","prevTerminal","nextTerminal","_prev$props","arrowBindingsIndex","endShape","parentPageId","getParentPageId","nextParentId","_this$findCommonAnces","highestSibling","finalIndex","reparentedArrow","startSibling","getNearestSiblingShape","endSibling","higherSiblings","nextHighestNonArrowSibling","deletedShape","_step5$value","_unbindArrowTerminal","pageStates","_cleanupInstancePageState","isShapeInSamePageAsArrow","_reparentArrow","shapesNoLongerInPage","nextPageState","_this9","reparentBoundArrows","boundArrows","allMovingIds","instancePageState","_this10$getShapeById","_this10$getShapeById2","nextFocusLayerId","_this$pages$find","instanceStates","backupPageId","documentSettings","_this11","updateUserDocumentSettings","_isPenMode","_this12","_pageState","_this13","getShapesAndDescendantsInOrder","_this$_pageTransformC","getPageCenter","_pageBoundsCache","getMaskedPageBoundsById","findAncestor","ancestorId","hasAncestor","_this14","_this$findAncestor","nodeA","ancestor","_this15","cullingBounds","cullingBoundsExpanded","renderingShapes","getShapeToDisplay","parentOpacity","isAncestorErasing","isShapeErasing","isInViewport","isCulled","_this16","commonBounds","expand","_this17","_this18","_parents$get","boundsAreEqual","_willSetInitialBounds","updateInstanceState","before","viewportPageCenter","after","screenToPage","_cameraManager","panZoomIntoView","_this$instanceState$s","_this$viewportScreenB","_cullingBounds","_cullingBoundsExpanded","expandBy","unsafeGetWithoutCapture","_camera$z","_camera$z2","_this$pageState$focus","focusedShape","_match$id","_setFocusLayer","_this$getShapeById","setInstancePageState","localEditingBounds","getEditingBounds","pageEditingBounds","zoomToBounds","centerOnPoint","canReceiveNewChildrenOfType","maskedPageBounds","_this19","droppingShapes","canDropShapes","_filter","focusLayerShape","_this20","_this21","allRotations","_this22","_this23","_this24","pushShapeWithDescendants","otherShape","_this25","siblingShape","ancestor2","shapeIsInPage","isInPageSearch","sizes","_activeToolId","activeTool","activeToolId","_currentChildState$in","_currentChildState$in2","currentChildState","_state$children","childState","_this26","_this$inputs2","_info$point2","sz","_this$camera2","px","py","_this27","_partition2","satisfies","doesNotSatisfy","partition","nonShapes","updateViewportScreenBounds","allShapesCommonBounds","_this28","pageTransforms","allShapes","descendant","boundId","rootShapeIds","assetsSet","serialize","_this29","_options$select","_options$preserveIds","preserveIds","_options$preservePosi","preservePosition","_options$point","idMap","pasteParentId","lowestDepth","lowestAncestors","isDuplicating","rootShape","rootShapes","newShapes","mappedId","assetsToCreate","assetsToUpdate","_asset$props$src","allSettled","_ref45","newAsset","assets2","updateAssets","status","newCreatedShapes","onlyRoot","_s$x","_s$y","createCustomShapeId","_createShapes","_this30","_options$duration","_options$ease","animationId","animations","_arr2","animatingShapes","handleTick","animatingShapes2","partialsToUpdate","tPartials","_ref46","_updateShapes","_deleteShapes","_updateUserDocumentSettings","_updatePage","_createPage","_this31","getContent","createPage","putContent","_deletePage","_setInstancePageState","_this32","_setSelectedIds","selectedIdsSet","_this33","_assets","_createAssets","_deleteAssets","_updateAssets","_getSvg","_opts$scale","_opts$background","_opts$darkMode","_opts$preserveAspectR","preserveAspectRatio","realContainerEl","realContainerStyle","fakeContainerEl","containerStyle","fontsUsedInExport","_Array$from","_document$body$focus","_document$body","fontInstances","_fontInstances","_this34","_args4","getComputedStyle","getPropertyValue","_util$toSvg","utilSvgElement","shapeSvg","clipPath","innerElement","toSvg","grey","childNodes","fonts","isUsed","fontFaceRule","fontFile","base64Font","newFontFaceRule","fontName","family","$$_url","$$_fontface","updatePage","_this35","getShapesInPage","fromPageZ","_this35$selectionBoun","currentPage","toId","fromId","operation","_this36","getParentsMappedToChildren","movingSet","siblings","indices","movingIndices","selectIndex","isSelecting","isMoving","_siblings","_siblings2","reorderShapes","_this37","_this38","dim","shapeGap","_loop4","nextShape","gap2","maxCount","_this38$getShapeUtil$","_this38$getShapeUtil","localDelta","translateStartChanges","_this39","shapePageBounds","nextShapePageBounds","space","startWidth","spaces","nextBounds","commonAfter","centerDelta","_this$getShapeUtil$on3","_this$getShapeUtil3","translateStartChange","_this40","_this40$getShapeUtil$","_this40$getShapeUtil","translateChanges","_this41","midFirst","_this41$getShapeUtil$","_this41$getShapeUtil","shapeScale","preScaleShapePageCenter","postScaleShapePageCenter","_scalePagePoint","currentPageCenter","getPageCenterById","pageDelta","postScaleShapePagePoint","_this$getPointInParen","getPointInParentSpace","relativePoint","newRelativePagePoint","rotWith","_options$initialShape","_options$scaleOrigin","_this$getPageBoundsBy","_options$scaleAxisRot","_options$initialPageT","_options$initialBound","getBoundsById","_resizeUnalignedShape","onResize","_options$dragHandle","_options$mode","myScale","areWidthAndHeightAlignedWithCorrectAxis","_this$getPointInParen2","initialPageCenter","newPageCenter","initialPageCenterInParentSpace","newPageCenterInParentSpace","_this42","shapeBounds","localOffset","_Vec2d$Add2","insertIndex","_this43","parentPageRotation","decompose","sibs","sibWithInsertIndex","sibAbove","sib","_this44","idsToInclude","visitedIds","idsToCheck","_setCurrentPageId","_updateInstanceState","_this$getShapeById2","_this45","major","_step14","steppedDelta","_iterator14","_this$getShapeUtil$on4","_this$getShapeUtil4","_this46","initialIds","idsToCreate","idsMap","shapesToCreate","_shape$parentId","vec","siblingAboveId","siblingAbove","newBoundShapeId","pointInArrowSpace","ids2","_this47","getChildProp","_step15","_iterator15","childShape","_step16","_iterator16","_step17","_iterator17","currentShape","currentCamera","_setCamera","_this$viewportScreenB2","targetViewport","_animateToViewport","_this$viewportPageBou","pw","_this48","_this$camera3","_this$camera4","_this$camera5","z1","_this49","selectedBounds","_this50","bufferOffsets","_activeAreaManager","pageTop","pageRight","pageBottom","pageLeft","selectedTop","selectedRight","selectedBottom","selectedLeft","targetZoom","inset","_opts$duration","_this51","_animateViewport","_this$_viewportAnimat","easedViewport","targetViewportPage","_opts$duration2","_opts$easing","startViewport","_this52","_opts$speedThreshold","speedThreshold","currentSpeed","moveCamera","_this52$camera","movementVec","activeArea","viewportAspectRatio","shapeAspectRatio","_onCreateAssetFromFile","_onCreateBookmarkFromUrl","_doc$head$querySelect","_doc$head$querySelect2","_doc$head$querySelect3","_doc$head$querySelect4","_doc$head$querySelect5","_doc$head$querySelect6","resp","doc","DOMParser","parseFromString","_this$findCommonAnces2","_shapesWithRootParent","_this53","groupId","sortedShapeIds","_pageBounds$point","shapesWithRootParent","highestIndex","_this54","idsToSelect","n2","group2","App","defaultEditorAssetUrls","sansSerif","monospace","initialState","ErrorBoundary","_React$Component","_this$props$onError","_this$props","Brush","shouldDisplay","Grid","_app$camera","xmlns","GridLayer","xo","yo","gxo","gyo","Handle","lastX","lastY","_getHandle","_getHandle2","_getHandle3","onPointerEnter","_getHandle4","onPointerLeave","_getHandle5","useHandleEvents","HandlesContainer","handlesToDisplay","Cursor","CursorHint","viewport","ShapeWithPropsEquality","_this$shape","_other$shape","EvenInnererIndicator","indicator","InnerIndicator","IndicatorErrorFallback","ShapeIndicator","isHinting","LiveCollaborators","presences","interval","setInterval","COLLABORATOR_INACTIVITY_TIMEOUT","useActivePresences","userPresence","Collaborator","isCursorInViewport","CollaboratorScribble","Scribble","SelectionBg","hideSelectionBoundsBg","useSelectionEvents","releaseCapture","SQUARE_ROOT_PI","MobileRotateHandle","dataWd","RotateCornerHandle","targetSize","corner","SelectionFg","isReadonlyMode","topEvents","rightEvents","bottomEvents","leftEvents","topLeftEvents","topRightEvents","bottomRightEvents","bottomLeftEvents","isDefaultCursor","isChangingStyles","isTinyX","isTinyY","isSmallX","isSmallY","mobileHandleMultiplier","targetSizeX","targetSizeY","onlyShape","showSelectionBounds","hideSelectionBoundsFg","shouldDisplayBox","shouldDisplayControls","showCornerRotateHandles","hideRotateHandle","showMobileRotateHandle","showResizeHandles","hideResizeHandles","hideAlternateCornerHandles","showOnlyOneHandle","hideRotateCornerHandles","hideMobileRotateHandle","hideTopLeftCorner","hideTopRightCorner","hideBottomLeftCorner","hideBottomRightCorner","hideEdgeTargetsDueToCoarsePointer","hideEdgeTargets","ShapeErrorFallback","Shape","handlePointerMove","onTouchStart","useShapeEvents","rContainer","getClipPathById","canUnmount","CulledShape","InnerShape","PointsSnapLine","firstX","firstY","secondX","secondY","useNWtoSEdireciton","GapsSnapLine","edgeIntersection","nextEdgeIntersection","SnapLine","SnapLines","DupSvg","setHtml","getSvg","outerHTML","paddingTop","Canvas","onDropOverride","rCanvas","rHtmlLayer","rSvgLayer","_app$inputs$currentSc","info2","handleKeyUp","_document$activeEleme","ELEMENT_NODE","_app$inputs$currentSc2","handleTouchStart","_e$target","_e$target2","touchXPosition","touchXRadius","radiusX","handleWheel","useDocumentEvents","useCoarsePointer","PointerEvent","_target$tagName","toLocaleLowerCase","useFixSafariDoubleTapZoomPencilEvents","updateBounds","throttle","resizeObserver","ResizeObserver","contentRect","observe","disconnect","useScreenBounds","htmlElm","_usePattern","patternContext","patternIsReady","_onDrop","_e$dataTransfer","_e$dataTransfer$files","onDragOver","onDrop","useCanvasEvents","_rCanvas$current","ShapesToDisplay","refX","refY","orient","SelectedIdIndicators","HoveredShapeIndicator","HintedShapeIndicator","BASE_ERROR_URL","ErrorFallback","containerRef","shouldShowError","setShouldShowError","didCopy","setDidCopy","_useState6","shouldShowResetConfirmation","setShouldShowResetConfirmation","errorMessage","errorStack","isDarkModeFromApp","_useState8","setIsDarkMode","_containerRef$current","foundParentThemeClass","resetLocalState","_window$__tldraw__har","__tldraw__hardReset","textarea","reload","isMobileSafari","iOS","webkit","Layout","setScale","setScaleDebounced","useZoomCss","_app$cursor","useCursor","useDarkMode","ss","useForceUpdate","handleFocusOut","HTMLInputElement","HTMLTextAreaElement","useSafariFocusOutFix","usePreloadFont","_font$style","_font$weight","weight","featureSettings","stretch","unicodeRange","descriptors","fontInstance","FontFace","load","TldrawEditor","setContainer","TldrawEditorBeforeLoading","_props$assetUrls","_store","loadedStore","_usePreloadAssets","assetUrls","typefaces","getTypefaces","usePreloadAssets","preloadingComplete","preloadingError","createStore","LoadingScreen","ErrorScreen","TldrawEditorAfterLoading","onMount","_React$useState4","setApp","app2","prevApp","onMountEvent","handlerRef","useEvent","tldrawReady","onStoreChange","_app$crashingError","idbProxyableTypes","cursorAdvanceMethods","instanceOfAny","constructors","cursorRequestMap","transactionDoneMap","transactionStoreNamesMap","transformCache","reverseTransformCache","idbProxyTraps","IDBTransaction","objectStoreNames","objectStore","wrapFunction","IDBDatabase","IDBCursor","advance","continue","continuePrimaryKey","unwrap","storeNames","tx","transformCachableValue","unlisten","DOMException","cacheDonePromiseForTransaction","IDBObjectStore","IDBIndex","IDBRequest","request","success","promisifyRequest","openDB","blocked","upgrade","blocking","terminated","indexedDB","openPromise","oldVersion","newVersion","deleteDB","deleteDatabase","readMethods","writeMethods","cachedMethods","targetFuncName","useIndex","isWrite","storeName","_target","_args","oldTraps","tabIdKey","USER_DATA_KEY","globalUserData","_JSON$parse","localStorage","defaultDocumentKey","DEFAULT_DOCUMENT_NAME","_window$localStorage$","STORE_PREFIX","TAB_ID","_window$tabIdKey","dbNameIndexKey","getAllIndexDbNames","_JSON$parse2","addDbName","withDb","_withDb","storeId","database","createObjectStore","loadDataFromStore","_loadDataFromStore","universalPersistenceKey","_opts$didCancel","recordsStore","schemaStore","didCancel","getAll","storeChangesInIndexedDb","_storeChangesInIndexedDb","_opts$didCancel2","_Object$values$_i","_id","storeSnapshotInIndexedDb","_storeSnapshotInIndexedDb","_opts$didCancel3","BC","BroadcastChannel","BroadcastChannelMock","_name","_msg","TLLocalSyncClient","onLoad","onLoadError","channel","tlsync","serializedSchema","debug","diffQueue","schedulePersist","connect","_console","isDebugging","_connect","_data$schema","migrationResult","alert","didDispose","migrateStoreSnapshot","serializeEarliestVersion","mergeRemoteChanges","_msg2$schema","data2","_window$location","_window$location$relo","msg2","comparison","initTime","isReloading","shouldDoFullDBWrite","persistIfNeeded","doesDeleteInstance","applyDiff","scheduledPersistTimeout","didLastWriteError","isPersisting","diffQueueLength","storeIsPossiblyCorrupt","isPossiblyCorrupted","doPersist","_doPersist","_hardReset","_ref$shouldReload","shouldReload","useLocalSyncClient","_state$syncedStore","syncedStore","setSyncedStore","client","userDataUnsubcribe","subscribeToUserData","prevState","_extends","$e42e1063c40fb3ef$export$b9ecd428b558ff10","originalEventHandler","ourEventHandler","_ref$checkForDefaultP","checkForDefaultPrevented","$6ed0406888f73fc4$export$43e446d32b3d21af","$6ed0406888f73fc4$var$setRef","$6ed0406888f73fc4$export$c7b2cbe3552a0d05","$3vqmr$useCallback","$c512c27ab02ef895$export$50c7b4e9d9f19c1","scopeName","createContextScopeDeps","defaultContexts","createScope","scopeContexts","defaultContext","$3bkAK$createContext","scope","contexts","$3bkAK$useMemo","rootComponentName","BaseContext","$3bkAK$createElement","consumerName","$3bkAK$useContext","$c512c27ab02ef895$var$composeContextScopes","scopes","baseScope","createScope1","scopeHooks","useScope","overrideScopes","nextScopes1","nextScopes","currentScope","$5e63c961fc1ce211$export$8c6ed5c666ac1360","$9IrjX$forwardRef","forwardedRef","slotProps","childrenArray","$9IrjX$Children","slottable","$5e63c961fc1ce211$var$isSlottable","newElement","newChildren","$9IrjX$isValidElement","$9IrjX$createElement","$5e63c961fc1ce211$var$SlotClone","$9IrjX$babelruntimehelpersesmextends","$9IrjX$cloneElement","childProps","slotPropValue","propName","childPropValue","$5e63c961fc1ce211$var$mergeProps","$9IrjX$composeRefs","$5e63c961fc1ce211$export$d9f1ccf0bdb05d45","$9IrjX$Fragment","$e02a7d9cb1dc128c$export$c74125a8e3af6bb2","PROVIDER_NAME","_$6vYhU$createContext2","$6vYhU$createContextScope","createCollectionContext","createCollectionScope","_createCollectionCont2","collectionRef","itemMap","CollectionProviderImpl","useCollectionContext","CollectionProvider","$6vYhU$react","COLLECTION_SLOT_NAME","CollectionSlot","composedRefs","$6vYhU$useComposedRefs","$6vYhU$Slot","ITEM_SLOT_NAME","ITEM_DATA_ATTR","CollectionItemSlot","_$6vYhU$react$createE","itemData","Slot","ItemSlot","getItems","collectionNode","orderedNodes","orderedItems","$8927f6f2acc4f386$export$250ffa63cdc0d034","primitive","Node","$4q5Fq$forwardRef","asChild","primitiveProps","Comp","$4q5Fq$Slot","$4q5Fq$useEffect","$4q5Fq$createElement","$4q5Fq$babelruntimehelpersesmextends","$8927f6f2acc4f386$export$6d1a0317bde7de7f","$4q5Fq$flushSync","$b1b2314f5f9a1d84$export$25bec8c6f54ee79a","callbackRef","$lwiWj$useRef","$lwiWj$useEffect","$lwiWj$useMemo","_callbackRef$current2","_callbackRef$current","$5cb92bef7577960e$var$originalBodyPointerEvents","$5cb92bef7577960e$var$CONTEXT_UPDATE","$5cb92bef7577960e$var$POINTER_DOWN_OUTSIDE","$5cb92bef7577960e$var$FOCUS_OUTSIDE","$5cb92bef7577960e$var$DismissableLayerContext","$kqwpH$createContext","layers","layersWithOutsidePointerEventsDisabled","branches","$5cb92bef7577960e$export$177fb62ff3ec1f22","$kqwpH$forwardRef","_node$ownerDocument","_props$disableOutside","disableOutsidePointerEvents","onEscapeKeyDown","onPointerDownOutside","onFocusOutside","onInteractOutside","onDismiss","layerProps","$kqwpH$useContext","_$kqwpH$useState2","$kqwpH$useState","node1","setNode","$kqwpH$useComposedRefs","highestLayerWithOutsidePointerEventsDisabled","highestLayerWithOutsidePointerEventsDisabledIndex","isBodyPointerEventsDisabled","isPointerEventsEnabled","pointerDownOutside","handlePointerDownOutside","$kqwpH$useCallbackRef","isPointerInsideReactTreeRef","$kqwpH$useRef","handleClickRef","$kqwpH$useEffect","handlePointerDown","handleAndDispatchPointerDownOutsideEvent","$5cb92bef7577960e$var$handleAndDispatchCustomEvent","eventDetail","discrete","originalEvent","onPointerDownCapture","$5cb92bef7577960e$var$usePointerDownOutside","isPointerDownOnBranch","branch","focusOutside","handleFocusOutside","isFocusInsideReactTreeRef","onFocusCapture","onBlurCapture","$5cb92bef7577960e$var$useFocusOutside","onEscapeKeyDownProp","$hPSQ5$useCallbackRef","$hPSQ5$useEffect","$kqwpH$useEscapeKeydown","$5cb92bef7577960e$var$dispatchUpdate","handleUpdate","$kqwpH$createElement","$kqwpH$Primitive","$kqwpH$babelruntimehelpersesmextends","$kqwpH$composeEventHandlers","$5cb92bef7577960e$export$4d5eb2109db14228","CustomEvent","$kqwpH$dispatchDiscreteCustomEvent","$5cb92bef7577960e$export$be92b6f5f03c0fe9","$5cb92bef7577960e$export$aecb2ddcb55c95be","$f1701beae083dbae$export$602eac185826482c","$7SXl2$forwardRef","_globalThis$document","_props$container","portalProps","$7SXl2$reactdom","$7SXl2$createElement","$7SXl2$Primitive","$7SXl2$babelruntimehelpersesmextends","$9f79659886946c16$export$e5c5a5f917a5871c","$dxlwH$useLayoutEffect","$921a889cee6df7e8$export$99c2b779aa4e8b8b","present","_$iqq3r$useState2","$iqq3r$useState","stylesRef","$iqq3r$useRef","prevPresentRef","prevAnimationNameRef","_$fe963b355347cc68$ex","machine","$iqq3r$useReducer","nextState","$fe963b355347cc68$export$3e6543de14f8614f","mounted","UNMOUNT","ANIMATION_OUT","unmountSuspended","MOUNT","ANIMATION_END","unmounted","_$fe963b355347cc68$ex2","send","$iqq3r$useEffect","currentAnimationName","$921a889cee6df7e8$var$getAnimationName","$iqq3r$useLayoutEffect","wasPresent","prevAnimationName","handleAnimationEnd","isCurrentAnimation","$iqq3r$flushSync","handleAnimationStart","isPresent","$iqq3r$useCallback","$921a889cee6df7e8$var$usePresence","$iqq3r$Children","$iqq3r$useComposedRefs","$iqq3r$cloneElement","$71cd76cc60e0454e$export$6f32135080cb4c3","defaultProp","_ref$onChange","_$71cd76cc60e0454e$va","uncontrolledState","$bnPw9$useState","prevValueRef","$bnPw9$useRef","$bnPw9$useCallbackRef","$bnPw9$useEffect","$71cd76cc60e0454e$var$useUncontrolledState","_$71cd76cc60e0454e$va2","uncontrolledProp","setUncontrolledProp","isControlled","value1","$bnPw9$useCallback","$ea1ef594cf570d83$export$439d29a4e110a164","$kVwnw$forwardRef","$kVwnw$createElement","$kVwnw$Primitive","$kVwnw$babelruntimehelpersesmextends","margin","clip","whiteSpace","wordWrap","$054eb8030ebde76e$var$PROVIDER_NAME","_$eyrYI$createCollect2","$eyrYI$createCollection","$054eb8030ebde76e$var$Collection","$054eb8030ebde76e$var$useCollection","_$eyrYI$createContext2","$eyrYI$createContextScope","$054eb8030ebde76e$var$createToastContext","_$054eb8030ebde76e$va2","$054eb8030ebde76e$var$ToastProviderProvider","$054eb8030ebde76e$var$useToastProviderContext","$054eb8030ebde76e$export$f5d03d415824e0e","__scopeToast","_props$label","_props$duration","_props$swipeDirection","swipeDirection","_props$swipeThreshold","swipeThreshold","_$eyrYI$useState2","$eyrYI$useState","setViewport","_$eyrYI$useState4","toastCount","setToastCount","isFocusedToastEscapeKeyDownRef","$eyrYI$useRef","isClosePausedRef","$eyrYI$createElement","onViewportChange","onToastAdd","$eyrYI$useCallback","prevCount","onToastRemove","propTypes","$054eb8030ebde76e$var$VIEWPORT_NAME","$054eb8030ebde76e$var$VIEWPORT_DEFAULT_HOTKEY","$054eb8030ebde76e$var$VIEWPORT_PAUSE","$054eb8030ebde76e$var$VIEWPORT_RESUME","$054eb8030ebde76e$export$6192c2425ecfd989","$eyrYI$forwardRef","hotkey","_props$hotkey","_props$label2","viewportProps","wrapperRef","headFocusProxyRef","tailFocusProxyRef","$eyrYI$useComposedRefs","hotkeyLabel","hasToasts","$eyrYI$useEffect","_ref$current","wrapper","pauseEvent","handleResume","resumeEvent","handleFocusOutResume","handlePointerLeaveResume","getSortedTabbableCandidates","tabbingDirection","tabbableCandidates","toastItem","toastNode","toastTabbableCandidates","nodes","walker","createTreeWalker","NodeFilter","SHOW_ELEMENT","acceptNode","isHiddenInput","FILTER_SKIP","FILTER_ACCEPT","nextNode","currentNode","$054eb8030ebde76e$var$getTabbableCandidates","isMetaKey","_headFocusProxyRef$cu","focusedElement","isTabbingBackwards","_headFocusProxyRef$cu2","_tailFocusProxyRef$cu","sortedCandidates","candidate","$054eb8030ebde76e$var$focusFirst","$eyrYI$Branch","role","$054eb8030ebde76e$var$FocusProxy","onFocusFromOutsideViewport","$eyrYI$Primitive","$eyrYI$babelruntimehelpersesmextends","$054eb8030ebde76e$var$FOCUS_PROXY_NAME","proxyProps","$eyrYI$VisuallyHidden","_context$viewport","prevFocusedElement","$054eb8030ebde76e$var$TOAST_NAME","$054eb8030ebde76e$export$8d8dc7d5f743331b","forceMount","openProp","defaultOpen","onOpenChange","toastProps","_$eyrYI$useControllab2","$eyrYI$useControllableState","_$eyrYI$useControllab3","setOpen","$eyrYI$Presence","$054eb8030ebde76e$var$ToastImpl","onClose","$eyrYI$useCallbackRef","onResume","onSwipeStart","$eyrYI$composeEventHandlers","onSwipeMove","_event$detail$delta","onSwipeCancel","removeProperty","onSwipeEnd","_event$detail$delta2","_$054eb8030ebde76e$va4","$054eb8030ebde76e$var$ToastInteractiveProvider","$054eb8030ebde76e$var$useToastInteractiveContext","_props$type","durationProp","_$eyrYI$useState6","pointerStartRef","swipeDeltaRef","duration1","closeTimerStartTimeRef","closeTimerRemainingTimeRef","closeTimerRef","handleClose","_context$viewport2","startTimer","getTime","announceTextContent","$eyrYI$useMemo","$054eb8030ebde76e$var$getAnnounceTextContent","$eyrYI$Fragment","$054eb8030ebde76e$var$ToastAnnounce","$eyrYI$createPortal","$eyrYI$Root","userSelect","touchAction","hasSwipeMoveStarted","isHorizontalSwipe","clampedX","clampedY","moveStartBuffer","$054eb8030ebde76e$var$handleAndDispatchCustomEvent","$054eb8030ebde76e$var$isDeltaInDirection","event1","toast","announceProps","_$eyrYI$useState8","renderAnnounceText","setRenderAnnounceText","_$eyrYI$useState10","isAnnounced","setIsAnnounced","$eyrYI$useLayoutEffect","raf1","raf2","$054eb8030ebde76e$var$useNextFrame","timer","$eyrYI$Portal","$054eb8030ebde76e$export$16d42d7c29b95a4","titleProps","$054eb8030ebde76e$export$ecddd96c53621d9a","descriptionProps","_excluded7","$054eb8030ebde76e$var$ACTION_NAME","$054eb8030ebde76e$export$3019feecfda683d2","altText","actionProps","_excluded8","$054eb8030ebde76e$var$ToastAnnounceExclude","$054eb8030ebde76e$export$811e70f61c205839","$054eb8030ebde76e$var$CLOSE_NAME","closeProps","_excluded9","interactiveContext","announceExcludeProps","_excluded10","TEXT_NODE","$054eb8030ebde76e$var$isHTMLElement","ariaHidden","isExcluded","radixToastAnnounceExclude","radixToastAnnounceAlt","$eyrYI$dispatchDiscreteCustomEvent","isDeltaX","candidates","previouslyFocusedElement","$054eb8030ebde76e$export$be92b6f5f03c0fe9","$054eb8030ebde76e$export$f99233281efd08a0","$054eb8030ebde76e$export$393edc798c47379d","$054eb8030ebde76e$export$e19cd5f9376f8cee","$054eb8030ebde76e$export$f39c2d165cd861fe","$f631663db3294ace$var$DirectionContext","$7Gjcd$createContext","$f631663db3294ace$export$b39126d51d94e6f3","localDir","globalDir","$7Gjcd$useContext","$3db38b7d1fb3fe6a$var$count","$3db38b7d1fb3fe6a$export$b7ece24a22aeda8c","$1wErz$useEffect","_edgeGuards$","_edgeGuards$2","edgeGuards","insertAdjacentElement","$3db38b7d1fb3fe6a$var$createFocusGuard","cssText","$d3863c46a17e8a28$var$AUTOFOCUS_ON_MOUNT","$d3863c46a17e8a28$var$AUTOFOCUS_ON_UNMOUNT","$d3863c46a17e8a28$var$EVENT_OPTIONS","$d3863c46a17e8a28$export$20e40289641fbbb6","$45QHv$forwardRef","_props$loop","_props$trapped","trapped","onMountAutoFocusProp","onMountAutoFocus","onUnmountAutoFocusProp","onUnmountAutoFocus","scopeProps","_$45QHv$useState2","$45QHv$useState","container1","$45QHv$useCallbackRef","lastFocusedElementRef","$45QHv$useRef","$45QHv$useComposedRefs","focusScope","paused","$45QHv$useEffect","handleFocusIn","$d3863c46a17e8a28$var$focus","$d3863c46a17e8a28$var$focusScopesStack","mountEvent","_ref$select","$d3863c46a17e8a28$var$focusFirst","$d3863c46a17e8a28$var$getTabbableCandidates","unmountEvent","$45QHv$useCallback","isTabKey","_$d3863c46a17e8a28$va","$d3863c46a17e8a28$var$findVisible","$d3863c46a17e8a28$var$getTabbableEdges","_$d3863c46a17e8a28$va2","$45QHv$createElement","$45QHv$Primitive","$45QHv$babelruntimehelpersesmextends","elements","$d3863c46a17e8a28$var$isHidden","upTo","visibility","_ref3$select","$d3863c46a17e8a28$var$isSelectableInput","activeFocusScope","$d3863c46a17e8a28$var$arrayRemove","_stack$","$d3863c46a17e8a28$var$createFocusScopesStack","updatedArray","$1746a345f3d73bb7$var$useReactId","$2AODx$react","$1746a345f3d73bb7$var$count","$1746a345f3d73bb7$export$f680877a34711e37","deterministicId","_$2AODx$react$useStat2","setId","$2AODx$useLayoutEffect","reactId","reference","floating","_n$placement","_n$strategy","_n$middleware","_a$_n","_p","_h","_yield$h","_y","_w","placement","strategy","middleware","isRTL","getElementRects","initialPlacement","middlewareData","rects","t3","_e13","_e13$boundary","_e13$rootBoundary","_e13$elementContext","_e13$altBoundary","_e13$padding","boundary","rootBoundary","elementContext","altBoundary","isElement","t4","t5","contextElement","getDocumentElement","t6","t7","t8","t9","t10","getClippingRect","t11","t12","convertOffsetParentRelativeRectToViewportRelativeRect","t14","t15","getOffsetParent","t16","t17","t18","offsetParent","t13","t19","_data","_ref2$padding","getDimensions","clientHeight","clientWidth","main","_e$mainAxis","_e$crossAxis","_e$fallbackStrategy","_e$flipAlignment","_p3","_t","_t2","_e3","_n3","_t3","mainAxis","crossAxis","fallbackPlacements","fallbackStrategy","flipAlignment","flip","overflows","_ref4$strategy","_e4","_e5","referenceHiddenOffsets","referenceHidden","escapedOffsets","escaped","alignmentAxis","_objectSpread3","_e6","_e6$mainAxis","_e6$crossAxis","_e6$limiter","_t4","_t5","limiter","_e7","_e7$offset","_e7$mainAxis","_e7$crossAxis","_n6","availableHeight","availableWidth","userAgentData","brands","brand","ShadowRoot","overflowX","overflowY","perspective","contain","willChange","offsetWidth","visualViewport","offsetLeft","offsetTop","pageXOffset","pageYOffset","clientLeft","clientTop","assignedSlot","scrollWidth","scrollHeight","getRootNode","getClientRects","_o","_o$ancestorScroll","ancestorScroll","_o$ancestorResize","ancestorResize","_o$elementResize","elementResize","_o$animationFrame","animationFrame","deepEqual","useFloating","_temp","_ref3$placement","_ref3$strategy","whileElementsMounted","whileElementsMountedRef","useLatestRef","cleanupRef","setData","latestMiddleware","setLatestMiddleware","computePosition","isMountedRef","ReactDOM","runElementMountCallback","cleanupFn","setReference","setFloating","arrow$1","$db6c3485150b8e66$export$1ab7ae714698c4b8","_$9gyGR$useState2","$9gyGR$useState","setSize","$9gyGR$useLayoutEffect","borderSizeEntry","borderSize","unobserve","$cf1ac5d9fe0e8206$var$POPPER_NAME","_$kY93V$createContext2","$kY93V$createContextScope","$cf1ac5d9fe0e8206$var$createPopperContext","$cf1ac5d9fe0e8206$export$722aac194ae923","_$cf1ac5d9fe0e8206$va2","$cf1ac5d9fe0e8206$var$PopperProvider","$cf1ac5d9fe0e8206$var$usePopperContext","$cf1ac5d9fe0e8206$export$badac9ada3a0bdf9","__scopePopper","_$kY93V$useState2","$kY93V$useState","anchor","setAnchor","$kY93V$createElement","onAnchorChange","$cf1ac5d9fe0e8206$var$ANCHOR_NAME","$cf1ac5d9fe0e8206$export$ecd4e1ccab6ed6d","$kY93V$forwardRef","virtualRef","anchorProps","$kY93V$useRef","$kY93V$useComposedRefs","$kY93V$useEffect","$kY93V$Primitive","$kY93V$babelruntimehelpersesmextends","$cf1ac5d9fe0e8206$var$CONTENT_NAME","_$cf1ac5d9fe0e8206$va4","$cf1ac5d9fe0e8206$var$PopperContentProvider","_$cf1ac5d9fe0e8206$va6","hasParent","positionUpdateFns","$cf1ac5d9fe0e8206$var$PositionContextProvider","$cf1ac5d9fe0e8206$var$usePositionContext","$cf1ac5d9fe0e8206$export$bc4ae5855d3c4fc","_arrowSize$width","_arrowSize$height","_middlewareData$arrow","_middlewareData$arrow2","_middlewareData$arrow3","_middlewareData$hide","_middlewareData$trans","_middlewareData$trans2","_props$side","_props$sideOffset","sideOffset","_props$align","_props$alignOffset","alignOffset","_props$arrowPadding","arrowPadding","_props$collisionBound","collisionBoundary","_props$collisionPaddi","collisionPadding","collisionPaddingProp","_props$sticky","_props$hideWhenDetach","hideWhenDetached","_props$avoidCollision","avoidCollisions","onPlaced","contentProps","_$kY93V$useState4","setContent","_$kY93V$useState6","setArrow","arrowSize","$kY93V$useSize","arrowWidth","arrowHeight","desiredPlacement","hasExplicitBoundaries","detectOverflowOptions","$cf1ac5d9fe0e8206$var$isNotNull","_$kY93V$useFloating","$kY93V$useFloating","$kY93V$autoUpdate","$cf1ac5d9fe0e8206$var$anchorCssProperties","$kY93V$offset","$kY93V$shift","$kY93V$limitShift","$kY93V$arrow","$kY93V$flip","$kY93V$size","$cf1ac5d9fe0e8206$var$transformOrigin","$kY93V$hide","$cf1ac5d9fe0e8206$var$isDefined","$kY93V$useLayoutEffect1","isPlaced","_$cf1ac5d9fe0e8206$va8","$cf1ac5d9fe0e8206$var$getSideAndAlignFromPlacement","placedSide","placedAlign","handlePlaced","$kY93V$useCallbackRef","arrowX","arrowY","cannotCenterArrow","centerOffset","_$kY93V$useState8","contentZIndex","setContentZIndex","_$cf1ac5d9fe0e8206$va9","$kY93V$useLayoutEffect","commonProps","hide","onArrowChange","shouldHideArrow","_rects$reference","_middlewareData$arrow4","_middlewareData$arrow5","_middlewareData$arrow6","_middlewareData$arrow7","_middlewareData$arrow8","isArrowHidden","_$cf1ac5d9fe0e8206$va11","noArrowAlign","arrowXCenter","arrowYCenter","_placement$split2","_placement$split2$","$cf1ac5d9fe0e8206$export$be92b6f5f03c0fe9","$cf1ac5d9fe0e8206$export$b688253958b8dfe7","$cf1ac5d9fe0e8206$export$7c6e2c02157bb7d2","$d7bdfb9eb0fdf311$var$ENTRY_FOCUS","$d7bdfb9eb0fdf311$var$EVENT_OPTIONS","$d7bdfb9eb0fdf311$var$GROUP_NAME","_$98Iye$createCollect2","$98Iye$createCollection","$d7bdfb9eb0fdf311$var$Collection","$d7bdfb9eb0fdf311$var$useCollection","_$98Iye$createContext2","$98Iye$createContextScope","$d7bdfb9eb0fdf311$var$createRovingFocusGroupContext","$d7bdfb9eb0fdf311$export$c7109489551a4f4","_$d7bdfb9eb0fdf311$va2","$d7bdfb9eb0fdf311$var$RovingFocusProvider","$d7bdfb9eb0fdf311$var$useRovingFocusContext","$d7bdfb9eb0fdf311$export$8699f7c8af148338","$98Iye$forwardRef","$98Iye$createElement","__scopeRovingFocusGroup","$d7bdfb9eb0fdf311$var$RovingFocusGroupImpl","$98Iye$babelruntimehelpersesmextends","orientation","currentTabStopIdProp","currentTabStopId","defaultCurrentTabStopId","onCurrentTabStopIdChange","onEntryFocus","groupProps","$98Iye$useRef","$98Iye$useComposedRefs","$98Iye$useDirection","_$98Iye$useControllab2","$98Iye$useControllableState","_$98Iye$useControllab3","setCurrentTabStopId","_$98Iye$useState2","$98Iye$useState","isTabbingBackOut","setIsTabbingBackOut","handleEntryFocus","$98Iye$useCallbackRef","isClickFocusRef","_$98Iye$useState4","focusableItemsCount","setFocusableItemsCount","$98Iye$useEffect","onItemFocus","$98Iye$useCallback","tabStopId","onItemShiftTab","onFocusableItemAdd","onFocusableItemRemove","$98Iye$Primitive","onMouseDown","$98Iye$composeEventHandlers","isKeyboardFocus","entryFocusEvent","focusable","$d7bdfb9eb0fdf311$var$focusFirst","$d7bdfb9eb0fdf311$var$ITEM_NAME","$d7bdfb9eb0fdf311$export$ab9df7c53fe8454","_props$focusable","_props$active","itemProps","autoId","$98Iye$useId","isCurrentTabStop","focusIntent","$d7bdfb9eb0fdf311$var$getDirectionAwareKey","$d7bdfb9eb0fdf311$var$MAP_KEY_TO_FOCUS_INTENT","$d7bdfb9eb0fdf311$var$getFocusIntent","candidateNodes","startIndex","$d7bdfb9eb0fdf311$var$wrapArray","ArrowLeft","ArrowUp","ArrowRight","ArrowDown","PageUp","Home","PageDown","End","PREVIOUSLY_FOCUSED_ELEMENT","$d7bdfb9eb0fdf311$export$be92b6f5f03c0fe9","$d7bdfb9eb0fdf311$export$6d08773d2e66f8f2","getDefaultParent","originalTarget","counterMap","uncontrolledNodes","markerMap","lockCount","unwrapHost","applyAttributeToOthers","markerName","controlAttribute","targets","correctedTarget","correctTargets","markerCounter","hiddenNodes","elementsToKeep","elementsToStop","keep","deep","attr","alreadyHidden","counterValue","markerValue","hideOthers","activeParentNode","__assign","__rest","zeroRightClassName","fullWidthClassName","useMergeRefs","useCallbackRef","assignRef","ItoI","innerCreateMedium","defaults","assigned","medium","useMedium","assignSyncMedium","cbs","assignMedium","pendingQueue","executeQueue","cycle","effectCar","ssr","createSidecarMedium","nothing","RemoveScroll","parentRef","_a","onScrollCapture","onWheelCapture","onTouchMoveCapture","callbacks","setCallbacks","forwardProps","removeScrollBar","shards","sideCar","noIsolation","inert","allowPinchZoom","_b","Container","SideCar","containerProps","lockRef","fullWidth","zeroRight","currentNonce","Target","isSideCarExport","makeStyleTag","nonce","__webpack_nonce__","stylesheetSingleton","counter","stylesheet","css","styleSheet","getElementsByTagName","insertStyleTag","styleSingleton","useStyle","sheet","isDynamic","styleHookSingleton","dynamic","zeroGap","getGapWidth","gapMode","cs","getOffset","documentWidth","windowWidth","innerWidth","Style","getStyles","allowRelative","important","RemoveScrollBar","noRelative","noImportant","passiveSupported","nonPassive","elementCanBeScrolled","alwaysContainsScroll","locationCouldBeScrolled","elementCouldBeScrolled","getScrollVariables","elementCouldBeVScrolled","elementCouldBeHScrolled","getHScrollVariables","getTouchXY","getDeltaXY","extractRef","generateStyle","idCounter","lockStack","exported","shouldPreventQueue","touchStartRef","activeAxis","lastProps","allow_1","pack","ar","__spreadArray","shouldCancelEvent","currentAxis","touchStart","moveDirection","canBeScrolledInMainDirection","cancelingAxis","endTarget","sourceDelta","noOverscroll","directionFactor","getDirectionFactor","targetInLock","shouldCancelScroll","isDeltaPositive","availableScroll","availableScrollTop","elementScroll","handleScroll","shouldPrevent","_event","sourceEvent","deltaCompare","should","shardNodes","shouldCancel","scrollTouchStart","scrollWheel","scrollTouchMove","ReactRemoveScroll","$6cc32821e9371a1c$var$SELECTION_KEYS","$6cc32821e9371a1c$var$LAST_KEYS","$6cc32821e9371a1c$var$FIRST_LAST_KEYS","$6cc32821e9371a1c$var$SUB_OPEN_KEYS","ltr","rtl","$6cc32821e9371a1c$var$SUB_CLOSE_KEYS","$6cc32821e9371a1c$var$MENU_NAME","_$epM9y$createCollect2","$epM9y$createCollection","$6cc32821e9371a1c$var$Collection","$6cc32821e9371a1c$var$useCollection","_$epM9y$createContext2","$epM9y$createContextScope","$epM9y$createPopperScope","$epM9y$createRovingFocusGroupScope","$6cc32821e9371a1c$var$createMenuContext","$6cc32821e9371a1c$export$4027731b685e72eb","$6cc32821e9371a1c$var$usePopperScope","$6cc32821e9371a1c$var$useRovingFocusGroupScope","_$6cc32821e9371a1c$va2","$6cc32821e9371a1c$var$MenuProvider","$6cc32821e9371a1c$var$useMenuContext","_$6cc32821e9371a1c$va4","$6cc32821e9371a1c$var$MenuRootProvider","$6cc32821e9371a1c$var$useMenuRootContext","$6cc32821e9371a1c$export$d9b273488cd8ce6f","__scopeMenu","_props$open","modal","_props$modal","popperScope","_$epM9y$useState2","$epM9y$useState","isUsingKeyboardRef","$epM9y$useRef","handleOpenChange","$epM9y$useCallbackRef","$epM9y$useDirection","$epM9y$useEffect","handlePointer","$epM9y$createElement","$epM9y$Root","onContentChange","$epM9y$useCallback","$6cc32821e9371a1c$export$9fa5ebd18bee4d43","$epM9y$forwardRef","$epM9y$Anchor","$epM9y$babelruntimehelpersesmextends","$6cc32821e9371a1c$var$PORTAL_NAME","_$6cc32821e9371a1c$va6","$6cc32821e9371a1c$var$PortalProvider","$6cc32821e9371a1c$var$usePortalContext","$6cc32821e9371a1c$export$793392f970497feb","$epM9y$Presence","$epM9y$Portal","$6cc32821e9371a1c$var$CONTENT_NAME","_$6cc32821e9371a1c$va8","$6cc32821e9371a1c$var$MenuContentProvider","$6cc32821e9371a1c$var$useMenuContentContext","$6cc32821e9371a1c$export$479f0f2f71193efe","portalContext","_props$forceMount","rootContext","$6cc32821e9371a1c$var$MenuRootContentModal","$6cc32821e9371a1c$var$MenuRootContentNonModal","$epM9y$useComposedRefs","$epM9y$hideOthers","$6cc32821e9371a1c$var$MenuContentImpl","trapFocus","disableOutsideScroll","$epM9y$composeEventHandlers","onOpenAutoFocus","onCloseAutoFocus","rovingFocusGroupScope","_$epM9y$useState4","currentItemId","setCurrentItemId","contentRef","timerRef","searchRef","pointerGraceTimerRef","pointerGraceIntentRef","pointerDirRef","lastPointerXRef","ScrollLockWrapper","$epM9y$RemoveScroll","$epM9y$Fragment","scrollLockWrapperProps","$epM9y$Slot","handleTypeaheadSearch","_items$find","_items$find2","currentItem","currentMatch","textValue","nextMatch","isRepeated","normalizedSearch","currentMatchIndex","wrappedValues","$6cc32821e9371a1c$var$wrapArray","$6cc32821e9371a1c$var$getNextMatch","newItem","updateSearch","$epM9y$useFocusGuards","isPointerMovingToSubmenu","_pointerGraceIntentRe","_pointerGraceIntentRe2","cursorPos","polygon","inside","$6cc32821e9371a1c$var$isPointInPolygon","$6cc32821e9371a1c$var$isPointerInGraceArea","onItemEnter","onItemLeave","_contentRef$current","onTriggerLeave","onPointerGraceIntentChange","intent","$epM9y$FocusScope","_contentRef$current2","$epM9y$DismissableLayer","$epM9y$Root1","$epM9y$Content","$6cc32821e9371a1c$var$getOpenState","isKeyDownInside","closest","isModifierKey","isCharacterKey","$6cc32821e9371a1c$var$focusFirst","$6cc32821e9371a1c$var$whenMouse","pointerXHasChanged","newDir","$6cc32821e9371a1c$export$22a631d1f72787bb","$epM9y$Primitive","$6cc32821e9371a1c$var$ITEM_NAME","$6cc32821e9371a1c$var$ITEM_SELECT","$6cc32821e9371a1c$export$2ce376c2cc3355c8","_props$disabled","onSelect","contentContext","isPointerDownRef","$6cc32821e9371a1c$var$MenuItemImpl","menuItem","itemSelectEvent","$epM9y$dispatchDiscreteCustomEvent","_props$onPointerDown","isTypingAhead","_props$disabled2","_$epM9y$useState6","isFocused","setIsFocused","_$epM9y$useState8","setTextContent","_menuItem$textContent","$epM9y$Item","$6cc32821e9371a1c$export$f6f243521332502d","_props$checked","onCheckedChange","checkboxItemProps","$6cc32821e9371a1c$var$ItemIndicatorProvider","$6cc32821e9371a1c$var$isIndeterminate","$6cc32821e9371a1c$var$getCheckedState","$6cc32821e9371a1c$var$RADIO_GROUP_NAME","_$6cc32821e9371a1c$va10","onValueChange","$6cc32821e9371a1c$var$ITEM_INDICATOR_NAME","_$6cc32821e9371a1c$va12","$6cc32821e9371a1c$var$useItemIndicatorContext","$6cc32821e9371a1c$export$a2593e23056970a3","itemIndicatorProps","_excluded11","indicatorContext","$6cc32821e9371a1c$var$SUB_NAME","_$6cc32821e9371a1c$va14","$6cc32821e9371a1c$var$MenuSubProvider","$6cc32821e9371a1c$var$useMenuSubContext","$6cc32821e9371a1c$export$71bdb9d1e2909932","_props$open2","parentMenuContext","_$epM9y$useState10","trigger","setTrigger","_$epM9y$useState12","contentId","$epM9y$useId","triggerId","onTriggerChange","$6cc32821e9371a1c$var$SUB_TRIGGER_NAME","$6cc32821e9371a1c$export$5fbbb3ba7297405f","subContext","openTimerRef","clearOpenTimer","pointerGraceTimer","$epM9y$composeRefs","_props$onClick","_context$content","_context$content2","rightSide","bleed","contentNearEdge","contentFarEdge","_context$content3","$6cc32821e9371a1c$var$SUB_CONTENT_NAME","$6cc32821e9371a1c$export$e7142ab31822bde6","_props$forceMount2","subContentProps","_excluded14","_subContext$trigger","isCloseKey","$6cc32821e9371a1c$export$be92b6f5f03c0fe9","$6cc32821e9371a1c$export$b688253958b8dfe7","$6cc32821e9371a1c$export$602eac185826482c","$6cc32821e9371a1c$export$7c6e2c02157bb7d2","$6cc32821e9371a1c$export$eb2fcfdbd7ba97d4","$6cc32821e9371a1c$export$6d08773d2e66f8f2","$6cc32821e9371a1c$export$16ce288f89fa631c","$6cc32821e9371a1c$export$c3468e2714d175fa","$6cc32821e9371a1c$export$d7a01e11500dfb6f","$6cc32821e9371a1c$export$2ea8a7a591ac5eac","$6cc32821e9371a1c$export$6d4de93b380beddf","$1b0217ee4a91d156$var$CONTEXT_MENU_NAME","_$3TiJz$createContext2","$3TiJz$createContextScope","$3TiJz$createMenuScope","$1b0217ee4a91d156$var$createContextMenuContext","$1b0217ee4a91d156$var$useMenuScope","_$1b0217ee4a91d156$va2","$1b0217ee4a91d156$var$ContextMenuProvider","$1b0217ee4a91d156$var$useContextMenuContext","$1b0217ee4a91d156$export$8dc6765e8be191c7","__scopeContextMenu","_$3TiJz$useState2","$3TiJz$useState","open1","menuScope","handleOpenChangeProp","$3TiJz$useCallbackRef","$3TiJz$useCallback","$3TiJz$createElement","$3TiJz$Root","$3TiJz$babelruntimehelpersesmextends","$1b0217ee4a91d156$var$TRIGGER_NAME","$1b0217ee4a91d156$export$be6fc7b1d5b0beb9","$3TiJz$forwardRef","triggerProps","pointRef","$3TiJz$useRef","DOMRect","fromRect","longPressTimerRef","clearLongPress","handleOpen","$3TiJz$useEffect","$3TiJz$Fragment","$3TiJz$Anchor","$3TiJz$Primitive","WebkitTouchCallout","$3TiJz$composeEventHandlers","$1b0217ee4a91d156$var$whenTouchOrPen","onPointerCancel","$1b0217ee4a91d156$export$14afd0be83e45060","$3TiJz$Portal","$1b0217ee4a91d156$var$CONTENT_NAME","$1b0217ee4a91d156$export$572205900c9369e","hasInteractedOutsideRef","$3TiJz$Content","_props$onCloseAutoFoc","_props$onInteractOuts","$1b0217ee4a91d156$export$9860523b0fcdd664","$3TiJz$Group","$1b0217ee4a91d156$export$16a26dc176a49100","$3TiJz$Item","$1b0217ee4a91d156$export$b6adbe51d5d8b7ec","$3TiJz$CheckboxItem","$1b0217ee4a91d156$export$5bc21d1c00c4b201","_$3TiJz$useControllab2","$3TiJz$useControllableState","$3TiJz$Sub","$1b0217ee4a91d156$export$30b2b5c64556d316","triggerItemProps","_excluded13","$3TiJz$SubTrigger","$1b0217ee4a91d156$export$2c967063bd2dc512","$3TiJz$SubContent","$1b0217ee4a91d156$export$be92b6f5f03c0fe9","$1b0217ee4a91d156$export$41fb9f06171c75f4","$1b0217ee4a91d156$export$602eac185826482c","$1b0217ee4a91d156$export$7c6e2c02157bb7d2","$1b0217ee4a91d156$export$eb2fcfdbd7ba97d4","$1b0217ee4a91d156$export$6d08773d2e66f8f2","$1b0217ee4a91d156$export$16ce288f89fa631c","$1b0217ee4a91d156$export$d7a01e11500dfb6f","$1b0217ee4a91d156$export$2ea8a7a591ac5eac","$1b0217ee4a91d156$export$6d4de93b380beddf","compactMenuItems","menuGroup","childItems","checkbox","actionItem","readonlyOk","menuSubmenu","menuCustom","_opts$readonlyOk","_opts$disabled","_opts$checked","_opts$disabled2","shapesWithUnboundArrows","useThreeStackableItems","useAllowGroup","useAllowUngroup","_app$getShapeById","showUiPaste","isActiveToolItem","geoState","_item$meta","_item$meta2","$5d3850c4d0b4e6c7$var$DIALOG_NAME","_$67UHm$createContext2","$67UHm$createContextScope","$5d3850c4d0b4e6c7$var$createDialogContext","_$5d3850c4d0b4e6c7$va2","$5d3850c4d0b4e6c7$var$DialogProvider","$5d3850c4d0b4e6c7$var$useDialogContext","$5d3850c4d0b4e6c7$export$3ddf2d174ce01153","__scopeDialog","triggerRef","$67UHm$useRef","_$67UHm$useControllab2","$67UHm$useControllableState","_$67UHm$useControllab3","$67UHm$createElement","$67UHm$useId","titleId","descriptionId","onOpenToggle","$67UHm$useCallback","prevOpen","$5d3850c4d0b4e6c7$var$PORTAL_NAME","_$5d3850c4d0b4e6c7$va4","$5d3850c4d0b4e6c7$var$PortalProvider","$5d3850c4d0b4e6c7$var$usePortalContext","$5d3850c4d0b4e6c7$export$dad7c95542bacce0","$67UHm$Children","$67UHm$Presence","$67UHm$Portal","$5d3850c4d0b4e6c7$var$OVERLAY_NAME","$5d3850c4d0b4e6c7$export$bd1d06c79be19e17","$67UHm$forwardRef","overlayProps","$5d3850c4d0b4e6c7$var$DialogOverlayImpl","$67UHm$babelruntimehelpersesmextends","$67UHm$RemoveScroll","$67UHm$Slot","$67UHm$Primitive","$5d3850c4d0b4e6c7$var$getState","$5d3850c4d0b4e6c7$var$CONTENT_NAME","$5d3850c4d0b4e6c7$export$b6d9565de1e068cf","$5d3850c4d0b4e6c7$var$DialogContentModal","$5d3850c4d0b4e6c7$var$DialogContentNonModal","$67UHm$useComposedRefs","$67UHm$useEffect","$67UHm$hideOthers","$5d3850c4d0b4e6c7$var$DialogContentImpl","$67UHm$composeEventHandlers","_context$triggerRef$c","ctrlLeftClick","_context$triggerRef$c2","_context$triggerRef$c3","$67UHm$useFocusGuards","$67UHm$Fragment","$67UHm$FocusScope","$67UHm$DismissableLayer","$5d3850c4d0b4e6c7$var$TITLE_NAME","$5d3850c4d0b4e6c7$export$16f7638e4a34b909","$5d3850c4d0b4e6c7$var$CLOSE_NAME","$5d3850c4d0b4e6c7$export$fba2fb7cd781b7ac","$5d3850c4d0b4e6c7$var$TITLE_WARNING_NAME","_$67UHm$createContext4","$67UHm$createContext","contentName","titleName","docsSlug","$5d3850c4d0b4e6c7$export$be92b6f5f03c0fe9","$5d3850c4d0b4e6c7$export$602eac185826482c","$5d3850c4d0b4e6c7$export$c6fdb837b070b4ff","$5d3850c4d0b4e6c7$export$7c6e2c02157bb7d2","Icon","small","invertIcon","useAssetUrls","icons","isDarwin","cmdKey","kbdStr","subStr","NEXT_PUBLIC_VERCEL_ENV","NEXT_PUBLIC_VERCEL_URL","Kbd","Button","_props$title","iconLeft","smallIcon","kbd","_ref$isChecked","isChecked","_ref$type","spinner","msg","useTranslation","labelStr","classnames","Header","Title","_Dialog","CloseButton","Body","Footer","$d08ef79370b62062$var$DROPDOWN_MENU_NAME","_$9kmUS$createContext2","$9kmUS$createContextScope","$9kmUS$createMenuScope","$d08ef79370b62062$var$createDropdownMenuContext","$d08ef79370b62062$var$useMenuScope","_$d08ef79370b62062$va2","$d08ef79370b62062$var$DropdownMenuProvider","$d08ef79370b62062$var$useDropdownMenuContext","$d08ef79370b62062$export$e44a253a59704894","__scopeDropdownMenu","$9kmUS$useRef","_$9kmUS$useControllab2","$9kmUS$useControllableState","_$9kmUS$useControllab3","$9kmUS$createElement","$9kmUS$useId","$9kmUS$useCallback","$9kmUS$Root","$9kmUS$babelruntimehelpersesmextends","$d08ef79370b62062$var$TRIGGER_NAME","$d08ef79370b62062$export$d2469213b3befba9","$9kmUS$forwardRef","$9kmUS$Anchor","$9kmUS$Primitive","$9kmUS$composeRefs","$9kmUS$composeEventHandlers","$d08ef79370b62062$export$cd369b4d4d54efc9","$9kmUS$Portal","$d08ef79370b62062$var$CONTENT_NAME","$d08ef79370b62062$export$6e76d93a37c01248","$9kmUS$Content","isRightClick","$d08ef79370b62062$export$246bebaba3a2f70e","$9kmUS$Group","$d08ef79370b62062$export$ed97964d1871885d","$9kmUS$Item","$d08ef79370b62062$export$53a69729da201fa9","$9kmUS$CheckboxItem","$d08ef79370b62062$export$42355ae145153fb6","$9kmUS$ItemIndicator","$d08ef79370b62062$export$21dcb7ec56f874cf","subTriggerProps","$9kmUS$SubTrigger","$d08ef79370b62062$export$f34ec8bc2482cc5f","$9kmUS$SubContent","$d08ef79370b62062$export$be92b6f5f03c0fe9","$d08ef79370b62062$export$41fb9f06171c75f4","$d08ef79370b62062$export$602eac185826482c","$d08ef79370b62062$export$7c6e2c02157bb7d2","$d08ef79370b62062$export$eb2fcfdbd7ba97d4","$d08ef79370b62062$export$6d08773d2e66f8f2","$d08ef79370b62062$export$16ce288f89fa631c","$d08ef79370b62062$export$c3468e2714d175fa","$d08ef79370b62062$export$d7a01e11500dfb6f","_$9kmUS$useControllab5","_$9kmUS$useControllab6","$9kmUS$Sub","$d08ef79370b62062$export$2ea8a7a591ac5eac","$d08ef79370b62062$export$6d4de93b380beddf","Root","_ref$modal","useMenuIsOpen","DropdownMenu","Trigger","Content","_ref3$side","_ref3$align","_ref3$sideOffset","_ref3$alignOffset","SubTrigger","dataDirection","SubContent","_ref6$alignOffset","_ref6$sideOffset","Group","_ref7$size","Item","noClose","CheckboxItem","RadioItem","ButtonPicker","styleType","_props$value","_props$columns","rPointing","_React$useMemo","handlePointerUp","handleButtonClick","handleButtonPointerDown","handleButtonPointerEnter","handleButtonPointerUp","Input","_ref$autoselect","autoselect","_ref$autofocus","autofocus","onCancel","_ref$shouldManuallyMa","shouldManuallyMaintainScrollPositionWhenFocused","rInputRef","rInitialValue","rCurrentValue","_rInputRef$current","scrollIntoView","block","_rInputRef$current2","onKeyUp","$faa2e61a3361514f$var$PAGE_KEYS","$faa2e61a3361514f$var$ARROW_KEYS","$faa2e61a3361514f$var$BACK_KEYS","$faa2e61a3361514f$var$SLIDER_NAME","_$g1Vy2$createCollect2","$g1Vy2$createCollection","$faa2e61a3361514f$var$Collection","$faa2e61a3361514f$var$useCollection","$faa2e61a3361514f$var$createCollectionScope","_$g1Vy2$createContext2","$g1Vy2$createContextScope","$faa2e61a3361514f$var$createSliderContext","_$faa2e61a3361514f$va2","$faa2e61a3361514f$var$SliderProvider","$faa2e61a3361514f$var$useSliderContext","$faa2e61a3361514f$export$472062a354075cee","$g1Vy2$forwardRef","_props$min","_props$max","_props$step","_props$orientation","_props$minStepsBetwee","minStepsBetweenThumbs","_props$defaultValue","_props$onValueChange","_props$onValueCommit","onValueCommit","_props$inverted","inverted","sliderProps","_$g1Vy2$useState2","$g1Vy2$useState","slider","setSlider","$g1Vy2$useComposedRefs","thumbRefs","$g1Vy2$useRef","valueIndexToChangeRef","isHorizontal","isFormControl","SliderOrientation","$faa2e61a3361514f$var$SliderHorizontal","$faa2e61a3361514f$var$SliderVertical","_$g1Vy2$useControllab2","$g1Vy2$useControllableState","_thumbs$valueIndexToC","_$g1Vy2$useControllab3","setValues","valuesBeforeSlideStartRef","updateValues","atIndex","decimalCount","$faa2e61a3361514f$var$getDecimalCount","snapToStep","rounder","$faa2e61a3361514f$var$roundValue","$g1Vy2$clamp","prevValues","nextValues","$faa2e61a3361514f$var$getNextSortedValues","minStepsBetweenValues","stepsBetweenValues","$faa2e61a3361514f$var$getStepsBetweenValues","$faa2e61a3361514f$var$hasMinStepsBetweenValues","hasChanged","$g1Vy2$createElement","__scopeSlider","thumbs","$g1Vy2$babelruntimehelpersesmextends","$g1Vy2$composeEventHandlers","onSlideStart","closestIndex","distances","$faa2e61a3361514f$var$getClosestValueIndex","onSlideMove","onSlideEnd","onHomeKeyDown","onEndKeyDown","onStepKeyDown","stepDirection","multiplier","$faa2e61a3361514f$var$BubbleInput","_$faa2e61a3361514f$va4","$faa2e61a3361514f$var$SliderOrientationProvider","$faa2e61a3361514f$var$useSliderOrientationContext","_$g1Vy2$useState4","rectRef","$g1Vy2$useDirection","isDirectionLTR","isSlidingFromLeft","getValueFromPointer","pointerPosition","$faa2e61a3361514f$var$linearScale","$faa2e61a3361514f$var$SliderImpl","isBackKey","sliderRef","isSlidingFromBottom","$g1Vy2$Primitive","$faa2e61a3361514f$var$TRACK_NAME","$faa2e61a3361514f$export$105594979f116971","trackProps","$faa2e61a3361514f$var$RANGE_NAME","$faa2e61a3361514f$export$a5cf38a7a000fe77","_objectSpread4","rangeProps","valuesCount","percentages","$faa2e61a3361514f$var$convertValueToPercentage","offsetStart","offsetEnd","$faa2e61a3361514f$var$THUMB_NAME","$faa2e61a3361514f$export$2c1b491743890dec","_$g1Vy2$useState6","thumb","setThumb","$g1Vy2$useMemo","$faa2e61a3361514f$var$SliderThumbImpl","thumbProps","_$g1Vy2$useState8","$g1Vy2$useSize","percent","totalValues","$faa2e61a3361514f$var$getLabel","orientationSize","thumbInBoundsOffset","halfWidth","$faa2e61a3361514f$var$getThumbInBoundsOffset","$g1Vy2$useEffect","inputProps","$8LvvK$useRef","previous","$8LvvK$useMemo","$g1Vy2$usePrevious","inputProto","Event","output","$faa2e61a3361514f$export$be92b6f5f03c0fe9","$faa2e61a3361514f$export$13921ac0cc260818","$faa2e61a3361514f$export$9a58ef0d7ad3278c","$faa2e61a3361514f$export$6521433ed15a34db","Slider","handleValueChange","Track","Range","Thumb","validUrlRegex","valiateUrl","EditLinkDialog","validState","setIsValid","rValue","validStateUrl","handleClear","setProp","handleComplete","validState2","handleCancel","isRemoving","Dialog","blobAsString","_blobAsString","_callee13","_context13","readAsText","dataTransferItemAsString","_dataTransferItemAsString","_callee14","_context14","getAsString","disallowClipboardEvents","stripHtml","createHTMLDocument","pasteTldrawContent","pastePlainText","_app$textMeasure$meas","pasteUrl","_resp$headers$get","headers","pasteFiles","pasteSvgText","svgString","assetID","createAssetShapeAtPoint","blobs","handleMenuCopy","kind","stringifiedClipboard","_navigator$clipboard","textItems","htmlBlob","Blob","ClipboardItem","writeText","pasteText","validUrlList","url2","protocol","uniq","getValidHttpURLList","isValidHttpURL","pasteExcalidrawContent","_x18","_pasteExcalidrawContent","_callee15","tldrawContent","groupShapeIdToChildren","rotatedElements","getOpacity","strokeWidthsToSizes","fontSizesToSizes","getFontSizeAndScale","fontFamilyToFontType","colorsToColors","strokeStylesToStrokeTypes","fillStylesToFillType","textAlignToAlignTypes","arrowheadsToArrowheadTypes","getBend","getDash","getFill","excElementIdsToTldrawShapeIds","skipIds","groupedShapeIds","_step6$value","viewPortCenter","_context18","startPoint","endPoint","point2","hachure","dot","triangle","bar","_strokeStylesToStroke","strokeStyle","roughness","_fillStylesToFillType","boundElements","boundElement","_groupShapeIdToChildr","_element$link","_strokeWidthsToSizes$","_colorsToColors$color","colorToUse","_colorsToColors$eleme","_colorsToColors$eleme2","_element$startBinding","_element$endBinding","_strokeWidthsToSizes$2","_colorsToColors$eleme3","_arrowheadsToArrowhea","_arrowheadsToArrowhea2","_text2","_start","_end","startTargetId","endTargetId","_fontFamilyToFontType","_colorsToColors$eleme4","_getFontSizeAndScale","_element$id","_context17","groupIds","labelElement","_context15","strokeColor","_ref13$","roundness","_context16","elementId","endArrowhead","startArrowhead","fileId","groupShapes","rotateShapesBy","handleFilesBlob","_x19","_x20","_x21","handleHtmlString","_html$match","json","rootNode","bodyNode","firstElementChild","hasAttribute","_x22","_x23","_x24","handleTextString","_text$match","_x25","_x26","_x27","handleNativeDataTransferPaste","writingFile","writingContent","_text","getAsFile","_x28","_x29","_x30","handleNativeClipboardPaste","clipboardItems","isFile","_blob","_blob2","getType","_x34","_x31","_x32","_x33","useMenuClipboardEvents","copy","cut","paste","_onPaste","_callee12","_context12","_x35","_x36","ToastsContext","ToastsProvider","toasts","setToasts","addToast","_toast$id","removeToast","clearToasts","useToasts","DEFAULT_TRANSLATION","EN_TRANSLATION","messages","fetchTranslation","_fetchTranslation","language","missing","translations","en","getTranslation","_getTranslation","useLanguages","currentLanguage","AssetUrlsContext","AssetUrlsProvider","TranslationsContext","useCurrentTranslation","TranslationProvider","overrides","userSettings","getAssetUrl","currentTranslation","setCurrentTranslation","_loadTranslation","localeString","translation","loadTranslation","_translation$messages","getExportSvgElement","_getExportSvgElement","format","getExportedSvgBlob","_getExportedSvgBlob","getExportedImageBlob","_getExportedImageBlob","fallbackWriteTextAsync","_fallbackWriteTextAsync","getText","DialogsContext","DialogsProvider","dialogs","setDialogs","addDialog","_dialog$id","updateDialog","newDialogData","removeDialog","_m$onClose","clearDialogs","_m$onClose2","useDialogs","useInsertMedia","inputRef","onchange","_onchange","fileList","accept","_inputRef$current","ActionsContext","ActionsProvider","_useDialogs","insertMedia","printSelectionOrPages","prevPrintEl","prevStyleEl","_printSelectionOrPages","clearElements","allowAllPages","beforePrintHandler","afterPrintHandler","addPageToPrint","triggerPrint","svgOpts","_page","_svg","_page2","_svg2","print","footer","printEl","styleEl","usePrint","_useMenuClipboardEven","copyAs","jsonStr","useCopyAs","exportAs","_exportAs","_dataURL","_dataURL2","useExportAs","actions2","makeActions","component","menuLabel","contextMenuLabel","warnMsg","createList","deleteList","newPos","ungroupShapes","alignShapes","distributeShapes","stretchShapes","flipShapes","packShapes","stackShapes","bringToFront","bringForward","sendBackward","sendToBack","selectAll","dontUseOffset","offsetCloseToZero","nudgeShapes","_app$selectedPageBoun","useActions","PORTRAIT_BREAKPOINTS","BreakpointContext","BreakPointProvider","breakpoint","breakpoints","useBreakpoint","layoutQuery","useHasLinkShapeSelected","ActionsMenuSchemaContext","ActionsMenuSchemaProvider","selectedCount","oneSelected","twoSelected","threeSelected","threeStackableItems","allowGroup","allowUngroup","showEditLink","isZoomedTo100","actionMenuSchema","useCanRedo","canRedo","useCanUndo","useShowAutoSizeToggle","ContextMenuSchemaContext","ContextMenuSchemaProvider","_window$navigator$cli","showAutoSizeToggle","onlyFlippableShapeSelected","isShapeWithHandles","useOnlyFlippableShape","oneEmbedSelected","selectedId","oneEmbeddableBookmarkSelected","atLeastOneShapeOnPage","isTransparentBg","hasClipboardWrite","contextMenuSchema","contextMenuSchema2","showUngroup","useContextMenuSchema","KeyboardShortcutsDialog","isReadonly","useReadonly","shortcutsItems","KeyboardShortcutsSchemaContext","useKeyboardShortcutsSchema","getKeyboardShortcutItem","item2","_item$actionItem","shortcutsLabel","HelpMenuSchemaContext","HelpMenuSchemaProvider","_useLanguages","helpMenuSchema","helpMenuSchema2","isff","addEvent","useCapture","getMods","modifier","mods","getKeys","_keyMap","backspace","tab","esc","del","ins","home","pageup","pagedown","capslock","num_0","num_1","num_2","num_3","num_4","num_5","num_6","num_7","num_8","num_9","num_multiply","num_add","num_enter","num_subtract","num_decimal","num_divide","_modifier","option","control","cmd","modifierMap","_mods","_downKeys","winListendFocus","_scope","elementHasBindEvent","setScope","getScope","eachUnbind","_ref$splitKey","splitKey","originKey","unbindKeys","lastKey","arr1","compareArray","eventHandler","modifiersMatch","shortcut","asterisk","hotkeys","keyName","keyNum","keydown","keyup","keyShortcut","_downKeysCurrent","isElementBind","clearModifier","_api","getPressedKeyString","getKey","getModifier","deleteScope","newScope","getPressedKeyCodes","isPressed","flag","isContentEditable","readOnly","unbind","keysInfo","keyMap","_hotkeys","noConflict","EmbedDialog","embedDefinition","setEmbedDefinition","setUrl","embedInfoForUrl","setEmbedInfoForUrl","showError","setShowError","rShowErrorTimeout","embedIcons","ToolsContext","ToolsProvider","tools2","makeTools","useTools","SKIP_KBDS","getHotkeysStringFromKbd","KeyboardShortcutsSchemaProvider","keyboardShortcutsSchema","keyboardShortcutsSchema2","rIsOpen","isOpen","menuId","MenuSchemaContext","MenuSchemaProvider","isMobile","isToolLock","emptyPage","noneSelected","menuSchema","menuSchema2","toolbarItem","toolItem","ToolbarSchemaContext","ToolbarSchemaProvider","toolbarSchema","hand","eraser","note","MoveToPageMenu","_ContextMenu","moveShapesToPage","newPageId","oldPageId","ContextMenu","noItemsToShow","ContextMenuContent","handleSubOpenChange","disableClicks","setDisableClicks","getContextMenuItem","labelToUse","DebugPanel","renderDebugMenuItems","CurrentState","ShapeCount","DebugMenuContent","setError","ExampleDialog","onContinue","cols","createNShapes","countDescendants","elms","getElementById","descendants","dontShowAgain","setDontShowAgain","marginRight","_onClick","cvs","resetTransform","clearRect","Path2D","save","getPageCorners","restore","ellipse","LanguageMenu","handleLanguageSelect","updateUser","HelpMenu","Portal","HelpMenuContent","useHelpMenuSchema","getHelpMenuItem","MinimapManager","selectFill","viewportFill","contentScreenBounds","contentPageBounds","canvasScreenBounds","canvasPageBounds","_this$getScreenPoint","getScreenPoint","clampToBounds","_this$getPagePoint","getPagePoint","_shapesPageBounds$min","_shapesPageBounds$max","_shapesPageBounds$min2","_shapesPageBounds$max2","shapesPageBounds","vpPageBounds","lx","ly","qr","qt","updateCanvasPageBounds","globalAlpha","ax","ay","bx","by","shapesPath","selectedPath","_this$colors","roundedRect","strokeRect","sharpRect","closePath","rx2","ry2","collaborator","collaborators","quadraticCurveTo","_rx","_ry","Minimap","minimap","_minimap$minimapScree","minimapScreenPointToPagePoint","clampedPoint","originPageCenter","_minimap$minimapScree2","_vpPageBounds","_minimap$minimapScree3","screenPoint","setDpr","updateContentScreenBounds","allShapeBounds","ZoomMenu","hasShapes","hasSelected","handleDoubleClick","ZoomMenuItem","_props$noClose","NavigationZone","_useLocalStorageState","updateValue","useLocalStorageState","_useLocalStorageState2","collapsed","setCollapsed","toggleMinimap","DoubleDropdownPicker","labelA","labelB","itemsA","itemsB","styleTypeA","styleTypeB","valueA","valueB","iconA","_itemsA$find$icon","_itemsA$find","iconB","_itemsB$find$icon","_itemsB$find","startWdPrefix","endWdPrefix","DropdownPicker","StylePanel","handlePointerOut","hideGeo","hideArrowHeads","hideSpline","hideText","CommonStylePickerSet","TextStylePickerSet","GeoStylePickerSet","ArrowheadStylePickerSet","SplineStylePickerSet","useStyleChangeCallback","handleOpacityValueChange","showPickers","opacityIndex","BackToContent","showBackToContent","setShowBackToContent","showBackToContentPrev","visibleShapes","showBackToContentNow","ModalContent","Dialogs","ExitPenMode","$cb5cc270b50c6fcd$var$POPOVER_NAME","_$am6gm$createContext2","$am6gm$createContextScope","$am6gm$createPopperScope","$cb5cc270b50c6fcd$var$createPopoverContext","$cb5cc270b50c6fcd$var$usePopperScope","_$cb5cc270b50c6fcd$va2","$cb5cc270b50c6fcd$var$PopoverProvider","$cb5cc270b50c6fcd$var$usePopoverContext","$cb5cc270b50c6fcd$export$5b6b19405a83ff9d","__scopePopover","$am6gm$useRef","_$am6gm$useState2","$am6gm$useState","hasCustomAnchor","setHasCustomAnchor","_$am6gm$useControllab2","$am6gm$useControllableState","_$am6gm$useControllab3","$am6gm$createElement","$am6gm$Root","$am6gm$useId","$am6gm$useCallback","onCustomAnchorAdd","onCustomAnchorRemove","$cb5cc270b50c6fcd$var$TRIGGER_NAME","$cb5cc270b50c6fcd$export$7dacb05d26466c3","$am6gm$forwardRef","composedTriggerRef","$am6gm$useComposedRefs","$am6gm$Primitive","$am6gm$babelruntimehelpersesmextends","$cb5cc270b50c6fcd$var$getState","$am6gm$composeEventHandlers","$am6gm$Anchor","$cb5cc270b50c6fcd$var$PORTAL_NAME","_$cb5cc270b50c6fcd$va4","$cb5cc270b50c6fcd$var$PortalProvider","$cb5cc270b50c6fcd$var$usePortalContext","$cb5cc270b50c6fcd$export$dd679ffb4362d2d4","$am6gm$Presence","$am6gm$Portal","$cb5cc270b50c6fcd$var$CONTENT_NAME","$cb5cc270b50c6fcd$export$d7e1f420b25549ff","$cb5cc270b50c6fcd$var$PopoverContentModal","$cb5cc270b50c6fcd$var$PopoverContentNonModal","isRightClickOutsideRef","$am6gm$useEffect","$am6gm$hideOthers","$am6gm$RemoveScroll","$am6gm$Slot","$cb5cc270b50c6fcd$var$PopoverContentImpl","$am6gm$useFocusGuards","$am6gm$FocusScope","$am6gm$DismissableLayer","$am6gm$Content","$cb5cc270b50c6fcd$export$be92b6f5f03c0fe9","$cb5cc270b50c6fcd$export$41fb9f06171c75f4","$cb5cc270b50c6fcd$export$602eac185826482c","$cb5cc270b50c6fcd$export$7c6e2c02157bb7d2","Popover","PopoverPrimitive","PopoverTrigger","PopoverContent","ActionsMenu","useActionsMenuSchema","DuplicateButton","noSelected","MenuContent","useMenuSchema","getMenuItem","_navigator$clipboard2","PageItemInput","isCurrentPage","renamePage","onMovePage","getIndexBelow","PageItemSubmenu","listSize","onRename","onDuplicate","newId","duplicatePage","onMoveUp","onMoveDown","onDelete","deletePage","PageMenu","ITEM_HEIGHT","rSortableContainer","maxPageCountReached","setIsEditing","toggleEditing","setIsOpen","isOpen2","rMutables","pointing","startY","dragIndex","_useState5","sortablePositionItems","setSortablePositionItems","elmTopPosition","scrollTo","elmBottomPosition","_currentTarget$datase","mut","dragY","_mut$pointing","handleCreatePageClick","_sortablePositionItem","prompt","RedoButton","TrashButton","UndoButton","MenuZone","Toast","_toast$closeLabel","_toast$closeLabel2","hasActions","keepOpen","marginLeft","closeLabel","Toasts","ToastViewport","setHasToasts","MobileStylePanel","currentColor","disableStylePanel","handleStylesOpenChange","ToggleToolLockedButton","Toolbar","rMostRecentlyActiveDropdownItem","toolbarItems","useToolbarSchema","getTitle","activeToolbarItem","dropdownFirstItem2","itemsInPanel2","itemsInDropdown2","overflowIndex","itemsInPanel","itemsInDropdown","dropdownFirstItem","ToolbarButton","OverflowToolsContent","_meta$geo","_ref5$toolItem","_item$meta$geo","TLUiIconTypes","defaultUiAssetUrls","useShallowArrayEquality","useMergedTranslationOverrides","overridesArray","mergedTranslations","override","_step12$value","strings","useMergedOverrides","defaultHelpers","_useToasts","useDefaultHelpers","_step10$value","actionsMenu","helpers","contextMenu","helpMenu","menu","toolbar","keyboardShortcutsMenu","mergeOverrides","TldrawUiContextProvider","InternalProviders","mergedOverrides","TldrawUi","shareZone","TldrawUiInner","_loadImages","loadImages","usePreloadIcons","TldrawUiContent","areShortcutsDisabled","tool","useKeyboardShortcuts","useNativeClipboardEvents","handleMaxShapes","handleMoveToPage","useAppEvents","toggleFocus","ToastProvider","Tldraw","_props$persistenceKey","persistenceKey","_props$instanceId","userData","_Component","_jsxs","_jsx"],"sourceRoot":""}